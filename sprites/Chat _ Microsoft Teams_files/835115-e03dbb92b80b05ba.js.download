"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[835115,561776],{561776:(e,t,n)=>{var o;n.d(t,{D:()=>o}),function(e){e.AcceptSharedChannelInvitationDialog="AcceptSharedChannelInvitationDialog",e.AccessibilitySettingsPanelButton="AccessibilitySettingsPanelButton",e.ActivityFeed="ActivityFeed",e.ActivityFeedBellClick="ActivityFeedBellClick",e.AddAccountFromButton="AddAccountFromButton",e.AddAccountFromMeMenu="AddAccountFromMeMenu",e.AddAccountFromSettings="AddAccountFromSettings",e.AddCloudStorageFolderDialog="AddCloudStorageFolderDialog",e.AltTextMenuItem="AltTextMenuItem",e.AnalyticsChannelDropdown="AnalyticsChannelDropdown",e.AnalyticsButtonCrossTeamName="AnalyticsButtonCrossTeamName",e.AnalyticsButtonCrossTeamPeopleCount="AnalyticsButtonCrossTeamPeopleCount",e.AnalyticsButtonPerTeamToCross="AnalyticsButtonPerTeamToCross",e.AnalyticsButtonChannelToTeam="AnalyticsButtonChannelToTeam",e.AppBar="AppBar",e.AppearanceSettings="AppearanceSettings",e.AppProfileCard="AppProfileCard",e.AppSwitchConfirmationPage="AppSwitchConfirmationPage",e.AppSwitcher="AppSwitcher",e.AuthApp="AuthApp",e.Authentication="Authentication",e.AutoBrb="AutoBrb",e.Autosuggest="Autosuggest",e.Avatar="Avatar",e.AvatarCoachmark="AvatarCoachmark",e.BannerNotification="BannerNotification",e.BlockChat="BlockChat",e.BrbForm="BrbForm",e.Breadcrumb="Breadcrumb",e.BreakoutRoomsCreateButton="BreakoutRoomsCreateButton",e.BreakoutRoomsPanel="BreakoutRoomsPanel",e.BreakoutRoomsRecreateButton="BreakoutRoomsRecreateButton",e.BreakoutRoomsSettingPresenter="BreakoutRoomsSettingPresenter",e.BroadcastInfoPanelButton="BroadcastInfoPanelButton",e.BroadcastInfoPanelContainer="BroadcastInfoPanelContainer",e.BroadcastJoinAsAttendeeButton="BroadcastJoinAsAttendeeButton",e.BroadcastLeaveScreen="BroadcastLeaveScreen",e.BroadcastQnaPanelButton="BroadcastQnaPanelButton",e.BroadcastQnaPanelWrapper="BroadcastQnaPanelWrapper",e.Calendar="Calendar",e.CalendarAnswer="CalendarAnswer",e.CalendarEventAction="CalendarEventAction",e.CalendarSettings="CalendarSettings",e.CalendarSyncBanner="CalendarSyncBanner",e.CallDebug="CallDebug",e.CallHealthButton="CallHealthButton",e.CallSettings="CallSettings",e.CallSettingsHeader="CallSettingsHeader",e.Calling="Calling",e.CallingAlert="CallingAlert",e.CallingAppEvent="CallingAppEvent",e.CallingBreakoutRoomsWrapper="CallingBreakoutRoomsWrapper",e.CallingDeeplinkDialog="CallingDeeplinkDialog",e.CallingCameraEffectsPanelWrapper="CallingCameraEffectsPanelWrapper",e.CallingCustomVideoBackgroundsPanelContainer="CallingCustomVideoBackgroundsPanelContainer",e.CallingCustomVideoBackgroundsPanelWrapper="CallingCustomVideoBackgroundsPanelWrapper",e.CallingDevicesPanelWrapper="CallingDevicesPanelWrapper",e.CallingEndScreen="CallingEndScreen",e.CallingEndScreenPostMeetingChat="CallingEndScreenPostMeetingChat",e.CallingOnBeforeDeeplinkParsed="CallingOnBeforeDeeplinkParsed",e.CallingPreJoinEffectsAndAvatarsButton="CallingPreJoinEffectsAndAvatarsButton",e.CallingPreJoinScreenCancelButton="CallingPreJoinScreenCancelButton",e.CallingPrejoinScreenHideAllPanels="CallingPrejoinScreenHideAllPanels",e.CallingPreJoinScreenVideoEffectsButton="CallingPreJoinScreenVideoEffectsButton",e.CallingRosterWrapper="CallingRosterWrapper",e.CallingScreen="CallingScreen",e.CallingScreenErrorBoundary="CallingScreenErrorBoundary",e.CallingScreenHideAllPanels="CallingScreenHideAllPanels",e.CallMonitor="CallMonitor",e.CallsHeaderRenderer="CallsHeaderRenderer",e.CallTransferButton="CallTransferButton",e.CameraEffectsButton="CameraEffectsButton",e.CameraEffectsPrejoinPanelButton="CameraEffectsPrejoinPanelButton",e.CameraEffectsVideoPreviewButton="CameraEffectsVideoPreviewButton",e.CampaignNotification="CampaignNotification",e.Card="Card",e.CastWizard="CastWizard",e.CDLWorker="CDLWorker",e.ChannelContextualSearch="ChannelContextualSearch",e.ChannelDashboardHeader="ChannelDashboardHeader",e.ChannelDeleteOrUserNotMember="ChannelDeleteOrUserNotMember",e.ChannelEmail="ChannelEmail",e.ChannelHeader="ChannelHeader",e.ChannelInfoPane="ChannelInfoPane",e.ChannelInfoPaneExpanded="ChannelInfoPaneExpanded",e.ChannelLeaveContextMenuButton="ChannelLeaveContextMenuButton",e.ChannelList="ChannelList",e.ChannelListItem="ChannelListItem",e.ChannelMembers="ChannelMembers",e.ChannelOrTeamDeleteOrUserNotMember="ChannelOrTeamDeleteOrUserNotMember",e.ChannelPostMessage="ChannelPostMessage",e.ChannelPreStateScheduleMeetingDetailsMenuContextButton="ChannelPreStateScheduleMeetingDetailsMenuContextButton",e.ChannelRepliesPane="ChannelRepliesPane",e.ChannelL2NavigateViaHistory="ChannelL2NavigateViaHistory",e.ChannelSettings="ChannelSettings",e.ChannelInvitations="ChannelInvitations",e.ChatAddMembers="ChatAddMembers",e.ChatBubbles="ChatBubbles",e.ChatButton="ChatButton",e.ChatCallButton="ChatCallButton",e.ChatChattingWithMtoUserBanner="ChatChattingWithMtoUserBanner",e.ChatClaimed="ChatClaimed",e.ChatClaimLink="ChatClaimLink",e.ChatContextualSearch="ChatContextualSearch",e.ChatDeeplinkId="ChatDeeplinkId",e.ChatDeeplinkMessage="ChatDeeplinkMessage",e.ChatDeeplinkUsers="ChatDeeplinkUsers",e.ChatDeprovisioned="ChatDeprovisioned",e.ChatDisabledComposeLink="ChatDisabledComposeLink",e.ChatDiscardConversation="ChatDiscardConversation",e.ChatEmbedSdk="ChatEmbedSdk",e.ChatError="ChatError",e.ChatEscalation="ChatEscalation",e.ChatHeader="ChatHeader",e.ChatHighlightsDetails="ChatHighlightsDetails",e.ChatInfoPane="ChatInfoPane",e.ChatInfoPaneButton="ChatInfoPaneButton",e.ChatInfoPaneDetails="ChatInfoPaneDetails",e.ChatInviteConfirmationDialog="ChatInviteConfirmationDialog",e.ChatInviteLink="ChatInviteLink",e.ChatJoinShareButton="ChatJoinShareButton",e.ChatListFilterItem="ChatListFilterItem",e.ChatListItem="ChatListItem",e.ChatListItemBlockChatButton="ChatListItemBlockChatButton",e.ChatListItemDeleteChatButton="ChatListItemDeleteChatButton",e.ChatListItemDiscardButton="ChatListItemDiscardButton",e.ChatListItemInviteLinkButton="ChatListItemInviteLinkButton",e.ChatListItemMenuLeaveButton="ChatListItemMenuLeaveButton",e.ChatListItemMenuPinButton="ChatListItemMenuPinButton",e.ChatListMeetingItem="ChatListMeetingItem",e.ChatListSuggestedContact="ChatListSuggestedContact",e.ChatListSingleInboxMenu="ChatListSingleInboxMenu",e.ChatMeetingChiclet="ChatMeetingChiclet",e.ChatPane="ChatPane",e.ChatPopOutNewChat="ChatPopOutNewChat",e.ChatRailHeader="ChatRailHeader",e.ChatResolveConversationLie="ChatResolveConversationLie",e.ChatRoster="ChatRoster",e.ChatSendMessage="ChatSendMessage",e.ChatSendMessageRetry="ChatSendMessageRetry",e.ChatViewDeeplink="ChatViewDeeplink",e.ChatWith="ChatWith",e.ChatWithUser="ChatWithUser",e.ChatProtocolDeeplink="ChatProtocolDeeplink",e.ClosedCaptionsSettingsPanelWrapper="ClosedCaptionsSettingsPanelWrapper",e.CodeSnippetDiscardButton="CodeSnippetDiscardButton",e.CommunitiesAddMember="CommunitiesAddMember",e.CommunitiesEventsButton="CommunitiesEventsButton",e.CommunitiesCreateChannel="CommunitiesCreateChannel",e.CommunitiesEditChannelButton="CommunitiesEditChannelButton",e.CommunitiesCreateEventButton="CommunitiesCreateEventButton",e.CommunitiesInviteLink="CommunitiesInviteLink",e.CommunitiesGuidelinesDialog="CommunitiesGuidelinesDialog",e.CommunitiesGetAppDialog="CommunitiesGetAppDialog",e.CommunitiesCreateDialog="CommunitiesCreateDialog",e.CommunitiesEditDialog="CommunitiesEditDialog",e.CommunitiesSendPostAsEmailDialog="CommunitiesSendPostAsEmailDialog",e.CommunitiesShareFeedbackButton="CommunitiesShareFeedbackButton",e.CommunitiesManage="CommunitiesManage",e.CommunitiesOnboarding="CommunitiesOnboarding",e.CommunitiesHeader="CommunitiesHeader",e.CommunitiesList="CommunitiesList",e.ComposeChat="ComposeChat",e.ComposeChatDisabled="ComposeChatDisabled",e.ConnectedCalendarStatusBanner="ConnectedCalendarStatusBanner",e.ContactsSyncBanner="ContactsSyncBanner",e.ContactsSyncDialog="ContactsSyncDialog",e.ContactsSyncMobileSyncDialog="ContactsSyncMobileSyncDialog",e.ContentCameraSettingsButton="ContentCameraSettingsButton",e.ConveneOnBeforeDeeplinkParsed="ConveneOnBeforeDeeplinkParsed",e.Conversation="Conversation",e.CopyImage="CopyImage",e.Core="Core",e.CoreResolvers="CoreResolvers",e.CreateChannelDialog="CreateChannelDialog",e.CrossPostDeleteDialogButton="CrossPostDeleteDialogButton",e.CrossPostSelectChannelsButton="CrossPostSelectChannelsButton",e.CustomizeReactionsTrigger="CustomizeReactionsTrigger",e.CustomVideoBackgroundsPanelButton="CustomVideoBackgroundsPanelButton",e.CustomVideoBackgroundsPrejoinPanelButton="CustomVideoBackgroundsPrejoinPanelButton",e.CustomVideoBackgroundsVideoPreviewButton="CustomVideoBackgroundsVideoPreviewButton",e.DebugPanel="DebugPanel",e.DefaultChatNewChat="DefaultChatNewChat",e.DefaultChatNewGroup="DefaultChatNewGroup",e.DevicePanelButton="DevicePanelButton",e.Discover="Discover",e.DiscoverSurface="DiscoverSurface",e.DiscoverSurfaceDislikeFeedItemButton="DiscoverSurfaceDislikeFeedItemButton",e.DiscoverSurfaceEntry="DiscoverSurfaceEntry",e.DiscoverSurfaceL2BackButton="DiscoverSurfaceL2BackButton",e.Dlp="Dlp",e.DocumentCameraSharingButton="DocumentCameraSharingButton",e.EducationGuardians="EducationGuardians",e.EmbedBackButton="EmbedBackButton",e.EmbedDeeplink="EmbedDeeplink",e.EmergencyCallingSettingsSubpage="EmergencyCallingSettingsSubpage",e.Esp="Esp",e.ExtensionCommanding="ExtensionCommanding",e.ExternalCommand="ExternalCommand",e.FaceEnrollmentGetStartedButton="FaceEnrollmentGetStartedButton",e.FileDialog="FileDialog",e.FileViewer="FileViewer",e.FluidAltText="FluidAltText",e.FluidDiscardButton="FluidDiscardButton",e.FluidPickerCommand="FluidPickerCommand",e.FluidShareServicePermissionsCallback="FluidShareServicePermissionsCallback",e.Flyout="Flyout",e.FlyoutAuthLanding="FlyoutAuthLanding",e.FlyoutOnExperienceWarmJob="FlyoutOnExperienceWarmJob",e.FlyoutPrewarmJob="FlyoutPrewarmJob",e.FollowHybridRsvpNudgeUfd="FollowHybridRsvpNudgeUfd",e.ForwardMessageDialog="ForwardMessageDialog",e.GalleryImage="GalleryImage",e.GeneralSettings="GeneralSettings",e.GetLinkToChannelMenuButton="GetLinkToChannelMenuButton",e.GetLinkToCommunityButton="GetLinkToCommunityButton",e.GetLinkToTeamMenuButton="GetLinkToTeamMenuButton",e.GetTenantsFromSettings="GetTenantsFromSettings",e.GiveFeedbackChoices="GiveFeedbackChoices",e.GoogleAuthOnBeforeDeepLinkParsed="GoogleAuthOnBeforeDeepLinkParsed",e.HangupButton="HangupButton",e.Homepage="Homepage",e.InContextStore="InContextStore",e.InsertHyperlink="InsertHyperlink",e.InternalDeeplink="InternalDeeplink",e.JoinTeamDialog="JoinTeamDialog",e.KeyboardShortcut="KeyboardShortcut",e.KeypadButton="KeypadButton",e.LayoutError="LayoutError",e.LeaveCommunity="LeaveCommunity",e.LeaveGroupAndBlockUser="LeaveGroupAndBlockUser",e.LivePersonaCard="LivePersonaCard",e.LogsDownloading="LogsDownloading",e.LmsCourseCalendar="LmsCourseCalendar",e.LmsCourseTeams="LmsCourseTeams",e.LoopTryInSelfChatButton="LoopTryInSelfChatButton",e.M365ChatFeedback="M365ChatFeedback",e.ManageTeams="ManageTeams",e.ManageUserApps="ManageUserApps",e.ManageTeamDashboard="ManageTeamDashboard",e.MediaStreamsButton="MediaStreamsButton",e.MeetApp="MeetApp",e.MeetingBot="MeetingBot",e.MeetingCollabButton="MeetingCollabButton",e.MeetingDetailsButton="MeetingDetailsButton",e.MeetingDetailsPanelWrapper="MeetingDetailsPanelWrapper",e.MeetingInfoButton="MeetingInfoButton",e.MeetingInfoPanelWrapper="MeetingInfoPanelWrapper",e.MeetingNotesButton="MeetingNotesButton",e.MeetingOptions="MeetingOptions",e.MeetingRecapChatNavButton="MeetingRecapChatNavButton",e.MeetingRoomConsole="MeetingRoomConsole",e.MeetingRoomFrontOfRoom="MeetingRoomFrontOfRoom",e.MeetingRoomFrontOfRoomCallPanelsManager="MeetingRoomFrontOfRoomCallPanelsManager",e.MeetingRoomJoinByCodeButton="MeetingRoomJoinByCodeButton",e.MeetLauncher="MeetLauncher",e.MeshAvatarPanel="MeshAvatarPanel",e.MessageAction="MessageAction",e.MessageDraftDiscardButton="MessageDraftDiscardButton",e.MessageExtensionFlyout="MessageExtensionFlyout",e.MessageGiphyConsent="MessageGiphyConsent",e.MessageLeaveChatButton="MessageLeaveChatButton",e.MessageReaction="MessageReaction",e.MessageReadReceipt="MessageReadReceipt",e.MessageRemoveChatUserButton="MessageRemoveChatUserButton",e.MessageShareChatButton="MessageShareChatButton",e.MoreAvatarSettingsButton="MoreAvatarSettingsButton",e.MoreAvatarSettingsButtonInFlyout="MoreAvatarSettingsButtonInFlyout",e.MoreOptionsMenu="MoreOptionsMenu",e.MTMAChildWindowTenantName="MTMAChildWindowTenantName",e.MTMANotificationCard="MTMANotificationCard",e.NewChat="NewChat",e.Notifications="Notifications",e.NotificationsActivation="NotificationsActivation",e.NotificationSettings="NotificationSettings",e.NotificationSettingsRecommendations="NotificationSettingsRecommendations",e.Nova="Nova",e.OfficeIntegration="OfficeIntegration",e.OfficeIntegrationChat="OfficeIntegrationChat",e.OneUpConversationButton="OneUpConversationButton",e.OofSettings="OofSettings",e.OSFileShareEvent="OSFileShareEvent",e.PerCommunityNotificationSettingsDialog="PerCommunityNotificationSettingsDialog",e.PeripheralDeviceTeamsButtonShortPress="PeripheralDeviceTeamsButtonShortPress",e.PinUnpinPostConfirmButton="PinUnpinPostConfirmButton",e.PlatformAppDetailsDialog="PlatformAppDetailsDialog",e.PlatformExtension="PlatformExtension",e.PlatformPersonalAppHeader="PlatformPersonalAppHeader",e.PlatformPersonalAppDeepLink="PlatformPersonalAppDeepLink",e.PlatformTabDeepLink="PlatformTabDeepLink",e.PlatformTabHeader="PlatformTabHeader",e.PopOutButton="PopOutButton",e.PresenterToolbar="PresenterToolbar",e.PreviewButton="PreviewButton",e.QueuesAppHeader="QueuesAppHeader",e.RecordButton="RecordButton",e.ReplaceChatItemButton="ReplaceChatItemButton",e.ReportConcernCommunitiesButton="ReportConcernCommunitiesButton",e.ReportConcernCommunitiesDialog="ReportConcernCommunitiesDialog",e.ResolveConversation="ResolveConversation",e.RosterButton="RosterButton",e.ScheduleOOFFromMeMenu="ScheduleOOFFromMeMenu",e.SchedulingFormHeader="SchedulingFormHeader",e.SchoolTeams="SchoolTeams",e.Search="Search",e.SendChannelPost="SendChannelPost",e.SendChannelReply="SendChannelReply",e.SendChat="SendChat",e.Settings="Settings",e.SettingsHeader="SettingsHeader",e.ShareEmail="ShareEmail",e.ShareMeetingInviteDialog="ShareMeetingInviteDialog",e.ShareToTeamsMultiWindow="ShareToTeamsMultiWindow",e.ShareWithTeamYouOwnDialog="ShareWithTeamYouOwnDialog",e.ShareTray="ShareTray",e.ShellVersionCheck="ShellVersionCheck",e.ShellAuthState="ShellAuthState",e.ShellCDLServicesState="ShellCDLServicesState",e.ShellNetworkState="ShellNetworkState",e.ShellPresenceState="ShellPresenceState",e.SideloadedAppUploadButton="SideloadedAppUploadButton",e.SignOutEmbedClient="SignOutEmbedClient",e.SignOutLink="SignOutLink",e.Slimcore="Slimcore",e.SmartDeviceAvatarButton="SmartDeviceAvatarButton",e.SmartDeviceJoinByCodeBackButton="SmartDeviceJoinByCodeBackButton",e.SmartDeviceJoinByCodeButton="SmartDeviceJoinByCodeButton",e.StageViewDeeplink="StageViewDeeplink",e.StagingAppUploadButton="StagingAppUploadButton",e.StandAlone="StandAlone",e.StopMdpDataCollectionButton="StopMdpDataCollectionButton",e.Store="Store",e.StreamCameraButton="StreamCameraButton",e.StyleMyRoomPanel="StyleMyRoomPanel",e.Survey="Survey",e.SwitchAccountFromMeMenu="SwitchAccountFromMeMenu",e.SwitchAccountFromSettings="SwitchAccountFromSettings",e.TeamsAPIEventHandler="TeamsAPIEventHandler",e.TabConfigurationDialog="TabConfigurationDialog",e.TabInfoButton="TabInfoButton",e.TagCard="TagCard",e.TakeSnapshot="TakeSnapshot",e.TaskModuleDeeplink="TaskModuleDeeplink",e.TeamChannels="TeamChannels",e.TeamDashboardHeader="TeamDashboardHeader",e.TeamsGallery="TeamsGallery",e.TenantAppUploadButton="TenantAppUploadButton",e.TenantRedemption="TenantRedemption",e.TflFre="TflFre",e.Toast="Toast",e.TranscriptButton="TranscriptButton",e.TranscriptPanelButton="TranscriptPanelButton",e.TranscriptPanelWrapper="TranscriptPanelWrapper",e.Trouter="Trouter",e.TwoWaySmsFriendlyName="TwoWaySmsFriendlyName",e.UbarAccessibilityCoachmark="UbarAccessibilityCoachmark",e.UnifiedConsent="UnifiedConsent",e.UnifiedSearch="UnifiedSearch",e.Unknown="Unknown",e.UnlockTeam="UnlockTeam",e.UnpinChatItemButton="UnpinChatItemButton",e.UpdateGroupChatAvatarButton="UpdateGroupChatAvatarButton",e.UpdateTfwGroupChatAvatarButton="UpdateGroupChatAvatarButton",e.UpdateTenantsFromSettings="UpdateTenantsFromSettings",e.VideoCallPreviewPopup="VideoCallPreviewPopup",e.VideoEffectsAndAvatarButton="VideoEffectsAndAvatarButton",e.VideoEffectsAndAvatarPanel="VideoEffectsAndAvatarPanel",e.VideoEffectsButton="VideoEffectsButton",e.VideoEffectsCustomizationButton="VideoEffectsCustomizationButton",e.VideoEffectsMoreViewPanel="VideoEffectsMoreViewPanel",e.VideoEffectsPickerMoreButton="VideoEffectsPickerMoreButton",e.VideoEffectsVideoAppPanel="VideoEffectsVideoAppPanel",e.VideoPreviewDeviceSettingsButton="VideoPreviewDeviceSettingsButton",e.VideoSharingButton="VideoSharingButton",e.VirtualEventDetails="VirtualEventDetails",e.VirtualEventsListItem="VirtualEventsListItem",e.VoiceEnrollmentGetStartedButton="VoiceEnrollmentGetStartedButton",e.WhiteboardCameraSharingButton="WhiteboardCameraSharingButton",e.YammerQnaButton="YammerQnaButton",e.YammerQnaContainer="YammerQnaContainer"}(o||(o={}))},836240:(e,t,n)=>{var o;n.d(t,{R:()=>o}),function(e){e.flyout="flyout",e.iFrame="iFrame",e.primary="primary",e.secondary="secondary",e.minimode="minimode"}(o||(o={}))},71386:(e,t,n)=>{var o;n.d(t,{W:()=>o}),function(e){e.WindowReady="windowReady",e.WindowUnloaded="windowUnloaded",e.WindowAppStart="windowAppStart",e.CoreInitialized="coreInitialized",e.CommandChangeType="commandEvent",e.ExperienceStarted="experienceStarted",e.CoreInitializationFailed="coreInitializationFailed",e.ExtendedEntityContainerState="extendedEntityContainerState",e.MainWindowBlockedState="mainWindowBlockedState"}(o||(o={}))},22083:(e,t,n)=>{n.d(t,{G:()=>i});var o=n(116230);class i extends Error{get extensions(){return this.getExtensions()}constructor({type:e,code:t,message:n,prevError:o,userContextId:i}){var a;super(n),this.type=e,this.code=t,this.prevError=o,this.userContextId=i;const r=function(e){var t;return null!==(t=null==e?void 0:e.split("\n").slice(1))&&void 0!==t?t:[]}(null!==(a=null==o?void 0:o.stack)&&void 0!==a?a:this.stack);this.stack=[`${t} Error: ${n}`,...r].join("\n"),Object.setPrototypeOf(this,new.target.prototype)}static isFunction(e){return"function"==typeof e}getBoundaryProps(){return{title:`default_${this.type.toLowerCase()}_title`,description:`default_${this.type.toLowerCase()}_description`}}toTelemetryEntry(){var e,t;let n=this.toTelemetryCode(),a=this.prevError;for(;a;)a instanceof i&&i.isFunction(a.toTelemetryEntry)?(n+=a.toTelemetryEntry(),a=void 0):(0,o.a)(a)?(n+=`[IError::${a.code}]`,a=null!==(e=a.innerError)&&void 0!==e?e:null===(t=a.reason)||void 0===t?void 0:t.innerError):(n+=`[Error::${a.message}]`,a=void 0);return n}toJSON(){return{type:this.type,code:this.code,stack:this.stack,userContextId:this.userContextId,prevError:this.prevError}}serialize(){const e=new WeakSet;return JSON.stringify(this,((t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}))}deserialize(e){this.stack=e.stack}toTelemetryCode(){return`[${this.type}::${this.code}]`}getExtensions(){return{type:this.type,code:this.code,prevError:this.prevError,boundaryProps:this.getBoundaryProps()}}}},734876:(e,t,n)=>{n.d(t,{$:()=>o,G:()=>c});var o,i=n(22083),a=n(307909),r=n(116230);!function(e){e.CDL_WORKER_FAILURE="CDL_WORKER_FAILURE",e.CLEANUP="CLEANUP",e.CORE_SERVICES_MISSING="CORE_SERVICES_MISSING",e.CREATE_USER_CONTEXT_FAILED_GENERIC="CREATE_USER_CONTEXT_FAILED_GENERIC",e.CREATE_WINDOW_WRAPPER="CREATE_WINDOW_WRAPPER",e.DISABLED_BY_ADMIN="DISABLED_BY_ADMIN",e.EXPERIENCE_DISABLED="EXPERIENCE_DISABLED",e.GET_CURRENT_CLOUD_FAILED="GET_CURRENT_CLOUD_FAILED",e.INVALID_INTENT_OVERRIDE="INVALID_INTENT_OVERRIDE",e.LAUNCH_CLOUD_DEEPLINK_ERROR="LAUNCH_CLOUD_DEEPLINK_ERROR",e.LAYOUT_ERROR="LAYOUT_ERROR",e.LAYOUT_ERROR_USER_BLOCKED="LAYOUT_ERROR_USER_BLOCKED",e.LAYOUT_PHASE_STATE_MACHINE_TIMEOUT="LAYOUT_PHASE_STATE_MACHINE_TIMEOUT",e.NETWORK_OFFLINE="NETWORK_OFFLINE",e.NETWORK_OFFLINE_USER_BLOCKED="NETWORK_OFFLINE_USER_BLOCKED",e.RENDERING_CONTEXT_DOES_NOT_EXIST="RENDERING_CONTEXT_DOES_NOT_EXIST",e.UNKNOWN="UNKNOWN",e.TELEMETRY_PRIMARY_USER_SET_FAILURE="TELEMETRY_PRIMARY_USER_SET_FAILURE",e.USER_DOES_NOT_EXIST="USER_DOES_NOT_EXIST",e.USER_NOT_AUTHENTICATED="USER_NOT_AUTHENTICATED",e.USERCONTEXTID_EMPTY="USERCONTEXTID_EMPTY",e.WINDOW_UNDEFINED="WINDOW_UNDEFINED"}(o||(o={}));const s={CDL_WORKER_FAILURE:"Cdl worker did not start up properly.",DISABLED_BY_ADMIN:"Please switch back to classic Teams.",EXPERIENCE_DISABLED:"We can't wait to show you the new Teams, but we're not quite ready for you. We'll let you know when it's time.",LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:"Layout phase state machine has timed out triggering a view tear down.",TELEMETRY_PRIMARY_USER_SET_FAILURE:"This can result from a failure to load the PIE api, a failure to call maglev, or a failure to set primary user in the telemetry web worker"},l={CREATE_USER_CONTEXT_FAILED_GENERIC:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},DISABLED_BY_ADMIN:{title:"default_disabledbyadmin_title",description:"default_disabledbyadmin_description",actions:["SWITCH_TO_CLASSIC","SIGN_OUT"],icon:a.P.NoLongerAllowed},EXPERIENCE_DISABLED:{title:"default_experiencedisabled_title",description:"default_experiencedisabled_description",actions:["SIGN_OUT"],icon:a.P.NoLongerAllowed},LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},NETWORK_OFFLINE:{title:"default_nonetwork_title",description:"error_nonetwork_text"},NETWORK_OFFLINE_USER_BLOCKED:{title:"default_nonetwork_title",description:"error_nonetwork_text",actions:["RESTART"]},CDL_WORKER_FAILURE:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},LAYOUT_ERROR:{title:"default_unknown_title",description:"",actions:[]},LAYOUT_ERROR_USER_BLOCKED:{title:"default_unknown_title",description:"",actions:["RESTART"]},RENDERING_CONTEXT_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},USER_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]}};class c extends i.G{constructor(e,t,n){var o,i,a,l,c;super({type:"CoreError",code:e,message:null!==(o=s[e])&&void 0!==o?o:(0,r.a)(t)?null!==(a=null===(i=t.innerError)||void 0===i?void 0:i.message)&&void 0!==a?a:null===(c=null===(l=t.reason)||void 0===l?void 0:l.innerError)||void 0===c?void 0:c.message:null==t?void 0:t.message,prevError:t,userContextId:n})}getBoundaryProps(){var e;return null!==(e=l[this.code])&&void 0!==e?e:{title:"default_core_title",description:"default_core_description"}}static fromSerialized(e){if("CoreError"!==(null==e?void 0:e.type))return null;const t=new c(e.code,e.prevError,e.userContextId);return t.deserialize(e),t}}},41094:(e,t,n)=>{n.d(t,{Y:()=>i});var o=n(22083);class i extends o.G{constructor(e,t){super({type:"TrustedTypeError",code:e,prevError:t})}}},116230:(e,t,n)=>{function o(e){const t=e;return"string"==typeof(null==t?void 0:t.code)}n.d(t,{a:()=>o})},846275:(e,t,n)=>{n.d(t,{n:()=>ae});var o=n(71386),i=n(459767),a=n(836240),r=n(296154),s=n(786884),l=n(471285);class c{constructor(e,t){this.shellComms=e,this.globalWindow=t,this.defaultRequestTimeoutMs=3e4,this.bufferInTimeout=5e3}postMessage(e,t){const n={eventId:e,payload:t,correlationId:(0,r.v4)()};this.shellComms.postMessage(n)}requestMessage(e,t,n=this.defaultRequestTimeoutMs){let o;const i=(0,r.v4)(),a=((null==t?void 0:t.timeout)||n)+this.bufferInTimeout;return new Promise(((n,r)=>{const c=t=>{this.globalWindow.clearTimeout(o),t&&!t.error?n(t.payload):r((0,s.Tr)(l.w5.ShellService,l.jK.RemoteOperationFailed,"requestMessage",{eventName:e,error:t&&t.error,correlationId:i},"Received an error from IPC"))};o=this.globalWindow.setTimeout((()=>{this.shellComms.remove(e,c),r((0,s.Tr)(l.w5.ShellService,l.jK.TimedOut,"requestMessage",{eventName:e,correlationId:i}))}),a),this.shellComms.once(e,c,i);const d={eventId:e,correlationId:i,payload:t};this.shellComms.postMessage(d)}))}addEventListener(e,t,n){n&&n.once?this.shellComms.once(e,t):this.shellComms.on(e,t)}removeEventListener(e,t){t?this.shellComms.remove(e,t):this.shellComms.removeAll(e)}open(e,t,n){const o={openType:e,openHandler:t,handlerParams:n};this.postMessage("requestShellToOpen",o)}}class d{constructor(e,t,n){this._globalWindow=e,this.shellComms=t,this.envPerformance={getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}};const{isInCypressFrame:o,isInIframe:r}=n;let s=i.QP.standAlone;this.viewportContext=a.R.primary,r&&!o?(s=i.QP.iframe,this.viewportContext=a.R.iFrame):null!==this._globalWindow.opener&&(s=i.QP.secondary,this.viewportContext=a.R.secondary),this._hostedWindowContext=Object.assign(Object.assign({},n),{panelContext:s,startReason:i.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.opener=new c(this.shellComms,this._globalWindow)}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var u=n(298672),h=n(461525);var C=n(809868);class m{constructor(e,t){this.getObservableOn=e=>{const t=this.observableCache,n=t.get(e);if(n)return n;const o=new C.xQ;return t.set(e,o),o},this.next=e=>{this.logger.debug("Incoming message received. Filtering through cached observables.");const t=e.metaData.destination.channel,n=this.observableCache.get(t);n&&n.next(e)},this.error=e=>{const t=e.message?e.message:e;this.logger.error(`Internal Message Source emitted an error - {${t}}. Completing then clearing all observables from cache...`),this.completeAndClearCache()},this.complete=()=>{this.logger.debug("Internal Message Source completed. Completing then clearing all observables from cache..."),this.completeAndClearCache()},this.completeAndClearCache=()=>{this.observableCache.forEach((e=>e.complete())),this.observableCache.clear(),this.logger.debug("Cache cleared")},this.logger=t,this.observableCache=new Map,e.subscribe(this)}}const g="multi-window-manager-channel";var p=n(337036),E=n(74017),S=n(197981);const _=/^https:\/\/local\.teams\.(office|live)\.com(:8080)?$/;function v(e,t){return t.some((t=>{if(t.startsWith("regex:")){const n=t.replace("regex:","");return new RegExp(n).test(e)}return t===e}))}function T(e){return _.test(new URL(e).origin)}const f=(e,t,n,o)=>p.y.create((i=>{e.addEventListener("message",(e=>{const{eventId:a,channel:r}=e.data;e&&a&&r===g&&function(e,t,n){var o,i,a;const r=n.newLogger("PostMessage origin validation","services-io-browser-shell-message-passing-browser"),s=e.origin;return t?!("*"!==t&&!T(s)&&((0,S.isArray)(t)?0===t.length?(null===(o=r.errorToTelemetry)||void 0===o||o.call(r,"PostMessage is disabled for this experience. (case 5)","core_origin_validation_failed",{message:s},!0),1):!v(s,t)&&(null===(i=r.errorToTelemetry)||void 0===i||i.call(r,"Event origin is not in allow-list. Event was dropped. (case 4)","core_origin_validation_failed",{message:s},!0),1):(null===(a=r.errorToTelemetry)||void 0===a||a.call(r,"Could not match the event origin. Event was dropped. (case 6)","core_origin_validation_failed",{message:s},!0),1))):(r.debug("PostMessage is enabled for backwards compatibility. No postMessageConfig is set on this experience. https://aka.ms/tmp-post-message-config (case1 )"),!0)}(e,n.postMessageConfig,o)&&(t.debug("Incoming message from post messages"),i.next(e.data))}))})).pipe((0,E.B)());class I{constructor(e,t,n,o){this.opt=o,this.postMessage=e=>{var t,n;if((0,S.isArray)(this.opt.postMessageConfig)&&0===this.opt.postMessageConfig.length)return void(null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"postMessageConfig is set to empty array. No outgoing post messages are allowed","core_origin_validation_failed",void 0,!0));this.logger.log("Sending targeted message to host browser only");const o=null!==e.payload&&"object"==typeof e.payload?Object.assign({},e.payload):{payload:e.payload};this.windowReference.parent.postMessage({channel:g,payload:Object.assign(Object.assign({},o),{channel:e.channel})},((e,t,n)=>{const o=new URL(e.location.href).origin;let i;if(!t||"*"===t)return"*";if(e.document.referrer)try{i=new URL(e.document.referrer).origin}catch(t){n.error(`Invalid referrer: ${e.document.referrer}`)}return i?i===o||T(i)||v(i,t)?i:(n.error(`Invalid target origin (${i}). Source origin (${o}) was returned as target origin.`),o):(n.log(`Could not determine target origin. Falling back to source origin: ${o}`),o)})(this.windowReference,this.opt.postMessageConfig,this.logger))},this.broadcast=()=>{},this.asObservable=e=>this.shellChannelCache.getObservableOn(e).pipe((0,h.U)((e=>(e=>({channel:e.metaData.destination.channel,payload:e.payload}))(e)))),this.createShellChannelCache=(e,t,n,o)=>{t.debug("Creating Shell Channel cache");const i=f(e,t,n,o);return new m(i,t)},this.logger=n.newLogger("RndrShComm","services-io-browser-shell-message-passing-browser"),this.processId=e,this.windowReference=t,this.shellChannelCache=this.createShellChannelCache(this.windowReference,this.logger,this.opt,n)}}const R="main_process",w="main_renderer";var A;!function(e){e[e.Request=0]="Request",e[e.Response=1]="Response"}(A||(A={}));var B=n(721259),D=n(530260),M=n(708842),b=n(593761),P=n(432707),y=n(324127),L=n(532556),O=n(475781),k=n(135822);const U=5*n(862696).gT.MILLI_PER_SECOND;class N{constructor(e,t,n){this.createResponseFunction=(e,t,n)=>o=>{const i=this.messagePassingService,a={direction:A.Response,responsePayload:o,procedureSignature:n},r={channel:t,payload:a};this.logger.log(`Sending response with signature: ${n}`),i.postMessage(r,[e])};if(3!==arguments.length||e.trim().length<=0)throw(0,s.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof N);this.logger=n,this.messagePassingService=t,this.metaData={requestId:e}}send(e,t,n=U){const o=this.messagePassingService,i=this.metaData,a=o.processId,s=i.requestId,l=r.v4(),c=t?[t]:o.processId!==R?[R]:[w],d={channel:s,payload:{direction:A.Request,senderProcessId:a,procedureSignature:l,requestPayload:e}};this.logger.log(`Invoking procedure on ${t} with id, ${l}`);const u=(0,B.c)().pipe((0,b.x)((()=>o.postMessage(d,c)))),h=o.asObservable(s).pipe((0,P.h)((e=>e.payload.direction===A.Response)),(0,y.zg)((e=>{const t=e.payload;return t.procedureSignature===l?(0,D.of)(t.responsePayload):(0,B.c)()})));return(0,M.z)(u,h).pipe((0,L.P)(),(0,O.V)(n))}sendAsPromise(e,t,n=U){return this.logger.debug("Invoking procedure as promise"),new Promise(((o,i)=>{this.send(e,t,n).subscribe((e=>{o(e)}),(e=>{i(e)}))}))}asObservable(){const e=this.messagePassingService,t=this.metaData.requestId;return this.logger.debug("Retreiving observable on request-response procedure"),e.asObservable(t).pipe((0,P.h)((e=>e.payload.direction===A.Request)),(0,k.b)((e=>{this.logger.log(`Incoming request with signature - ${e.payload.procedureSignature}`)})),(0,h.U)((e=>{const n=e.payload,o=n.procedureSignature,i=n.requestPayload,a=n.senderProcessId;return{payload:i,respond:this.createResponseFunction(a,t,o)}})))}}var F=n(147382),W=n(803557),x=n(557435);class H{constructor(e,t,n){this.setState=e=>{const t=this.metaData,n={lastAuthorMetaData:t,newState:e};this.logger.debug(`Process, ${t.authorId}, is setting the state`),this.stateUpdateSource.next(n)},this.asObservable=()=>(this.logger.debug("Retreiving observable on the state"),this.distinctStateUpdates.pipe((0,h.U)((e=>e.newState)))),this.setupContinuousSyncronizationAcrossShellBoundary=()=>{const e=this.messagePassingService,t=this.metaData,n=this.logger,o=this.stateUpdateSource,i=this.distinctStateUpdates,a=t.storeId;i.pipe((0,P.h)((e=>e.lastAuthorMetaData.authorId===this.metaData.authorId)),(0,k.b)((()=>n.debug("Broadcasting state update")))).subscribe((t=>{const n={payload:t,channel:a};e.broadcast(n)})),e.asObservable(a).pipe((0,P.h)((e=>e.payload.lastAuthorMetaData.authorId!==t.authorId)),(0,k.b)((()=>n.log("State update incoming from message passing service")))).subscribe((e=>{o.next(e.payload)}))},this.setupInitialStateSynchronizationRequest=()=>{const e=this.metaData,t=this.distinctStateUpdates,n=this.messagePassingService,o=e.storeId,i=o.concat("-initial-sync-request");t.pipe((0,k.b)((()=>this.logger.debug("State updated. SwitchMapping to observable on incoming sync requests"))),(0,W.w)((()=>n.asObservable(i)),((e,t)=>{const n=t.payload.requesterMetaData.authorId;return{syncResponseMessage:{channel:o,payload:e},targetId:n}})),(0,k.b)((({targetId:e})=>this.logger.debug(`Incoming initial sync request from ${e}.`)))).subscribe((({syncResponseMessage:e,targetId:t})=>{n.postMessage(e,[t])}));const a={channel:i,payload:{requesterMetaData:e}};this.logger.debug("Sending out initial synchronization request..."),n.broadcast(a)};if(3!==arguments.length||e.trim().length<=0)throw(0,s.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof H);const o=t.processId;this.logger=n,this.messagePassingService=t,this.metaData={storeId:e,authorId:o};this.stateUpdateSource=new F.t(1),this.distinctStateUpdates=this.stateUpdateSource.pipe((0,x.x)(((e,t)=>(0,S.isEqual)(e,t)))),this.setupContinuousSyncronizationAcrossShellBoundary(),this.setupInitialStateSynchronizationRequest()}}class Y{constructor(e,t,n){if(3!==arguments.length||e.trim().length<=0)throw(0,s.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof Y);this.logger=n,this.messagePassingService=t,this.metaData={streamId:e}}next(e,...t){const n=this.metaData,o=this.messagePassingService,i=t&&t.length>0?t:this.messagePassingService.processId!==R?[R]:[w],a={channel:n.streamId,payload:e};this.logger.debug(`Invoking stream on targets: ${JSON.stringify(i)}.`),o.postMessage(a,i)}asObservable(){const e=this.messagePassingService,t=this.metaData.streamId;return e.asObservable(t).pipe((0,h.U)((e=>e.payload)),(0,k.b)((()=>{this.logger.debug("Handling stream event.")})))}}class V{constructor(e,t){if(this.getRequest=e=>new N(e,this.messagePassingService,this.loggerFactory.newLogger(`ShRqst${e}`,"services-io-browser-shell-communication-provider")),this.getStream=e=>new Y(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStrm${e}`,"services-io-browser-shell-communication-provider")),this.getStore=e=>new H(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStr${e}`,"services-io-browser-shell-communication-provider")),!e||!t)throw(0,s.Tr)(`sc: ${e}, lf: ${t}`,l.jK.Undefined,typeof V);this.messagePassingService=e,this.loggerFactory=t}}var K=n(729350),G=n(816195);class ${constructor(e,t){if(this.windowReference=e,this.opt=t,!this.windowReference)throw(0,s.Tr)(l.w5.ShellService,l.jK.Undefined,"constructor");const n={error:()=>{},warn:()=>{},debug:()=>{},info:()=>{},log:()=>{}},o={newLogger:()=>n},i=new I("browserWindow",this.windowReference,o,this.opt);this.shellComms=new V(i,o),this.subscriptionManager=new C.xQ}postMessage(e){this.shellComms.getStream(e.eventId).next(e)}on(e,t,n=""){this.createSubscription(e,t,!1,n)}once(e,t,n=""){this.createSubscription(e,t,!0,n)}remove(e,t){this.subscriptionManager.next({channel:e,listener:t})}removeAll(e){this.subscriptionManager.next({channel:e})}createSubscription(e,t,n,o){const i=this.shellComms.getStream(e).asObservable().pipe(this.filterWrapper((e=>{var t;const n=(null==e?void 0:e.correlationId)||(null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.correlationId);return!e||!n||n===o}))),a=this.registerForUnsubscription(e,t);(n?i.pipe((0,K.q)(1),(0,G.R)(a)):i.pipe((0,G.R)(a))).subscribe((e=>{t({payload:e})}),(e=>{throw(0,s.Tr)(l.w5.ShellService,l.jK.RemoteOperationFailed,"createSubscription",{errorMsg:(0,s.B9)(e)})}))}registerForUnsubscription(e,t){return this.subscriptionManager.pipe(this.filterWrapper((n=>n.channel===e&&(void 0===n.listener||n.listener===t))))}filterWrapper(e){return(0,P.h)(e)}}class z{constructor(e,t){this.globalWindow=e,this.opt=t}configureShell(e){const t=this.globalWindow,n=this.createShellCommService(this.globalWindow,this.opt),o=new d(this.globalWindow,n,e);return{hostedWindowContext:o.getHostedWindowContext(),window:(0,u.So)(t,o,!1)}}createShellCommService(e,t){return new $(e,t)}}class q{constructor(e,t,n,r){this.envPerformance=e,this._globalWindow=t,this.shellComms=n,this._hostedWindowContext=Object.assign(Object.assign({},r),{panelContext:i.QP.secondary,startReason:i.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.viewportContext=a.R.iFrame,this.opener=new c(n,this._globalWindow),this._globalWindow.addEventListener("unload",(()=>{this.shellComms.postMessage({eventId:o.W.WindowUnloaded})}))}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){const e={eventId:o.W.WindowAppStart};this.shellComms.postMessage(e)}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var j,X=n(295598);!function(e){e.WindowMinimize="child-window-minimize",e.WindowMaximize="child-window-maximize"}(j||(j={}));const Q="experience-renderer-channel";class J{constructor(e){this.ipcRenderer=e,this.onceListenerLookup={},this.listenerLookup={},this.ipcRenderer.on(Q,((e,t)=>{if(t&&t.eventId){const e=`${t.eventId}${t.correlationId||""}`;this.onceListenerLookup[e]?(this.onceListenerLookup[e].forEach((e=>e(t))),delete this.onceListenerLookup[e]):this.listenerLookup[e]&&this.listenerLookup[e].forEach((e=>{e(t)}))}}))}postMessage(e){switch(e.eventId){case X.rY.ActivityEvent:case X.rY.CreateWebview:case X.rY.GetWindowLaunchSubSteps:case X.rY.SetTouchBar:case X.rY.ClearTouchBar:case X.rY.ActivateOutlook:case X.rY.RequestTabMetrics:case X.rY.HasDevicePermissionsCallback:this.ipcRenderer.send(Q,e);break;case o.W.CoreInitialized:case X.rY.WindowInitialized:this.ipcRenderer.send(Q,e),this.ipcRenderer.sendToHost(Q,e);break;default:this.ipcRenderer.sendToHost(Q,e)}}on(e,t,n=""){const o=`${e}${n}`;this.listenerLookup[o]||(this.listenerLookup[o]=[]),this.listenerLookup[o].push(t)}once(e,t,n=""){const o=`${e}${n}`;this.onceListenerLookup[o]||(this.onceListenerLookup[o]=[]),this.onceListenerLookup[o].push(t)}remove(e,t){e&&t&&(this.onceListenerLookup[e]&&(this.onceListenerLookup[e]=this.onceListenerLookup[e].filter((e=>e!==t)),0===this.onceListenerLookup[e].length&&delete this.onceListenerLookup[e]),this.listenerLookup[e]&&(this.listenerLookup[e]=this.listenerLookup[e].filter((e=>e!==t)),0===this.listenerLookup[e].length&&delete this.listenerLookup[e]))}removeAll(e){delete this.onceListenerLookup[e],delete this.listenerLookup[e]}}class Z{constructor(e){this.windowHandle=e,this.ipcRenderer=this.windowHandle.desktop.ipcRenderer,this.webViewCommService=new J(this.ipcRenderer),this.browserShellCommService=new $(e,{})}postMessage(e){switch(e.eventId){case X.rY.ActivityEvent:case X.rY.CreateWebview:case X.rY.GetWindowLaunchSubSteps:case X.rY.SetTouchBar:case X.rY.ClearTouchBar:this.ipcRenderer.send(Q,e);break;case o.W.CoreInitialized:case X.rY.WindowInitialized:this.ipcRenderer.send(Q,e),this.browserShellCommService.postMessage(e);break;default:this.browserShellCommService.postMessage(e)}}on(e,t,n=""){this.webViewCommService.on(e,t,n),this.browserShellCommService.on(e,t,n)}once(e,t,n=""){this.webViewCommService.once(e,t,n),this.browserShellCommService.once(e,t,n)}remove(e,t){this.webViewCommService.remove(e,t),this.browserShellCommService.remove(e,t)}removeAll(e){this.webViewCommService.removeAll(e),this.browserShellCommService.removeAll(e)}}class ee{constructor(e){this.globalWindow=e}configureShell(e){const t=this.globalWindow,{isInIframe:n}=e,o=this.extractPerformanceTooling(t),i=n?new Z(t):new J(t.desktop.ipcRenderer),a=new q(o,t,i,e);return Object.keys(t.desktop).forEach((e=>{"perf"!==e&&delete t.desktop[e]})),{hostedWindowContext:a.getHostedWindowContext(),window:(0,u.So)(t,a,!1)}}extractPerformanceTooling(e){return e.desktop.perf||{getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}}}}var te=n(418566);class ne{constructor(e){this.windowEnvironment=e}configure(e){const t={isInCypressFrame:oe(this.windowEnvironment),isInIframe:ie(this.windowEnvironment)};t.isInIframe&&function(e){var t;if(e.navigator){if("Electron"===te.getParser(null===(t=e.navigator)||void 0===t?void 0:t.userAgent).getBrowserName())return!0}return!1}(this.windowEnvironment)&&function(e){var t;try{const n=e.parent;if(!n||!function(e){return!(!e||!e.electronSafeIpc)}(n))return;e.desktop={perf:null===(t=n.desktop)||void 0===t?void 0:t.perf,ipcRenderer:n.electronSafeIpc},e.createInterprocessStore=n.createInterprocessStore,e.vdiSettings=n.vdiSettings}catch(e){return}}(this.windowEnvironment);return(function(e){return!!(e&&e.desktop&&e.desktop.ipcRenderer)}(this.windowEnvironment)?new ee(this.windowEnvironment):new z(this.windowEnvironment,e)).configureShell(t)}}function oe(e){try{let t=!!e.Cypress;if(!t){const n=e.top||e.parent;t=!!(null==n?void 0:n.Cypress)}return t}catch(e){return!1}}function ie(e){try{return e.self!==e.top}catch(e){return!0}}class ae{constructor(){this._opt={};const e=new ne(window);this.config=e.configure(this._opt),this.config.window.opener.postMessage(o.W.WindowReady)}set opt(e){Object.keys(e).forEach((t=>{this._opt[t]=e[t]}))}static getInstance(){return ae.instance||(ae.instance=new ae),ae.instance}get window(){return this.config.window}}},812224:(e,t,n)=>{n.d(t,{t:()=>r});var o=n(361366),i=n(41094),a=n(157453);class r{constructor(e,t){this._document=e,this._chunkConfig=t,this._loadedItems=new Map,this._loadScript=(0,a.m)(((e,t)=>new Promise(((n,o)=>{if(!e)return n();const a=this._document.createElement("script");if(a.onload=()=>n(),a.onerror=o,a.async=!0,a.id=`${t}-script`,a.charset="utf-8",!this._coreSecurityService)throw new i.Y("DEVELOPER_ERROR",new Error("Chunkloader core security service is not defined. This should never happen"));try{const t=this._coreSecurityService.getTrustedTypePolicy("@msteams/services-utilities-common#ChunkLoader").createScriptURL(e,a.baseURI);a.src=t}catch(e){throw e}this._document.body.appendChild(a)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this._loadStyle=(0,a.m)(((e,t)=>new Promise(((n,o)=>{if(!e)return n();const i=this._document.createElement("link");i.onload=()=>n(),i.onerror=o,i.type="text/css",i.rel="stylesheet",i.id=`${t}-style`,i.charset="utf-8",i.href=e,this._document.head.appendChild(i)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this.loadChunk=(e,t=!1)=>(0,o.__awaiter)(this,void 0,void 0,(function*(){if(!this._chunkConfig)throw new Error("Chunk loading is not supported in this window or host.");const n=e.reduce(((e,n)=>{const o=this._chunkConfig&&this._chunkConfig[n];if(!o)return e.push(Promise.reject(new Error(`No chunk information found for ${o}.`))),e;const i=o.endsWith(".css")?this._loadStyle:this._loadScript,a=this._loadedItems.get(o)||i(o,n).catch((e=>{throw t&&this._loadedItems.delete(o),e}));return this._loadedItems.has(o)||this._loadedItems.set(o,a),e.push(a),e}),[]);yield Promise.all(n)}))}configureCoreSecurityService(e){if(this._coreSecurityService)throw new i.Y("DUPLICATE_POLICY_FOUND",new Error("ChunkLoader::coreSecurityService is already defined. Developer should not be calling configureCoreSecurityService multiple times in it's context"));e&&(this._coreSecurityService=e)}}},734400:(e,t,n)=>{function o(e){return e.ResizeObserver?e.ResizeObserver:function(t){const n=new Map;let o,i=!1;function a(){if(i||!n.size)return void(o=void 0);const r=[];n.forEach(((e,t)=>{const o=t.getBoundingClientRect();e.height!==o.height&&(n.set(t,o),r.push({target:t,contentRect:o}))})),r.length&&t(r),o=e.requestAnimationFrame(a)}return{observe(t){n.has(t)||(n.set(t,t.getBoundingClientRect()),o||(o=e.requestAnimationFrame(a)))},unobserve(e){n.has(e)&&n.delete(e)},disconnect(){n.clear(),o=void 0,i=!0}}}}n.d(t,{S:()=>o})},157453:(e,t,n)=>{n.d(t,{X:()=>c,m:()=>d});var o=n(361366),i=n(41094),a=n(804436),r=n(786884),s=n(471285),l=n(763785);const c=(e,t)=>(...n)=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){for(;;)try{return yield e(...n)}catch(e){yield t(e,...n)}})),d=(e,t)=>{const{maxRetries:n,retryWindow:c,backoffTime:d,shouldRetry:u}=t,h=e=>c-(Date.now()-e);return(...t)=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){const o=Date.now();let c=0,C=h(o);for(;c++<=n&&C>0;)try{return yield Promise.resolve(e.apply(e,t))}catch(e){if(e instanceof i.Y)throw e;const t=yield(0,a.tE)(e);if(u&&!u(t))throw t?(0,r.Tr)(t.context,t.code,t.subContext?t.subContext:"",t.reason,t.message,t.serverResponse):(0,r.Tr)("RetryWithBackoff",s.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${c}, RemainingTime: ${C}`);if(c>=n||h(o)<=0)break;yield(0,l._)(d),C=h(o)}throw(0,r.Tr)("RetryWithBackoff",s.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${c}, RemainingTime: ${C}`)}))}},862696:(e,t,n)=>{var o,i,a;n.d(t,{gT:()=>o,lP:()=>i,ej:()=>a}),function(e){e[e.Two=2]="Two",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.TWENTY_FOUR=24]="TWENTY_FOUR",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE",e[e.MILLISECONDS_PER_HOUR=36e5]="MILLISECONDS_PER_HOUR",e[e.MILLISECONDS_PER_DAY=864e5]="MILLISECONDS_PER_DAY"}(o||(o={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES=3]="DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES",e[e.DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW=3e4]="DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW",e[e.DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME=2e3]="DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=22e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=24e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT",e[e.DEFAULT_SKYPE_MAX_DELAY_TIME_MS=3e4]="DEFAULT_SKYPE_MAX_DELAY_TIME_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS=15e3]="DEFAULT_SKYPE_MAX_RETRY_DURATION_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_COUNT=3]="DEFAULT_SKYPE_MAX_RETRY_COUNT",e[e.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS=1e3]="DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS",e[e.DEFAULT_SKYPE_EXP_DELAY_FACTOR=2]="DEFAULT_SKYPE_EXP_DELAY_FACTOR"}(i||(i={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.AUTHZ_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation"}(a||(a={}))}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/835115-e03dbb92b80b05ba.js.map