(()=>{var __webpack_modules__={931473:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<link\n  rel="icon"\n  type="image/png"\n  href="[[staticsPath]]/hashedassets/favicon/prod/favicon-32x32-04b7d908.png"\n/>\n<link\n  rel="icon"\n  type="image/png"\n  href="[[staticsPath]]/hashedassets/favicon/prod/favicon-16x16-aedbfeac.png"\n/>\n<link\n  rel="icon"\n  type="image/png"\n  href="[[staticsPath]]/hashedassets/favicon/prod/favicon-96x96-6b9521ce.png"\n/>\n<link\n  rel="shortcut icon"\n  type="image/x-icon"\n  href="[[staticsPath]]/hashedassets/favicon/prod/favicon-34ed16c5.ico"\n/>';return __p}},346701:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)__p+="<style>\n  .preload-title-bar-trim {\n    ","mac"===osPlatform?__p+="\n    --preload-title-bar-background-color: rgb(98, 100, 167);\n    ":__p+="\n    --preload-title-bar-background-color: rgb(70, 71, 117);\n    ",__p+='\n\n    background-color: var(--preload-title-bar-background-color);\n    padding: .3rem .3rem 0 .3rem;\n    height: 4rem;\n    width: 100%;\n    position: fixed;\n    top: 0;\n    left: 0;\n    box-sizing: border-box;\n    -webkit-app-region: drag;\n    z-index: -20;\n  }\n\n  .preload-title-bar-trim * {\n    margin: 0;\n    padding: 0;\n    -webkit-margin-before: 0;\n    -webkit-margin-after: 0;\n    box-sizing: inherit;\n  }\n\n  .preload-title-bar {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    color: white;\n    position: relative;\n  }\n\n\n  /**\n   * Allows resizing around the edges of the title bar by creating a region that isn\'t draggable\n   * The \'top\' value must be greater than zero, otherwise when the app is maximized,\n   * you won\'t be able to click and drag the window from the very top\n   */\n  .preload-title-bar::before {\n    content: "";\n    top: .2rem;\n    position: absolute;\n    height: .2rem;\n    -webkit-app-region: no-drag;\n    width: 100%;\n    left: 0;\n  }\n\n  .preload-title-bar-text {\n    margin: auto;\n    text-align: center;\n    font-size: 1.4rem;\n    pointer-events: none;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  .preload-title-bar-buttons {\n    height: 4rem;\n    display: flex;\n    flex-basis: 0;\n    align-items: center;\n    position: absolute;\n    top: 0;\n    right: 0;\n    margin-top: -.3rem;\n    margin-right: -.3rem;\n  }\n\n  .preload-title-bar-button {\n    background-color: var(--preload-title-bar-background-color);\n    -webkit-app-region: no-drag;\n    user-select: none;\n    border: 0;\n    border-radius: 0;\n    cursor: pointer;\n    height: 100%;\n    width: 4rem;\n    outline: none;\n  }\n\n  .preload-title-bar-button>svg {\n    fill: white;\n    background-color: inherit;\n    width: 1.6rem;\n    height: 1.6rem;\n    display: block;\n    margin: auto;\n  }\n\n  .preload-title-bar-button-close-filled {\n    display: none;\n  }\n\n  .preload-title-bar-button-close-outline {\n    display: block;\n  }\n\n  .preload-title-bar-button:hover {\n    background-color: rgb(51, 52, 74);\n  }\n\n  .preload-title-bar-button-close:hover {\n    background-color: rgb(196, 49, 75);\n  }\n\n  .preload-title-bar-button-close:hover .preload-title-bar-button-close-filled {\n    display: block;\n  }\n\n  .preload-title-bar-button-close:hover .preload-title-bar-button-close-outline {\n    display: none;\n  }\n</style>\n<div class="preload-title-bar-trim">\n  <div id="preload-title-bar" class="preload-title-bar">\n    <span class="preload-title-bar-text" aria-hidden="true">Microsoft Teams</span>\n\n    ',"windows"===osPlatform&&(__p+='\n    <div class="preload-title-bar-buttons">\n      \x3c!-- TODO: Hook button up to minimize/maximize/collapse API --\x3e\n      <button class="preload-title-bar-button">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <path d="M10 16v-1h12v1H10z"></path>\n        </svg>\n      </button>\n      \x3c!-- TODO: Hook button up to minimize/maximize/collapse API --\x3e\n      <button class="preload-title-bar-button">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <path d="M10 10h12v12H10V10zm11 11V11H11v10h10z"></path>\n        </svg>\n      </button>\n      \x3c!-- TODO: toggle on when maximized --\x3e\n      \x3c!-- TODO: Hook button up to minimize/maximize/collapse API --\x3e\n      <button class="preload-title-bar-button" style="display:none;">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <path d="M11 9v2H9v12h12v-2h2V9H11zm9 13H10V12h10v10zm2-2h-1v-9h-9v-1h10v10z"></path>\n        </svg>\n      </button>\n      <button class="preload-title-bar-button preload-title-bar-button-close">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <g>\n            <path class="preload-title-bar-button-close-outline"\n              d="M16.707 16l4.243-4.243a.5.5 0 1 0-.707-.707L16 15.293l-4.243-4.243a.5.5 0 1 0-.707.707L15.293 16l-4.243 4.243a.5.5 0 1 0 .707.707L16 16.707l4.243 4.243a.498.498 0 0 0 .707 0 .5.5 0 0 0 0-.707L16.707 16z">\n            </path>\n            <path class="preload-title-bar-button-close-filled"\n              d="M17.414 16l3.89-3.89a1 1 0 1 0-1.415-1.413L16 14.586l-3.89-3.89a1 1 0 1 0-1.413 1.415L14.586 16l-3.89 3.89a1 1 0 1 0 1.415 1.413L16 17.414l3.89 3.89a.997.997 0 0 0 1.413 0 1 1 0 0 0 0-1.415L17.414 16z">\n            </path>\n          </g>\n        </svg>\n      </button>\n    </div>\n    '),__p+="\n  </div>\n</div>";return __p}},871177:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)0;return __p}},406364:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<style type="text/css" id="splash-styles">\n  /** Remove outline, when focusing splash screen, because it is not necessary to inform user about focus on that element. */\n  div[id="splash-screen"] {\n    outline: none;\n  }\n\n\n  /** Below styles are dedicated for the pre-loading wheel (before React loads) */\n  .ui.loader {\n    display: none;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    margin: 0;\n    text-align: center;\n    z-index: 1000;\n    -webkit-transform: translateX(-50%) translateY(-50%);\n    transform: translateX(-50%) translateY(-50%);\n  }\n\n  .ui.loader:before {\n    position: absolute;\n    content: "";\n    top: 0;\n    left: 50%;\n    width: 100%;\n    height: 100%;\n    border-radius: 500rem;\n    border: 0.2em solid rgba(0, 0, 0, 0.1);\n  }\n\n  .ui.loader:after {\n    position: absolute;\n    content: "";\n    top: 0;\n    left: 50%;\n    width: 100%;\n    height: 100%;\n    -webkit-animation: loader 0.6s linear;\n    animation: loader 0.6s linear;\n    -webkit-animation-iteration-count: infinite;\n    animation-iteration-count: infinite;\n    border-radius: 500rem;\n    border-color: #767676 transparent transparent;\n    border-style: solid;\n    border-width: 0.2em;\n    -webkit-box-shadow: 0 0 0 1px transparent;\n    box-shadow: 0 0 0 1px transparent;\n  }\n\n  @-webkit-keyframes loader {\n    from {\n      -webkit-transform: rotate(0);\n      transform: rotate(0);\n    }\n\n    to {\n      -webkit-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n\n  @keyframes loader {\n    from {\n      -webkit-transform: rotate(0);\n      transform: rotate(0);\n    }\n\n    to {\n      -webkit-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n\n  .ui.large.loader:after,\n  .ui.large.loader:before {\n    width: 3.42857143rem;\n    height: 3.42857143rem;\n    margin: 0 0 0 -1.71428571rem;\n  }\n\n  .ui.text.loader {\n    width: auto !important;\n    height: auto !important;\n    text-align: center;\n    font-style: normal;\n  }\n\n  .ui.loader.active,\n  .ui.loader.visible {\n    display: block;\n  }\n\n  .ui.loader.disabled,\n  .ui.loader.hidden {\n    display: none;\n  }\n\n  .ui.large.text.loader {\n    min-width: 3.42857143rem;\n    padding-top: 4.21428571rem;\n  }\n\n  @-webkit-keyframes fadeOut {\n    from {\n      opacity: 1;\n    }\n\n    to {\n      opacity: 0;\n    }\n  }\n\n  @keyframes fadeOut {\n    from {\n      opacity: 1;\n    }\n\n    to {\n      opacity: 0;\n    }\n  }\n\n  .ui.loader.fadeOut {\n    -webkit-animation: fadeOut 500ms linear;\n    animation: fadeOut 500ms linear;\n  }\n</style>';return __p}},874645:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)__p+='<div id="splash-screen" tabindex="-1" role="progressbar" aria-valuetext="Loading..."\nstyle="height: 100vh; overflow: hidden; -webkit-app-region: drag;">\n  \x3c!-- Inline styles below as once React loads, all of the below will be removed. --\x3e\n  <div style="height: calc(100% - 4rem);\n                -webkit-user-select: none;\n                background-color: transparent;">\n    ',titleBar&&(__p+='\n      <div style="height:4rem;background-color:#464775"></div>\n    '),__p+='\n    <div class="ui large active text loader">\n      <span id="splash-screen-label">Loading...</span>\n    </div>\n  </div>\n</div>\n';return __p}},706827:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj){if(__p+='<!DOCTYPE html>\n<html lang="en">\n<head data-config="'+(null==(__t=htmlWebpackPlugin.options.platformConfig)?"":__t)+'">\n  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />\n  <meta name="containerVer" content="'+(null==(__t=htmlWebpackPlugin.options.containerVer)?"":__t)+'" />\n  <script nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">'+(null==(__t=htmlWebpackPlugin.options.publicPathScript)?"":__t)+"<\/script>\n  "+(null==(__t=htmlWebpackPlugin.options.partials.devtools)?"":__t)+"\n  "+(null==(__t=htmlWebpackPlugin.options.partials.favicons)?"":__t)+"\n\n  ",htmlWebpackPlugin.options.isMainWindow&&(__p+='\n    <script type="text/javascript" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+"\">\n      __webpack_nonce__ = '"+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+"';\n      __VERSION__  = '"+(null==(__t=htmlWebpackPlugin.options.containerVer)?"":__t)+'\';\n      // TODO Remove the copy step once OnePlayer Loader supports dynamic importing. (https://onedrive.visualstudio.com/OMG/_workitems/edit/1170258)\n      onePlayerLoaderFullStaticPath = window.__webpack_public_path__;\n      function postExperienceStarted(message, errorCode) {\n        if (window.desktop && window.desktop.ipcRenderer) {\n          // Notifies the host of the experienceStarted event\n          window.desktop.ipcRenderer.sendToHost("experience-renderer-channel", {\n            eventId: "experienceStarted",\n            payload: {\n              message: message,\n              errorCode: errorCode,\n              errorDescription: errorCode && message\n            }\n          });\n        }\n      }\n\n      function experienceContainerPerfEntriesHandler(_ipcRendererEvent, event) {\n          if (event && event.eventId === "getExperienceContainerPerfEntries") {\n            if (window.desktop.ipcRenderer) {\n              // Notifies the host of the performance entries\n              window.desktop.ipcRenderer.sendToHost("experience-renderer-channel", {\n                eventId: "getExperienceContainerPerfEntries",\n                payload: {\n                  data: window.performance.getEntriesByType("resource")\n                }\n              });\n            }\n          }\n        }\n\n      function postPerformanceEntriesOnRequest() {\n        if(window.desktop && window.desktop.ipcRenderer && window.desktop.ipcRenderer.once) {\n          window.desktop.ipcRenderer.once("experience-renderer-channel",\n          experienceContainerPerfEntriesHandler);\n        }\n      }\n\n      function registerHandlersAndSetSource(id, src) {\n        const scriptEle = document.getElementById(id);\n        if (scriptEle && src) {\n          scriptEle.onload = function() {\n            postExperienceStarted(id + " loaded");\n          };\n          scriptEle.onerror = function() {\n            postExperienceStarted("Loading " + id + " failed. src=" + src, -1);\n          };\n\n          scriptEle.src = src;\n        }\n      }\n    <\/script>\n\n    <script nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n      performance.mark("execute-index-html-script");\n      postExperienceStarted("start");\n      postPerformanceEntriesOnRequest();\n    <\/script>\n\n    \x3c!-- TODO [#2218015]: [Debt][MW]: remove html.position=fixed once MW is fully react. --\x3e\n    <style>\n      html {\n        position: fixed;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n      }\n    </style>\n  '),__p+="\n\n   <style>\n    html,\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Web', sans-serif;\n      width: 100%;\n      height: 100%;\n      padding: 0;\n      margin: 0;\n    }\n\n    html {\n      font-size: calc(1em * .625);\n    }\n\n    body {\n      font-size: 1.4rem;\n      overflow: hidden;\n    }\n\n    /** Enable antialiasing and font smoothing across supporting browsers for all elements */\n    * {\n      -webkit-font-smoothing: antialiased;\n      -moz-osx-font-smoothing: grayscale;\n    }\n\n    /*!*Remove hidden ADAL iframes borders as to not cause unnecessary vertical scrolling*!*/\n    body > iframe[id^=\"adal\"] {\n      border: 0;\n    }\n  </style>\n\n  "+(null==(__t=void 0!==htmlWebpackPlugin.options.partials.splashStyles?htmlWebpackPlugin.options.partials.splashStyles:"")?"":__t)+"\n\n</head>\n\n<body ",htmlWebpackPlugin.options.isMainWindow?__p+='\n        id="main-window-body"\n      ':__p+='\n        id="child-window-body"\n      ',__p+="\n>\n\n",htmlWebpackPlugin.options.partials.preloadTitleBar&&(__p+="\n  "+(null==(__t=htmlWebpackPlugin.options.partials.preloadTitleBar)?"":__t)+"\n"),__p+="\n\n",htmlWebpackPlugin.options.partials.splash&&!htmlWebpackPlugin.options.isMainWindow?__p+='\n  <div style="display: none; height: inherit;" id="app"></div>\n  '+(null==(__t=htmlWebpackPlugin.options.partials.splash)?"":__t)+"\n":__p+='\n  <div style="height: inherit;" id="app"></div>\n',__p+='\n\n  <script id="initialize-bootstrap-data" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n    // Wrap in an IIFE to prevent leaking to the global scope\n    (function() {\n      function setInitialThemeColors() {\n        const theme = "'+(null==(__t=htmlWebpackPlugin.options.theme)?"":__t)+'" || "default";\n\n        const bodyStyle = document.body.style;\n        switch (theme) {\n          case "default":\n            bodyStyle.backgroundColor = "#F3F2F1";\n            bodyStyle.color = "#252424";\n            break;\n          case "dark":\n            bodyStyle.backgroundColor = "#201F1F";\n            bodyStyle.color = "#FFF";\n            break;\n          case "contrast":\n            bodyStyle.backgroundColor = "#000";\n            bodyStyle.color = "#FFF";\n            break;\n          case "defaultV2":\n          case "tfl-default":\n            bodyStyle.backgroundColor = "#F5F5F5";\n            bodyStyle.color = "#252424";\n            break;\n          case "darkV2":\n          case "tfl-dark":\n            bodyStyle.backgroundColor = "#1F1F1F";\n            bodyStyle.color = "#FFF";\n            break;\n        }\n      }\n\n      function setInitialWindowTitle() {\n        const isMainWindow = "'+(null==(__t=htmlWebpackPlugin.options.isMainWindow)?"":__t)+'";\n\n        if (isMainWindow) {\n          document.title = "";\n        } else {\n          document.title = "New Window | Microsoft Teams";\n        }\n      }\n\n      function focusSplashScreen() {\n        const splashScreen = document.getElementById("splash-screen");\n        if (splashScreen) {\n          splashScreen.focus();\n        }\n      }\n      ',htmlWebpackPlugin.options.shouldStubConsoleError&&(__p+="\n      /*\n       * Stub console error to prevent the console from leaking objects.\n       * See bug: 1911460.\n       */\n      function stubConsoleError() {\n        const originalConsoleError = console.error;\n\n        const sendConsoleErrorToHost = function (args) {\n          // Stop this after main is loaded successfully.\n          if (window.desktop && window.desktop.ipcRenderer) {\n            const errorDescription = message = args.toString();\n\n            // Notifies the host of the experienceStarted event\n            window.desktop.ipcRenderer.sendToHost(\"experience-renderer-channel\", {\n              eventId: \"experienceStarted\",\n              payload: {\n                message,\n                errorCode: \"consoleError\",\n                errorDescription\n              }\n            });\n          }\n        }\n\n        const getConsoleErrorArgs = function (...args) {\n          const newArgs = [];\n          args.forEach(arg => {\n            if (!arg || typeof arg === 'string') {\n              newArgs.push(arg);\n            } else if (typeof arg.stack === 'string') {\n              newArgs.push(arg.stack);\n            } else if (typeof arg.message === 'string') {\n              newArgs.push(arg.message);\n            } else {\n              newArgs.push(JSON.stringify(arg));\n            }\n          });\n          return newArgs;\n        };\n\n        window.consoleErrorFn = function(...args) {\n          const newArgs = getConsoleErrorArgs(args);\n          originalConsoleError(...newArgs);\n        };\n\n        console.error = function(...args) {\n          const newArgs = getConsoleErrorArgs(args);\n          sendConsoleErrorToHost(newArgs);\n          originalConsoleError(...newArgs);\n      }\n    }\n\n      stubConsoleError();\n\n      /*\n       * Force unhandledrejections to errors to be serialized to prevent object leaks.\n       * See bug: 1911460.\n       */\n      const handleError = e => {\n        console.error((e && e.reason) || e);\n        e && e.preventDefault && e.preventDefault();\n        return true;\n      };\n      window.addEventListener('unhandledrejection', handleError);\n      window.addEventListener('error', handleError);\n      "),__p+='\n\n      const isScriptError = e => !!(\n        e.filename?.indexOf("46156") > -1 ||\n        e.filename?.indexOf("48494") > -1 ||\n        e.filename?.indexOf("92891") > -1 ||\n        e.filename?.indexOf("main") > -1\n        );\n\n      // Add handler for errors that occur during script loading phase.\n      window.handleGlobalWindowError = e => {\n        if (isScriptError(e)) {\n          postExperienceStarted("script error: " + e.message + ";" + "filename: " + e.filename, "scriptError");\n        }\n        return true;\n      };\n      window.addEventListener(\'error\', window.handleGlobalWindowError);\n\n      setInitialThemeColors();\n      setInitialWindowTitle();\n      // focus splash screen in order to narrate loading message and title of the window\n      focusSplashScreen();\n    })();\n  <\/script>\n\n  \x3c!-- Only use custom inject logic if `inject: false` is set --\x3e\n  ',!htmlWebpackPlugin.options.inject&&htmlWebpackPlugin.files.js){var allEntryAssets=htmlWebpackPlugin.files.js.concat(htmlWebpackPlugin.files.css).map((e=>({id:e.split("/").pop().replace(/(-[0-9a-g]+)?\..+/,""),path:e})));for(var file of(__p+='\n    \x3c!-- Chunk loader configuration --\x3e\n    <script id="cache-chunks" type="application/javascript" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+"\">\n      window.__experienceWindowChunks__ = JSON.parse('"+(null==(__t=JSON.stringify(Object.fromEntries(allEntryAssets.map((e=>[e.id,e.path])))))?"":__t)+"');\n    <\/script>\n\n    \x3c!-- Include the javascript entries that are expliclity mentioned, in the order they are mentioned --\x3e\n    ",allEntryAssets)){var fileId=file.id,fileLocation=file.path,isGriffel=/griffel/.test(fileLocation);if(!isGriffel){var lazy=htmlWebpackPlugin.options.lazy,isLazy=lazy&&lazy.includes(fileId),isPolyfill=/polyfill/.test(fileId);isPolyfill?__p+='\n        <script nomodule id="'+(null==(__t=fileId)?"":__t)+'" src="'+(null==(__t=fileLocation)?"":__t)+'"><\/script>\n      ':isLazy||(__p+='\n        <script id="'+(null==(__t=fileId)?"":__t)+'"><\/script>\n        <script nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n          registerHandlersAndSetSource("'+(null==(__t=fileId)?"":__t)+'", "'+(null==(__t=fileLocation)?"":__t)+'");\n        <\/script>\n      '),__p+="\n    "}}__p+="\n  "}__p+='\n\n  <script type="application/javascript" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n    // This code is required to provide post message communication between hosted iframe and MWv2 experience.\n    (function() {\n      function proxyPostMessage(target, message, targetOrigin) {\n        if (targetOrigin && target && target.contentWindow) {\n          target.contentWindow.postMessage(message, targetOrigin);\n        } else {\n          console.log("either targetOrigin or target is invalid");\n        }\n      }\n      window.proxyPostMessage = proxyPostMessage;\n    })();\n  <\/script>\n</body>\n</html>\n\n'}return __p}},341696:(e,t,n)=>{"use strict";n.d(t,{qo:()=>b,I1:()=>h,wY:()=>S,d4:()=>y,Zm:()=>f});var i=n(361366);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"firstLoginInfoNS"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Web"}},{kind:"Field",name:{kind:"Name",value:"WebNorthStar"}},{kind:"Field",name:{kind:"Name",value:"CoachMarkSavedWeb"}},{kind:"Field",name:{kind:"Name",value:"PromptCards"}},{kind:"Field",name:{kind:"Name",value:"FreemiumFRE"}},{kind:"Field",name:{kind:"Name",value:"ios"}},{kind:"Field",name:{kind:"Name",value:"android"}},{kind:"Field",name:{kind:"Name",value:"wp"}},{kind:"Field",name:{kind:"Name",value:"electron"}},{kind:"Field",name:{kind:"Name",value:"maglev"}},{kind:"Field",name:{kind:"Name",value:"desktopHwa"}},{kind:"Field",name:{kind:"Name",value:"surfaceHub"}},{kind:"Field",name:{kind:"Name",value:"espFirstRunStarted"}},{kind:"Field",name:{kind:"Name",value:"espFirstRunCompleted"}},{kind:"Field",name:{kind:"Name",value:"unknown"}}]}}]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferencesForCategory"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferencesForCategory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformationValue"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"firstLoginInfoNS"}}]}}]}}]}}]}},...a.definitions]},r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsEspUserPreferenceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateUserPreferences"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserPreferences"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"firstLoginInfoNS"}}]}}]}}]}}]}},...a.definitions]};var s=n(65903);const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"activateEspTarget"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"surfaceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"targetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"selector"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activateEspTarget"},arguments:[{kind:"Argument",name:{kind:"Name",value:"surfaceId"},value:{kind:"Variable",name:{kind:"Name",value:"surfaceId"}}},{kind:"Argument",name:{kind:"Name",value:"targetId"},value:{kind:"Variable",name:{kind:"Name",value:"targetId"}}},{kind:"Argument",name:{kind:"Name",value:"selector"},value:{kind:"Variable",name:{kind:"Name",value:"selector"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}]}]}}]},c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsEspSurfaceUpdateEspSurfaceDisplayStatusMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isEspSurfaceShowing"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateEspSurfaceDisplayStatus"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isEspSurfaceShowing"},value:{kind:"Variable",name:{kind:"Name",value:"isEspSurfaceShowing"}}}]}]}}]};var d=n(804436),u=n(786884),m=n(471285),g=n(197981);const p="growth_growthplatform_start_esp_job",v="growth_growthplatform_esp_display_actions",h=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,a;try{const t=yield e.query({query:o,variables:{category:"firstLoginInformation"}});return"FirstLoginInformationValue"===(null===(n=t.data)||void 0===n?void 0:n.userPreferencesForCategory.__typename)?null===(i=t.data)||void 0===i?void 0:i.userPreferencesForCategory.firstLoginInformation:null}catch(e){return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,"First Login CDL Query failed",p),null}})),f=(e,t,n,a,l)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},a),{[t]:n.toISOString()});if(delete i.__typename,i){let e;for(e in i)null===i[e]&&delete i[e]}yield e.mutate({mutation:r,variables:{category:s.nV$.firstLoginInformation,value:JSON.stringify(i)},update:(e,t)=>{var n,i,a,r,s;if("UserPreferences"===(null===(i=null===(n=t.data)||void 0===n?void 0:n.updateUserPreferences)||void 0===i?void 0:i.__typename))try{e.writeQuery({query:o,variables:{category:"firstLoginInformation"},data:{userPreferencesForCategory:{firstLoginInformation:null===(r=null===(a=t.data)||void 0===a?void 0:a.updateUserPreferences)||void 0===r?void 0:r.firstLoginInformation,__typename:"FirstLoginInformationValue"}}})}catch(e){null===(s=l.errorToTelemetry)||void 0===s||s.call(l,"Error while updating cache after updating firstLoginInformation.",p)}}})})),y=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;try{yield e.mutate({mutation:c,variables:{isEspSurfaceShowing:t},fetchPolicy:"no-cache"})}catch(e){const t=S(e,"Failed to update esp display status.");return null===(i=n.errorToTelemetry)||void 0===i||i.call(n,t.join(" "),v),Promise.reject()}return Promise.resolve(void 0)})),b=(e,t,n,a="shell",o,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;try{yield e.mutate({mutation:l,variables:{surfaceId:n,targetId:a,selector:o,windowId:r},fetchPolicy:"no-cache"})}catch(e){const n=S(e,"Failed to activate ESP target component.");return null===(i=t.errorToTelemetry)||void 0===i||i.call(t,n.join(" "),v),Promise.reject()}return Promise.resolve(void 0)})),S=(e,t)=>{const n=[t];if(k(e)){const t=(0,d.E6)(e),i=(0,u.O$)(t,"innerError",void 0);(null==i?void 0:i.code)===m.jK.NotPresent&&n.push((0,u.B9)(i))}return n},k=e=>!!e&&!!(0,g.get)(e,"graphQLErrors")},538427:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"espState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"espState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"espState"}}]}}]}},...n(661696).J.definitions]}},296117:(e,t,n)=>{"use strict";n.d(t,{l8:()=>C,FC:()=>b});var i=n(574540),a=n(181939),o=n(809868),r=n(878563),s=n(54427),l=n(746195),c=n(47135),d=n(361874);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"activeCallsChangedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeCallsChangedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"calls"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"teamsCallId"}},{kind:"Field",name:{kind:"Name",value:"callInitiator"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"replyChainMessageId"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}}]}}]}}]}}]};var m=n(342116),g=n(816195),p=n(520850),v=n(557435),h=n(174792),f=n(197981);const[y,b]=(0,a.j)("ActiveCallsContext");function S(e){return null!=e}const k=new Map,w=(e,t,{data:n,error:i})=>{var a,o;if(i)return e.error(`Failed to receive data from activeCallsChangedEvent: ${i}`),t;const r=null===(a=null==n?void 0:n.activeCallsChangedEvent)||void 0===a?void 0:a.id;if(!r)return t;const s=((null===(o=null==n?void 0:n.activeCallsChangedEvent)||void 0===o?void 0:o.calls)||[]).filter(S),l=new Map(t);return 0===s.length?(e.log(`No more calls found in ${r}. Removing from active calls map`),l.delete(r),0===l.size?k:l):(e.log(`Updating key in map for conversation ${r}. Number of active calls: ${s.length}`),new Map(l.set(r,s.reduce(((e,t)=>t.messageId?e.set(t.messageId,t):e),new Map))))},C=({children:e})=>{const t=(0,d.x)(),n=(0,l.w)("ActiveCallsContextContainer"),{enableActiveCallsSubscription:a}=(0,s.NC)(c.J.Channels),b=(()=>{const e=i.useMemo((()=>new o.xQ),[]);return i.useEffect((()=>()=>{e.next(),e.complete()}),[e]),e})(),[S,C]=i.useMemo((()=>{const e=new r.X(k);if(!a)return[e,f.noop];const i=(0,m.G)(t.subscribe({query:u,fetchPolicy:"no-cache"})).pipe((0,g.R)(b),(0,p.R)(((e,t)=>w(n,e,t)),k),(0,v.x)(),(0,h.d)(1)).subscribe(e);return[e,()=>i.unsubscribe()]}),[t,a,n,b]);return i.useEffect((()=>C)),i.createElement(y,{source$:S,children:e})}},318704:(e,t,n)=>{"use strict";n.d(t,{t:()=>a,j:()=>o});var i=n(82566);const a=()=>Promise.all([n.e(410202),n.e(129408),n.e(662738),n.e(639036),n.e(540028),n.e(561167),n.e(942475)]).then(n.bind(n,172830)),o=()=>(0,i.mT)(a,"search-answer")},564453:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"recordAppUsage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recordAppUsage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appsUsageFields"}}]}}]}},...n(955677).o.definitions]}},52954:(e,t,n)=>{"use strict";n.d(t,{vb:()=>o,c6:()=>r});var i=n(574540);const a=i.createContext(""),o=i.memo((e=>{const{children:t,joinId:n}=e;return i.createElement(a.Provider,{value:n},t)})),r=()=>i.useContext(a);o.displayName="JoinContext"},604572:(e,t,n)=>{"use strict";n.d(t,{l:()=>u,S:()=>r});var i=n(860125),a=n(859741),o=n(678058);function r(e,t){(0,i.addHook)("uponSanitizeElement",l),(0,i.addHook)("uponSanitizeElement",s),t&&(0,i.addHook)("uponSanitizeElement",c);const n=(0,i.sanitize)(e,{ALLOWED_TAGS:[]});return(0,i.removeHooks)("uponSanitizeElement"),n}function s(e){"BR"===e.tagName&&e.replaceWith(" ")}function l(e){"BLOCKQUOTE"===e.tagName&&e.remove()}function c(e){var t;if("IMG"!==e.tagName)return;const n=null!==(t=e.getAttribute("src"))&&void 0!==t?t:"";if((e=>!!e&&e.split("giphy.com").length>1)(n))return void e.replaceWith("📷 GIF");const i=e.getAttribute("alt");if(!i)return;(function(e){return e===o.T.emoji}(e.getAttribute("itemtype"))||function(e,t){return e===d&&(null==t?void 0:t.startsWith(a.rW))}(e.className,n))&&e.replaceWith(i)}const d="emojione";function u(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}},92836:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"controllerConnectedServicesEnabled"}},{kind:"Field",name:{kind:"Name",value:"readReceiptsEnabled"}}]}}]}}]}},108353:(e,t,n)=>{"use strict";n.d(t,{i1:()=>i,t3:()=>s,tT:()=>l,BN:()=>c,vc:()=>d});var i,a=n(54427),o=n(47135),r=n(60746);function s(e){const{allowUserChat:t,messagingPolicy:n}=e;return"boolean"==typeof t||!!n?t?i.Enabled:i.Disabled:i.Unknown}function l(){const e=(0,a.NC)(o.J.Messaging);return e.enableComposeDisabledBasedOnPolicy?s(e):i.Enabled}function c(e){const t=l();return e===r.k2.Meeting||e===r.k2.Channel?i.Enabled:t}function d(e,t){const n=c(e),{enablePinMessageToChat:r}=(0,a.NC)(o.J.Messaging);return t&&!!r&&n!==i.Disabled}!function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.Unknown="Unknown"}(i||(i={}))},339244:(e,t,n)=>{"use strict";n.d(t,{qK:()=>o,F2:()=>r,$i:()=>s,Xk:()=>l});const i="communities-selected-id",a="current-enitity-type",o=()=>localStorage.getItem(i),r=()=>localStorage.getItem("communities-selected-reply-id"),s=()=>localStorage.getItem(a),l=()=>localStorage.removeItem(a)},972687:(e,t,n)=>{"use strict";n.d(t,{Id:()=>a,yx:()=>r,Cs:()=>s});var i=n(574540);const a={isCallModeStreaming:()=>!1,isFullScreenButtonDisabled:()=>!1,isInEmbedContext:()=>!1,isTestUser:()=>!1,getCallId:()=>{},getCorrelationId:()=>"",getForceAttendeeStreaming:()=>{},getEnablePlayerControlsForStreamingMode:()=>{},getParticipantId:()=>{},getStreamDetails:()=>{},getStreamingMode:()=>!1,getTelemetryData:()=>{},getThreadId:()=>"",getUiLanguagePreference:()=>{},getCallMode:()=>{},getMeetingRole:()=>{},setFullScreenButton:()=>{},setStreamDetails:()=>{},sendConveneError:()=>{},sendDataLoadError:()=>{},sendHeartbeat:()=>{},sendMetadata:()=>{},sendData:()=>{},sendServerError:()=>{},createBroadcastEndEventListener:()=>{},createCallDataUpdateEventListener:()=>{},createStreamUpdateEventListener:()=>{},createCaptionsToggleEventListener:()=>{},destroyCaptionsToggleEventListener:()=>{},createSubtitleTrackChangeEventListener:()=>{},destroySubtitleTrackChangeEventListener:()=>{},destroyBroadcastEndEventListener:()=>{},destroyCallDataUpdateEventListener:()=>{},destroyStreamUpdateEventListener:()=>{},sendReadyToRecieveBroadcastEndNotification:()=>{},sendReadyToRecieveCallDataUpdateNotification:()=>{},sendReadyToRecieveStreamUpdatesNotification:()=>{},validateEmbedStreamDetailsArray:()=>({isSuccessful:!0})},o=i.createContext(null),r=i.memo((e=>{const{conveneHostMessaging:t,children:n}=e,r={conveneHostMessaging:t||Object.assign({},a)};return i.createElement(o.Provider,{value:r},n)}));r.displayName="ConveneHostMessagingContextProvider";const s=()=>i.useContext(o)},541704:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});class i{constructor(){this.registerAppPhase=({phase:e,signals:t,timeout:n})=>{const i=this._phasesMap.get(e);this._phasesMap.set(e,Object.assign(Object.assign({},i),{signals:t,timeout:n}))},this._phasesMap=new Map}get appPhases(){return{phases:this._phasesMap}}}},440429:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});const i=e=>t=>t.reduce(((t,n)=>(t[n]=e[n],t)),{})},468578:(e,t,n)=>{"use strict";n.d(t,{FU:()=>i,ZG:()=>o});var i,a=n(794781);!function(e){e.DEFAULT="default",e.HEADER_AT_BOTTOM="header_at_bottom",e.HYER="hyer"}(i||(i={}));class o{constructor({layoutKey:e=i.DEFAULT,layoutMode:t,layoutTemplatesPerLayoutMode:n}){var o;this.getTemplate=({layoutKey:e=i.DEFAULT,layoutMode:t,slots:n,slotsDimensionsOverrides:a={}})=>{const o=this._layoutTemplates[t][this._getKeyFromSlotNameArray(e,n)];return"function"==typeof o?o(a):o},this._getKeyFromSlotNameArray=(e=i.DEFAULT,t)=>[e,...[...t].sort()].join("-"),this._layoutTemplates={[a.lO.focus]:{},[a.lO.minimal]:{},[a.lO.standard]:{},[a.lO.minimode]:{}},null===(o=n[t])||void 0===o||o.forEach((n=>{(n.layoutKey||i.DEFAULT)===e&&this._registerTemplates(Object.assign({layoutMode:t},n))}))}_registerTemplates({layoutKey:e=i.DEFAULT,layoutMode:t,responsiveTemplates:n,slots:a}){const o=this._getKeyFromSlotNameArray(e,a);if(void 0!==this._layoutTemplates[t][o])throw new Error(`You can't have two templates with same slots for same layoutMode, slots: ${o} layoutMode: ${t}`);this._layoutTemplates[t][o]="function"==typeof n?n:()=>n}}},245353:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var i,a=n(361366),o=n(980477),r=n(574540),s=n(166439),l=n(786884),c=n(471285),d=n(82566),u=n(343324);null===(i=null===performance||void 0===performance?void 0:performance.mark)||void 0===i||i.call(performance,"resolve-main-imports-end");const m=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(899405),n.e(907784),n.e(838608),n.e(553211),n.e(714133),n.e(92700),n.e(598731),n.e(10143),n.e(529544),n.e(356833),n.e(709528),n.e(418676),n.e(301920),n.e(921132),n.e(886258),n.e(991883),n.e(433409),n.e(699772),n.e(185097),n.e(802054)]).then(n.bind(n,747806));class g{constructor(e){this._activationOptions=e,this._mounted=!1,this._logger=this._activationOptions.coreServices.loggerFactory.newLogger("CoreReactRenderer","components-core-layout")}activate(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){this.deactivate();try{return this._activateRoot()}catch(e){const t=(0,l.Tr)("Experience",c.jK.Undefined,"activate",e);return this._logger.errorToTelemetry&&this._logger.errorToTelemetry(t.message,"webclient_framework_foundation_components_core_react_renderer",void 0,!0),this._activationOptions.coreServices.errorState.error=t,Promise.reject(t)}}))}deactivate(){this._mounted&&(o.unmountComponentAtNode(this._activationOptions.rootElement),this._mounted=!1)}_activateRoot(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{window:t,rootElement:n,coreServices:{altScenarioService:i,scenarioFactory:a}}=this._activationOptions,{RootRenderer:l}=yield(0,d.mT)(m,"core-essentials",a);return null===(e=null==i?void 0:i.altScenario)||void 0===e||e.mark(u.ck.CoreEssentialsChunkLoad),new Promise((e=>{o.render(r.createElement(l,Object.assign({},this._activationOptions)),n,(()=>{this._mounted=!0,t&&(0,s.rx)(t.document,n),e()}))}))}))}}},129756:(e,t,n)=>{"use strict";n.d(t,{L:()=>l});var i=n(874645),a=n(406364),o=n(931473),r=n(346701),s=n(871177);const l={splashStyles:a,favicons:o,splash:i,preloadTitleBar:r,devtools:s}},166439:(e,t,n)=>{"use strict";n.d(t,{rx:()=>i});const i=(e,t)=>{((e,t)=>{const n=e.getElementById("splash-screen");n&&(n.setAttribute("aria-hidden","true"),e.body.removeChild(n),t&&(t.style.display="block"))})(e,t),(e=>{const t=e.getElementsByClassName("preload-title-bar-trim")[0];t&&e.body.removeChild(t)})(e)}},955118:(e,t,n)=>{"use strict";n.d(t,{o:()=>f});var i=n(361366),a=n(47135),o=n(82566),r=n(802788),s=n(245353),l=n(574540),c=n(980477),d=n(763785),u=n(749876);const m=()=>l.createElement(u.e,{client:{}},l.createElement("div",null));class g extends l.PureComponent{constructor(){super(...arguments),this.divRef=l.createRef(),this.siblingEl=l.createRef()}componentDidMount(){const{document:e}=this.props.mainWindow,t=e.createElement("div");this.divRef.current&&(this.divRef.current.appendChild(t),t.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0,relatedTarget:this.siblingEl.current})))}render(){return l.createElement("div",{ref:this.divRef},l.createElement("div",{ref:this.siblingEl,onMouseEnter:()=>{}}))}}class p extends l.PureComponent{constructor(){super(...arguments),this.state={mounted:!1}}componentDidMount(){this.setState({mounted:!0})}render(){return l.createElement("div",null)}}const v=e=>{(e=>{e.document.body.dispatchEvent(new MouseEvent("click",{bubbles:!0}))})(e)};var h=n(343324);const f=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const o=yield y(t);return e.pipe((0,r.j)((({id:e,window:i,context$:a})=>((e,t,n,i,a,o)=>{if(!e)return null;const r=e.document.getElementById("app");if(!r){const e=a.loggerFactory.newLogger("entry","components-core-layout");return e.errorToTelemetry&&e.errorToTelemetry("element with ID 'app' not found on the document.","webclient_framework_foundation_components_render_windows",void 0,!0),null}a.scenarioFactory.startStep(h.RG.ExperienceReady,h.ck.RenderProviders);const l=new s.Z({context$:t,coreServices:a,getExperienceProps:n,reactDiagnosticsService:o,rootElement:r,windowId:i,window:e});return l.activate(),{coreRenderer:l,host:e,windowId:i}})(i,a,n,e,t,o)),(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!e)return;const{host:n,coreRenderer:o,windowId:r}=e;v(n),o.deactivate();const s=t.windowProvider;yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.document,n=t.body,i=t.createElement("div");i.setAttribute("id","memory-cleanup");const a=n.appendChild(i);yield(0,d._)(0),c.render(l.createElement(l.Fragment,null,l.createElement(m,null),l.createElement(g,{mainWindow:e}),l.createElement(p,null)),a),c.unmountComponentAtNode(a),n.removeChild(a)})))(s);const{dataCleanupService:u,dataEvictionService:h,coreSettings:f}=t;u.markDataForWindowAsInactive(r);const{enableSingleApolloCoreCache:y}=f.get(a.J.Core);y&&(null==h||h.evict())}))),(({id:e})=>e))).subscribe()})),y=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{enableReactDiagnostics:t,enableReactDiagnosticsConsoleLog:i,enableReactDiagnosticsDisplayNameFix:r}=e.coreSettings.get(a.J.Diagnostics);if(t)try{const{initReactDiagnostics:t,ReactDiagnosticsService:a}=yield(0,o.mT)((()=>Promise.all([n.e(13753),n.e(991883),n.e(582271)]).then(n.bind(n,698936))),"react-diagnostics",e.scenarioFactory),s=new a(!!i,!!r);return t(s),s}catch(t){const n=e.loggerFactory.newLogger("react-diagnostics","components-core-layout");n.errorToTelemetry&&n.errorToTelemetry(`Failed to load react-diagnostic ${t}`,"webclient_framework_foundation_components_render_windows",void 0,!0)}}))},270184:(e,t,n)=>{"use strict";n.d(t,{uH:()=>a,lS:()=>o,qi:()=>r});var i=n(65903);const a=e=>"com.microsoft.teams.callable-channel"===e||"com.microsoft.teamspace.tab.file.staticviewer.pdf"===e||"44263ed4-f1ac-4e96-93aa-d24dd50459ea"===e||"com.microsoft.teamspace.tab.web"===e,o=(e,t,n)=>{if(n){const{correlationId:a,installationScope:o,tabConfigurationData:r,threadId:s,teamId:l,isEduContext:c,isTmpLaunch:d}=n;switch(o){case i.qi6.Team:return t.platform.inContextStorePostInstall({appId:e,teamId:l,correlationId:a,isEduContext:c,isTmpLaunch:d,tabConfigurationData:r,channelId:s,name:"openTabInstanceConfigDialogForChannel",inContextStoreLaunchOptions:n});case i.qi6.GroupChat:return t.platform.inContextStorePostInstall({appId:e,correlationId:a,tabConfigurationData:r,isTmpLaunch:d,chatId:s,name:"openTabInstanceConfigDialogForChat",inContextStoreLaunchOptions:n})}}return Promise.resolve()},r=e=>"Student"===e||"Teacher"===e},623409:(e,t,n)=>{"use strict";n.d(t,{pQ:()=>d,ei:()=>u,JW:()=>m,Pq:()=>g,PO:()=>p,ox:()=>v,Jj:()=>h});var i=n(759704),a=n(794781),o=n(561776),r=n(938557),s=n(412229),l=n(343324);const c="_djb2_msteams_prefix_",d="tab::",u=2,m=(e,t)=>(null==t?void 0:t.startsWith(c))?t:`${c}${(0,s.E)(`${e}:${null==t?void 0:t.replace(/\+/g," ")}`)}`,g=(e,t,n,s,l,c,d,u,m,g)=>{var p,v;return{entity:{type:i.p.extensions,id:JSON.stringify({appId:e,tabEntityId:c,subEntityId:u}),action:i.u.view},command:{visibilityState:null!==(p=null==d?void 0:d.visibilityState)&&void 0!==p?p:a.fe.show,stateTransition:t?a.su.new:null!==(v=null==d?void 0:d.stateTransition)&&void 0!==v?v:a.su.flush,correlation:{source:null!=l?l:o.D.Unknown,startTimestamp:Date.now()}},entityOptions:{entryPoint:s?r.mQ.activityFeed:r.mQ.personalApp,isMultiWindow:t,subEntityId:u,isAppSelected:m,source:l,deeplinkStartedTime:g?Date.now():void 0,originalDeeplink:g||void 0,reloadTrigger:n,isFromActivityFeed:s}}},p=(e,t,n,s,l,c,d)=>{var u,g;return{entity:{type:i.p.extensions,id:JSON.stringify({appId:t,threadId:n||s,tabId:null,tabEntityId:m(t,l)}),action:i.u.view,linkedEntity:{id:n?JSON.stringify({channelId:n}):s,type:n?i.p.channels:i.p.chats,action:i.u.view}},command:{visibilityState:null!==(u=null==c?void 0:c.visibilityState)&&void 0!==u?u:a.fe.show,stateTransition:null!==(g=null==c?void 0:c.stateTransition)&&void 0!==g?g:a.su.forceFlush,correlation:{source:o.D.PlatformTabDeepLink,startTimestamp:Date.now()}},entityOptions:{entryPoint:n?r.mQ.channelTab:r.mQ.chatTab,source:o.D.PlatformTabDeepLink,subEntityId:d,deeplinkStartedTime:Date.now(),originalDeeplink:e}}},v={files:"files",photos:"photos",attendancereport:"attendancereport",recordingsandtranscripts:"recordingsandtranscripts",recap:"recap",breakoutrooms:"breakoutrooms"},h=(e,t,n,s,c,d,u)=>{var m,g;null===(m=null==u?void 0:u.findScenario(l.RG.PlatformTabDeeplinkHandling))||void 0===m||m.cancel();const p=null==u?void 0:u.newScenario(l.RG.PlatformTabDeeplinkHandling);p&&(null===(g=null==u?void 0:u.hoistScenarioToCore)||void 0===g||g.call(u,p)),null==p||p.appendEventData({"PlatformTabDeeplink.pathname":n.pathname,"PlatformTabDeeplink.search":n.search}),null==p||p.mark("create_deeplink_command");const h="files"===d,f=(e=>{switch(e){case v.files:return i.p.file;case v.photos:return i.p.gallery;case v.attendancereport:return i.p.meetinganalytics;case v.recordingsandtranscripts:return i.p.transcriptcontent;case v.recap:return i.p.meetingrecap;case v.breakoutrooms:return i.p.breakoutrooms;default:return i.p.extensions}})(d),y={entityCommand:{entity:{type:f,action:h?i.u.list:i.u.view,id:f===i.p.extensions?JSON.stringify({appId:null,threadId:e||t,tabId:d,tabEntityId:null}):null,linkedEntity:{id:e?JSON.stringify({channelId:e}):t,type:e?i.p.channels:i.p.chats,action:i.u.view}},command:{stateTransition:a.su.forceFlush,visibilityState:a.fe.show},entityOptions:{subEntityId:null==c?void 0:c.subEntityId,entryPoint:e?r.mQ.channelTab:r.mQ.chatTab,source:o.D.PlatformTabDeepLink,deeplinkStartedTime:Date.now(),originalDeeplink:n}},metadata:{allowAnonymous:!1,tenantId:s}};return null==p||p.mark("return_deeplink_command"),null==p||p.appendEventData({"PlatformTabDeeplink.generatedCommand":y.toString()}),Promise.resolve(y)}},714385:(e,t,n)=>{"use strict";n.d(t,{W8:()=>i,xT:()=>a,fk:()=>o});const i=e=>{const{removeUrl:t,contentUrl:n,websiteUrl:i,entityId:a,baseInfo:o}=e||{};return{removeUrl:t||void 0,contentUrl:n||"",websiteUrl:i||void 0,entityId:a||void 0,suggestedDisplayName:(null==o?void 0:o.displayName)||void 0}},a=(e,t,n)=>{var i,a,o,r;const s=e=>e&&String(e);let l;return l=n?{contentUrl:s(e.contentUrl)||(null==t?void 0:t.contentUrl)||"",websiteUrl:null!==(i=s(e.websiteUrl))&&void 0!==i?i:null==t?void 0:t.websiteUrl}:{contentUrl:s(e.contentUrl)||(null==t?void 0:t.contentUrl)||"",removeUrl:null!==(a=s(e.removeUrl))&&void 0!==a?a:null==t?void 0:t.removeUrl,websiteUrl:null!==(o=s(e.websiteUrl))&&void 0!==o?o:null==t?void 0:t.websiteUrl,entityId:null!==(r=s(e.entityId))&&void 0!==r?r:null==t?void 0:t.entityId,suggestedDisplayName:s(e.suggestedDisplayName)||(null==t?void 0:t.suggestedDisplayName)},l},o=(e,t,n,i,a,o)=>{if(n)return e.log("app is not supported because appId not found in the current thread"),n;const r=null==i?void 0:i.includes(t);if(r)return e.log("app is not supported because appId is found in the disabledTabAppIds blocklist"),r;if(t&&a){const n=a.includes(t);if(o){if(!n)return e.log("app is not supported because appId is not present in the appIdlist whitelist"),!n}else if(n)return e.log("app is not supported because appId is  present in the appIdlist blocklist"),n}return!1}},726988:(e,t,n)=>{"use strict";n.d(t,{r:()=>f,P:()=>h});var i=n(574540),a=n(54427),o=n(47135),r=n(361874);const s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchEntity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contentSources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"contentSource"}}]}},{kind:"Field",name:{kind:"Name",value:"entityType"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"contentSource"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchContentSource"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}.definitions]},l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"refiner"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchRefiner"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"layout"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"layout"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"layout"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RefinerLayout"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"fieldName"}},{kind:"Field",name:{kind:"Name",value:"displayInterface"}}]}}]}.definitions]},c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FetchSearchPrefetchConfigs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchPrefetchConfigs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"verticals"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"searchVerticalConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"ecsSettings"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"searchVerticalConfig"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchVerticalConfig"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"queryTemplate"}},{kind:"Field",name:{kind:"Name",value:"entities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entity"}}]}},{kind:"Field",name:{kind:"Name",value:"refiners"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"refiner"}}]}}]}},...s.definitions,...l.definitions]}.definitions]};var d=n(350478),u=n(515079),m=n(343324),g=n(307831);const p=i.createContext({verticals:[],isInitialized:!1}),v={verticals:[],ecsSettings:{},isInitialized:!1},h=()=>i.useContext(p),f=i.memo((e=>{const{enableCustomVerticals:t}=(0,a.NC)(o.J.Serp),{scenarioFactory:n}=(0,d.SE)(),s=(0,r.x)(),[l,h]=i.useState(v),f=(0,g.WD)(u.nh.POST_CRITICAL),y=i.useCallback((()=>{const e=n.newScenario(m.RG.CustomSearchPreFetch,{startTime:Date.now()});s.query({query:c,fetchPolicy:"cache-first"}).then((t=>{var n;const i=null===(n=t.data)||void 0===n?void 0:n.searchPrefetchConfigs,a=Object.assign({},v);i&&(a.verticals=i.verticals,i.ecsSettings&&(a.ecsSettings=i.ecsSettings)),h((()=>Object.assign(Object.assign({},a),{isInitialized:!0}))),null==e||e.stop()}))}),[s,n]);f&&t&&!l.isInitialized&&y();const b=i.useMemo((()=>({verticals:l.verticals,ecsSettings:l.ecsSettings,isInitialized:l.isInitialized})),[l]);return t?i.createElement(p.Provider,{value:b},e.children):i.createElement(i.Fragment,null,e.children)}))},517544:(e,t,n)=>{"use strict";n.d(t,{fd:()=>l,zt:()=>c,R3:()=>d});var i=n(47135),a=n(864355),o=n(270184),r=n(343324),s=n(938557);const l=(e,t)=>t?`${e};replyChainId=${t}`:e,c=(e,t,n,a)=>{const{licenseType:r}=e.get(i.J.UserResources),{enableStageviewMW:l,enableStageviewMWInChannels:c,enableCollabStageForEDU:d}=e.get(i.J.Extensibility),u=t===s.E4.desktop;return!(!d&&(0,o.qi)(r)||!u)&&(l&&!c?"chats"===n.type&&!a:!!c&&("chats"===n.type||"channels"===n.type))},d=(e,t,n,i,o)=>{var s,l;const c=u(i),d=e.newScenario(c),m=e.newScenario(r.RG.PlatformTabLaunch);return d.appendEventData({"App.Id":n,"Thread.Id":t,"PlatformApp.ScenarioCapability":a.Ky.tabs,"App.EntryPoint":i,"App.Scope":o}),m.appendEventData({"App.Id":n,"Thread.Id":t,"App.EntryPoint":i,"App.Scope":o}),d.clientId=d.id,m.clientId=m.id,null===(s=e.hoistScenarioToCore)||void 0===s||s.call(e,d),null===(l=e.hoistScenarioToCore)||void 0===l||l.call(e,m),{phase1CollabStageScenario:d,endToEndScenario:m}},u=e=>{switch(e){case s.mQ.adaptiveCardStageModal:case s.mQ.deepLinkStageModal:case s.mQ.sdk:return r.RG.PlatformTabStageModalLaunch;case s.mQ.adaptiveCardCollabStage:default:return r.RG.PlatformTabCollabStageLaunch}}},814740:(e,t,n)=>{"use strict";var i;n.d(t,{X:()=>i,G:()=>a}),function(e){e.CreateTeam="CreateTeam",e.JoinTeam="JoinTeam",e.JoinTeamByCode="JoinTeamByCode",e.AddMember="AddMember",e.AddChannel="AddChannel",e.MarkAllChannelsAsRead="MarkAllChannelsAsRead",e.ManageTeamsList="ManageTeamsList",e.ManageTeamsInvites="ManageTeamsInvites",e.CrossTeamAnalytics="CrossTeamAnalytics"}(i||(i={}));const a={forceSync:!1}},540110:(e,t,n)=>{"use strict";n.d(t,{g$:()=>c,jd:()=>d,pt:()=>m,GZ:()=>g,Dk:()=>p});var i=n(65903),a=n(471285),o=n(786884),r=n(768187),s=n(561776),l=n(814740);const c=(e,t)=>{var n,a;return e.isGeneral?t!==i.S1B.OwnersPost||e.memberRole===i.k_p.Admin:e.memberRole===i.k_p.Admin||e.isModerator||(null===(n=e.channelSettings)||void 0===n?void 0:n.channelPostPermissions)===i.XIP.Everyone||(null===(a=e.channelSettings)||void 0===a?void 0:a.channelPostPermissions)===i.XIP.EveryoneButGuests&&e.memberRole!==i.k_p.Guest&&e.memberRole!==i.k_p.Undefined},d=(e,t)=>{const n=decodeURIComponent(e),{channelId:i,replyChainId:r}=u(n,t);if(!("string"==typeof i)||!("string"==typeof r||null==r)){const n=`TeamsAndChannelsHelper::extractChannelMessageCompoundId::${a.jK.InvalidInput}::${e}`;throw null==t||t.error(n),(0,o.Tr)("TeamsAndChannelsHelper",a.jK.InvalidInput,"extractChannelMessageCompoundId",{compoundId:e},n)}return{channelId:i,replyChainId:r}},u=(e,t)=>{try{const{channelId:t,replyChainId:n}=JSON.parse(e);return{channelId:t,replyChainId:n}}catch(n){return null==t||t.warn(`Exception parsing channel navigation args JSON, will assume the passed id is a channel id: ${e}`),{channelId:e}}},m=e=>{if(!e)return{teamId:void 0,channelId:void 0};try{const{teamId:t,channelId:n}=JSON.parse(e);return{teamId:t,channelId:n}}catch(t){return{channelId:e}}},g=(e,t,n,i,a,o,c,d,u,m)=>{switch(e){case l.X.CreateTeam:i?t.teamsAndChannels.createTeamOnMainView({source:r.IC.template},c):t.teamsAndChannels.createTeam();break;case l.X.JoinTeamByCode:c===s.D.SchoolTeams?t.school.gridTeamDiscover():t.teamsAndChannels.teamDiscover();break;case l.X.JoinTeam:a?t.teamsGallery.launchTeamsGallery():t.teamsAndChannels.teamDiscover();break;case l.X.AddChannel:n&&m?t.teamsAndChannels.createChannel({teamId:n.id,groupId:n.groupId||""}):n&&t.teamsAndChannels.addChannel(n.id);break;case l.X.AddMember:n&&(o?t.teamsAndChannels.addMemberToTeamDialog(n.id):t.teamsAndChannels.addMember(n.id));break;case l.X.MarkAllChannelsAsRead:null==d||d();break;case l.X.ManageTeamsList:t.teamsAndChannels.manageTeamsList(s.D.ChannelList,void 0,null==u?void 0:u()),null==d||d();break;case l.X.ManageTeamsInvites:t.teamsAndChannels.manageSharedChannelsPendingInvites(s.D.ChannelList,void 0,null==u?void 0:u()),null==d||d();break;case l.X.CrossTeamAnalytics:t.teamsAndChannels.crossTeamAnalytics(s.D.ChannelList,void 0,null==u?void 0:u()),null==d||d()}},p=e=>{var t,n;const i=null===(t=e.graphQLErrors)||void 0===t?void 0:t.find((e=>{var t;return"CDLResolver"===(null===(t=e.extensions)||void 0===t?void 0:t.source)})),a=null===(n=null==i?void 0:i.extensions)||void 0===n?void 0:n.prevError;return null==a?void 0:a.extraInfo}},324782:(e,t,n)=>{"use strict";n.d(t,{su:()=>s,Ef:()=>l,V7:()=>c});var i=n(47135),a=n(54427),o=n(948519);const r=({ageGroup:e,enableUnderAgeOfConsentPolicy:t})=>{const n=e===o.zH.MinorWithMsaParentalConsent||e===o.zH.MinorWithoutMsaParentalConsent;return!!t&&n},s=e=>{const{ageGroup:t,enableUnderAgeOfConsentPolicy:n}=e.get(i.J.AgeConsent);return r({ageGroup:t,enableUnderAgeOfConsentPolicy:n})},l=(e=!1)=>{const{ageGroup:t,enableUnderAgeOfConsentPolicy:n}=(0,a.NC)(i.J.AgeConsent);return!(!e||t)||r({ageGroup:t,enableUnderAgeOfConsentPolicy:n})},c=e=>{const{disableGiphyForUnderAgeUser:t}=e.get(i.J.AgeConsent);return s(e)&&!!t}},214166:(e,t,n)=>{"use strict";function i(e){const t={};return(n,...i)=>{try{let a=t[n];return a||(a=t[n]=e(...i).then((e=>(delete t[n],e))).catch((e=>{throw delete t[n],e}))),a}catch(e){throw e}}}n.d(t,{k:()=>i})},741502:(e,t,n)=>{"use strict";var i,a;n.d(t,{j:()=>i,Q:()=>a}),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting",e.LicenseError="LicenseError"}(i||(i={})),function(e){e.Failure="Failure",e.InteractionRequired="InteractionRequired",e.Success="Success",e.LicenseError="LicenseError",e.Unknown="Unknown"}(a||(a={}))},193022:(e,t,n)=>{"use strict";var i,a,o,r,s;n.d(t,{hO:()=>i,Zw:()=>a,in:()=>o,s_:()=>r,O_:()=>s,e0:()=>l}),function(e){e.POP="pop",e.BEARER="Bearer"}(i||(i={})),function(e){e[e.Skype=0]="Skype",e[e.AAD=1]="AAD",e[e.CAE=2]="CAE"}(a||(a={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(o||(o={})),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(r||(r={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT="https://api.spaces.skype.com",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation"}(s||(s={}));const l="9188040d-6c67-4c5b-b112-36a304b66dad"},774279:(e,t,n)=>{"use strict";var i;n.d(t,{dX:()=>i}),function(e){e.authWarmLaunch="authWarmLaunch",e.authWarmLaunchAfterLoginValidation="authWarmLaunchAfterLoginValidation",e.authAnonLaunch="authAnonLaunch",e.authLoginSsoComplete="authLoginSsoComplete",e.authDisableSsoLaunch="authDisableSsoLaunch",e.authAfterLogoutLaunch="authAfterLogoutLaunch",e.authLoginPage="authLoginPage",e.authMtoUser="authMtoUser"}(i||(i={}))},27994:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a});let i=[];function a(e){i.push(e)}},678413:(e,t,n)=>{"use strict";n.d(t,{R:()=>i,u:()=>s});var i,a=n(878563),o=n(47135),r=n(197981);!function(e){e.Active="Active",e.Inactive="Inactive",e.LongInactive="LongInactive"}(i||(i={}));class s{constructor(e,t,n,o,l){this._host=e,this._activityCallback=o,this._trackDocumentVisibility=l,this.msUntilIdle=s.MsUntilIdleDefault,this.msUntilLongIdle=s.msUntilLongIdleDefault,this.handleMonitoredWindowEvent=(0,r.debounce)((()=>{this._idleStateBehaviorSubject.value!==i.Active&&this._idleStateBehaviorSubject.next(i.Active),this.restartIdleTimer(),this._activityCallback&&this._activityCallback()}),s.msDelayTime,{maxWait:this.msUntilIdle-s.msDelayTime*s.msMaxWaitTimeFactor,leading:!0}),this.handleIdleTimerTimeout=()=>{this._idleStateBehaviorSubject.next(i.Inactive),this._idleCountdownTimer=void 0,this.restartLongIdleTimer()},this.handleLongIdleTimerTimeout=()=>{this._idleStateBehaviorSubject.next(i.LongInactive),this._longIdleCountdownTimer=void 0},this.handleDocumentVisibilityChange=()=>{this._host.document.hidden?this._idleStateBehaviorSubject.next(i.Inactive):(this._idleStateBehaviorSubject.next(i.Active),this.restartIdleTimer())},this._idleStateBehaviorSubject=new a.X(i.Inactive),n&&this.setSettings(n),this.restartLongIdleTimer(),s.monitoredWindowEvents.forEach((t=>{e.addEventListener(t,this.handleMonitoredWindowEvent)})),l&&e.addEventListener("visibilitychange",this.handleDocumentVisibilityChange),t.newLogger("IdleTracker","core-services-client-state").log("Initialized")}observe(){return this._idleStateBehaviorSubject.asObservable()}getState(){return this._idleStateBehaviorSubject.value}createChildWindowIdleTracker(e,t,n){const i=this._activityCallback||this.handleMonitoredWindowEvent;return new s(e,t,n,i)}restartIdleTimer(){this.stopIdleTimers(),this._idleCountdownTimer=this._host.setTimeout(this.handleIdleTimerTimeout,this.msUntilIdle)}dispose(){this.stopIdleTimers(),s.monitoredWindowEvents.forEach((e=>{this._host.removeEventListener(e,this.handleMonitoredWindowEvent)})),this._trackDocumentVisibility&&this._host.removeEventListener("visibilitychange",this.handleDocumentVisibilityChange),this._idleStateBehaviorSubject.complete(),this.handleMonitoredWindowEvent.cancel()}setSettings(e){const{appIdleTimeoutInMs:t,appLongIdleTimeoutInMs:n}=e.get(o.J.Core);this.msUntilIdle=t||s.MsUntilIdleDefault,this.msUntilLongIdle=n||s.msUntilLongIdleDefault}restartLongIdleTimer(){void 0!==this._longIdleCountdownTimer&&(this._host.clearTimeout(this._longIdleCountdownTimer),this._longIdleCountdownTimer=void 0),this._longIdleCountdownTimer=this._host.setTimeout(this.handleLongIdleTimerTimeout,this.msUntilLongIdle)}stopIdleTimers(){void 0!==this._idleCountdownTimer&&(this._host.clearTimeout(this._idleCountdownTimer),this._idleCountdownTimer=void 0),void 0!==this._longIdleCountdownTimer&&(this._host.clearTimeout(this._longIdleCountdownTimer),this._longIdleCountdownTimer=void 0)}}s.monitoredWindowEvents=["scroll","DOMMouseScroll","mousewheel","touchstart","touchmove","mousemove","keydown"],s.msDelayTime=1e3,s.msMaxWaitTimeFactor=30,s.msUntilLongIdleDefault=12e5,s.MsUntilIdleDefault=3e5},948519:(e,t,n)=>{"use strict";var i,a,o,r,s,l,c,d,u,m,g,p,v,h,f,y,b,S,k,w,C,_,T,I,E,N,A,F,D,R,x,M,O,P,L,U,j,$,B,W,H,V,z,q,G,J,Q,K,Y,X,Z,ee,te,ne,ie,ae,oe,re,se,le,ce,de,ue,me,ge,pe,ve,he,fe,ye,be,Se,ke,we,Ce,_e,Te,Ie,Ee,Ne,Ae,Fe,De,Re,xe,Me,Oe,Pe,Le,Ue,je,$e,Be,We,He,Ve,ze;n.d(t,{zH:()=>i,YZ:()=>s,Xl:()=>l,jE:()=>c,Yl:()=>m,BI:()=>g,m6:()=>p,wx:()=>f,KX:()=>T,Fs:()=>I,wk:()=>E,mD:()=>N,vk:()=>A,yX:()=>R,Kk:()=>M,td:()=>O,Io:()=>j,Ry:()=>$,IC:()=>B,Z8:()=>W,FB:()=>z,EM:()=>J,Pn:()=>Q,KN:()=>K,a5:()=>X,$e:()=>Z,gG:()=>ee,NL:()=>ie,aG:()=>de,TB:()=>ge,C7:()=>pe,AO:()=>fe,in:()=>ye,B6:()=>be,m1:()=>Se,vG:()=>ke,zO:()=>we,EQ:()=>_e,i:()=>Ne,Gn:()=>Fe,UF:()=>Me,Aq:()=>Oe,$w:()=>Pe,PG:()=>Le,oj:()=>Ue,Hj:()=>je,XI:()=>$e,_Y:()=>Be,cJ:()=>We,iJ:()=>He,RH:()=>Ve}),function(e){e.Adult="Adult",e.MinorNoParentalConsentRequired="MinorNoParentalConsentRequired",e.MinorWithMsaParentalConsent="MinorWithMsaParentalConsent",e.MinorWithoutMsaParentalConsent="MinorWithoutMsaParentalConsent",e.NotAdult="NotAdult"}(i||(i={})),function(e){e.Msa="Msa",e.Aad="Aad"}(a||(a={})),function(e){e.Skype="Skype",e.AAD="AAD",e.CAE="CAE"}(o||(o={})),function(e){e.prod="prod",e.dod="dod",e.gcch="gcch",e.life="life",e.gallatin="gallatin"}(r||(r={})),function(e){e.FILEDOMAIN="FILEDOMAIN",e.MESSAGEDOMAIN="MESSAGEDOMAIN",e.GROUPCHATDOMAIN="GROUPCHATDOMAIN",e.TCDOMAIN="TCDOMAIN"}(s||(s={})),function(e){e.DEFAULT="DEFAULT",e.SUBSTRATET1="SUBSTRATET1",e.SUBSTRATET2="SUBSTRATET2",e.TOPN="TOPN"}(l||(l={})),function(e){e.Discoverable="Discoverable",e.Undiscoverable="Undiscoverable",e.Unknown="Unknown"}(c||(c={})),function(e){e.EWS="EWS",e.REST="REST",e.Substrate="Substrate"}(d||(d={})),function(e){e.CalendarEventsFetchFailed="CalendarEventsFetchFailed",e.None="None",e.PeopleServiceInitFailed="PeopleServiceInitFailed",e.TaskTimedOut="TaskTimedOut",e.TokenGenerationFailed="TokenGenerationFailed",e.UserMailboxEndpointFetchFailed="UserMailboxEndpointFetchFailed"}(u||(u={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled",e.ForceDisabled="ForceDisabled",e.ForceEnabled="ForceEnabled"}(m||(m={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(g||(g={})),function(e){e.EveryoneInCompany="EveryoneInCompany",e.Everyone="Everyone"}(p||(p={})),function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Local="Local",e.Microsoft="Microsoft",e.Preview="Preview",e.Production="Production",e.Staging="Staging",e.SyntheticTraffic="SyntheticTraffic"}(v||(v={})),function(e){e.cancel="cancel",e.fail="fail",e.incomplete="incomplete",e.success="success"}(h||(h={})),function(e){e.PowerPoint="PowerPoint",e.Excel="Excel",e.Word="Word",e.Visio="Visio",e.OneNote="OneNote",e.Whiteboard="Whiteboard",e.Undefined="Undefined"}(f||(f={})),function(e){e.Present="Present",e.Collaboration="Collaboration",e.None="None"}(y||(y={})),function(e){e.NoPermission="NoPermission",e.SingleStepPermission="SingleStepPermission",e.MultiStepPermission="MultiStepPermission",e.None="None"}(b||(b={})),function(e){e.AlwaysEnabled="AlwaysEnabled",e.AlwaysDisabled="AlwaysDisabled",e.UserOverride="UserOverride"}(S||(S={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.UserOverride="UserOverride"}(k||(k={})),function(e){e.DisabledUserOverride="DisabledUserOverride",e.Disabled="Disabled"}(w||(w={})),function(e){e.DisabledUserOverride="DisabledUserOverride",e.Disabled="Disabled"}(C||(C={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(_||(_={})),function(e){e.horizontal="horizontal",e.horizontalEnd="horizontalEnd",e.overflow="overflow",e.indicators="indicators"}(T||(T={})),function(e){e.default="default",e.button="button"}(I||(I={})),function(e){e.Compact="Compact",e.Inline="Inline",e.Split="Split",e.Stacked="Stacked"}(E||(E={})),function(e){e.None="None",e.FreeTask="FreeTask",e.Idle="Idle"}(N||(N={})),function(e){e.AlwaysKeep="AlwaysKeep",e.MergeWithNext="MergeWithNext",e.MergeWithPrevious="MergeWithPrevious"}(A||(A={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(F||(F={})),function(e){e.NotificationOnly="NotificationOnly",e.ConferenceMuted="ConferenceMuted",e.ConferenceUnMuted="ConferenceUnMuted"}(D||(D={})),function(e){e.v0="v0",e.v1="v1",e.international="international"}(R||(R={})),function(e){e.Disabled="Disabled",e.SingleApplication="SingleApplication",e.EntireScreen="EntireScreen"}(x||(x={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.EnabledExceptAnonymous="EnabledExceptAnonymous"}(M||(M={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(O||(O={})),function(e){e.Unknown="Unknown",e.Online="Online",e.OnPrem="OnPrem"}(P||(P={})),function(e){e.Regular="Regular",e.CallQueue="CallQueue",e.CallGroup="CallGroup",e.Delegate="Delegate",e.MeetingStartedReminder="MeetingStartedReminder"}(L||(L={})),function(e){e.Ring="Ring",e.Bop="Bop",e.Bounce="Bounce",e.Bubbles="Bubbles",e.DripDrop="DripDrop",e.Eureka="Eureka",e.Flutter="Flutter",e.HighScore="HighScore",e.NextLevel="NextLevel",e.Plink="Plink",e.RingRing="RingRing",e.Ripple="Ripple",e.Spacetime="Spacetime",e.WishGranted="WishGranted",e.Wobble="Wobble",e.BubblesLoud="BubblesLoud",e.Remix="Remix"}(U||(U={})),function(e){e.Immediate="Immediate",e.Simultaneous="Simultaneous",e.Unanswered="Unanswered"}(j||(j={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing",e.Group="Group"}($||($={})),function(e){e.Ring="Ring",e.Mute="Mute"}(B||(B={})),function(e){e.BackgroundEffect="BackgroundEffect",e.BackgroundAPL="BackgroundAPL"}(W||(W={})),function(e){e.Cameo="Cameo",e.ContentOnly="ContentOnly",e.Weatherperson="Weatherperson",e.SideBySide="SideBySide",e.NewsAnchor="NewsAnchor"}(H||(H={})),function(e){e.Disabled="Disabled",e.ReceiveOnly="ReceiveOnly",e.SendOnly="SendOnly",e.Inactive="Inactive",e.Bidirectional="Bidirectional"}(V||(V={})),function(e){e.fail="fail",e.incomplete="incomplete",e.cancel="cancel"}(z||(z={})),function(e){e.Grid="Grid",e.SpeakerView="SpeakerView",e.MixedGridView="MixedGridView"}(q||(q={})),function(e){e.sendMessage="sendMessage",e.setConsumptionHorizon="setConsumptionHorizon"}(G||(G={})),function(e){e.Mac="Mac",e.Windows="Windows"}(J||(J={})),function(e){e.ams="ams",e.amsV2="amsV2",e.appMonetizationService="appMonetizationService",e.appService="appService",e.appsSuggestionService="appsSuggestionService",e.calling_registrarUrl="calling_registrarUrl",e.calling_trouterUrl="calling_trouterUrl",e.chatService="chatService",e.chatServiceAfd="chatServiceAfd",e.chatSvcAggAfd="chatSvcAggAfd",e.cmdArtifactsService="cmdArtifactsService",e.consumerLicenses="consumerLicenses",e.groupsServiceV2="groupsServiceV2",e.mcpService="mcpService",e.middleTier="middleTier",e.mtImageService="mtImageService",e.phonelinkSmsService="phonelinkSmsService",e.powerPointStateService="powerPointStateService",e.peopleProfileService="peopleProfileService",e.search="search",e.teamsAndChannelsProvisioningService="teamsAndChannelsProvisioningService",e.teamsEventsIntegration="teamsEventsIntegration",e.teamsPushServiceAfd="teamsPushServiceAfd",e.unifiedPresence="unifiedPresence",e.urlp="urlp",e.urlpV2="urlpV2",e.userProfileService="userProfileService",e.virtualEventsService="virtualEventsService",e.userIntelligenceService="userIntelligenceService"}(Q||(Q={})),function(e){e.UserChoice="UserChoice",e.AdminDisabled="AdminDisabled",e.MicrosoftChoice="MicrosoftChoice"}(K||(K={})),function(e){e.Forced="Forced",e.FollowOfficePreview="FollowOfficePreview",e.Enabled="Enabled",e.Disabled="Disabled"}(Y||(Y={})),function(e){e.Desktop="Desktop",e.Web="Web"}(X||(X={})),function(e){e.DataCapture="DataCapture",e.TrafficCop="TrafficCop"}(Z||(Z={})),function(e){e.Disabled="Disabled",e.DryRun="DryRun",e.DryRunQuiet="DryRunQuiet",e.Enabled="Enabled",e.EnabledQuiet="EnabledQuiet"}(ee||(ee={})),function(e){e.None="None",e.Error="Error",e.Warn="Warn",e.Info="Info",e.Debug="Debug",e.Verbose="Verbose",e.Max="Max"}(te||(te={})),function(e){e.MeetingAddApp="MeetingAddApp",e.ExtensibilityAppPickerFlyout="ExtensibilityAppPickerFlyout"}(ne||(ne={})),function(e){e.extensibilityAppPickerMeetingAddTapEntryPointConfig="extensibilityAppPickerMeetingAddTapEntryPointConfig"}(ie||(ie={})),function(e){e.Tab="Tab",e.Messaging="Messaging"}(ae||(ae={})),function(e){e.recent="recent",e.custom="custom",e.suggested="suggested"}(oe||(oe={})),function(e){e.Grid="Grid",e.List="List"}(re||(re={})),function(e){e.extensibility_flyout_add_a_new_app="extensibility_flyout_add_a_new_app",e.meeting_apps_flyout_games_section_internal_header="meeting_apps_flyout_games_section_internal_header",e.meeting_apps_flyout_games_section_header="meeting_apps_flyout_games_section_header",e.meeting_apps_flyout_games_section_microsoft_internal_header="meeting_apps_flyout_games_section_microsoft_internal_header"}(se||(se={})),function(e){e.MRU="MRU",e.TenantAppRankingECS="TenantAppRankingECS",e.TenantAppRankingSuggestionService="TenantAppRankingSuggestionService",e.Alphabetical="Alphabetical",e.None="None"}(le||(le={})),function(e){e.Flyout="Flyout",e.RightRail="RightRail"}(ce||(ce={})),function(e){e.team="team",e.personal="personal",e.groupChat="groupChat",e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat"}(de||(de={})),function(e){e.query="query",e.action="action",e.Query="Query",e.Action="Action"}(ue||(ue={})),function(e){e.Rating="Rating",e.Verbatim="Verbatim"}(me||(me={})),function(e){e.Petrol="Petrol",e.ODS="ODS"}(ge||(ge={})),function(e){e.Legacy="Legacy",e.Graph="Graph",e.Vroom="Vroom"}(pe||(pe={})),function(e){e.Osearch="Osearch",e.AllFiles="AllFiles"}(ve||(ve={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.EnabledUserOverride="EnabledUserOverride",e.DisabledUserOverride="DisabledUserOverride"}(he||(he={})),function(e){e.blockingDisallowed="blockingDisallowed",e.blockingAllowed="blockingAllowed"}(fe||(fe={})),function(e){e.Full="Full",e.Limited="Limited",e.Restricted="Restricted"}(ye||(ye={})),function(e){e.Everyone="Everyone",e.None="None",e.UserPreference="UserPreference"}(be||(be={})),function(e){e.Strict="Strict",e.Moderate="Moderate",e.NoRestriction="NoRestriction"}(Se||(Se={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(ke||(ke={})),function(e){e.Chat="Chat",e.FlyoutInlineChat="FlyoutInlineChat",e.ChannelPost="ChannelPost",e.ChannelReply="ChannelReply",e.DiscoverSurfacePost="DiscoverSurfacePost"}(we||(we={})),function(e){e.Staging="Staging",e.Dogfood="Dogfood",e.Prod="Prod"}(Ce||(Ce={})),function(e){e.fixedByHost="fixedByHost",e.grow="grow",e.growHeight="growHeight"}(_e||(_e={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(Te||(Te={})),function(e){e.small="small",e.medium="medium",e.large="large"}(Ie||(Ie={})),function(e){e.Discoverable="Discoverable",e.Undiscoverable="Undiscoverable",e.Unknown="Unknown"}(Ee||(Ee={})),function(e){e.bubble="bubble",e.flat="flat"}(Ne||(Ne={})),function(e){e.df="df",e.msit="msit"}(Ae||(Ae={})),function(e){e.inTenantResults="inTenantResults",e.federatedAndBotResults="federatedAndBotResults",e.teamTagResults="teamTagResults",e.groupChatResults="groupChatResults",e.pstnResults="pstnResults"}(Fe||(Fe={})),function(e){e.Disabled="Disabled",e.EnabledTeamOwner="EnabledTeamOwner",e.EnabledTeamOwnerMember="EnabledTeamOwnerMember"}(De||(De={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(Re||(Re={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(xe||(xe={})),function(e){e.Clean="Clean",e.UpgradeBlocking="UpgradeBlocking",e.UpgradeNonBlocking="UpgradeNonBlocking",e.Warm="Warm"}(Me||(Me={})),function(e){e.Edge="Edge",e.Safari="Safari",e.Chrome="Chrome",e.Firefox="Firefox",e.Electron="Electron",e.Unknown="Unknown"}(Oe||(Oe={})),function(e){e.None="None",e.CitrixXenDesktop="CitrixXenDesktop",e.CitrixXenApp="CitrixXenApp",e.VMWare="VMWare",e.WVD="WVD"}(Pe||(Pe={})),function(e){e.Web="Web",e.Desktop="Desktop",e.Rigel="Rigel",e.SurfaceHub="SurfaceHub"}(Le||(Le={})),function(e){e.Unknown="Unknown",e.Teacher="Teacher",e.Student="Student",e.Anonymous="Anonymous"}(Ue||(Ue={})),function(e){e.Everyone="Everyone",e.EveryoneInCompanyExcludingGuests="EveryoneInCompanyExcludingGuests"}(je||(je={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}($e||($e={})),function(e){e.DefaultOnly="DefaultOnly",e.DefaultAndPredefinedOnly="DefaultAndPredefinedOnly",e.AllQuestions="AllQuestions"}(Be||(Be={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(We||(We={})),function(e){e.None="None",e.InviteOnly="InviteOnly",e.EveryoneInCompanyIncludingGuests="EveryoneInCompanyIncludingGuests",e.Everyone="Everyone"}(He||(He={})),function(e){e.None="None",e.InviteOnly="InviteOnly",e.EveryoneInCompanyIncludingGuests="EveryoneInCompanyIncludingGuests",e.Everyone="Everyone"}(Ve||(Ve={})),function(e){e.SingleChoice="SingleChoice",e.MultiChoice="MultiChoice",e.SingleLineText="SingleLineText",e.MultiLineText="MultiLineText"}(ze||(ze={}))},448025:(e,t,n)=>{"use strict";var i,a;n.d(t,{t:()=>i,Y:()=>a}),function(e){e.Compose="Compose",e.MessagePane="MessagePane",e.DeeplinkedMessage="DeeplinkedMessage",e.DoNotMove="DoNotMove"}(i||(i={})),function(e){e.LeftRailSelectedItem="LeftRailSelectedItem",e.DoNotMove="DoNotMove"}(a||(a={}))},270641:(e,t,n)=>{"use strict";var i;n.d(t,{Y:()=>i}),function(e){e.BottomLeft="BottomLeft",e.BottomRight="BottomRight",e.TopLeft="TopLeft",e.TopRight="TopRight"}(i||(i={}))},290457:(e,t,n)=>{"use strict";var i;n.d(t,{hO:()=>i,K$:()=>a,v4:()=>o,F_:()=>r}),function(e){e.POP="pop",e.BEARER="Bearer"}(i||(i={}));const a="https://api.spaces.skype.com",o="ForceFallbackToWebAuth",r="ForceReloadIfSkypeAuthFail"},512975:(e,t,n)=>{"use strict";var i;n.d(t,{l:()=>i,Q:()=>a}),function(e){e[e.UNKNOWN=-1]="UNKNOWN",e[e.ONLINE=1]="ONLINE",e[e.OFFLINE=0]="OFFLINE"}(i||(i={}));const a=["ChatSync","Presence","Files","OneNote","Groups","Video","MasterTab","IndexDb","AdalTokens","AdalLogin","AdalReauth","SkypeTokens","SkypeLicense","SupportedBrowser","MSAGuestLicense","AppSession","CSAStartup"]},762686:(e,t,n)=>{"use strict";n.d(t,{QC:()=>i,_1:()=>a,fl:()=>o,nx:()=>r});const i="cdl-worker-startup-status",a="cdl-worker-verbose-log",o="cdl-worker-aggregated-user-data",r="cdl-worker-global-user-data"},402393:(e,t,n)=>{"use strict";var i;n.d(t,{B:()=>i}),function(e){e.Abandoned="Abandoned",e.AfterOnCommandReceived="AfterOnCommandReceived",e.AfterOnEventReceived="AfterOnEventReceived",e.AlreadyFocused="AlreadyFocused",e.ApplicationHookReceivedCommand="ApplicationHookReceivedCommand",e.ApplicationHookContinuedCommand="ApplicationHookContinuedCommand",e.BeforeOnCommandReceived="BeforeOnCommandReceived",e.BeforeOnEventReceived="BeforeOnEventReceived",e.Blanked="Blanked",e.ChunkLoadStarted="ChunkLoadStarted",e.ChunkLoadSucceeded="ChunkLoadSucceeded",e.Close="Close",e.CommandAfterGetAppViewEntitiesSucceeded="CommandAfterGetAppViewEntitiesSucceeded",e.CommandBeforeGetAppViewEntities="CommandBeforeGetAppViewEntities",e.CommandHandledByOnCommandReceived="CommandHandledByOnCommandReceived",e.CommandHandledPriorToResolution="CommandHandledPriorToResolution",e.CommandMetaDataAdded="CommandMetaDataAdded",e.CommandReceived="CommandReceived",e.CommandReportingTimedOut="CommandReportingTimedOut",e.CommandResolutionStarted="CommandResolutionStarted",e.CommandStart="CommandStart",e.DeeplinkReceived="DeeplinkReceived",e.DeeplinkParsed="DeeplinkParsed",e.DeeplinkParseByAppStarted="DeeplinkParseByAppStarted",e.DeeplinkParseByAppSucceeded="DeeplinkParseByAppSucceeded",e.DelegatedCommandReceived="DelegatedCommandReceived",e.EventBubbled="EventBubbled",e.EventHandled="EventHandled",e.Hidden="Hidden",e.IntentReceived="IntentReceived",e.IntentTransferredCrossCloud="IntentTransferredCrossCloud",e.OnBeforeIntentAuthenticatedStarted="OnBeforeIntentAuthenticatedStarted",e.OnBeforeIntentAuthenticatedCompleted="OnBeforeIntentAuthenticatedCompleted",e.OnLoadingScreenDisplayStarted="OnLoadingScreenDisplayStarted",e.OnLoadingScreenDisplayCompleted="OnLoadingScreenDisplayCompleted",e.WaitForUserContextStarted="WaitForUserContextStarted",e.WaitForUserContextCompleted="WaitForUserContextCompleted",e.WaitForUserContextFailed="WaitForUserContextFailed",e.OnAfterIntentAuthenticatedStarted="OnAfterIntentAuthenticatedStarted",e.OnAfterIntentAuthenticatedCompleted="OnAfterIntentAuthenticatedCompleted",e.IntentHookStarted="IntentHookStarted",e.IntentHookResolved="IntentHookResolved",e.IntentHookRejected="IntentHookRejected",e.IntentHookCompleted="IntentCompleted",e.IntentExecuted="IntentExecuted",e.Failure="Failure",e.Focus="Focus",e.Incomplete="Incomplete",e.LayoutRendered="LayoutRendered",e.LayoutRenderUpdated="LayoutRenderUpdated",e.NavigationCommandStart="NavigationCommandStart",e.NotHandled="NotHandled",e.Rendered="Rendered",e.RenderStarted="RenderStarted",e.ScenarioEventDataAppended="ScenarioEventDataAppended",e.ScenarioMarked="ScenarioMarked",e.SlotPhasedRenderingTimedOut="SlotPhasedRenderingTimedOut",e.Toggled="Toggled",e.UnmountStarted="UnmountStarted",e.WindowCreated="WindowCreated",e.WindowUpdated="WindowUpdated",e.WindowNotUpdated="WindowNotUpdated"}(i||(i={}))},137853:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{yU:()=>i,FV:()=>a,c4:()=>o}),function(e){e.ActiveEntitiesResolved="active_entities_resolved",e.ActiveEntitiesDestroyed="active_entities_destroyed",e.AppSelectionChanged="app_selection_changed_resolved",e.ExperienceIdleStateChanged="experience_idle_state_changed",e.InitialDeeplinkResolved="initial_deep_link_resolved",e.NavigationIntentExecuted="navigation_intent_executed",e.UserAuthenticated="user_authenticated",e.UserConsentedToConsumeResources="user_consented_to_consume_resources"}(i||(i={})),function(e){e.LayoutRenderComplete="layout_render_complete",e.LayoutRenderCancelled="layout_render_cancelled",e.WindowStateChange="window_state_change",e.WindowOptionsChange="window_options_change"}(a||(a={})),function(e){e.Started="app_started",e.Initialized="app_initialized",e.ExperienceWarm="experience_warm",e.UserWarm="user_warm",e.ExperienceIdle="experience_idle",e.WindowWarm="window_warm"}(o||(o={}))},343087:(e,t,n)=>{"use strict";var i,a,o,r,s,l,c,d,u,m;n.d(t,{gV:()=>i,XY:()=>a,Jc:()=>o,Ae:()=>r}),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab",e[e.BotConfig=7]="BotConfig",e[e.StoreApp=8]="StoreApp"}(i||(i={})),function(e){e.contentBubble="contentBubble",e.targetedMeetingNotification="targetedMeetingNotification"}(a||(a={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(o||(o={})),function(e){e.message="message",e.compose="compose",e.commandBox="commandBox",e.copilot="copilot"}(r||(r={})),function(e){e.normal="normal",e.high="high",e.urgent="urgent"}(s||(s={})),function(e){e.aadApplication="aadApplication",e.bot="bot",e.tenantBot="tenantBot",e.office365Connector="office365Connector",e.webhook="webhook"}(l||(l={})),function(e){e.team="team",e.channel="channel"}(c||(c={})),function(e){e.html="html",e.text="text"}(d||(d={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry"}(u||(u={})),function(e){e.aadUser="aadUser",e.onPremiseAadUser="onPremiseAadUser",e.anonymousGuest="anonymousGuest",e.federatedUser="federatedUser"}(m||(m={}))},765395:(e,t,n)=>{"use strict";var i;n.d(t,{f:()=>i}),function(e){e.JoinByCode="JoinByCode",e.Dialpad="Dialpad",e.Cortana="Cortana",e.SmartDeviceJoinByCode="SmartDeviceJoinByCode"}(i||(i={}))},420990:(e,t,n)=>{"use strict";var i;n.d(t,{vW:()=>i,o_:()=>a,Tf:()=>o}),function(e){e[e.Background=0]="Background",e[e.Macro=1]="Macro",e[e.RenderBlocking=2]="RenderBlocking",e[e.UserVisible=3]="UserVisible"}(i||(i={}));const a=-1;var o;!function(e){e[e.None=0]="None",e[e.Canceled=1]="Canceled",e[e.Received=2]="Received",e[e.Started=3]="Started",e[e.Complete=4]="Complete"}(o||(o={}))},460136:(e,t,n)=>{"use strict";var i,a;n.d(t,{Z:()=>i,d:()=>a}),function(e){e.AppUpdatedUsingServiceWorker="AppUpdatedUsingServiceWorker",e.ClearContainer="ClearContainer",e.CloudMismatchOnLogIn="CloudMismatchOnLogIn",e.ErrorPageReboot="ErrorPageReboot",e.ErrorPageSignOut="ErrorPageSignOut",e.RemoveAuthenticatedUser="RemoveAuthenticatedUser",e.RingSwitch="RingSwitch",e.LanguageSwitch="LanguageSwitch"}(i||(i={})),function(e){e.Auth="Auth",e.DeveloperSwitchersService="DeveloperSwitchersService",e.ReloadAppTask="ReloadAppTask",e.WebClientUpdateService="WebClientUpdateService",e.RemoveAuthenticatedUserResolver="RemoveAuthenticatedUserResolver",e.Core="Core"}(a||(a={}))},60097:(e,t,n)=>{"use strict";n.d(t,{dS:()=>i,Pz:()=>a,s_:()=>o,Tu:()=>r,Hm:()=>s,x8:()=>l});const i="com.microsoft.teams.chat",a="com.microsoft.teams.calling",o="com.microsoft.teams.meetingOptions",r="com.microsoft.teams.files",s="com.microsoft.teams.teamsAndChannels",l="com.microsoft.teams.teamsGallery"},916821:(e,t,n)=>{"use strict";var i,a;n.d(t,{_:()=>i,a:()=>a}),function(e){e.apps="apps",e.broadcasts="broadcasts",e.chats="chats",e.calls="calls",e.calendars="calendars",e.extensions="extensions",e.files="files",e.licenses="licenses",e.meetings="meetings",e.teamgallery="teamgallery"}(i||(i={})),function(e){e.list="list",e.create="create",e.join="join",e.error="error",e.view="view"}(a||(a={}))},962400:(e,t,n)=>{"use strict";var i,a;n.d(t,{t:()=>i,z:()=>a}),function(e){e.core="core",e.window="window",e.mtmaCore="mtmaCore",e.mtmaUser="mtmaUser",e.mtmaWindow="mtmaWindow",e.viewSchema="viewSchema",e.embed="embed",e.cmd="cmd",e.other="other"}(i||(i={})),function(e){e.query="query",e.watchQuery="watchQuery",e.mutate="mutate",e.subscribe="subscribe",e.readQuery="readQuery",e.writeQuery="writeQuery",e.readFragment="readFragment",e.writeFragment="writeFragment"}(a||(a={}))},23092:(e,t,n)=>{"use strict";var i,a;n.d(t,{Q:()=>i,N:()=>a}),function(e){e.Unknown="unknown",e.Prod="prod"}(i||(i={})),function(e){e.MW="MW",e.Anglr="Anglr",e.ShareToTeams="ShareToTeams",e.Files="Files",e.Calendar="Calendar",e.MtgOpt="MtgOpt",e.EmbedClient="EmbedClient",e.LmsIntegration="LmsIntegration",e.CallingEmbed="CallingEmbed",e.ReactWebClient="ReactWebClient",e.Example="Example"}(a||(a={}))},878898:(e,t,n)=>{"use strict";n.d(t,{I:()=>o});var i=n(916852);const a="IntentPersistenceService";class o{constructor(e){this._localStorage=e}getAllStoredDeeplinks(){const e=this._localStorage.get(a,i.f.Experience);return this.jsonParseSafe(e)||{}}storeDeeplink(e,t){const n=this.getAllStoredDeeplinks();n[e]=t.toString(),this.persist(n)}deleteDeeplink(e){const t=this.getAllStoredDeeplinks();delete t[e],this.persist(t)}clear(){this._localStorage.remove(a,i.f.Experience)}persist(e){this._localStorage.set(a,JSON.stringify(e),i.f.Experience)}jsonParseSafe(e){if(e)try{return JSON.parse(e)}catch(e){return}}}},366800:(e,t,n)=>{"use strict";n.d(t,{xm:()=>a,qf:()=>o,vu:()=>r,b3:()=>s,j:()=>d,sW:()=>u});var i=n(862696);const a="[Authentication][DiscoverV2]";var o,r,s,l,c;!function(e){e.userLocale="X-Client-UI-Language",e.skypeTokenAuthzTypeHeader="ms-teams-authz-type",e.claimsChallengeCapable="claimsChallengeCapable",e.consistencyValue="ConsistencyLevel"}(o||(o={})),function(e){e.skypeTokenRefresh="TokenRefresh",e.skypeTokenExplicitLogin="ExplicitLogin",e.strongConsistencyMsInternalUserSignup="MS-Internal-UserSignup",e.strongConsistencyDefaultValue="Organization;ScenarioId={id}"}(r||(r={})),function(e){e[e.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD=i.gT.Two*i.gT.SECONDS_PER_MINUTE*i.gT.MILLI_PER_SECOND]="DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD"}(s||(s={})),function(e){e.skypeAuthAnonReloadJoinLocation="skypeAuthAnonReloadJoinLocation",e.skypeAuthForceAnonReload="skypeAuthForceAnonReload"}(l||(l={})),function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.THIRTY=30]="THIRTY"}(c||(c={}));const d={SKYPE_SEND_REQUEST:"skype_send_request",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim"},u="NA"},475368:(e,t,n)=>{"use strict";n.d(t,{bO:()=>F,BD:()=>D,r2:()=>R,db:()=>M,LO:()=>P,uc:()=>L,qW:()=>U,ut:()=>j,S9:()=>$,Z2:()=>B,Mu:()=>W,Qe:()=>H,br:()=>V,ZC:()=>z,wh:()=>q,nD:()=>J,TB:()=>Q,wC:()=>K,WA:()=>Y,H:()=>X,nd:()=>Z,lm:()=>ee,UE:()=>ne,lZ:()=>ie,l2:()=>ae,JY:()=>oe,nH:()=>re,qO:()=>se});var i=n(361366),a=n(471285),o=n(786884),r=n(916561),s=n(431566),l=n(47135),c=n(635424),d=n(26653),u=n(790626),m=n(205240),g=n(343324),p=n(332130),v=n(193022),h=n(334025),f=n(710141),y=n(471608),b=n(184717),S=n(662239),k=n(289887),w=n(862696),C=n(786918),_=n(993815),T=n(366800),I=n(65903),E=n(404026),N=n(729690);const A=[a.jK.NetworkOffline,a.jK.Forbidden,a.jK.ProxyAuthenticationRequired],F={context:T.xm,subContext:"_getDiscoverResponse",errorCode:a.jK.NetworkOffline,message:"Network is offline, not making any call",isExpected:!0},D={context:T.xm,subContext:"_getDiscoverResponse",errorCode:h.SM.InteractionRequired,message:"Interaction is required to get a skype token, not making any call",isExpected:!0},R=(e,t,n)=>{let i;if(!n){const{response:t}=e;i=null==t?void 0:t.isExpected}let r=e;r.context||(r=(0,o.Jn)(e,a.w5.Discover,a.jK.InvalidResponse,"",{error:e.stack},e.message||("string"==typeof e?e:(0,C.u4)(e))));const{serverResponse:{status:s,body:l,headers:c={}}={},context:d}=r;let{reason:u,message:m,code:g=a.jK.InvalidResponse,subContext:p=""}=r;return u=c?Object.assign(Object.assign({},u),{responseCorrelationId:c["correlation-id"],innerError:r}):u,m=(null==l?void 0:l.message)||m,p=(null==l?void 0:l.errorCode)||d,g=t?x(s):a.jK.NetworkOffline,(0,o.Tr)(a.w5.Discover,g,p,Object.assign(Object.assign({},u),{innerError:e}),m,r.serverResponse,i)},x=e=>{if(void 0===e)return a.jK.InvalidResponse;switch(e){case r.qb.FORBIDDEN:return a.jK.Forbidden;case r.qb.NOT_AUTHORIZED:return a.jK.Unauthorized;case r.qb.PROXY_AUTHENTICATION_REQUIRED:return a.jK.ProxyAuthenticationRequired;default:return a.jK.FailedToFetch}},M=(e,t,n)=>{if(!e)throw t;const i=Object.assign(Object.assign({},t),{errorCode:t.code,reason:(0,C.u4)(t.reason)});return te(t)||!n&&(null==t?void 0:t.isExpected)?e.cancel(i):e.fail(i),t.reason&&(t.reason.isExpectedError=te(t)),t},O=(0,u.type)({skypeid:u.string}),P=((0,u.type)({skypeTokenData:(0,u.type)({regionGtms:s.UH,token:(0,u.type)({skypeToken:u.string,expiration:u.number,userDetails:(0,u.partial)({region:u.string})})})},"token"),(e,t)=>{if(!e)return t.error("Can not get userId due to skypeToken is undefined"),"";const{skypeid:n}=(0,m.as)(O,(0,_.J)(e));return`8:${n}`}),L=e=>{let t=e.findScenario(g.RG.GetSkypeToken);return t||(t=e.newScenario(g.RG.GetSkypeToken),t.mark("Non authz error scenario")),t},U=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=(0,f.pW)();null==n||n.push("fn:getuid");const a=yield e.getUser({correlation:{id:i,source:"discover-helper::getUserIdentifierForDiscover",scenarioName:g.RG.AuthWebUser}});if(null==n||n.push("user:"+ +!!a),null==a?void 0:a.isAuthenticated){t.log(`[_getUserIdentifier][${i}]user found by getUser call`);return(0,y.Xx)(a)}const o=`[_getUserIdentifier] ${a?`User is not authenticated. UserId: [${a.id}] tenantId: [${a.profile.tid}]`:"user missing"}. ${null==n?void 0:n.join(";")}`;throw(0,b.Tr)({context:T.xm,subContext:"_getUserIdentifier",errorCode:a?h.SM.UserNotAuthenticated:h.SM.UserNotFoundError,isExpected:!0,message:o,correlationId:null!=i?i:(0,f.pW)()})})),j=(e,t,n,a,o,r,s,l,c)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){S.Jt.put(W(e),t.userDetails),null==n||n.push("userDetails:1"),yield(0,N.u)(t,s,r,l,c),S.Jt.put(B(e),t),null==n||n.push("skypeToken:1"),(null==t?void 0:t.regionGtms)?(S.Jt.put($(e),null==t?void 0:t.regionGtms),null==n||n.push("regionGtms:1")):(null==n||n.push("regionGtms:-1"),o.error(`[_getDiscoverResponse][${a}] RegionGtm is missing in response, not able to cache.`))})),$=e=>({user:e,typeName:"Discover",key:h.op}),B=e=>({user:e,typeName:"Discover",key:h.rz}),W=e=>({user:e,typeName:"Discover",key:h.ru}),H=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a;const o=Date.now(),{regionGtms:r,licenseDetails:s,skypeToken:l,tokens:c,region:d,regionOverride:u,regionSettings:m,skypeGuestUserToken:g,consumerLicenseDetails:p,userRegion:v}=yield e.body.json();null===(i=t.eventData)||void 0===i||i.push("parsejson:1");const h=l||c||g,f=null!==(a=null==h?void 0:h.skypeToken)&&void 0!==a?a:null==h?void 0:h.skypetoken;let y;return n.log(`[_acquireSkypeTokenWeb][${null==t?void 0:t.correlationId}] Response parsed succeed.`),p&&(y={timeStamp:new Date(o),consumerLicenseDetails:p}),{userId:P(f,n),regionGtms:r,licenseDetails:s,skypeToken:f,expires:new Date(o+(null==h?void 0:h.expiresIn)*w.gT.MILLI_PER_SECOND),region:d,userRegion:v,regionOverride:u,regionSettings:m,consumerLicenseDetails:y}})),V=(e,t,n)=>{if(e.push("fn:_getUserDetailFromHost"),!t)return void e.push("_bootstrapData:0");const{userId:i,region:a,licenseDetails:o,userRegion:r}=t;return i&&a&&o&&!r?{id:i,licenseDetails:o,region:a,userRegion:r}:(n.log(`[_getUserDetailFromHost] userId:${!!i}|region:${!!a}|licenseDetails:${!!o}|userRegionForMultiGeo:${!!r}`),void e.push(`userId:${!!i}|region:${!!a}|licenseDetails:${!!o}|userRegionForMultiGeo:${!!r}`))},z=(e,t)=>{var n;const i=P(e.skypeToken,t);return t.log(`[convertResponseToISkypeToken] Skypeid received from discovery. Region: ${null==e?void 0:e.region}`),{skypeToken:null==e?void 0:e.skypeToken,expiration:null===(n=null==e?void 0:e.expires)||void 0===n?void 0:n.getTime(),regionGtms:null==e?void 0:e.regionGtms,userDetails:{id:i,licenseDetails:Object.assign(Object.assign({},null==e?void 0:e.licenseDetails),{consumerLicenseDetails:null==e?void 0:e.consumerLicenseDetails}),region:null==e?void 0:e.region,userRegion:null==e?void 0:e.userRegion,regionOverride:null==e?void 0:e.regionOverride,regionSettings:null==e?void 0:e.regionSettings}}},q=(e,t,n,i,a)=>{const{skypeTokenValidationDisabled:o}=n.get(l.J.Auth),r=n.get(l.J.Host).skypeTokenValidationDisabled,s=o||r;return s&&G(e,t,i,a),!!s},G=(e,t,n,i)=>{if(t){n.log(`Skype token validation skipped. forceRenew:${e};isTokenSame:${t}`);const a=i.newScenario(g.RG.SkypeTokenValidationSkipped);a.appendEventData({message:`forceRenew:${e};isTokenSame:${t}`}),a.stop()}},J=(e,t,n)=>{var i;if(!(0,y.FG)(e.userIdentifier,(0,y.Xx)(t)))throw null===(i=e.eventData)||void 0===i||i.push("userMismatch"),n.warn("[_acquireSkypeTokenWeb] user obtained does not match provided userIdentifier, throw error."),(0,b.Tr)({context:T.xm,subContext:"_acquireSkypeTokenWeb",errorCode:h.SM.UserNotFoundError,message:"User obtained does not match provided userIdentifier.",correlationId:e.correlationId,isExpected:!0})},Q=(e,t,n,i,a,o)=>{const{authOverrides:r}=n.get(l.J.Host),{authzEndpointUrl:s,authzUrl:d,regionGtmsEnv:u}=n.get(l.J.Auth),m=((e,t,n,i,a)=>{const{environment:o}=(null==i?void 0:i.get(l.J.Metadata))||{},{doNotPassTenantIdForAnonMeetingJoins:r}=(null==i?void 0:i.get(l.J.Calling))||{};let s={method:"POST",url:n?`${e}?region_gtms_env=${n}`:`${e}`,serviceName:c.EJ.Auth,apiName:"acquireSkypeTokenWeb"};if(t.role===I.w4O.Anonymous)if(t.subType===p.Yf.Ccm){const e=le(t);if(!e)throw(0,b.Tr)({context:"Authentication",subContext:"DiscoverHelper::getRequestConfig",errorCode:"MeetingDetailsNotFound",message:"No meetingUrl present for CCM user",correlationId:a,isExpected:!1});s=Object.assign(Object.assign({},s),{body:`{"meetingURL": "${e}"}`})}else s=r?Object.assign(Object.assign({},s),{url:`${e}/visitor`}):Object.assign(Object.assign({},s),{url:`${e}/visitor`,body:`{"tenantId": "${t.profile.tid}"}`});return o!==v.s_.life||t.role!==I.w4O.Guest&&t.role!==I.w4O.Anonymous||(s=Object.assign(Object.assign({},s),{url:`${e}/guest${n?`?region_gtms_env=${n}`:""}`})),s})((null==r?void 0:r.authzEndpointUrl)||s||d||h.ej.AUTHZ_DEFAULT_BASE_URL,e,u,n,t);return i.log(`[_getFormatRequest][${t}] Request formatted. `),m.headers=((e,t,n,i)=>{const a={},o=null==t?void 0:t.locale,{disableClaimsChallenge:r}=n.get(l.J.Auth);return o&&(a[T.qf.userLocale]=o),r||(a[T.qf.claimsChallengeCapable]="true"),a.clientRequestId=e,a["x-ms-skip-phone"]="true",void 0!==i&&(a["ms-teams-authz-type"]=i?T.vu.skypeTokenRefresh:T.vu.skypeTokenExplicitLogin),a})(t,a,n,o),m},K=e=>{var t,n,i,a,o,r,s,l,c,u,m,g,p,v,h,f,y,b;return{id:e.id,region:e.region,userRegion:e.userRegion||void 0,tenant:{type:(null===(t=e.licenseDetails)||void 0===t?void 0:t.isFreemium)?d.OV.Freemium:d.OV.Work},isAdvComms:(null===(n=e.licenseDetails)||void 0===n?void 0:n.isAdvComms)||!1,isTranscriptEnabled:(null===(i=e.licenseDetails)||void 0===i?void 0:i.isTranscriptEnabled)||!1,isFreemium:(null===(a=e.licenseDetails)||void 0===a?void 0:a.isFreemium)||!1,isTrial:(null===(o=e.licenseDetails)||void 0===o?void 0:o.isTrial)||!1,isWebinarEnabled:(null===(r=e.licenseDetails)||void 0===r?void 0:r.isWebinarEnabled)||!1,eduLicenseSkuAndCategory:(null===(s=e.licenseDetails)||void 0===s?void 0:s.eduLicenseSkuAndCategory)||void 0,isBasicLiveEventsEnabled:(null===(l=e.licenseDetails)||void 0===l?void 0:l.isBasicLiveEventsEnabled)||!1,isCopilot:(null===(c=e.licenseDetails)||void 0===c?void 0:c.isCopilot)||!1,isM365CopilotBusinessChat:(null===(u=e.licenseDetails)||void 0===u?void 0:u.isM365CopilotBusinessChat)||!1,isTPProtection:(null===(m=e.licenseDetails)||void 0===m?void 0:m.isTPProtection)||!1,isTPCustomization:(null===(g=e.licenseDetails)||void 0===g?void 0:g.isTPCustomization)||!1,isTPManagement:(null===(p=e.licenseDetails)||void 0===p?void 0:p.isTPManagement)||!1,isTPWebinar:(null===(v=e.licenseDetails)||void 0===v?void 0:v.isTPWebinar)||!1,isTPVirtualAppointments:(null===(h=e.licenseDetails)||void 0===h?void 0:h.isTPVirtualAppointments)||!1,isInfoProtectionPremium:(null===(f=e.licenseDetails)||void 0===f?void 0:f.isInfoProtectionPremium)||!1,isTeamsPhonePremium:(null===(y=e.licenseDetails)||void 0===y?void 0:y.isTeamsPhonePremium)||!1,isAvatarsEnabled:(null===(b=e.licenseDetails)||void 0===b?void 0:b.isAvatarsEnabled)||!1}},Y=(e,t,n)=>{"object"==typeof e&&(e.context=e.context||T.xm,e.subContext=e.subContext||t,e.correlationId=e.correlationId||n)},X=(e,t,n,i,a)=>{const o=`${null==e?void 0:e.subContext}: Failed to get skype token; correlationId:${e.correlationId}, status:${a}, message:${t}, eventData: ${null==n?void 0:n.join(";")}`;return e.isExpected?i.debug(o):i.error(o),e},Z=(e,t,n)=>{const i=null==e?void 0:e.join(";"),a=(null==n?void 0:n.get(l.J.Metadata))||{},o=n.get(l.J.Auth);return{message:`${i}::isOnline-${t}::environment:${null==a?void 0:a.environment}`,endpointUrl:null==o?void 0:o.authzUrl,resource:null==o?void 0:o.authzResource}},ee=(e,t,n,i,o,s)=>{var c,d;const{serverResponse:{status:u,body:m}={}}=e;let{message:g,errorCode:p}=e;const{reason:v,code:h}=e,f=n&&!(e.context===a.w5.RejectHttpError&&h===a.jK.RemoteOperationFailed),y=null==t?void 0:t.join(";");u&&(p=x(u),g=m.message);const b={reason:v,message:g,eventData:y},S=(0,E.A)((0,C.u4)(b)),k=e.correlationId,w=(null==s?void 0:s.get(l.J.Metadata))||{},_=s.get(l.J.Auth);void 0===e.isExpected&&(e.isExpected=!f||A.indexOf(p)>-1);const I={context:null!==(c=null==e?void 0:e.context)&&void 0!==c?c:T.xm,subContext:null==e?void 0:e.subContext,message:`${g}::isOnline-${f}::env:${null==w?void 0:w.environment}`,errorCode:f?null!=p?p:h:a.jK.NetworkOffline,statusCode:u,correlationId:k,reason:S,endpointUrl:null==_?void 0:_.authzUrl,resource:null==_?void 0:_.authzResource,isExpected:!f||e.isExpected};if(!((null===(d=(0,C.u4)(e.reason))||void 0===d?void 0:d.indexOf("LoggedAlready"))>-1)&&i){switch(((e,t,n)=>{const{errorCode:i,code:o}=t;if(!e||t.isExpected||n===r.qb.FORBIDDEN||n===r.qb.PROXY_AUTHENTICATION_REQUIRED||i===a.jK.NetworkOffline||o===a.jK.NetworkOffline)return"cancel";if(i===a.jK.TimedOut||o===a.jK.TimedOut)return"incomplete";switch(n){case r.qb.NOT_AUTHORIZED:case-1:case r.qb.THROTTLED:return"incomplete";default:return"fail"}})(f,e,u)){case"stop":i.stop(I);break;case"incomplete":i.incomplete(I);break;case"cancel":i.cancel(I);break;case"fail":default:i.fail(I)}}return X(e,g,t,o,u)};function te(e){return A.indexOf(e.code)>-1||"Authentication::getUser"===e.subContext&&e.message.indexOf("User information is not available")>-1||e.message.indexOf("getUser: MSAL account not found")>-1||e.message.indexOf("Get skype token promise timed out, keep retrying. Is expected:true")>-1}function ne(e,t,n,i){return t.getUser().then((()=>{const a=oe(i),{requireSkypetokenForMT:o}=i.get(l.J.Auth),r=t.authorize(e,a);return o?n.authorize(r,"x-skypetoken"):r}))}function ie(e,t,n){return t.getUser().then((()=>{const i=oe(n);return t.authorize(e,i)}))}function ae(e,t,n){return t.getUser().then((()=>{const{cmdMeetingArtifactsServiceResource:i}=n.get(l.J.CMDMeetingArtifactsService);return t.authorize(e,null!=i?i:"")}))}function oe(e){const{isRunningGlassjar:t,mtAuthResourceOverride:n}=e.get(l.J.Test);if(t&&n)return n;const{authOverrides:i}=e.get(l.J.Host),{mtResource:a}=e.get(l.J.Auth);return(null==i?void 0:i.mtResource)||a||v.O_.MT}const re=(e,t,n,i)=>{var a,o,r,s,c,u,m;if(!e)return void i.log("Failed to obtain telemetry details from discovery.");if(!n)return void i.log("Failed to obtain telemetry provider from getTelemetryProviderInstance.");const g=null===(a=e.licenseDetails)||void 0===a?void 0:a.isFreemium,{environment:p}=t.get(l.J.Metadata),h=p===v.s_.life?d.OV.Life:g?d.OV.Freemium:d.OV.Work;if(p===v.s_.life&&g&&i.warn("The Environment indicates TFL, but Freemium is true - defaulting telemetry to TFL Tenant.Model"),n.setContext("UserInfo.Region",e.region),n.setContext("Tenant.Model",h),null===(o=e.consumerLicenseDetails)||void 0===o?void 0:o.consumerLicenseDetails){const t=null===(c=null===(s=null===(r=e.consumerLicenseDetails)||void 0===r?void 0:r.consumerLicenseDetails)||void 0===s?void 0:s.licensedProducts)||void 0===c?void 0:c.map((e=>e.skuName)).sort().join(",");n.setContext("UserInfo.IsLicensed",!!(null===(m=null===(u=e.consumerLicenseDetails)||void 0===u?void 0:u.consumerLicenseDetails)||void 0===m?void 0:m.hasTeamsLicense)),n.setContext("UserInfo.Licenses",t)}},se=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{disableClaimsChallenge:i}=a.get(l.J.Auth);if(i)o.log("[unauthorizedErrorHandler] Claims challenge handling disabled.");else if(e)if(t)S.Jt.deleteType(t,"Token");else{const e=yield n.getUser();S.Jt.deleteType((0,y.Xx)(e),"Token")}else o.log("[unauthorizedErrorHandler] No header passed in.")})),le=e=>{const t=S.Jt.getValue((0,k.VF)((0,y.Xx)(e)).meetingDetails);if(!t)return;const{messageId:n,conversationId:i,tenantId:a,rootMessageId:o}=t;return n===o?`${a}${i}${n}`:`${a}${i}${n}${o}`}},729690:(e,t,n)=>{"use strict";n.d(t,{u:()=>u,p:()=>m});var i=n(361366),a=n(19435),o=n(72297),r=n(662239),s=n(289887),l=n(47135),c=n(343324),d=n(334025);function u(e,t,n,r,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableSkypeTokenEncryption:i,enableEncryptionKeyMaglev:u}=s.get(l.J.Auth);if(!i)return e;const m=n.newScenario(c.RG.AuthWebEncryptToken);m.mark("auth_web_encrypt_token_start");const g=yield(0,a.mM)(t,r,void 0,!!u);if(!g)return m.mark("auth_web_encrypt_token_stop",{reason:"tokenEncryption:MissingEncryptionKey"}),m.stop(),e;try{const n=t.crypto.getRandomValues(new Uint8Array(d.uI.SIXTEEN)),i=(new TextEncoder).encode(e.skypeToken),a=yield t.crypto.subtle.encrypt({name:"AES-CBC",iv:n},g,i);e.encryptedToken=(0,o.z)(a),e.iv=(0,o.z)(n),m.mark("auth_web_encrypt_token_stop",{reason:"tokenEncryption:success"}),m.stop()}catch(e){m.mark("auth_web_encrypt_token_stop",{error:e,reason:"tokenEncryption:error"},"failure"),m.fail()}return e}))}function m(e,t,n,d,u){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableSkypeTokenEncryption:i,enableEncryptionKeyMaglev:m}=u.get(l.J.Auth);if(!i||!e.encryptedToken||e.skypeToken)return e;const g=n.newScenario(c.RG.AuthWebDecryptToken);g.mark("auth_web_decrypt_token_start");const p=yield(0,a.mM)(t,d,void 0,!!m);if(!p)return g.mark("auth_web_decrypt_token_stop",{reason:"Missing encryption key for decryption"}),g.stop(),e;let v=e.iv;if(v||(v=r.Jt.getValue(s.Jl.initializationVector)),!v)return g.mark("auth_web_decrypt_token_stop",{reason:"Missing initialization vector for decryption"}),g.stop(),e;try{const n=(0,o.k)(v),i=(0,o.k)(e.encryptedToken),a=yield t.crypto.subtle.decrypt({name:"AES-CBC",iv:n},p,i);e.skypeToken=(new TextDecoder).decode(a),g.mark("auth_web_decrypt_token_stop"),g.stop()}catch(e){g.mark("auth_web_decrypt_token_stop",{error:e},"failure"),g.fail()}return e}))}},782037:(e,t,n)=>{"use strict";n.d(t,{Mf:()=>a,f$:()=>o,U3:()=>r,cW:()=>s});var i=n(759704);function a(e,t){return{entity:{type:i.p.chats,action:i.u.create,id:o(e)},command:t}}function o(e){return JSON.stringify(e&&e.length>0?e.sort():[])}function r(e,t,n,i){let a={};if(!e)return a;if(e.type===t&&e.action===n){const t=e.options;if(t&&"string"==typeof t)try{a=JSON.parse(t)}catch(e){i.warn(`Entity options are in unexpected format. Expected a valid stringified JSON object but instead received: ${t}.`)}}else i.warn(`Entity options are (incorrectly) being asked for type and action that do not pertain to the entity. ${e.type} != ${t} or ${e.action} != ${n}`);return a}const s=e=>`${e.substring(0,32)}00000000${e.substring(40)}`},181612:(e,t,n)=>{"use strict";n.d(t,{E:()=>s,z:()=>l});var i=n(361366),a=n(786884),o=n(471285);let r;const s=e=>t=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!r)return e(t);return e(t).then((e=>(null==r||r.processResponse(e),e))).catch((e=>{throw null==r||r.processError(e),e}))}));function l(e,t){if(r){throw(0,a.Tr)(o.w5.Tasks,o.jK.AlreadyInitialized,"subscribeToSendNetworkTracking",void 0,"subscription exists")}r={processResponse:e,processError:t};return()=>{r=void 0}}},422327:(e,t,n)=>{"use strict";n.d(t,{Cu:()=>a,pf:()=>o,f2:()=>r,nU:()=>s,zj:()=>l,IY:()=>c,K4:()=>d});var i=n(948519);function a(e){return e.includes("local")?"local":e.includes("-oncdn-")?"container":"production"}function o(e,t){var n,i,a;try{const t=r(e),i=null===(n=null==t?void 0:t.dataset)||void 0===n?void 0:n.config;return i?JSON.parse(decodeURIComponent(i)):{}}catch(e){const n=`Failed to parse head-data config with error: ${e}`;(null==t?void 0:t.errorToTelemetry)?null===(i=null==t?void 0:t.errorToTelemetry)||void 0===i||i.call(t,n,"webclient_framework_head_config",void 0,!0):null===(a=null==t?void 0:t.error)||void 0===a||a.call(t,n)}return{}}function r(e){const t=null==e?void 0:e.document.getElementsByTagName("head");if(t)return t[0]}function s(e){const t=e.navigator.userAgent.match(/maglev\/(\d+\.\d+\.\d+\.\d+)/);return t&&t.length>1?t[1]:void 0}function l(e,t){let n=(null==t?void 0:t.environment)||"prod";return"infer"===n&&(n=function(e){return e.location.origin.includes("gov")?"gcchigh":e.location.origin.includes("dod")?"dod":e.location.origin.includes("live")?"life":"prod"}(e)),n}const c=e=>e===i.UF.UpgradeNonBlocking||e===i.UF.Warm;function d(e){var t,n;const i=null===(n=null===(t=e.navigator)||void 0===t?void 0:t.serviceWorker)||void 0===n?void 0:n.controller;return"activated"===(null==i?void 0:i.state)}},709567:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o});var i=n(916821),a=n(375378);class o{constructor(e,t){this.routingService=e,this.rootRoutingService=t}toCallById(e){this.routingService.navigate(this.callByIdDescriptor(e))}toCallList(){this.routingService.navigate(this.callsListDescriptor())}callByIdDescriptor(e){return this.concatToAppDescriptor({resources:[{resource:i._.calls,id:e}]})}callsListDescriptor(){return this.concatToAppDescriptor({resources:[{resource:i._.calls,action:i.a.list}]})}concatToAppDescriptor(e){const t=this.rootRoutingService.callingAppDescriptor();return(0,a.MJ)(t,e)}}},142503:(e,t,n)=>{"use strict";var i;n.d(t,{e:()=>r}),function(e){e.OrgChart="organization"}(i||(i={}));var a=n(916821),o=n(375378);class r{constructor(e,t){this.routingService=e,this.rootRoutingService=t}toCreateChatWithUsers(e){this.routingService.navigate(this.createChatWithUsersDescriptor(e))}toChatById(e){this.routingService.navigate(this.chatByIdDescriptor(e))}toOrgChart(e){this.routingService.navigate(this.orgChartDescriptor(e))}toChatList(){this.routingService.navigate(this.chatListDescriptor())}chatByIdDescriptor(e){return this.concatToAppDescriptor({resources:[{resource:a._.chats,id:e}]})}createChatWithUsersDescriptor(e){const t=JSON.stringify(e&&e.length>0?e.sort():[]);return this.concatToAppDescriptor({resources:[{resource:a._.chats,action:a.a.create,id:t}]})}chatListDescriptor(){return this.concatToAppDescriptor({resources:[{resource:a._.chats,action:a.a.list}]})}orgChartDescriptor(e){const t=this.createChatWithUsersDescriptor([e]);return(0,o.MJ)(t,{resources:[{resource:a._.extensions,id:i.OrgChart}]})}concatToAppDescriptor(e){const t=this.rootRoutingService.chatAppDescriptor();return(0,o.MJ)(t,e)}}},86567:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var i=n(375378);class a{constructor(e,t){this._history=t,this._logger=e.newLogger("External Routing Service","core-services-routing")}serializeToPath(e){const{descriptor:t,exact:n}=e;let a="";return t&&(a=(0,i.XP)({descriptor:t})),this._history?n||(a=this._history.createHref({pathname:a}).toString()):n&&this._logger.error("Unable to execute on history to generate absolute path. History initialized with undefined"),a}}},276667:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var i=n(916821);class a{meetingOptionsPageDescriptor(e){const{tenantId:t,organizerId:n,threadId:a,messageId:o,additionalMessageId:r,search:s}=e;return{resources:[{resource:i._.meetings,id:JSON.stringify({tenantId:t,organizerId:n,threadId:a,messageId:o,additionalMessageId:r})}],search:s}}meetingOptionsLicenseDescriptor(e){return{resources:[{resource:i._.licenses,action:i.a.list}],search:e?e.search:void 0}}}},814475:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(60097),a=n(916821);class o{constructor(e){this._routingService=e}toAppById(e){this._routingService.navigate(this.appDescriptor(e))}chatAppDescriptor(){return this.appDescriptor(i.dS)}callingAppDescriptor(){return this.appDescriptor(i.Pz)}meetingOptionsAppDescriptor(){return this.appDescriptor(i.s_)}fileAppDescriptor(){return this.appDescriptor(i.Tu)}appDescriptor(e,t){return{resources:[{resource:a._.apps,id:e,action:t}]}}}},375378:(e,t,n)=>{"use strict";n.d(t,{MJ:()=>u,XP:()=>m,Or:()=>p,Df:()=>y,mR:()=>b});var i=n(361366),a=n(916821),o=n(785722),r=n(197981);const s=new Map,l=/^\/|\/$/g;function c(e,t){const n=t?":":"",i=e.id?`/${n}${e.id}`:"",a=e.action?`/${e.action}`:"";return`${e.resource}${i}${a}`}function d(e){const{descriptor:t,asPath:n,stem:a=""}=e,o=(0,i.__rest)(e,["descriptor","asPath","stem"]);let r=a;const s=t?t.resources:void 0;if(s&&s.length>0)for(const e of s)r=`${r}/${c(e,n)}`;return Object.assign(Object.assign({},o),{descriptor:t,asPath:n,stem:r})}function u(...e){return e.reduce(((e,t)=>(e.resources=e.resources.concat(t.resources),e.search=Object.assign(Object.assign({},e.search),t.search),e)),{resources:[],search:{}})}function m(e){return(0,r.flow)([d,h,f])(e).stem}function g(e){if(!e||0===e.length)return[];const t=s.get(e);if(t)return t;let n=[];const i=e.replace(l,"");if(0===i.length)return n;const o=i.split("/");try{const t=function(e){const t=[];let n=-1;for(const i of e){const e=i;a._[e]&&(n++,t[n]=[]),n>=0&&t[n].push(e)}return t}(o);return t&&(n=t.map((e=>{let t;const n=2,i=3;switch(e.length){case i:t={resource:e[0],id:e[1],action:e[n]};break;case n:{const n=e[1];t=a.a[n]?{resource:e[0],action:e[1]}:{resource:e[0],id:e[1]};break}default:throw new Error("Invalid resource fragment format found, id or action is required.")}return t}))),s.size<1e3&&s.set(e,n),n}catch(e){throw new Error(`Unable to parse path into proper resources. ${e.message}`)}}function p(e){return(0,o.parse)(e||"")}function v(e){return(0,o.stringify)(e||{})}function h(e){const{context:t,asPath:n,stem:i=""}=e;let a=i;if(t){const e=t.router;if(!e)throw new Error("Cannot generate a relative path without a context. Verify a context was added provided");{const t=n?e.route.match.path:e.route.match.url;a="/"!==t?`${t}${a}`:a}}return Object.assign(Object.assign({},e),{stem:a})}function f(e){const{descriptor:t,asPath:n,stem:i=""}=e;let a=i;if(t){const e=v(t.search);e&&(a=`${a}${n?`/:${e}`:`?${e}`}`)}return Object.assign(Object.assign({},e),{stem:a})}function y(e){const{search:t}=e,n=(0,i.__rest)(e,["search"]),a=v(t);return{pathname:m({descriptor:n}),search:a}}function b(e){const{pathname:t,search:n}=e;return{resources:g(t),search:p(n)}}},952049:(e,t,n)=>{"use strict";var i;n.d(t,{S:()=>r}),function(e){e[e.Allow=0]="Allow",e[e.Block=1]="Block"}(i||(i={}));class a{constructor(){this._taps=[]}tap(e){return this._taps.push(e),()=>{this._taps=this._taps.filter((t=>t!==e))}}call(e){let t;for(const n of this._taps){const i=n({data:e,previousResult:t});void 0!==i&&(t=i)}return t}}var o=n(375378);class r{constructor(e){this._history=e,this.onNavigationBlocked=new a,this.onNavigationStart=new a,this.onNavigationSucceeded=new a,this._handleNavigationStart=e=>{if(!this._history||!this._history.location)return;const t=this._history.location,n=(0,o.mR)(t),a=(0,o.mR)(e);return this.onNavigationStart.call({from:n,to:a})===i.Block?(this.onNavigationBlocked.call({to:a}),!1):void 0},this._handleNavigationSuccess=e=>{const t=(0,o.mR)(e);this.onNavigationSucceeded.call({to:t})},this._history&&this._history.block&&this._history.block(this._handleNavigationStart),this._history&&this._history.listen&&this._history.listen(this._handleNavigationSuccess)}}},438332:(e,t,n)=>{"use strict";n.d(t,{I:()=>p,s:()=>v});var i=n(956045),a=n(855120),o=n(142503),r=n(709567),s=n(814475),l=n(952049),c=n(786884),d=n(471285),u=n(276667),m=n(86567);let g;const p=(e,t,n)=>{const c=new i.Z(e,t),d=new s.A(c),p={state:new a.M(e,n,t),root:d,call:new r.Y(c,d),chat:new o.e(c,d),meeting:new u.R,external:new m.z(e,t),hooks:new l.S(t)};return g=p,g},v=()=>{if(!g)throw(0,c.Tr)("RoutingServices",d.jK.NotInitialized,"getInstance");return g}},956045:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(375378);class a{constructor(e,t){this.history=t,this._logger=e.newLogger("Routing Service","core-services-routing")}navigate(e){const t=(0,i.Df)(e);this.execute(t)}execute(e){this.history?this.history.push(e):this._logger.error("Unable to route using history. History initialized with undefined")}}},855120:(e,t,n)=>{"use strict";n.d(t,{M:()=>a});var i=n(375378);class a{constructor(e,t,n){this._location=t,this._history=n,this._logger=e.newLogger("State Routing Service","core-services-routing")}getSearchState(){const e=this.getLocation();if(!e)return{};const t=e.search;return t!==this._previousSearch&&(this._previousSearch=t,this._currentState=(0,i.Or)(t)),this._currentState||{}}getOrigin(){const e=this.getLocation();return e&&e.origin}getHost(){const e=this.getLocation();return e&&e.host}getPathname(){const e=this.getLocation();return e&&e.pathname}getLocation(){if(this._location||this._logger.error("Unable to execute on location. Location initialized with undefined"),this._location&&this._history&&this._history.location){const{search:e,pathname:t}=this._history.location;return Object.assign(Object.assign({},this._location),{search:e,pathname:t})}return this._location}}},119824:(e,t,n)=>{"use strict";n.d(t,{Q6:()=>r,bE:()=>s,qo:()=>l});var i=n(47135),a=n(423105),o=n(197981);const r=e=>{const t=e.get(i.J.Host).enableSyncEngine;return(0,o.isNil)(t)?!!e.get(i.J.CdlWorker).enableSyncEngine:t},s=e=>{const t=e.get(i.J.Host).enableProfileManagerStore;return(0,o.isNil)(t)?!!e.get(i.J.People).enableProfileManagerStore:t},l=e=>{const{dataStoreMapType:t,disableDataStoreInMemoryProvider:n}=e.get(i.J.CdlWorker);return n?"none":t||a.o}},177768:(e,t,n)=>{"use strict";n.d(t,{cZ:()=>f,Gg:()=>y,UZ:()=>h});var i=n(471285),a=n(590818),o=n(848378),r=n(520850),s=n(532556),l=n(475781),c=n(620954),d=n(247889),u=n(461525),m=n(111182),g=n(177538),p=n(621084);const v=([e,t])=>(t&&e.do((()=>{}),(e=>{throw e})),e);function h(e,t){return(...n)=>(0,a.P)((()=>e(...n))).pipe(((e,t)=>{const n=e.pipe((0,r.R)(((e,n)=>e||!t(n)),!1)),i=e.pipe((0,s.P)(t),(0,l.V)(5e3));return(0,o.z)((0,c.i)(),(0,d.M)(n),(0,u.U)(v),(0,m.a)((e=>e.pipe((0,g.w)(i)))),(0,p.D)())})(t,b)).toPromise()}const f=e=>(e=>{switch(e){case i.eT.Disabled:case i.eT.Offline:return!1;default:return!0}})(e),y=e=>()=>f(e.getState()),b=e=>e},351598:(e,t,n)=>{"use strict";n.d(t,{s:()=>r,r:()=>s});var i=n(471285),a=n(157453),o=n(980402);function r(e,t){return n=>c((()=>e(n)),t)}function s(e,t){return n=>d(c((()=>e(n)),t),t)}const l=(e,t)=>{if(e.context===i.w5.RejectHttpError&&t.retryCount++<(t.policy.maxRetryCountForOffline||t.policy.maxRetryCount)&&t.policy.shouldRetryRejectHttpError)return t.policy.errorHandler(e,t);if(!e.serverResponse)throw e;const{serverResponse:{status:n}}=e;if(n&&t.retryCount++<t.policy.maxRetryCount&&t.policy.shouldRetry(n))return t.retriesTable[n]=(t.retriesTable[n]||0)+1,t.policy.errorHandler(e,t);throw e},c=(e,t)=>(0,a.X)(e,l)({policy:t,delay:t.createDelay(),retryCount:0,retriesTable:{}}),d=(e,t)=>(0,o.E)(e,t.retryMaxTimeMs)},754645:(e,t,n)=>{"use strict";n.d(t,{mf:()=>i,Zz:()=>a,hh:()=>o,YM:()=>r});const i={Safari:11.1},a=11,o=11.1,r={chrome:">=60",chromium:">=60",edge:">=12",electron:">=2",firefox:">=52"}},313142:(e,t,n)=>{"use strict";n.d(t,{H$:()=>r,MB:()=>s,Qh:()=>l,L5:()=>c});var i=n(418566),a=n(754645),o=n(10339);function r(e=a.YM){return!!e&&!!d().satisfies(e)}function s(){return!u("ie")}function l(){return!!d().satisfies({safari:`>=${a.mf.Safari}`})}function c(){return u("safari")&&void 0===d().getBrowserVersion()}function d(){return i.getParser((0,o.J)().navigator.userAgent)}function u(e){return d().isBrowser(e,!0)}},486403:(e,t,n)=>{"use strict";n.d(t,{h$:()=>N,sE:()=>T,lx:()=>I,Do:()=>A,gi:()=>E,xB:()=>F});var i=n(867634),a=n(65903);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForDeletedMessages"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"time"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}},{kind:"Field",name:{kind:"Name",value:"escalations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"userHasSaved"}},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"}},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"FragmentSpread",name:{kind:"Name",value:"deletionInfo"}}]}},...o.definitions]},s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"deletedMessages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deletedMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"message"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageFieldsForDeletedMessages"}}]}}]}}]}},...r.definitions]};var l=n(405716);const c={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedReplyChainMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};l.lB.definitions;var d=n(356449);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedMeetingReplyMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};d.yM.definitions;var m=n(501183);const g={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedStandardPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};m.w3.definitions;var p=n(225222);const v={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedAnnouncementPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};p.Be.definitions;var h=n(692639);const f={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedEmailPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};h.E3.definitions;var y=n(301762);const b={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedMeetingPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};y.lU.definitions;var S=n(210424);const k={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedConnectorPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConnectorPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};S.zL.definitions;var w=n(500685);const C={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedGuardiansPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GuardiansPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};w.N4.definitions;var _=n(912825);function T(e,t){const{message:n}=R(e,t.id,t.clientMessageId,void 0,!(null==t?void 0:t.deleteTime)),i=n&&n.message&&n.message.importance===a.Ntc.Urgent;return{__typename:"DeletionInfo",showMessageAsDeleted:!!n,canBeUndeleted:!!n&&!i,deleteFailed:!1}}function I(e,t,n,i){try{const{message:a}=R(e,t,n,i);if(a){const{message:n}=a,i=Object.assign(Object.assign({},n),{id:t}),o=`Message:${t}`;return e.writeFragment({id:o,fragment:r,data:i}),i}}catch(e){i.error(`Failed to recoverDeletedMessageInCache for messageId: ${t}`)}}function E(e,t,n,i,a,r){const{fragment:s,fragmentName:l}=function(e){switch(e){case"Message":return{fragment:o,fragmentName:"deletionInfo"};case"ReplyChainMessage":return{fragment:c,fragmentName:"DataClientChatDeletedReplyChainMessageFragment_deletionInfo"};case"MeetingReplyMessage":return{fragment:u,fragmentName:"DataClientChatDeletedMeetingReplyMessageFragment_deletionInfo"};case"StandardPostMessage":return{fragment:g,fragmentName:"DataClientChatDeletedStandardPostMessageFragment_deletionInfo"};case"AnnouncementPostMessage":return{fragment:v,fragmentName:"DataClientChatDeletedAnnouncementPostMessageFragment_deletionInfo"};case"EmailPostMessage":return{fragment:f,fragmentName:"DataClientChatDeletedEmailPostMessageFragment_deletionInfo"};case"MeetingPostMessage":return{fragment:b,fragmentName:"DataClientChatDeletedMeetingPostMessageFragment_deletionInfo"};case"ConnectorPostMessage":return{fragment:k,fragmentName:"DataClientChatDeletedConnectorPostMessageFragment_deletionInfo"};case"GuardiansPostMessage":return{fragment:C,fragmentName:"DataClientChatDeletedGuardiansPostMessageFragment_deletionInfo"};default:return{fragment:o,fragmentName:"deletionInfo"}}}(n),d=`${n}:${t}`;try{const a=e.readFragment({id:d,fragment:s,fragmentName:l});a&&e.writeFragment({id:d,fragment:s,data:Object.assign(Object.assign({},a),{id:t,deleteTime:r,deletionInfo:{__typename:"Message"===n?"DeletionInfo":"MessageDeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:i},version:(0,_.M)()[0].toString()})})}catch(e){a.error(`Failed to updateCachedMessageForDelete for messageId: ${t}`)}}function N(e,t,n){let i=[];try{if(i=D(e,n),i.find((e=>e.id===t)))return;const a=`Message:${t}`,o=e.readFragment({id:a,fragment:r,fragmentName:"messageFieldsForDeletedMessages"}),l=Object.assign(Object.assign({},o),{id:`${o.id}_deleted`}),c={id:t,message:l,__typename:"DeletedMessage"};return i=[c,...i],e.writeQuery({query:s,data:{deletedMessages:i}}),c}catch(e){n.error(`Failed to addDeletedMessageToCacheForUndelete for messageId: ${t}`)}}function A(e,t,n,i){try{const a=D(e,i),{message:o,isDeletedLieMessage:l}=R(e,t,n,i,!1,a);if(o){const i=a.filter((e=>{var i;return l?(null===(i=e.message)||void 0===i?void 0:i.clientMessageId)!==n:e.id!==t})),c=Object.assign(Object.assign({},o.message),{id:t,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},version:(0,_.M)()[0].toString(),__typename:"Message"});e.writeQuery({query:s,data:{deletedMessages:i}});const d=`Message:${t}`;return e.writeFragment({id:d,fragment:r,data:c}),c}}catch(e){i.error(`Failed to removeDeletedMessageFromCacheForUndelete for messageId: ${t}`)}}function F(e,t,n,o){const r=i.Ps`
    fragment messageFieldsNeeded on Message {
      deleteTime
      importance
      deletionInfo {
        showMessageAsDeleted
        canBeUndeleted
        deleteFailed
      }
      version
    }
  `,s=`Message:${t}`;try{const t=e.readFragment({id:s,fragment:r});if(t){const i=t.importance===a.Ntc.Urgent;e.writeFragment({id:s,fragment:r,data:{deleteTime:n,importance:t.importance,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!!n,canBeUndeleted:!!n&&!i,deleteFailed:!1},version:(0,_.M)()[0].toString(),__typename:"Message"}})}}catch(e){o.error(`Failed to updateCachedMessageForUndelete for messageId: ${t}`)}}const D=(e,t)=>{let n;try{n=e.readQuery({query:s})}catch(e){t&&t.error("Unable to fetch deleted messages",e)}return n&&n.deletedMessages||[]},R=(e,t,n,i,a,o)=>{const r={message:null,isDeletedLieMessage:!1};if(!(o=o||D(e,i))||0===o.length)return r;if(!a){const e=o.find((e=>e.id===t));if(e)return{message:e,isDeletedLieMessage:!1}}const s=o.find((e=>e.message&&e.message.clientMessageId===n));return s?{message:s,isDeletedLieMessage:!0}:r}},675953:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"dlpDialogData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dlpDialogData"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isReport"}},{kind:"Field",name:{kind:"Name",value:"isOverride"}},{kind:"Field",name:{kind:"Name",value:"justification"}}]}}]}}]}},930262:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"insertedHyperlink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"insertedHyperlink"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayText"}},{kind:"Field",name:{kind:"Name",value:"address"}}]}}]}}]}},252959:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"smartReplyFileSuggestion"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"smartReplyFileSuggestion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileName"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}},706900:(e,t,n)=>{"use strict";n.d(t,{Om:()=>s,Ng:()=>l});var i=n(197981),a=n(47135);const o=[{predicate:e=>!!e.get(a.J.Presence).enablePresenceInWorker,resolvers:{query:["presence","presences"],mutation:["setPresence","setStatusNote","setCallStatePresence"],subscription:["presenceUpdateEvent"]}},{predicate:e=>!!e.get(a.J.Host).enableEspInWorker||!!e.get(a.J.Esp).enableEsp,resolvers:{query:["espState","irisCampaign"],mutation:["recordEligibleSurface","recordDisplayedSurface","recordEspCompletedActions","triggerNotificationDisplay"],subscription:["espTriggerEvent","espSurfaceShownEvent"]}},{predicate:e=>!!e.get(a.J.Guardians).enableMembersAndRelatedContactsWorkerResolver,resolvers:{query:["membersAndRelatedContacts"],mutation:[],subscription:[]}},{predicate:e=>!!e.get(a.J.Guardians).enableRelatedContactsWorkerResolver,resolvers:{query:["relatedContacts"],mutation:[],subscription:[]}},{predicate:e=>{var t,n;return!(!(null===(t=e.get(a.J.Host))||void 0===t?void 0:t.enableHybridDiscoverSurface)&&!(null===(n=e.get(a.J.DiscoverSurface))||void 0===n?void 0:n.enableHybridDiscoverSurface))},resolvers:{query:["feed"],mutation:["feedback","discoverSurfaceUserPreferenceForEntities","removeHasUpdatedItemsFlag","startPolling","stopPolling"],subscription:["replyChainSummaryEvent","discoverFeedHasUpdatedItems"]}},{predicate:e=>!!e.get(a.J.WhatsNew).enableWhatsNew,resolvers:{query:["whatsNewState"],mutation:["recordWhatsNewDisplayedFeature","recordWhatsNewEntryPointPromotion","recordWhatsNewEntryPointUserAction"],subscription:[]}}],r=[{predicate:e=>!!e.get(a.J.Host).enableOfflineActionsManager&&!!e.get(a.J.Host).msgEnableOfflineReactions,resolvers:{query:[],mutation:["updateMessageEmotion"],subscription:[]}},{predicate:e=>!!e.get(a.J.Messaging).msgEnableAutoSetConsumptionHorizonResolver,resolvers:{query:[],mutation:["setConsumptionHorizon"],subscription:[]}},{predicate:e=>!!e.get(a.J.Extensibility).enableAdaptiveAppletCacheFromCDL,resolvers:{query:[],mutation:["cardCacheOperation"],subscription:[]}}];function s(e,t){const{experimentalResolvers:n,stableResolvers:o}=e.get(a.J.Cdl),s=o&&o.resolvers||{query:[],mutation:[],subscription:[]};if(t.log(`Supported operations from config: ${JSON.stringify(s,d)}`),o&&o.version&&n&&n.version&&o.version>=n.version){const e=n.resolvers||{query:[],mutation:[],subscription:[]};t.log(`Supported operations from ECS: ${JSON.stringify(e,d)}`),(0,i.mergeWith)(s,e,u)}m(s,r,e,t);const l=(0,i.mapValues)(s,(e=>e?new Set(e):new Set)),{dataLayerSettings:g}=e.get(a.J.Host);return c(g,l,t,"Angular")}function l(e,t,n){const r=function(e,t){var n;let a;try{if(!t)throw new Error("CDL Worker did not return supported operations");a=JSON.parse(t)}catch(t){null===(n=e.errorToTelemetry)||void 0===n||n.call(e,`getWorkerSupportedOperations: Failed to set CDL Worker supported operations: ${t&&t.message}`,"cdl_worker_manager_get_worker_supported_operations_error",void 0,!0),a={query:[],mutation:[],subscription:[]}}return(0,i.mapValues)(a,(e=>e?new Set(e):new Set))}(t,n),{supportedResolvers:s,activitySupportedResolvers:l,mtmaMissedNotificationsSupportedResolvers:d,calendarSupportedResolvers:g,chatSupportedResolvers:p,chatPartiallySupportedResolvers:v,phonelinkSmsSupportedResolvers:h,appsUsageResolvers:f,peopleTargetingSupportedResolvers:y}=e.get(a.J.CdlWorker),b=function(e){const t={query:[],mutation:[],subscription:[]};return e.forEach((e=>e&&(0,i.mergeWith)(t,e,u))),t}([s,l,d,g,p,v,h,f,y]);return m(b,o,e,t),c(b,r,t,"Worker")}function c(e,t,n,a){if(!e)return{query:new Set,mutation:new Set,subscription:new Set};n.log(`Supported operations received from ${a}: ${JSON.stringify(e,d)}`);const o=(0,i.mapValues)(e,((e,n)=>new Set(e.filter((e=>t[n]&&t[n].has(e))))));return n.log(`Merged datalayer settings with config: ${JSON.stringify(o,d)}`),o}const d=(e,t)=>"object"==typeof t&&t instanceof Set?Array.from(t):t,u=(e,t)=>(0,i.isArray)(e)?e.concat(t):void 0;function m(e,t,n,a){const o={query:[],mutation:[],subscription:[]};t.forEach((({predicate:e,resolvers:t})=>{e(n)&&(0,i.mergeWith)(o,t,u)})),a.log(`Supported additional operations: ${JSON.stringify(o,d)}`),(0,i.mergeWith)(e,o,u)}},297774:(e,t,n)=>{"use strict";n.d(t,{nG:()=>l,zz:()=>c,Fj:()=>d});var i=n(786884),a=n(471285),o=n(197981),r=n(583229),s=n(934271);const l=(e,t,n)=>(0,s.C)(n,t).find((t=>t.id===e)),c=(e,t,n)=>{const i={currentFiles:[...(0,s.C)(t,n).map((t=>{const n=e.findIndex((e=>e.id===t.id));if(-1===n)return t;const i=e[n];e.splice(n,1);return(0,o.merge)({},t,i)})),...e]};t.writeQuery({query:r.gv.currentFilesQuery,variables:{fileContainerId:n},data:i})},d=(e,t,n)=>{const o=(0,s.C)(n,t),l=o.find((t=>t.id===e));if(!l)throw(0,i.Tr)("FileUploadResolver",a.jK.NotPresent,"removecachefile",{logErrorMessage:`File with id: ${e} not found  in the cache`});const c=o.filter((t=>t.id!==e));return n.writeQuery({query:r.gv.currentFilesQuery,variables:{fileContainerId:t},data:{currentFiles:c}}),l}},934271:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});var i=n(583229);const a=(e,t)=>{let n=null;try{n=e.readQuery({query:i.gv.currentFilesQuery,variables:{fileContainerId:t}})}catch(e){}return n||(n={currentFiles:[]}),n.currentFiles}},664058:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"customAppUploadResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAppUploadResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAppType"}}]}}]}}]}},576752:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppDevicePermissionsUpdatedQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDevicePermissionsUpdated"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}}]}},500161:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppsBadgeReadQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsBadgeRead"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},689288:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformInContextStoreLaunchInstalledAppResultQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"inContextStoreLaunchInstalledAppResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"capability"}},{kind:"Field",name:{kind:"Name",value:"appDisplayName"}},{kind:"Field",name:{kind:"Name",value:"draftId"}}]}}]}}]}},511225:(e,t,n)=>{"use strict";n.d(t,{r:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformTabDeletionResultQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelMeetingMessageId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tabDeletionResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}},{kind:"Argument",name:{kind:"Name",value:"channelMeetingMessageId"},value:{kind:"Variable",name:{kind:"Name",value:"channelMeetingMessageId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"channelMeetingMessageId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]}},657503:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageExtensionsAppsState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageExtensionsAppsState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toggleRefetch"}}]}}]}}]}},786213:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"tabConfigurationResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tabConfigurationResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]}},503155:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webhookConfirmationResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webhookConfirmationResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},822927:(e,t,n)=>{"use strict";n.d(t,{w:()=>s});var i=n(882975),a=n(402393),o=n(197981);function r(e,t,n=!0){var a;let r=[];try{const t=e.readQuery({query:i.i8});r=null!==(a=null==t?void 0:t.activeWindows)&&void 0!==a?a:r}catch(e){t.warn(`cache.readQuery failed for activeWindowsQuery with ${e}`)}return n?(0,o.cloneDeep)(r):r}const s=()=>({Query:{activeWindows:(e,t,{cache:n,loggerFactory:i})=>r(n,i.newLogger("activeWindows-query","data-client-windows"),!1)},Mutation:{removeWindow(e,{windowId:t},{cache:n,loggerFactory:o,commandChangeReportingService:s}){const l=o.newLogger("removeWindow-mutation","data-client-windows"),c=r(n,l),d=c.findIndex((e=>e.id===t));if(d>=0){const e=function(e,t,n){const a=e.splice(t,1);return n.writeQuery({query:i.i8,data:{activeWindows:e}}),a[0]}(c,d,n);return s.report({type:a.B.Close,correlationId:e.correlation.id,context:{target:"remove-window-mutation"},userContextId:e.userContextId||void 0}),e}return l.warn(`Removing window that does not exist ${t}`),null}}})},752823:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var i=n(882975);function a(e){e.writeQuery({query:i.i8,data:{activeWindows:[]}})}},225222:(e,t,n)=>{"use strict";n.d(t,{Be:()=>m});var i=n(324018),a=n(334476),o=n(112653),r=n(245919),s=n(321813),l=n(770754),c=n(17284),d=n(908129),u=n(878987);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonAnnouncementPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"announcement"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"originalImageUrl"}},{kind:"Field",name:{kind:"Name",value:"croppedImageUrl"}},{kind:"Field",name:{kind:"Name",value:"colorTheme"}},{kind:"Field",name:{kind:"Name",value:"croppedImageHeight"}},{kind:"Field",name:{kind:"Name",value:"croppedImageWidth"}},{kind:"Field",name:{kind:"Name",value:"croppedImageAltText"}},{kind:"Field",name:{kind:"Name",value:"isTeamsIllustration"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.w.definitions,...o.p.definitions,...r.S.definitions,...s.v.definitions,...l.w.definitions,...c.x.definitions,...d.I.definitions,...u.M3.definitions]}},692639:(e,t,n)=>{"use strict";n.d(t,{E3:()=>m});var i=n(324018),a=n(334476),o=n(112653),r=n(245919);const s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"from"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"sender"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"to"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"cc"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"emailLink"}},{kind:"Field",name:{kind:"Name",value:"totalRecipients"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"smtp"}}]}}]}.definitions]};var l=n(321813),c=n(770754),d=n(17284),u=n(908129);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"emailDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.w.definitions,...o.p.definitions,...r.S.definitions,...s.definitions,...l.v.definitions,...c.w.definitions,...d.x.definitions,...u.I.definitions]}},878987:(e,t,n)=>{"use strict";n.d(t,{M3:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"meetingTitle"}},{kind:"Field",name:{kind:"Name",value:"meetingActionType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment_scheduledMeetingInfo"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment_scheduledMeetingInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ScheduledMeetingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUID"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}}]}}]}.definitions]}},301762:(e,t,n)=>{"use strict";n.d(t,{lU:()=>m});var i=n(334476),a=n(112653),o=n(245919),r=n(324018),s=n(878987),l=n(321813),c=n(770754),d=n(17284),u=n(908129);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.w.definitions,...a.p.definitions,...o.S.definitions,...r.Uw.definitions,...s.M3.definitions,...l.v.definitions,...c.w.definitions,...d.x.definitions,...u.I.definitions]}},356449:(e,t,n)=>{"use strict";n.d(t,{yM:()=>m});var i=n(112653),a=n(245919),o=n(334476),r=n(321813),s=n(770754),l=n(324018),c=n(878987),d=n(17284),u=n(908129);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingReplyMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.p.definitions,...a.S.definitions,...o.w.definitions,...r.v.definitions,...s.w.definitions,...l.Uw.definitions,...c.M3.definitions,...d.x.definitions,...u.I.definitions]}},405716:(e,t,n)=>{"use strict";n.d(t,{lB:()=>u});var i=n(324018),a=n(112653),o=n(245919),r=n(334476),s=n(321813),l=n(770754),c=n(908129),d=n(17284);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonReplyMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}},{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.p.definitions,...o.S.definitions,...r.w.definitions,...s.v.definitions,...l.w.definitions,...c.I.definitions,...d.x.definitions]}},501183:(e,t,n)=>{"use strict";n.d(t,{w3:()=>u});var i=n(324018),a=n(334476),o=n(112653),r=n(245919),s=n(321813),l=n(770754),c=n(908129),d=n(17284);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonStandardPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.w.definitions,...o.p.definitions,...r.S.definitions,...s.v.definitions,...l.w.definitions,...c.I.definitions,...d.x.definitions]}},785773:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ActionCategory:()=>i.hXz,ActionItemConfidence:()=>i.IGm,ActionItemOwnershipType:()=>i.QFN,ActionItemsModelInsightType:()=>i.sjk,ActionType:()=>i.Usq,ActiveContextType:()=>i.xz$,Activity:()=>i.cS$,ActivityType:()=>i.T8Q,ActorToItemRelationshipType:()=>i.xa1,AgendaViewEndState:()=>i.OQO,AiInsertOperationStatus:()=>i.n1g,AiInsightsOperationType:()=>i.kfo,AlertActionType:()=>i.c3b,AlertSeverity:()=>i.BLW,AlertType:()=>i.NK9,AliasVisibilitySetting:()=>i.Ei,AllowVoicemail:()=>i.jx2,AllowedNotificationsEngineParams:()=>i.Jbg,AllowedSenderType:()=>i.MTl,AltScenarioAction:()=>i.JPG,AmsItemType:()=>i.YEG,AnnotationEventType:()=>i.Vuv,AppBasedLinkAppResultType:()=>i.LYR,AppBasedLinkCachePolicyType:()=>i.XW6,AppBasedLinkPreviewType:()=>i.sQ6,AppCapability:()=>i.PwB,AppConsumptionHorizonAppType:()=>i.g2l,AppDefaultInstallScope:()=>i.s8E,AppDevicePermissionType:()=>i._Ll,AppDevicePermissionsUpdatedStatus:()=>i.VDl,AppGroupCapability:()=>i.JEf,AppInstallScope:()=>i.qi6,AppInstallationStates:()=>i.JMQ,AppKind:()=>i.OPt,AppPermissionNodeType:()=>i.YVt,AppReviewReportCategory:()=>i.$hY,AppReviewSource:()=>i.dXV,AppReviewsFilter:()=>i.yhY,AppReviewsSort:()=>i.Y5e,AppServiceState:()=>i.YHP,ApplicationIdentityType:()=>i.FXX,AppointmentType:()=>i.Vne,ApprovalAction:()=>i.m0e,ArgumentValueType:()=>i.K6z,ArtifactType:()=>i.BzI,AskPermissionTicketState:()=>i.zO$,AttachmentLayout:()=>i.kUQ,AttachmentType:()=>i.sfQ,AttendanceReportType:()=>i.LmM,AttendeeClientType:()=>i.wGx,AttendeeConsentType:()=>i.ZB_,AttendeeGroupType:()=>i.H9H,AttendeeRegistrationStatus:()=>i.MSv,AttendeeRestrictableModality:()=>i.Zwl,AttendeeType:()=>i.Ili,AudienceType:()=>i._BL,AudioUsageMode:()=>i.nUz,AuthenticationAccountType:()=>i.Chc,AuthenticationCloudType:()=>i.G7Z,AuthenticationState:()=>i.zGj,AuthenticationUserRole:()=>i.w4O,AuthenticationUserSubType:()=>i.Yfn,AutoAdmittedUsersOption:()=>i.Hl5,Availability:()=>i.a8y,AvailabilityFreeBusyType:()=>i.o2x,AvatarMediaType:()=>i.FHR,BackgroundImageContext:()=>i.nEL,BannerAction:()=>i.sRD,BannerName:()=>i.XDy,BannerNotificationCause:()=>i.lFB,BannerNotificationIntentLevel:()=>i.XuV,BiometricVoiceEnrollmentStatus:()=>i.nK,BlobType:()=>i.R0O,BotAuthResultType:()=>i.MnL,BotConfigResultTypes:()=>i.$xD,BotMessagePreviewAction:()=>i.WVv,BotSourceType:()=>i.xUu,BreakoutRoomActionState:()=>i.CF7,BreakoutRoomsAssignmentType:()=>i.vSz,BreakoutRoomsCreationStatus:()=>i.Ivr,BreakoutRoomsSettingsStatus:()=>i.OIX,BroadcastLayoutType:()=>i.v6g,BroadcastMeetingAccessLevel:()=>i.VwM,BroadcastParticipantRole:()=>i.tf6,BroadcastPlayerType:()=>i.A49,BroadcastSectionType:()=>i.sTL,BroadcastStatus:()=>i.TPs,BroadcastStreamType:()=>i.jld,BroadcastType:()=>i.G7F,BrowserChoice:()=>i.dOI,BuddyGroupType:()=>i.Io4,BusyOnBusyOptions:()=>i.M4c,CalendarAppointmentType:()=>i.eQ$,CalendarArtifactGroupType:()=>i.Ulw,CalendarArtifactType:()=>i.Frf,CalendarAvailabilityType:()=>i.tL2,CalendarErrorCode:()=>i.xNx,CalendarEventSelectFields:()=>i.ufv,CalendarEventType:()=>i.oDm,CalendarFormErrorType:()=>i.P3i,CalendarFormSlotType:()=>i.YQ8,CalendarInsightType:()=>i.y3S,CalendarMeetingScheduleType:()=>i.MUv,CalendarScenarioStatus:()=>i.jQt,CalendarSyncStatusEnum:()=>i.vo$,CallACSRecordingState:()=>i.npU,CallAbortReason:()=>i.Vos,CallAction:()=>i.LWr,CallAppContentSharingMode:()=>i.VRN,CallBlockingAction:()=>i.IU_,CallClosedCaptionStatus:()=>i.I_G,CallClosedCaptionsStatus:()=>i.Ge7,CallCoachStatus:()=>i.T3A,CallDeviceShortcutType:()=>i.zYS,CallDirection:()=>i.kwT,CallForwardingTargetType:()=>i.Ryo,CallForwardingType:()=>i.Io1,CallGroupNotification:()=>i.fCN,CallGroupNotificationOverride:()=>i.ICr,CallHandlingAssociationType:()=>i.UiT,CallHealthState:()=>i.x1h,CallLocalRecordingState:()=>i.URt,CallLogCallState:()=>i.Qv1,CallLogCallType:()=>i.BdF,CallLogSessionType:()=>i.FTP,CallLogTransferStatus:()=>i.hyV,CallParticipantKind:()=>i.xys,CallPptSharingChangeSlideAction:()=>i.XR$,CallQueueActionTargetType:()=>i.cw,CallQueueConfigurationType:()=>i.Cdg,CallQueueNoAgentAction:()=>i.kG0,CallQueueOverflowAction:()=>i.BNj,CallQueueRoutingMethod:()=>i.SIK,CallQueueTimeoutAction:()=>i.RJA,CallRecordingState:()=>i.OJN,CallRedirectionTargetType:()=>i.QeU,CallRefreshSettingsType:()=>i.jpo,CallTranscriptEntryType:()=>i.YnP,CallTranscriptState:()=>i.prp,CallVoiceCollectionState:()=>i.Uq$,CallingAppEventResolutionSourceName:()=>i.BHj,CallingAppEventSourceName:()=>i.eb2,CallingContentActionVisibility:()=>i.KRy,CallingIntentType:()=>i.GXC,CallingScreenGalleryType:()=>i.Iho,CallingServiceEntrypointType:()=>i.cCY,CallingServiceState:()=>i.h6$,CallingWindowingExperienceMode:()=>i.wml,CaptionFontSizeType:()=>i.$0E,CardCacheOperationType:()=>i.mz$,ChannelCrossPostStatus:()=>i.OQk,ChannelMessageEventType:()=>i.n96,ChannelPinPostPermissions:()=>i.s8d,ChannelPostPermissions:()=>i.XIP,ChannelReplyPermissions:()=>i.ytf,ChannelSystemMessageRoleUpdateType:()=>i.Tak,ChannelThreadSubType:()=>i.P7$,ChannelType:()=>i.xuW,ChatAssociationError:()=>i.Fu9,ChatDisabledContextReason:()=>i.Z4B,ChatListEventType:()=>i.Rb4,ChatSubType:()=>i.k2e,ChatType:()=>i.z_3,ChatTypeFilter:()=>i.sTm,ClaimedConversationImportState:()=>i.B1J,ClientChannelType:()=>i.kK_,ClientDeviceType:()=>i.AeV,ClientPreferencesCategory:()=>i.wIZ,ClosedCaptionsSettingsCaptionColorType:()=>i.wls,ClosedCaptionsSettingsCaptionHeightType:()=>i.JKW,ClosedCaptionsSettingsFontSizeType:()=>i.aR8,ClosedCaptionsSettingsPositionType:()=>i.xvC,ClosedCaptionsTextTrackSource:()=>i.clf,CommandActions:()=>i.kjp,CommandContext:()=>i.Ae9,CommandSource:()=>i.Dyf,CommentStreamContentType:()=>i.J37,CommunityJoinRequestsActionType:()=>i.H0s,CompliancePolicyStatus:()=>i._Bi,CompliancePolicyType:()=>i.Q9H,ComplianceRecordingState:()=>i.l8x,ComposeLanguagePromptEvent:()=>i.GQc,CompositorRenderType:()=>i.zct,ConfigurableTabContext:()=>i.jDS,ConnectedAccountRequestSource:()=>i.dcg,ConnectedCalendarSource:()=>i.xP5,ConsultMode:()=>i.gXl,ContactDataSource:()=>i.l5h,ContactsSyncError:()=>i.yOG,ContactsSyncSource:()=>i.VTC,ContactsSyncType:()=>i.ERR,ContactsSyncWorkflowStatus:()=>i.LUR,ContainerState:()=>i.MZr,ContentCameraType:()=>i.WR8,ContentType:()=>i.zcD,ConversationIdentityType:()=>i.kge,ConversationMemberRole:()=>i.dRH,CorrelationSourceHint:()=>i.c$2,CortanaState:()=>i.YN3,CourseMembersAndOwnersStatus:()=>i.BFo,CreateCompositorContext:()=>i.BsF,CreateLinkType:()=>i.U4g,CurrentCallingState:()=>i.rsL,CustomAppType:()=>i.LQX,CustomBackgroundImageCategory:()=>i.ws1,CustomFrameAreaEventType:()=>i.zO9,CustomLayoutSelection:()=>i.XoC,DCGPhonelinkSmsServiceErrorCode:()=>i.ODi,DLResultError:()=>i.AcR,DebugBroadcastParticipantRole:()=>i.X9x,DebugBroadcastStateStatus:()=>i.Fd9,DebugBroadcastType:()=>i.ffC,DeepLinkChicletState:()=>i.TDJ,DeeplinkedMessageState:()=>i.IEi,DeltaRequestMode:()=>i.yNt,Density:()=>i.AMX,DeviceType:()=>i.Yii,DeviceTypeInput:()=>i.y2I,DevicesMeetingType:()=>i.LVq,DialogAction:()=>i.Liy,DialogContentType:()=>i.jWr,DialogName:()=>i.WBC,DisableReasonCode:()=>i.Rdl,DisallowedToPostReason:()=>i.Jb0,DiscoverSurfacePreference:()=>i.H9T,DiscoverSurfaceScopeForPreference:()=>i.XdF,DiscoverSurfaceUserPreferenceEntity:()=>i.v0k,DisplayWaterMark:()=>i.mGI,DisposeReason:()=>i.pMG,DisposeSource:()=>i.QuG,DocumentViewerFileType:()=>i.mFq,DurableTaskWorkflowStatus:()=>i.Slq,ElementType:()=>i.Hdy,EmailDigestOptions:()=>i.vdn,EmailNotificationOptions:()=>i.SMg,EmergencyLocationType:()=>i.LQ7,EmotionAction:()=>i.PFp,EmotionKey:()=>i.aUL,EngagementSurface:()=>i.C55,EngagementType:()=>i.phe,EntityAction:()=>i.ukP,EntityStateTransition:()=>i.suD,EntityType:()=>i.pyR,EntityVisibilityState:()=>i.feW,EnvironmentSupport:()=>i.Ln2,EscalationModality:()=>i.F6r,EspActionType:()=>i.f4k,EspAlignment:()=>i.Qbq,EspExternalTelemetryType:()=>i.P7M,EspModalImageStyling:()=>i.jlU,EspPosition:()=>i.uNA,EspResourceType:()=>i.EK3,EspTrigger:()=>i.LQM,EventActionType:()=>i.qeQ,ExperienceAccountMode:()=>i.bzN,ExtendedContainerState:()=>i.oqG,ExtensibilityAppPickerAppCapability:()=>i.QUi,ExtensibilityAppPickerAppSectionLayout:()=>i.qcc,ExtensibilityAppPickerCategories:()=>i.Xom,ExtensibilityAppPickerConfigKey:()=>i.lhu,ExtensibilityAppPickerInstallScope:()=>i.LHZ,ExtensibilityAppPickerInstallationStates:()=>i.Nbe,ExtensibilityAppPickerLayout:()=>i.ydL,ExtensionPointTypes:()=>i._WJ,ExternalAccountProvider:()=>i.RqE,ExternalCloudStorageProviderCode:()=>i.mFJ,FeedbackActionType:()=>i.vXL,FeedbackCallType:()=>i.ven,FeedbackMetadataFeatureArea:()=>i.NsI,FeedbackMetadataFeedbackType:()=>i.Af8,FeedbackService:()=>i.TBq,FeedbackSignalType:()=>i.oNc,FeedbackType:()=>i.nwx,FileAttachSuggestionSource:()=>i.$qY,FileChicletState:()=>i.cj1,FileOpenPreference:()=>i.Djg,FileUploadStatus:()=>i.XXy,FileViewServiceName:()=>i.a4b,FilesNavigationType:()=>i.BUw,FilesProviderType:()=>i.RWp,FluidContextType:()=>i.$Q1,FluidSourceType:()=>i.Da2,FluidUrlPermissionState:()=>i.WzC,FlyoutCameraUserChoice:()=>i.CRV,FreeBusyType:()=>i.eN,FrontRowDefaultPanelType:()=>i.wkl,FrontRowVideoSize:()=>i.dxg,GeneralChannelPosting:()=>i.S1B,GestureBasedReactionServiceState:()=>i.clb,GestureReactionStatus:()=>i.Kb4,GestureReactionType:()=>i.osM,GiphyRatingType:()=>i.m1e,GreetActiveType:()=>i.nzs,GridViewSectionId:()=>i.y$p,GuardiansAnnouncementStatus:()=>i.vJe,GuestInviteError:()=>i.wzb,HolographicDeviceType:()=>i.VpQ,HolographicInteractionComponent:()=>i.Dhn,HostTheme:()=>i.Up8,ImageDownloadStatus:()=>i.XGL,InfoPaneState:()=>i.MwA,InsightKindEnum:()=>i.UMR,InsightProcessingResultStatus:()=>i.kBB,InstalledAppSortType:()=>i.YeP,InstalledAppsUpdateEventType:()=>i.rQh,InteractionCommand:()=>i.e30,InteropConversationStatus:()=>i.uI5,InvitationState:()=>i.MwQ,InviteLinkType:()=>i.WZ1,JoinActionType:()=>i.Xh1,JoinRequestErrors:()=>i.r2Q,LabelPrivacy:()=>i.CB9,LandingScreen:()=>i.kAY,LayoutModes:()=>i.lOW,LayoutType:()=>i.msV,LeftRailSettingsCalendarType:()=>i.LwA,LinkScopeInput:()=>i.ENt,LinkType:()=>i.UnB,LinkTypeInput:()=>i.CNO,LiveStreamCaptionsLocale:()=>i.eNG,LiveStreamPlaybackError:()=>i.UT7,LiveStreamPlaybackState:()=>i.gzh,LoadDirection:()=>i.bGy,LocaleParamsType:()=>i.NtM,LocationType:()=>i._iy,M365AppFilter:()=>i.rB1,MediaEventType:()=>i.ZnX,MeetAppAction:()=>i.wR5,MeetAppEventInsightSource:()=>i.sTX,MeetAppEventResponse:()=>i.xen,MeetAppScenario:()=>i.$pD,MeetAppTopic:()=>i.IEy,MeetAppTranscriptFragmentSource:()=>i.oR$,MeetForWorkAction:()=>i.mez,MeetForWorkErrorType:()=>i.lcg,MeetForWorkFilterTab:()=>i.KY$,MeetForWorkRecurrencePatternType:()=>i.j5k,MeetForWorkResultStatus:()=>i.YXx,MeetForWorkScenario:()=>i.unu,MeetForWorkWeekDay:()=>i.Oig,MeetingAgendaHostClient:()=>i.mTO,MeetingAgendaState:()=>i.LJK,MeetingAgendaType:()=>i.ZAT,MeetingArtifactResourceType:()=>i.Xjc,MeetingArtifactType:()=>i.ceh,MeetingAttendanceType:()=>i.yG1,MeetingChatNotificationValue:()=>i.Cyn,MeetingChatPolicy:()=>i.UOl,MeetingJoinType:()=>i.cku,MeetingOptionsError:()=>i.aVM,MeetingOptionsPredicateOperator:()=>i.NNg,MeetingOptionsUserType:()=>i.X6H,MeetingPanelLocation:()=>i.su9,MeetingReactionType:()=>i.Le1,MeetingRecapCatchupItemsStatus:()=>i.M_S,MeetingRecommendationEntityType:()=>i.T1N,MeetingRecordingType:()=>i.u1r,MeetingResponseType:()=>i.Vf1,MeetingRoomAppState:()=>i.wVt,MeetingRoomDefaultFoRLayoutType:()=>i.gcs,MeetingRoomFrontOfRoomCallPanel:()=>i.gCs,MeetingRoomLayoutSelection:()=>i.XKC,MeetingRoomMeetingLinkUrlSource:()=>i.z$r,MeetingRoomRemoteControlLayoutType:()=>i.MEc,MeetingRoomThemeName:()=>i.LB2,MeetingStatus:()=>i.ytK,MeetingSummaryQnAType:()=>i.XRp,MeetingSurface:()=>i.Ajc,MeetingType:()=>i.wJZ,MembersAndRelatedContactsError:()=>i.c0v,MembershipType:()=>i.$cQ,MenuOptionsAction:()=>i.gre,MenuOptionsCallTargetType:()=>i.xWr,MessageAttachedType:()=>i.HBY,MessageExtensionCommandContextType:()=>i.ht_,MessageExtensionCommandType:()=>i.wHp,MessageExtensionInputType:()=>i.evG,MessageExtensionInvokeCacheFetchPolicy:()=>i.EG2,MessageImportance:()=>i.Ntc,MessageImportanceInGraphFormat:()=>i.rgk,MessageLanguageStatus:()=>i.YYW,MessageRenderType:()=>i.Mem,MessageReplyPermissions:()=>i.P$n,MessageSize:()=>i.TEU,MessageStatus:()=>i.rJC,MissedActivityOfConversationType:()=>i.W2,MissedMtmaNotificationSignals:()=>i.gNb,MissedNotificationsIconsBadgeType:()=>i.cOo,ModelDirectiveScope:()=>i.qPe,MuteAllScope:()=>i.h$0,MuteTeamErrors:()=>i.fFE,NavigationDirection:()=>i.fEB,NoAgentApplyTo:()=>i.IH6,NoiseSuppressionMode:()=>i.zk2,NoiseSuppressionSupport:()=>i.tHj,NotificationSettingsOptions:()=>i.HrE,NotificationType:()=>i.k$E,OfflineActionType:()=>i.vJk,OneDriveForBusinessAvailability:()=>i.UQW,OneDriveItemType:()=>i.$IJ,OneGQL_PersonAnniversaryType:()=>i.U6l,OneGQL_PersonContactSortField:()=>i.Sej,OneGQL_PersonRawCollectionSortField:()=>i.z$1,OneGQL_PersonRelationship:()=>i.bkD,OneGQL_PersonTagColor:()=>i.zMv,OneGQL_PersonaAddressType:()=>i.swL,OneGQL_PersonaBodyType:()=>i.AyW,OneGQL_PersonaEmailType:()=>i.xK,OneGQL_PersonaPhoneType:()=>i.nmV,OneGQL_PersonaPropertySource:()=>i.oDq,OneGQL_PresenceAvailabilityType:()=>i.rr4,OneGQL_PresenceFrontLineWorkerPresence:()=>i.Ie1,OneGQL_PresenceSettableAvailabilityType:()=>i.ebH,OneGQL_PresenceStatusNoteExpiryPreDefinedEnum:()=>i.ehc,OneGQL_SortDirection:()=>i.L8l,OptionExternalFeedType:()=>i.sfo,OptionInterpretationType:()=>i.xHp,OptionPersonType:()=>i.vE1,OptionValueType:()=>i.Of,OutOfOfficeExternalAudience:()=>i.TEL,OutOfOfficeStatus:()=>i.b8x,OutlookAutoRunEventOptionsSendMode:()=>i.nkg,OutlookRequirementsFormFactor:()=>i.YIJ,OutlookRequirementsScope:()=>i.z7v,OutlookRibbonsContext:()=>i.Rk4,OutlookRibbonsTabGroupControlType:()=>i.Q$q,OutlookRibbonsTabPostionAlign:()=>i.bh4,OutlookRuntimesLifetime:()=>i.GYn,OutlookRuntimesType:()=>i.HOj,OverflowRoomCallState:()=>i.O3C,ParentsAnnouncementsStatus:()=>i.opK,ParkContext:()=>i.YYO,ParticipantChangeType:()=>i.bCV,ParticipantJoinMeetingMode:()=>i.Mck,ParticipantState:()=>i.b1t,PeoplePickerFor:()=>i.TSI,PerformanceMode:()=>i.eft,PermissionScope:()=>i.UWY,PhoneNumberFormat:()=>i.M9W,PhoneNumberType:()=>i.fk5,PhoneType:()=>i.z_G,PhonelinkSmsPairingStatus:()=>i.mZW,PinOperation:()=>i.Ygv,PinnedConversationItemType:()=>i.Voh,PinnedPostContentType:()=>i.OLn,PlaceType:()=>i.ASP,PlatformAppPermission:()=>i.$Kr,PlatformAppsFetchSource:()=>i.p1$,PlatformTabEventType:()=>i.OPX,PlatformTabSettingsTypes:()=>i.Qhk,PlatformTabsEntryPoint:()=>i.sqJ,PlatformTabsQueryType:()=>i.rtK,PolicyViolationType:()=>i.btQ,PollOnDemandSupportedSettingsNamespaces:()=>i.x4d,PostType:()=>i.hQF,PptSharingContentMode:()=>i.h88,PptSharingMode:()=>i.h5P,PptSharingSource:()=>i.HnM,PresenceLocationType:()=>i.A1$,PresenceSource:()=>i.W8Z,ProfileType:()=>i.pqZ,ProvenanceType:()=>i.DTV,PtzControlCommand:()=>i.mH$,PtzErrorReason:()=>i.c$B,PtzSessionTerminatedReason:()=>i.DGS,QuestionnaireItemType:()=>i.yVM,ReactionType:()=>i.lom,RecorderOption:()=>i.Em8,RecordingPublishProgressStatus:()=>i.D73,RedeemIssueType:()=>i.Hy_,RegistrationOperationType:()=>i._Gd,RegistrationQuestionCategory:()=>i.LE8,RegistrationQuestionType:()=>i.D8e,RelatedContactError:()=>i.HTB,RelatedContactStatus:()=>i.Loq,RelevanceRelationshipType:()=>i.amW,ReportConcernContext:()=>i.Xzf,ReportConcernReason:()=>i.RaO,ResultTypes:()=>i.CO3,RingtoneCallType:()=>i.s1w,RingtoneNames:()=>i.rRG,RoomBookingType:()=>i.KZH,RoomRemoteMediaControlsCapabilities:()=>i.oXn,RoomRemoteMeetingControlsCapabilities:()=>i.TPi,RoomRemoteStageLayoutControlsCapabilities:()=>i.DjH,ScalingMode:()=>i.p8s,ScdStatus:()=>i.BIC,SchedulingFormTaskState:()=>i.vDg,SchedulingFormTaskType:()=>i.EhV,SchedulingFormTerminatingActionType:()=>i.ts3,SchedulingServiceEventType:()=>i._eA,SchedulingServiceMeetingPromiseState:()=>i.XlO,ScreenShareControlState:()=>i.jer,ScreenSharingControlStateAsViewer:()=>i.CDU,SearchBoxAction:()=>i.dQF,SearchHistoryAction:()=>i.rZ3,SearchSuggestionActionType:()=>i.fZW,SearchSuggestionEntitySource:()=>i.NPL,SearchSuggestionEntityType:()=>i.Bpo,SearchSuggestionGroupType:()=>i.orD,SearchSuggestionIconType:()=>i.$nY,SendFeedbackType:()=>i.wJo,SendMessageAction:()=>i.xyM,ServiceRecourseQueryAlterationTypes:()=>i.xwW,ServiceTeamMembershipUpdateType:()=>i.Bo,SessionType:()=>i.FFn,SettingsCategory:()=>i.Jpo,SettingsComponentLayoutType:()=>i.U5q,SettingsComponentType:()=>i.VSu,SettingsPaneCategory:()=>i.XQ2,SettingsPanelTab:()=>i.NHA,SettingsPanelTabElement:()=>i.ja_,ShareFormStatus:()=>i.f15,SharePointFileDocumentLibraryAccessType:()=>i.AjG,SharePointFileSpecialDocumentLibraryType:()=>i.q2e,SharePreviewType:()=>i.iTP,ShareableContentType:()=>i.c_Z,SharedWithTeamInvitationError:()=>i.HRx,SharingEntityType:()=>i.XDD,SharingLayoutMode:()=>i.EUN,SharingSourceType:()=>i.myd,SlotName:()=>i.WLT,SmbUserIntentType:()=>i.sCu,SmsDeliveryReportKey:()=>i.f1K,SortColumn:()=>i.Hn1,SortDirection:()=>i.SrV,SortOrderSources:()=>i.PaK,SpecialFolderName:()=>i.ZSI,SplitCallingScreenSource:()=>i.ig0,StaticImageType:()=>i.ynw,StaticTabContext:()=>i.BUQ,StaticTabID:()=>i.ozu,StatusBarMessageType:()=>i.fNK,StatusNoteExpiry:()=>i.v2d,StoreArticleMediaType:()=>i.OE2,StoreItemAttribute:()=>i.r7c,StoreItemFeature:()=>i.OO0,StoreItemKind:()=>i.fSs,StoreItemOrder:()=>i.qVz,StreamDeliveryPipelineType:()=>i.FT_,StreamLabel:()=>i.k3Z,StreamTranscriptionLocale:()=>i.w$N,StreamType:()=>i.jxR,StreamingAppState:()=>i.Vfj,StreamingEventType:()=>i.fNg,SubStageType:()=>i.Z7A,SubstrateEntityType:()=>i.JJh,SuggestionTimeQuality:()=>i.g9K,SupportedViewEntities:()=>i.tF7,SurveyFieldType:()=>i.oR4,SurveySourceContextOptions:()=>i.VLC,SyncBannerUserActionType:()=>i.zPu,SystemAudioDriverState:()=>i.pq3,SystemAudioSupport:()=>i.BYq,SystemSettingId:()=>i.l2X,TabPinnedState:()=>i.vb$,TaskModuleClosedReason:()=>i.Kks,TaskModuleEntryPoints:()=>i.gVh,TaskModuleUpdateType:()=>i.pyY,TeamAccessType:()=>i.eUH,TeamCreationStatus:()=>i.wZ4,TeamJoinState:()=>i.yvs,TeamJoinStatus:()=>i.ZHF,TeamLayoutPreferenceOptions:()=>i.$lW,TeamLockState:()=>i.iNV,TeamMemberRole:()=>i.k_p,TeamSettingsProperty:()=>i.reX,TeamType:()=>i.C9I,TeamsCameraFarEndPanTiltZoomControlMode:()=>i.phR,TeamsChannelPostInclusionReasonDetailedInclusionReasonEnum:()=>i._34,TeamsCollabContextType:()=>i.$u5,TeamsForCourseStatus:()=>i.V9I,TenantAnalyticsTeamTypeByPrivacy:()=>i.Bg,TenantAnalyticsTimeperiod:()=>i.nqg,TenantFeedbackAnswerType:()=>i.s1,TenantInvitationScenario:()=>i.nx0,TenantInvitationUserType:()=>i.eDm,TflMeetingType:()=>i.aU,Theme:()=>i.Q2A,ThirdPartyDevicePairingResult:()=>i.Z8d,ThumbnailBlobContentFetchResult:()=>i.WOu,ToastIntent:()=>i.GSK,ToastType:()=>i.pCN,ToggleHoldCallContext:()=>i.Vif,TokenType:()=>i.ivb,TranscriptArtifactType:()=>i.Dz_,TranscriptDownloadFormat:()=>i.Z9q,TranscriptEditType:()=>i.Cn5,TranscriptEventType:()=>i.Qen,TranslationAction:()=>i.ygE,TranslationFeedbackType:()=>i.taM,TranslationMode:()=>i.Lps,TranslationPreference:()=>i.zwH,TranslationRequestState:()=>i.kUj,TranslationStatus:()=>i.Yvc,TranslationStatusV2:()=>i.C14,TswSdkMessageType:()=>i.fXy,UnlockTeamResult:()=>i.arA,UpdateClientStateSource:()=>i.HRk,UpdateDelegatesAction:()=>i.fGh,UpdateLocalCacheSupportedPoliciesAndSettingsNamespaces:()=>i._fr,UpdatedMembersErrorType:()=>i.idH,UserAuthState:()=>i.JEq,UserClassification:()=>i.oNF,UserExperiencePreferencesCategory:()=>i.UZQ,UserFlwPresence:()=>i.kz6,UserIdentityType:()=>i.$xx,UserMeetingRole:()=>i.LXf,UserMeetingRoleType:()=>i.dOr,UserPreferencesCategory:()=>i.nV$,UserRole:()=>i.i44,UserRoleInConsultCall:()=>i.$i$,UserRoleInEmergencyCall:()=>i.DPJ,UserTheme:()=>i.SqH,VideoAppPostMessageEvent:()=>i.Cfe,VideoBackgroundImageState:()=>i.VCP,VideoEffect:()=>i.hvQ,VideoEffectReadinessOnDevice:()=>i.hFs,VideoEffectStateType:()=>i.MpO,VideoExtensibilityLifecycleEventType:()=>i.nWM,VideoExtensibilityPerfEventType:()=>i.iR3,VideoFileStatus:()=>i.cSI,VideoFrameFormat:()=>i.ipA,VideoManifestType:()=>i.WwQ,VideoMessageCaptionStatus:()=>i.OCt,VideoRotationDegree:()=>i.o0l,VideoScanType:()=>i.bax,ViewMode:()=>i.wOR,VirtualDesktopInfrastructureConnectedState:()=>i.Ws2,VirtualEventAccessType:()=>i.g8S,VirtualEventAction:()=>i.Mu6,VirtualEventEmailTemplateType:()=>i.UjV,VirtualEventRecurrenceType:()=>i.c87,VirtualEventRoleType:()=>i.ZR_,VirtualEventState:()=>i.Tg8,VirtualEventType:()=>i.i0v,VirtualEventsOrgProvisioningStatus:()=>i.Bq8,WebinarAccessPolicy:()=>i.yBp,WebinarField:()=>i.fjC,WebinarParticipantRole:()=>i.RyT,WebinarQuestionnaireType:()=>i.kg$,WebinarStatus:()=>i.MDw,WhatsNewActionType:()=>i.wi7,WhiteboardSharingContentMode:()=>i.Tuo,WhoCanPresentOption:()=>i.Vqf,WidgetType:()=>i.l9N,WindowingCoordsType:()=>i.cAL,WindowingLinkedContentType:()=>i.JLw,WindowingMode:()=>i.lCV,WindowsEffects:()=>i.sZ5,WindowsEffectsStates:()=>i.vhA});var i=n(244634)},275123:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i={M365Application:["M365HubApplication","M365PlatformApplication"],M365ApplicationIcon:["InternalIcon","RemoteImage"],M365ApplicationBadge:["M365ApplicationNumericBadge"],EventTrigger:["AppAcquisitionLink","AppSecondaryAction"],Node:["M365HubApplication","M365PlatformApplication","Conversation","Me","FullAccount","Cloud","ActiveTenant","InactiveTenant","MeInOtherTenant","Person","MePresence","PersonPresence","AvailabilityOption"],ConnectionEdge:["M365ApplicationEdge","AccountEdge","TenantEdge"],ConnectionEdgeWithCursorPagination:[],Connection:["M365ApplicationConnection","AccountConnection","TenantConnection"],ConnectionWithCursorPagination:[],MutationFailure:["PresenceMutationFailure","PresenceMutationFailureNetworkOffline"],BaseAccount:["FullAccount","Cloud"],Account:["FullAccount","Cloud"],Tenant:["ActiveTenant","InactiveTenant"],BaseTenant:["ActiveTenant","InactiveTenant"],Persona:["Me","MeInOtherTenant","Person"],Individual:["Me","MeInOtherTenant","Person"],Presence:["MePresence","PersonPresence"],PresenceStatusNoteExpiry:["PresenceStatusNoteExpiryPreDefined","PresenceStatusNoteExpiryCustom"],PresenceMutationResult:["PresenceMutationSuccess","PresenceMutationFailure","PresenceMutationFailureNetworkOffline"]}},765550:(e,t,n)=>{"use strict";n.d(t,{wf:()=>B,s_:()=>$});var i=n(361366),a=n(65903);const o=e=>e&&!!e.wamsStreamingUrl&&!!e.decryptionToken,r=(e,t,n)=>{var i,r,s,l;return{__typename:"Broadcast",id:e,admissionType:n.admissionType,type:t?a.G7F.Overflow:a.G7F.QuickStart,userRole:n.userRole||a.tf6.Attendee,correlationId:n.correlationId,title:n.subject,utcStart:n.utcStart||null,utcEnd:n.utcEnd||null,location:n.location||null,streamingDetails:c(e,n),qna:Object.assign(Object.assign({},n.qna),{isEnabled:(null===(i=n.qna)||void 0===i?void 0:i.isEnabled)||!1,attendeeUrl:(null===(r=n.qna)||void 0===r?void 0:r.attendeeUrl)||"",moderatorUrl:(null===(s=n.qna)||void 0===s?void 0:s.moderatorUrl)||"",iosAutodiscoverUrl:(null===(l=n.qna)||void 0===l?void 0:l.iosAutodiscoverUrl)||"",__typename:"BroadcastQnaMetadata"}),yammer:n.yammer&&{__typename:"BroadcastYammerMetadata",broadcastId:n.yammer.broadcastId,groupId:n.yammer.groupId,isEnabled:n.yammer.isEnabled,eventUrl:n.yammer.event}||null,meetingStatus:n.meetingStatus||(o(n.stream)||o(n.altStream)?a.ytK.Live:a.ytK.Created),supportUrl:n.supportUrl,sdn:u(n)||null,transcription:g(e,n),aesKey:Object.assign({__typename:"AESKey"},p(n)),aesKeyRefresh:n.aesKeyRefresh,error:n.error||null,signalR:Object.assign({__typename:"SignalRDetails"},v(n)),streamResource:h(n),broadcastRestartVersion:n.broadcastRestartVersion||0,odspVodShareUrl:n.odspVodShareUrl||null,access:f(n)}},s=e=>({__typename:"BroadcastAttendeeStream",wamsStreamingUrl:null==e?void 0:e.wamsStreamingUrl,decryptionToken:null==e?void 0:e.decryptionToken}),l=e=>({__typename:"BroadcastStreamingInfo",wamsStreamingUrl:(null==e?void 0:e.wamsStreamingUrl)||null,wamsHlsStreamingUrls:null,decryptionToken:(null==e?void 0:e.decryptionToken)||null,setKeyAuthorizationCookieUri:null,keyAuthorizationToken:null,sdn:d(e)||null,deliveryPipelineType:"AMS"}),c=(e,t)=>({__typename:"BroadcastStreamingDetails",id:e,stream:l(t.stream),altStream:l(t.altStream)}),d=e=>e&&e.sdnName&&e.sdnPluginUrl&&{__typename:"SDNDetails",name:e.sdnName,playbackInfo:e.sdnPlaybackInfo||"",pluginUrl:e.sdnPluginUrl,sdkUrl:""}||void 0,u=e=>e.stream&&d(e.stream)||e.altStream&&d(e.altStream),m=e=>e/1e3,g=(e,t)=>{var n,i,a,o,r,s;return{__typename:"BroadcastTranscription",id:e,isEnabled:null===(n=t.transcription)||void 0===n?void 0:n.isEnabled,isSuppressed:null===(i=t.transcription)||void 0===i?void 0:i.isSuppressed,translationLanguages:null===(a=t.transcription)||void 0===a?void 0:a.translationLanguages,transcriptionLanguage:null===(o=t.transcription)||void 0===o?void 0:o.transcriptionLanguage,captionsOriginUrl:null===(r=t.transcription)||void 0===r?void 0:r.captionsOriginUrl,captionsCacheUrl:null===(s=t.transcription)||void 0===s?void 0:s.captionsCacheUrl}},p=e=>{var t,n,i,a;return{id:(null===(t=e.aesKey)||void 0===t?void 0:t.id)||"",iv:(null===(n=e.aesKey)||void 0===n?void 0:n.iv)||"",expiry:(null===(i=e.aesKey)||void 0===i?void 0:i.expiry)||"",key:(null===(a=e.aesKey)||void 0===a?void 0:a.key)||""}},v=e=>{var t,n,i,a,o;return{attendeeHubName:(null===(t=null==e?void 0:e.signalR)||void 0===t?void 0:t.attendeeHubName)||null,eventTeamHubName:(null===(n=null==e?void 0:e.signalR)||void 0===n?void 0:n.eventTeamHubName)||null,url:(null===(i=null==e?void 0:e.signalR)||void 0===i?void 0:i.url)||null,querystrings:(null===(a=null==e?void 0:e.signalR)||void 0===a?void 0:a.querystrings)||null,setCookieUrl:(null===(o=null==e?void 0:e.signalR)||void 0===o?void 0:o.setCookieUrl)||null}},h=e=>{var t;return{__typename:"StreamResource",attendeeEmbed:(null===(t=e.streamResource)||void 0===t?void 0:t.attendeeEmbed)||""}},f=e=>{var t,n,i;return(null==e?void 0:e.access)&&{__typename:"BroadcastAccess",useLiveEventAuthorizationV2:null===(t=null==e?void 0:e.access)||void 0===t?void 0:t.useLiveEventAuthorizationV2,disableLobby:null===(n=null==e?void 0:e.access)||void 0===n?void 0:n.disableLobby,inInvitation:null===(i=null==e?void 0:e.access)||void 0===i?void 0:i.inInvitation,attendeeAuthorization:y(e)}||void 0},y=e=>{var t;return(null===(t=null==e?void 0:e.access)||void 0===t?void 0:t.attendeeAuthorization)&&{__typename:"BroadcastAttendeeAuthorization",errorCode:e.access.attendeeAuthorization.errorCode,subCode:e.access.attendeeAuthorization.subCode,details:e.access.attendeeAuthorization.details}||void 0};const b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"broadcast"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"roleHint"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"broadcast"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"roleHint"},value:{kind:"Variable",name:{kind:"Name",value:"roleHint"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastFragment"}}]}}]}},...n(562175)._L.definitions]},S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showInMeetingReport"}}]}}]}}]};var k=n(328497),w=n(343324),C=n(837804),_=n(786884);const T=e=>{const[t,n,i,o,r]=e.split("__");return{tenantId:t,organizerId:n,threadId:i,messageId:o,sessionId:r,roleHint:a.tf6.Attendee}},I=(e,t,n,a,o,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const i=(0,C.G5)(t),l=e.readQuery({query:b,variables:{id:i}});if(l)return l.broadcast;{const l=yield n.getAttendeeMeeting(a),c=r(t,o,l);return E(e,s,i,c),c}}catch(e){throw s.error(e),e}})),E=(e,t,n,i)=>{const a={broadcast:i};try{e.writeQuery({query:b,variables:{id:n},data:a})}catch(e){t.error(e)}},N=(e,t,n,a,o,r,s,l,c,d,u)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,m;if(A(e))return!1;const g=F(s,a,o,c,l,d),p=P(a,n);r.joinId=null===(m=null===(i=null==e?void 0:e.signalR)||void 0===i?void 0:i.querystrings)||void 0===m?void 0:m.joinid;const v=L(a,r,n,g,l,s,o,e.meetingStatus);try{const i=!o||u;return e.signalR&&e.signalR.url&&!e.error&&i?(yield t.subscribeToBroadcast(a,e.signalR,g,p,v),!0):!e.error&&(n.startPollingAttendeeMeeting(a,r,g,e.meetingStatus,!0),!0)}catch(t){return l.error(t),n.startPollingAttendeeMeeting(a,r,g,e.meetingStatus,!0),!0}})),A=e=>{var t;return e.meetingStatus===a.ytK.Stopped&&(null===(t=e.streamingDetails)||void 0===t?void 0:t.stream.wamsStreamingUrl)},F=(e,t,n,i,a,o)=>(s,l)=>{const d=D(o,t);let u="",m="";try{const o=(0,C.G5)(t),p=i.readQuery({query:b,variables:{id:o}}),v=null==p?void 0:p.broadcast;let h;if(v)if(h=Object.assign({},v),l===k.N.transcriptionStateUpdate)h.transcription=g(t,s),u="SignalR",m=k.N.transcriptionStateUpdate;else if(l===k.N.streamUpdateHubEvent){const e=c(t,s);if(R(e,v.streamingDetails))return void d.stop({broadcastData:"Duplicated update skipped"});h.streamingDetails=x(v,e),h.broadcastRestartVersion=s.broadcastRestartVersion,h.meetingStatus=M(v.broadcastRestartVersion,s.broadcastRestartVersion),u="SignalR",m=k.N.streamUpdateHubEvent}else h=Object.assign({},r(t,n,s)),u="Attendee Polling";else h=Object.assign({},r(t,n,s));const f=O(h);a.log(f),d.stop({broadcastData:JSON.stringify({updateSource:u,updateType:m,details:f})}),e.publish(`${k.V}-${t}`,{broadcastUpdatedEvent:h}),a.log(`New broadcast info successfully published for ${t}`),E(i,a,o,h)}catch(e){a.error(e),d.fail({broadcastData:`Error while processing broadcast update. updateSource: ${u}, updateType: ${m}`,broadcastError:e&&e.message})}},D=(e,t)=>{const n=e.newScenario(w.RG.BroadcastSubscriptionUpdate);return n.appendEventData({"Thread.Id":(0,C.G5)(t)}),n},R=(e,t)=>(null==e?void 0:e.stream.wamsStreamingUrl)===(null==t?void 0:t.stream.wamsStreamingUrl)&&(null==e?void 0:e.altStream.wamsStreamingUrl)===(null==t?void 0:t.altStream.wamsStreamingUrl),x=(e,t)=>{var n,i,a;return{__typename:"BroadcastStreamingDetails",stream:(null==t?void 0:t.stream)||(null===(n=e.streamingDetails)||void 0===n?void 0:n.stream),altStream:(null==t?void 0:t.altStream)||(null===(i=e.streamingDetails)||void 0===i?void 0:i.altStream),id:(null==t?void 0:t.id)||(null===(a=e.streamingDetails)||void 0===a?void 0:a.id)}},M=(e,t)=>(t=t||0)>(e=e||0)?a.ytK.Suspended:a.ytK.Created,O=e=>{var t,n,i,a,o,r,s,l;const c=e.broadcastRestartVersion,d=e.meetingStatus,u=null===(n=null===(t=e.streamingDetails)||void 0===t?void 0:t.stream)||void 0===n?void 0:n.wamsStreamingUrl,m=!!(null===(a=null===(i=e.streamingDetails)||void 0===i?void 0:i.stream)||void 0===a?void 0:a.decryptionToken),g=null===(r=null===(o=e.streamingDetails)||void 0===o?void 0:o.altStream)||void 0===r?void 0:r.wamsStreamingUrl,p=!!(null===(l=null===(s=e.streamingDetails)||void 0===s?void 0:s.altStream)||void 0===l?void 0:l.decryptionToken),v=e.transcription;return`broadcastRestartVersion: ${c}, meetingStatus: ${d}, stream: ${u}, isDecryptionTokenAvailable: ${m}, altStream: ${g}, isAltDecryptionTokenAvailable: ${p}, isTranscriptionEnabled: ${null==v?void 0:v.isEnabled}, isTranscriptionSuppressed: ${null==v?void 0:v.isSuppressed}`},P=(e,t)=>()=>{t.stopPollingAttendeeMeeting(e)},L=(e,t,n,i,a,o,r,s)=>l=>{if(!l){a.log("broadcast-subscripotion disconnect callback called not intentionally. Subscribing to attendee service polling.");try{n.startPollingAttendeeMeeting(e,t,i,s,!1)}catch(t){U(a,o,t.message,e,r)}}},U=(e,t,n,i,a)=>{e.error("Error while starting broadcast updates subscription");const o=r(i,a,{error:{errorMessage:n}});t.publish(`${k.V}-${i}`,{broadcastUpdatedEvent:o})};var j=n(47135);const $={Query:{broadcastAttendeeMeeting(e,{broadcastAttendeeMeetingParams:t},{cache:n,coreSettings:a,getBroadcastAttendeeService:o,loggerFactory:r}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=a.get(j.J.MeetingArtifacts);let i=!0;const l=r.newLogger("broadcastAttendeeMeetingQuery","data-resolvers-browser-broadcast-attendee"),{overflowAttendance:c}=e;if(t){if(c)try{i=((e,t)=>{var n;if("Disabled"===t)return!1;if("Enabled"===t)return!0;const i=!(!e||!e.userPreferences||"true"!==e.userPreferences.showInMeetingReport&&"false"!==e.userPreferences.showInMeetingReport);return"EnabledUserOverride"===t?!i||"false"!==(null===(n=null==e?void 0:e.userPreferences)||void 0===n?void 0:n.showInMeetingReport):"DisabledUserOverride"!==t||!!i&&"false"!==(null==e?void 0:e.userPreferences.showInMeetingReport)})(n.readQuery({query:S}),e.allowTrackingInReportPolicy)}catch(e){l.error("Failed to fetch allowTrackingInReportPolicy"),l.error(e)}return{__typename:"BroadcastAttendeeMeeting",id:(d=yield(yield o()).getAttendeeMeeting(Object.assign(Object.assign({},t),{allowTrackingInReport:i}))).correlationId,title:d.subject,stream:s(d.stream),altStream:s(d.altStream),qna:d.qna,yammer:d.yammer&&{__typename:"YammerMetadata",broadcastId:d.yammer.broadcastId,groupId:d.yammer.groupId,isEnabled:d.yammer.isEnabled,eventUrl:d.yammer.event},supportUrl:d.supportUrl}}return null;var d}))},broadcastCaptions(e,{id:t,broadcastId:n,culture:a,currentPlayerTime:o},{cache:r,getBroadcastCaptionsService:s,loggerFactory:l}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=l.newLogger("broadcastCaptionsQuery","data-resolvers-browser-broadcast-attendee");if(!t&&!n||!a)return e.error("Invalid params sent to broadcastCaptions Query"),Promise.reject("Invalid params sent to broadcastCaptions Query");e.log(`Fetching the captions for: ID: ${t}, Culture: ${a}, Time: ${o}`);const i=t||(0,C.G5)(n);try{const e=r.readQuery({query:b,variables:{id:i}});if(e&&e.broadcast.aesKey&&e.broadcast.transcription){const t={aesKey:e.broadcast.aesKey,aesKeyRefresh:e.broadcast.aesKeyRefresh,correlationId:e.broadcast.correlationId,transcription:e.broadcast.transcription},n=yield s();n.setCurrentCaptionLanguage(i,a);return(e=>{const t=[];for(const n of e){if(""===n.Text)continue;const e={__typename:"Captions",start:m(n.TimestampMs),text:n.Text,end:m(n.EndTimestampMs)};t.push(e)}return t})(yield n.getCaptions(o,i,t,a))}}catch(t){e.error("Failed to fetch captions"),e.error(t)}return Promise.resolve([])}))},broadcast(e,{id:t,roleHint:n},{getBroadcastAttendeeService:o,loggerFactory:s}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const[e,i,l,c,d]=t.split("__");if(!(e&&i&&l&&c)){const e=`Invalid Id: ${t}`;throw s.newLogger("broadcast","data-resolvers-browser-broadcast-attendee").error(e),new Error(e)}const u=!!d,m=u?a.G7F.Overflow:a.G7F.QuickStart,g=yield(yield o()).getAttendeeMeeting({tenantId:e,organizerId:i,threadId:l,messageId:c,sessionId:d,roleHint:n,broadcastType:m});return r(t,u,g)}))}},Mutation:{startLiveStreamCaptions(e,{id:t,liveStreamId:n,culture:a},{cache:o,getBroadcastCaptionsService:r,getLiveStreamRenderingService:s,loggerFactory:l}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=l.newLogger("liveStreamCaptionsMutation","data-resolvers-browser-broadcast-attendee");try{const i=o.readQuery({query:b,variables:{id:t}});if(!i)throw new Error("Could not find broadcast data");const l=yield s(),c=yield r(),d=()=>l.getDiagnosticData(n).then((t=>(e.log(`The times are: ${t.currentAbsoluteTime}, ${t.currentMediaTime}, ${t.currentPlayPosition}`),t.currentAbsoluteTime))),u=e=>{l.addCues(n,e)},m={aesKey:i.broadcast.aesKey,aesKeyRefresh:i.broadcast.aesKeyRefresh,correlationId:i.broadcast.correlationId,transcription:i.broadcast.transcription};c.startCaptionsForStream(n,t,m,a,!1,d,u)}catch(t){e.error("Failed to fetch captions"),e.error(t)}return null}))},stopLiveStreamCaptions(e,{liveStreamId:t},{getBroadcastCaptionsService:n,getLiveStreamRenderingService:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=o.newLogger("liveStreamCaptionsMutation","data-resolvers-browser-broadcast-attendee");e.log(`Stopping captions for stream ${t}`);try{const e=yield n(),i=yield a();return e.stopCaptionsForStream(t),i.clearCues(t),!0}catch(n){return e.error(`Error while stopping captions for stream ${t}`),e.error(n),!1}}))},toggleLiveStreamCaptionButton(e,{liveStreamId:t,shouldShowButton:n},{getLiveStreamRenderingService:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=o.newLogger("toggleLiveStreamCaptionButton","data-resolvers-browser-broadcast-attendee");e.log(`Setting the caption button visibility in the player to ${n} for stream ${t}`);try{return(yield a()).showCaptions(t,n),!0}catch(i){return e.error(`Error while setting the caption button to ${n} for stream ${t}`),!1}}))},subscribeToBroadcastUpdates(e,{id:t},{loggerFactory:n,getBroadcastAttendeeService:a,getBroadcastSignalRService:o,pubsub:r,cache:s,coreSettings:l,scenarioFactory:c}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield a(),d=yield o(),u=n.newLogger("broadcastSubscribe","data-resolvers-browser-broadcast-attendee"),{enableSignalrForOverflow:m}=l.get(j.J.Broadcast);return yield((e,t,n,a,o,r,s,l)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=T(e),c=!!i.sessionId;try{const d=yield I(o,e,t,i,c,r);return d?(a.publish(`${k.V}-${e}`,{broadcastUpdatedEvent:d}),yield N(d,n,t,e,c,i,a,r,o,s,l)):(U(r,a,"Error subscribing to broadcast updates",e,c),!1)}catch(t){return r.error(t),U(r,a,(0,_.VK)(t),e,c),!1}})))(t,e,d,r,s,u,c,!!m)}))},unsubscribeFromBroadcastUpdates(e,{id:t},{getBroadcastAttendeeService:n,getBroadcastSignalRService:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=o.newLogger("broadcastUnsubscribe","data-resolvers-browser-broadcast-attendee");e.log(`Stopping subscription for broadcast ${t}`);try{(yield n()).stopPollingAttendeeMeeting(t);return(yield a()).unsubscribeFromBroadcast(t),!0}catch(n){return e.error(`Error while unsubscribing from broadcast ${t}`),e.error(n),!1}}))}},Subscription:{broadcastQnaFeedStatusEvent:{subscribe:(e,{id:t},{pubsub:n})=>n.asyncIterator(t)},broadcastUpdatedEvent:{subscribe:(e,{broadcastId:t},{pubsub:n})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return n.asyncIterator(`${k.V}-${t}`)}))}}},B=()=>({Mutation:{updateBroadcastQnaFeedStatus:(e,{id:t,isQnaFeedLoaded:n,hasNewMessages:i},{pubsub:a})=>(null==i&&null==n||a.publish(t,{broadcastQnaFeedStatusEvent:{isQnaFeedLoaded:!!n,hasNewMessages:!!i}}),{__typename:"BroadcastQnaFeedStatus",isQnaFeedLoaded:!!n,hasNewMessages:!!i})}})},256030:(e,t,n)=>{"use strict";n.d(t,{w:()=>s});var i=n(197981),a=n(494326);const o="calendarv2",r=e=>{const t=e.get(o);return t?(0,a.D)(t):{}},s={Query:{calendarSettingsFromLocalStorage:(e,t,{localStorage:n})=>(({shouldGetDateRangeType:e,shouldGetWorkHours:t,shouldGetWorkWeekDays:n},i)=>{const a=r(i);return{__typename:"ICalendarSettings",dateRangeType:e&&a.dateRangeType||null,workHours:t&&a.workHours?Object.assign({__typename:"IWorkHours"},a.workHours):null,workWeekDays:n&&a.workWeekDays||null,isLeftRailExpanded:a.isLeftRailExpanded}})(t,n)},Mutation:{saveCalendarSettingsInLocalStorage:(e,t,{localStorage:n})=>((e,t)=>{const n=r(t);return(0,i.forOwn)(e,((e,t)=>{null!=e&&(n[t]=e)})),t.setSafe(o,JSON.stringify(n)),!0})(t,n)}}},579612:(e,t,n)=>{"use strict";n.d(t,{s:()=>q});var i=n(361366),a=n(749922),o=n(92836),r=n(47135),s=n(615465),l=n(343324),c=n(739582),d=n(65903),u=n(571685),m=n(471285),g=n(786884),p=n(86371);const v=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=n.filter((e=>!e.shareUrl)).map((e=>e.id));if(0===i.length)return n;const a=yield e.shareDriveItems(i),o=new Map;a.forEach(((e,t)=>o.set(i[t],e)));const r=[];for(const e of n){const n=o.get(e.id);if(n){if(!n.link){const n=`ShareUrl (link.webUrl) is not present in createLink response for fileId: ${e.id}`,i={[p.z.internalErrorCode]:"ShareUrlIsMissingFromResponse",[p.z.logErrorMessage]:n};throw t.newLogger("ChatResolversUtilsFiles","data-resolvers-browser-chat").error(`${n}. ${JSON.stringify(i)}`),(0,g.Tr)(m.w5.AddShareUrlOnSendMessage,m.jK.Undefined,"",i,n)}r.push(Object.assign(Object.assign({},e),{shareUrl:n.link.webUrl,shareId:n.shareId}))}else r.push(e)}return r})),h=e=>{var t;return!!(null===(t=null==e?void 0:e.files)||void 0===t?void 0:t.length)},f=(e,t,n)=>{const i=e.newLogger("ChatResolversUtilsFiles","data-resolvers-browser-chat"),{reason:a}=n;if(a){const e={errorCode:a[p.z.internalErrorCode]||n.code||"ErrorCodeMissing",correlationId:a[p.z.correlationId],statusCode:a[p.z.httpCode],message:a[p.z.logErrorMessage]||"Log message is not present in reason bag",errors:a[p.z.logErrorMessage]};throw t.fail(e),i.error(`Failed to generate ShareUrl for files. ${JSON.stringify(e)}`),n}const o={errorCode:n.code||m.jK.Unknown,message:"thrown error is not an instance of IError. So not much data available",errors:`${n.context}_${n.subContext}`};throw t.fail(o),i.error(`Failed to generate ShareUrl for files and as well error is not instance of IError ${JSON.stringify(o)}`),n},y=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{return yield e()}catch(e){const i="Failed to lazy load drive item share service",a={[p.z.internalErrorCode]:e.code||"FailedToLazyLoadDriveItemShareService",[p.z.logErrorMessage]:i,innerError:e},o={errorCode:a[p.z.internalErrorCode],message:a[p.z.logErrorMessage]};n.fail(o);throw t.newLogger("ChatResolversUtilsFiles","data-resolvers-browser-chat").error(`Failed to get DriveItemShareService. error: ${JSON.stringify(o)}`),(0,g.Tr)(m.w5.AddShareUrlOnSendMessage,m.jK.FailedToLazyLoadService,"",a,i)}}));var b=n(563132),S=n(197981),k=n(26653),w=n(585478),C=n(864355),_=n(97600),T=n(469929),I=n(60746),E=n(678058),N=n(26724),A=n(464445);const F={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"optionalTelemetry"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"optionalTelemetry"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidCorrelationId"}},{kind:"Field",name:{kind:"Name",value:"fluidDataLossOccurred"}},{kind:"Field",name:{kind:"Name",value:"fluidDataLossPrevented"}}]}}]}}]};var D=n(556569),R=n(900840);const x=e=>{switch(e){case"Standard":return"NORMAL";case"Important":return"HIGH";case"Urgent":return"URGENT"}return null},M=e=>{var t;const n=null===(t=e.computed)||void 0===t?void 0:t.cards;if(!n)return!1;return!!(0,S.find)(n,(e=>"application/vnd.microsoft.card.fluid"===e.contentType||"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType))},O=e=>{var t;if(j(e.content)>0)return!0;const n=null===(t=e.computed)||void 0===t?void 0:t.cards;return!!n&&n.some((e=>e.appName===R.SL))},P=e=>{var t;const n=null===(t=e.computed)||void 0===t?void 0:t.cards;if(n){const e=[];return n.forEach((t=>{e.push(t.appId)})),null==e?void 0:e.join(",")}return""},L=e=>{const t=new RegExp(E.T.reply,"g");return(e.match(t)||[]).length},U=(e,t)=>e.split(" ").filter((e=>e===`itemtype="${t}"`)).length,j=e=>e.split(" ").filter((e=>e===`type="${R.m7}"`)).length,$=(e,t,n,i,a,o,r,s)=>{var l,c,u,m,g,p,v,h,f,y,b;return Object.assign({"DataBag.messagelength":(b=e.content,b?b.replace(/(<([^>]+)>)/gi,""):"").length,"DataBag.size":e.content.length,"DataBag.importantflag":x(e.importance),"DataBag.messageType":o?r?"replyConversation":"newConversation":"Update"===t?"chatEdit":"newP2PMessage","DataBag.postType":"Announcement"===e.postType?"announcement":"normal","DataBag.richText":(y=e.messageType,"RichText/Html"===y),"DataBag.fluidCard":M(e),"DataBag.appId":P(e),"DataBag.sfbInteropMessage":(null==i?void 0:i.chatType)===d.z_3.SfBInteropChat,"DataBag.mricollection":(null===(c=null===(l=null==i?void 0:i.memberIds)||void 0===l?void 0:l.map((e=>(0,_.Q2)(e))))||void 0===c?void 0:c.join(" "))||"","DataBag.rostersize":(null===(u=null==i?void 0:i.memberIds)||void 0===u?void 0:u.length)||0,"DataBag.attachments":(null===(m=e.files)||void 0===m?void 0:m.length)||0,"DataBag.attachmentIds":(null===(p=null===(g=e.files)||void 0===g?void 0:g.map((e=>e.id)))||void 0===p?void 0:p.join(" "))||"","DataBag.fileTypeList":(null===(h=null===(v=e.files)||void 0===v?void 0:v.map((e=>e.type)))||void 0===h?void 0:h.filter((e=>!(0,S.isNil)(e))))||[],"DataBag.suggestedFile":null===(f=e.files)||void 0===f?void 0:f.some((e=>"smartReply"===e.context)),"DataBag.leftRailDirective":o?"channel-list":"chat-list","Messaging.messageChannelType":s,"DataBag.messageID":e.id!==e.clientMessageId?e.id:void 0,"DataBag.isNewChat":!!a,"DataBag.newChatIntentId":a,"DataBag.tflOffNetworkEmailCount":(null==i?void 0:i.memberIds)?i.memberIds.filter((e=>e.startsWith(T.b6))).length:0,"DataBag.tflOffNetworkOneWayPhoneCount":(null==i?void 0:i.memberIds)?i.memberIds.filter((e=>e.startsWith(T.EI))).length:0,"DataBag.tflSMSMembersCount":(null==i?void 0:i.memberIds)?i.memberIds.filter(_.yj).length:0,"DataBag.offNetworkContactsSelected":(null==i?void 0:i.memberIds)?i.memberIds.filter(_.$i).length:0,"DataBag.hasAADFederatedMembers":(null==i?void 0:i.hasFederatedUser)||!1,"DataBag.hasMSAFederatedMembers":(null==i?void 0:i.hasTflConsumerUser)||!1,"DataBag.quotedReplyCount":L(e.content),"DataBag.groupTemplateType":null==i?void 0:i.groupTemplate,"DataBag.chatType":B(i),"DataBag.GIF":U(e.content,E.T.giphy),"DataBag.Sticker":U(e.content,E.T.sticker),"Designer.containsImageFromDesigner":O(e)},((e,t)=>{const n={};if(e&&(null==t?void 0:t.isOneOnOne)&&(null==t?void 0:t.hasFederatedUser)){const e=D.eo.getTflExtendedDirectoryMembership(null==t?void 0:t.extendedDirectoryRedemptionRequired);e&&(n["DataBag.TFLUserInED"]=!0,n["DataBag.TFLUserEDState"]=e)}return n})(n,i))},B=e=>(null==e?void 0:e.guardianChatInfo)?k.Ml.GuardianChat:null,W=(e,t,n,i,a,o,r,s,l,u,m,g,p,v)=>{var h,f;const y=((e,t)=>{var n,i;if(!e||e.chatSubType===I.k2.Channel)return t?w.Th.Channel:void 0;const a=null!==(i=null===(n=e.memberIds)||void 0===n?void 0:n.map((e=>e)))&&void 0!==i?i:[],o=(0,_._K)(e.id,e.isFederated,e.isOneOnOne,e.hasFederatedUser,a);return(0,c.NL)(e.id,e.chatType,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,o,e.isFederated)})(s,m);let b={};y===w.Th.Botchat&&(b=((e,t)=>{var n,i,a;const o=null===(n=null==e?void 0:e.memberIds)||void 0===n?void 0:n.find(_.bl);if(o){const e=o.substring(T.at.BotPrefix.length);try{const n=t.readQuery({query:N.Cj,variables:{installedContext:{scope:d.qi6.Personal}}});if(n){const t=null===(i=n.installedAppsV2)||void 0===i?void 0:i.filter((t=>{var n,i,a;return(null===(a=null===(i=null===(n=null==t?void 0:t.definition)||void 0===n?void 0:n.bots)||void 0===i?void 0:i[0])||void 0===a?void 0:a.id)===e}));if(t&&t.length>0)return{id:null===(a=t[0])||void 0===a?void 0:a.id,capabilityId:e,scenarioCapability:C.Ky.bots}}}catch(e){}}return{}})(s,u));let S={};y!==w.Th.Channel&&y!==w.Th.Communities||(S=((e,t,n,i)=>{var a,o,r,s,l;let c;try{c=e.readQuery({query:A.h,variables:{conversationId:t}})}catch(e){i.error(`Failed to retrieve Team.Id and Team.OfficeGroupId from cache. Thread.Id: ${t}. Thread.Type: ${n}.`)}return{channelType:null==c?void 0:c.channelByID.channelType,teamId:null===(o=null===(a=null==c?void 0:c.channelByID)||void 0===a?void 0:a.owningTeam)||void 0===o?void 0:o.id,officeGroupId:null===(l=null===(s=null===(r=null==c?void 0:c.channelByID)||void 0===r?void 0:r.owningTeam)||void 0===s?void 0:s.teamSiteInformation)||void 0===l?void 0:l.groupId}})(u,e,y,o));const k=null!==(h=null==S?void 0:S.channelType)&&void 0!==h?h:null,E=function(e,t){let n=null;n=e?t?w.wh.discoverSurface:w.wh.Channel:w.wh.Chat;return n}(m,v),F=m?"channel":"chat",D=$(t,n,r,s,l,m,g,k);a.recordPanelAction({actionGesture:w.uS.click,actionOutcome:w.$K.submit,actionOutcomeNew:w.$K.submit,actionScenarioType:w.Yu.composeMsg,actionScenario:w.Tk.composeSendMessage,moduleName:w.rA.sendButton,moduleNameNew:w.rA.sendButton,moduleType:w.PO.sendMessageButton,moduleTypeNew:w.PO.sendMessageButton,officeGroupId:null!=(null==S?void 0:S.officeGroupId)?null==S?void 0:S.officeGroupId:void 0,panelRegion:w.Ai.main,panelType:E,panelRegionNew:w.Ai.main,panelTypeNew:E,threadId:e,teamId:null!=p?p:null==S?void 0:S.teamId,threadMembers:null===(f=null==s?void 0:s.memberIds)||void 0===f?void 0:f.length,threadType:y,actionWorkload:m?w.sz.channelContent:w.sz.chatContent,actionSubworkload:w.eD.composeMsg,tabId:"",tabType:"conversations",tabIdNew:"",tabTypeNew:"conversations",tabOrdinal:1,appName:F,dataBag:{id:"",data:Object.assign(Object.assign(Object.assign({},i),D),H(u,v,g)),dispose:()=>{}},extensibilityData:b},o)};function H(e,t,n){var i,a,o;const r={};let s=null;try{s=e.readQuery({query:F})}catch(e){}const l=null==s?void 0:s.optionalTelemetry;return void 0!==(null==l?void 0:l.fluidDataLossOccurred)&&null!==(null==l?void 0:l.fluidDataLossOccurred)&&(r["DataBag.fluidDataLossOccurred"]=null===(i=null==s?void 0:s.optionalTelemetry)||void 0===i?void 0:i.fluidDataLossOccurred),void 0!==(null==l?void 0:l.fluidDataLossPrevented)&&null!==(null==l?void 0:l.fluidDataLossPrevented)&&(r["DataBag.fluidDataLossPrevented"]=null===(a=null==s?void 0:s.optionalTelemetry)||void 0===a?void 0:a.fluidDataLossPrevented),void 0!==(null==l?void 0:l.fluidCorrelationId)&&null!==(null==l?void 0:l.fluidCorrelationId)&&(r["Messaging.fluidCorrelationId"]=null===(o=null==s?void 0:s.optionalTelemetry)||void 0===o?void 0:o.fluidCorrelationId),t&&(r["DiscoverSurface.requestId"]=t,r["DataBag.messageID"]=n),r}var V=n(69509),z=n(288596);const q={Mutation:{sendMessageWorker(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return G(e,t)}))},sendMessage(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return G(e,t)}))}}},G=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{convId:n,action:a,originalConvId:o,withChatNetworkFallback:c,searchSessionId:m,sendFromChannel_ToBeRefactored:g}=e;let p=e.message;const{cache:S,coreSettings:k,loggerFactory:w,offlineCacheManager:C,getDriveItemShareService:_,scenarioFactory:T,channelView:I,teamId:E,getPeopleService:N,requestId:A}=t,{enableInstalledAppsV2:F,enableBotsFileSharing:D,enableAppsQueryOptimization:R,botFileInfoFetchTimeout:x}=k.get(r.J.Extensibility),{enableFilesShareLinksInvite:M,enableSharingByCreateLinkAPI:O,enableFilesShareLinksFetchFederatedUsersAPI:P,enableFilesShareLinksFetchTflConsumerUsersAPI:L}=k.get(r.J.Files),{msgEnableChannelsV2:U}=k.get(r.J.Host),{enableScheduleMessage:j,fluid:$}=k.get(r.J.Messaging),{enableMeetingChatAttachmentsInMCO:B,meetingChatAttachmentsMap:H}=k.get(r.J.ArtifactsPlatform),{environment:q}=k.get(r.J.Metadata),G=q===s.s.life,Y={"DataBag.searchSessionId":m,"DataBag.isChannelsV2":!!U,"DataBag.channelView":I,"Compose.sendPostAsEmail":!!(null==p?void 0:p.sendPostAsEmail)},X=w.newLogger("chatMutationForwardResolvers","data-resolvers-browser-chat"),Z=(0,u.q)(a,p),ee=T.findScenario(Z),te=yield(0,b.mb)(n,S,t,X,w,c,null,null,void 0,o||"");null==ee||ee.mark(l.ck.ChatSendMessageGotChat);const ne=Q(o,S,X),ie=yield J(t);null==ee||ee.mark(l.ck.ChatSendMessageServicesLazyLoadComplete);const ae=(0,b.Fb)(S,n,F,R),oe=(0,b.QD)(S),re=K(t,X);(M||j)&&te&&(0,b.iX)(te)&&(p=yield(0,b.Ju)(p,te,t,P,L)),(M||j)&&g&&(p=yield(0,b.DE)(p,S,n,X,t)),B&&function(e,t,n,a,o,r,s,c){var u,m,g,p,v,h;(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:f}=(0,V.aN)(l.RG.AddAttachmentToMCO,o),y=null===(u=null==e?void 0:e.files)||void 0===u?void 0:u.length;try{if(y&&("Recurring"===(null===(m=null==t?void 0:t.meetingInformation)||void 0===m?void 0:m.meetingType)||"Scheduled"===(null===(g=null==t?void 0:t.meetingInformation)||void 0===g?void 0:g.meetingType))){const l=yield c(),u=(yield((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=`8:orgid:${e}`,i=(yield t.getPeopleProfilesByMris([n],"MeetingChat")).get(n);return null==i?void 0:i.userPrincipalName})))((null===(p=null==t?void 0:t.meetingInformation)||void 0===p?void 0:p.organizerId)||"",l))||"",m=`${null===(v=t.me)||void 0===v?void 0:v.objectId}@${t.addedByTenantId}`,g=`${t.meetingInformation.organizerId}@${t.meetingInformation.tenantId}`,y=t.meetingInformation.iCalUid||"",S=e.files,k=[];let w="",C="",_=!1;if(S.forEach((e=>{var i,a;const o=(null==e?void 0:e.type)||"";for(const e of n||[])if(e.enabled){if(null===(i=e.fileType)||void 0===i?void 0:i.includes(o)){w=e.appType,C=e.appId,_=!0;break}(null===(a=e.fileType)||void 0===a?void 0:a.includes("all"))&&(_=!0)}if(_){const n=((e,t,n,i)=>{var a;return{location:(null==e?void 0:e.objectUrl)||"",type:d.ceh.MeetingChat,subType:n||"",metadata:{appTitle:n||"",appId:i||"",userId:(null===(a=null==t?void 0:t.me)||void 0===a?void 0:a.objectId)||"",fileTitle:(null==e?void 0:e.title)||"",imageUrl:(null==e?void 0:e.previewUrl)||"",shareUrl:(null==e?void 0:e.shareUrl)||"",fileId:(null==e?void 0:e.id)||"",fileType:(null==e?void 0:e.type)||"",baseUrl:(null==e?void 0:e.baseUrl)||""}}})(e,t,w,C);k.push(n),w="",C="",_=!1}})),k.length>0){const e=(0,b.i$)(t,y,g,m,u);e?(null===(h=s.errorToTelemetry)||void 0===h||h.call(s,e,"cmd_meetings_collab_object_add_resources_to_collab_object_event"),f.fail({reason:e})):(0,z.A)(r,o,a,d.ceh.MeetingChat,y,y,g,m,k,((e,t)=>{var n;return{meetingUrl:(null===(n=e.meetingInformation)||void 0===n?void 0:n.meetingJoinUrl)||"https://teams.microsoft.com",threadId:e.id,messageId:"0",organizerUpn:t}})(t,u))}}f.stop()}catch(e){(0,V.S3)(s,e,f,"cmd_meetings_collab_object_add_resources_to_collab_object_event","addAttachemntsToMCO failed with errorCode")}}))}(p,te,H,w,T,t.getCollabObjectService,X,N);let se=yield(0,b.JB)(t,p,a,n,re,Object.assign(Object.assign({},ie),{offlineCacheManager:C,telemetryDatabag:Y,convId:n,conversationMembers:null==te?void 0:te.memberIds,getInstalledMessageExtensionApps:ae,getAppDefinitions:oe}),ee,!!g);return O&&p&&(se=yield((e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(h(a)){const i=t.newScenario(l.RG.FilesCreateShareLink),o=yield y(e,n,i);try{const e=yield v(o,n,a.files);return i.stop(),Object.assign(Object.assign({},a),{files:e})}catch(e){f(n,i,e)}}return Object.assign({},a)})))(_,T,w,se)),se=yield(0,b.KE)(se,X,$,t),se=yield(0,b.R_)(ie.botsPlatformService,se,D,w,te,x),se=(0,b.wX)(se,te),((e,t,n,i,{loggerFactory:a,userBiService:o,cache:r},s,l,c,d,u,m,g)=>{const p=a.newLogger("sendMessageTelemetry","data-resolvers-browser-chat");o?W(e,t,n,i,o,p,s,l,c,r,d,u,m,g):p.warn("userBiService is null")})(n,se,a,Y,t,G,te,ne,g,null==p?void 0:p.replyChainId,E,A),Object.assign(Object.assign({},e),{message:se})})),J=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{getAppBasedLinkService:t,getAsyncMediaService:n,getUrlPreviewService:i,getImageProxyService:a,getFilesReferenceService:o,getBotsPlatformService:r}=e,[s,l,c,d,u,m]=yield Promise.all([n(),a(),i(),o(),t(),r()]);return{asyncMediaService:s,imageProxyService:l,urlPreviewService:c,fileReferenceService:d,appBasedLinkService:u,botsPlatformService:m}})),Q=(e,t,n)=>{var i;let o=null;if((0,c.UL)(e))try{const n=t.readQuery({query:a.i,variables:{convId:e}});o=null!==(i=null==n?void 0:n.newChatIntentId)&&void 0!==i?i:null}catch(e){n.error("Failed to find newChatIntentId in cache")}return o},K=(e,t)=>{var n;let i=!0;const{cache:a,coreSettings:s}=e,{enableConnectedExperiences:l}=s.get(r.J.Messaging);if(!l)return i;try{const e=a.readQuery({query:o.K});i="false"!==(null===(n=null==e?void 0:e.userPreferences)||void 0===n?void 0:n.controllerConnectedServicesEnabled)}catch(e){t.error("Failed to find userPreferences in cache")}return i}},563132:(e,t,n)=>{"use strict";n.d(t,{QD:()=>W,R_:()=>$,mb:()=>Z,i$:()=>ne,Fb:()=>H,Ju:()=>q,DE:()=>G,iX:()=>ee,PJ:()=>j,JB:()=>L,wX:()=>te,KE:()=>Q});var i=n(361366),a=n(197981),o=n(500795),r=n(343324),s=n(739582),l=n(78997),c=n(181896);let d=class{transform(e,t){var n,i,o,r,s,l;if(e.parent&&1===e.parent.children.length&&"div"===(null===(n=e.parent.name)||void 0===n?void 0:n.toLowerCase())&&"root"===(null===(i=e.parent.parent)||void 0===i?void 0:i.type)){if((!e.children||0===e.children.length)&&"text"===e.type)return t.isPureText=!0,void(t.textContent=(0,a.unescape)(e.data));if("tag"===e.type&&"p"===(null===(o=e.name)||void 0===o?void 0:o.toLowerCase())&&1===(null===(r=e.children)||void 0===r?void 0:r.length)&&"text"===e.children[0].type)return t.isPureText=!0,void(t.textContent=(0,a.unescape)(null===(s=e.children)||void 0===s?void 0:s[0].data));if("tag"===e.type&&"p"===(null===(l=e.name)||void 0===l?void 0:l.toLowerCase()))return e.name="div",e}}};d=(0,i.__decorate)([(0,c.wx)({name:"BotMessageContentSerializer",filter:"*"})],d);var u=n(53092),m=n(139682),g=n(97600),p=n(490503),v=n(469929),h=n(707418),f=n(47135);var y=n(245349),b=n(980402),S=n(198760);const k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserChatAppDefinitionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...n(479531).Eb.definitions]};var w=n(26724),C=n(633100);const _={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...C.W4.definitions]},T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...C.W4.definitions]};var I=n(829832),E=n(678058),N=n(912825);const A={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};let F=class{transform(e,t){if(e&&e.attribs&&I.zj.cacheKey in e.attribs&&e.attribs[I.zj.cacheKey]===t.cacheKey)return t.instancesReplaced++,void 0!==t.value?e.attribs[t.prop]=t.value:t.prop in e.attribs&&void 0===t.value&&delete e.attribs[t.prop],e}};F=(0,i.__decorate)([(0,c.wx)({name:"InlineVideoUpdater",filter:[{itemtype:E.T.amsVideo}]})],F);var D=n(65903),R=n(438985),x=n(900840),M=n(740755),O=n(464445);const P=(e,t,n,a,o,s,l,d)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{cache:i,coreSettings:m,loggerFactory:g,scenarioFactory:p,authenticationUser:v,i18n:h}=e,f=g.newLogger("chat-resolver-utils","data-resolvers-browser-chat"),y=(0,c.te)(u.bl,t,Object.assign(Object.assign({},n),{coreSettings:m,loggerFactory:g,scenarioFactory:p,authenticationUser:v,i18n:h}));try{yield(0,S.yG)(i,e,a,o,s,y,n.messageProperties,d),null==l||l.mark(r.ck.ChatSendMessageOptimisticResponsePosted)}catch(e){f.error(`client lie generation failed for conversation: ${a} clientMessageId: ${o.clientMessageId} error: ${e}`)}return(0,c.zL)(u.Vf,y,Object.assign(Object.assign({},n),{coreSettings:m,loggerFactory:g,scenarioFactory:p,i18n:h,videoMessageLieUpdater:(e,t,n)=>((e,t,n,i,a)=>{if(!t)throw Error("clientMessageId undefined");const o=`Message:${t}`;let r;try{r=e.readFragment({id:o,fragment:A})}catch(e){throw e}if(!r)throw Error(`Message lie ${o} not found.`);if(!r.content)throw Error(`Message lie ${o} has no content.`);const s={cacheKey:n,prop:i,value:a,instancesReplaced:0},l=(0,c.te)([F],r.content,s);if(1!==s.instancesReplaced)throw Error(`${s.instancesReplaced} instances found instead of 1`);{const n=(0,N.M)()[0].toString();try{e.writeFragment({id:o,fragment:A,data:{__typename:"Message",id:t,content:l,version:n}})}catch(e){throw e}}})(i,o.clientMessageId,e,t,n)}))})),L=(e,t,n,a,o,s,l,c)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{content:d,computed:u,files:m,clientMessageId:g,deeplinks:p,title:v}=t,y=(0,i.__rest)(t,["content","computed","files","clientMessageId","deeplinks","title"]),b=Object.assign({conversationId:a,connectedExperienceEnabled:o,existingLinks:(null==u?void 0:u.embeddedLinks)||[],messageProperties:u?Object.assign(Object.assign({},u),{embeddedLinks:[]}):{},files:m,coreSettings:e.coreSettings,loggerFactory:e.loggerFactory},s),{coreSettings:S,loggerFactory:k}=e,w=k.newLogger("chat-resolver-utils","data-resolvers-browser-chat"),C=yield P(e,d,b,a,t,n,l,c),_=((e,t)=>{const{enableEntityConversationInMWTab:n}=e.get(f.J.Extensibility);if(!n)return[];const i=h.h.getInstance(),a=i.getSubEntityDeepLinkInfo();return a&&t&&i.getClientMessageId()===t?(i.setSubEntityDeepLinkInfo(void 0),i.setClientMessageId(void 0),[a]):[]})(S,g||void 0),{updatedTitle:T,updatedCards:I}=yield U(v||"",b);return w.log(`serialized message ${g}`),null==l||l.mark(r.ck.ChatSendMessageSerializationComplete),Object.assign({content:C,computed:Object.assign(Object.assign({},b.messageProperties),{cards:I}),files:b.files,deeplinks:_.length>0?_:p,clientMessageId:g,title:T},y)})),U=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,a,o;let r=e,s=t.messageProperties.cards;if(null==s?void 0:s.length){const e=s.find((e=>e.appId===x.lq&&e.contentType===x.hY));if(e){let l=JSON.parse(e.content);if((null===(n=l.imageData)||void 0===n?void 0:n.origImage)&&(null===(o=null===(a=null===(i=l.imageData)||void 0===i?void 0:i.croppedImage)||void 0===a?void 0:a.src)||void 0===o?void 0:o.startsWith("blob:"))){const n=yield(0,y.Hk)(l.imageData.croppedImage.src),i="MicrosoftTeams-image.png",a=yield t.asyncMediaService.uploadItem(n,t.conversationId,"IMAGE",i,M.r1.Inline),o=a.inlineSizeUrl.replace("/imgo","/imgpsh_fullsize");l=Object.assign(Object.assign({},l),{imageData:Object.assign(Object.assign({},l.imageData),{croppedImage:Object.assign(Object.assign({},l.imageData.croppedImage),{id:a.objectId,src:o}),origImage:Object.assign(Object.assign({},l.imageData.origImage),{id:a.objectId,src:o})})});const c=Object.assign(Object.assign({},e),{content:JSON.stringify(l)});s=s.map((e=>e.appId===x.lq&&e.contentType===x.hY?c:e)),r=""}}}return{updatedTitle:r,updatedCards:s}})),j=(e,t)=>{const{loggerFactory:n,offlineCacheManager:i}=e,a={logger:n.newLogger("serializeDraftMessage","data-resolvers-browser-chat"),offlineCacheManager:i},o=(0,c.te)(u.D,t.content,a);return Object.assign(Object.assign({},t),{content:o})},$=(e,t,n,a,o,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!o||!n||!t.files||0===t.files.length)return t;if(!(null==o?void 0:o.isOneOnOneBotChat))return t;const i=a.newLogger("chat-resolver-utils","data-resolvers-browser-chat"),s=r||1e4,l=yield Promise.all(t.files.map((t=>B(t,e,i,s))));return Object.assign(Object.assign({},t),{files:l})})),B=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=e.objectUrl;if(i){let o;try{o=yield(0,b.E)(t.getBotFileDownloadUrl(i,n),a,"get bot downlaod url timed out")}catch(e){o=null,n.error("getBotDownloadUrlForFiles: failed to get file info")}if(o)return Object.assign(Object.assign({},e),{downloadUrl:o})}return e})),W=e=>()=>{try{const t=e.readQuery({query:k,variables:{options:{capabilityFilter:[D.PwB.Messaging]}}});return(null==t?void 0:t.appDefinitions)||void 0}catch(e){return}},H=(e,t,n,i)=>()=>{var o;try{if(n){const n=V(e,t,i);return(0,a.compact)(null==n?void 0:n.filter((e=>{var t;return null===(t=null==e?void 0:e.definition)||void 0===t?void 0:t.messageExtensions})).map((e=>e&&z(e)?e:null)))}{const n=e.readQuery({query:T,variables:{conversationId:t,installedScopes:[D.qi6.Personal,D.qi6.GroupChat],options:{capabilityFilter:[D.PwB.Messaging]}}});return(0,a.compact)(null===(o=null==n?void 0:n.installedApps)||void 0===o?void 0:o.map((e=>e&&z(e)?e:null)))}}catch(e){return}},V=(e,t,n)=>{var i;let a=null;try{a=e.readQuery({query:w.Cj,variables:{installedContext:{scope:D.qi6.Personal}}})}catch(e){a=null}let o=null;try{if(n){const n=e.readQuery({query:_,variables:{conversationId:t}});o=null==n?void 0:n.installedChatAppsWithPreCheck}else{const n=e.readQuery({query:w.Cj,variables:{installedContext:{conversationId:t,scope:D.qi6.GroupChat}}});o=null==n?void 0:n.installedAppsV2}}catch(e){o=null}const r=null!=o?o:[];return(null!==(i=null==a?void 0:a.installedAppsV2)&&void 0!==i?i:[]).concat(r)},z=e=>(0,a.includes)([D.JMQ.Installed,D.JMQ.InstalledAndFavorited,D.JMQ.InstalledAndPermanent],e.installationState),q=(e,t,{getSharepointShareService:n,getPeopleService:a,discover:o},r,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;if((null===(i=null==e?void 0:e.files)||void 0===i?void 0:i.length)&&!(null==t?void 0:t.isOneOnOneBotChat)){const i=yield n(),l=yield a(),c=yield o.skypeid(),d=(yield X(t,l,r,s)).filter((e=>e.mri!==c)),u=yield i.shareFiles(e.files,d);return Object.assign(Object.assign({},e),{files:u})}return e})),G=(e,t,n,a,{getSharepointShareService:o})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,r,s,l,c,d,u,m,g;const p=J(t,n,a),v=null===(s=null===(r=null===(i=null==p?void 0:p.channelByID)||void 0===i?void 0:i.owningTeam)||void 0===r?void 0:r.teamSiteInformation)||void 0===s?void 0:s.sharepointSiteUrl,h=null===(c=null===(l=null==p?void 0:p.channelByID)||void 0===l?void 0:l.owningTeam)||void 0===c?void 0:c.smtpAddress,f=null===(m=null===(u=null===(d=null==p?void 0:p.channelByID)||void 0===d?void 0:d.owningTeam)||void 0===u?void 0:u.teamSiteInformation)||void 0===m?void 0:m.groupId;if(v&&h&&f&&(null===(g=null==e?void 0:e.files)||void 0===g?void 0:g.length)&&e.files[0].baseUrl!==v)try{const t=yield o(),n=[{id:f,smtpAddresses:[h],objectId:f}],i=yield t.shareFiles(e.files,n);return Object.assign(Object.assign({},e),{files:i})}catch(e){a.error("getMessageWithFileShareLinksForChannel: Failed to create the shareLink for Channel's message")}return e})),J=(e,t,n)=>{try{return e.readQuery({query:O.h,variables:{conversationId:t}})}catch(e){return n.error("getChannelFieldsForFileSharing: Failed to find channels related data"),null}},Q=(e,t,n,{getFluidService:a})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,o;if(e&&e.content&&e.fluidUrlPermissionInfo&&e.fluidUrlPermissionInfo.grantPermissionVariables){const{siteUrl:r,driveId:s,itemId:l,queryParams:c,linkType:d,scope:u,recipientList:g}=e.fluidUrlPermissionInfo.grantPermissionVariables,p={deferRedeemEnabled:!!(null==n?void 0:n.shareLinkDeferRedeemEnabled),partialSuccessEnabled:!!(null==n?void 0:n.shareLinkPartialSuccessEnabled)},v=yield a();try{const t=yield v.createShareLink(r,s,l,c,d,u,g,p),n=null===(i=null==t?void 0:t.link)||void 0===i?void 0:i.webUrl,a=null===(o=e.computed)||void 0===o?void 0:o.cards;if(a&&n){const t=a.find((e=>e.contentType===m.p.FluidEmbed||"fluid-card"===e.appId));if(t&&t.contentType===m.p.FluidEmbed){const i=t.cardClientId,a=JSON.parse(t.content).componentUrl,o=K(t,n),r=Y(e.content,E.T.fluidEmbedLink,n,a,i);return Object.assign(Object.assign({},e),{content:r,computed:Object.assign(Object.assign({},e.computed),{cards:o})})}if(t&&"fluid-card"===t.appId){const i=K(t,n);return Object.assign(Object.assign({},e),{computed:Object.assign(Object.assign({},e.computed),{cards:i})})}}}catch(e){t.warn(`Error creating fluid sharelink in chat resolvers: ${e}`)}}return e})),K=(e,t)=>{const n=[],i=e.contentType===m.p.FluidEmbed?JSON.parse(e.content).sourceType:null,a=JSON.stringify({componentUrl:t,sourceType:i}),o=Object.assign(Object.assign({},e),{content:a});return n.push(o),n},Y=(e,t=E.T.fluidLink,n,i,a)=>{const o=R.N.parseDOM(e),r=R.N.DomUtils.findAll((e=>"a"===e.name&&R.N.DomUtils.getAttributeValue(e,I.zj.itemtype)===t&&!!R.N.DomUtils.getAttributeValue(e,"href")),o),s=R.N.DomUtils.getAttributeValue(o[1],"itemid"),l=R.N.DomUtils.getAttributeValue(r[0],"href");if((e=>e.length>=1)(r)&&r[0]&&s&&a&&l&&i&&n&&s===a&&l===i){return e.replace(/href="(.*?)"/,`href="${n}`)}return e},X=(e,t,n,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=e.hasFederatedUser,r=e.hasTflConsumerUser,[s,c]=r?(0,a.partition)(e.memberIds,(t=>(0,g.Nl)(t)&&!(0,p.Bl)(e.id))):[[],e.memberIds],d=n&&i?yield(0,l.a2)(c||[],t):yield(0,l.Mv)(c||[],t),u=o&&r?yield(0,l.LH)(s||[],t):[];return d.concat(u)})),Z=(e,t,n,a,r,l,c,d,u,m)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,g;let p;try{p=null===(i=t.readQuery({query:o.vh,variables:{convId:e}}))||void 0===i?void 0:i.chat}catch(e){a.error("Failed to find chat in cache")}if(l&&!p){const t=yield n.getCSAService(),i=yield t.getChat(e);i&&(p=(0,s._$)(i,r,c,{id:d},u))}const v=(0,s.UL)(m)||(0,s.AK)(m);if(!p&&v&&m){e=m;try{p=null===(g=t.readQuery({query:o.vh,variables:{convId:e}}))||void 0===g?void 0:g.chat}catch(e){a.error("Failed to find chat in cache")}}return p})),ee=({chatType:e})=>e===D.z_3.Chat||e===D.z_3.Meeting,te=(e,t)=>{var n,i;const o=!(0,a.isEmpty)(null==t?void 0:t.botMembers),r=!!(null===(i=null===(n=e.computed)||void 0===n?void 0:n.mentions)||void 0===i?void 0:i.find((e=>"bot"===e.mentionType)));if(!((null==t?void 0:t.isOneOnOneBotChat)||o&&r))return e;const s={},l=(0,c.te)([d],e.content,s);return s.isPureText&&!(0,a.isNil)(s.textContent)?Object.assign(Object.assign({},e),{content:s.textContent,messageType:"BotMessageBack"===e.messageType?"BotMessageBack":v.Cs.Text}):Object.assign(Object.assign({},e),{content:l})},ne=(e,t,n,i,a)=>{var o;let r="";return e||(r=r?r.concat(", Chat Object ( thus meetingUrl)"):r.concat("Missing Chat Object ( thus meetingUrl)")),t||(r=r?r.concat(", externalEntityKey"):r.concat("Missing externalEntityKey")),n||(r=r?r.concat(", organizer"):r.concat("Missing organizer")),i||(r=r?r.concat(", user"):r.concat("Missing user")),e&&!(null===(o=e.meetingInformation)||void 0===o?void 0:o.meetingJoinUrl)&&(r=r?r.concat(", meetingUrl"):r.concat("Missing meetingUrl")),a||(r=r?r.concat(", organizerUpn"):r.concat("Missing organizerUpn")),r||void 0}},464445:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserChatChannelIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"owningTeam"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"smtpAddress"}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}}]}}]}}]}}]}},26724:(e,t,n)=>{"use strict";n.d(t,{Cj:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsV2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...n(633100).W4.definitions]}},323228:(e,t,n)=>{"use strict";n.d(t,{D:()=>a});var i=n(867634);const a={Mutation:{updateFilePermission(e,{updateFilePermissionInput:t},{cache:n}){if(!t)return!1;const{fileId:a,shareUrl:o,shareId:r,scope:s}=t,l=i.Ps`
  fragment filePermissionUpdate on FileUpload {
    id
    shareUrl
    shareId
    permissionScope
  }
`;let c;const d=`FileUpload:${a}`;try{c=n.readFragment({fragment:l,id:d})}catch(e){throw e}if(!c)throw new Error("Expected initial files to be populated before a command is executed");const u=Object.assign(Object.assign({},c),{shareUrl:o,shareId:r,permissionScope:s});return n.writeFragment({fragment:l,id:d,data:u}),!0},updatePermissionScopeInFileUpload(e,{updatePermissionScopeInput:t},{cache:n}){if(!t)return!1;const{fileId:a,scope:o}=t;if(!a)return!1;const r={permissionScope:o,__typename:"FileUpload"};try{n.writeFragment({fragment:i.Ps`
  fragment updatePermissionScope on FileUpload {
    permissionScope
  }
`,id:`FileUpload:${a}`,data:r})}catch(e){return!1}return!0}}}},2002:(e,t,n)=>{"use strict";n.d(t,{w:()=>o,Q:()=>r});var i=n(361366),a=n(5020);const o={Query:{meetForWorkAppUserState(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n.getMeetForWorkService()).getAppUserState()}))},meetForWorkDiagnoisticInformation(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n.getMeetForWorkService()).readDiagnosticMessage()}))}},Mutation:{refreshForMeetApp(e,t,{getMeetForWorkService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return n().then((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return e.refresh()})))),!0}))},deleteUpcomingEventForMeetApp(e,{meetingId:t},{getMeetForWorkService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n()).deleteUpcomingEvent(t)}))},updateUpcomingEventCallStateForMeetApp(e,{conversationId:t,isOngoingCall:n},{getMeetForWorkService:a}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield a()).updateUpcomingEventCallState(t,n)}))},updateMeetForWorkAppUserState(e,{updatedValue:t},n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n.getMeetForWorkService()).updateAppUserState(t)}))},setFetchMeetAppDataEnabled(e,{enable:t},{getMeetForWorkService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n()).setFetchDataEnabled(t),!0}))},requireFurtherRecentDataFromMeetApp(e,{sessionId:t},{getMeetForWorkService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n()).requireFurtherRecentData(t)}))}}},r={Subscription:{meetAppInsightsEvent:{subscribe:(0,a.OF)(((e,t,{pubsub:n,getMeetForWorkService:a})=>(a().then((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){e.fetchDataIfNeeded()})))),n.asyncIterator("meetAppInsightsEvent"))),((e,t)=>t.topic===e.meetAppInsightsEvent.topic))}}}},69509:(e,t,n)=>{"use strict";n.d(t,{o9:()=>s,Uk:()=>l,aN:()=>c,S3:()=>d});var i=n(404026),a=n(455074),o=n(151322),r=n(296154);const s=e=>(0,i.A)(e)||"<scrubbed>",l=e=>e.map((e=>e.type)).sort().toString(),c=(e,t)=>{const n=t.newScenario(e);let i=n.id;return(0,o.z)(i)||(i=(0,r.v4)()),n.appendEventData({correlationId:i}),{scenario:n,correlationId:i}};function d(e,t,n,i,o){var r,s,l,c,d,u,m,g,p;const v={message:null===(r=t.reason)||void 0===r?void 0:r[a.zm.logErrorMessage],statusCode:null===(s=t.reason)||void 0===s?void 0:s[a.zm.httpStatusCode],errorCode:null===(l=t.reason)||void 0===l?void 0:l[a.zm.internalErrorCode],subError:null===(c=t.reason)||void 0===c?void 0:c[a.zm.subError],correlationId:null===(d=t.reason)||void 0===d?void 0:d[a.zm.correlationId],cmdRequestId:null===(u=t.reason)||void 0===u?void 0:u[a.zm.cmdRequestId],reportingService:null===(m=t.reason)||void 0===m?void 0:m[a.zm.reportingService]};!function(e,t,n,i){e.errorToTelemetry?e.errorToTelemetry(t,n,i,!0):e.error(t)}(e,`${o} ${null===(g=t.reason)||void 0===g?void 0:g[a.zm.internalErrorCode]}, errorMessage: ${null===(p=t.reason)||void 0===p?void 0:p[a.zm.logErrorMessage]}`,i,v),n.fail(v)}},288596:(e,t,n)=>{"use strict";n.d(t,{s_:()=>g,A:()=>p});var i=n(361366),a=n(471285),o=n(343324),r=n(455074),s=n(65903),l=n(786884),c=n(197981),d=n(69509);let u;const m=e=>u||(u=e.newLogger("meeting-artifacts-resolvers","data-resolvers-browser-meeting-artifacts")),g={Query:{meetingArtifacts(e,{meetingArtifactType:t,externalEntityKey:n,organizer:a,user:r},{getCollabObjectService:s,scenarioFactory:l,loggerFactory:c,callerApp:g}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:i}=(0,d.aN)(o.RG.ReadCollabObject,l),p=(0,d.o9)(n);e.appendEventData({externalEntityKey:p}),m(c),u.log(`Read collab object for ${p}`);try{const o=yield s(),l=yield o.readCollabObject(i,n,a,r,g),c=((null==l?void 0:l.resources)||[]).filter((e=>e.type.toLowerCase()===t.toLowerCase())).map((e=>({id:e.id,type:h(e.type),location:e.location,metadata:e.metadata})));u.log(`type of resources received after reading collabObject ${(0,d.Uk)(c)}`);const m={changeKey:null==l?void 0:l.changeKey,resources:c};return e.stop({message:(0,d.Uk)(c)}),m}catch(t){return(0,d.S3)(u,t,e,"cmd_meetings_collab_object_read_collab_object_event","get meetingArtifacts query failed with errorCode"),Promise.reject(t)}}))},allMeetingArtifacts(e,{externalEntityKey:t,organizer:n,user:a},{getCollabObjectService:r,scenarioFactory:s,loggerFactory:l,callerApp:c}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:i}=(0,d.aN)(o.RG.ReadCollabObject,s),g=(0,d.o9)(t);e.appendEventData({externalEntityKey:g}),m(l),u.log(`Read collab object to get all meeting artifacts for ${g}`);try{const o=yield r(),s=yield o.readCollabObject(i,t,n,a,c),l=((null==s?void 0:s.resources)||[]).filter((e=>f(e.type))).map((e=>Object.assign({id:e.id,type:h(e.type),location:e.location,subType:e.subType},e.metadata)));u.log(`type of resources received after reading collabObject to get all meeting artifacts are ${(0,d.Uk)(l)}`);const m={changeKey:null==s?void 0:s.changeKey,resources:l};return e.stop({message:(0,d.Uk)(l)}),m}catch(t){return(0,d.S3)(u,t,e,"cmd_meetings_collab_object_read_collab_object_event","get meetingArtifacts query failed with errorCode"),Promise.reject(t)}}))},allMeetingArtifactsBatch(e,{meetingArtifactsBatchInputList:t},{getCollabObjectService:n,scenarioFactory:a,loggerFactory:r}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:i}=(0,d.aN)(o.RG.ReadCollabObjectBatchRequest,a);m(r),u.log(`Read group of meeting artifacts for ${t.length} meetings start`);try{const a=yield n(),o=function(e){const t=[];if(null==e?void 0:e.collabMap){const n=e.collabMap;Object.keys(n).forEach((e=>{var i;const a={iCalUid:e,value:{resources:((null===(i=n[e].collab)||void 0===i?void 0:i.resources)||[]).filter((e=>f(e.type))).map((e=>Object.assign({id:e.id,type:h(e.type),location:e.location,subType:e.subType},e.metadata)))}};t.push(a)}))}return t}(yield a.readCollabObjectBatchRequest(i,function(e){const t={collabIds:{}};return e.forEach((e=>{t.collabIds=Object.assign(Object.assign({},t.collabIds),{[e.iCalUid]:{smtp:e.organizer}})})),t}(t)));return u.log(`Read group of meeting artifacts for ${o.length} meetings success`),e.stop(),o}catch(t){return(0,d.S3)(u,t,e,"cmd_meetings_collab_object_read_collab_object_batch_request_event","get meetingArtifacts batch request query failed with errorCode"),Promise.reject(t)}}))},reserveMeetingArtifact(e,{externalEntityKey:t,seriesExternalEntityKey:n,organizer:a,user:r,meetingParams:l},{getCollabObjectService:c,scenarioFactory:g,loggerFactory:p,callerApp:h}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:i}=(0,d.aN)(o.RG.ReserveResourceToCollabObject,g),f=(0,d.o9)(t),y=(0,d.o9)(n);e.appendEventData({externalEntityKey:f,seriesExternalEntityKey:y}),m(p),u.log(`Reserve meeting artifact for instance externalEntityKey: ${f}, series externalEntityKey: ${y}`);try{const o=s.ceh.Notes,d=yield c(),u=yield d.reserveResourceToCollabObject(i,function(e,t,n,i,a,o){return{type:e.toLowerCase(),externalEntityKey:t,seriesExternalEntityKey:n,meetingUrl:o.meetingUrl,threadId:o.threadId,messageId:o.messageId,organizerUpn:o.organizerUpn,organizer:i,user:a}}(o,t,n,a,r,l),h);if(null==u?void 0:u.collab){const t=v(o,u);return e.stop(),Object.assign(Object.assign({},u),{collab:{changeKey:null==u?void 0:u.collab.changeKey,resources:t}})}return e.stop(),u}catch(t){return(0,d.S3)(u,t,e,"cmd_meetings_collab_object_reserve_resource_to_collab_object_event","reserveMeetingArtifact query failed with errorCode"),Promise.reject(t)}}))},readAndOptionallyReserveMeetingArtifact(e,{externalEntityKey:t,organizer:n,user:a},{getCollabObjectService:r,scenarioFactory:l,loggerFactory:c,callerApp:g}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:i}=(0,d.aN)(o.RG.ReadAndOptionallyReserveResourceToCollabObject,l),p=(0,d.o9)(t);e.appendEventData({externalEntityKey:p}),m(c),u.log(`Read and Optionally Reserve meeting artifact for instance externalEntityKey: ${p}`);try{const o=s.ceh.Notes,l=yield r(),c=yield l.readAndOptionallyReserveResourceToCollabObject(i,function(e,t,n,i){return{type:e.toLowerCase(),externalEntityKey:t,organizer:n,user:i}}(o,t,n,a),g);if(null==c?void 0:c.collab){const t=v(o,c);return e.stop(),Object.assign(Object.assign({},c),{collab:{changeKey:null==c?void 0:c.collab.changeKey,resources:t}})}return e.stop(),c}catch(t){return(0,d.S3)(u,t,e,"cmd_meetings_collab_object_read_and_optionally_reserve_resource_to_collab_object_event","readAndOptionallyReserveMeetingArtifact query failed with errorCode"),Promise.reject(t)}}))}},Mutation:{addMeetingArtifacts(e,{externalEntityKey:t,seriesExternalEntityKey:n,organizer:a,user:o,meetingParams:r,meetingArtifacts:s},{getCollabObjectService:l,scenarioFactory:c,loggerFactory:d,callerApp:u}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return p(l,c,d,u,t,n,a,o,s,r)}))},commitMeetingArtifact(e,{externalEntityKey:t,seriesExternalEntityKey:n,organizer:a,user:l,secret:u,resourceUri:g,metadata:p},{getCollabObjectService:v,scenarioFactory:h,loggerFactory:f,callerApp:y}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=m(f),{scenario:i,correlationId:b}=(0,d.aN)(o.RG.CommitResourceToCollabObject,h);try{const o=yield v(),m=(0,d.o9)(t),h=(0,d.o9)(n);return e.log(`commit Meeting Artifact to instance externalEntityKey: ${m}, series externalEntityKey: ${h}`),i.appendEventData({externalEntityKey:m,seriesExternalEntityKey:h}),u?(yield o.commitResourceToCollabObject(b,function(e,t,n,i,a,o,r,s){var l;const d=null!==(l=s)&&void 0!==l?l:{};return{type:e.toLowerCase(),externalEntityKey:t,seriesExternalEntityKey:n,organizer:i,user:a,secret:o,resourceUri:r,metadata:(0,c.omitBy)(S(d),c.isEmpty)}}(s.ceh.Notes,t,n,a,l,u,g,p),y),i.stop(),!0):(e.error("commit Meeting Artifact API called without secret"),i.fail({errorCode:r.py.INVALID_SECRET.toString(),message:r.WK.INVALID_SECRET}),!1)}catch(t){return(0,d.S3)(e,t,i,"cmd_meetings_collab_object_commit_resource_to_collab_object_event","commit Meeting Artifact commit mutation failed with errorCode"),Promise.reject(t)}}))},updateMeetingArtifacts(e,{externalEntityKey:t,seriesExternalEntityKey:n,organizer:s,user:c,meetingParams:u,changeKey:g,meetingArtifacts:p},{getCollabObjectService:v,scenarioFactory:h,loggerFactory:f,callerApp:y}){var S;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=m(f),{scenario:i,correlationId:k}=(0,d.aN)(o.RG.UpdateResourcesOnCollabObject,h),w=(0,d.o9)(t),C=(0,d.o9)(n);e.log(`Update meeting artifacts for externalEntityKey: ${w} and seriesExternalEntityKey: ${C}`);try{const o=yield v(),m=null!==(S=p)&&void 0!==S?S:[];if(i.appendEventData({externalEntityKey:w,seriesExternalEntityKey:C,message:(0,d.Uk)(m)}),0===m.length){const t=(0,l.Tr)(a.w5.CmdArtifactsServiceClient,a.jK.InvalidInput,"meetingArtifactsResolver.updateMeetingArtifacts",{[r.zm.internalErrorCode]:r.py.EMPTY_INPUT,[r.zm.logErrorMessage]:r.WK.EMPTY_INPUT},r.WK.EMPTY_INPUT.toString());return(0,d.S3)(e,t,i,"cmd_meetings_collab_object_add_resources_to_collab_object_event","addMeetingArtifactsCalled with an empty array of meeting artifacts"),!1}return yield o.updateResourcesOnCollabObject(k,function(e,t,n,i,a,o,r){return{externalEntityKey:e,seriesExternalEntityKey:t,organizer:n,user:i,meetingUrl:a.meetingUrl,threadId:a.threadId,messageId:a.messageId,organizerUpn:a.organizerUpn,changeKey:o,resources:b(r)}}(t,n,s,c,u,g,m),y),i.stop(),!0}catch(t){return(0,d.S3)(e,t,i,"cmd_meetings_collab_object_update_resource_on_collab_object_event","UpdateMeetingArtifacts mutation failed"),Promise.reject(t)}}))}},MeetingArtifactV2Union:{__resolveType:e=>e.type===s.ceh.Transcript?"MeetingArtifactV2Transcript":e.type===s.ceh.Recording?"MeetingArtifactV2Recording":e.type===s.ceh.Notes?"MeetingArtifactV2Notes":e.type===s.ceh.MeetingContent?"MeetingArtifactV2MeetingContent":"MeetingArtifactV2Default"}};function p(e,t,n,a,s,l,c,u,g,p){var v;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=m(n),{scenario:h,correlationId:f}=(0,d.aN)(o.RG.AddResourcesToCollabObject,t);h.appendEventData({callerApp:a});try{const t=yield e(),n=(0,d.o9)(s);i.log(`Adding meeting artifacts to externalEntityKey: ${n}`);const o=null!==(v=g)&&void 0!==v?v:[];return h.appendEventData({externalEntityKey:n,message:(0,d.Uk)(o)}),0===o.length?(i.error("addMeetingArtifacts called with and empty array of meeting artifacts"),h.fail({errorCode:r.py.EMPTY_INPUT.toString(),message:r.WK.EMPTY_INPUT}),!1):(yield t.addResourcesToCollabObject(f,function(e,t,n,i,a,o){return{externalEntityKey:e,seriesExternalEntityKey:t,organizer:n,user:i,meetingUrl:a.meetingUrl,threadId:a.threadId,messageId:a.messageId,organizerUpn:a.organizerUpn,resources:b(o)}}(s,l,c,u,p,o),a),h.stop(),!0)}catch(e){return(0,d.S3)(i,e,h,"cmd_meetings_collab_object_add_resources_to_collab_object_event","addMeetingArtifacts mutation failed with errorCode"),Promise.reject(e)}}))}const v=(e,t)=>{var n,i;return null===(i=null===(n=null==t?void 0:t.collab)||void 0===n?void 0:n.resources)||void 0===i?void 0:i.filter((t=>t.type.toLowerCase()===s.ceh[e].toLowerCase())).map((e=>Object.assign(Object.assign({},e),{id:e.id,type:h(e.type),location:e.location,metadata:e.metadata,subType:e.subType})))},h=e=>{for(const t of Object.keys(s.ceh))if(t.toLowerCase()===e.toLowerCase())return s.ceh[t];return e},f=e=>{for(const t of Object.keys(s.ceh))if(t.toLowerCase()===e.toLowerCase())return!0;return!1},y=e=>{var t,n;const i=null!==(t=e.metadata)&&void 0!==t?t:{};return{id:e.id,location:e.location,type:e.type,subType:null!==(n=null==i?void 0:i.appTitle)&&void 0!==n?n:"",metadata:S(i)}},b=e=>e.map(y),S=e=>(e=>{let t={};if(e.state){const n=t;t=Object.assign(Object.assign({},n),{state:e.state})}if(e.isShared){const n=t;t=Object.assign(Object.assign({},n),{isShared:e.isShared})}if(e.linkScope){const n=t;t=Object.assign(Object.assign({},n),{linkScope:e.linkScope})}if(e.hostClient){const n=t;t=Object.assign(Object.assign({},n),{hostClient:e.hostClient})}if(e.appId){const n=t;t=Object.assign(Object.assign({},n),{appId:e.appId})}if(e.appTitle){const n=t;t=Object.assign(Object.assign({},n),{appTitle:e.appTitle})}if(e.fileTitle){const n=t;t=Object.assign(Object.assign({},n),{fileTitle:e.fileTitle})}if(e.imageUrl){const n=t;t=Object.assign(Object.assign({},n),{imageUrl:e.imageUrl})}if(e.userId){const n=t;t=Object.assign(Object.assign({},n),{userId:e.userId})}if(e.shareUrl){const n=t;t=Object.assign(Object.assign({},n),{shareUrl:e.shareUrl})}if(e.fileId){const n=t;t=Object.assign(Object.assign({},n),{fileId:e.fileId})}if(e.fileType){const n=t;t=Object.assign(Object.assign({},n),{fileType:e.fileType})}if(e.baseUrl){const n=t;t=Object.assign(Object.assign({},n),{baseUrl:e.baseUrl})}if(e.objectUrl){const n=t;t=Object.assign(Object.assign({},n),{objectUrl:e.objectUrl})}if(e.meetingContentMetadataObject){const n=t;t=Object.assign(Object.assign({},n),{meetingContentMetadataObject:e.meetingContentMetadataObject})}if(e.thumbnailUrl){const n=t;t=Object.assign(Object.assign({},n),{thumbnailUrl:e.thumbnailUrl})}return t})(e)},2352:(e,t,n)=>{"use strict";n.d(t,{w:()=>r,s:()=>s});var i=n(361366),a=n(909966),o=n(5020);const r={Query:{meetingBotMetaInfo(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{getMeetingBotService:e}=n,t=yield e();return{meetingBotMri:yield t.getBotId(),__typename:"MeetingBotMetaInfo"}}))},meetingBotCalendarEvents(e,{start:t,end:n},a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield a.getMeetingBotService();return(yield e.fetchCalendarEvents(t,n)).filter((e=>!e.isAllDayEvent&&e.isOnlineMeeting)).map((e=>{var t;return{id:e.objectId,start:new Date(e.startTime).toUTCString(),end:new Date(e.endTime).toUTCString(),iCalUID:e.iCalUID,subject:e.subject,objectId:e.objectId,conversationId:null===(t=e.skypeTeamsDataObj)||void 0===t?void 0:t.cid,skypeTeamsMeetingUrl:e.skypeTeamsMeetingUrl,isCancelled:e.isCancelled,isAllDayEvent:e.isAllDayEvent}}))}))},meetingBotChatIdForCalendarEvent(e,{eventId:t},n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n.getMeetingBotService()).fetchChatIdForCalendarEvent(t)}))}},Mutation:{postMeetingStarted(e,{absentAttendees:t,hasRecordingStarted:n,meetingId:o,isForced:r},s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield s.getMeetingBotService();if(!r&&e.isMeetingEventSent(o,a.$.MeetingStart))return"absentAttendee checked";if(e.setMeetingEventSent(o,a.$.MeetingStart),t&&t.length>0){const i=yield e.postEventToBot({Scenario:a.$.MeetingStart,MeetingInfo:{HasRecordingStarted:n,AbsentAttendee:t}});return`${null==i?void 0:i.status}`}return"no absent attendees"}))},postGreetingToMeetingBot(e,{input:{meetingId:t,organizerId:n,recordingState:o,hasPresentedDeck:r,hasRecordingStarted:s,hasProactiveAction:l,absentAttendee:c,timeElapedSinceMeetingStartedInMinutes:d,hasNextMeeting:u,endTime:m,isRecurrent:g}},p){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield p.getMeetingBotService();if(e.isMeetingEventSent(t,a.$.InMeetingGreeting)||e.isMeetingEventSent(t,a.$.MeetingStart))return!1;e.setMeetingEventSent(t,a.$.InMeetingGreeting);return!!(yield e.postEventToBot({Scenario:a.$.InMeetingGreeting,MeetingInfo:{MeetingId:t,AbsentAttendee:c,OrganizerId:n,RecordingState:o,HasPresentedFile:r,HasProactiveAction:l,HasRecordingStarted:s,TimeElapedSinceMeetingStartedInMinutes:d,HasNextMeeting:u,EndTime:m,IsRecurrent:g,Subject:"Subject"}}))}))},tryStartMeetingBotPublisher(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{getMeetingBotService:e,loggerFactory:t}=n;t.newLogger("MeetingBot Resolver","data-resolvers-browser-meeting-artifacts").log("tryStartMeetingBotPublisher");const i=yield e();return yield i.startPublisher(),!0}))},sendActionStatus(e,{botAction:t,isActionSucess:n,nextMeetingName:o},r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield r.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.InMeetingActionStatusUpdated,MeetingInfo:{InMeetingAction:t,IsActionSucceed:n,NextMeetingName:o}}),!0}))},sendRunningLateForNextMeetingNotification(e,{iCalUID:t,subject:n,objectId:o,conversationId:r},s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield s.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.RunningLate,MeetingInfo:{CallId:t,ThreadId:r,Subject:n,MeetingUid:o}}),!0}))},removeCalendarEvent(e,{eventId:t},n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield n.getMeetingBotService();return yield e.removeCalendarEvent(t),"Message sent"}))},sendMeetingBotMessage(e,{text:t,conversationId:n},a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield a.getMeetingBotService()).sendMeetingBotMessage(t,n)}))},sendMeetingObjectId(e,{meetingObjectId:t},n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield n.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.InMeetingShareFile,MeetingInfo:{MeetingId:t}}),!0}))},reportUsageToMeetingBot(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n.getMeetingBotService()).reportUsageToMeetingBot()}))},triggerBotAction(e,{conversationId:t,botAction:n,actionId:a},o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield o.getMeetingBotService(),i=yield e.fetchChatIdForCalendarEvent(t);return o.pubsub.publish("meetingBotActionEvent",{meetingBotActionEvent:{conversationId:i,botAction:n,actionId:a},__typename:"meetingBotActionEvent"}),!0}))},sendMessageToConversation(e,{conversationId:t,message:n,files:a},o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(a&&!a.length)return!1;const e=yield o.getMeetingBotService();return yield e.sendToConversation(t,n,a),!0}))}}},s={Subscription:{meetingBotActionEvent:{subscribe:(0,o.OF)(((e,t,{pubsub:n})=>n.asyncIterator(["meetingBotActionEvent"])),((e,t)=>t.conversationId===e.meetingBotActionEvent.conversationId))}}}},842533:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserMeetingRoomMeetingRoomFrontOfRoomCallPanelsStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingRoomFrontOfRoomCallPanelsState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"rightPanel"}}]}}]}}]}},993985:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i="payment-service"},792897:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});var i=n(993985),a=n(550598);let o;const r={Mutation:{updatePaymentDetailsInCache:(e,{eventId:t,paymentDetails:n},{cache:r,loggerFactory:s})=>{var l;(e=>{o||(o=e.newLogger(i.k,"data-resolvers-browser-payment"))})(s);try{const e=(null===(l=r.readQuery({query:a.Z,variables:{eventId:t}}))||void 0===l?void 0:l.paymentDetails)||{},i=Object.assign(Object.assign(Object.assign({},e),n),{__typename:"PaymentDetails"});return r.writeQuery({query:a.Z,variables:{eventId:t},data:{paymentDetails:i}}),Object.assign(Object.assign({},i),{__typename:"PaymentDetails"})}catch(e){throw o.error("Payment client resolver failed to update payment details in cache",e),e}}}}},550598:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"paymentDetails"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"eventId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paymentDetails"},arguments:[{kind:"Argument",name:{kind:"Name",value:"eventId"},value:{kind:"Variable",name:{kind:"Name",value:"eventId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"eventId"}},{kind:"Field",name:{kind:"Name",value:"paymentProvider"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"product"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount"}},{kind:"Field",name:{kind:"Name",value:"currency"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}}]}}]}}]}}]}}]}}]}},708551:(e,t,n)=>{"use strict";n.d(t,{w:()=>v});var i=n(361366),a=n(48697),o=n(65903),r=n(197981);function s(e,t){return t.isGeneral&&e.memberRole!==o.k_p.Admin&&function(e){return e.teamSettings&&e.teamSettings.generalChannelPosting===o.S1B.OwnersPost}(e)}function l(e,t){return e.isUserMuted?o.Jb0.MutedTeamMember:s(e,t)?o.Jb0.OnlyOwnersCanPost:o.Jb0.None}var c=n(119283);function d(e,t){var n,i;return{id:t.id,channelType:m(t.channelType),isGeneral:t.isGeneral||!1,displayName:t.displayName,disallowedToPostReason:l(e,t),consumptionHorizon:t.consumptionHorizon?Object.assign(Object.assign({},t.consumptionHorizon),{__typename:"ClientConsumptionHorizon"}):null,filesRelativePath:(null===(n=t.defaultFileSettings)||void 0===n?void 0:n.filesRelativePath)||null,memberRole:g(t.memberRole),isModerator:t.isModerator||!1,channelSettings:{__typename:"ChannelSettings",channelPostPermissions:p(null===(i=t.channelSettings)||void 0===i?void 0:i.channelPostPermissions)},sharepointSiteUrl:t.sharepointSiteUrl||null,team:{id:e.id,displayName:e.displayName,groupId:e.teamSiteInformation.groupId,sharepointSiteUrl:e.teamSiteInformation.sharepointSiteUrl||null,pictureETag:e.pictureETag||null,smtpAddress:e.smtpAddress,teamSettings:e.teamSettings,__typename:"ClientTeam"},isArchived:t.isArchived,isDeleted:t.isDeleted,__typename:"ChannelWithTeam"}}function u(e){return(0,r.flatMap)(e,(e=>e.filteredChannels.map(d.bind(void 0,e))))}function m(e){switch(e){case o.xuW.Standard:return o.kK_.Standard;case o.xuW.Private:return o.kK_.Private;case o.xuW.Shared:return o.kK_.Shared;default:return null}}const g=e=>{switch(e){case o.k_p.Admin:return o.k_p.Admin;case o.k_p.Guest:return o.k_p.Guest;case o.k_p.User:return o.k_p.User;case o.k_p.Undefined:default:return o.k_p.Undefined}},p=e=>{switch(e){case o.XIP.Moderators:return o.XIP.Moderators;case o.XIP.EveryoneButGuests:return o.XIP.EveryoneButGuests;case o.XIP.Everyone:default:return o.XIP.Everyone}},v={Query:{channelSearch:(e,{searchQuery:t},n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let e=yield h(n);if(0===e.length)return{__typename:"ChannelSearchResults",resultsByChannelName:[],resultsByTeamName:[]};e=e.filter((e=>!e.isDeleted)).map((e=>Object.assign(Object.assign({},e),{channels:e.channels.filter((e=>!e.isDeleted))})));const i=new RegExp((0,r.escapeRegExp)(t.toLowerCase())),a=(0,r.cloneDeep)(e).filter((e=>i.test(e.displayName.toLowerCase()))).map((e=>(e.filteredChannels=e.channels,e)));return{__typename:"ChannelSearchResults",resultsByChannelName:u(e.map((e=>(e.filteredChannels=e.channels.filter((e=>i.test(e.displayName.toLowerCase()))),e)))),resultsByTeamName:u(a)}})),channel:(e,{channelId:t},n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e=yield h(n);let i;return(0,r.forEach)(e,(e=>{const n=(0,r.find)(e.channels,{id:t});return!n||(i=d(e,n),!1)})),i}))}};function h(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,cache:n,coreSettings:i,localStorage:o,loggerFactory:r,scenarioFactory:s}=e;let l;try{({teams:l}=n.readQuery({query:a.TK}))}catch(e){r.newLogger("ClientResolvers","data-resolvers-browser-teams").warn("Cache error, returning empty data instead");const d=t&&(yield(0,c.Qp)(t,i,o,s));if(d){const e=d.map(c.uX);n.writeQuery({query:a.TK,data:{teams:e}})}l=d||[]}return l}))}},48697:(e,t,n)=>{"use strict";n.d(t,{TK:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"teamsList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"isDeleted"}},{kind:"Field",name:{kind:"Name",value:"isUserMuted"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"smtpAddress"}},{kind:"Field",name:{kind:"Name",value:"pictureETag"}},{kind:"Field",name:{kind:"Name",value:"teamSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalChannelPosting"}}]}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"channels"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"isDeleted"}},{kind:"Field",name:{kind:"Name",value:"isArchived"}},{kind:"Field",name:{kind:"Name",value:"isGeneral"}},{kind:"Field",name:{kind:"Name",value:"isShown"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"channelSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelPostPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"isModerator"}}]}}]}}]}}]}},119283:(e,t,n)=>{"use strict";n.d(t,{uX:()=>f,Qp:()=>C,xm:()=>E,GC:()=>A});var i=n(361366),a=n(197981),o=n(47135),r=n(343324),s=n(973737),l=n(490503),c=n(469929),d=n(60746),u=n(739582),m=n(10339),g=n(65903);const p="conversations",v="teams-list";function h(e){var t,n;return Object.assign(Object.assign(Object.assign({__typename:"Channel"},(0,a.defaults)((0,a.pick)(e,["id","channelType","displayName","isArchived","isDeleted","isGeneral","isModerator","isShown","memberRole"]),{channelType:null,isArchived:null,isDeleted:null,isModerator:null,memberRole:null})),{channelSettings:(0,a.defaults)(e.channelSettings,{__typename:"ChannelSettings",channelPostPermissions:null}),defaultFileSettings:{__typename:"DefaultFileSettings",filesRelativePath:(null===(t=e.defaultFileSettings)||void 0===t?void 0:t.filesRelativePath)||null},sharepointSiteUrl:e.sharepointSiteUrl||null}),(null===(n=e.consumptionHorizon)||void 0===n?void 0:n.id)?{consumptionHorizon:{__typename:"ConsumptionHorizon",id:e.consumptionHorizon.id,timeStamp:e.consumptionHorizon.timeStamp||null}}:{consumptionHorizon:null})}function f(e){return Object.assign(Object.assign({__typename:"Team"},(0,a.defaults)((0,a.pick)(e,["id","displayName","isDeleted","isUserMuted","memberRole","smtpAddress","pictureETag","teamType"]),{isUserMuted:null,pictureETag:null,smtpAddress:null,teamType:null})),{teamSettings:{__typename:"TeamSettings",generalChannelPosting:e.teamSettings.generalChannelPosting||null},teamSiteInformation:Object.assign({__typename:"TeamSiteInformation"},(0,a.defaults)((0,a.pick)(e.teamSiteInformation,["groupId","sharepointSiteUrl"]),{groupId:null,sharepointSiteUrl:null})),channels:(e.channels||[]).map(h)})}function y(e){try{return JSON.parse(e)}catch(e){return}}function b(e){if(!e||0===e.length)return;const t=new Map,n=new Map;e.filter((e=>e&&(0,l.HU)(e))).map((e=>t.set(e.id,function(e){var t;const n=e.threadProperties;return Object.assign({id:e.id,displayName:n[c.Q5.SpaceThreadTopic]||"",isDeleted:(0,l.uY)(e),memberRole:w((null===(t=e.memberProperties)||void 0===t?void 0:t.role)||c.nL.None),teamSiteInformation:{groupId:n[c.Q5.GroupId]||"",sharepointSiteUrl:n[c.Q5.SiteUrl]},smtpAddress:n[c.Q5.TeamSmtpAddress],pictureETag:n[c.Q5.PictureETag],isFavorite:(0,l.Dq)(e),channels:[]},function(e){const t=y(e.threadProperties[c.Q5.TeamAdminSettings]);return t?{teamSettings:t.userSettings,teamGuestSettings:t.guestSettings}:{teamSettings:{}}}(e))}(e)))),e.filter((e=>e&&(0,l.J6)(e)&&e.threadProperties)).map((e=>n.set(e.id,{teamId:e.threadProperties[c.Q5.SpaceId],channel:S(e)}))),n.forEach((e=>{const{teamId:n,channel:i}=e,a=n&&t.get(n);a&&(i.team=a,a.channels.push(i))}));const i=Array.from(t.values());return i.length>0?i:void 0}function S(e){const t=e.threadProperties,n=t[c.Q5.SpaceTypes]===d.tG.Private;return{id:e.id,displayName:(n?t[c.Q5.SpaceThreadTopic]:(0,l.T7)(e))||"",description:t[c.Q5.TopicDescription]||"",isDeleted:(0,l.uY)(e),isGeneral:(0,l.HU)(e),channelType:k(t[c.Q5.SpaceTypes]),tabs:[],isShown:(0,l.Dq)(e),isShownByDefault:"true"===t[c.Q5.FavDefault],sharepointSiteUrl:n?t[c.Q5.SiteUrl]:void 0,defaultFileSettings:{filesRelativePath:t[c.Q5.FolderRelativeUrl]},consumptionHorizon:(0,u._l)(e.id,e.properties[c.Ff.ConsumptionHorizon])}}function k(e){switch(e){case d.tG.Private:return g.xuW.Private;case d.tG.Shared:return g.xuW.Shared;case d.tG.None:default:return g.xuW.Standard}}function w(e){switch(e){case c.nL.Admin:return g.k_p.Admin;case c.nL.Guest:return g.k_p.Guest;case c.nL.User:return g.k_p.User;case c.nL.None:default:return g.k_p.Undefined}}function C(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableChannelLocalCache:i,channelLocalCacheMaxDays:r,enableChannelIndexedDBCache:s,disableChannelIndexedDBNextCache:l}=t.get(o.J.Search);let c,d=!1;if(s&&(c=yield E(e.profile.objectId,e.profile.tenantId,a,!!l),d=void 0!==c),i&&(function(e,t){const n=N(e),i=new Date(Date.now()),a=new Date((null==n?void 0:n.timestamp)||0);a.setDate(a.getDate()+t),a<i&&e.remove(v)}(n,d?0:r||7),!c)){const e=N(n);c=null==e?void 0:e.teams}return c}))}let _;let T;const I=(0,m.J)();function E(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return _||(_=function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const o=n.newScenario(r.RG.GetTeamsChannelsFromIndexedDB),l=a=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=function(e,t,n){return n?`Teams:conversation-manager:${t}:${e}`:`skypexspaces-${e}`}(e,t,n),o=function(e){return e?2:7}(n);return(0,s.q8)(i,o,p,"",a,!0)}))}(e,t,a,n)}catch(e){return void o.appendEventData({errors:JSON.stringify(e)})}}));let c;if(a||(c=yield l(!0)),c||(c=yield l(!1)),c)try{const e=b(c);return o.stop({message:e?"Successfully fetched.":"Conversations store does not contain any teams or channels."}),e}catch(e){return void o.fail({errors:"Fails to convert conversations to teams."})}else o.fail({errors:"unable to read conversations from indexedbd"})}))}(e,t,n,a),T=I.setTimeout((()=>{_=void 0,I.clearTimeout(T),T=void 0}),3e5),_)}))}function N(e){const t=e.get(v);if(t)return y(t)}function A(e,t){e.setSafe(v,JSON.stringify({timestamp:Date.now(),teams:t}))}},483094:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i="webinar-service"},479786:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webinarImageQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"webinarId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webinarImage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"webinarId"},value:{kind:"Variable",name:{kind:"Name",value:"webinarId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"}}]}}]}}]}},943969:(e,t,n)=>{"use strict";n.d(t,{HY:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webinar"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"webinarId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webinar"},arguments:[{kind:"Argument",name:{kind:"Name",value:"webinarId"},value:{kind:"Variable",name:{kind:"Name",value:"webinarId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"allWebinarFiels"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"allWebinarFiels"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Webinar"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"eventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"accessPolicy"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"isFull"}},{kind:"Field",name:{kind:"Name",value:"privacyProfileStatementLink"}},{kind:"Field",name:{kind:"Name",value:"capacity"}},{kind:"Field",name:{kind:"Name",value:"price"}}]}},{kind:"Field",name:{kind:"Name",value:"speakerBios"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"speakerId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"questionnaire"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"questionId"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}},{kind:"Field",name:{kind:"Name",value:"isPredefined"}}]}},{kind:"Field",name:{kind:"Name",value:"isUserAlreadyRegistered"}},{kind:"Field",name:{kind:"Name",value:"joinLink"}},{kind:"Field",name:{kind:"Name",value:"participantRole"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"registrationId"}},{kind:"Field",name:{kind:"Name",value:"paymentTransactionId"}}]}}]}.definitions]}},977307:(e,t,n)=>{"use strict";n.d(t,{O:()=>a,a:()=>o});var i=n(943969);const a=(e,t)=>{try{const n=e.readQuery({query:i.HY,variables:{webinarId:t}});if(!n||!n.webinar)throw new Error("Invalid cached webinar data");return n.webinar}catch(e){throw e}},o=(e,t,n,o)=>{try{const o=a(n,e),r=Object.assign(Object.assign({},o),{questionnaire:t.map((e=>{var t,n,i;return Object.assign(Object.assign({},e),{name:null!==(t=e.name)&&void 0!==t?t:null,displayName:null!==(n=e.displayName)&&void 0!==n?n:null,options:null!==(i=e.options)&&void 0!==i?i:null,__typename:"WebinarQuestion"})}))});n.writeQuery({variables:{webinarId:e},query:i.HY,data:{webinar:r}})}catch(e){throw o.error("Webinar resolver fails to update webinar questions in cache."),e}}},885769:(e,t,n)=>{"use strict";n.d(t,{s:()=>c});var i=n(483094),a=n(943969),o=n(479786),r=n(977307);let s;const l=e=>s||(s=e.newLogger(i.k,"data-resolvers-browser-webinar")),c={Mutation:{updateWebinarDetails:(e,{webinarId:t,detailsInput:n},{cache:i,loggerFactory:o})=>{l(o);try{const e=(0,r.O)(i,t),o=Object.assign(Object.assign({},e),{eventDetails:Object.assign(Object.assign(Object.assign({},e.eventDetails),n),{__typename:"WebinarDetails"})});return i.writeQuery({variables:{webinarId:t},query:a.HY,data:{webinar:o}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar details in cache."),e}},updateWebinarQuestions:(e,{webinarId:t,questionsInput:n},{cache:i,loggerFactory:a})=>(l(a),(0,r.a)(t,n,i,s),{_:!0,__typename:"Webinar"}),updateWebinarSpeakers:(e,{webinarId:t,speakersInput:n},{cache:i,loggerFactory:o})=>{l(o);try{const e=(0,r.O)(i,t),o=Object.assign(Object.assign({},e),{speakerBios:n.map((e=>Object.assign(Object.assign({},e),{__typename:"WebinarSpeakerBio"})))});return i.writeQuery({variables:{webinarId:t},query:a.HY,data:{webinar:o}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar speakers in cache."),e}},updateWebinarImage:(e,{webinarId:t,webinarImageInput:n},{cache:i,loggerFactory:a})=>{l(a);try{return i.writeQuery({variables:{webinarId:t},query:o.C,data:{webinarImage:{image:n.image,__typename:"WebinarImage"}}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar image in cache."),e}}}}},78997:(e,t,n)=>{"use strict";n.d(t,{Mv:()=>r,kO:()=>s,a2:()=>c,LH:()=>d});var i=n(361366),a=n(197981),o=n(443467);function r(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return l(e,t)}))}function s(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return l(e,t,n)}))}function l(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,a.uniqBy)(e,(e=>e)),r=(0,a.chunk)(i.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT),s=yield Promise.all(r.map((e=>t.getPeopleProfilesByMris(e,n,!0,!1,!0))));let l=[];return s.forEach((e=>{l=l.concat(Array.from(e.values(),(e=>(0,o.ne)(e))))})),l}))}function c(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,a.uniqBy)(e,(e=>e)),r=(0,a.chunk)(i.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT);return(yield Promise.all(r.map((e=>t.getPeopleProfilesIncludeFederatedByMris(e,!0,!1,n))))).map((e=>Array.from(e.values(),(e=>(0,o.ne)(e))))).reduce(((e,t)=>e.concat(t)),[])}))}function d(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,a.uniqBy)(e,(e=>e)),r=(0,a.chunk)(i.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT);return(yield Promise.all(r.map((e=>t.getTflConsumerProfilesByMris(e,n||null))))).map((e=>Array.from(e.values(),(e=>(0,o.ne)(e))))).reduce(((e,t)=>e.concat(t)),[])}))}},739582:(e,t,n)=>{"use strict";n.d(t,{NP:()=>L,b6:()=>U,Hi:()=>W,xA:()=>H,FX:()=>V,Rx:()=>z,eH:()=>Q,OB:()=>K,is:()=>te,YU:()=>se,it:()=>le,H4:()=>ue,Ey:()=>me,dx:()=>ge,zK:()=>pe,Th:()=>ve,TK:()=>he,iB:()=>fe,DP:()=>ye,Gt:()=>be,yU:()=>Se,ac:()=>ke,uA:()=>we,bv:()=>Ce,_l:()=>Te,wX:()=>Ne,ob:()=>Ae,sf:()=>Fe,fN:()=>Me,FH:()=>je,pR:()=>$e,b_:()=>Be,zT:()=>We,vI:()=>He,Qq:()=>Ve,I6:()=>ze,AY:()=>Qe,nF:()=>Ye,Lr:()=>Ze,_$:()=>et,x6:()=>tt,Hl:()=>nt,lg:()=>it,_S:()=>at,t4:()=>ot,ph:()=>rt,O5:()=>lt,eN:()=>dt,YX:()=>mt,im:()=>gt,l0:()=>pt,D1:()=>vt,Pi:()=>ht,MB:()=>ft,Go:()=>yt,xT:()=>bt,RU:()=>St,eY:()=>kt,_V:()=>wt,aw:()=>Ct,rP:()=>_t,qJ:()=>Tt,UL:()=>It,AK:()=>Et,YD:()=>Nt,wm:()=>At,nI:()=>Ft,fM:()=>Dt,GE:()=>xt,Eu:()=>Mt,NL:()=>Ot,SX:()=>$t,Dy:()=>Wt,Er:()=>Ht});var i=n(361366),a=n(47135),o=n(585478),r=n(513368),s=n(325276),l=n(317421),c=n(97600),d=n(469929),u=n(60746),m=n(182302),g=n(490503),p=n(991161),v=n(844943),h=n(622419),f=n(660329),y=n(209114),b=n(76672),S=n(297055),k=n(494326),w=n(786884),C=n(471285),_=n(197981),T=n(437194),I=n(379720),E=n(443467),N=n(778764),A=n(556569),F=n(895961),D=n(912825),R=n(30791),x=n(65903),M=n(258248),O=n(761734);const P="http://schema.skype.com/StarredMessage",L="http://schema.skype.com/File",U=2,j=b.F,$=new Map([["sms",x.F6r.SMS],["email",x.F6r.Email],["call",x.F6r.Call],["teamscall",x.F6r.TeamsCall],["etnp",x.F6r.ETNP]]),B=new Set(["RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]);var W;!function(e){e.FAMILY="family",e.FRIENDS="friends",e.PROJECT="projectCoord",e.WORKPLACE="company",e.TRIP_PLANNING="tripPlanning",e.GET_TOGETHER="getTogether",e.LOCAL_COMMUNITY="localCommunity",e.HOLIDAY_PLANNING="holidayPlanning"}(W||(W={}));const H="preview-",V="newchat",z="welcomePage",q=(e,t,n=!1)=>{if(!(null==e?void 0:e.emotions))return null;const i=e.emotions.map((({key:e,users:t})=>({key:e,users:t.map((({mri:e,time:t,value:n})=>({id:j(e),time:t,value:n}))).sort(((e,t)=>e.time-t.time))})));return n&&i.sort(((e,n)=>{var i,a,o,r,s,l;return(null!==(o=null!==(a=null===(i=null==t?void 0:t.emotions)||void 0===i?void 0:i[n.key])&&void 0!==a?a:n.users.length)&&void 0!==o?o:0)-(null!==(l=null!==(s=null===(r=null==t?void 0:t.emotions)||void 0===r?void 0:r[e.key])&&void 0!==s?s:e.users.length)&&void 0!==l?l:0)})),i},G=e=>{if(!e||!e.emotions)return null;const t=e.emotions;return Object.keys(t).map((e=>({key:e,count:t[e]})))},J=e=>{if(!e||!e.escalations)return null;return JSON.parse(e.escalations).map((({key:e,users:t})=>({key:$.get(e),users:t.map((({mri:e,time:t,value:n})=>({mri:j(e),time:t,value:n})))})))},Q=(e,t,n)=>e&&e.mentions?X(e.mentions,t,n):null,K=(e,t,n)=>e&&e.onbehalfof?X(e.onbehalfof,t,n):null,Y=(e,t)=>{if(!t||!t.atp)return null;const n=t.atp;try{return"string"==typeof n?JSON.parse(n):n}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toAtpSharepointData: ${t}`),null}},X=(e,t,n)=>{var i;try{if("string"==typeof e&&(0,c.lp)(e))return null;const n="string"==typeof e?JSON.parse(e):e;return(null==n?void 0:n.length)?n.map((({itemid:e,mri:n,displayName:i,mentionType:a})=>({id:`${t}_${e}_${n}`,userId:n,itemId:e,displayName:i,mentionType:a}))):null}catch(e){const a=null==n?void 0:n.newLogger("Chat Helper","data-resolvers-common");return null===(i=null==a?void 0:a.errorToTelemetry)||void 0===i||i.call(a,`UnhandledException in messageId: ${t}, processMentions - errorcode: ${e.errorcode}, error: ${e.error}`,"process_mentions_parse_error"),null}},Z=(e,t,n,i)=>{var a,o,r;if(!t||!t.files)return null;const s=e.newLogger("Chat Helper","data-resolvers-common");try{let e=JSON.parse(null==t?void 0:t.files),r=0;return e=e.filter((e=>"deeplink"===e.type)),r=e.length,e=e.filter((e=>e)),r!==e.length&&(null===(a=null==s?void 0:s.errorToTelemetry)||void 0===a||a.call(s,`toDeepLinks::Files contains falsy value. Filtered out.::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),r=e.length),e=e.filter((e=>e.id)),r!==e.length&&(null===(o=null==s?void 0:s.errorToTelemetry)||void 0===o||o.call(s,`toDeepLinks::Files contains object without id field which should be a required field. Filtered out.::id=${n}::conversationId=${i}`,"process_deeplink_parse_error")),e.map((({id:e,title:t,fileInfo:n,channelId:i,state:a})=>({id:e,title:t,state:a,serverRelativeUrl:n.serverRelativeUrl,channelId:i,siteUrl:n.siteUrl,objectUrl:n.fileUrl})))}catch(e){return null===(r=null==s?void 0:s.errorToTelemetry)||void 0===r||r.call(s,`toDeepLinks::errorcode=${e.errorcode}::error=${e.error}::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),null}},ee=e=>{if("string"==typeof e)try{const t=(0,R.d)(e).languages.split(":")[0];return"null"===t?null:t}catch(e){return null}return null},te=e=>e&&JSON.stringify((0,_.map)(e,(e=>{var{content:t}=e,n=(0,i.__rest)(e,["content"]);return Object.assign(Object.assign({},n),{content:JSON.parse(t)})}))),ne=(e,t)=>{if(!e||!e.links)return{urlPreview:null,embeddedLinks:null};try{const t=["http","https"],n=JSON.parse(e.links),i=[],a=[];return n.forEach((e=>{ie(e,i,t),ae(e,a,t)})),{urlPreview:a.length>0?a[0]:null,embeddedLinks:i}}catch(e){return t.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message transformation: ${e}`),{urlPreview:null,embeddedLinks:null}}},ie=(e,t,n)=>{const{url:i,fileShareUrlMeta:a,title:o,description:r}=e,s=(0,S.Nm)(i,n);a&&t.push({objectUrl:s,title:o,description:r,fileShareUrlMeta:a})},ae=(e,t,n)=>{const{url:i,preview:a,previewenabled:o}=e,{previewurl:r,previewmeta:s,title:l,description:c}=a||{},d=(0,S.Nm)(i,n);t.push({url:d,thumbnail:(0,S.Nm)(r,n),title:l,description:c,previewEnabled:o,thumbnailMeta:s?{width:s.width,height:s.height}:null})},oe=(e,t,n,i)=>{let a=i&&i.policyViolation;const o=i&&i.genericStreamMetadata;if(!a&&!o)return null;const r={};if("string"==typeof a)try{a=JSON.parse(a)}catch(n){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing PolicyViolation in message: ${t}. Error: ${n}`)}a&&(r.policyViolation=a);let s=o&&o.policyTip;if("string"==typeof o)try{s=JSON.parse(o).policyTip}catch(n){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing policy tip in message: ${t}. Error: ${n}`)}if(s){const e=i&&i.subject;r.dlpData={id:t,content:n,policyTip:s,subject:e}}return r},re=e=>{if(!e.scheduledmeetinginfo||(0,_.isNil)(e.scheduledmeetinginfo.eventType))return null;const t=e.scheduledmeetinginfo,{iCalUid:n}=t,a=(0,i.__rest)(t,["iCalUid"]);return Object.assign({iCalUID:n},a)},se=e=>{const{itemId:t,meetingTitle:n,meetingActionType:a,scheduledMeetingInfo:o}=e,r=(0,i.__rest)(e,["itemId","meetingTitle","meetingActionType","scheduledMeetingInfo"]),s=Object.assign(Object.assign(Object.assign({},r),(e=>{const{iCalUID:t}=e,n=(0,i.__rest)(e,["iCalUID"]);return{scheduledmeetinginfo:Object.assign(Object.assign({},n),{iCalUid:t})}})(o)),{itemid:t,meetingtitle:n,"@type":a});return JSON.stringify(s)},le=(e,t)=>{if(!t||!t.meeting)return null;try{const e=JSON.parse(t.meeting),{organizerId:n,tenantId:i,meetingJoinUrl:a,location:o,itemid:r,meetingtitle:s,rsvpTo:l,body:c}=e;return(0,F.w)({meetingActionType:e[d.BM.MeetingType],organizerId:n,tenantId:i,meetingJoinUrl:a,location:o,itemId:r,meetingTitle:s,rsvpTo:l,body:c,scheduledMeetingInfo:re(e)})}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toMeeting: ${t}`),null}},ce=(e,t,n,i)=>{const a=t||n;if(a)return a;if(i&&B.has(e)){const e=i.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},de=(e,t)=>"-1"===e?t:e,ue=(0,l.Z)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),me=(e,t)=>{if(e.length<=1)return e;const n=ue(t),i=[...e];return i.sort(((e,t)=>n.compare(e.displayName||"",t.displayName||""))),i},ge=(e,t,n)=>{const i=me(e,n),a=[],o=[];return(0,_.forEach)(i,(e=>{const{id:n,displayName:i}=e;if(n!==t&&!A.eo.isTFLOffNetworkUser(n)&&i){if(o.push(i),20===o.length)return!1;a.length<3&&a.push(e)}return!0})),{membersLimited:a,memberDisplayNamesLimited:o}},pe=(e,t,n,i,a,o)=>{var s;if(!(null==e?void 0:e.id))return;const l=ve(e,t,i,a,n,!!o),{id:d,clientmessageid:u,messagetype:m,properties:g,callId:p,skypeguid:v,composetime:h,content:f,conversationid:y,draftDetails:b,crossPostData:S}=e,k=(0,c.kw)(b),{callHistoryInput:w,isSlaCallHistory:C}=(0,T.fb)(g);return Object.assign(Object.assign({},l),{__typename:"Message",interopDeliveryState:jt(null==g?void 0:g.deliveryState),smsDeliveryReports:g&&g.smsDeliveryReports?g.smsDeliveryReports:null,announcement:Ce(g),escalations:J(g),notification:Pt(t,g),notifications:Ut(t,g),meeting:le(t,g),onBehalfOf:K(g,d,t),callId:ce(m,p,v||g&&g.skypeguid,f),callLog:g&&(0,T.Hb)(de(d,u),w,y,m,f,t,C),skypeguid:v,composeTime:h,isCallStartedMessage:(0,r.LY)(f,m),replyPermission:null!==(s=null==g?void 0:g.replyPermission)&&void 0!==s?s:null,atpSharepointData:Y(t,g),isDeletedByAdmin:(null==g?void 0:g.adminDelete)||!1,suggestedActions:(null==g?void 0:g.suggestedActions)||null,scheduledSendTime:k?new Date(k).toISOString():null,draftId:(null==g?void 0:g.draftId)||(k?null==l?void 0:l.id:null),conversationId:y,crossPostStatus:S?(0,M.N)(S.status):void 0,crossPostFailedChannels:null==S?void 0:S.failedChannels})},ve=({id:e,content:t,originalarrivaltime:n,from:i,messagetype:a,annotationsSummary:o,userHasStarred:r,properties:s,clientmessageid:l,version:c,imdisplayname:d,translation:g,conversationid:p,conversationLink:v},h,f,y,b,S=!1)=>{let k=t;f&&(k=f);const w=(0,m.le)(h,s,y),C=(e=>{const{body:t,subject:n,title:i,toggled:a,detectedLanguageName:o,sourceLanguageCode:r,targetLanguageCode:s,error:l}=e||{};return(void 0!==t||void 0!==l)&&o&&r&&s?{translationStatus:(()=>{if(!a)return x.C14.ShowOriginalMessage;if(!l)return x.C14.Done;switch(l){case u.AO.Success:return x.C14.Done;case u.AO.SkipTranslation:return x.C14.TranslationNotNeeded;case u.AO.MessageNotFound:return x.C14.MessageNotFound;case u.AO.VersionNotFound:return x.C14.VersionNotFound;case u.AO.LanguageDetectionFailed:return x.C14.LanguageDetectionFailed;case u.AO.UnsupportedSourceLanguage:return x.C14.UnsupportedSourceLanguage;default:return x.C14.UnknownError}})(),translatedSubject:n,translatedContent:t,translatedTitle:i,sourceLanguageName:o,sourceLanguageCode:r}:void 0})(g),_=(null==C?void 0:C.translationStatus)===x.C14.Done?(0,D.M)()[0].toString():c,T=ee(null==s?void 0:s.languageStamp);return Object.assign(Object.assign(Object.assign({id:de(e,l),content:k,originalArrivalTime:n,from:j(i),messageType:(0,m.DE)(h,a,s),isImportant:(0,I.wU)(null==s?void 0:s.importance),importance:(0,I.gy)(null==s?void 0:s.importance),emotionsSummary:G(o),emotions:q(s,o,S),mentions:Q(s,e,h),cards:w,files:(0,m.jz)(h,s),deeplinks:Z(h,s,e,p||v)},ne(s,h)),{deleteTime:null==s?void 0:s.deletetime,editTime:null==s?void 0:s.edittime,version:_,userHasSaved:r,imDisplayName:d,clientMessageId:l,dlpContext:oe(h,e,t,s),atpSharepointData:Y(h,s),status:b||x.rJC.Delivered,hardDeleteReason:null==s?void 0:s.hardDeleteReason,hardDeleteTime:null==s?void 0:s.hardDeleteTime,onBehalfOf:K(s,e,h),sourceLanguageCode:T}),C)},he=({content:e,id:t,messageType:n,originalArrivalTime:i,type:a,version:o})=>({__typename:"Message",content:e,id:t,messageType:n,originalArrivalTime:new Date(i).toISOString(),type:a,version:o}),fe=(e,t,n)=>{const i=pe(e,t,wt(e.state),void 0,void 0,!!(null==n?void 0:n.shouldSortReactions));if(!i)throw(0,w.Tr)("ChatHelpers",C.jK.Undefined,"toNewMessageSchema",{resource:e},"Bad shaped NewMessage");let a=null;if(e&&e.conversationLink){const t=(0,c.P5)(e);a=t===i.id?null:t}return{convId:e.conversationid||(0,c.o_)(e),replyChainId:a,threadType:e.threadtype,threadTopic:e.threadtopic,message:i}};function ye(e,t){return{__typename:"Message",content:"",messageType:"Text",id:e,originalArrivalTime:t,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,embeddedLinks:null,callId:null,replyPermission:null,onBehalfOf:null,atpSharepointData:null,deeplinks:null,version:null,importance:null,interopDeliveryState:null,smsDeliveryReports:null,suggestedActions:null,emotions:null,emotionsSummary:null,escalations:null,mentions:null,status:null,diagnosticInfo:null,clientMessageId:e,urlPreview:null,dlpContext:null,editTime:null,deletionInfo:null,translation:null,userHasSaved:null}}function be(e,t){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:t,timeStamp:t,clientMessageId:(0,N.K)()}}function Se(e){const t=new Date,n=t.toISOString(),i=t.getTime().toString();return Object.assign(Object.assign({},{members:[],membersLimited:[],activeCallsCount:null,canBeDiscarded:null,canBeFavorited:null,canBeHidden:null,botMembers:null,canBeLeft:null,canBeMuted:null,canBePinned:null,canBotBeBlocked:null,canManageApps:null,canPopOut:null,canTagContact:null,chatSubType:null,isDisabled:!1,isOneOnOne:!1,isOneOnOneBotChat:!1,isRead:!0,datatid:null,displayName:null,hasActions:null,hasActiveCalls:null,hasFailedMessages:null,isBotBlocked:null,isBotUser:null,isContactTagged:null,isFederated:!1,isHidden:null,isHighImportance:null,isLastMessageFromMe:null,isLastMessageText:null,isMeeting:!1,isMuted:null,isNewChat:!0,isSfB:!1,isUrgentImportance:null,isUserMember:!0,creator:null,meetingInformation:null,userConsumptionHorizon:null,consumptionHorizonBookmark:null,lastMessageTime:null,lastContentMessageTime:null,longTitle:null,messagePreview:null,messagePreviewAria:null,otherMemberMris:null,pictureGroup:null,pictureUpn:null,pinnedIndex:null,plGroupKey:null,presenceSource:null,showAtMention:null,showMarkers:null,tooltipTitle:null,substrateGroupId:null}),{__typename:"Conversation",id:e,memberIds:[],memberDisplayNamesLimited:[],nonTeamsFederatedUserLimitedNames:[],hasFederatedUser:!1,chatHistoryHiddenTime:null,hasTflConsumerUser:!1,hasEnterpriseUser:!1,hasUnknownConsumerUser:!1,hasUnknownEnterpriseUser:!1,hasTflSmsUnverifiedUser:!1,hasTflSmsVerifiedUser:!1,tflOffNetworkUser:null,cfet:!1,consumerGroupId:null,tenantId:null,title:"",hasBotMember:!1,hasUnresolvedFederatedUser:!1,isChatDisabledForRecipients:!1,typingUsers:[],isPrivateChatPolicyDefinedScenario:null,meetingChatPolicy:null,me:null,tflOffNetworkUserLength:null,nonTeamsFederatedUsers:[],nonTeamsFederatedUsersLength:0,chatType:x.z_3.Chat,type:x.z_3.Chat,lastMessage:ye(i,n),consumptionHorizon:be(e,n),addedBy:null,addedByTenantId:null,sensitivityLabel:null})}const ke=(e,t,n,a)=>{var{annotationsSummary:o,id:r,from:s,messageType:l,properties:c,version:d}=e,u=(0,i.__rest)(e,["annotationsSummary","id","from","messageType","properties","version"]);if(void 0===a&&(a=!1),!r)return null;const{callHistoryInput:g,isSlaCallHistory:p}=(0,T.fb)(c);try{return Object.assign(Object.assign(Object.assign({__typename:"Message",id:r,from:s,messageType:(0,m.DE)(n,l,c),version:(0,_.isNumber)(d)?d.toString():void 0,isImportant:(0,I.wU)(c&&c.importance),importance:(0,I.gy)(c&&c.importance),interopDeliveryState:jt(null==c?void 0:c.deliveryState),smsDeliveryReports:(null==c?void 0:c.smsDeliveryReports)||null,emotions:q(c,o,a),emotionsSummary:G(o),announcement:Ce(c),escalations:J(c),mentions:Q(c,r,n),onBehalfOf:K(c,r,n),cards:(0,m.le)(n,c),files:(0,m.jz)(n,c),deeplinks:Z(n,c,r,t)},ne(c,n)),{deleteTime:c&&c.deletetime,editTime:c&&c.edittime,isDeletedByAdmin:c&&c.adminDelete,scheduledSendTime:(null==c?void 0:c.sendAt)||null,draftId:(null==c?void 0:c.draftId)||null,hardDeleteTime:c&&c.hardDeleteTime,hardDeleteReason:c&&c.hardDeleteReason,suggestedActions:(null==c?void 0:c.suggestedActions)||null,status:x.rJC.Delivered,dlpContext:oe(n,r,u.content,c),meeting:le(n,c),callId:c&&c.skypeguid,callLog:c&&(0,T.Hb)(r,g,t,l,u.content,n,p),sourceLanguageCode:ee(null==c?void 0:c.languageStamp)}),u)}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message transformation: ${e}`),Object.assign({id:r,from:s,messageType:(0,m.DE)(n,l,c),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null},u)}},we=({originalArrivalTime:e,timeStamp:t,clientMessageId:n})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(t).toISOString(),clientMessageId:n}),Ce=e=>{const t={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e)return t;const n="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!n||0===n.length)return t;const i=n.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!i)return t;const a=_e(i);return{title:e.title?e.title:"",originalImageUrl:a.originalImageUrl,croppedImageUrl:a.croppedImageUrl,colorTheme:a.colorTheme,croppedImageHeight:a.croppedImageHeight,croppedImageWidth:a.croppedImageWidth,croppedImageAltText:a.croppedImageAltText,isTeamsIllustration:a.isTeamsIllustration}},_e=e=>{let t=(0,_.get)(e,"content.imageData.origImage.src",null),n=(0,_.get)(e,"content.imageData.croppedImage.src",null);const i=(0,_.get)(e,"content.imageData.croppedImage.imageHeight",null),a=(0,_.get)(e,"content.imageData.croppedImage.imageWidth",null),o=(0,_.get)(e,"content.imageData.croppedImage.imageAltText",null),r=(0,_.get)(e,"content.imageData.isTeamsIllustration",null);let s=(0,_.get)(e,"content.imageData.colorTheme",null)||(0,_.get)(e,"content.colorTheme",null);return t=void 0===t?null:t,n=void 0===n?null:n,s=void 0===s?null:s,{originalImageUrl:t,croppedImageUrl:n,croppedImageHeight:i,croppedImageWidth:a,croppedImageAltText:o,colorTheme:s,isTeamsIllustration:r}},Te=(e,t)=>{if(!t||(0,_.isEmpty)(t))return null;const[n,i,a]=t.split(";"),o=parseInt(n,10),r=parseInt(i,10);return isNaN(o)||isNaN(r)?null:Object.assign({id:e},we({originalArrivalTime:o,timeStamp:r,clientMessageId:a}))},Ie=(e,t,n)=>{try{const n=Ee(t),i=null==n?void 0:n.map((t=>({activityReplyToId:t.replyToId,activityTimestamp:t.timestamp,convId:e,suggestedReplies:t.suggestedActions.actions.filter((e=>{var t,n;return(null===(t=null==e?void 0:e.channelData)||void 0===t?void 0:t.id)&&(null===(n=null==e?void 0:e.channelData)||void 0===n?void 0:n.utcTime)})).map((e=>{var n,i;const a={targetMessageId:(null===(n=null==e?void 0:e.channelData)||void 0===n?void 0:n.targetMessageId)||t.replyToId,type:(null===(i=null==e?void 0:e.channelData)||void 0===i?void 0:i.type)||"reply"};return{suggestionChannelData:Object.assign(Object.assign({},null==e?void 0:e.channelData),a),value:e.value,whisperId:t.id}}))})));return i&&0!==i.length?{suggestedRepliesCollections:i}:null}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},Ee=e=>{const t=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>{var t,n,i;return(null==e?void 0:e.type)===d.uV&&(null===(t=null==e?void 0:e.from)||void 0===t?void 0:t.id)===d.ZI&&(null==e?void 0:e.timestamp)&&(null===(i=null===(n=null==e?void 0:e.suggestedActions)||void 0===n?void 0:n.actions)||void 0===i?void 0:i.some((e=>e.type===d.qC||e.type===d.DC)))}));return t&&0!==t.length?t:null},Ne=(e,t,n)=>{const i=t&&t[d.Ff.SmartReplies];return i&&"string"==typeof i?((e,t,n)=>{try{const i=JSON.parse(t);return Ie(e,i,n)}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromString: Exception in parsing quick reply augmentation. Error: ${e}`),null}})(e,i,n):null},Ae=e=>{switch(e){case u.wJ.None:return x.wJZ.Unknown;case u.wJ.Adhoc:return x.wJZ.Adhoc;case u.wJ.Scheduled:return x.wJZ.Scheduled;case u.wJ.Recurring:return x.wJZ.Recurring;case u.wJ.Broadcast:return x.wJZ.Broadcast;case u.wJ.MeetNow:return x.wJZ.MeetNow}},Fe=e=>e&&e.map((e=>({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})))||null;function De(e,t){if(!e||!t)return!1;return(0,g.hu)(e,t)>0}function Re(e,t,n,i,a,o=!1,r=!1,s,l){const d=(0,m.C)(e,n),u=e.find((({id:e})=>e===t))||null,g=St(e),p=(0,c.iK)(e,a,[]).members||[];return Object.assign(Object.assign(Object.assign(Object.assign({memberIds:p.map((({id:e})=>e))},ge(p,t,i)),$e(d)),Qe(t,p)),{me:u,isUserMember:!!u,tflOffNetworkUser:(0,_.first)(g),tflOffNetworkUserLength:g.length,hasBotMember:p.some((({id:e})=>(0,c.bl)(e))),hasFederatedUser:!!d.length||o,hasTflConsumerUser:Ve(p)||r,hasEnterpriseUser:Je(p),hasUnknownEnterpriseUser:Ge(p),hasUnknownConsumerUser:qe(p),hasUnresolvedFederatedUser:d.some(A.eo.isUnknownUser),hasTflSmsUnverifiedUser:He(p),hasTflSmsVerifiedUser:ze(p),isRetentionHorizonSet:De(l,s)})}const xe=e=>{switch(typeof e){case"string":return"true"===e.toLowerCase()}return e};function Me(e){const t=Object.keys(null!=e?e:{}).filter((e=>e.includes(d.Q5.Liveness))).map((t=>({key:t,value:String(e[t])})));return(0,_.isEmpty)(t)?null:t}function Oe(e,t,n,i,o,r,s,l,m){var y,b,S,k,w,C,T,I;const{id:E,lastMessage:N}=e,A=function(e,t,n){if(e&&!(0,_.isEmpty)(e))return Ze(pe(e,t,void 0,void 0,void 0,n))}(N,i,!!(null===(b=null===(y=null==n?void 0:n.get(a.J.Messaging).expandedReactionsConfigs)||void 0===y?void 0:y.chat)||void 0===b?void 0:b.enableSend)),F=(null==r?void 0:r.id)||"",D=It(E),R=!!(0,g.YP)(e);let x={};if(A){let a=null==N?void 0:N.preview;if("string"!=typeof a&&!a){const r=(0,_.keyBy)(t,"id");n&&l&&(a=(0,h.t)({conversation:e,profilesMap:r,coreSettings:n,i18n:l,loggerFactory:i,currentUserMri:F,currentUserTenantId:null!=o?o:"",addSenderName:!0}))}const r=(0,O.aw)(A,F);x=Object.assign(Object.assign({},A),{preview:a,clientMessageId:D?Date.now().toString():null==A?void 0:A.clientMessageId,originalArrivalTime:D?e.clientArrivalTime:null==A?void 0:A.originalArrivalTime,isSystemMessage:(0,O.Ew)(A),hasMention:r,canShowEveryoneMentionBadge:(0,O.Hu)(A||void 0,F)&&!r})}const M=Re(t,F,o,s,e.threadProperties,null===(S=e.usersProps)||void 0===S?void 0:S.hasFederatedUser,null===(k=e.usersProps)||void 0===k?void 0:k.hasConsumerUser,n,e),P=function(e,t){const{id:n,properties:i,threadProperties:a}=e,o=Te(n,(0,p.zA)(e.properties));return{chatSubType:rt(a.threadType),chatType:lt(a.threadType),consumptionHorizon:Te(n,i[d.Ff.ConsumptionHorizon]),consumptionHorizonBookmark:o,quickReplyAugmentation:Ne(n,i,t),creator:a[d.Q5.Creator],importState:Xe(a[d.Q5.ImportState]),isDisabled:vt(a.isDisabled),disabledReason:Ye(a.disabledReason),isLastMessageFromMe:a.isLastMessageFromMe,meetingInformation:rt(a.threadType)===u.k2.Channel?void 0:yt(n,a[d.Q5.Meeting]),sensitivityLabel:a[d.Q5.SensitivityLabelId]?{id:a[d.Q5.SensitivityLabelId],isCopyBlocked:a[d.Q5.SensitivityLabelIsCopyBlocked]}:void 0,tenantId:a[d.Q5.TenantId],title:a.topic,userConsumptionHorizon:o,interopConversationStatus:dt(i[d.Ff.InteropConversationStatus]),gapDetectionEnabled:xe(a.gapDetectionEnabled),cfet:We(a.cfet),consumerGroupId:a[d.Q5.ConsumerGroupId],guardianChatInfo:a[d.Q5.GuardianChatInfo],groupTemplate:Rt(a[d.Q5.GroupTemplate]),themeId:a[d.Q5.ThemeId],picture:a[d.Q5.Picture],addedBy:(null==i?void 0:i.addedBy)||null,addedByTenantId:(null==i?void 0:i.addedByTenantId)||null,meetingChatPolicy:mt(a[d.Q5.MeetingChatPolicy]),chatScheduleSuggestionSuppressUntil:null==i?void 0:i.chatScheduleSuggestionSuppressUntil,isCommentStream:(0,v.Bu)(a),commentStreamPolicy:mt(a[d.Q5.CommentStreamPolicy])}}(e,i),L=e.properties.historyHiddenTime,U=(0,g.dO)(e,n).toString();return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),M),P),Le(e.memberProperties)),{shortTitle:null===(w=e.chatTitle)||void 0===w?void 0:w.shortTitle,longTitle:null===(C=e.chatTitle)||void 0===C?void 0:C.longTitle,id:E,isRead:Bt(e,(null==r?void 0:r.id)||""),isHidden:(0,f.n)(L,null==A?void 0:A.originalArrivalTime,U),isMuted:null!==(T=(0,g.tl)(e))&&void 0!==T?T:!!(0,c.e9)(E)&&m,isOneOnOne:R,isOneOnOneBotChat:R&&M.hasBotMember,isBotBlocked:Pe(null===(I=e.threadProperties)||void 0===I?void 0:I.messagingdisabled),isFederated:(0,c.eX)(E),isMeeting:(0,c.e9)(E),isSfB:(0,v.Jn)(E),lastMessage:x,awarenessLiveState:Me(e.threadProperties),members:[],clearHistoryTime:U,chatHistoryHiddenTime:L,type:null}),bt(e.threadProperties.pinnedItems))}const Pe=e=>"string"==typeof e?"true"===e.toLowerCase():Boolean(e),Le=e=>{const t=null==e?void 0:e[d.e0.RelationshipState];return{extendedDirectoryRedemptionRequired:null==t?void 0:t.edRedemptionRequired}},Ue=(e,t)=>(0,_.map)(t,(t=>e[t.id]||function(e){return(0,E.ne)(Object.assign(Object.assign({},e),{mri:e.id,objectId:"",type:"",userPrincipalName:"",isMuted:e.isReader,displayName:e.friendlyName}))}(t))),je=(e,t,n,i,a,o,r,s,l)=>{try{return Oe(e,Ue(t,e.members),n,i,a,o,r,s,l)}catch(t){return i.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toConversationSchemaFromSkypeConversationLocal transformation: ${t}`),Object.assign(Object.assign({},e),{id:e.id,isUserMember:!1,members:[],membersLimited:[],memberDisplayNamesLimited:[],type:null})}},$e=e=>{const t=e.filter((e=>{var t;return!A.eo.isUnknownUser(e)&&(null===(t=e.featureSettings)||void 0===t?void 0:t.coExistenceMode)!==s.hN.TeamsOnly&&!!e.displayName}));return{nonTeamsFederatedUserLimitedNames:t.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:t.length}},Be=(e,t,n)=>{try{const n=Ue(t,e.members);return{id:e.id,members:n}}catch(t){return n.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toConversationMembersSchemaFromSkypeConversationLocal transformation: ${t}`),{id:e.id,members:[]}}},We=e=>{switch(typeof e){case"string":return"true"===(null==e?void 0:e.toLowerCase())}return!!e},He=e=>e.some((({id:e})=>(0,c.MR)(e))),Ve=e=>e.some((e=>A.eo.isTFLConsumerUser(e))),ze=e=>e.some((e=>A.eo.isTFLSmsVerifiedMri(null==e?void 0:e.id))),qe=e=>e.some((e=>(0,c.Nl)(e.id)&&A.eo.isUnknownUser(e))),Ge=e=>e.some((e=>A.eo.isEnterpriseUserMri(e.id)&&A.eo.isUnknownUser(e))),Je=e=>e.some((e=>A.eo.isEnterpriseUserMri(e.id))),Qe=(e,t)=>{let n=!0;const i=t&&t.some((t=>{if(!t.isFederated&&t.id!==e&&t.featureSettings){const e=t.featureSettings.isPrivateChatEnabled;return null==e?(n=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:n,isChatDisabledForRecipients:i}},Ke={opted_out:x.Rdl.OptedOut,claimed:x.Rdl.Claimed,deprovisioned:x.Rdl.Deprovisioned},Ye=e=>{if(!e)return;const t=(0,k.D)(e);return{newlyCreatedUserId:t.userId,code:Ke[t.code]}},Xe=e=>{if(e)return x.B1J[e]},Ze=e=>Object.assign(Object.assign({},e),{__typename:"LastMessage"}),et=(e,t,n,a,o)=>{var r,{id:s,members:l,consumptionHorizon:c,userConsumptionHorizon:u,lastMessage:m,creator:g,meetingInformation:p,isDisabled:v,disabledReason:h,importState:f,isMuted:y,isLastMessageFromMe:b,isRead:S,isOneOnOne:k,isOneOnOneBotChat:w,isSticky:C,isExternal:T,consumerGroupId:I,templateType:N,chatType:A,historyHiddenTime:F,createdAt:D,interopConversationStatus:R,quickReplyAugmentation:M,meetingPolicy:O,addedBy:P,addedByTenantId:L,sensitivityLabel:U}=e,j=(0,i.__rest)(e,["id","members","consumptionHorizon","userConsumptionHorizon","lastMessage","creator","meetingInformation","isDisabled","disabledReason","importState","isMuted","isLastMessageFromMe","isRead","isOneOnOne","isOneOnOneBotChat","isSticky","isExternal","consumerGroupId","templateType","chatType","historyHiddenTime","createdAt","interopConversationStatus","quickReplyAugmentation","meetingPolicy","addedBy","addedByTenantId","sensitivityLabel"]);try{const e=(0,_.map)(l,(e=>(0,E.ne)(e))),i=m&&Ze(ke(m,s,t)),F=p&&{id:s,subject:p.subject,startTime:p.startTime,scenario:p.scenario,endTime:p.endTime,iCalUid:p.iCalUid,location:p.location,exchangeId:p.exchangeId,meetingType:p.meetingType?Ae(p.meetingType):x.wJZ.Unknown,resolvedSensitivityLabelId:p.resolvedSensitivityLabelId,isCopyRestrictionEnforced:p.isCopyRestrictionEnforced,meetingJoinUrl:p.meetingJoinUrl},D=!(!k&&!C&&N!==d.Q5.ImmutableRoster),$=U&&U.id?{id:U.id,isCopyBlocked:(null===(r=U.protectTeamsLabelAction)||void 0===r?void 0:r.isCopyRestrictionEnforced)||!1}:void 0;return Object.assign(Object.assign(Object.assign({__typename:"Conversation"},Re(e,(null==a?void 0:a.id)||"",n,o)),j),{id:s,consumptionHorizon:c&&Object.assign({__typename:"ConsumptionHorizon",id:s},we(c)),consumptionHorizonBookmark:u&&Object.assign({__typename:"ConsumptionHorizonBookmark",id:s},we(u)),userConsumptionHorizon:u&&Object.assign({__typename:"ConsumptionHorizonBookmark",id:s},we(u)),lastMessage:i,members:[],creator:g,meetingInformation:F,isDisabled:!!v,disabledReason:Ye(h),importState:Xe(f),isMuted:y,isLastMessageFromMe:!!b,isRead:S,isOneOnOne:D,cfet:T,consumerGroupId:I,isOneOnOneBotChat:!!w,chatType:lt(A),interopConversationStatus:dt(R),quickReplyAugmentation:M&&Ie(s,M,t),addedBy:P,addedByTenantId:L,meetingChatPolicy:mt(O),sensitivityLabel:$})}catch(e){t.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${e}`);return Object.assign(Object.assign({},j),{id:s,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:F,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,chatType:null})}},tt=({id:e,members:t},n)=>{try{const n=(0,_.map)(t,(e=>(0,E.ne)(e)));return{__typename:"ConversationMembers",id:e,members:n}}catch(t){n.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${t}`);return{id:e,members:[]}}},nt=(e,t,n,i,a)=>({node:et(e,t,n,i,a),cursor:e.createdAt||e.id}),it=e=>({activities:e.activities,callLogs:e.callLogs,chats:e.chats,total:e.total});function at(e){return JSON.stringify((0,_.map)(e,(e=>{const t=e.mentionType,n=e.displayName;return{"@type":"http://schema.skype.com/Mention",itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}function ot(e){return!e||e.length<1?null:JSON.stringify(e.map((e=>{const t=e.mentionType,n=e.displayName;return{itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}const rt=e=>{if(e)return"space"===e||"topic"===e?u.k2.Channel:"meeting"===e?u.k2.Meeting:u.k2.None},st=new Map([["chat",x.z_3.Chat],["phonechat",x.z_3.PhoneChat],["phonelink1on1chat",x.z_3.Phonelink1on1Chat],["phonelinkgroupchat",x.z_3.PhonelinkGroupChat],["meeting",x.z_3.Meeting],["sfbinteropchat",x.z_3.SfBInteropChat]]),lt=e=>{let t=null;return null==e||(t=st.get(e),void 0===t&&(t=null)),t},ct=new Map([["AcceptPending",x.uI5.AcceptPending],["ExtendedDirectoryAcceptPending",x.uI5.ExtendedDirectoryAcceptPending],["Accepted",x.uI5.Accepted],["Blocked",x.uI5.Blocked],["Quarantined",x.uI5.Quarantined]]),dt=e=>e&&ct.get(e)||null,ut=new Map([["ChatEnabled",x.UOl.ChatEnabled],["ChatDisabled",x.UOl.ChatDisabled],["InMeeting",x.UOl.InMeeting],["ChatEnabledAnonymousDisabled",x.UOl.ChatEnabledAnonymousDisabled],["InMeetingAnonymousDisabled",x.UOl.InMeetingAnonymousDisabled]]),mt=e=>e&&ut.get(e)||null,gt=e=>!!e&&e===x.z_3.PhoneChat,pt=e=>{if(!e)return!1;switch(typeof e){case"string":e="true"===e.toLowerCase();case"boolean":return e;default:return!1}},vt=e=>(0,_.isString)(e)?"true"===e.toLowerCase():e||!1,ht=({id:e,conversationid:t,imdisplayname:n,from:i,composetime:a},o)=>e&&{"@type":P,mri:j(i),imdisplayname:n,messageId:e,parentMessageId:null!=o?o:e,threadId:t,isUnresolvedEmailUser:!1,originalComposeTime:a},ft=(e,t,n)=>{const i=n.find((n=>{try{const i=JSON.parse((n.properties||{}).starred),a=i&&i["@type"]===P&&i.threadId===t?i.messageId:void 0;return e===a}catch(e){return!1}}));return i&&i.id},yt=(e,t)=>{if(!t)return;const n=JSON.parse(t);return Object.keys(t).length?Object.assign(Object.assign({id:e},n),{meetingJoinUrl:n.meetingJoinUrl||n.meetingJoinURL,meetingType:n.meetingType?Ae(u.wJ[n.meetingType]):x.wJZ.Unknown}):void 0},bt=e=>{if(e)try{const t=JSON.parse(e);return{pinnedConversationItems:t.reduce(((e,t)=>(t.itemType===x.Voh.Message&&e.push({__typename:"Message",id:t.itemId}),e)),[])}}catch(e){return}},St=e=>e.filter((({id:e})=>A.eo.isTFLOffNetworkUser(e))),kt=(e,t,n)=>{const i=q(n.properties);return!!i&&i.some((n=>n.key===e&&!!n.users&&n.users.some((e=>e.id===t))))},wt=e=>{let t;switch(e){case y.iv.Error:t=x.rJC.Error;break;case y.iv.Sending:t=x.rJC.Sending;break;default:t=x.rJC.Delivered}return t},Ct=({resourceType:e,resource:t},n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if("ThreadUpdate"===e)try{const{id:e="",members:i}=t,a=i?yield n(i,e):[];return{__typename:"ConversationMembers",id:e,members:a}}catch(e){a.newLogger("toChatMembersEvent","data-resolvers-common").error(`Failed getting thread members: ${e}`)}})),_t=e=>(0,v.Jn)(e)||(0,c.eX)(e)||(0,g.Bl)(e),Tt=(e,t)=>(0,_.filter)(e,(0,_.omit)(t,"__typename")),It=e=>!!e&&-1!==e.indexOf(H),Et=e=>!!(null==e?void 0:e.startsWith("tfl:preview-")),Nt=e=>!!e&&(-1!==e.indexOf(d.X2)||-1!==e.indexOf(d.At)),At=e=>e===V,Ft=e=>At(e)||It(e),Dt=e=>{switch(e){case W.FAMILY:case W.FRIENDS:case W.PROJECT:case W.WORKPLACE:case W.TRIP_PLANNING:case W.GET_TOGETHER:case W.LOCAL_COMMUNITY:case W.HOLIDAY_PLANNING:return!0}return!1},Rt=e=>{const t=e&&(0,k.D)(e).id;return Dt(t)?t:void 0},xt=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),Mt=e=>!!e&&e.includes("meeting"),Ot=(e,t,n,i,a,r,s)=>{if(e)return n?o.Th.Meeting:i?a?o.Th.Botchat:gt(t)?o.Th.SMSOneOnOneChat:(0,g.Bl)(e)?o.Th.SfcInteropChat:(0,v.Jn)(e)?o.Th.SfbInteropChat:r?o.Th.NativeFederatedChat:s?o.Th.FederatedChat:o.Th.OneOnOneChat:(0,g.mB)(e)?o.Th.StreamOfNotes:o.Th.GroupChat},Pt=(e,t)=>{if(!t||!t.notification)return null;try{const e=t.notification;return{alertInMeeting:e.alertInMeeting,externalResourceUrl:e.externalResourceUrl}}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in chat message notification transformation: ${t}`),null}},Lt=e=>{if((0,_.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,_.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},Ut=(e,t)=>{if(!t||!t.notifications)return null;try{const e="string"==typeof t.notifications?JSON.parse(t.notifications):t.notifications;return e&&e.map((({surface:e,contentType:t,content:n})=>{var i,a,o;return{surface:e,contentType:t,content:{value:{height:null!==(i=Lt(n.value.height))&&void 0!==i?i:void 0,width:null!==(a=Lt(n.value.width))&&void 0!==a?a:void 0,title:n.value.title,url:null!==(o=n.value.url)&&void 0!==o?o:""}}}}))}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message notifications parsing: ${t}`),null}};function jt(e){if(e)return"string"==typeof e?e:e.state}const $t=(e,t,n)=>{const i=n.get(a.J.Messaging).commCopilotSummarizationRequestConfig;return i?{gptVersion:i.gptVersion,summaryMode:i.summaryMode,input:{type:i.threadType,id:e,lookbackperiod:t},promptSetting:{temperature:"1.0"}}:null},Bt=(e,t)=>{if(At(e.id)||It(e.id))return!0;let n=(0,p.Hs)(e,t);if(!n&&Mt(e.id)&&e.lastContentMessageTime){const t=new Date(e.lastContentMessageTime).getTime(),i=(0,p.bf)(e),a=(0,p.BU)(e);n=t<=i.originalArrivalTime&&0===a.originalArrivalTime}return n},Wt=e=>e.chatSubType===u.k2.Channel,Ht=e=>{var t,n;if(Wt(e)){const i=null===(t=e.threadProperties)||void 0===t?void 0:t[d.Q5.SpaceTypes],a=i?parseInt(i,10):0;return!!!(null===(n=e.threadProperties)||void 0===n?void 0:n[d.Q5.SubstrateGroupId])&&a!==u.tG.Private}return!1}},951412:(e,t,n)=>{"use strict";n.d(t,{B:()=>g,c:()=>p});var i=n(486172),a=n(371825),o=n(987752),r=n(109458),s=n(337210),l=n(139130),c=n(197981),d=n(511629),u=n(440398),m=n(617435);function g(e,t){const n=(0,c.castArray)(e),i=(0,u.yM)(n.map((e=>e.resolvers))),a=(null==t?void 0:t.enableClassBasedErrors)?"function"==typeof i?(...e)=>(0,o.o)(i(...e),"CDLResolver"):(0,o.o)(i,"CDLResolver"):i;return p({schema:(0,d.sJ)({resolvers:a,typeDefs:(0,u.c5)(n.map((e=>e.typeDefs))),directiveResolvers:(0,u.yM)(n.map((e=>e.directiveResolvers))),noExtensionExtraction:!0,updateResolversInPlace:!0,resolverValidationOptions:{requireResolversForResolveType:"ignore"},skipASTValidation:!0}),contextValue:n.reduceRight(((e,t)=>Object.assign(Object.assign({},e),t.contextValue)),{})})}function p(e){return new i.i((t=>{const{query:n,variables:i}=t,{operation:o}=(0,r.S)(n,null),c=t.getContext(),{schema:d,contextValue:u}=null!=e?e:c.incremental,g=Object.assign(Object.assign({},u),c);return"subscription"===o?(0,m.F)((()=>(0,s.L)({schema:d,document:n,contextValue:g,variableValues:i}))):new a.y((e=>{try{Promise.resolve((0,l.ht)({schema:d,document:n,variableValues:i,contextValue:g})).then((t=>{e.closed||(e.next(t),e.complete())}),(t=>{e.closed||e.error(t)}))}catch(t){e.closed||e.error(t)}}))}))}},730808:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversConnectedCalendarShowHardDeleteSurfaceDialogQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowHardDeleteConnectedCalendarSurfaceDialog"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},657321:(e,t,n)=>{"use strict";n.d(t,{s:()=>o});var i=n(361366),a=n(730808);const o={Mutation:{setShouldShowHardDeleteConnectedCalendarSurfaceDialog:(e,{showDialog:t},{cache:n,loggerFactory:o})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{n.writeQuery({query:a.g,data:{shouldShowHardDeleteConnectedCalendarSurfaceDialog:t}})}catch(e){o.newLogger("setShouldShowHardDeleteConnectedCalendarSurfaceDialogMutation","data-resolvers-connected-calendar").error("Failed to write to client cache the show hard-delete connected calendar surface dialog mutation")}return t}))}}},634298:(e,t,n)=>{"use strict";n.d(t,{s:()=>s});var i=n(361366),a=n(696267),o=n(659617),r=n(870444);const s={Query:{localizationSettings(e,t,{hostCommunicationService:n,platformService:a,routingServices:s,i18n:l}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield d(s.state.getSearchState()||{});if(e)return{currentLocale:e};if(localStorage.getItem("localeCode"))return{currentLocale:localStorage.getItem("localeCode")};if(a.config.clientType===o.Bh.Web)return{currentLocale:l.locale};let t;try{const e=yield c(n);e?(t=(0,r.vw)(e).locale,yield l.setLocale(t)):t=l.locale}catch(e){t=l.locale}return{currentLocale:t}}))}},Mutation:{updateCurrentLocale(e,{newLocale:t},{cache:n,hostCommunicationService:r,loggerFactory:s,platformService:c,i18n:d}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const e={localizationSettings:{__typename:"LocalizationSettings",currentLocale:t}};return yield d.setLocale(t),localStorage.setItem("localeCode",t),n.writeQuery({query:a.y,data:e}),c.config.clientType!==o.Bh.Web&&(yield l(s,r,t)),{currentLocale:t}}catch(e){return{currentLocale:d.locale}}}))}}},l=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const a=e.newLogger("LocalizationSettingsResolvers","data-resolvers-localization-settings");try{const e=yield t.loadModule("osutils");(yield null===(i=null==e?void 0:e.setAppLocale)||void 0===i?void 0:i.call(e,{localeName:n}))||a.warn("hostingCommunicationService language set has failed")}catch(e){a.warn("hostingCommunicationService failed to load")}})),c=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;const n=yield e.loadModule("osutils"),i=yield null===(t=null==n?void 0:n.getAppLocale)||void 0===t?void 0:t.call(n);return null==i?void 0:i.localeName})),d=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(e.localeCode)return e.localeCode;if(e.language)return e.language.toLowerCase();if(!e.setting)return;const t=e.setting;let n;if(Array.isArray(t)){for(const e of t)if(e.startsWith("localeCode:")){n=e;break}}else t.startsWith("localeCode:")&&(n=t);return n?n.split(":")[1]:void 0}))},97037:(e,t,n)=>{"use strict";var i=n(361366);var a=n(197981),o=n(574540),r=n.t(o,2),s=n(58871),l=n(581721),c=n(82566),d=n(794781),u=n(759704);const m=e=>{if(g(e))return p(e)?{subNavEntity:v(e),headerEntity:h(e),startEntity:f(e),mainEntity:y(e),endEntity:b(e)}:null},g=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.agendapage].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},p=()=>!0,v=()=>null,h=()=>null,f=()=>null,y=({entity:e})=>e,b=()=>null,S={id:"com.microsoft.teams.agenda-page",name:"AgendaPageApp",supportedEntities:[u.p.agendapage],supportedRenderModes:[s.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},k=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(273621),n.e(899405),n.e(907784),n.e(838608),n.e(553211),n.e(714133),n.e(92700),n.e(603286),n.e(784198),n.e(623025),n.e(579814),n.e(110350),n.e(709528),n.e(301920),n.e(397914),n.e(501749),n.e(41547),n.e(398949),n.e(54570),n.e(968634),n.e(761569),n.e(494101)]).then(n.bind(n,953333));function w(){const e=()=>null;return{getAppViewEntities:m,manifest:S,render:({appRenderMode:t,loggerFactory:n,onRenderEvent:a,scenarioFactory:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e=n.newLogger("AgendaPageApp","apps-agenda-page"),t="agenda-page-app";a("ChunkLoadStarted",{chunkName:t});const{AgendaPage:i}=yield(0,c.mT)(k,t,r);return a("ChunkLoadSucceeded",{chunkName:t}),e.log("render: loading agendapage app"),o.createElement(l.f,{namespace:"calling",loaderRenderer:null},o.createElement(i,null))}return o.createElement(e,null)}))}}var C=n(65903);const _=e=>{if(T(e))return I(e)?{subNavEntity:E(e),headerEntity:N(e),startEntity:A(e),mainEntity:F(e),endEntity:D(e)}:null},T=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.annotation].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},I=()=>!0,E=()=>null,N=()=>null,A=()=>null,F=({entity:e})=>e,D=()=>null,R=()=>({[C.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!0,isSlotBackgroundTransparent:!0,UNSAFE_enablePptProvider:!0}}}),x={id:"com.microsoft.teams.annotation",name:"AnnotationApp",supportedEntities:[u.p.annotation],supportedRenderModes:[s.S.Main],windowFeatures:{additionalFeatures:{alwaysOnTop:"true",excludeWindowFromScreenSharing:"true",transparent:"true",hideWindowControl:"true",resizable:"false"},top:0,left:0,height:360,width:640,minHeight:360,minWidth:640}},M=()=>n.e(188357).then(n.bind(n,452989)),O=({windowOptions:e})=>e&&x.windowFeatures?{additionalFeatures:x.windowFeatures.additionalFeatures,top:e.top,left:e.left>0?e.left:e.left/2,width:x.windowFeatures.width,height:x.windowFeatures.height,minWidth:x.windowFeatures.minWidth,minHeight:x.windowFeatures.minHeight,fullscreen:!0}:Object.assign(Object.assign({},x.windowFeatures),{fullscreen:!0});function P(){const e=()=>null;return{getAppViewEntities:_,getAppViewEntitiesProps:R,getAppWindowFeatures:O,manifest:x,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const{Annotation:e}=yield(0,c.mT)(M,"annotation-app",n);return o.createElement(l.f,{namespace:"calling",loaderRenderer:null},o.createElement(e,null))}return o.createElement(e,null)}))}}var L=n(47135),U=n(484133);const j=e=>{if($(e))return B(e)?{subNavEntity:W(e),headerEntity:H(e),startEntity:V(e),mainEntity:z(e),endEntity:q(e)}:null},$=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.attendeeview].includes(i),r=n&&[u.u.default,u.u.create,u.u.view].includes(n);return!!(a&&o&&r)},B=()=>!0,W=()=>null,H=({entity:e})=>e,V=()=>null,z=({entity:e})=>e,q=()=>null,G=({coreSettings:e,themeOptions:t})=>{var n;const{enableLightThemeSupport:i=!1}=null!==(n=null==e?void 0:e.get(L.J.Calling))&&void 0!==n?n:{};return{[C.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!i||(null==t?void 0:t.isCallingWindowDarkTheme)}},[C.tF7.headerEntity]:{[s.S.HorizontalBar]:{doesHeaderOverlapMain:!1,isBackgroundTransparent:!0}}}},J={id:"com.microsoft.teams.attendee-view",name:"AteendeeViewApp",supportedEntities:[u.p.attendeeview],supportedRenderModes:[s.S.Main,s.S.HorizontalBar],windowFeatures:{height:360,width:640,minHeight:360,minWidth:640,offset:20}},Q=()=>Promise.all([n.e(239894),n.e(598731),n.e(132733),n.e(704475),n.e(785918),n.e(506205),n.e(613306),n.e(179947),n.e(495570),n.e(803120),n.e(771478),n.e(869731),n.e(117530)]).then(n.bind(n,660038)),K=()=>Promise.all([n.e(239894),n.e(598731),n.e(132733),n.e(704475),n.e(785918),n.e(506205),n.e(613306),n.e(179947),n.e(495570),n.e(803120),n.e(771478),n.e(869731),n.e(117530)]).then(n.bind(n,752997)),Y="attendee-view-app",X=(e,t,n,i)=>{const a=(e=>{const t=null==e?void 0:e.coreSettings.get(L.J.Host).disableOldDesktopCallMonitor;return(null==e?void 0:e.coreSettings.get(L.J.Calling).enableModernCallMonitor)||t?{width:304,height:247,cornerMargin:100}:{width:280,height:160,cornerMargin:16}})(i),o=a.cornerMargin,r=a.height+a.cornerMargin+16,s="availLeft"in e?e.availLeft:0,l=("availTop"in e?e.availTop:0)+e.availHeight-n-r,c=s+e.availWidth-t-o,d=l<0||c<0;return{top:d?0:l,left:d?0:c}},Z=({coreServices:e,host:t})=>{var n;const i=null==t?void 0:t.screen;if(!i)return null;const a=(null===(n=J.windowFeatures)||void 0===n?void 0:n.width)||640,o=(e=>e?360+(0,U.fh)(e.windowProvider,6)+(0,U.fh)(e.windowProvider,2.4):360)(e),{top:r,left:s}=X(i,a,o,e);return{additionalFeatures:{alwaysOnTop:"true",closable:"false",excludeWindowFromScreenSharing:"true",fullscreenable:"false",maximizable:"false",resizable:"false"},top:r,left:s,width:a,height:o,minWidth:a,minHeight:o}};function ee(){const e=()=>null;return{getAppViewEntities:j,getAppViewEntitiesProps:G,getAppWindowFeatures:Z,manifest:J,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const{AttendeeView:e}=yield(0,c.mT)(Q,Y,n);return o.createElement(te,null,o.createElement(e,null))}if(t===s.S.HorizontalBar){const{AttendeeToolbar:e}=yield(0,c.mT)(K,Y,n);return o.createElement(te,null,o.createElement(e,null))}return o.createElement(e,null)}))}}const te=({children:e})=>o.createElement(l.f,{namespace:"calling",loaderRenderer:null},e),ne={id:"com.microsoft.teams.biometric-enrollment",name:"BiometricEnrollmentApp",supportedRenderModes:[s.S.Main],supportedEntities:[u.p.voiceenrollment,u.p.faceenrollment],windowFeatures:{minWidth:900,width:900,minHeight:950,height:950}},ie=e=>{if(ae(e))return oe(e)?{subNavEntity:re(e),headerEntity:se(e),startEntity:le(e),mainEntity:ce(e),endEntity:de(e)}:null},ae=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.faceenrollment,u.p.voiceenrollment].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},oe=()=>!0,re=()=>null,se=()=>null,le=()=>null,ce=({entity:e})=>e,de=()=>null,ue=()=>Promise.all([n.e(893479),n.e(672617),n.e(134315),n.e(261098),n.e(3071),n.e(880414)]).then(n.bind(n,1301)),me=()=>ne.windowFeatures||{};function ge(){const e=()=>null;return{getAppViewEntities:ie,getAppWindowFeatures:me,manifest:ne,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="biometric-enrollment-entry",{BiometricEnrollmentEntry:t}=yield(0,c.mT)(ue,e,n);return o.createElement(t,null)}return o.createElement(e,null)}))}}var pe=n(22083);class ve extends pe.G{static fromExecutionError(e,t){return new ve({code:"EXECUTION_FAILURE",taskName:e,prevError:t})}static fromMissingDependencies(e,t){return new ve({code:"MISSING_DEPENDENCIES",taskName:e,dependencies:t,message:`${JSON.stringify(t)} are required, but not initialized.`})}constructor({code:e,taskName:t,prevError:n,dependencies:i,message:a}){super({type:"TaskError",code:e,prevError:n,message:a}),this.taskName=t,this.missingDependencies=i}getBoundaryProps(){return"EXECUTION_FAILURE"===this.code&&this.prevError instanceof pe.G?this.prevError.getBoundaryProps():super.getBoundaryProps()}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{taskName:this.taskName,prevError:this.prevError,missingDependencies:JSON.stringify(this.missingDependencies)})}toTelemetryCode(){var e;return`[${this.type}::${this.taskName}::${this.code}::${null===(e=this.missingDependencies)||void 0===e?void 0:e.join()}]`}static fromSerialized(e){if("TaskError"!==(null==e?void 0:e.type))return null;const t=new ve({code:e.code,taskName:e.taskName,prevError:e.prevError,dependencies:e.dependencies});return t.deserialize(e),t}}var he=n(471285);class fe{constructor(e,t){this.id=e,this.name=he.Yg[e],this.dependencies=t}executeSafe(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=[];for(const t of this.dependencies)null==e[t]&&n.push(t);if(n.length>0)throw ve.fromMissingDependencies(this.name,n);try{return yield this.execute(e,t)}catch(e){throw ve.fromExecutionError(this.name,e)}}))}}var ye=n(432850),be=n(293400);class Se extends fe{constructor(){super(he.Yg.CreateAsyncMediaAuth,["gtmRegistry","discover","loggerFactory","coreSettings","windowProvider","platformService","endpointsManager","localStorage","authenticationService","config","authenticationUser"]),this.lifeCycleSubscriptions=[he.sM.OnUserAuthenticated,he.sM.OnUserAuthenticated_MTMA]}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.mediaAuthService||(e.mediaAuthService=new be.b(ye.l,e.gtmRegistry,e.discover,e.loggerFactory,e.coreSettings,e.windowProvider,e.platformService,e.endpointsManager,e.localStorage,e.authenticationService,e.config,e.authenticationUser))}))}}const ke={id:"com.microsoft.teams.breakout-rooms",name:"BreakoutRoomsApp",supportedEntities:[u.p.breakoutrooms,u.p.breakoutroomsassignment,u.p.breakoutroomsassignmenttype,u.p.breakoutroomscreaterooms,u.p.breakoutroomsdeleteroom,u.p.breakoutroomsdeleterooms,u.p.breakoutroomseditroom,u.p.breakoutroomssettings],supportedRenderModes:[s.S.Main,s.S.HorizontalBar,s.S.Rail],getDefaultCommand:()=>({type:u.p.breakoutrooms,action:u.u.view}),windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20}},we=e=>{if(Ce(e))return _e(e)?{subNavEntity:Te(e),headerEntity:Ie(e),startEntity:Ee(e),mainEntity:Ne(e),endEntity:Ae(e)}:null},Ce=({entity:e,layoutMode:t})=>{const{action:n=null,type:i}=Object.assign({},e),a=[d.lO.standard,d.lO.focus].includes(t),o=[u.u.view,null].includes(n),r=[u.p.breakoutrooms].includes(i);return!!(n&&a&&r&&o)},_e=()=>!0,Te=({entity:e,layoutMode:t})=>[d.lO.standard].includes(t)?e:null,Ie=({entity:e,layoutMode:t})=>[d.lO.standard].includes(t)?e:null,Ee=()=>null,Ne=({layoutMode:e,entity:t})=>[d.lO.standard,d.lO.focus].includes(e)?t:null,Ae=()=>null,Fe=({areEmptySlotsTransparent:e})=>({[C.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!0}},[C.tF7.subNavEntity]:{[s.S.Rail]:{isBackgroundTransparent:e}},[C.tF7.headerEntity]:{[s.S.HorizontalBar]:{isBackgroundTransparent:e}}}),De=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(273621),n.e(134315),n.e(899405),n.e(907784),n.e(838608),n.e(553211),n.e(714133),n.e(92700),n.e(414176),n.e(709528),n.e(730588),n.e(998947),n.e(958163),n.e(301920),n.e(931517),n.e(431648),n.e(384037)]).then(n.bind(n,798768)),Re="breakout-rooms-northstar-app",xe=()=>ke.windowFeatures||{};function Me(){const e=()=>null;return{manifest:ke,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){n("ChunkLoadStarted",{chunkName:Re});const{BreakoutRoomsAppEntry:e}=yield(0,c.mT)(De,Re,a);return n("ChunkLoadSucceeded",{chunkName:Re}),o.createElement(l.f,{namespaces:["breakoutRooms"],loaderRenderer:null},o.createElement(e,null))}return o.createElement(e,null)})),getAppViewEntities:we,getAppViewEntitiesProps:Fe,getAppWindowFeatures:xe,onRegister:e=>{e.registerTask(new Se)}}}var Oe=n(972687),Pe=n(659617),Le=n(837804),Ue=n(10339);var je,$e=n(917163);!function(e){e.EmptyDeeplinkUrl="empty-deeplink-url-received",e.EmptyContext="empty-context-received",e.InvalidIsBroadcastMeetingType="invalid-isBroadcastMeeting-type",e.InvalidRoleType="invalid-role-type"}(je||(je={}));const Be=[{filter:e=>{const t=e.pathname.includes("/l/meetup-join"),n=new URLSearchParams(e.search).get("context");if(!n)return!1;const{IsBroadcastMeeting:i}=JSON.parse(n);return t&&i},execute:({deeplinkUrl:{pathname:e,search:t},context:{coreSettings:n,__doNotUse_globalDataClient:o}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const{allowBroadcastAttendeeMeetingJoinsInT2:r,conveneTemplateUrl:s,allowBroadcastPresenterJoinsInT2:l}=n.get(L.J.Broadcast);if(!e)return Promise.reject({message:je.EmptyDeeplinkUrl});const c=e.split(/[/?&]/),d=c.indexOf("meetup-join")+1,u=c[d],m=c[d+1],g=new URLSearchParams(t);g.set("anon","true");const p=g.get("deeplinkId"),v=g.get("context");if(!v)return Promise.reject({message:je.EmptyContext});const{Tid:h,Oid:f,IsBroadcastMeeting:y,role:b}=JSON.parse(v);if(!(0,a.isBoolean)(y))return Promise.reject({message:je.InvalidIsBroadcastMeetingType});if(!("a"===b||void 0===b))return Promise.reject({message:je.InvalidRoleType});const S="a"===b,k=`${e}?${g.toString()}`;let w;const _=((e,t)=>{if("null"!==e)return e;const n=t.get("fqdn");return n?`https://${n}`:void 0})(origin,g);_&&(w=`${_}/_#${e}?${g.toString()}`);const T={joinType:C.cku.Legacy,conversationId:u,messageId:m,rootMessageId:m,isChannel:"0"!==m,isAdhoc:!1,tenantId:h,organizerId:f,meetingCloud:g.get("fqdn")||(0,$e.uO)(origin)};return((e,t,n,i,a,o,r,s,l,c,d)=>{const{tenantId:u,organizerId:m,conversationId:g,rootMessageId:p}=a;if(t&&!o)return Promise.resolve({entityCommand:{entity:{type:C.pyR.callingdeeplink,action:C.ukP.join,id:`${g}/${p}`},command:{visibilityState:C.feW.show,stateTransition:C.suD.new,layoutMode:C.lOW.focus},entityOptions:{deeplinkUrl:n,coordinates:a,directMeetingLink:d,deepLinkId:c,roleHint:r,isBroadcastMeeting:s}},metadata:{allowAnonymous:!1,tenantId:u}});if(e){const e=`${u}__${m}__${g}__${p}`;if(i&&i.config.clientType===Pe.Bh.Maglev)return Promise.resolve({entityCommand:{entity:{id:e,type:C.pyR.broadcasts,action:C.ukP.view},command:{visibilityState:C.feW.show,stateTransition:C.suD.new,layoutMode:C.lOW.focus},entityOptions:{threadId:g,messageId:p,tenantId:u,organizerId:m}},metadata:{allowAnonymous:!0,tenantId:u}});if(l&&i&&i.config.clientType===Pe.Bh.Web){const t=(0,Ue.J)(),n=(0,Le.Dk)(e,l);return t.open(n,"_blank"),Promise.resolve(void 0)}return Promise.resolve({entityCommand:{entity:{type:C.pyR.unsupporteddeeplinkdialog,action:C.ukP.view},command:{layoutMode:C.lOW.standard,stateTransition:C.suD.extend,visibilityState:C.feW.show},entityOptions:{originalDeeplink:n}},metadata:{allowAnonymous:!1,userContextId:void 0}})}return Promise.resolve({entityCommand:{entity:{type:C.pyR.unsupporteddeeplinkdialog,action:C.ukP.view},command:{layoutMode:C.lOW.standard,stateTransition:C.suD.extend,visibilityState:C.feW.show},entityOptions:{originalDeeplink:n}},metadata:{allowAnonymous:!1,userContextId:void 0}})})(r||!1,l||!1,k,null===(i=null==o?void 0:o.ctx)||void 0===i?void 0:i.platformService,T,S,b,y,s||void 0,p,w)}))}],We=e=>{if(He(e))return Ve(e)?{subNavEntity:ze(e),headerEntity:qe(e),startEntity:Ge(e),mainEntity:Je(e),endEntity:Qe(e)}:null},He=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.broadcasts,u.p.eventsbroadcastqna].includes(i),r=n&&[u.u.create,u.u.default,u.u.list,u.u.view,u.u.info].includes(n);return!!(a&&o&&r)},Ve=()=>!0,ze=()=>null,qe=({entity:e})=>e,Ge=()=>null,Je=({entity:e})=>e,Qe=({contextEntity:e})=>{const{action:t,type:n}=e||{};return e&&(n===u.p.broadcasts&&t===u.u.info||n===u.p.eventsbroadcastqna)?e:null},Ke={id:"com.microsoft.teams.broadcast",name:"Broadcast",supportedEntities:[u.p.broadcasts,u.p.broadcastfeedback,u.p.eventsbroadcastqna],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600}};var Ye=n(296154),Xe=n.n(Ye),Ze=n(52954);const et=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(273621),n.e(899405),n.e(907784),n.e(838608),n.e(553211),n.e(714133),n.e(92700),n.e(510906),n.e(623025),n.e(579814),n.e(110350),n.e(709528),n.e(301920),n.e(507328),n.e(59242),n.e(501749),n.e(41547),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(836083),n.e(699466),n.e(279439),n.e(510510),n.e(467007),n.e(534311),n.e(713501),n.e(468557)]).then(n.bind(n,725980)),tt=({coreServices:e,host:t,isResize:n})=>{const{minHeight:i,minWidth:a}=Ke.windowFeatures||{},o=null==t?void 0:t.screen;if(n&&!o)return Ke.windowFeatures||null;if(!o)return null;let{height:r=1,width:s=1}=((e,t)=>{const{minHeight:n=0,minWidth:i=0}=Ke.windowFeatures||{};let{width:a,height:o}=Ke.windowFeatures||{};if(!t)return{height:o,width:a,minHeight:n,minWidth:i};const{orientation:{type:r}}=e,{landscapeScreenRatio:s,portraitScreenRatio:l,widthHeightRatio:c}=t.coreSettings.get(L.J.Broadcast);if(s&&l&&c)switch(r){case"landscape-primary":case"landscape-secondary":const t=s*e.availHeight;o=t>n?t:n,a=c*o;break;case"portrait-primary":case"portrait-secondary":const r=l*e.availWidth;a=r>i?r:i,o=1/c*a}return{height:o,width:a}})(o,e);const l=o.availHeight-20,c=s>=o.availWidth||r>=l;c&&(r=o.availHeight,s=o.availWidth);const{left:d,top:u}=((e,t,n,i,a)=>{if(i)return{left:0,top:0};const o="availLeft"in e?e.availLeft:0,r="availTop"in e?e.availTop:0,s=o+e.availWidth/2-t/2;let l;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":l=r+a;break;default:l=r+e.availHeight/2-n/2}return{left:s,top:l}})(o,s,r,c,20);return{additionalFeatures:{minHeight:`${i}`,minWidth:`${a}`},height:r,width:s,fullScreen:c,left:d,top:u,minHeight:i,minWidth:a}};function nt(){const e=()=>null;return{getAppViewEntities:We,getAppWindowFeatures:tt,onBeforeDeeplinkParsed:Be,manifest:Ke,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,Ye.v4)();switch(t){case s.S.HorizontalBar:case s.S.Main:case s.S.Rail:const a="broadcast-app",{BroadcastViewsRenderer:r}=yield(0,c.mT)(et,a,n);return o.createElement(Ze.vb,{joinId:i},o.createElement(l.f,{namespace:"broadcast",loaderRenderer:null},o.createElement(Oe.yx,null,o.createElement(r,{appRenderMode:t}))));default:return o.createElement(e,null)}}))}}var it=n(343324);const at=e=>{if(ot(e))return rt(e)?{subNavEntity:st(e),headerEntity:lt(e),startEntity:ct(e),mainEntity:dt(e),endEntity:ut(e)}:null},ot=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.standard,d.lO.focus].includes(e),o=n&&[u.u.create,u.u.default,u.u.view,u.u.list].includes(n),r=[u.p.calendar,u.p.schedulingform].includes(i),s=u.p.schedulingform!==i&&u.u.view===n&&d.lO.focus===e;return!(!(a&&r&&o)||s)},rt=()=>!0,st=()=>null,lt=({entity:e,coreSettings:t})=>{const n=null==t?void 0:t.get(L.J.Calendar).enableCalendarSchedulingFormMultiSlot,i=null==t?void 0:t.get(L.J.Calendar).enableFluentCalendarSurface,a=!!n&&e.type===u.p.schedulingform,o=!!i&&e.type===u.p.calendar;return a||o?e:null},ct=()=>null,dt=({contextEntity:e,entity:t})=>(null==e?void 0:e.type)&&[u.p.extensions,u.p.attendancereport,u.p.meetinganalytics,u.p.meetingrecap,u.p.transcriptcontent].includes(e.type)?e:t,ut=({contextEntity:e})=>e&&e.action&&e.type===u.p.meetingcollaboration?e:null,mt="calendar",gt="viewCalendarApp",pt=()=>({actor:mt,action:gt}),vt={id:"com.microsoft.teams.calendar",name:"CalendarApp",getLocalizedName:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("calendar"),e.stringTranslate("calendar","calendar_app_name")})),actors:[mt],supportedEntities:[u.p.calendar,u.p.schedulingform,u.p.connectedcalendardialog,u.p.connectedcalendarsurfacedialog,u.p.channelcalendar],supportedRenderModes:[s.S.Main,s.S.HorizontalBar,s.S.Modal],getDefaultCommand:()=>({type:u.p.calendar,action:u.u.default}),windowFeatures:{minWidth:565,width:1241,minHeight:720,height:720}};var ht=n(541704),ft=n(515079);const yt=({action:e,appRenderMode:t,type:n,coreSettings:i})=>{const a=new ht.H,{calendarAppPhaseTimeouts:o}=i.get(L.J.Calendar,["calendarAppPhaseTimeouts"]),r=[],l=[];return n===u.p.calendar?function(e,t){switch(e){case s.S.Main:t.push(ft.GZ.CALENDAR_VIEW_RENDERED);break;case s.S.HorizontalBar:t.push(ft.GZ.CALENDAR_HEADER_RENDERED)}}(t,r):n===u.p.schedulingform&&function(e,t,n,i){switch(t){case s.S.Main:n.push(ft.GZ.CALENDAR_SF_VIEW_RENDERED),e===u.u.view&&i.push(ft.GZ.CALENDAR_SF_TRACKING_VIEW_RENDERED);break;case s.S.HorizontalBar:n.push(ft.GZ.CALENDAR_SF_HEADER_RENDERED)}}(e,t,r,l),r.length>0&&a.registerAppPhase({phase:ft.nh.CRITICAL,signals:r,timeout:(null==o?void 0:o.critical)||1e4}),l.length>0&&a.registerAppPhase({phase:ft.nh.POST_CRITICAL,signals:l,timeout:(null==o?void 0:o.postCritical)||1e4}),a.appPhases},bt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCalendarTryStartMeetingBotPublisherMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tryStartMeetingBotPublisher"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};function St(e){const{client:t,coreSettings:n,loggerFactory:i}=e,a=t,o=i.newLogger("[MeetingBot-StartJob]","apps-calendar");return{id:"start-meeting-bot",runOncePerId:!0,job:()=>{n.get(L.J.MeetingBot).enableMeetingBot?a.mutate({mutation:bt,fetchPolicy:"no-cache"}):o.log("meetingbot is disabled")}}}var kt=n(561776);const wt=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("CalendarApp onCommandReceived","apps-calendar");if(e.command.actor===mt)switch(n){case gt:return{entity:{type:u.p.calendar,action:u.u.default},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.Unknown}}};default:i.error(`Command action '${n}' is not supported at CalendarApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by CalendarApp.`)}));var Ct=n(916852);const _t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCalendarSyncConnectedCalendarSettingsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"syncConnectedCalendarSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"accountAddress"}},{kind:"Field",name:{kind:"Name",value:"accountId"}},{kind:"Field",name:{kind:"Name",value:"isSyncAllowed"}}]}}]}}]},Tt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCalendarGetExternalAccountsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"connectedAccountRequestResource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConnectedAccountRequestSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getExternalAccounts"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"connectedAccountRequestResource"},value:{kind:"Variable",name:{kind:"Name",value:"connectedAccountRequestResource"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"oAuthProviderDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"oAuthProviderType"}}]}},{kind:"Field",name:{kind:"Name",value:"userAccount"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"alternateId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"emailAddress"}}]}},{kind:"Field",name:{kind:"Name",value:"refreshTokenExpirationUnixTimestamp"}}]}}]}}]},It={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCalendarRefreshExternalAccountMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accountId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"refreshExternalAccount"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accountId"},value:{kind:"Variable",name:{kind:"Name",value:"accountId"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}]}]}}]},Et="lastRefreshAttemptTimestamp",Nt="pauseRefresh",At=e=>e/86400,Ft=()=>Math.round(Date.now()/1e3),Dt=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){yield n.mutate({mutation:It,variables:{accountId:e,callerInfo:t}})})),Rt=(e,t)=>{if(!e||!t)return!0;const n=Number(e);if(isNaN(n))return!0;const i=Ft();return At(n-i)<=t},xt=e=>`tmp.${e}.refreshExternalAccount`,Mt=(e,t,n,i)=>{const a={[Et]:t,[Nt]:!!i};return null==n?void 0:n.setSafe(xt(e),JSON.stringify(a),Ct.f.UserAndExperience)},Ot=(e,t,n,i)=>{const a=((e,t)=>{const n={[Et]:null,[Nt]:!1};if(!t)return n;const i=t.get(xt(e));if(!i)return n;try{const e=JSON.parse(i);n.lastRefreshAttemptTimestamp=e.lastRefreshAttemptTimestamp||null,n.pauseRefresh=e.pauseRefresh||!1}catch(e){return n}return n})(e,n);if(a.pauseRefresh)return t.mark(it.ck.NoSrtRefreshNeededDueToPause),!1;if(!i)return!0;const o=a.lastRefreshAttemptTimestamp,r=Number(o);if(isNaN(r))return!0;const s=Ft();return!(At(s-r)<=i)||(t.mark(it.ck.NoSrtRefreshNeededBasedOnLastRefreshTimestamp),!1)},Pt=(e,t,n,i)=>{var a;const o=`Failed createConnectedAccountRefreshSrtJob with error code: ${i}`;null===(a=e.errorToTelemetry)||void 0===a||a.call(e,o,"connected_account_refresh_srt_job"),n&&t.fail({errors:o})},Lt=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;if(!e)return null;const i=e.graphQLErrors,a=i&&(null===(n=null===(t=i[0])||void 0===t?void 0:t.originalError)||void 0===n?void 0:n.serverResponse);if(!a)return null;try{const e=yield a.body.clone().json();return{errorCode:e.errorCode,message:e.message}}catch(e){return{message:"Failed to extract server response in extractServerError"}}})),Ut=e=>{var t,n,i;if(!e)return!1;const a=e.graphQLErrors,o=null===(t=null==a?void 0:a[0])||void 0===t?void 0:t.originalError;return(null===(i=null===(n=null==o?void 0:o.reason)||void 0===n?void 0:n.innerError)||void 0===i?void 0:i.context)===he.w5.Authentication},jt="createConnectedAccountRefreshSrtJob";function $t(e){const{client:t,coreSettings:n,localStorage:a,loggerFactory:o,scenarioFactory:r}=e,s=o.newLogger("connected-account-refresh-srt-job","apps-calendar"),l=t,{numberOfDaysToWaitBeforeSrtExpires:c,numberOfDaysToWaitSinceLastSrtRefresh:d}=n.get(L.J.Calendar);return{id:"connected-account-refresh-srt-job",job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e,n;const o=r.newScenario(it.RG.ConnectedAccountRefreshSrtJob);let u=!1;const m=[];try{const r=yield((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n;let i;const{data:a}=yield t.query({query:_t,fetchPolicy:"network-only",variables:{callerInfo:e}});return(null===(n=null==a?void 0:a.syncConnectedCalendarSettings)||void 0===n?void 0:n.length)&&(i=a.syncConnectedCalendarSettings.filter((e=>!1===e.isSyncAllowed))),i})))(jt,t);if(o.mark(it.ck.GetConnectedCalendarSettingsComplete),!r||0===r.length)return o.mark(it.ck.NoUnsyncedConnectedCalendarSettingFound),void o.stop();if(!((e,t,n,i)=>{let a=!1;for(const o of e)Ot(o.accountId,t,n,i)&&(a=!0);return a})(r,o,a,d))return void o.stop();const g=yield((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{data:n}=yield t.query({query:Tt,fetchPolicy:"network-only",variables:{callerInfo:e,connectedAccountRequestResource:C.dcg.TflCloudCache}});return null==n?void 0:n.getExternalAccounts})))(jt,t);o.mark(it.ck.GetExternalAccountsComplete),g&&0!==g.length||o.mark(it.ck.NoExternalAccountsFound);for(let t=0;g&&t<g.length;t++){const i=g[t];if(!i)continue;const d=null===(e=i.userAccount)||void 0===e?void 0:e.id,p=r.find((e=>e.accountId===d));try{if(!p){o.mark(it.ck.NoMatchingExternalAccountToRefresh);continue}o.mark(it.ck.ExternalAccountFound);const e=i.refreshTokenExpirationUnixTimestamp;Rt(e,c)?(yield Dt(d,jt,l),o.mark(it.ck.RefreshExternalAccountComplete)):o.mark(it.ck.NoSrtRefreshNeededBasedOnSrtExpirationTimestamp),Mt(d,Ft(),a)}catch(e){let t;t=Ut(e)?he.jK.Unauthorized:null===(n=yield Lt(e))||void 0===n?void 0:n.errorCode,Mt(d,Ft(),a,t===he.jK.Unauthorized),Pt(s,o,!1,t),u=!0,m.push(t)}}o.stop()}catch(e){const{errorCode:t}=(yield Lt(e))||{};Pt(s,o,!0,t)}u&&Pt(s,o,!0,m.join(", "))}))}}var Bt=n(494326),Wt=n(786018);const Ht="/scheduling-form/";var Vt,zt,qt,Gt,Jt,Qt,Kt;!function(e){e[e.Channel=0]="Channel",e[e.PrivateChat=1]="PrivateChat"}(Vt||(Vt={})),function(e){e[e.UserEventUsingEventId=0]="UserEventUsingEventId",e[e.TeamEventUsingEventId=1]="TeamEventUsingEventId",e[e.UserEventUsingICalUId=2]="UserEventUsingICalUId",e[e.TeamEventUsingICalUId=3]="TeamEventUsingICalUId",e[e.UserSeriesEventUsingOccurenceEventId=4]="UserSeriesEventUsingOccurenceEventId"}(zt||(zt={})),function(e){e.newMeeting="/l/meeting/new",e.viewMeeting="/l/meeting/details",e.meetingDetails="/l/calendar/scheduling-form"}(qt||(qt={})),function(e){e.NoEventId="calendar_on_before_deep_link_parsed_no_event_id_error",e.FeatureNotEnabled="calendar_on_before_deep_link_parsed_feature_not_enabled_error",e.InvalidContext="calendar_on_before_deep_link_parsed_invalid_context_error"}(Gt||(Gt={})),function(e){e.NoEventId="Parsed calendar deep link does not contain the event id",e.FeatureNotEnabled="Feature for parsing T1 calendar deep links in T2.1 is not enabled",e.InvalidContext="Parsed calendar deep link does not contain valid context query param"}(Jt||(Jt={})),function(e){e.StartTime="startTime",e.EndTime="endTime",e.Subject="subject",e.Content="content",e.Attendees="attendees"}(Qt||(Qt={})),function(e){e.EventId="eventId",e.Context="context"}(Kt||(Kt={}));const Yt=({deeplinkUrl:e,parsedDeeplinkHash:t,preferredCommandInput:n,context:{coreSettings:i,loggerFactory:a}})=>{var o,r,s,l;const c=a.newLogger("CalendarApp onBeforeDeeplinkParsed","apps-calendar"),{enableParseT1CalendarDeeplinks:m}=i.get(L.J.Calendar);if(!m)throw null===(o=c.errorToTelemetry)||void 0===o||o.call(c,Jt.FeatureNotEnabled,Gt.FeatureNotEnabled),Error(Jt.FeatureNotEnabled);let g,p,v,h,f;if(null==t?void 0:t.search){const{search:e}=t;g=e.eventId,p=e.conversationId,v=parseInt(e.providerType,10)||zt.UserEventUsingEventId,h=parseInt(e.opener,10)||Vt.PrivateChat,f=Xt(e.context,c)}else{const{search:t}=e,n=new URLSearchParams(t);g=n.get(Kt.EventId)||void 0,v=zt.UserEventUsingEventId,h=Vt.PrivateChat;const i=n.get(Kt.Context);f=Xt(i,c)}const y=(null==n?void 0:n.correlation.source)===kt.D.ActivityFeed?Wt.kH.NOTIFICATION_POPOVER:Wt.kH.DEEP_LINK;if(g)return Promise.resolve({entityCommand:{entity:{type:u.p.schedulingform,action:u.u.view,id:g},command:{stateTransition:null!==(r=null==n?void 0:n.stateTransition)&&void 0!==r?r:d.su.flush,visibilityState:null!==(s=null==n?void 0:n.visibilityState)&&void 0!==s?s:d.fe.show},entityOptions:Object.assign({navCtx:y,eventId:g,opener:h,conversationId:p,providerType:v},f)},metadata:{allowAnonymous:!1}});throw null===(l=c.errorToTelemetry)||void 0===l||l.call(c,Jt.NoEventId,Gt.NoEventId),Error(Jt.NoEventId)},Xt=(e,t)=>e&&(0,Bt.D)(e,{},(()=>{var e;throw null===(e=t.errorToTelemetry)||void 0===e||e.call(t,Jt.InvalidContext,Gt.InvalidContext),Error(Jt.InvalidContext)})),Zt=({deeplinkUrl:e,parsedDeeplinkHash:t,context:{coreSettings:n,loggerFactory:i}})=>{var a;const o=i.newLogger("CalendarApp onBeforeDeeplinkParsed","apps-calendar"),{enableParseT1CalendarDeeplinks:r}=n.get(L.J.Calendar);if(!r)throw null===(a=o.errorToTelemetry)||void 0===a||a.call(o,Jt.FeatureNotEnabled,Gt.FeatureNotEnabled),Error(Jt.FeatureNotEnabled);let s,l,c,m,g;if(null==t?void 0:t.search){const{search:e}=t;s=e.startTime&&new Date(e.startTime)||void 0,l=e.endTime&&new Date(e.endTime)||void 0,c=e.subject,m=e.content,g=e.attendees}else{const{search:t}=e,n=new URLSearchParams(t),i=n.get(Qt.StartTime),a=n.get(Qt.EndTime);s=i&&new Date(i)||void 0,l=a&&new Date(a)||void 0,c=n.get(Qt.Subject)||void 0,m=n.get(Qt.Content)||void 0,g=n.get(Qt.Attendees)||void 0}return Promise.resolve({entityCommand:{entity:{type:u.p.schedulingform,action:u.u.create,id:(0,Ye.v4)()},command:{stateTransition:d.su.flush,visibilityState:d.fe.show},entityOptions:{navCtx:Wt.kH.DEEP_LINK,startTime:s,endTime:l,subject:c,content:m,attendees:g,opener:1}},metadata:{allowAnonymous:!1}})},en={filter:(e,t)=>{var n;return!!e.hash&&(null==t?void 0:t.pathname)===Ht&&!(null===(n=null==t?void 0:t.search)||void 0===n?void 0:n.eventId)},execute:Zt},tn={filter:(e,t)=>{var n;return!!e.hash&&(null==t?void 0:t.pathname)===Ht&&!!(null===(n=null==t?void 0:t.search)||void 0===n?void 0:n.eventId)},execute:Yt},nn=[{filter:qt.newMeeting,execute:Zt},{filter:qt.viewMeeting,execute:Yt},en,tn,{filter:qt.meetingDetails,execute:({deeplinkUrl:e,preferredCommandInput:t,context:{coreSettings:n,loggerFactory:i}})=>{var a,o,r,s;const l=i.newLogger("CalendarApp onBeforeDeeplinkParsed","apps-calendar"),{enableParseT1CalendarDeeplinks:c}=n.get(L.J.Calendar);if(!c)throw null===(a=l.errorToTelemetry)||void 0===a||a.call(l,Jt.FeatureNotEnabled,Gt.FeatureNotEnabled),Error(Jt.FeatureNotEnabled);const{pathname:m,searchParams:g}=e,p=m.split("/")[4],v=(0,Bt.D)(g.get("context"),{},(()=>{var e;throw null===(e=l.errorToTelemetry)||void 0===e||e.call(l,Jt.InvalidContext,Gt.InvalidContext),Error(Jt.InvalidContext)}));if(!p)throw null===(o=l.errorToTelemetry)||void 0===o||o.call(l,Jt.NoEventId,Gt.NoEventId),Error(Jt.NoEventId);return Promise.resolve({entityCommand:{entity:{type:u.p.schedulingform,action:u.u.view,id:p},command:{stateTransition:null!==(r=null==t?void 0:t.stateTransition)&&void 0!==r?r:d.su.flush,visibilityState:null!==(s=null==t?void 0:t.visibilityState)&&void 0!==s?s:d.fe.show},entityOptions:Object.assign({navCtx:Wt.kH.DEEP_LINK,opener:Vt.PrivateChat,eventId:p},v)},metadata:{allowAnonymous:!1}})}}],an=()=>Promise.all([n.e(893479),n.e(273621),n.e(657777),n.e(68101),n.e(524661),n.e(623025),n.e(579814),n.e(110350),n.e(264630),n.e(602460),n.e(902140),n.e(262855),n.e(757052),n.e(459737),n.e(451115),n.e(668778)]).then(n.bind(n,832895)),on=()=>vt.windowFeatures||{};function rn(){return{getAppViewEntities:at,getAppWindowFeatures:on,getCommandScenarioName:sn,getPlatformAppIdForEntity:e=>e.type===u.p.calendar||e.type===u.p.schedulingform?"ef56c0de-36fc-4ef8-b417-3d82ba9d073c":void 0,manifest:vt,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="calendar-app";t("ChunkLoadStarted",{chunkName:i});const{CalendarViewsRenderer:a}=yield(0,c.mT)(an,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(l.f,{namespaces:["calendar","compose","extensibility","files"],loaderRenderer:null},o.createElement(a,{appRenderMode:e,onRenderEvent:t,scenarioFactory:n}))})),onBeforeDeeplinkParsed:nn,onCommandReceived:wt,onPreWarm:e=>{const{context:t}=e,n=t.coreSettings,{enableConnectedAccountSrtRefresh:i}=n.get(L.J.Calendar),a=[St(t)];return i&&a.push($t(t)),a},getAppPhases:yt}}const sn=e=>{const{command:t,entity:n}=e;switch(n.type){case u.p.schedulingform:if(t.visibilityState===d.fe.hide)return;return n.action===u.u.create?it.RG.CalSchedulingFormLoadForCreateMode:it.RG.CalSchedulingFormLoad;case u.p.calendar:return it.RG.CalendarSurfaceLoad;case u.p.channelcalendar:return it.RG.ChannelCalendarLoad;case u.p.connectedcalendardialog:return it.RG.ConnectedCalendarDialogLoad;default:return}};var ln=n(741898);const cn="entitymoreinfo",dn="requestPersonMoreInfo",un="requestTopicMoreInfo",mn=e=>({actor:cn,action:dn,data:e}),gn=e=>({actor:cn,action:un,data:e}),pn={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case ln.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:mn(i)})}return Promise.resolve(void 0)}};var vn=n(305255);const hn=e=>{if(fn(e))return yn(e)?{subNavEntity:bn(e),headerEntity:Sn(e),startEntity:kn(e),mainEntity:wn(e),endEntity:Cn(e)}:null},fn=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.callablechannels].includes(i),r=n&&[u.u.create,u.u.default,u.u.list,u.u.view].includes(n);return!!(a&&o&&r)},yn=()=>!0,bn=({entity:e})=>e,Sn=({entity:e})=>e,kn=()=>null,wn=({entity:e})=>e,Cn=()=>null,_n={id:"com.microsoft.teams.callable-channel",name:"CallableChannelApp",supportedEntities:[u.p.callablechannels],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Tn=()=>n.e(724526).then(n.bind(n,344343)),In=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(259196),n.e(86052),n.e(302711),n.e(636762),n.e(499057),n.e(603286),n.e(836870),n.e(213104),n.e(384420),n.e(49750),n.e(181896),n.e(95235),n.e(803466),n.e(623025),n.e(579814),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(61627),n.e(4528),n.e(191280),n.e(86048),n.e(29311),n.e(481321),n.e(384848),n.e(674818),n.e(397914),n.e(860125),n.e(628212),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(398949),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(645508),n.e(317689),n.e(842905),n.e(196673),n.e(648558),n.e(764175),n.e(968634),n.e(530658),n.e(926721),n.e(905697),n.e(707902),n.e(858141),n.e(568740)]).then(n.bind(n,547886)),En=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(259196),n.e(86052),n.e(302711),n.e(636762),n.e(499057),n.e(603286),n.e(836870),n.e(213104),n.e(384420),n.e(49750),n.e(181896),n.e(95235),n.e(803466),n.e(623025),n.e(579814),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(61627),n.e(4528),n.e(191280),n.e(86048),n.e(29311),n.e(481321),n.e(384848),n.e(674818),n.e(397914),n.e(860125),n.e(628212),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(398949),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(645508),n.e(317689),n.e(842905),n.e(196673),n.e(648558),n.e(764175),n.e(968634),n.e(530658),n.e(926721),n.e(905697),n.e(707902),n.e(858141),n.e(568740)]).then(n.bind(n,697633));function Nn(){const e=()=>null;return{eventHandlers:pn,getAppViewEntities:hn,manifest:_n,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a,coreSettings:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="callable-channels-app";n("ChunkLoadStarted",{chunkName:e});const{enableEntityMoreInfo:t}=r.get(L.J.Core),i=({children:e})=>o.createElement(o.Fragment,null,e),{LPC:s}=t?{LPC:i}:yield(0,c.mT)(En,e,a),d=t?i:vn.p3;n("ChunkLoadSucceeded",{chunkName:e});const[{CallableChannelEntryContainer:u},{CallsTabContextProvider:m}]=yield Promise.all([(0,c.mT)(Tn,e,a),(0,c.mT)(In,e,a)]);return o.createElement(l.f,{namespaces:["calling","messaging"],loaderRenderer:null},o.createElement(s,null,o.createElement(d,null,o.createElement(m,null,o.createElement(u,null)))))}return o.createElement(e,null)}))}}var An=n(786884),Fn=n(980402);const Dn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"InitCallingService"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entryPoint"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingServiceEntrypointType"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"initCallingService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entryPoint"},value:{kind:"Variable",name:{kind:"Name",value:"entryPoint"}}}]}]}}]},Rn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingDisposeCallingServiceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposeReason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposeReason"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposeSource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposeSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"disposeCallingService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"disposeReason"},value:{kind:"Variable",name:{kind:"Name",value:"disposeReason"}}},{kind:"Argument",name:{kind:"Name",value:"disposeSource"},value:{kind:"Variable",name:{kind:"Name",value:"disposeSource"}}}]}]}}]};var xn;!function(e){e.DisposeMutationGenericJobError="DisposeMutationGenericJobError"}(xn||(xn={}));const Mn=(e,t,n,a,o)=>({id:"standup-calling",runOncePerId:!0,job:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const r=a.newScenario(it.RG.CallingAppInit,{clientId:(0,Ye.v4)()}),s=a.newScenario(it.RG.StandupCallingAppExecute);s.appendEventData({context:n}),s.mark(it.ck.ExecuteJob);const l=t.newLogger("getStandupCallingJob","apps-calling");l.log("[getStandupCallingJob] Initializing calling service");const{enableCallingSignOut:c,callingServiceDisposeTimeoutInMs:d}=o.get(L.J.Calling);try{const t=(e=>{switch(e){case it.ck.OnAppPreWarm:return C.cCY.onAppPreWarm;case it.ck.OnAppPreInit:return C.cCY.onAppPreInit;default:throw new Error(`StandupCallingJob - ${it.ck} is not on_app_pre_warm or on_app_pre_init`)}})(n);r.mark(it.ck.InitCallingServiceMutation),s.pause({reason:he.jK.WaitingForResponse}),yield e.mutate({mutation:Dn,variables:{entryPoint:t},context:{scenarioClientId:r.clientId,scenarioName:r.name}}),s.resume()}catch(e){throw l.error(`[getStandupCallingJob] Error initializing calling service [error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`),s.fail({errors:e.name,message:`${it.ck.ExecuteJob} failed with ${e.message}`}),(0,An.Tr)(n,he.jK.StandupCallingJobError,e.name,void 0,e.message)}if(s.mark(it.ck.JobCompleted),l.log("[getStandupCallingJob] Calling service initialized"),s.stop(),c)return()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return On(e,l,a,n,d||45e3)}))}))}),On=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const r=C.pMG.SignOut,s=C.QuG.StandupCallingAppJob,l=n.newScenario(it.RG.CallingServiceDispose);l.appendEventData({context:r,dataSource:s,origin:a}),null===(i=n.hoistScenarioToCore)||void 0===i||i.call(n,l),t.log(`[getStandupCallingJob] Calling service disposal initiated. [step: ${a}, reason:${r}, source:${s}, timeout:${o}]`);try{const t=e.mutate({mutation:Rn,variables:{disposeReason:r,disposeSource:s}});yield(0,Fn.E)(t,o,`Dispose mutation timed out. [timeoutAmount:${o}]`)}catch(e){throw t.error(`[getStandupCallingJob] Error disposing calling service [error.name=${null==e?void 0:e.name}, error.code=${null==e?void 0:e.code}, error.message=${null==e?void 0:e.message}, timeout:${o}]`),l.fail({reason:(null==e?void 0:e.code)||xn.DisposeMutationGenericJobError,message:(null==e?void 0:e.message)||e}),(0,An.Tr)(it.RG.CallingServiceDispose,he.jK.StandupCallingJobError,r,void 0,null==e?void 0:e.message)}l.stop(),t.log("[getStandupCallingJob] Calling service disposed")})),Pn={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingContentEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingContentEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibility"}}]}},{kind:"Field",name:{kind:"Name",value:"content"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingBannerContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_mainAppContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingWindowingContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingDialogContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingNotificationContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToChatContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToChatListContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToSettingsPaneContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToCallListContent"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingBannerContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingBannerContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"intentLevel"}},{kind:"Field",name:{kind:"Name",value:"dismissable"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"bannerScenario"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"dismissOnAction"}},{kind:"Field",name:{kind:"Name",value:"joinButtonText"}},{kind:"Field",name:{kind:"Name",value:"bannerActions"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_mainAppContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MainAppContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingWindowingContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingWindowingContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"coordsType"}},{kind:"Field",name:{kind:"Name",value:"windowingMode"}},{kind:"Field",name:{kind:"Name",value:"linkedContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingDialogContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingDialogContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"dialogActions"}},{kind:"Field",name:{kind:"Name",value:"dialogStrings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"text"}}]}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingNotificationContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingNotificationContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"crossClientScenarioName"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"subtitle"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"toastType"}},{kind:"Field",name:{kind:"Name",value:"bypassOsLevelDoNotDisturb"}},{kind:"Field",name:{kind:"Name",value:"image"}},{kind:"Field",name:{kind:"Name",value:"ringtoneAssetUrl"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"userid"}},{kind:"Field",name:{kind:"Name",value:"primaryAction"}},{kind:"Field",name:{kind:"Name",value:"actions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"icon"}},{kind:"Field",name:{kind:"Name",value:"actionType"}}]}},{kind:"Field",name:{kind:"Name",value:"header"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"defaultImageDataUrl"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"subtitle"}},{kind:"Field",name:{kind:"Name",value:"mri"}}]}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToChatContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToChatContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"messageId"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToChatListContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToChatListContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToSettingsPaneContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToSettingsPaneContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"tabItemId"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToCallListContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToCallListContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}.definitions]},Ln={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppSetupEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppSetupEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"result"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppEventsSetupSuccess"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppEventsSetupSuccess"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventsSetupSuccess"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"_"}}]}}]}.definitions]},Un={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsCallingCallingAppEventsSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingAppEvents"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppEvent"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"event"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingContentEvent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppSetupEvent"}}]}},{kind:"Field",name:{kind:"Name",value:"context"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"source"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}}]}}]}},...Pn.definitions,...Ln.definitions]}.definitions]};var jn,$n,Bn,Wn,Hn,Vn,zn,qn;function Gn(e,t,n){const{id:i,title:a,callId:o,crossClientScenarioName:r,subtitle:s,image:l,time:c,actions:u,type:m,primaryAction:g,header:p,toastType:v,ringtoneAssetUrl:h}=e,f=parseInt(c,10),y=p?{alt:p.subtitle,src:p.defaultImageDataUrl}:void 0;return{command:{correlation:{source:kt.D.Notifications,id:n},stateTransition:d.su.new,visibilityState:d.fe.show},entityOptions:{buttons:null==u?void 0:u.map((e=>function(e,t,n,i,a){const{actionType:o,label:r,icon:s}=t;return Object.assign(Object.assign({},s&&{image:{alt:r,src:s}}),{targetEntity:{action:Wn.mutate,dataOptions:{actionType:o,toastId:e,toastType:a},id:e,type:$n.calls},text:r,preferImageOnly:n.get(L.J.Calling).forceTextOnT2Notifications?void 0:!!s,style:Kn(o,i)})}(i,e,t,m,v))),callId:o,crossClientScenarioName:r,bypassOsLevelDoNotDisturb:Jn(m,t),isIncomingCall:Qn(m),mainImage:{alt:a,src:l},ringtone:h,targetEntity:{action:Wn.mutate,dataOptions:{actionType:g,toastId:i,toastType:v},id:i,type:$n.calls},text:s,time:new Date(f),title:a,headerImage:y,headerTitle:null==p?void 0:p.title,headerSubtitle:null==p?void 0:p.subtitle}}}!function(e){e.toastFromWeb="toastFromWeb",e.toastFromHost="toastFromHost"}(jn||(jn={})),function(e){e.calls="calls",e.chats="chats",e.toasts="toasts",e.signout="signout",e.extensions="extensions",e.reminders="reminders",e.channels="channels",e.activity="activity",e.campaignnotifications="campaignnotifications",e.communities="communities",e.callingdeeplink="callingdeeplink"}($n||($n={})),function(e){e.hide="hide",e.show="show"}(Bn||(Bn={})),function(e){e.mutate="mutate",e.view="view",e.list="list",e.join="join"}(Wn||(Wn={})),function(e){e.success="success",e.critical="critical"}(Hn||(Hn={})),function(e){e.start="start",e.quit="quit",e.restart="restart"}(Vn||(Vn={})),function(e){e.airgap08="airgap08",e.prod="prod",e.life="life",e.dod="dod",e.gcch="gcch",e.gallatin="gallatin",e.airgap09="airgap09"}(zn||(zn={})),function(e){e.inProc="inProc",e.outOfProc="outOfProc"}(qn||(qn={}));const Jn=(e,t)=>{let n;switch(e){case C.k$E.MeetingWentLive:n=!!t.get(L.J.Calling).enableUrgentMeetingStartedNotificationV2;break;default:n=!1}return n},Qn=e=>e!==C.k$E.MeetingWentLive&&e!==C.k$E.CallAnsweredElsewhere;function Kn(e,t){if(t!==C.k$E.Meeting)switch(e){case"ReplyIncomingCall":return;case"RejectIncomingCall":return Hn.critical;default:return Hn.success}}function Yn(e,t,n,i){const{id:a,coordsType:o,windowingMode:r,linkedContent:s}=n,{action:{visibility:l}}=t,{source:c,timeStamp:m}=i,g=function(e){return e===C.KRy.Show?d.fe.show:d.fe.hide}(l),p=function(e){return e===C.lCV.SingleWindow?d.su.flush:d.su.new}(r),v=s&&function(e){if(!e||!e.id)return;return{id:e.id,type:u.p.chats}}(s);return{entity:{id:a,type:function(e){switch(e){case C.cAL.RigelGallery:return u.p.callsgallery;case C.cAL.RigelContent:return u.p.callscontent;case C.cAL.RigelGalleryAndContent:return u.p.callsgalleryandcontent;default:return u.p.calls}}(o),action:u.u.view,linkedEntity:v},command:{visibilityState:g,stateTransition:p,correlation:{id:e,startTimestamp:m||void 0,source:`${kt.D.CallingAppEvent}::${c.name}::${c.description}`}}}}function Xn(e,t){switch(e){case C.KRy.Show:return d.fe.show;case C.KRy.Hide:return d.fe.hide;default:return t.warn(`${e} cannot be converted to visibility state, defaulting to hide`),d.fe.hide}}var Zn,ei=n(575603);!function(e){e.Calling="Calling",e.Notifications="Notifications",e.Devices="Devices",e.PremiumBenefits="PremiumBenefits",e.Privacy="Privacy"}(Zn||(Zn={}));const ti={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},ni={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingPriorityContactsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldFetchFromNetwork"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"priorityContacts"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shouldFetchFromNetwork"},value:{kind:"Variable",name:{kind:"Name",value:"shouldFetchFromNetwork"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"jobTitle"}}]}}]}}]},ii={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"toastImageAsDataUri"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};const ai=new class{constructor(){this.deeplinkEntitySet=!1,this.callingAppEventsSubscribed=!1,this.unlockDeeplinkEntity=()=>{const e=this.deeplinkEntityId;return this.deeplinkEntityId=void 0,this.resolvePromise&&this.resolvePromise(),e},this.lockDeeplinkEntity=e=>{this.deeplinkEntitySet||(this.initializingPromise=new Promise((e=>{this.resolvePromise=()=>{e()}})),this.deeplinkEntityId=e,this.deeplinkEntitySet=!0)},this.getDeeplinkEntityLocked=()=>this.deeplinkEntitySet,this.getDeeplinkReady=()=>this.initializingPromise,this.getCallingAppEventsSubscribed=()=>this.callingAppEventsSubscribed,this.setCallingAppEventsSubscribed=e=>{this.callingAppEventsSubscribed=e}}},oi={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"resolveCallingAppEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingAppEventResolution"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventResolution"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolveCallingAppEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingAppEventResolution"},value:{kind:"Variable",name:{kind:"Name",value:"callingAppEventResolution"}}}]}]}}]};function ri(e,t,n){const{eventId:i,resolution:a,context:o}=e,{source:r}=o;return n.log(`[resolveCallingAppEvent] Resolving calling app event [eventId=${i}, source.name=${r.name}, source.description=${r.description}]`),t.mutate({mutation:oi,variables:{callingAppEventResolution:{eventId:i,resolution:a,context:o}},fetchPolicy:"no-cache"})}var si,li=n(806366),ci=n(309097);!function(e){e[e.SingleAccount=0]="SingleAccount",e[e.MultipleAccounts=1]="MultipleAccounts"}(si||(si={}));var di=n(7182);function ui(e,t,n){if(e&&t)return t.getAccountMode()===si.MultipleAccounts?(n.log(li.f.ReturningUserKeyForToastCollection),(0,di.b4)(e)):void n.error(li.f.CollectionIdUndefined);n.error(li.f.NoAutheticatedUserOrTrackingService)}function mi(e,t,n){const{id:i,name:a,dialogActions:o,dialogStrings:r}=t,{action:{visibility:s}}=e,{timeStamp:l}=n;let c;if(s===C.KRy.Show)c=d.fe.show;else{if(s!==C.KRy.Hide)return;c=d.fe.hide}const m={visibilityState:c,stateTransition:d.su.extend,correlation:{id:i,startTimestamp:l||void 0,source:a}},g=function(e){switch(e){case C.WBC.WindowingError:return u.p.windowingerrordialog;case C.WBC.CallingRestartRecomendedError:return u.p.restartrecomendeddialog;case C.WBC.Alert:return u.p.callingalertdialog;case C.WBC.CallingUnparkCall:return u.p.unparkcalldialog;case C.WBC.CallingConfirm:return u.p.callingconfirmdialog;case C.WBC.OptionsSettings:return u.p.optionssettingsdialog;case C.WBC.PrejoinOverlay:return u.p.prejoinoverlaydialog;case C.WBC.UserMedia:return u.p.usermediadialog;default:return}}(a);if(!g)return;const p={dialogActions:o,dialogStrings:r};return{entity:{id:i,type:g,action:u.u.create},entityOptions:p,command:m}}const gi={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingTriggerDialogActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dialogId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DialogAction"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerDialogAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"dialogId"},value:{kind:"Variable",name:{kind:"Name",value:"dialogId"}}},{kind:"Argument",name:{kind:"Name",value:"actionName"},value:{kind:"Variable",name:{kind:"Name",value:"actionName"}}}]}]}}]};function pi(e,t,n){const{id:i,bannerScenario:a,bannerActions:o}=t,{action:{visibility:r}}=e,{timeStamp:s}=n,l=function(e){let t;if(e===C.KRy.Show)t=d.fe.show;else{if(e!==C.KRy.Hide)return;t=d.fe.hide}return t}(r);if(void 0===l)return;const c={visibilityState:l,stateTransition:d.su.extend,correlation:{id:i,startTimestamp:s||void 0,source:a}},m=function(e){switch(e){case C.XDy.EndpointTransfer:return u.p.callingbannernotification;default:return}}(a),g=function(e){let t;e===d.fe.show&&(t=u.u.join);e===d.fe.hide&&(t=u.u.delete);return t}(l);return m&&g?{bannerPrimaryActionEntity:{id:i,type:m,action:g},entityOptions:{bannerActions:o},command:c,bannerDismissCommandEntity:{id:i,type:u.p.callingbannernotification,action:u.u.delete}}:void 0}function vi(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const{eventId:i,resolution:a,context:o}=e;yield ri({eventId:i,resolution:a,context:o},t,n)}catch(e){n.error(a,`error: [errorName=${e.name}, errorMessage=${e.message}]]`)}}))}function hi(e,t,n,i,a){let o={success:{_:!0}};return i&&a&&(o={error:{name:i,message:a}}),{eventId:e,resolution:o,context:{source:{name:t,description:n}}}}const fi=(e,t,n,a,o,r,s,l)=>()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const c=n.newLogger("getSetupAppEventsJob","apps-calling"),{enableCallingAppEventSubscriptionTelemetry:d}=a.get(L.J.Calling);let u=!1;const m=(0,ci.P)();let g;return d&&(g=o.newScenario(it.RG.CallingAppEventsSubscribe)),ai.setCallingAppEventsSubscribed(!0),e.subscribe({query:Un,fetchPolicy:"no-cache"}).map((({data:e})=>null==e?void 0:e.callingAppEvents)).subscribe({next:r=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let i;if(d&&(i=o.newScenario(it.RG.CallingAppEventSubscriptionNext,{clientId:null==r?void 0:r.id})),!r)return c.error("[getSetupAppEventsInnerJob] Received undefined calling app event"),void(null==i||i.fail({reason:"undefined-calling-app-event"}));if("CallingAppSetupEvent"===r.event.__typename&&r.event.result&&"CallingAppEventsSetupSuccess"===r.event.result.__typename)return c.log("[getSetupAppEventsInnerJob] Successfully subscribed."),u=!0,m.resolve(),void(null==g||g.stop());const{context:p}=r,{source:v}=p;c.log(`[getSetupAppEventsInnerJob] Received calling app event [event.id=${r.id}][context.externalId=${p.externalId}][source.name=${v.name}][source.description=${v.description}]`);try{yield yi(s,r,a,e,t,n,o,l),null==i||i.stop()}catch(t){c.error(`Calling app event handler threw error. [error.name=${null==t?void 0:t.name}][error.message=${null==t?void 0:t.message}]`),null==i||i.fail({errorCode:t.name,message:t.message,reason:"job-subscription-next-error"}),ri({eventId:r.id,resolution:{error:{name:(null==t?void 0:t.errorCode)||he.jK.HandleCallingAppEventError,message:(null==t?void 0:t.errorMessage)||`Unhandled exception while handling calling app events in job [eventId=${r.id}]`}},context:{source:{name:C.BHj.CallingAppEventJobHandlerError,description:`Error handling event in app job setup calling app events [eventId=${r.id} error.errorCode=${null==t?void 0:t.errorCode}, error.message=${null==t?void 0:t.errorMessage}]`}}},e,c)}})),error:e=>{if(c.error(`[getSetupAppEventsInnerJob] Error in calling app events subscription [error.name=${null==e?void 0:e.name}][error.message=${null==e?void 0:e.message}]`),!u){const t=(0,An.Tr)(r,he.jK.SetupCallingAppEventsJobError,"",{},`[getSetupAppEventsInnerJob] error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}`);m.reject(t)}if(d){let t=o.findScenario(it.RG.CallingAppEventsSubscribe);t||(t=o.newScenario(it.RG.CallingAppEventsSubscribe)),t.fail({errorCode:null==e?void 0:e.name,message:null==e?void 0:e.message,reason:"app-job-subscription-error"})}},complete:()=>{if(d){o.newScenario(it.RG.CallingAppEventsUnsubscribe).stop()}}}),m.promise})),yi=(e,t,n,a,o,r,s,l)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{id:c,event:m,context:g}=t;if(!("action"in m)||!("content"in m)){throw r.newLogger("appEventsHandler","apps-calling").error("[getSetupAppEventsInnerJob] Expected event of type CallingAppEvent, not CallingAppSetupEvent."),new Error("IncorrectCallingAppEventTypeError")}switch(m.content.__typename){case"MainAppContent":!function(e,t,n,a,o){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleMainAppContentEvent","apps-calling"),r={id:o.context.externalId||"undefined",startTimestamp:o.context.timeStamp||"undefined",scenarioName:it.RG.CallingAppEventMainApp,source:kt.D.CallingAppEvent};try{yield t.deepLink.launchMainApp(r)}catch(e){const t=(null==e?void 0:e.name)||"unknown-launch-main-app-commanding-error-name",o=(null==e?void 0:e.message)||"unknown-launch-main-app-commanding-error-message";i.error(`[handleMainAppContentEvent] Commanding error errorName=${t}, eventSource=${r.source}, errorMessage=${o}]`);try{yield ri({eventId:a,resolution:{error:{name:t,message:o}},context:{source:{name:C.BHj.MainAppCommandingError,description:`Error triggering launch main app command [eventId=${a}, eventSource=${r.source}]`}}},n,i)}catch(e){i.error(`[handleMainAppContentEvent] Error when reporting event "error" [eventId=${a}, eventSource=${r.source}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}return}i.log(`[handleMainAppContentEvent] Commanding success [eventId=${a}, eventSource=${r.source}]`);try{yield ri({eventId:a,resolution:{success:{_:!0}},context:{source:{name:C.BHj.MainAppCommandingSuccess,description:`Command resolved successfully [eventId=${a}, eventSource=${r.source}]`}}},n,i)}catch(e){i.error(`[handleMainAppContentEvent] Error when reporting event "success" [error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}}))}(r,o,a,c,t);break;case"CallingWindowingContent":!function(e,t,n,a,o,r,s,l){var c;(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingWindowingContentEvent","apps-calling"),{entity:d,command:u}=Yn(a,o,r,s),m=ai.unlockDeeplinkEntity();try{yield t.call.callById(d.id,{visibilityState:u.visibilityState,stateTransition:u.stateTransition,correlation:u.correlation},null===(c=null==d?void 0:d.linkedEntity)||void 0===c?void 0:c.id,d.type,m)}catch(e){const t=(null==e?void 0:e.name)||"unknown-windowing-commanding-error-name",o=(null==e?void 0:e.message)||"unknown-windowing-commanding-error-message";i.error(`[handleCallingWindowingContentEvent] Windowing commanding error [entity.id=${d.id}, errorName=${t}, errorMessage=${o}]`);try{yield ri({eventId:a,resolution:{error:{name:t,message:o}},context:{source:{name:C.BHj.WindowingCommandingTriggerError,description:`Error triggering windowing command [eventId=${a}, entity.id=${d.id}]`}}},n,i)}catch(e){i.error(`[handleCallingWindowingContentEvent] Error when reporting event "error" [eventId=${a}, entity.id=${d.id}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}return}const{enableCallingAppCommandResolvedHook:g}=l.get(L.J.Calling);if(!g){i.log(`[handleCallingWindowingContentEvent] Windowing commanding success [eventId=${a}, entity.id=${d.id}]`);try{yield ri({eventId:a,resolution:{success:{_:!0}},context:{source:{name:C.BHj.WindowingCommandingSuccess,description:`Windowing command resolved successfully [eventId=${a}, entity.id=${d.id}]`}}},n,i)}catch(e){i.error(`[handleCallingWindowingContentEvent] Error when reporting event "success" [entity.id=${d.id}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}}}))}(r,o,a,c,m,m.content,g,n);break;case"CallingToChatContent":!function(e,t,n,a,o){var r;(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingToChatContentEvent","apps-calling"),{entity:s,command:l}=function(e,t,n,i){const a=t.id,{action:{visibility:o}}=e,{externalId:r,timeStamp:s}=i,l=Xn(o,n),c=t.messageId?{id:t.messageId,type:u.p.messages}:void 0;return{entity:{id:a,type:u.p.chats,action:u.u.view,linkedEntity:c},command:{visibilityState:l,stateTransition:d.su.new,correlation:{id:r||void 0,startTimestamp:s||void 0,source:kt.D.CallingAppEvent}}}}(n,a,i,o);try{yield t.chat.chatById(s.id,{entityCommand:{visibilityState:l.visibilityState,stateTransition:l.stateTransition,correlation:l.correlation},entityOptions:{messageId:null===(r=s.linkedEntity)||void 0===r?void 0:r.id}})}catch(e){i.error(`[getSetupAppEventsInnerJob] Navigation to chat commanding error [entity.id: ${s.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}i.log(`[getSetupAppEventsInnerJob] Navigation to chat commanding success [entity.id: ${s.id}]`)}))}(r,o,m,m.content,g);break;case"CallingToChatListContent":!function(e,t,n,a){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingToChatListContentEvent","apps-calling"),{command:o}=function(e,t,n){const{action:{visibility:i}}=e,{externalId:a,timeStamp:o}=n,r=Xn(i,t);return{entity:{type:u.p.chats,action:u.u.view},command:{visibilityState:r,stateTransition:d.su.none,correlation:{id:a||void 0,startTimestamp:o||void 0,source:kt.D.CallingAppEvent}}}}(n,i,a);try{yield t.chat.chatList({visibilityState:o.visibilityState,stateTransition:o.stateTransition,correlation:o.correlation})}catch(e){i.error(`[getSetupAppEventsInnerJob] Navigation to chat list commanding error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}i.log("[getSetupAppEventsInnerJob] Navigation to chat list commanding success")}))}(r,o,m,g);break;case"CallingToCallListContent":!function(e,t,n,a){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingToCallListContentEvent","apps-calling"),{command:o}=function(e,t,n){const{action:{visibility:i}}=e,{externalId:a,timeStamp:o}=n,r=Xn(i,t);return{entity:{type:u.p.callsmain,action:u.u.view},command:{visibilityState:r,stateTransition:d.su.none,correlation:{id:a||void 0,startTimestamp:o||void 0,source:kt.D.CallingAppEvent}}}}(n,i,a);try{yield t.call.callList({visibilityState:o.visibilityState,stateTransition:o.stateTransition,correlation:o.correlation})}catch(e){i.error(`[getSetupAppEventsInnerJob] Navigation to call list commanding error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}i.log("[getSetupAppEventsInnerJob] Navigation to call list commanding success")}))}(r,o,m,g);break;case"CallingToSettingsPaneContent":!function(e,t,n){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingToSettingsPaneContentEvent","apps-calling"),a=function(e){const t=new Map([[Zn.Calling,ei.Y.Calls],[Zn.Notifications,ei.Y.Notifications],[Zn.Devices,ei.Y.Devices],[Zn.PremiumBenefits,ei.Y.Benefits],[Zn.Privacy,ei.Y.Privacy]]);return{id:e.tabItemId?t.get(e.tabItemId):void 0,command:{stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:kt.D.CallingAppEvent}}}}(n),{id:o,command:r}=a;try{yield t.settings.launchSection(o,r)}catch(e){i.error(`[getSetupAppEventsInnerJob] setting commanding error [entity.id: ${o}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}(r,o,m.content);break;case"CallingBannerContent":!function(e,t,n,a,o,r,s,l){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingBannerContentEvent","apps-calling"),{enableCallingBannerContent:c}=l.get(L.J.Calling);if(!c)return;const d=pi(o,r,s);if(!d){i.error("[handleCallingBannerContentEvent] Banner commanding error - no command to fire, visibility state is undefined");const e="Unknown-banner-commanding-error-name",t=`Unhandled exception while handling calling app events in job, error in converting banner content to command, visibility state is undefined [eventId=${a}]`,o=C.BHj.BannerContentToCommandingConversionError,r=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to undefined commanding with [eventId=${a},`,s=hi(a,o,`Error converting banner content to commanding [eventId=${a}]`,e,t);return void(yield vi(s,n,i,r))}const{bannerPrimaryActionEntity:u,entityOptions:m,command:g,bannerDismissCommandEntity:p}=d,{action:{visibility:v}}=o;if(v===C.KRy.Show)try{yield t.shell.showBanner({id:r.id,text:r.text,intentLevel:r.intentLevel,action:{text:r.joinButtonText,command:{entity:u,entityOptions:m,command:g},dismissOnAction:r.dismissOnAction},dismissable:r.dismissable||void 0,dismissActionCommand:{entity:p,entityOptions:m,command:g},duration:r.duration,bannerScenario:r.bannerScenario,source:r.source});const e=C.BHj.ShowBannerSuccess,o=`Show banner command resolved successfully [eventId=${a}, entity.id=${u.id}]`,s=`[handleCallingBannerContentEvent] Error when reporting show banner event "success" with [eventId=${a}, entity.id=${u.id},`,l=hi(a,e,o);yield vi(l,n,i,s)}catch(e){i.error(`Error is displaying banner through shell.showBanner with [entity.id: ${u.id}, error.name: ${e.name}, error.message: ${e.message}]`);const t="Unknown-show-banner-error-name",o=`Unhandled exception while handling calling app events in job, failed to trigger shell.showBanner function, error in showing banner [eventId=${a}]`,r=C.BHj.ShowBannerError,s=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to failure of shell.showBanner with [eventId=${a},`,l=hi(a,r,`Error in showing banner through shell.showBanner [eventId=${a}]`,t,o);yield vi(l,n,i,s)}if(v===C.KRy.Hide)try{yield t.shell.dismissBanner(r.id,r.source),i.log(`[dismissBanner] Successfully hiding the banner with [bannerId: ${r.id}] when call is no longer active.`);const e=C.BHj.DismissBannerSuccess,o=`Dismiss banner command resolved successfully [eventId=${a}, entity.id=${p.id}]`,s=`[handleCallingBannerContentEvent] Error when reporting dismiss banner event "success" with [eventId=${a}, entity.id=${p.id},`,l=hi(a,e,o);yield vi(l,n,i,s)}catch(e){i.error(`Error in dismissing the banner when call is no longer active. entity.id: ${p.id}, entity.action: ${p.action}, error.name=${e.name}, error.message=${e.message}]`);const t="Unknown-dismiss-banner-error-name",o=`Unhandled exception while handling calling app events in job, failed to trigger shell.dimissBanner function, error in dismissing banner [eventId=${a}]`,r=C.BHj.DismissBannerError,s=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to failure of shell.dismissBanner with [eventId=${a},`,l=hi(a,r,`Error in dismissing banner through shell.dismissBanner [eventId=${a}]`,t,o);yield vi(l,n,i,s)}}))}(r,o,a,c,m,m.content,g,n);break;case"CallingDialogContent":!function(e,t,n,a,o,r,s){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingDialogContentEvent","apps-calling"),{id:l}=o,c=s.findScenarioByNameAndId(it.RG.CallingDialogOpen,l);c||i.error(`[getSetupAppEventsInnerJob] Cannot find calling_dialog_open scenario [dialogId: ${l}]`),null==c||c.mark(it.ck.CallingDialogCallingAppEventReceived);const u=mi(a,o,r);if(!u){const e="[getSetupAppEventsInnerJob] Dialog commanding error - no command to fire, command is undefined";return i.error(e),void(null==c||c.fail({errors:e,errorCode:"command-is-undefined"}))}const{entity:m,entityOptions:g,command:p}=u;if(!m.type){const e=`[getSetupAppEventsInnerJob] Dialog commanding error - no command to fire, entity type is undefined [entity.id: ${m.id}]`;return i.error(e),void(null==c||c.fail({errors:e,errorCode:"entity-type-is-undefined"}))}let v;null==c||c.mark(it.ck.BeforeCallingDialogEntityCommandTriggered);try{v=yield n.call.openDialog(m,p,g)}catch(e){const t=`[getSetupAppEventsInnerJob] Dialog commanding error [entity.id: ${m.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`;return i.error(t),void(null==c||c.fail({errors:t,errorCode:"open-dialog-commanding-error"}))}null==c||c.mark(it.ck.AfterCallingDialogEntityCommandTriggered);const h=v.subscribe({next:({containerState:e})=>{switch(e){case d.oq.Closed:t.mutate({mutation:gi,variables:{dialogId:o.id,actionName:C.Liy.PostClose}}),h.unsubscribe();break;case d.oq.Open:null==c||c.stop({reason:`Dialog container opened [dialogId: ${l}]`})}}});i.log(`[getSetupAppEventsInnerJob] Dialog commanding success [entity.id: ${m.id}]`),null==c||c.mark(it.ck.SubscribedToDialogObservable)}))}(r,a,o,m,m.content,g,s);break;case"CallingNotificationContent":!function(e,t,n,a,o,r,s,l,c,d){var m,g,p,v,h,f,y,b;(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingNotificationContentEvent","apps-calling");let S;const k=(0,Ye.v4)(),{enableIncomingCallCrossClientTelemetry:w}=s.get(L.J.Calling);w&&n.callId&&n.crossClientScenarioName&&(S=l.findScenarioByNameAndId(n.crossClientScenarioName,n.callId)),S&&(null==S?void 0:S.isHoisted)||(S=l.newScenario(it.RG.CrossClientToastView),S.clientId=k,S.appendEventData({mainEntityType:u.p.calls}),null===(m=l.hoistScenarioToCore)||void 0===m||m.call(l,S));const _=Gn(n,s,k);if(_.entityOptions&&s.get(L.J.Notifications).enableToastCollections&&(_.entityOptions.collectionId=ui(c,d,i)),"CreateNotificationWithActions"===(null===(g=o.source)||void 0===g?void 0:g.name))if(a===C.KRy.Show){S.mark(it.ck.CrossClientTriggerShowToast),yield Promise.all([ki(n,r,_,i,S),bi(n,r,_,i,S)]);try{yield t.call.callNotification(_,n.id,k,C.KRy.Show)}catch(e){S.fail({errorCode:li.f.SubscriptionFailed,reason:"Subscription failed on show"}),i.error(`CN:${n.id}:[handleCallingNotificationContentEvent] Notification commanding error on [${null===(p=o.source)||void 0===p?void 0:p.name}] [[content.id: ${n.id}], entity.id: toasts, visibility: ${a.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}else{S.mark(it.ck.CrossClientTriggerHideToast);try{yield t.call.callNotification(_,n.id,k,C.KRy.Hide)}catch(e){S.fail({errorCode:li.f.SubscriptionFailed,reason:"Subscription failed on hide"}),i.error(`CN:${n.id}:[handleCallingNotificationContentEvent] Notification commanding error on [${null===(v=o.source)||void 0===v?void 0:v.name}] [[content.id: ${n.id}], entity.id: toasts, visibility: ${a.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}else{if("UpdateNotification"!==(null===(h=o.source)||void 0===h?void 0:h.name))return S.fail({errorCode:li.f.SubscriptionFailed,reason:`Invalid context.source.name [${null===(y=o.source)||void 0===y?void 0:y.name}]`}),void i.error(`CN:${n.id}:[handleCallingNotificationContentEvent] Notification commanding error invalid context.source.name [${null===(b=o.source)||void 0===b?void 0:b.name}] [[content.id: ${n.id}], entity.id: toasts, visibility: ${a.toString()}`);S.mark(it.ck.CrossClientTriggerUpdateToast);try{yield t.call.callNotification(_,n.id,k,C.KRy.Show)}catch(e){S.fail({errorCode:li.f.SubscriptionFailed,reason:"Subscription failed on update"}),i.error(`CN:${n.id}:[handleCallingNotificationContentEvent] Notification commanding error on [${null===(f=o.source)||void 0===f?void 0:f.name}] [[content.id: ${n.id}], entity.id: toasts, visibility: ${a.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}S.mark(it.ck.CrossClientEntityCommandTriggered),i.log(`CN:${n.id}:[handleCallingNotificationContentEvent] Notification commanding success [content.id: ${n.id}][entity.id: toasts][visibility: ${a.toString()}]`)}))}(r,o,m.content,m.action.visibility,g,a,n,s,e,l)}}));function bi(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const r=yield function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e.query({query:ni,fetchPolicy:"network-only"});return n?n.data.priorityContacts.map((e=>e.id)):(t.error("CN:[handleCallingNotificationContentEvent] Failed to fetch priority contacts"),[])}catch(e){return t.error("CN:[handleCallingNotificationContentEvent] Failed to fetch priority contacts"),[]}}))}(t,a);n.entityOptions.isUrgent=r.includes(e.userid),o.mark(it.ck.PriorityContactsFetched)}catch(t){a.error(`CN:${e.id}:[handleCallingNotificationContentEvent] Error when fetching priority contacts. Error: ${t}`)}}))}function Si(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield e.query({query:ti,variables:{userId:t,displayName:n,profilePictureSize:"HR96x96"}});if(!i)return void o.error(`CN:${a}:[handleCallingNotificationContentEvent] Failed to generate avatar image url`);const r=yield e.query({query:ii,variables:{url:i.data.msaUserProfilePicture}});return(null==r?void 0:r.data.toastImageAsDataUri)||void 0}catch(e){return void o.error(`CN:${a}:[handleCallingNotificationContentEvent] failed to fetch avatar image`)}}))}function ki(e,t,n,a,o){var r,s,l,c,d,u;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{let i,m;e.userid&&(null===(r=n.entityOptions)||void 0===r?void 0:r.mainImage)?i=Si(t,e.userid,e.title,e.id,a):a.log("[handleCallingNotificationContentEvent] Primary avatar not fetched, user id or main image property is not present on the content."),(null===(s=e.header)||void 0===s?void 0:s.mri)&&(null===(l=n.entityOptions)||void 0===l?void 0:l.headerImage)&&(m=Si(t,e.header.mri,e.header.subtitle,e.id,a));const[g,p]=yield Promise.all([i,m]);g&&(n.entityOptions.mainImage={src:g,alt:null!==(c=e.title)&&void 0!==c?c:""},o.mark(it.ck.CrossClientAvatarFetched)),p&&(n.entityOptions.headerImage={src:p,alt:null!==(u=null===(d=e.header)||void 0===d?void 0:d.subtitle)&&void 0!==u?u:""})}catch(e){a.error(`[handleCallingNotificationContentEvent] failed handle avatar fetches. Error: ${e}`)}}))}var wi=n(786918),Ci=n(405668);const _i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingSetCallStatePresenceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"endpointPresenceRequest"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EndpointPresenceRequest"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setCallStatePresence"},arguments:[{kind:"Argument",name:{kind:"Name",value:"endpointPresenceRequest"},value:{kind:"Variable",name:{kind:"Name",value:"endpointPresenceRequest"}}}]}]}}]},Ti={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"callingClientStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingClientStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingClientStateEvent"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingClientStateEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingClientStateEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"inCall"}},{kind:"Field",name:{kind:"Name",value:"isScreenSharing"}}]}}]}.definitions]},Ii={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateClientStateVeryActive"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isVeryActive"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateClientStateSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateClientStateVeryActive"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isVeryActive"},value:{kind:"Variable",name:{kind:"Name",value:"isVeryActive"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}]}]}}]},Ei=(e,t)=>()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=t.newLogger("getCallingClientEventsJob","apps-calling");e.subscribe({query:Ti,fetchPolicy:"no-cache"}).subscribe((({data:a,errors:o})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(o){const e=o.map((e=>e.message));n.error(`handleCallingClientStateEvent: Error receiving callingClientStateEvent [Errors: ${e.join()}]`)}else a&&(n.log(`handleCallingClientStateEvent: Processing callingClientStateEvent [Received: ${(0,wi.u4)(a)}]`),function(e,t,n){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingClientStateEvent","apps-calling");i.log(`Event received: ${(0,wi.u4)(t)}`);try{yield n.mutate({mutation:Ii,variables:{isVeryActive:t.inCall||t.isScreenSharing,source:C.HRk.Calling}})}catch(e){i.error(`mutation updateClientStateVeryActiveDocument error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}(t,a.callingClientStateEvent,e),a.callingClientStateEvent.isScreenSharing?(Ni(t,{availability:C.a8y.DoNotDisturb,activity:C.cS$.Presenting},e),Ai(C.rsL.ScreenSharing,e)):a.callingClientStateEvent.inCall?(Ni(t,{availability:C.a8y.Busy,activity:C.cS$.InACall},e),Ai(C.rsL.InCall,e)):Ai(C.rsL.None,e))}))))}));function Ni(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("setCallStatePresence","apps-calling");i.log(`Call state presence received: ${(0,wi.u4)(t)}`);try{yield n.mutate({mutation:_i,variables:{endpointPresenceRequest:t}})}catch(e){i.error(`mutation AppsCallingSetCallStatePresenceMutationDocument error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}function Ai(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield t.mutate({mutation:Ci.b,variables:{newState:e},fetchPolicy:"no-cache"})}))}const Fi=(e,t,n,i,a,o,r,s)=>{const{enableCallingStackInitialization:l,enableCallingClientEvents:c,enableCallingAppEvents:d}=a.get(L.J.Calling),u=[];if(l){const t=Di(i,it.RG.StandupCallingAppJob,o);u.push(Mn(e,n,o,i,a)),t.mark(it.ck.JobAdded),t.stop()}return d&&u.push(((e,t,n,i,a,o,r,s)=>({id:"setup-calling-app-events",runOncePerId:!0,job:fi(e,t,n,i,a,o,r,s)}))(e,t,n,a,i,o,s,r)),c&&u.push(((e,t)=>({id:"calling-client-events",runOncePerId:!0,job:Ei(e,t)}))(e,n)),u},Di=(e,t,n)=>{let i=e.findScenario(t);return i||(i=e.newScenario(t)),i.mark(n),i},Ri=({context:{authenticationUser:e,client:t,coreSettings:n,entityCommanding:i,loggerFactory:a,scenarioFactory:o,userTrackingService:r}})=>Fi(t,i,a,o,n,it.ck.OnAppPreWarm,r,e),xi=({context:{client:e,coreSettings:t,entityCommanding:n,loggerFactory:i,scenarioFactory:a}})=>Fi(e,n,i,a,t,it.ck.OnAppPreInit),Mi=e=>"tel:"===e,Oi={filter:({protocol:e})=>Mi(e),execute:({deeplinkUrl:{pathname:e,protocol:t},context:{coreSettings:n,loggerFactory:a}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,o;const r=a.newLogger("[Calling][OnBeforeDeeplinkParsed][CallingProtocol]","apps-calling"),{enableCallWithUsersDeeplink:s}=n.get(L.J.Calling);if(!s||!Mi(t)){const e=`enableCallWithUsersDeeplink=${s} or protocol=${t} is not supported`;throw null===(i=r.warnToTelemetry)||void 0===i||i.call(r,e,"calling_protocol_deeplink_condition",void 0,!0),new Error(e)}return null===(o=r.infoToTelemetry)||void 0===o||o.call(r,`Returning calling protocol dialog intent for protocol=${t}`,"calling_protocol_deeplink_condition",void 0,!0),{entityCommand:{entity:{type:u.p.callingprotocoldeeplinkdialog,action:u.u.create},command:{visibilityState:d.fe.show,stateTransition:d.su.extend,layoutMode:d.lO.standard},entityOptions:{protocol:"tel",target:e}},metadata:{allowAnonymous:!1}}}))};var Pi;!function(e){e.EmptyDeeplinkUrl="empty-deeplink-url-received",e.MeetingCodeParse="meeting-code-parse-error",e.LegacyCoordinatesParse="legacy-coordinates-parse-error",e.EmptyContext="empty-context-received",e.EmptyParsedUrlParams="empty-parsed-url-params",e.None="no-entity-command-expected",e.PresentDeepLinkT2Disabled="present-deeplink-t2-disabled",e.EmptySearch="empty-search-url"}(Pi||(Pi={}));const Li=e=>({visibilityState:d.fe.show,stateTransition:e?d.su.flush:d.su.new,layoutMode:e?d.lO.standard:d.lO.focus}),Ui=(e,t)=>{if("null"!==e)return e;const n=t.get("fqdn");return n?`https://${n}`:void 0},ji={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingHandlePresentDeeplinkMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ver"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pptContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"handlePresentDeepLink"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ver"},value:{kind:"Variable",name:{kind:"Name",value:"ver"}}},{kind:"Argument",name:{kind:"Name",value:"deeplinkId"},value:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}}},{kind:"Argument",name:{kind:"Name",value:"pptContext"},value:{kind:"Variable",name:{kind:"Name",value:"pptContext"}}}]}]}}]},$i=e=>{const[,,t,n]=e.pathname.split("/"),{users:i,withVideo:a}=(({searchParams:e})=>{const t=(e.get("users")||"").trim(),n="true"===(e.get("withVideo")||"").toLocaleLowerCase();if(0===t.length)return{users:[],withVideo:n};const i=t.split(",").filter(Boolean).map((e=>e.toLocaleLowerCase()));return{users:[...new Set(i)],withVideo:n}})(e);return{type:t,containerId:n,users:i,withVideo:a}},Bi=e=>{const{type:t,containerId:n,users:i}=$i(e);return"call"===t&&"0"===n&&i.length>0},Wi=[Oi,{filter:e=>{const t=e.pathname.includes("/l/meetup-join"),n=new URLSearchParams(e.search).get("context");if(!n)return!1;const{IsBroadcastMeeting:i}=JSON.parse(n);return t&&!i},execute:({deeplinkUrl:{pathname:e,search:t,origin:n},context:{coreSettings:i,loggerFactory:a}})=>{const o=a.newLogger("[Calling][onBeforeDeeplinkParsed][/l/meetup-join]","apps-calling"),{allowAnonymousMeetingJoin:r,enableDeeplinkFlushCommand:s}=i.get(L.J.Calling);if(o.log(`Parsing pathname: ${e}, search: ${t}, allowAnonymousMeetingJoin: ${r}`),!e)return Promise.reject({message:Pi.EmptyDeeplinkUrl});const l=e.split(/[/?&]/),c=l.indexOf("meetup-join")+1,d=l[c],m=l[c+1],g=new URLSearchParams(t);g.set("anon","true");const p=g.get("context");if(!p)return Promise.reject({message:Pi.EmptyContext});const v=g.get("pp"),{Tid:h,Oid:f,MessageId:y,prid:b,isPublic:S}=JSON.parse(p);if(!(d&&m&&h&&f)){const e=`${d?"":"empty-conversationId"} ${m?"":"empty-rootMessageId"} ${h?"":"empty-tenantId"} ${f?"":"empty-organizerId"}`;return Promise.reject({message:Pi.LegacyCoordinatesParse,reason:e})}let k;const w=Ui(n,g);w&&(k=`${w}/_#${e}?${g.toString()}`);const _={joinType:C.cku.Legacy,conversationId:d,messageId:y||m,rootMessageId:m,isChannel:"0"!==m,isAdhoc:!1,tenantId:h,organizerId:f,meetingCloud:g.get("fqdn")||(0,$e.uO)(n),participantPin:v,registration:b?{participantRegistrationId:b,isPublicEvent:S||!1}:null};return o.log(`Resolving ${JSON.stringify(_)}`),Promise.resolve({entityCommand:{entity:{type:u.p.callingdeeplink,action:u.u.join,id:`${d}/${m}`},command:Li(!!s),entityOptions:{deeplinkUrl:e,coordinates:_,directMeetingLink:k,homeCloud:g.get("homeCloud"),deeplinkId:g.get("deeplinkId")}},metadata:{allowAnonymous:r||!1,tenantId:h}})}},{filter:"/meet",execute:({deeplinkUrl:{pathname:e,search:t,origin:n},context:{coreSettings:i,loggerFactory:a}})=>{const o=a.newLogger("[Calling][onBeforeDeeplinkParsed][/meet]","apps-calling"),{allowAnonymousMeetingJoin:r,defaultAnonTenantId:s,doNotPassTenantIdForAnonMeetingJoins:l,enableDeeplinkFlushCommand:c}=i.get(L.J.Calling),{enableXboxWatchparties:d}=i.get(L.J.WindowsSignatureExperiences);if(o.log(`Parsing pathname: ${e}, search: ${t}, allowAnonymousMeetingJoin: ${r}`),!e)return Promise.reject({message:Pi.EmptyDeeplinkUrl});const m=e.split(/[/?&]/),g=m.indexOf("meet"),p=m[g+1];if(!p||-1===g)return Promise.reject({message:Pi.MeetingCodeParse});const v=new URLSearchParams(t);let h,f;v.set("anon","true");const y=Ui(n,v);return y&&(h=`${y}/_#${e}?${v.toString()}`,f=`${y}${e}${t}`),o.log(`Resolving ${p}`),Promise.resolve({entityCommand:{entity:{type:u.p.callingdeeplink,action:u.u.join,id:p},command:Li(!!c),entityOptions:{deeplinkUrl:e,coordinates:{joinType:C.cku.MeetingData,meetingData:{meetingCode:p,passcode:v.get("p"),meetingUrl:f},participantPin:v.get("pp"),isAdhoc:!1},directMeetingLink:h,homeCloud:v.get("homeCloud"),deeplinkId:v.get("deeplinkId"),isWatchParty:"true"===v.get("isWatchParty")&&d}},metadata:{allowAnonymous:r||!1,tenantId:l?void 0:s||void 0}})}},{filter:"/l/present",execute:({deeplinkUrl:{search:e},context:{coreSettings:t,loggerFactory:n,__doNotUse_globalDataClient:a}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const{enablePresentDeepLinkForMTMA:o}=t.get(L.J.Calling),r=n.newLogger("[Calling][onBeforeDeeplinkParsed][/present]","apps-calling");if(r.log(`EnablePresentToTeamsT2: ${o}. Parsing search length: ${e.length}`),!o)return Promise.reject({message:Pi.PresentDeepLinkT2Disabled});if(""===e)return Promise.reject({message:Pi.EmptySearch});const s=new URLSearchParams(e),l=s.get("ver"),c=s.get("deeplinkId"),m=s.get("pptContext");if(r.log(`Parsed params ver: ${l}, deeplinkId: ${c}`),!l||!c||!m)return Promise.reject({message:Pi.EmptyParsedUrlParams});let g;try{g=yield a.mutate({mutation:ji,variables:{ver:l,deeplinkId:c,pptContext:m}})}catch(e){throw null===(i=r.errorToTelemetry)||void 0===i||i.call(r,e.message,"cmd_meetings_pptsharing_handle_present_deeplink_mutation_error"),new Error(e.message)}return g&&g.data&&!g.data.handlePresentDeepLink?Promise.resolve({entityCommand:{entity:{type:u.p.presentdeeplinknomeetingcontextdialog,action:u.u.create},command:{visibilityState:d.fe.show,stateTransition:d.su.extend,layoutMode:d.lO.standard}},metadata:{allowAnonymous:!1}}):void 0}))},{filter:"/convene/events",execute:({deeplinkUrl:{pathname:e,search:t,origin:n},context:{coreSettings:i,loggerFactory:a}})=>{var o;const r=a.newLogger("[Calling][onBeforeDeeplinkParsed][events]","apps-calling"),{allowAnonymousMeetingJoin:s,defaultAnonTenantId:l}=i.get(L.J.Calling);if(r.log(`Parsing pathname: ${e}, search: ${t}, allowAnonymousMeetingJoin: ${s}`),!e)return Promise.reject({message:Pi.EmptyDeeplinkUrl});if(!e.startsWith("/convene/events"))return Promise.reject({message:Pi.MeetingCodeParse});const c=new URLSearchParams(t);c.set("anon","true");const m=`${n}/_#${e}?${c.toString()}`,g=c.get("url");if(!g)return Promise.reject({message:Pi.MeetingCodeParse});const p=new URL(g),v=null!==(o=p.pathname.split("/").find((e=>e.startsWith("19:"))))&&void 0!==o?o:"",h=p.searchParams.get("context");if(!h)return Promise.reject({message:Pi.MeetingCodeParse});const{Tid:f,Oid:y,prid:b}=JSON.parse(h),S=p.searchParams.get("displayName");return Promise.resolve({entityCommand:{entity:{type:u.p.events,action:u.u.join,id:"embed"},command:{visibilityState:d.fe.show,stateTransition:d.su.none,layoutMode:d.lO.standard,correlation:{id:Xe()(),startTimestamp:Date.now(),source:kt.D.CallingOnBeforeDeeplinkParsed}},entityOptions:{embedUrl:m,meetingUrl:g,threadId:v,messageId:"0",tenantId:f,organizerId:y,registrationId:b,displayName:S}},metadata:{allowAnonymous:s||!1,tenantId:l||void 0}})}},{filter:e=>Bi(e),execute:({deeplinkUrl:e,context:{coreSettings:t,loggerFactory:n}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a;const o=n.newLogger("[Calling][OnBeforeDeeplinkParsed][CallingDeeplink]","apps-calling"),{enableCallingDeeplink:r}=t.get(L.J.Calling),{type:s,containerId:l,users:c,withVideo:m}=$i(e),g=JSON.stringify({type:s,containerId:l,usersCount:c.length});if(!r||!Bi(e)){const e=`Skip rendering deeplink dialog: enableCallingDeeplink=${r}, infoFromUrl=${g}`;throw null===(i=o.warnToTelemetry)||void 0===i||i.call(o,e,"calling_deeplink_navigation",void 0,!0),new Error(e)}return null===(a=o.infoToTelemetry)||void 0===a||a.call(o,`Render deeplink dialog: infoFromUrl=${g}`,"calling_deeplink_navigation",void 0,!0),{entityCommand:{entity:{type:u.p.callingdeeplinkDialog,action:u.u.create},command:{visibilityState:d.fe.show,stateTransition:d.su.extend,layoutMode:d.lO.standard},entityOptions:{users:c,withVideo:m}},metadata:{allowAnonymous:!1}}}))}],Hi={shouldAddEntitiesToWindowHistory:e=>{var t,n;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.callingdeeplink&&(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==u.p.calls},shouldRestoreClientToEntities:e=>{var t,n;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.callingdeeplink&&(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==u.p.calls}};var Vi=n(201439),zi=n(604994);const qi={onEventReceived:({eventInput:e})=>{var t,n,i,a;switch(e.event.type){case ln.uS.requestPersonMoreInfo:const o=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:mn(o)});case Vi.uS.showMonitor:return Promise.resolve({command:zi.CN.showMonitor(null===(a=(i=e.event).data)||void 0===a?void 0:a.call(i))});case Vi.uS.closeMonitor:return Promise.resolve({command:zi.CN.closeMonitor()});case Vi.uS.hideMonitor:return Promise.resolve({command:zi.CN.hideMonitor()});case Vi.uS.unhideMonitor:return Promise.resolve({command:zi.CN.unhideMonitor()})}return Promise.resolve(void 0)}},Gi=({appRenderMode:e,coreSettings:t})=>{const n=new ht.H,{criticalPhaseTimeout:i}=t.get(L.J.Calling);return e!==s.S.Main||n.registerAppPhase({phase:ft.nh.CRITICAL,signals:[ft.GZ.CALLING_SCREEN_RENDERED],timeout:i||9e4}),n.appPhases};var Ji=n(270641);const Qi=e=>{if(Ki(e))return Yi(e)?{subNavEntity:Xi(e),headerEntity:Zi(e),startEntity:ea(e),mainEntity:ta(e),endEntity:na(e)}:null},Ki=({layoutMode:e,entity:t,contextEntity:n})=>{const{action:i=null,type:a}=Object.assign({},t),o=[d.lO.focus,d.lO.standard].includes(e),r=[u.p.callingdeeplink,u.p.calls,u.p.callsmonitor,u.p.meetings,u.p.events,u.p.meetingroomallinonecall].includes(a),s=i&&[u.u.create,u.u.default,u.u.list,u.u.view,u.u.join].includes(i)||a===u.p.callingdeeplink&&!i&&!!n;return!!(o&&r&&s)},Yi=({contextEntity:e})=>!e||![u.p.identity,u.p.tflfre].includes(e.type),Xi=()=>null,Zi=({entity:e,contextEntity:t})=>e.type===u.p.callingdeeplink?t||null:e,ea=()=>null,ta=({entity:e,contextEntity:t})=>e.type===u.p.callingdeeplink&&(null==t?void 0:t.type)===u.p.calls?t:e,na=({contextEntity:e})=>e&&e.action&&(e.type===u.p.chats||e.type===u.p.devicesettings||e.type===u.p.meetings||e.type===u.p.extensions||e.type===u.p.transcript||e.type===u.p.meetingdetails||e.type===u.p.roster||e.type===u.p.yammerqna||e.type===u.p.accessibilitypanel||e.type===u.p.meetingcollaboration||e.type===u.p.closedcaptionssettings)||(null==e?void 0:e.action)===u.u.info&&(null==e?void 0:e.type)===u.p.calls?e:null,ia=({entity:e,coreSettings:t,themeOptions:n})=>{var i;const{enableLightThemeSupport:a=!1,renderHeaderAtBottomForCalls:o=!1,enableSmartDeviceLayout:r=!1}=null!==(i=null==t?void 0:t.get(L.J.Calling))&&void 0!==i?i:{},l=new Set([u.p.calls,u.p.meetingroomallinonecall]),c=null==n?void 0:n.isCallingWindowDarkTheme;return(null==e?void 0:e.type)===u.p.callsmonitor?{[C.tF7.mainEntity]:{[s.S.Main]:{doesHeaderOverlapMain:!1,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!a||c,UNSAFE_enablePptProvider:!0}},[C.tF7.headerEntity]:{[s.S.HorizontalBar]:{slotHeightOverrides:"5.4rem",doesHeaderOverlapMain:!1,isBackgroundTransparent:!0}}}:{[C.tF7.mainEntity]:{[s.S.Main]:{doesHeaderOverlapMain:!1,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!a||c,canOverrideMeetingTheme:!1,UNSAFE_enablePptProvider:!0}},[C.tF7.headerEntity]:{[s.S.HorizontalBar]:{slotHeightOverrides:"auto",doesHeaderOverlapMain:!1,isBackgroundTransparent:!1,renderHeaderAtBottom:!(!o&&!r||void 0===(null==e?void 0:e.type)||!l.has(e.type))}},[C.tF7.endEntity]:{[s.S.Rail]:{doesHeaderOverlapMain:(null==e?void 0:e.type)===u.p.videobackgrounds,isBackgroundTransparent:!!e&&aa.includes(e.type)}},[C.tF7.monitorEntity]:{[s.S.Monitor]:{areaRectangle:{height:"auto",position:Ji.Y.BottomRight,width:"32rem"},draggableAreaHeight:"3.2rem"}}}},aa=[u.p.videobackgrounds,u.p.videoeffectsandavatar,u.p.videoeffectscustomization,u.p.videoeffectsmoreview,u.p.stylemyroom],oa={id:"com.microsoft.teams.calling",name:"Calls",supportedEntities:[u.p.callingdeeplink,u.p.callingdeeplinkDialog,u.p.callingprotocoldeeplinkdialog,u.p.calls,u.p.callscontent,u.p.callsgallery,u.p.callsgalleryandcontent,u.p.meetingroomallinonecall,u.p.callsmonitor,u.p.cameraeffects,u.p.contentcamerasetup,u.p.callingalertdialog,u.p.callingbannernotification,u.p.callingconfirmdialog,u.p.unparkcalldialog,u.p.usermediadialog,u.p.devicesettings,u.p.notes,u.p.mediastreams,u.p.meetingdetails,u.p.meetings,u.p.meetingstream,u.p.roster,u.p.pstncallmedialog,u.p.videobackgrounds,u.p.stylemyroom,u.p.broadcastqna,u.p.transcript,u.p.shareMeetingInfo,u.p.stagecontent,u.p.breakoutroomspanel,u.p.invisionwhiteboard,u.p.videoeffectscustomization,u.p.videoeffectsmoreview,u.p.videoeffectsandavatar,u.p.windowingerrordialog,u.p.restartrecomendeddialog,u.p.stagingroomstartmeetingconfirmationdialog,u.p.meshavatar,u.p.events,u.p.yammerqna,u.p.roomremote,u.p.accessibilitypanel,u.p.closedcaptionssettings,u.p.meetingcollaboration,u.p.presentdeeplinknomeetingcontextdialog,u.p.floatingmonitor],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Modal,s.S.Rail,s.S.Monitor],windowFeatures:{otherEntityTypes:{minWidth:800,width:800,minHeight:670,height:600},[u.p.callsmonitor]:{height:247,width:304,additionalFeatures:{alwaysOnTop:"true",resizable:"false",fullscreenable:"false",maximizable:"false",closable:"false",hideWindowControl:"true",frame:"false",contentprotection:"true",excludeWindowFromScreenSharing:"true",closeoverride:"true"}}},shouldErrorOnEntityCommandTimeout:!0},ra={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"triggerCallingToastAction"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"notificationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerCallingToastAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"notificationId"},value:{kind:"Variable",name:{kind:"Name",value:"notificationId"}}},{kind:"Argument",name:{kind:"Name",value:"actionType"},value:{kind:"Variable",name:{kind:"Name",value:"actionType"}}}]}]}}]},sa={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"fireCallingIntent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var la=n(404026),ca=n(177948),da=n(802030);const ua={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingTriggerBannerActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bannerId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BannerAction"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerBannerAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bannerId"},value:{kind:"Variable",name:{kind:"Name",value:"bannerId"}}},{kind:"Argument",name:{kind:"Name",value:"actionName"},value:{kind:"Variable",name:{kind:"Name",value:"actionName"}}}]}]}}]},ma={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingBroadcastRoleQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"roleHint"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"joinId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"broadcast"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"roleHint"},value:{kind:"Variable",name:{kind:"Name",value:"roleHint"}}},{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"joinId"},value:{kind:"Variable",name:{kind:"Name",value:"joinId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"userRole"}}]}}]}}]},ga=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!t.entityOptions){const e="[handleDeeplink] No entity options";return a.error(e),Promise.reject(e)}const{coordinates:o,roleHint:r}=t.entityOptions,{tenantId:s,organizerId:l,conversationId:c,messageId:m,broadcast:g}=o,p=`${s}__${l}__${c}__${m}`,v=(null==g?void 0:g.role)||(yield((e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const{data:i}=yield e.query({query:ma,variables:{id:t,roleHint:n,teamsCallId:"",joinId:""}});return a.log(`[getBroadcastRole] userRole: ${i.broadcast.userRole}`),i.broadcast.userRole}catch(e){return a.log(`[getBroadcastRole] error: ${e}`),C.tf6.None}})))(n,p,r,a));return v===C.tf6.Contributor?(t.entityOptions=Object.assign(Object.assign({},t.entityOptions),{coordinates:Object.assign(Object.assign({},o),{broadcast:{role:v}})}),pa(e,t,a)):v===C.tf6.Producer?Object.assign(Object.assign({},t),{entity:Object.assign(Object.assign({},t.entity),{type:u.p.unsupporteddeeplinkdialog,action:u.u.view}),command:Object.assign(Object.assign({},t.command),{layoutMode:d.lO.standard,stateTransition:d.su.extend,visibilityState:d.fe.show})}):Object.assign(Object.assign({},t),{entity:Object.assign(Object.assign({},t.entity),{id:p,type:u.p.broadcasts,action:u.u.view}),command:Object.assign(Object.assign({},t.command),{visibilityState:d.fe.show,stateTransition:d.su.new,layoutMode:d.lO.focus}),entityOptions:Object.assign(Object.assign({},t.entityOptions),{threadId:c,messageId:m,tenantId:s,organizerId:l})})})),pa=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coordinates:i}=t.entityOptions,a=ai.getDeeplinkEntityLocked();if(a||!a&&ai.getCallingAppEventsSubscribed())return ai.getDeeplinkReady()&&(n.log("[handleDeeplink] awaiting getDeeplinkReady"),yield ai.getDeeplinkReady()),va(e,t,n);const{conversationId:o,rootMessageId:r}=i,s=`${o}/${r}`;if(!s){const e="[handleDeeplink] Deeplink entity cannot be locked because lockId is undefined";return n.error(e),Promise.reject(e)}return n.log("[handleDeeplink] lockDeeplinkEntity"),ai.lockDeeplinkEntity(s),t})),va=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=t.entityOptions,{coordinates:a,deeplinkId:o}=i,r=(0,da.sM)(a,o);return n.log("[handleDeeplink] triggering fireCallingIntent mutation"),e.client.mutate({mutation:sa,variables:{callingIntent:r}}).then((()=>{n.log("[handleDeeplink] fireCallingIntent succeeded")})).catch((e=>(n.error(`failed to fireCallingintent with ${(0,la.A)(e)}`),Promise.reject(e))))})),ha=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:t,entityCommand:{entity:{type:n,action:i},dataOptions:a},requestContext:o,requestContext:{client:r}}=e,s=o.loggerFactory.newLogger("CallingOnBeforeCommandHandled","apps-calling");if(ka(n,i))return wa(o,t,s);if(((e,t)=>e===u.p.callingbannernotification&&t===u.u.join)(n,i))return((e,t)=>{const n=e.loggerFactory.newLogger("CallingBannerCommandHandler[handleBannerPrimaryAction]","apps-calling");if(!t.entityOptions){const e=`Error when handling banner's primary action, join click since entity options is undefined for entityId=${t.entity.id}, entityType=${t.entity.type} and entityAction=${t.entity.action}`;return n.error(e),Promise.reject(new Error(e))}return e.client.mutate({mutation:ua,variables:{bannerId:t.entity.id,actionName:C.sRD.PrimaryAction}})})(o,t);if(((e,t)=>e===u.p.callingbannernotification&&t===u.u.delete)(n,i))return((e,t)=>{const n=e.loggerFactory.newLogger("CallingBannerCommandHandler[handleBannerDismiss]","apps-calling");if(!t.entityOptions){const e=`Error when handling banner dismiss since entity options is undefined for entityId=${t.entity.id}, entityType=${t.entity.type} and entityAction=${t.entity.action}`;return n.error(e),Promise.reject(new Error(e))}return e.client.mutate({mutation:ua,variables:{bannerId:t.entity.id,actionName:C.sRD.DismissAction}})})(o,t);if(ya(n,i,t.entityOptions))return ga(o,t,r,s);if(Sa(n,i)){const{coordinates:e}=t.entityOptions,n=ai.getDeeplinkEntityLocked();if(n||!n&&ai.getCallingAppEventsSubscribed())return ai.getDeeplinkReady()&&(s.log("[handleDeeplink] awaiting getDeeplinkReady"),yield ai.getDeeplinkReady()),Ca(o,t,s);const i=(0,ca.N6)(e)?`${e.conversationId}/${e.rootMessageId}`:e.meetingData.meetingCode||(e.meetingData.meetingUrl?(e=>{const t=e.split(/[/?&]/);return t[t.indexOf("meet")+1]})(e.meetingData.meetingUrl):void 0);if(!i){const e="[handleDeeplink] Deeplink entity cannot be locked because lockId is undefined";return s.error(e),Promise.reject(e)}s.log("[handleDeeplink] lockDeeplinkEntity"),ai.lockDeeplinkEntity(i)}if(!a)return Promise.resolve(t);if(fa(n,i,a)){const e=a,t=e.toastId,n=e.actionType;return n?r.mutate({mutation:ra,variables:{notificationId:t,actionType:n}}).then((()=>{})).catch((()=>Promise.reject(li.f.CallingToastActionMutationFailed))):Promise.reject(li.f.CallsActionTypeToNotificationActionFailed)}return Promise.resolve(t)})),fa=(e,t,n)=>!!ba(n)&&(!!n.toastId&&e===u.p.calls&&t===u.u.mutate&&"Unknown"!==n.actionType),ya=(e,t,n)=>e===u.p.callingdeeplink&&t===u.u.join&&!!n.isBroadcastMeeting,ba=e=>void 0!==e.toastId,Sa=(e,t)=>e===u.p.callingdeeplink&&t===u.u.join,ka=(e,t)=>e===u.p.meetings&&t===u.u.join,wa=(e,t,n)=>{if(!t.entityOptions||!t.entityOptions.callingIntent){const e=`entityOptions must be of type IMeetingJoinOptions. entity.id=${t.entity.id} - correlationId=${t.command.correlation.id} - source=${t.command.correlation.source}`;return n.error(e),Promise.reject(e)}const{callingIntent:i}=t.entityOptions,{correlation:a}=t.command;return n.log("[handleMeetingJoin] triggering fireCallingIntent mutation"),_a(e,n,i,a.id)},Ca=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!t.entityOptions){const e="[handleDeeplink] No entity options";return n.error(e),Promise.reject(e)}const{correlation:i}=t.command,a=t.entityOptions,{coordinates:o,deeplinkId:r,isWatchParty:s,homeCloud:l}=a;let c;return c=s?(0,da.W5)(r):(0,da.sM)(o,r,l),n.log("[handleDeeplink] triggering fireCallingIntent mutation"),_a(e,n,c,i.id)})),_a=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return e.client.mutate({mutation:sa,variables:{callingIntent:n},context:{correlationId:a}}).then((()=>{t.log("fireCallingIntent succeeded")})).catch((e=>(t.error(`failed to fireCallingintent with ${(0,la.A)(e)}`),Promise.reject(e))))}));var Ta,Ia;!function(e){e[e.Canceled=0]="Canceled",e[e.Failure=1]="Failure",e[e.Incomplete=2]="Incomplete",e[e.Success=3]="Success"}(Ta||(Ta={})),function(e){e.Success="Success",e.Failure="Failure"}(Ia||(Ia={}));const Ea=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:{entity:{type:t,action:n},command:{visibilityState:i}},requestContext:{coreSettings:a,loggerFactory:o}}=e,r=o.newLogger("CallingApp[onCommandResult]","apps-calling"),{enableCallingAppCommandResolvedHook:s}=a.get(L.J.Calling);if(s)return t===u.p.calls&&n===u.u.view&&(r.log(`[onCommandResult] Windowing command with visibilityState: ${i}`),i===d.fe.show)?Na(e):void 0})),Na=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:{entity:{id:t},command:{correlation:{id:n}}},result:i,requestContext:{client:a,loggerFactory:o,scenarioFactory:r,error:s}}=e,l=o.newLogger("CallingApp[onCommandResult]","apps-calling");let c,d;if(i===Ta.Failure){c=Ia.Failure;const e=t?r.findScenarioByNameAndId(it.RG.CallingWindowPopoutIntent,t):void 0;null==e||e.mark("OnAfterCommandResolved"),null==e||e.appendEventData({errorCode:(null==s?void 0:s.errorCode)||he.jK.CallingCallsViewCommandError,message:(null==s?void 0:s.errorMessage)||"[onCommandResult] Window Rendering command for a call resulted in Failure or Incomplete.",context:"CallingApp"}),d=Aa(c,n,t,s)}else c=Ia.Success,d=Aa(c,n,t);try{yield ri(d,a,l)}catch(s){throw l.error(`[handleCallingWindowingContentEvent] Error when reporting event "${c}" [entity.id=${t}, error.name=${s.name}, error.message=${s.message}]`),new Error(`onCommandResult[error.name=${s.name},error.message=${s.message}]::resolveCallingAppEvent::${c}`)}})),Aa=(e,t,n,i)=>e===Ia.Success?{eventId:t,resolution:{success:{_:!0}},context:{source:{name:C.BHj.WindowingCommandingSuccess,description:`Windowing command resolved successfully [eventId=${t}, entity.id=${n}]`}}}:{eventId:t,resolution:{error:{name:(null==i?void 0:i.errorCode)||he.jK.CallingCallsViewCommandError,message:(null==i?void 0:i.errorMessage)||`[onCommandResult] calls-view command resolved with an error [eventId=${t}][entity.id=${n}]`}},context:{source:{name:C.BHj.WindowingCommandingTriggerError,description:`Error processing windowing command [eventId=${t}, entity.id=${n}, error.errorCode=${null==i?void 0:i.errorCode}, error.message=${null==i?void 0:i.errorMessage}]`}}};var Fa=n(28846);const Da=e=>{const{entity:{type:t,action:n}}=e;if(t===u.p.calls&&n===u.u.view)return it.RG.CallingEntityCommandCallsView};var Ra=n(806863),xa=n(409191);const Ma=(0,n(828074).s)({isWebCallMonitorWrapper:{Bbmb7ep:["fclariu","fyjfh2l"],Beyfa6y:["fyjfh2l","fclariu"],B7oj6ja:["f11xeu6h","f1knf8zw"],Btl43ni:["f1knf8zw","f11xeu6h"],B4j52fo:"ftac7j7",Bekrc4i:["f1w0yd9v","f1h0xgbp"],Bn0qgzm:"fdwcyh7",ibv6hh:["f1h0xgbp","f1w0yd9v"],icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"fgybt4j",h3c5rm:["fm8sagc","f10vrri"],B9xav0g:"f1pr7p4w",zhjwy3:["f10vrri","fm8sagc"],Bqenvij:"fk3a66p",a9b677:"fly5x3f"},isWebCallMonitorUbar:{a9b677:"fly5x3f",Bqenvij:"fyhdfh7"},isWebCallMonitorCallingScreen:{a9b677:"fly5x3f",Bqenvij:"f1l02sjl"}},{d:[".fclariu{border-bottom-right-radius:3px;}",".fyjfh2l{border-bottom-left-radius:3px;}",".f11xeu6h{border-top-right-radius:3px;}",".f1knf8zw{border-top-left-radius:3px;}",".ftac7j7{border-top-width:2px;}",".f1w0yd9v{border-right-width:2px;}",".f1h0xgbp{border-left-width:2px;}",".fdwcyh7{border-bottom-width:2px;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".fgybt4j{border-top-color:var(--colorStrokeFocus2);}",".fm8sagc{border-right-color:var(--colorStrokeFocus2);}",".f10vrri{border-left-color:var(--colorStrokeFocus2);}",".f1pr7p4w{border-bottom-color:var(--colorStrokeFocus2);}",".fk3a66p{height:25.7rem;}",".fly5x3f{width:100%;}",".fyhdfh7{height:7.2rem;}",".f1l02sjl{height:100%;}"]}),Oa=({ubar:e,callingScreen:t})=>{const n=Ma();return o.createElement(Ra.k,{"data-tid":"floating-call-monitor",column:!0,className:n.isWebCallMonitorWrapper},o.createElement(xa.W,{className:n.isWebCallMonitorUbar},e),o.createElement(xa.W,{className:n.isWebCallMonitorCallingScreen},t))},Pa=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(899405),n.e(287783),n.e(168904),n.e(522024),n.e(511402),n.e(274690),n.e(598731),n.e(533157),n.e(679306),n.e(990255),n.e(922724),n.e(623025),n.e(579814),n.e(110350),n.e(709528),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(507328),n.e(890770),n.e(105578),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(279439),n.e(510510),n.e(645508),n.e(842905),n.e(327119),n.e(376488),n.e(785918),n.e(467007),n.e(53807),n.e(506205),n.e(613306),n.e(179947),n.e(495570),n.e(774660),n.e(803120),n.e(790141),n.e(730579),n.e(771478),n.e(584751),n.e(232577),n.e(594881),n.e(974743),n.e(812070),n.e(786261),n.e(634075),n.e(271197),n.e(770326)]).then(n.bind(n,469484)),La=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(899405),n.e(287783),n.e(168904),n.e(522024),n.e(511402),n.e(274690),n.e(598731),n.e(533157),n.e(679306),n.e(990255),n.e(922724),n.e(623025),n.e(579814),n.e(110350),n.e(709528),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(507328),n.e(890770),n.e(105578),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(279439),n.e(510510),n.e(645508),n.e(842905),n.e(327119),n.e(376488),n.e(785918),n.e(467007),n.e(53807),n.e(506205),n.e(613306),n.e(179947),n.e(495570),n.e(774660),n.e(803120),n.e(790141),n.e(730579),n.e(771478),n.e(584751),n.e(232577),n.e(594881),n.e(974743),n.e(812070),n.e(786261),n.e(634075),n.e(271197),n.e(770326)]).then(n.bind(n,241974)),Ua=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(899405),n.e(287783),n.e(168904),n.e(522024),n.e(511402),n.e(274690),n.e(598731),n.e(533157),n.e(679306),n.e(990255),n.e(922724),n.e(623025),n.e(579814),n.e(110350),n.e(709528),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(507328),n.e(890770),n.e(105578),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(279439),n.e(510510),n.e(645508),n.e(842905),n.e(327119),n.e(376488),n.e(785918),n.e(467007),n.e(53807),n.e(506205),n.e(613306),n.e(179947),n.e(495570),n.e(774660),n.e(803120),n.e(790141),n.e(730579),n.e(771478),n.e(584751),n.e(232577),n.e(594881),n.e(974743),n.e(812070),n.e(786261),n.e(634075),n.e(271197),n.e(770326)]).then(n.bind(n,697633)),ja="calling-app-LPC",$a="calling-app",Ba=({appRenderMode:e,coreSettings:t,host:n,isHeader:a,isMainPanel:o,logger:r,onRenderEvent:l,scenarioFactory:d})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){r.log(`renderWithLPC: import LPC: isMainPanel=${o} isHeader=${a}`);const{enableCallingAppChunkLoadEventLog:i}=t.get(L.J.Calling),u=(0,c.mT)(Ua,i?ja:$a,d);if(e===s.S.Main){l("ChunkLoadStarted",i?{chunkName:ja}:{chunkName:$a});const{chunkLoadTimerPromise:e,chunkLoadTimer:s}=(({coreSettings:e,host:t})=>{let n=0;return{chunkLoadTimerPromise:new Promise(((i,a)=>{let{chunkLoadTimeout:o}=e.get(L.J.Calling);o||(o=Number.MAX_SAFE_INTEGER),n=t.setTimeout(a,o,(0,An.Tr)("CallingApp",he.jK.ChunkLoadTimedOut,"renderMain"))})),chunkLoadTimer:n}})({coreSettings:t,host:n});yield Promise.race([u,e]).then((()=>clearTimeout(s))).catch((e=>{throw r.error(`renderWithLPC: ChunkLoadTimedOut: isMainPanel=${o} isHeader=${a}`),e})),l("ChunkLoadSucceeded",i?{chunkName:ja}:{chunkName:$a})}const{LPC:m}=yield u;return r.log(`renderWithLPC: construct the slot element: isMainPanel=${o} isHeader=${a}`),m})),Wa=({coreServices:e,host:t,isResize:n,entityType:i,windowOptions:a})=>{var o,r;const{minHeight:s,minWidth:l}=(null===(o=oa.windowFeatures)||void 0===o?void 0:o.otherEntityTypes)||{},c=null==t?void 0:t.screen;if(i===u.p.callsmonitor)return(({host:e,windowOptions:t,coreServices:n})=>{var i,a;const o=null!==(a=Object.assign({},null===(i=oa.windowFeatures)||void 0===i?void 0:i[u.p.callsmonitor]))&&void 0!==a?a:{},r={width:o.width||0,height:o.height||0};return t&&(r.width=t.width||r.width,r.height=t.height||r.height),!!(null==n?void 0:n.coreSettings.get(L.J.Calling,["disableContentprotection"]).disableContentprotection)&&o.additionalFeatures&&(o.additionalFeatures=Object.assign(Object.assign({},o.additionalFeatures),{contentprotection:"false"})),e&&e.screen&&r.width&&r.height&&(o.top=0===(null==t?void 0:t.top)||(null==t?void 0:t.top)?t.top:e.screen.availHeight-(r.height+100),o.left=0===(null==t?void 0:t.left)||(null==t?void 0:t.left)?t.left:e.screen.availWidth-(r.width+100)),Object.assign(Object.assign({},o),r)})({host:t,windowOptions:a,coreServices:e});if(n&&!c)return(null===(r=oa.windowFeatures)||void 0===r?void 0:r.otherEntityTypes)||null;if(!c)return null;let{height:d=1,width:m=1}=((e,t)=>{var n,i;const{minHeight:a=0,minWidth:o=0}=(null===(n=oa.windowFeatures)||void 0===n?void 0:n.otherEntityTypes)||{};let{width:r,height:s}=(null===(i=oa.windowFeatures)||void 0===i?void 0:i.otherEntityTypes)||{};if(!t)return{height:s,width:r,minHeight:a,minWidth:o};const{orientation:{type:l}}=e,{landscapeScreenRatio:c,portraitScreenRatio:d,widthHeightRatio:u}=t.coreSettings.get(L.J.Calling);if(c&&d&&u)switch(l){case"landscape-primary":case"landscape-secondary":const t=c*e.availHeight;s=t>a?t:a,r=u*s;break;case"portrait-primary":case"portrait-secondary":const n=d*e.availWidth;r=n>o?n:o,s=1/u*r}return{height:s,width:r}})(c,e);const g=c.availHeight-20,p=m>=c.availWidth||d>=g;p&&(d=c.availHeight,m=c.availWidth);const{left:v,top:h}=((e,t,n,i,a)=>{if(i)return{left:0,top:0};const o="availLeft"in e?e.availLeft:0,r="availTop"in e?e.availTop:0,s=o+e.availWidth/2-t/2;let l;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":l=r+a;break;default:l=r+e.availHeight/2-n/2}return{left:s,top:l}})(c,m,d,p,20);return{additionalFeatures:{minHeight:`${s}`,minWidth:`${l}`},height:d,width:m,fullScreen:p,left:v,top:h,minHeight:s,minWidth:l}},Ha=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{logger:t,scenarioFactory:n,isMainPanel:i,isHeader:a,isModal:o,coreSettings:r,onRenderEvent:s}=e,{enableCallingAppChunkLoadEventLog:l}=r.get(L.J.Calling);l&&s("ChunkLoadStarted",{chunkName:$a}),t.log(`render: import the necessary subcomponents: isMainPanel=${i} isHeader=${a} isModal=${o}`);const[{CallingViewsRenderer:d},{CallingContextProvider:u}]=yield Promise.all([(0,c.mT)(Pa,$a,n),(0,c.mT)(La,$a,n)]);return l&&s("ChunkLoadSucceeded",{chunkName:$a}),{CallingViewsRenderer:d,CallingContextProvider:u}})),Va=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{isMainPanel:t,isHeader:n,isModal:i,logger:a,conveneHostMessaging:r}=e,{CallingViewsRenderer:s,CallingContextProvider:l}=yield Ha(e);return a.log(`render: construct the slot element: isMainPanel=${t} isHeader=${n} isModal=${i}`),(null==r?void 0:r.isInEmbedContext())?o.createElement(Ga,null,o.createElement(l,null,o.createElement(Oe.yx,{conveneHostMessaging:r},o.createElement(s,{isMainPanel:t,isHeader:n,isModal:i})))):o.createElement(Ga,null,o.createElement(l,null,o.createElement(s,{isMainPanel:t,isHeader:n,isModal:i})))})),za=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var{appRenderMode:t,loggerFactory:n,host:a,scenarioFactory:r}=e,l=(0,i.__rest)(e,["appRenderMode","loggerFactory","host","scenarioFactory"]);if(t===s.S.HorizontalBar||t===s.S.Main){const e=n.newLogger("CallingApp","apps-calling"),i=t===s.S.HorizontalBar;return Va(Object.assign({isMainPanel:!0,isHeader:i,isModal:!1,logger:e,scenarioFactory:r,appRenderMode:t,host:a},l))}return o.createElement(Fa.e,null)}));function qa(e){return{eventHandlers:qi,getAppPhases:Gi,getAppViewEntities:Qi,getAppViewEntitiesProps:ia,getAppWindowFeatures:Wa,getCommandScenarioName:Da,manifest:oa,render:t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var{appRenderMode:n,entity:a,loggerFactory:r}=t,l=(0,i.__rest)(t,["appRenderMode","entity","loggerFactory"]);const c=r.newLogger("CallingApp","apps-calling");if(a.type===u.p.floatingmonitor)return d=Object.assign({appRenderMode:n,entity:a,loggerFactory:r},l),(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var{loggerFactory:e,entity:t,appRenderMode:n}=d,a=(0,i.__rest)(d,["loggerFactory","entity","appRenderMode"]);const[r,l]=yield Promise.all([za(Object.assign({appRenderMode:s.S.HorizontalBar,entity:t,loggerFactory:e},a)),za(Object.assign({appRenderMode:s.S.Main,entity:t,loggerFactory:e},a))]);return o.createElement(Oa,{ubar:r,callingScreen:l})}));var d,m;if(a.type===u.p.callsmonitor)return za(Object.assign({appRenderMode:n,entity:a,loggerFactory:r},l));if(n===s.S.HorizontalBar||n===s.S.Modal){const t=n===s.S.HorizontalBar,i=n===s.S.HorizontalBar,a=n===s.S.Modal;return Va(Object.assign({conveneHostMessaging:e,isMainPanel:t,isHeader:i,isModal:a,logger:c,appRenderMode:n},l))}if(n===s.S.Main||n===s.S.Rail){const t=n===s.S.Main,a=!1,r=!1;return m=Object.assign({conveneHostMessaging:e,isMainPanel:t,isHeader:a,isModal:r,appRenderMode:n,logger:c},l),(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{isMainPanel:e,isHeader:t,isModal:n,logger:i,coreSettings:a,conveneHostMessaging:r}=m,{CallingViewsRenderer:s,CallingContextProvider:l}=yield Ha(m);i.log(`render: construct the slot element: isMainPanel=${e} isHeader=${t} isModal=${n}`);const{enableEntityMoreInfo:c=!1}=a.get(L.J.Core),d=({children:e})=>o.createElement(o.Fragment,null,e),u=c?d:yield Ba(m),g=c?d:vn.p3;return(null==r?void 0:r.isInEmbedContext())?o.createElement(Ga,null,o.createElement(u,null,o.createElement(g,null,o.createElement(Oe.yx,{conveneHostMessaging:r||Oe.Id},o.createElement(l,null,o.createElement(s,{isMainPanel:e,isHeader:t,isModal:n})))))):o.createElement(Ga,null,o.createElement(u,null,o.createElement(g,null,o.createElement(l,null,o.createElement(s,{isMainPanel:e,isHeader:t,isModal:n})))))}))}return o.createElement(Fa.e,null)})),onPreWarm:Ri,onPreInit:xi,onBeforeAddToNavigation:Hi,onBeforeCommandHandled:ha,onBeforeDeeplinkParsed:Wi,onCommandResult:Ea}}const Ga=({children:e})=>o.createElement(l.f,{namespaces:["calling","broadcast","extensibility","hololens","messaging","meetingOptions","datepicker"],loaderRenderer:null},e);var Ja=n(585478);const Qa="shell",Ka="showToast",Ya="updateProfilePicture",Xa="updateDisplayName",Za=e=>({actor:Qa,action:Ka,data:e}),eo=()=>({actor:Qa,action:Ya}),to=()=>({actor:Qa,action:Xa}),no="People",io="LivePersonaEditor",ao="viewPeopleApp",oo="openLivePersonaEditorDialog",ro=e=>({actor:io,action:oo,data:e}),so=()=>({actor:no,action:ao});var lo=n(138);const co={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallsMainSetSpeedDialMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"setSpeedDialSystemTagInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SetSpeedDialSystemTagInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setSpeedDialSystemTag"},arguments:[{kind:"Argument",name:{kind:"Name",value:"setSpeedDialSystemTagInput"},value:{kind:"Variable",name:{kind:"Name",value:"setSpeedDialSystemTagInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SetSpeedDialSystemTagMutationSuccess"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"successMessage"}},{kind:"Field",name:{kind:"Name",value:"edge"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cursor"}},{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OneGQL_Person"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"contactId"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonOneGqlPersonFragment"}}]}}]}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SpeedDialContactsError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorMessage"}}]}}]}}]}},...n(66556).W.definitions]};var uo=n(398291);const mo={onEventReceived:({eventInput:{event:e},requestContext:t})=>{const n=t.loggerFactory.newLogger("CallsApp onEventReceived","apps-calling");return go(e)?Promise.resolve({command:mn(e.data())}):(0,lo.Pu)(e)?Promise.resolve({command:ro(e.data())}):(0,lo.Gr)(e)?((e,t,n)=>e.mutate({mutation:co,variables:{setSpeedDialSystemTagInput:t},update(e,{data:{setSpeedDialSystemTag:i}}){n.log(`Speed dial cache updating. Mutation result: [setSpeedDialSystemTag.__typename=${i.__typename}]`),"SetSpeedDialSystemTagMutationSuccess"===i.__typename&&(0,uo.m)(e,i.edge,t.setIsSpeedDialContact,n),n.log("Speed dial cache updated")}}))(t.client,e.data(),n).then((({data:e})=>({command:Za({title:"SetSpeedDialSystemTagMutationSuccess"===e.setSpeedDialSystemTag.__typename?e.setSpeedDialSystemTag.successMessage:e.setSpeedDialSystemTag.errorMessage,intent:"SetSpeedDialSystemTagMutationSuccess"===e.setSpeedDialSystemTag.__typename?C.GSK.Success:C.GSK.Error,dismissOnAction:!0,duration:3e3})}))):Promise.resolve(void 0)}},go=e=>e.type===ln.uS.requestPersonMoreInfo,po=e=>{if(vo(e))return ho(e)?{subNavEntity:fo(e),headerEntity:yo(e),startEntity:bo(e),mainEntity:So(e),endEntity:ko(e)}:null},vo=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.callsmain,u.p.locationnotification].includes(i),r=n&&[u.u.create,u.u.default,u.u.list,u.u.view].includes(n);return!!(a&&o&&r)},ho=()=>!0,fo=()=>null,yo=({entity:e})=>e,bo=()=>null,So=({entity:e})=>e,ko=()=>null,wo="calls-main",Co="viewCallsMainApp",_o="markAllAsRead",To=()=>({actor:wo,action:Co}),Io=()=>({actor:wo,action:_o}),Eo={id:"com.microsoft.teams.callsmain",name:"CallsMain",actors:[wo],supportedEntities:[u.p.callsmain,u.p.locationnotification],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail,s.S.Modal],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600},getDefaultCommand:()=>({type:u.p.callsmain,action:u.u.view})},No=({appRenderMode:e,coreSettings:t})=>{const{callsAppPhaseTimeouts:n,enableCallsAppPhaseStateMachine:i}=t.get(L.J.Calling),a=new ht.H;if(!i)return a.appPhases;const o=[],r=[];switch(e){case s.S.Main:o.push(ft.GZ.DIALPAD_RENDERED),r.push(ft.GZ.CALL_GROUP_OWNERS_RENDERED),r.push(ft.GZ.CALL_FORWARDING_SETTINGS_RENDERED),r.push(ft.GZ.AUDIO_DEVICE_SETTINGS_RENDERED),o.push(ft.GZ.CALL_HISTORY_RENDERED),o.push(ft.GZ.SPEED_DIAL_RENDERED)}return a.registerAppPhase({phase:ft.nh.CRITICAL,signals:o,timeout:(null==n?void 0:n.critical)||1e4}),a.registerAppPhase({phase:ft.nh.POST_CRITICAL,signals:r,timeout:(null==n?void 0:n.postCritical)||1e4}),a.appPhases},Ao={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallsMainMarkAllCallsAsReadMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markMissedCallsAsRead"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActivityReadStatusUpdateError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorFaced"}}]}}]}}]}}]},Fo=({commandInput:e,requestContext:{loggerFactory:t,client:n}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const{command:{action:a}}=e,o=t.newLogger("CallsMainApp onCommandReceived","apps-calling");if(e.command.actor===wo)switch(a){case Co:return{entity:{type:u.p.callsmain,action:u.u.view},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.Unknown}}};case _o:return null===(i=o.infoToTelemetry)||void 0===i||i.call(o,"[UI]: marking all missed calls as read","calling_badge",void 0,!0),void n.mutate({mutation:Ao}).then((({data:e})=>{var t,n,i;const a=null===(t=null==e?void 0:e.markMissedCallsAsRead)||void 0===t?void 0:t.errorFaced;a?null===(n=o.errorToTelemetry)||void 0===n||n.call(o,`[UI]: marking all as read action failed: ${a}.`,"calling_badge",void 0,!0):null===(i=o.infoToTelemetry)||void 0===i||i.call(o,"[UI]: successfully marked all missed calls as read","calling_badge",void 0,!0)})).catch((e=>{var t;null===(t=o.errorToTelemetry)||void 0===t||t.call(o,`[UI]: marking all as read action failed: ${e.message}.`,"calling_badge",void 0,!0)}));default:o.error(`Command action '${a}' is not supported at CallsMainApp.`)}else o.error(`Command for actor '${e.command.actor}' cannot be handled by CallsMainApp.`)})),Do=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(259196),n.e(86052),n.e(302711),n.e(636762),n.e(499057),n.e(603286),n.e(836870),n.e(213104),n.e(384420),n.e(49750),n.e(181896),n.e(95235),n.e(803466),n.e(623025),n.e(579814),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(61627),n.e(4528),n.e(191280),n.e(86048),n.e(29311),n.e(481321),n.e(384848),n.e(674818),n.e(397914),n.e(860125),n.e(628212),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(398949),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(645508),n.e(317689),n.e(842905),n.e(196673),n.e(648558),n.e(764175),n.e(968634),n.e(530658),n.e(926721),n.e(905697),n.e(707902),n.e(858141),n.e(568740)]).then(n.bind(n,713172)),Ro=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(259196),n.e(86052),n.e(302711),n.e(636762),n.e(499057),n.e(603286),n.e(836870),n.e(213104),n.e(384420),n.e(49750),n.e(181896),n.e(95235),n.e(803466),n.e(623025),n.e(579814),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(61627),n.e(4528),n.e(191280),n.e(86048),n.e(29311),n.e(481321),n.e(384848),n.e(674818),n.e(397914),n.e(860125),n.e(628212),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(398949),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(645508),n.e(317689),n.e(842905),n.e(196673),n.e(648558),n.e(764175),n.e(968634),n.e(530658),n.e(926721),n.e(905697),n.e(707902),n.e(858141),n.e(568740)]).then(n.bind(n,547886)),xo=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(259196),n.e(86052),n.e(302711),n.e(636762),n.e(499057),n.e(603286),n.e(836870),n.e(213104),n.e(384420),n.e(49750),n.e(181896),n.e(95235),n.e(803466),n.e(623025),n.e(579814),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(61627),n.e(4528),n.e(191280),n.e(86048),n.e(29311),n.e(481321),n.e(384848),n.e(674818),n.e(397914),n.e(860125),n.e(628212),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(398949),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(645508),n.e(317689),n.e(842905),n.e(196673),n.e(648558),n.e(764175),n.e(968634),n.e(530658),n.e(926721),n.e(905697),n.e(707902),n.e(858141),n.e(568740)]).then(n.bind(n,386157)),Mo=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(259196),n.e(86052),n.e(302711),n.e(636762),n.e(499057),n.e(603286),n.e(836870),n.e(213104),n.e(384420),n.e(49750),n.e(181896),n.e(95235),n.e(803466),n.e(623025),n.e(579814),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(61627),n.e(4528),n.e(191280),n.e(86048),n.e(29311),n.e(481321),n.e(384848),n.e(674818),n.e(397914),n.e(860125),n.e(628212),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(398949),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(645508),n.e(317689),n.e(842905),n.e(196673),n.e(648558),n.e(764175),n.e(968634),n.e(530658),n.e(926721),n.e(905697),n.e(707902),n.e(858141),n.e(568740)]).then(n.bind(n,697633)),Oo=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(259196),n.e(86052),n.e(302711),n.e(636762),n.e(499057),n.e(603286),n.e(836870),n.e(213104),n.e(384420),n.e(49750),n.e(181896),n.e(95235),n.e(803466),n.e(623025),n.e(579814),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(61627),n.e(4528),n.e(191280),n.e(86048),n.e(29311),n.e(481321),n.e(384848),n.e(674818),n.e(397914),n.e(860125),n.e(628212),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(398949),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(645508),n.e(317689),n.e(842905),n.e(196673),n.e(648558),n.e(764175),n.e(968634),n.e(530658),n.e(926721),n.e(905697),n.e(707902),n.e(858141),n.e(568740)]).then(n.bind(n,518678)),Po=()=>Eo.windowFeatures||{},Lo=()=>it.RG.CallsAppSwitch,Uo="calls-main-app";function jo(){const e=()=>null;return{eventHandlers:mo,getAppPhases:No,getAppViewEntities:po,getAppWindowFeatures:Po,getCommandScenarioName:Lo,getPlatformAppIdForEntity:e=>e.type===u.p.callsmain?"20c3440d-c67e-4420-9f80-0e50c39693df":void 0,manifest:Eo,onCommandReceived:Fo,render:({appRenderMode:t,coreSettings:n,onRenderEvent:a,scenarioFactory:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){let i=!0;const d=e=>i=e,{enableLocationNotificationPopup:u}=n.get(L.J.Calling);if(t===s.S.Rail||t===s.S.Main){const e=t===s.S.Main;e&&a("ChunkLoadStarted",{chunkName:Uo}),e&&a("ChunkLoadSucceeded",{chunkName:Uo});const{enableEntityMoreInfo:i}=n.get(L.J.Core),d=({children:e})=>o.createElement(o.Fragment,null,e),{LPC:u}=i?{LPC:d}:yield(0,c.mT)(Mo,Uo,r),m=i?d:vn.p3,[{CallsMainViewsRenderer:g},{CallsTabContextProvider:p}]=yield Promise.all([(0,c.mT)(Do,Uo,r),(0,c.mT)(Ro,Uo,r)]);return o.createElement(l.f,{namespaces:["calling","messaging"],loaderRenderer:null},o.createElement(u,null,o.createElement(m,null,o.createElement(p,null,o.createElement(g,{isMainPanel:e})))))}if(t===s.S.Modal&&u){const e="calls-main-app";a("ChunkLoadStarted",{chunkName:Uo});const{EditEmergencyAddressDialogComponent:t}=yield(0,c.mT)(Oo,e,r);return a("ChunkLoadSucceeded",{chunkName:Uo}),o.createElement(t,{showEditAddressDialog:i,setShowEditAddressDialog:d,moduleName:Ja.rA.emergencyLocationManageLocationButton})}const{enableCallsAppHeader:m}=n.get(L.J.Calling);if(m&&t===s.S.HorizontalBar){a("ChunkLoadStarted",{chunkName:Uo});const[{CallsHeaderRenderer:e},{CallsTabContextProvider:t}]=yield Promise.all([(0,c.mT)(xo,Uo,r),(0,c.mT)(Ro,Uo,r)]);return a("ChunkLoadSucceeded",{chunkName:Uo}),o.createElement(t,null,o.createElement(e,null))}return o.createElement(e,null)}))}}const $o={id:"com.microsoft.teams.cast",name:"CastApp",supportedEntities:[u.p.cast],supportedRenderModes:[s.S.Main],windowFeatures:{width:640,height:720,minWidth:640,minHeight:720}},Bo=e=>{if(Wo(e))return Ho(e)?{subNavEntity:Vo(e),headerEntity:zo(e),startEntity:qo(e),mainEntity:Go(e),endEntity:Jo(e)}:null},Wo=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.cast].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},Ho=()=>!0,Vo=()=>null,zo=()=>null,qo=()=>null,Go=({entity:e})=>e,Jo=()=>null,Qo=()=>({[C.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!1,isThemePinnedToDarkOrHighContrast:!0,UNSAFE_enablePptProvider:!0}}}),Ko={shouldAddEntitiesToWindowHistory:e=>{var t;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.cast},shouldRestoreClientToEntities:()=>!0},Yo=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(698627),n.e(273621),n.e(134315),n.e(687601),n.e(284790),n.e(137434),n.e(450535),n.e(623025),n.e(579814),n.e(110350),n.e(121343),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(9886),n.e(152269),n.e(597003),n.e(437184),n.e(908915),n.e(975421),n.e(546933),n.e(584751),n.e(376657)]).then(n.bind(n,403585)),Xo=({host:e})=>{const t=null==e?void 0:e.screen;if(!t)return{};if(!$o.windowFeatures)return{};const{minHeight:n,minWidth:i}=$o.windowFeatures,{height:a=1,width:o=1}=$o.windowFeatures,{left:r,top:s}=((e,t,n,i)=>{const a=e.availLeft+e.availWidth/2-t/2;let o;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":o=e.availTop+i;break;default:o=e.availTop+e.availHeight/2-n/2}return{left:a,top:o}})(t,o,a,20);return{additionalFeatures:{minHeight:`${n}`,minWidth:`${i}`},height:a,width:o,left:r,top:s,minHeight:n,minWidth:i}};function Zo(){const e=()=>null;return{getAppViewEntities:Bo,getAppViewEntitiesProps:Qo,getAppWindowFeatures:Xo,manifest:$o,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="cast-app";n("ChunkLoadStarted",{chunkName:e});const{CastWizard:t}=yield(0,c.mT)(Yo,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)})),onBeforeAddToNavigation:Ko}}var er,tr=n(490503),nr=n(739582);!function(e){e.quickReply="quickReply",e.unknown="unknown",e.view="view"}(er||(er={}));const ir={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"sendMessage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageAction"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"correlationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendMessage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}},{kind:"Argument",name:{kind:"Name",value:"correlationId"},value:{kind:"Variable",name:{kind:"Name",value:"correlationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},ar={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsChatNotifyActiveContextChangedMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activeContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activeContextType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActiveContextType"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notifyActiveContextChangedToCDLWorker"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activeContextId"},value:{kind:"Variable",name:{kind:"Name",value:"activeContextId"}}},{kind:"Argument",name:{kind:"Name",value:"activeContextType"},value:{kind:"Variable",name:{kind:"Name",value:"activeContextType"}}}]}]}}]};var or=n(778764),rr=n(469929);const sr=e=>{const{entityCommand:t,entityCommand:{entity:{type:n,action:i,id:a},dataOptions:o},requestContext:r}=e,s=r.client;return ur(s,r.coreSettings,n,i,a),lr(s,o,t,n,i)},lr=(e,t,n,i,a)=>t&&cr(i,a)?dr(t)&&t.convId&&t.message?e.mutate({mutation:ir,variables:{convId:t.convId,message:{clientMessageId:(0,or.K)(),messageType:rr.Cs.HTML,content:t.message},action:C.xyM.Create}}).then((()=>{})).catch((()=>Promise.reject(li.f.ChatToastActionMutationFailed))):Promise.reject(li.f.ChatActionTypeToNotificationActionFailed):Promise.resolve(n),cr=(e,t)=>e===u.p.chats&&t===u.u.mutate,dr=e=>e.actionType===er.quickReply,ur=(e,t,n,i,a)=>{t.get(L.J.CdlWorker).enableNotifyActiveContextChangedToCDLWorker&&a&&n===u.p.chats&&i===u.u.view&&e.mutate({mutation:ar,fetchPolicy:"no-cache",variables:{activeContextId:a,activeContextType:C.xz$.chat}})},mr=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(410202),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(287783),n.e(907784),n.e(838608),n.e(168904),n.e(687601),n.e(553211),n.e(522024),n.e(511402),n.e(274690),n.e(860024),n.e(34693),n.e(869519),n.e(674881),n.e(533157),n.e(179826),n.e(92285),n.e(158057),n.e(509379),n.e(853664),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(604068),n.e(507328),n.e(921132),n.e(264630),n.e(319187),n.e(981004),n.e(757839),n.e(820464),n.e(200162),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(398949),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(279439),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(365130),n.e(815768),n.e(644027),n.e(842905),n.e(975421),n.e(248361),n.e(675049),n.e(335938),n.e(327119),n.e(262855),n.e(196673),n.e(354066),n.e(838267),n.e(369687),n.e(64113),n.e(302755),n.e(589835),n.e(181790),n.e(764175),n.e(972813),n.e(757052),n.e(459737),n.e(832078),n.e(191368),n.e(693514),n.e(335085),n.e(612396),n.e(570841),n.e(438912),n.e(255937),n.e(60504),n.e(210834),n.e(528187),n.e(386511),n.e(810439),n.e(613732),n.e(481647)]).then(n.bind(n,320144)),gr=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(410202),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(287783),n.e(907784),n.e(838608),n.e(168904),n.e(687601),n.e(553211),n.e(522024),n.e(511402),n.e(274690),n.e(860024),n.e(34693),n.e(869519),n.e(674881),n.e(533157),n.e(179826),n.e(92285),n.e(158057),n.e(509379),n.e(853664),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(604068),n.e(507328),n.e(921132),n.e(264630),n.e(319187),n.e(981004),n.e(757839),n.e(820464),n.e(200162),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(398949),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(279439),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(365130),n.e(815768),n.e(644027),n.e(842905),n.e(975421),n.e(248361),n.e(675049),n.e(335938),n.e(327119),n.e(262855),n.e(196673),n.e(354066),n.e(838267),n.e(369687),n.e(64113),n.e(302755),n.e(589835),n.e(181790),n.e(764175),n.e(972813),n.e(757052),n.e(459737),n.e(832078),n.e(191368),n.e(693514),n.e(335085),n.e(612396),n.e(570841),n.e(438912),n.e(255937),n.e(60504),n.e(210834),n.e(528187),n.e(386511),n.e(810439),n.e(613732),n.e(481647)]).then(n.bind(n,697633)),pr=({action:e,appRenderMode:t,coreSettings:n,type:i})=>{const a=new ht.H,{isHeaderDisabled:o=!1}=n.get(L.J.Core),{chatAppPhaseTimeouts:r,enableComposeCriticalPhaseLoad:l=!1,enableComposeCriticalPhaseLoadSecondaryViewport:c=!1,enableComposeCriticalPhaseLoadSecondaryViewportGate:d=!1}=n.get(L.J.Messaging),u=[],m=[];switch(t){case s.S.HorizontalBar:vr({criticalSignals:u,featureFlags:{isHeaderDisabled:o},postCriticalSignals:m,type:i});break;case s.S.Main:hr({action:e,criticalSignals:u,featureFlags:{enableComposeCriticalPhaseLoad:l},postCriticalSignals:m,type:i});break;case s.S.Rail:fr({action:e,criticalSignals:u,featureFlags:{enableComposeCriticalPhaseLoad:l,enableComposeCriticalPhaseLoadSecondaryViewport:c,enableComposeCriticalPhaseLoadSecondaryViewportGate:d},postCriticalSignals:m})}return a.registerAppPhase({phase:ft.nh.CRITICAL,signals:u,timeout:(null==r?void 0:r.critical)||6e4}),a.registerAppPhase({phase:ft.nh.POST_CRITICAL,signals:m,timeout:(null==r?void 0:r.postCritical)||1e4}),a.appPhases},vr=({featureFlags:{isHeaderDisabled:e},criticalSignals:t,postCriticalSignals:n,type:i})=>{i!==u.p.chatschannelconv?(!e&&t.push(ft.GZ.CHAT_HEADER_TITLE_RENDERED),!e&&n.push(ft.GZ.CHAT_HEADER_BUTTONS_RENDERED)):t.push(ft.GZ.CHANNEL_HEADER_RENDERED)},hr=({action:e,criticalSignals:t,featureFlags:{enableComposeCriticalPhaseLoad:n},postCriticalSignals:i,type:a})=>{if(e===u.u.join)return;if(a===u.p.chatschannelconv){t.push(ft.GZ.MESSAGES_RENDERED);return n?t.push(ft.GZ.COMPOSE_LOADED):i.push(ft.GZ.COMPOSE_LOADED),void i.push(ft.GZ.MESSAGE_REACTIONS_RENDERED,ft.GZ.PRESENCES_RENDERED,ft.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED)}t.push(ft.GZ.MESSAGES_RENDERED);const o=n;o&&t.push(ft.GZ.COMPOSE_LOADED),i.push(ft.GZ.MESSAGE_REACTIONS_RENDERED,ft.GZ.PRESENCES_RENDERED,ft.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED),!o&&i.push(ft.GZ.COMPOSE_LOADED)},fr=({action:e,criticalSignals:t,featureFlags:{enableComposeCriticalPhaseLoad:n,enableComposeCriticalPhaseLoadSecondaryViewport:i,enableComposeCriticalPhaseLoadSecondaryViewportGate:a},postCriticalSignals:o})=>{if(e===u.u.list)t.push(ft.GZ.CHAT_LIST_ITEMS_RENDERED),o.push(ft.GZ.PRESENCES_RENDERED);else if(e===u.u.view){t.push(ft.GZ.MESSAGES_RENDERED);const e=a&&i,r=n||e;r&&t.push(ft.GZ.COMPOSE_LOADED),o.push(ft.GZ.MESSAGE_REACTIONS_RENDERED,ft.GZ.PRESENCES_RENDERED,ft.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED),!r&&o.push(ft.GZ.COMPOSE_LOADED)}},yr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"discardDuringMeetingsAndCalls"}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"members"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"parentEntityTitle"}},{kind:"Field",name:{kind:"Name",value:"reaction"}},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderDecoratedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderGivenName"}},{kind:"Field",name:{kind:"Name",value:"senderId"}},{kind:"Field",name:{kind:"Name",value:"subtype"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"topic"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"fromExternalUser"}},{kind:"Field",name:{kind:"Name",value:"activityId"}},{kind:"Field",name:{kind:"Name",value:"isUrgent"}}]}}]}}]};var br,Sr;!function(e){e.GroupMessage="GroupMessage",e.Message="Message",e.Mention="Mention",e.Reaction="Reaction",e.InviteJoined="InviteJoined",e.TeamsTasks="TeamsTasks",e.Reminder="Reminder",e.Priority="Priority",e.DLP="DLP"}(br||(br={})),function(e){e.Small="HR64x64"}(Sr||(Sr={}));const kr="topic",wr="text",Cr="buttonText";var _r=n(960733);const Tr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},Ir={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaGroupProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaGroupProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"msaGroupInfo"},value:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}]}]}}]},Er={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"toastImageAsDataUri"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};var Nr=n(862696);const Ar={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsChatEmoticonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchEmoticons"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchFilter"},value:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}}},{kind:"Argument",name:{kind:"Name",value:"exactMatch"},value:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}}},{kind:"Argument",name:{kind:"Name",value:"includeShortCuts"},value:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}}},{kind:"Argument",name:{kind:"Name",value:"includeKeywords"},value:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}}},{kind:"Argument",name:{kind:"Name",value:"maxResultCount"},value:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}}},{kind:"Argument",name:{kind:"Name",value:"categoryId"},value:{kind:"Variable",name:{kind:"Name",value:"categoryId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsChatEmoticonFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsChatEmoticonFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"unicode"}},{kind:"Field",name:{kind:"Name",value:"animation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsChatEmoticonFragment_animation"}}]}},{kind:"Field",name:{kind:"Name",value:"etag"}},{kind:"Field",name:{kind:"Name",value:"diverse"}},{kind:"Field",name:{kind:"Name",value:"shortcuts"}},{kind:"Field",name:{kind:"Name",value:"searchMatch"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsChatEmoticonFragment_animation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fps"}},{kind:"Field",name:{kind:"Name",value:"framesCount"}},{kind:"Field",name:{kind:"Name",value:"firstFrame"}}]}}]}.definitions]}.definitions]};var Fr=n(556569),Dr=n(604572),Rr=n(876256),xr=n(209497);function Mr(e,t){const n=e.senderGivenName||e.senderDisplayName||jr(t);if(e.subtype)return t.stringTranslate("toastNotifications","new_task_list_added_toast_title",{sender:n})}function Or(e,t){const n=function(e,t){var n,i;const a=t.topic;if(a)return a;if(!(null===(n=t.members)||void 0===n?void 0:n.length))return;return null===(i=os(e,t.members))||void 0===i?void 0:i.displayName}(e,t);return t.subtype===xr.YQ.tFLPlanCreated&&n&&t.text?e.stringTranslate("toastNotifications","task_list_in_group_chat_added_text",{groupChatTitle:n,taskListTitle:t.text}):t.text||void 0}function Pr(e,t,n){const{enableInviteeJoinedActivity:i}=n.get(L.J.Activity),a=Ur(e,i?t.senderDisplayName:t.senderGivenName);return e.stringTranslate("toastNotifications",i?"toast_invite_joined_with_activity_feed_title":"toast_invite_joined",{sender:a})}function Lr(e,t,n,i){const{enableInviteeJoinedActivity:a}=i.get(L.J.Activity);if(a){const t=Ur(e,n.senderDisplayName);return e.stringTranslate("toastNotifications","toast_invite_joined_with_activity_feed_text",{sender:t})}return n.members&&n.members.length?n.topic||t(e,n.members):void 0}function Ur(e,t){return t||jr(e)}function jr(e){return e.stringTranslate("toastNotifications","toast_unknown_user")}var $r=n(223875),Br=n(679907),Wr=n(847263);function Hr(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{if(n.type===br.Priority)return t.log(`${li.f.ReturningHardcodedImage}: Returning default priority message avatar for toast ${n.correlationId}`),$r.ap;if(n.type===br.DLP)return t.log(`${li.f.ReturningHardcodedImage}: Returning default dlp message avatar for toast ${n.correlationId}`),$r.Uw;if(1===(null===(a=n.members)||void 0===a?void 0:a.length)&&n.type===br.GroupMessage)return t.log(`${li.f.ReturningHardcodedImage} Returning default group message avatar for toast ${n.correlationId} as there is just one member`),$r.dA;const o=n.type===br.GroupMessage?yield function(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!(null===(n=t.members)||void 0===n?void 0:n.length))return null;const{data:i}=yield e.query({query:Ir,variables:{msaGroupInfo:{pictureReadyUsers:t.members.map((({id:e,displayName:t})=>({userId:e,displayName:t}))).slice(0,Nr.gT.FOUR),conversationId:t.conversationId}}});return i.msaGroupProfilePicture}))}(e,n):yield function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{data:n}=yield e.query({query:Tr,variables:{userId:t.senderId,displayName:t.senderDisplayName,profilePictureSize:Sr.Small}});return n.msaUserProfilePicture}))}(e,n);if(!o)return void t.error(li.f.ImageUrlGenerationFailed);const r=yield e.query({query:Er,variables:{url:o}}),s=null==r?void 0:r.data.toastImageAsDataUri;return s?(t.log(li.f.ReturningFetchedImage),t.log(`Returning fetched image for toast ${n.correlationId}`),s):void t.error(li.f.ToastImageAsDataUriIsUndefined)}catch(e){return void t.error(li.f.ImageFetchFailed)}}))}function Vr(e,t){const{i18n:n,missedConversationsNumber:i,sender:a,otherSenders:o}=t;switch(e){case kr:return o>=1?n.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_group_topic",{sender:a,otherSenders:o}):n.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_topic",{sender:a});case Cr:return n.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_button_text");case wr:default:return n.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_text",{number:i})}}function zr(e,t,n){const{enableToastMediaTextPreview:i}=e.get(L.J.Notifications);return n.interopConversationStatus===rr.uI.AcceptPending||n.interopConversationStatus===rr.uI.ExtendedDirectoryAcceptPending?t.stringTranslate("people","invite_free_quarantined_notification_content"):i?qr(t,n):Gr(n.text||"")}function qr(e,t){switch(t.contentType){case Wr.zc.FILE:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_file");case Wr.zc.VOICE:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_voice_message");case Wr.zc.IMAGE:return e.stringTranslate("toastNotifications","toast_messaging_sent_an_image");case Wr.zc.LOCATION:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_location_message");case Wr.zc.VIDEO:return e.stringTranslate("toastNotifications","toast_messaging_sent_an_video");default:return Gr(t.text||"")}}function Gr(e){const t=(0,Dr.S)(e,!0).trim().replace(/\s\s+/g," ");return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&quot;/g,'"')}function Jr(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(o.log(`${li.f.MappingCommandOptions}: Generating command options for type ${n.type}`),n.type){case br.Message:case br.Priority:return function(e,t,n){return Object.assign(Object.assign(Object.assign({},ts(n)),es(t,n.interopConversationStatus)),{text:zr(e,t,n),title:Qr(t,n),isUrgent:!!n.isUrgent})}(e,t,n);case br.GroupMessage:return function(e,t,n){return Object.assign(Object.assign(Object.assign({},ts(n)),es(t,n.interopConversationStatus)),{text:Xr(e,t,n),title:n.topic||as(t,n.members)})}(e,t,n);case br.Mention:case br.Reaction:return function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const o=t.type===br.Reaction?yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const{id:t}=(0,Br.M)(null==n?void 0:n.toLocaleLowerCase().trim());if(!t)return;const{data:i}=yield e.query({query:Ar,variables:{searchFilter:t,exactMatch:!0}});return((null==i?void 0:i.searchEmoticons)||[])[0]}catch(e){return void t.error(li.f.ChatToastEmoticonsQueryFailed)}}))}(n,a,t.reaction):void 0;return Object.assign(Object.assign({},ts(t)),{text:t.topic||is(e,t.senderGivenName||t.senderDisplayName,t.members),isUrgent:!!t.isUrgent,title:Kr(e,t,(null==o?void 0:o.unicode)||void 0)})}))}(t,n,a,o);case br.InviteJoined:return function(e,t,n){return Object.assign(Object.assign({},ts(n)),{text:Lr(t,as,n,e),title:Pr(t,n,e)})}(e,t,n);case br.TeamsTasks:return function(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const r=yield function(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!a)return;const i=yield e.query({query:Rr.br,variables:{id:n,queryType:C.rtK.QueryByThread},fetchPolicy:"network-only"}).catch((()=>{t.error(li.f.ChatTabsFetchFailed)})),r=null===(o=null==i?void 0:i.data.platformTabs)||void 0===o?void 0:o.find((e=>(null==e?void 0:e.entityId)&&(null==e?void 0:e.entityId.toLowerCase().includes(a.toLowerCase()))));return r||t.log(li.f.ToastNavigationDataNotFound),r}))}(n,a,t.conversationId,t.tabId);return Object.assign(Object.assign({},ts(t)),{text:Or(e,t)||"",title:null!==(o=Mr(t,e))&&void 0!==o?o:"",type:br.TeamsTasks,tabId:JSON.stringify({tabId:null==r?void 0:r.baseInfo.id,threadId:t.conversationId,appId:null==r?void 0:r.baseInfo.appId,tabEntityId:null==r?void 0:r.entityId})})}))}(t,n,a,o);case br.DLP:return function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},ts(t)),{text:t.topic||ns(e,t.displayName||t.senderDisplayName,t.members),isUrgent:!!t.isUrgent,title:Yr(e,t)})}))}(t,n);default:return}}))}function Qr(e,t){const n=Zr(e,t),i=t.fromExternalUser&&t.senderDecoratedDisplayName;return Fr.eo.isTFLSmsMri(t.senderId)?e.stringTranslate("toastNotifications","toast_messaging_sms_user_given_name",{sender:n}):i&&t.senderDecoratedDisplayName||n}function Kr(e,t,n){switch(t.type){case br.Mention:const i="everyone"===t.subtype?"toast_messaging_mention_everyone":"toast_messaging_mention";return`@ ${e.stringTranslate("toastNotifications",i,{sender:t.senderDisplayName})}`;case br.Reaction:return e.stringTranslate("toastNotifications","toast_messaging_reaction",{sender:t.senderDisplayName,emoji:n})}}function Yr(e,t){switch(t.type){case br.DLP:return e.stringTranslate("toastNotifications","dlp_notify_sender_header")}}function Xr(e,t,n){const{enableToastMediaTextPreview:i}=e.get(L.J.Notifications);if(!n.text)return;const a=i?qr(t,n):Gr(n.text);if(!a)return;const o=n.senderGivenName||Zr(t,n);if(Fr.eo.isTFLSmsMri(n.senderId))return t.stringTranslate("toastNotifications","toast_messaging_sms_group_text_with_sender",{sender:o,text:a});const{enableGroupChatInviteFlow:r}=e.get(L.J.Messaging);return r&&n.interopConversationStatus===rr.uI.AcceptPending?t.stringTranslate("toastNotifications","toast_messaging_group_chat_invite_flow_text_with_sender",{displayName:o}):t.stringTranslate("toastNotifications","toast_messaging_group_text_with_sender",{sender:o,text:a})}function Zr(e,t){return!t.senderDisplayName||Fr.eo.isDisplayNameUnknownUser(t.senderDisplayName)?e.stringTranslate("toastNotifications","toast_unknown_user"):t.senderDisplayName}function es(e,t){return t===rr.uI.AcceptPending||t===rr.uI.ExtendedDirectoryAcceptPending||t===rr.uI.Quarantined?{quickReply:!1}:{quickReply:!0,quickReplyPlaceholder:e.stringTranslate("toastNotifications","toast_messaging_quickreply_placeholder_text"),quickReplyButton:e.stringTranslate("toastNotifications","toast_messaging_quickreply_button_text")}}function ts(e){return{conversationId:e.conversationId,messageId:e.messageId,quickReply:!1,time:new Date(+e.timestamp),discardDuringMeetingsAndCalls:!!e.discardDuringMeetingsAndCalls}}function ns(e,t,n){if(t)return e.stringTranslate("toastNotifications","toast_messaging_activity_text",{participants:t});const i=os(e,n);return i?e.stringTranslate("toastNotifications",i.count?"toast_messaging_activity_text_with_count":"toast_messaging_activity_text",{participants:i.displayName,count:i.count}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function is(e,t,n){const i=os(e,n);return i?e.stringTranslate("toastNotifications",i.count?"toast_messaging_activity_text_with_count":"toast_messaging_activity_text",{participants:i.displayName,count:i.count}):t?e.stringTranslate("toastNotifications","toast_messaging_activity_text",{participants:t}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function as(e,t){const n=os(e,t);return n?e.stringTranslate("toastNotifications",n.count?"toast_messaging_group_topic_with_count":"toast_messaging_group_topic",{participants:n.displayName,count:n.count}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function os(e,t){if(!t||!Array.isArray(t)||0===t.length)return;const n=e.stringTranslate("toastNotifications","toast_unknown_user"),i=t.map((e=>e.givenName||n));return(0,_r.N)(i,t.length)}function rs(e,t,n,a,o,r,s,l,c){const{enableCommandToHostCommService:d}=t.get(L.J.Core);return{id:"toast-event-subscription",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const m=s.newLogger("ToastEventSubscription","apps-chat");d?(m.log(li.f.Subscribing),n.subscribe({query:yr,fetchPolicy:"no-cache"}).forEach(function(e,t,n,a,o,r,s,l,c){const{enableToastCollections:d}=t.get(L.J.Notifications);return m=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,g;if(m.errors){const e=(0,wi.u4)(m.errors.map((e=>e.message)).join());return s.error(`${li.f.SubscriptionFailed} ${e}`),void ss(l,{errorCode:li.f.SubscriptionFailed,errors:e})}if(!(null===(i=m.data)||void 0===i?void 0:i.toastEvent))return s.error(li.f.EmptyEvent),void ss(l,{errorCode:li.f.EmptyEvent});s.log(`${li.f.ToastEventReceivedInJob}: Received a valid event in the toast subscription job, correlationId:${m.data.toastEvent.correlationId}, activityId:${m.data.toastEvent.activityId}`);const{toastEvent:p}=m.data,v=l.newScenario(it.RG.CrossClientToastView,{startTime:+p.timestamp});v.clientId=p.correlationId,v.appendEventData({activityId:m.data.toastEvent.activityId,isUrgent:!!m.data.toastEvent.isUrgent,mainEntityType:u.p.chats,mainEntitySubtype:m.data.toastEvent.type,messageId:m.data.toastEvent.messageId}),v.mark(it.ck.CrossClientToastEventReceived),s.log(`${li.f.LogToastInfo}: ${JSON.stringify(v.eventData)}`);const h=yield Jr(t,o,p,n,s);if(!h)return s.log(`${li.f.UnhandledType} ${p.type}`),void v.incomplete({reason:li.f.UnhandledType});const f=yield r({id:h.conversationId,type:u.p.chats,action:u.u.view,linkedEntity:null},n);if(v.mark(it.ck.CrossClientConversationFocusChecked),f)return s.log(li.f.ToastSuppressedForWindowInFocus),void v.incomplete({reason:li.f.ToastSuppressedForWindowInFocus});const y=yield Hr(n,s,p);v.mark(it.ck.CrossClientAvatarFetched),y&&(h.mainImage={alt:"",src:y}),null===(g=l.hoistScenarioToCore)||void 0===g||g.call(l,v),d&&(h.collectionId=ui(e,c,s)),h.type===br.TeamsTasks?a.toasts.showChatTabEntityNotification(p.correlationId,h):a.toasts.showMessage(p.correlationId,h),v.mark(it.ck.CrossClientEntityCommandTriggered),s.log(`${li.f.ToastCommandSent} type:${h.type} correlationId:${p.correlationId} activityId:${p.activityId}`)}))}(e,t,n,a,o,r,m,l,c))):m.log(li.f.NotEnabled)}))}}function ss(e,t){const n=e.newScenario(it.RG.CrossClientToastView);n.appendEventData({mainEntityType:u.p.chats}),n.fail(t)}const ls={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsChatConversationsReminderEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationsReminderUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"lastMessageAuthor"}},{kind:"Field",name:{kind:"Name",value:"lastMessageId"}},{kind:"Field",name:{kind:"Name",value:"lastMessageComposeTime"}},{kind:"Field",name:{kind:"Name",value:"missedThreadsCount"}},{kind:"Field",name:{kind:"Name",value:"userNames"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}}]}}]}}]},cs="life_web_and_desktop_growth_notification_reminders_info",ds="life_web_and_desktop_growth_notification_reminders_error";function us(e,t,n,a,o,r){const s="ConversationsReminderEventSubscription",l=t.newLogger(s,"apps-chat");return{id:"conversations-reminder-event-subscription",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t;const c=o.get(L.J.CdlWorker).enableConversationReminderEngine;if(null===(t=l.debugToTelemetry)||void 0===t||t.call(l,`Conversation Reminder Engine ${c?"is":"is not"} enabled`,cs,void 0,!0),!c)return;const d=e.watchQuery({query:ls,fetchPolicy:"no-cache"}).subscribe(function(e,t,n,a){return o=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,r,s,l,c;const d=null===(i=o.data)||void 0===i?void 0:i.conversationsReminderUpdatedEvent;if(!d)return void(null===(r=e.errorToTelemetry)||void 0===r||r.call(e,"Received empty conversationsReminderUpdatedEvent.",ds,void 0,!0));const u=a.newScenario(it.RG.ConversationsReminderSubscriptionJob);try{const{threadId:i,lastMessageAuthor:a,lastMessageId:o,lastMessageComposeTime:r,userNames:c,missedThreadsCount:m,timestamp:g,correlationId:p}=d,v=`Received conversationsReminderUpdatedEvent with ${m} unread conversations. Event id ${p}`;if(e.log(v),null===(s=e.infoToTelemetry)||void 0===s||s.call(e,v,cs,void 0,!0),u.appendEventData({correlationId:p}),u.mark(it.ck.ConversationsReminderEventReceived),!(i&&a&&o&&r&&m&&(null==c?void 0:c.length)&&g&&p))return null===(l=e.errorToTelemetry)||void 0===l||l.call(e,`${li.f.EmptyEvent}. Event id ${p}`,ds,void 0,!0),void u.fail({reason:`conversationsReminderUpdatedEvent missed values: ${JSON.stringify(Object.assign(Object.assign({},d),{lastMessageAuthor:a?"FULFILLED":"MISSED",userNames:(null==c?void 0:c.length)?"FULFILLED":"MISSED"}))}`});u.mark(it.ck.ConversationsReminderEventChecked);const h=function(e,t){const n={i18n:e,missedConversationsNumber:t.missedThreadsCount,sender:t.lastMessageAuthor,otherSenders:t.userNames.length-1};return{text:Vr(wr,n),title:Vr(kr,n),buttonText:Vr(Cr,n),mainImage:{alt:t.lastMessageAuthor,src:$r.dA},conversationId:t.threadId,messageId:t.lastMessageId,time:new Date(t.lastMessageComposeTime),quickReply:!1,type:br.Reminder}}(n,d);yield t.toasts.showReminder(p,h),u.stop({reason:"conversationsReminderUpdatedEvent was triggered"})}catch(t){const n="Something failed while processing the event.";null===(c=e.errorToTelemetry)||void 0===c||c.call(e,n,ds,void 0,!0),u.fail({reason:n})}}))}(l,n,a,r));return()=>{l.log(`${s} unsubscribed`),d.unsubscribe()}}))}}const ms=({context:{authenticationUser:e,client:t,coreSettings:n,entityCommanding:i,i18n:a,isEntityInView:o,loggerFactory:r,scenarioFactory:s,userTrackingService:l}})=>{const c=t;return[rs(e,n,c,i,a,o,r,s,l),us(c,r,i,a,n,s)]},gs=({context:{scenarioFactory:e}})=>[{id:"import-chat-bundle",runOncePerId:!0,job:()=>(({scenarioFactory:e})=>{(0,c.mT)(mr,"chat-app",e)})({scenarioFactory:e})}];var ps=n(448025),vs=n(948519),hs=n(69648);const fs=e=>{if(ys(e))return bs(e)?{subNavEntity:Ss(e),headerEntity:ks(e),startEntity:ws(e),mainEntity:Cs(e),endEntity:_s(e)}:null},ys=({contextEntity:e,entity:t,layoutMode:n})=>{const{action:i=null,type:a}=Object.assign({},t),{type:o,action:r}=e||{},s=[d.lO.standard,d.lO.focus].includes(n),l=i&&[u.u.create,u.u.default,u.u.empty,u.u.info,u.u.infoDetails,u.u.join,u.u.list,u.u.view,u.u.manage].includes(i),c=r&&o,m=[u.p.chats,u.p.chatschannelconv,u.p.chatsInfo,u.p.chatContextualSearch,u.p.chatsInfoView,u.p.chatManageApps].includes(a),g=n===d.lO.focus&&i===u.u.list;return!(!s||!m||!l&&!c||g)},bs=({entity:e,contextEntity:t})=>{const{type:n}=t||{},{action:i=null,type:a}=e||{};return!(a!==u.p.chats&&a!==u.p.chatContextualSearch&&a!==u.p.chatschannelconv||!(i||n&&![u.p.calls,u.p.callsgalleryandcontent,u.p.callsgallery,u.p.callscontent,u.p.platformStage,u.p.meetingroomallinonecall].includes(n)))},Ss=({entity:e,layoutMode:t})=>{if(t===d.lO.focus)return null;const{type:n,action:i}=e;let a;if("options"in e){const t=e.options&&(0,Bt.D)(e.options);((null==t?void 0:t.messageId)||(null==t?void 0:t.searchSessionId))&&(a=ps.Y.DoNotMove)}a||n!==u.p.chats&&n!==u.p.chatschannelconv||i!==u.u.default||(a=ps.Y.LeftRailSelectedItem);return{action:u.u.list,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:a?(0,wi.u4)({focusOnLoad:a}):null,type:n,windowOptions:null}},ks=({entity:e})=>{let t=u.u.view;const{action:n=null}=Object.assign({},e);return n&&[u.u.create,u.u.default,u.u.empty,u.u.join].includes(n)&&(t=n),Object.assign(Object.assign({},e),{action:t})},ws=()=>null,Cs=({entity:e,contextEntity:t})=>{let n=u.u.view;const{action:i=null}=Object.assign({},e);return i&&[u.u.create,u.u.default,u.u.empty,u.u.join,u.u.manage].includes(i)&&(n=i),t||Object.assign(Object.assign({},e),{action:n})},_s=({entity:e,contextEntity:t,coreSettings:n,layoutMode:i,userPreferences:a})=>{const{enableChatInfoPaneForMeeting:o,chatInfoPaneVisibilityState:r}=(null==n?void 0:n.get(L.J.Host))||{},{enableChatInfoPaneSearch:s,enableChatHighlightsSmartAction:l}=(null==n?void 0:n.get(L.J.Messaging))||{},c=Is(n),m=Ns(r,a,c);let g,p,v;if(t){if(({id:g,type:p,options:v}=t),p===u.p.meetingcollaboration)return t}else({id:g,type:p}=e),"options"in e&&(v=e.options);if(!((e,t,n,i,a)=>{var o;return!(a!==u.p.chatContextualSearch&&a!==u.p.chatHighlightsDetails&&(t!==d.lO.standard||e||!(null===(o=null==i?void 0:i.get(L.J.Core))||void 0===o?void 0:o.enableInfoPaneAsResponsiveMenu))||n&&t!==d.lO.standard&&t!==d.lO.focus)})(m,i,s,n,p))return null;const h=Es(g),f=(0,nr.fM)(g),y=Fs(g,o),b=Ts(p);if(!h&&!f&&!y&&Ms(p,s,l)){return{action:u.u.info,id:g||"",type:p,options:v}}if(!h&&!f&&!y&&b){return{action:u.u.info,id:g||"",type:u.p.chatsInfoView}}if(!h&&!f&&!y&&p===u.p.chatsInfo){return{action:u.u.infoDetails,id:g||"",type:p,options:v}}return null},Ts=e=>e===u.p.chats||e===u.p.chatschannelconv||e===u.p.chatsInfoView,Is=e=>{if(e){const{enableChatInfoPaneDefaultOpen:t}=e.get(L.J.Messaging),{enableChatInfoPaneDefaultOpen:n}=e.get(L.J.Host);return t||n}return!1},Es=e=>(0,nr.wm)(e)||(0,nr.UL)(e),Ns=(e,t,n)=>{var i,a;return(null!==(a=null!=e?e:null===(i=null==t?void 0:t.infoPane)||void 0===i?void 0:i.chats)&&void 0!==a?a:n?C.MwA.hidden:C.MwA.closed)===C.MwA.closed},As=e=>new Map([[hs.Rd.IS_GREATER_THAN_0,e],[hs.Rd.IS_AT_LEAST_947,e],[hs.Rd.IS_AT_LEAST_1350,e],[hs.Rd.IS_AT_LEAST_1500,e]]),Fs=(e,t)=>!t&&(0,nr.Eu)(e),Ds="41rem",Rs="32rem",xs=({areEmptySlotsTransparent:e,coreSettings:t,entity:n})=>{var i,a,o,r;const{isFlyoutChat:l}=null!==(i=null==t?void 0:t.get(L.J.Flyout))&&void 0!==i?i:{},{isNonInteractiveMeetingChat:c}=null!==(a=null==t?void 0:t.get(L.J.Calling))&&void 0!==a?a:{};let d=[vs.oj.Teacher,vs.oj.Student].includes(null==t?void 0:t.get(L.J.UserResources).licenseType)?As("32rem"):void 0;if(!d&&c){const{enableResponsiveChatPanel:e}=null!==(o=null==t?void 0:t.get(L.J.Calling))&&void 0!==o?o:{};d=e?new Map([[hs.Rd.IS_GREATER_THAN_0,Rs],[hs.Rd.IS_AT_LEAST_1350,Ds]]):As(Ds)}const{chatInfoPaneVisibilityState:m}=null!==(r=null==t?void 0:t.get(L.J.Host))&&void 0!==r?r:{};return d=m&&m===C.MwA.hidden?new Map([[hs.Rd.IS_GREATER_THAN_0,"0"],[hs.Rd.IS_AT_LEAST_947,"0"],[hs.Rd.IS_AT_LEAST_1350,Rs],[hs.Rd.IS_AT_LEAST_1500,Rs]]):d,{[C.tF7.endEntity]:{[s.S.Rail]:{slotWidthOverrides:d,isHideInfoPaneDisabled:(null==n?void 0:n.type)===u.p.chatContextualSearch||(null==n?void 0:n.type)===u.p.chatHighlightsDetails,infoPaneVisibilityStateInHybrid:m}},[C.tF7.subNavEntity]:{[s.S.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==t?void 0:t.get(L.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}},[C.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!!l,infoPaneVisibilityStateInHybrid:m}},[C.tF7.headerEntity]:{[s.S.HorizontalBar]:{isBackgroundTransparent:e}}}},Ms=(e,t,n)=>e===u.p.chatHighlightsDetails&&n||e===u.p.chatContextualSearch&&t;var Os=n(768187),Ps=n(517056),Ls=n(623409),Us=n(500795);const js="/l/invite/",$s="/l/claim",Bs={[$s]:Os.DL.Claim,[js]:Os.DL.Invite},Ws=new Set([$s,js]),Hs=(e,t,n)=>{var i;const a=n.newScenario(it.RG.ExtDeeplinkToChat),o=new URLSearchParams(e.search),r=null===(i=o.get("users"))||void 0===i?void 0:i.split(",").map((e=>e.trim())),s=o.get("message"),l=o.get("topicName");return a.mark(it.ck.ExtDeeplinkToChatParamsReceived,{userCount:null==r?void 0:r.length,isMessagePresent:!!s,isTopicNamePresent:!!l}),t.log("deeplink_to_chat_qsp_received"),Promise.resolve({entityCommand:{entity:{type:u.p.chats,action:u.u.view},command:{visibilityState:d.fe.show,stateTransition:d.su.new},correlation:{source:kt.D.ChatDeeplinkUsers},entityOptions:{initialComposeMessage:s,groupName:l,users:r,isViewFromChatDeeplink:!0}},metadata:{allowAnonymous:!1}})},Vs=(e,t)=>{var n;const i=e.pathname.split("/");return i.length>4&&"conversations"===i[4]&&(i[3].startsWith(rr.at.SkypeSpacesThread)||(0,tr.mB)(i[3]))?Promise.resolve({entityCommand:{entity:{type:u.p.chats,action:u.u.view,id:i[3]},command:{visibilityState:d.fe.show,stateTransition:d.su.new},correlation:{source:kt.D.ChatDeeplinkId}},metadata:{allowAnonymous:!1}}):(null===(n=t.warnNoPii)||void 0===n||n.call(t,`invalid path name ${e.pathname}`),Promise.reject("Deeplink to chat path invalid"))},zs=(e,t)=>Promise.resolve({entityCommand:{entity:{type:u.p.chats,action:u.u.join},command:{visibilityState:d.fe.show,stateTransition:d.su.flush},entityOptions:{inviteLinkType:t,inviteLinkUrl:e.toString()}},metadata:{allowAnonymous:!1}}),qs="chat",Gs="viewChatApp",Js=()=>({actor:qs,action:Gs});var Qs=n(108353);const Ks={id:"com.microsoft.teams.chat",name:"Chat",getLocalizedName:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("messaging"),e.stringTranslate("messaging","messaging_app_name")})),actors:[qs],supportedEntities:[u.p.alttext,u.p.chats,u.p.chatschannelconv,u.p.chatContextualSearch,u.p.chatHighlightsDetails,u.p.chatManageApps,u.p.chatsInfo,u.p.chatsInfoView,u.p.codesnippet,u.p.customizereactions,u.p.deletechat,u.p.dlp,u.p.fluid,u.p.giphyconsent,u.p.hyperlink,u.p.chatInviteConfirmation,u.p.leavechat,u.p.messagedraft,u.p.pinnedchatsmaxreached,u.p.pinnedconversationitems,u.p.removechatuser,u.p.reportConcern,u.p.forwardMessage,u.p.reportConcernForTFW,u.p.sharechatlink,u.p.streamcamera,u.p.streamcamerainchannels,u.p.streamcameraincommunities,u.p.translationfeedback,u.p.twowaysmsfriendlyname,u.p.updategroupchatavatar,u.p.tfwupdategroupchatavatar,u.p.blockChat,u.p.leaveGroupAndBlockUser,u.p.m365ChatLike,u.p.m365ChatDislike,u.p.m365ChatReportHarm],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Modal,s.S.Rail],getDefaultCommand:e=>{const{enableFilterPinnedAppsBasedOnPolicy:t}=e.get(L.J.Extensibility);if(!t||(0,Qs.t3)(e.get(L.J.Messaging))!==Qs.i1.Disabled)return{action:u.u.default,type:u.p.chats}},windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20,widthToScreenWidthRatio:.3,heightToWidthRatio:1.125}},Ys={shouldAddEntitiesToWindowHistory:e=>{var t,n;return!(0,nr.UL)(null===(t=null==e?void 0:e.mainEntity)||void 0===t?void 0:t.id)&&(null===(n=null==e?void 0:e.mainEntity)||void 0===n?void 0:n.action)!==u.u.create},shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:()=>!0},Xs={onEventReceived:({eventInput:e})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n,i,a;switch(e.event.type){case ln.uS.requestPersonMoreInfo:const o=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:mn(o)});case Vi.uS.expandTab:{const t=null===(a=(i=e.event).data)||void 0===a?void 0:a.call(i);return Promise.resolve({command:zi.CN.expandTab(t)})}case Vi.uS.resetLayoutOverrides:return Promise.resolve({command:zi.CN.resetLayoutOverrides()});case Vi.uS.maximizeTab:return Promise.resolve({command:zi.CN.maximizeTab()})}return Promise.resolve(void 0)}))},Zs=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("ChatApp onCommandReceived","apps-chat");if(e.command.actor===qs)switch(n){case Gs:return{entity:{type:u.p.chats,action:u.u.default},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.Unknown}}};default:i.error(`Command action '${n}' is not supported at ChatApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by ChatApp.`)})),el=({appViewState:e,availableEntities:t})=>{var n,i,a,o,r,s,l,c,d;const{selectedChatId:m}=e;if((null===(n=t.mainEntity)||void 0===n?void 0:n.type)===u.p.chats&&((null===(i=t.mainEntity)||void 0===i?void 0:i.action)===u.u.view||(null===(a=t.mainEntity)||void 0===a?void 0:a.action)===u.u.create||(null===(o=t.mainEntity)||void 0===o?void 0:o.action)===u.u.default)||(null===(r=t.mainEntity)||void 0===r?void 0:r.type)===u.p.chatschannelconv&&(null===(s=t.mainEntity)||void 0===s?void 0:s.action)===u.u.view){const e=null===(l=t.mainEntity)||void 0===l?void 0:l.id;(null==m?void 0:m.read())!==e&&(null==m||m.update((null===(c=t.mainEntity)||void 0===c?void 0:c.action)===u.u.create||null===(d=t.mainEntity)||void 0===d?void 0:d.id))}return Promise.resolve(void 0)},tl={gqlTypeName:"ChatAppViewState",queryFieldName:"chatAppViewState",computedValues:void 0,navigationalFieldDefaultValues:{},nonNavigationalFieldDefaultValues:{selectedChatId:null}},nl=({children:e})=>o.createElement(o.Fragment,null,e),il=(e,t,n)=>{const i=e.command.correlation.source,{entity:a,command:o}=e;if(a.type===u.p.chats&&o.stateTransition===d.su.new&&o.visibilityState===d.fe.show)return(0,tr.j8)(a.id)?it.RG.PhonelinkSmsChatPopOut:it.RG.ChatPopOut;if(a.type===u.p.chats&&(a.action===u.u.view||a.action===u.u.default)&&o.visibilityState===d.fe.show&&i!==kt.D.StandAlone){if(a.id===nr.FX)return it.RG.NewChat;if(i===kt.D.ChatListMeetingItem||i===kt.D.Calendar)return it.RG.MeetingChatSwitch;const{isFlyoutChat:e}=n.get(L.J.Flyout);if(e)return(0,tr.j8)(a.id)?it.RG.PhonelinkSmsInlineChatSwitch:it.RG.InlineChatSwitch;const{chatSwitchInPopOut:t}=n.get(L.J.Chat);return t?it.RG.ChatSwitchPopOut:(0,tr.j8)(a.id)?it.RG.PhonelinkSmsChatSwitch:it.RG.ChatSwitch}return a.type===u.p.chatContextualSearch&&a.action===u.u.info&&o.visibilityState!==d.fe.hide?it.RG.ContextualSearchStart:a.type===u.p.chatHighlightsDetails&&a.action===u.u.info&&o.visibilityState===d.fe.show?it.RG.ChatHighlightsDetailsStart:it.RG.EntityCommand},al=({coreServices:e,host:t,prevEntityType:n,screenState:i,windowOptions:a})=>{if(n===u.p.chats)return null;const{height:o,minHeight:r,minWidth:s,offset:l,width:c}=Ks.windowFeatures||{},d={left:(null==t?void 0:t.screenX)||0,top:(null==t?void 0:t.screenY)||0},m=((null==i?void 0:i.numOpenWindows)||1)*(l||1);return Object.assign(Object.assign({additionalFeatures:{minHeight:`${r}`,minWidth:`${s}`},height:o,left:(null==d?void 0:d.left)+m,minHeight:r,minWidth:s,top:(null==d?void 0:d.top)+m,width:c},(null==e?void 0:e.coreSettings.get(L.J.Core).enableRatioToScreenBasedSizing)&&function(e,t){const{widthToScreenWidthRatio:n,heightToWidthRatio:i}=t||{};if(!e||!i||!n)return{};const a=n*e.screen.availWidth;return{height:a*i,width:a}}(t,Ks.windowFeatures)),a)};function ol(){const e=({deeplinkUrl:e,context:t})=>{const n=t.loggerFactory.newLogger("ChatApp","apps-chat");return((e,t,n)=>{const{pathname:i}=n,{enableInviteLinks:a}=e.get(L.J.InviteLinks);for(const e of Array.from(Ws))if(i.startsWith(e)){if(!a){const e="Invite link redemption is disabled for this experience";return t.error(e),Promise.reject(e)}const i=Bs[e];if(void 0===i){const e="No Invite link type found for the specified prefixType";return t.error(e),Promise.reject(e)}return zs(n,i)}const o="No DeeplinkPrefixType found for the specified deeplinkUrl";return t.error(o),Promise.reject(o)})(t.coreSettings,n,e)};return{eventHandlers:Xs,getAppPhases:pr,getAppViewEntities:fs,getAppViewEntitiesProps:xs,getAppWindowFeatures:al,getCommandScenarioName:il,getPlatformAppIdForEntity:e=>e.type===u.p.chats||e.type===u.p.chatschannelconv?"86fcd49b-61a2-4701-b771-54728cd291fb":void 0,manifest:Ks,onBeforeAddToNavigation:Ys,onBeforeCommandHandled:sr,onBeforeDeeplinkParsed:[{filter:"/l/claim",execute:e},{filter:"/l/invite/",execute:e},{filter:"/l/chat",execute:({deeplinkUrl:e,context:{loggerFactory:t,scenarioFactory:n}})=>((e,t,n)=>{if(e.pathname.startsWith("/l/chat/0/0"))return Hs(e,t,n);{const{pathname:i,search:a}=e;t.log(`Parsing deeplinkUrl - pathname: ${i}, search: ${a}`);const o=i.split("/"),r=null==i?void 0:i.split(/[/?&]/),s=null==r?void 0:r.indexOf("chat"),l=null==r?void 0:r[s+Ls.ei],c=o.findIndex((e=>e.startsWith(rr.at.SkypeSpacesThread))),d=o[c],u=new URLSearchParams(a),m=u.get("context");let g;try{g=m&&JSON.parse(m)}catch(e){throw new Error("executeChatDeeplinkUrl(): Unable to parse context.")}const p=u.get("tenantId")||void 0;if((null==l?void 0:l.startsWith(Ls.pQ))||Object.keys(Ls.ox).includes(l)){const t=(0,Ls.Jj)("",d,e,p,g,l,n);return Promise.resolve(t)}return Vs(e,t)}})(e,t.newLogger("ChatApp_parseChatDeeplink","apps-chat"),n)},{filter:e=>{var t;if(null===(t=e.pathname)||void 0===t?void 0:t.startsWith("/l/message")){const t=new URLSearchParams(e.search).get("context");try{const e=null==t?null:JSON.parse(t);return"chat"===(null==e?void 0:e.contextType)}catch(e){return!1}}return!1},execute:({deeplinkUrl:e,preferredCommandInput:t,context:{getUserContexts:n,loggerFactory:a,scenarioFactory:o}})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var r;const s=a.newLogger("ChatApp_parseChatDeeplink","apps-chat"),l=yield n();let c;return l&&l.length>0&&(c=null===(r=l[l.length-1].context)||void 0===r?void 0:r.client),((e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,r;const s=a.newScenario(it.RG.ExtDeeplinkToChatMessage);if(!e.pathname.startsWith("/l/message"))return s.stop({reason:it.ck.ExtDeeplinkToChatMessagePathNotFound}),n.log("ext_deeplink_to_chat_message_path_not_found"),Promise.reject("Deeplink to chat message path not found");const l=e.pathname.split("/");if(l.length>3&&!l[3].startsWith(rr.at.SkypeSpacesThread)&&!l[3].startsWith(rr.at.PrivateFeed))return s.stop({reason:it.ck.ExtDeeplinkToChatMessageTypeNotSupported}),n.log("ext_deeplink_to_chat_message_type_not_supported"),Promise.reject("Deeplink to chat message type not supported");const c=l[3];let m=4<=l.length?l[4]:void 0;if(m="0"===m?void 0:m,s.mark(it.ck.ExtDeeplinkToChatMessageParamsReceived),n.log("ext_deeplink_to_chat_message_params_received"),t){const{data:e}=yield t.query({query:Us.vh,variables:{convId:c}}),i=e&&e.chat;if(i&&(!i.memberIds||0===i.memberIds.length))return s.stop({reason:it.ck.ExtDeeplinkToChatMessageUserIsNotMember}),n.log("ext_deeplink_to_chat_message_user_is_not_member."),Promise.resolve({entityCommand:{entity:{type:u.p.chats,action:u.u.error,id:Ps.P.UnableToViewChat},command:{stateTransition:d.su.extend,visibilityState:d.fe.show}},metadata:{allowAnonymous:!1}})}return s.stop({reason:it.ck.ExtDeeplinkToChatMessageResolved}),n.log("ext_deeplink_to_chat_message_resolved"),Promise.resolve({entityCommand:{entity:{type:u.p.chats,action:u.u.view,id:c},command:{visibilityState:null!==(i=null==o?void 0:o.visibilityState)&&void 0!==i?i:d.fe.show,stateTransition:null!==(r=null==o?void 0:o.stateTransition)&&void 0!==r?r:d.su.new},correlation:{source:kt.D.ChatDeeplinkMessage},entityOptions:{messageId:m}},metadata:{allowAnonymous:!1}})})))(e,c,s,o,t)}))},{filter:({protocol:e,pathname:t})=>{return"im:"===e||"sip:"===e&&(n=t.trim(),/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n.toLowerCase()));var n},execute:({deeplinkUrl:e,context:{loggerFactory:t}})=>((e,t)=>{const{protocol:n,pathname:i}=e;return t.log(`ChatApp_parseChatProtocolDeeplink: Deeplink to chat from protocol ${n} with pathname: ${i} received`),Promise.resolve({entityCommand:{entity:{type:u.p.chats,action:u.u.view},command:{visibilityState:d.fe.show,stateTransition:d.su.new},correlation:{source:kt.D.ChatProtocolDeeplink},entityOptions:{users:[e.pathname],isViewFromChatDeeplink:!0}},metadata:{allowAnonymous:!1}})})(e,t.newLogger("ChatApp_parseChatProtocolDeeplink","apps-chat"))}],onCommandReceived:Zs,onPreInit:gs,onPreWarm:ms,onRegister:e=>{e.registerTask(new Se)},onViewUpdateCommandResolved:el,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n,coreSettings:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableEntityMoreInfo:r=!1}=a.get(L.J.Core),{ChatViewsRenderer:s,LPC:d}=yield((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i="chat-app";t("ChunkLoadStarted",{chunkName:i});const{ChatViewsRenderer:a}=yield(0,c.mT)(mr,i,e),{LPC:o}=n?{LPC:nl}:yield(0,c.mT)(gr,i,e);return t("ChunkLoadSucceeded",{chunkName:i}),{ChatViewsRenderer:a,LPC:o}})))(n,t,!!r),u=r?nl:vn.p3;return o.createElement(l.f,{namespaces:["calling","chatList","compose","extensibility","files","lightbox","messaging","meetingAnalytics","urlPreview","datepicker"],loaderRenderer:null},o.createElement(d,null,o.createElement(u,null,o.createElement(s,{appRenderMode:e}))))})),viewStateRegistration:tl}}const rl=e=>{if(sl(e))return ll(e)?{subNavEntity:cl(e),headerEntity:dl(e),startEntity:ul(e),mainEntity:ml(e),endEntity:gl(e)}:null},sl=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.coachreport].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},ll=()=>!0,cl=()=>null,dl=()=>null,ul=()=>null,ml=({entity:e})=>e,gl=()=>null,pl={id:"com.microsoft.teams.coachreport",name:"CoachReport",supportedEntities:[u.p.coachreport],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.coachreport,action:u.u.view}),windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},vl=()=>Promise.all([n.e(893479),n.e(672617),n.e(477897),n.e(623025),n.e(579814),n.e(6788),n.e(438309),n.e(471154)]).then(n.bind(n,188086)),hl=()=>pl.windowFeatures||{};function fl(){const e=()=>null;return{getAppViewEntities:rl,getAppWindowFeatures:hl,manifest:pl,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="coach-report-app";n("ChunkLoadStarted",{chunkName:e});const{CoachReportRenderer:t}=yield(0,c.mT)(vl,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l.f,{namespaces:["calling","messaging","meetingAnalytics","coachReport"],loaderRenderer:null},o.createElement(t,null))}return o.createElement(e,null)}))}}const yl=e=>bl(e)?{subNavEntity:Sl(e),headerEntity:kl(e),startEntity:wl(e),mainEntity:Cl(e),endEntity:_l(e)}:null,bl=({entity:e})=>{const{type:t}=Object.assign({},e);return t!==u.p.platformstageinactivemeeting},Sl=()=>null,kl=({entity:e})=>e,wl=()=>null,Cl=({entity:e})=>e,_l=({entity:e,contextEntity:t})=>{const n=e.linkedEntity,i=e.options;return n?e.type===u.p.platformStage&&n.type===u.p.chats?Object.assign(Object.assign({},n),{action:u.u.view,options:i}):e.type===u.p.platformStage&&(null==t?void 0:t.type)===u.p.chats?Object.assign(Object.assign({},t),{action:u.u.view,options:i}):null:null},Tl={id:"com.microsoft.teams.collab-stage-view",name:"CollabStageViewApp",supportedEntities:[u.p.platformStage,u.p.platformstageinactivemeeting],supportedRenderModes:[s.S.Main,s.S.HorizontalBar],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600,offset:20}},Il={shouldAddEntitiesToWindowHistory:e=>{var t;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.platformStage},shouldRestoreClientToEntities:e=>{var t;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.platformStage}},El=({appRenderMode:e,coreSettings:t})=>{const n=new ht.H,{platformAppCriticalPhaseTimeout:i}=t.get(L.J.Extensibility);switch(e){case s.S.Main:n.registerAppPhase({phase:ft.nh.CRITICAL,signals:[ft.GZ.PLATFORM_APP_FRAME_CONTENT_RENDERED],timeout:i||35e3})}return n.appPhases},Nl=()=>Promise.all([n.e(893479),n.e(672617),n.e(698627),n.e(273621),n.e(129408),n.e(284790),n.e(179826),n.e(994959),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(757663),n.e(59106),n.e(595162),n.e(732773),n.e(501749),n.e(41547),n.e(991883),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(953808),n.e(836083),n.e(699466),n.e(279439),n.e(510510),n.e(652336),n.e(376488),n.e(314171),n.e(554648),n.e(982110)]).then(n.bind(n,257405)),Al=({coreServices:e,host:t,prevEntityType:n,entityType:i,screenState:a,isResize:o})=>{if((n===u.p.platformStage||n===u.p.calls)&&i===u.p.platformStage)return null;const{minHeight:r,minWidth:s,offset:l=1}=Tl.windowFeatures||{},c=null==t?void 0:t.screen;if(o)return Tl.windowFeatures||null;if(!c)return null;let{height:d=1,width:m=1}=((e,t)=>{const{minHeight:n=0,minWidth:i=0}=Tl.windowFeatures||{};let{width:a,height:o}=Tl.windowFeatures||{};if(!t)return{height:o,width:a,minHeight:n,minWidth:i};const{orientation:{type:r}}=e,{landscapeScreenRatio:s,portraitScreenRatio:l,widthHeightRatio:c}=t.coreSettings.get(L.J.Calling);if(s&&l&&c)switch(r){case"landscape-primary":case"landscape-secondary":const t=s*e.availHeight;o=t>n?t:n,a=c*o;break;case"portrait-primary":case"portrait-secondary":const r=l*e.availWidth;a=r>i?r:i,o=1/c*a}return{height:o,width:a}})(c,e);const g=c.availHeight-l,p=m>=c.availWidth||d>=g;p&&(d=c.availHeight,m=c.availWidth);const{left:v,top:h}=((e,t,n,i,a)=>{if(i)return{left:0,top:0};const o="availLeft"in e?e.availLeft:0,r="availTop"in e?e.availTop:0,s=o+e.availWidth/2-t/2;let l;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":l=r+a;break;default:l=r+e.availHeight/2-n/2}return{left:s,top:l}})(c,m,d,p,l),f=p?0:((null==a?void 0:a.numOpenWindows)||1)*l;return{additionalFeatures:{minHeight:`${r}`,minWidth:`${s}`},height:d,left:v+f,minHeight:r,minWidth:s,top:h+f,width:m}};function Fl(){return{getAppViewEntities:yl,getAppPhases:El,getAppWindowFeatures:Al,manifest:Tl,render:({appRenderMode:e,scenarioFactory:t,onRenderEvent:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="collab-stage-view-app";n("ChunkLoadStarted",{chunkName:i});const{StageViewEntry:a}=yield(0,c.mT)(Nl,i,t);return o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(a,{appRenderMode:e}))})),onBeforeAddToNavigation:Il}}const Dl="communities",Rl="viewCommunitiesApp",xl=()=>({actor:Dl,action:Rl}),Ml={id:"com.microsoft.teams.communities",name:"CommunitiesApp",actors:[Dl],supportedEntities:[u.p.communities,u.p.communitiesonboarding,u.p.sharecommunitieslink,u.p.reportconcerncommunities,u.p.communitiesaddmember,u.p.communitiescreatechannel,u.p.communitiesevents,u.p.communitiescreateevent,u.p.communitiesguidelinesdialog,u.p.communitiesmembers,u.p.communitiessendpostasemaildialog,u.p.communitiesgetappdialog,u.p.communitiescreatedialog,u.p.communitieseditdialog,u.p.communitiesjoinrequest,u.p.communitiesjoininviteview,u.p.leavecommunity,u.p.percommunitynotificationsettingsdialog],supportedRenderModes:[s.S.Main,s.S.HorizontalBar,s.S.Rail,s.S.Modal],getDefaultCommand:()=>({type:u.p.communitiesonboarding,action:u.u.default})},Ol=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("CommunitiesApp onCommandReceived","apps-communities");if(e.command.actor===Dl)switch(n){case Rl:return{entity:{type:u.p.communitiesonboarding,action:u.u.default},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.Unknown}}};default:i.error(`Command action '${n}' is not supported at CommunitiesApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by CommunitiesApp.`)}));var Pl=n(540110);const Ll=e=>{if(Ul(e))return jl(e)?{subNavEntity:$l(e),headerEntity:Bl(e),startEntity:Wl(e),mainEntity:Hl(e),endEntity:Vl(e)}:null},Ul=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.standard].includes(e),o=[u.p.communities,u.p.communitiesonboarding,u.p.communitiesevents,u.p.communitiescreateevent,u.p.communitiesmembers,u.p.communitiesjoinrequest,u.p.communitiesjoininviteview].includes(i),r=n&&[u.u.default,u.u.view,u.u.join,u.u.manage].includes(n);return!!(a&&o&&r)},jl=()=>!0,$l=({entity:e})=>{switch(e.type){case u.p.communitiesonboarding:case u.p.communitiescreateevent:return null;default:return e}},Bl=({entity:e,coreSettings:t})=>{if(e.type===u.p.communitiesonboarding)return null;const n=null==t?void 0:t.get(L.J.Calendar).enableCalendarSchedulingFormMultiSlot;return e.type!==u.p.communitiescreateevent||n?e:null},Wl=()=>null,Hl=({entity:e})=>e,Vl=()=>null,zl=({areEmptySlotsTransparent:e,coreSettings:t})=>({[C.tF7.subNavEntity]:{[s.S.Rail]:{areSlotShadowsDisabled:!1,isBackgroundTransparent:!!(null==t?void 0:t.get(L.J.Core).enableTransparentLeftRail)||e}},[C.tF7.mainEntity]:{[s.S.Main]:{isColorSchemeDefaultBackground2:!0}}});var ql,Gl=n(344856),Jl=n(324782),Ql=n(339244);!function(e){e.invitecommunity="/l/community/invite",e.message="/l/message",e.community="/l/community"}(ql||(ql={}));const Kl=Object.values(ql),Yl=Kl.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:Os.DL.Community})),{}),Xl=new Set(Kl),Zl=(e,t)=>{const n=(0,Ql.qK)(),i=n?{channelId:n}:null;return Promise.resolve({entityCommand:{entity:Object.assign({type:u.p.communities,action:u.u.join},i?{id:JSON.stringify(i)}:{}),command:{visibilityState:d.fe.show,stateTransition:d.su.forceFlush},entityOptions:{inviteLinkType:t,inviteLinkUrl:e.toString()}},metadata:{allowAnonymous:!1}})};var ec,tc;!function(e){e.NoChannelId="Parsed communities deep link does not contain the channel id",e.NoJoinCode="Parsed communities join link does not contain the join code",e.MinorAccount="Communities use is forbidden for the minor"}(ec||(ec={})),function(e){e.NoChannelId="channel_on_before_deep_link_parsed_no_channel_id_error",e.NoJoinCode="communities_join_no_join_code_failure",e.MinorAccount="channel_on_before_deep_link_parsed_feature_not_enabled_error"}(tc||(tc={}));const nc=(e,t,n)=>Promise.resolve({entityCommand:{entity:{type:u.p.communities,action:u.u.view,id:JSON.stringify({channelId:e,replyChainId:t})},command:{stateTransition:d.su.forceFlush,visibilityState:d.fe.show},entityOptions:{deepLinkId:n}},metadata:{allowAnonymous:!1}}),ic={filter:ql.message,execute:({deeplinkUrl:e,context:{loggerFactory:t,coreSettings:n}})=>{var i,a;const o=t.newLogger("CommunitiesApp onBeforeDeeplinkParsed","apps-communities"),{pathname:r,search:s}=e;o.log(`Parsing deeplinkUrl - pathname: ${r}, search: ${s}`);const l=r.split("/"),c=l.findIndex((e=>e.startsWith("19:"))),d=new URLSearchParams(s),u=l[c],m=l[c+1],g=d.get("parentMessageId")||void 0;if((0,Jl.su)(n))throw null===(i=o.errorToTelemetry)||void 0===i||i.call(o,ec.MinorAccount,tc.MinorAccount),Error(ec.MinorAccount);if(u)return o.log(`toNavigationIntent - channelId: ${u}, messageId: ${m}`),nc(u,g,m);throw null===(a=o.errorToTelemetry)||void 0===a||a.call(o,ec.NoChannelId,tc.NoChannelId),Error(ec.NoChannelId)}},ac=({deeplinkUrl:e,context:t})=>{var n,i;const a=t.loggerFactory.newLogger("CommunitiesApp","apps-communities"),{pathname:o}=e,r=o.split("/")[3];if((0,Jl.su)(t.coreSettings))throw null===(n=a.errorToTelemetry)||void 0===n||n.call(a,ec.MinorAccount,tc.MinorAccount),Error(ec.MinorAccount);if(r)return((e,t,n)=>{const{pathname:i}=n,{enableCommunitiesLinkJoin:a}=e.get(L.J.Communities);if(!a){const e="Invite link redemption is disabled for this experience";return t.error(e),Promise.reject(e)}for(const e of Array.from(Xl)){const t=Yl[e];if(i.startsWith(e)&&t)return Zl(n,t)}const o="No DeeplinkPrefixType found for the specified deeplinkUrl";return t.error(o),Promise.reject(o)})(t.coreSettings,a,e);throw null===(i=a.errorToTelemetry)||void 0===i||i.call(a,ec.NoJoinCode,tc.NoJoinCode),Error(ec.NoJoinCode)},oc=({deeplinkUrl:e,context:t})=>ac({deeplinkUrl:e,context:t}),rc=[ic,{filter:ql.community,execute:oc},{filter:ql.invitecommunity,execute:oc}],sc={shouldAddEntitiesToWindowHistory:e=>{var t;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.communitiesonboarding},shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:e=>{const{replyChainId:t}=(0,Pl.jd)((null==e?void 0:e.id)||"");return(null==e?void 0:e.type)===u.p.communities&&(null==e?void 0:e.action)===u.u.view&&!t}},lc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsCommunitiesToastEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"communitiesToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"count"}},{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"reaction"}},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderGivenName"}},{kind:"Field",name:{kind:"Name",value:"senderMri"}},{kind:"Field",name:{kind:"Name",value:"subtype"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}}]}}]}}]};var cc,dc,uc;!function(e){e.Follow="Follow",e.Reply="Reply",e.PersonalReply="PersonalReply",e.ReplyToReply="ReplyToReply",e.MentionInCommunity="MentionInCommunity",e.CommunitiesInviteJoined="CommunitiesInviteJoined",e.CommunityMention="CommunityMention",e.ReactionInCommunity="ReactionInCommunity"}(cc||(cc={})),function(e){e.Person="Person",e.Team="Team",e.Community="Community"}(dc||(dc={})),function(e){e.L1="L1",e.L2="L2"}(uc||(uc={}));const mc="new_community_post_toast_header",gc="community_reply_toast_header",pc="community_mention_person_toast_header",vc="community_invite_joined",hc="community_mention_everyone_toast_header",fc="community_single_member_reaction_header",yc="community_multiple_members_reaction_header",bc="communities_toast_event_subscription_job";var Sc=n(669434);const kc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCommunitiesMsaUserProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},wc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCommunitiesToastImageAsDataUriQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};function Cc(e,t,n,a){var o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const r=yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{data:i}=yield e.query({query:kc,variables:{userId:t,displayName:n,profilePictureSize:Sc.$D.Small}});return i.msaUserProfilePicture}))}(e,n,a);if(!r)return void(null===(o=t.errorToTelemetry)||void 0===o||o.call(t,li.f.ImageUrlGenerationFailed,bc,void 0,!0));const s=yield e.query({query:wc,variables:{url:r}});return(null==s?void 0:s.data.toastImageAsDataUri)||void 0}catch(e){return void(null===(r=t.errorToTelemetry)||void 0===r||r.call(t,li.f.ImageFetchFailed,bc,void 0,!0))}}))}const _c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCommunitiesToastEmoticonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchEmoticons"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchFilter"},value:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}}},{kind:"Argument",name:{kind:"Name",value:"exactMatch"},value:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}}},{kind:"Argument",name:{kind:"Name",value:"includeShortCuts"},value:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}}},{kind:"Argument",name:{kind:"Name",value:"includeKeywords"},value:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}}},{kind:"Argument",name:{kind:"Name",value:"maxResultCount"},value:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}}},{kind:"Argument",name:{kind:"Name",value:"categoryId"},value:{kind:"Variable",name:{kind:"Name",value:"categoryId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCommunitiesToastEmoticonFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCommunitiesToastEmoticonFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"unicode"}},{kind:"Field",name:{kind:"Name",value:"animation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCommunitiesToastEmoticonFragment_animation"}}]}},{kind:"Field",name:{kind:"Name",value:"etag"}},{kind:"Field",name:{kind:"Name",value:"diverse"}},{kind:"Field",name:{kind:"Name",value:"shortcuts"}},{kind:"Field",name:{kind:"Name",value:"searchMatch"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCommunitiesToastEmoticonFragment_animation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fps"}},{kind:"Field",name:{kind:"Name",value:"framesCount"}},{kind:"Field",name:{kind:"Name",value:"firstFrame"}}]}}]}.definitions]}.definitions]};function Tc({teamName:e,type:t,senderDisplayName:n,senderGivenName:a,subtype:o,count:r},s,l,c){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const d=n||a;if(!d)return"";const u={senderDisplayName:d,teamName:e};switch(t){case cc.Follow:return Ic(mc,u,s);case cc.Reply:case cc.PersonalReply:case cc.ReplyToReply:return Ic(gc,u,s);case cc.MentionInCommunity:return o===dc.Person?Ic(pc,u,s):"";case cc.CommunityMention:return o===dc.Community?Ic(hc,u,s):"";case cc.CommunitiesInviteJoined:return Ic(vc,u,s);case cc.ReactionInCommunity:const e=yield function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const{id:t}=(0,Br.M)(null==n?void 0:n.toLocaleLowerCase().trim());if(!t)return;const{data:i}=yield e.query({query:_c,variables:{searchFilter:t,exactMatch:!0}});return((null==i?void 0:i.searchEmoticons)||[])[0]}catch(e){return void(null===(a=t.errorToTelemetry)||void 0===a||a.call(t,`communities toast emoticon query failed for ${n}`,"communities_toast_emoticon_query_failed"))}}))}(l,c,o),t=(null==e?void 0:e.unicode)||void 0;return r&&r>0?Ic(yc,Object.assign(Object.assign({},u),{emoji:t,count:r}),s):Ic(fc,Object.assign(Object.assign({},u),{emoji:t}),s);default:return""}}))}function Ic(e,{emoji:t,teamName:n,senderDisplayName:i,count:a},o){return o.stringTranslate("toastNotifications",e,{emoji:t,senderDisplayName:i,teamName:n,count:a})}function Ec(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{conversationId:i,messageId:o,startTimestamp:r,teamName:s,senderMri:l,senderDisplayName:c,type:d,replyChainId:u}=e,m=yield Cc(n,a,l,c||""),g=function(e){switch(e){case cc.Follow:return uc.L1;case cc.Reply:case cc.PersonalReply:case cc.ReplyToReply:case cc.MentionInCommunity:case cc.CommunityMention:case cc.ReactionInCommunity:return uc.L2;default:return uc.L1}}(d),p=u&&g===uc.L2?u:void 0,v=yield Tc(e,t,n,a);return{conversationId:i,quickReply:!1,messageId:o,time:new Date(+r),replyChainId:p,text:s,title:v,mainImage:m?{alt:"",src:m}:void 0,type:d}}))}function Nc(e,t,n,a,o,r,s,l,c){const{enableCommandToHostCommService:d}=t.get(L.J.Core);return{id:"communities-toast-event-subscription",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var m,g;const p=a.newLogger("CommunitiesToastEventSubscription","apps-communities");d?(null===(g=p.debugToTelemetry)||void 0===g||g.call(p,"CommunitiesToastEventSubscription Job started",bc,void 0,!0),n.subscribe({query:lc,fetchPolicy:"no-cache"}).subscribe(function(e,t,n,a,o,r,s,l,c){const{enableToastCollections:d}=t.get(L.J.Notifications);return t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,m,g,p,v,h;if(t.errors)return void(null===(i=n.errorToTelemetry)||void 0===i||i.call(n,`${li.f.SubscriptionFailed}`,bc,void 0,!0));const f=null===(m=null==t?void 0:t.data)||void 0===m?void 0:m.communitiesToastEvent;if(!f)return void(null===(g=n.errorToTelemetry)||void 0===g||g.call(n,li.f.EmptyEvent,bc,void 0,!0));const y=a.newScenario(it.RG.CrossClientToastView,{startTime:+f.startTimestamp});y.clientId=f.correlationId,y.appendEventData({mainEntityType:u.p.communities}),y.mark("get_communities_toast_display_data_started");const b={channelId:f.conversationId,replyChainId:f.replyChainId},S=yield c({id:JSON.stringify(b),type:u.p.communities,action:u.u.view},s);if(y.mark(it.ck.CrossClientConversationFocusChecked),S)return null===(p=n.debugToTelemetry)||void 0===p||p.call(n,li.f.ToastSuppressedForWindowInFocus,bc,void 0,!0),void y.stop({reason:li.f.ToastSuppressedForWindowInFocus});const k=yield Ec(f,o,s,n);return y.mark("get_communities_toast_display_data_completed"),(null==k?void 0:k.title)?(d&&(k.collectionId=ui(e,l,n)),null===(h=a.hoistScenarioToCore)||void 0===h||h.call(a,y),r.toasts.showCommunitiesNotifications(f.correlationId,k)):(y.mark("unhandled_type_in_communities_toast"),null===(v=n.errorToTelemetry)||void 0===v||v.call(n,`${li.f.UnhandledType} ${f.type}`,bc,void 0,!0),void y.stop({reason:li.f.UnhandledType}))}))}(e,t,p,o,r,s,n,l,c))):null===(m=p.debugToTelemetry)||void 0===m||m.call(p,li.f.NotEnabled,bc,void 0,!0)}))}}const Ac=({context:{authenticationUser:e,client:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,i18n:o,entityCommanding:r,userTrackingService:s,isEntityInView:l}})=>[Nc(e,n,t,i,a,o,r,s,l)],Fc=({action:e,appRenderMode:t,coreSettings:n,type:i})=>{const a=new ht.H,{enableComposeCriticalPhaseLoadCommunities:o=!1}=n.get(L.J.Communities),{channelPhaseTimeoutSettings:r}=n.get(L.J.TeamsAndChannels),l=[],c=[];switch(t){case s.S.HorizontalBar:Dc({type:i,criticalSignals:l,featureFlags:{},postCriticalSignals:c});break;case s.S.Main:Rc({type:i,criticalSignals:l,featureFlags:{enableComposeCriticalPhaseLoadCommunities:o},postCriticalSignals:c});break;case s.S.Rail:xc({action:e,criticalSignals:l,postCriticalSignals:c,type:i,featureFlags:{}})}return a.registerAppPhase({phase:ft.nh.CRITICAL,signals:l,timeout:(null==r?void 0:r.critical)||25e3}),a.registerAppPhase({phase:ft.nh.POST_CRITICAL,signals:c,timeout:(null==r?void 0:r.postCritical)||1e4}),a.appPhases},Dc=({criticalSignals:e,type:t})=>{t===u.p.communities&&e.push(ft.GZ.COMMUNITIES_HEADER_RENDERED)},Rc=({criticalSignals:e,featureFlags:{enableComposeCriticalPhaseLoadCommunities:t},postCriticalSignals:n,type:i})=>{i===u.p.communities&&(e.push(ft.GZ.MESSAGES_RENDERED),t?e.push(ft.GZ.COMPOSE_LOADED):n.push(ft.GZ.COMPOSE_LOADED),n.push(ft.GZ.MESSAGE_REACTIONS_RENDERED,ft.GZ.PRESENCES_RENDERED,ft.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED))},xc=({action:e,criticalSignals:t,type:n})=>{n!==u.p.communities||e!==u.u.view&&e!==u.u.default||t.push(ft.GZ.CHANNEL_LIST_ITEMS_RENDERED)},Mc=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(287783),n.e(907784),n.e(168904),n.e(687601),n.e(553211),n.e(511402),n.e(860024),n.e(34693),n.e(674881),n.e(92285),n.e(509379),n.e(468600),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(604068),n.e(921132),n.e(264630),n.e(757839),n.e(532640),n.e(410602),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(398949),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(787970),n.e(842905),n.e(248361),n.e(675049),n.e(327119),n.e(262855),n.e(163395),n.e(354066),n.e(838267),n.e(369687),n.e(64113),n.e(302755),n.e(119751),n.e(181790),n.e(757052),n.e(459737),n.e(47331),n.e(911182),n.e(245526),n.e(672658),n.e(107052),n.e(335085),n.e(214475),n.e(419347),n.e(275240),n.e(423734),n.e(740085)]).then(n.bind(n,9151)),Oc=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(287783),n.e(907784),n.e(168904),n.e(687601),n.e(553211),n.e(511402),n.e(860024),n.e(34693),n.e(674881),n.e(92285),n.e(509379),n.e(468600),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(604068),n.e(921132),n.e(264630),n.e(757839),n.e(532640),n.e(410602),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(398949),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(787970),n.e(842905),n.e(248361),n.e(675049),n.e(327119),n.e(262855),n.e(163395),n.e(354066),n.e(838267),n.e(369687),n.e(64113),n.e(302755),n.e(119751),n.e(181790),n.e(757052),n.e(459737),n.e(47331),n.e(911182),n.e(245526),n.e(672658),n.e(107052),n.e(335085),n.e(214475),n.e(419347),n.e(275240),n.e(423734),n.e(740085)]).then(n.bind(n,697633)),Pc=(e,t)=>{var n;const{entity:i,command:a}=e,o=null===(n=null==a?void 0:a.correlation)||void 0===n?void 0:n.source,r=a.stateTransition===d.su.flush||a.stateTransition===d.su.forceFlush||a.stateTransition===d.su.new;if(i.type===u.p.communitiesonboarding&&i.action===u.u.default)return it.RG.CommunitiesAppInitiate;if(i.type===u.p.communities&&i.action===u.u.default)return it.RG.CommunitiesAppLoad;if(i.type===u.p.communities&&i.action===u.u.view&&a.visibilityState===d.fe.show&&r&&i.id){const{channelId:e,replyChainId:n}=(0,Pl.jd)(i.id,t);if(e){if(a.stateTransition===d.su.new)return n?it.RG.CommunitiesSwitchL2Popout:void 0;if(n)return it.RG.CommunitiesSwitchL2;if([kt.D.ChannelListItem,kt.D.CommunitiesList,kt.D.ChannelPostMessage,kt.D.ChannelRepliesPane].includes(o))return it.RG.CommunitiesSwitchL1}}};function Lc(){return{getAppPhases:Fc,getAppViewEntitiesProps:zl,getPlatformAppIdForEntity:e=>e.type===u.p.communities||e.type===u.p.communitiesonboarding||e.type===u.p.communitiesevents||e.type===u.p.communitiescreateevent||e.type===u.p.communitiesmembers?Gl.n.communities:void 0,onBeforeAddToNavigation:sc,getAppViewEntities:Ll,manifest:Ml,onCommandReceived:Ol,onBeforeDeeplinkParsed:rc,getCommandScenarioName:Pc,render:({appRenderMode:e,onRenderEvent:t})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n="communities-app";t("ChunkLoadStarted",{chunkName:n});const[{CommunitiesAppViews:i},{LPC:a}]=yield Promise.all([(0,c.mT)(Mc,n),(0,c.mT)(Oc,n)]);return t("ChunkLoadSucceeded",{chunkName:n}),o.createElement(a,null,o.createElement(vn.p3,null,o.createElement(l.f,{namespaces:["communities","chatList","extensibility","channels","lightbox"],loaderRenderer:null},o.createElement(i,{appRenderMode:e}))))})),onPreWarm:Ac}}const Uc={id:"com.microsoft.teams.discover-surface",name:"DiscoverSurfaceApp",supportedEntities:[u.p.discoversurface],supportedRenderModes:[s.S.Main,s.S.Rail,s.S.HorizontalBar],getDefaultCommand:()=>({type:u.p.discoversurface,action:u.u.default})},jc=e=>{if($c(e))return Bc(e)?{subNavEntity:Wc(e),headerEntity:Hc(e),startEntity:Vc(e),mainEntity:zc(e),endEntity:qc(e)}:null},$c=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.standard].includes(e),o=n&&[u.u.view,u.u.default].includes(n),r=[u.p.discoversurface].includes(i);return!!(a&&r&&o)},Bc=()=>!0,Wc=({coreSettings:e})=>{const{enableHybridChannelList:t}=(null==e?void 0:e.get(L.J.Host))||{};return t?{action:u.u.list,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:null,type:u.p.channels,windowOptions:null}:null},Hc=({entity:e})=>e,Vc=()=>null,zc=({entity:e})=>e,qc=()=>null,Gc=()=>({}),Jc=({appRenderMode:e,coreSettings:t})=>{const n=new ht.H,{criticalPhaseTimeout:i,postCriticalPhaseTimeout:a}=t.get(L.J.DiscoverSurface),o=[];switch(e){case s.S.HorizontalBar:o.push(ft.GZ.DISCOVER_SURFACE_HEADER_RENDERED);break;case s.S.Main:o.push(ft.GZ.DISCOVER_SURFACE_VIEW_RENDERED)}return n.registerAppPhase({phase:ft.nh.CRITICAL,signals:o,timeout:i||25e3}),n.registerAppPhase({phase:ft.nh.POST_CRITICAL,signals:[],timeout:a||1e4}),n.appPhases};var Qc=n(296117);const Kc=e=>it.RG.DiscoverSurfaceSwitchV2,Yc=()=>Promise.all([n.e(893479),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(907784),n.e(168904),n.e(687601),n.e(511402),n.e(860024),n.e(34693),n.e(674881),n.e(92285),n.e(54715),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(604068),n.e(757839),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(787970),n.e(842905),n.e(248361),n.e(675049),n.e(327119),n.e(262855),n.e(354066),n.e(369687),n.e(64113),n.e(757052),n.e(245526),n.e(107052),n.e(335085),n.e(996583)]).then(n.bind(n,855701)),Xc=()=>Promise.all([n.e(893479),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(907784),n.e(168904),n.e(687601),n.e(511402),n.e(860024),n.e(34693),n.e(674881),n.e(92285),n.e(54715),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(604068),n.e(757839),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(787970),n.e(842905),n.e(248361),n.e(675049),n.e(327119),n.e(262855),n.e(354066),n.e(369687),n.e(64113),n.e(757052),n.e(245526),n.e(107052),n.e(335085),n.e(996583)]).then(n.bind(n,697633)),Zc="discover-surface-app";function ed(){const e=()=>null;return{manifest:Uc,render:({appRenderMode:t,scenarioFactory:n,onRenderEvent:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){a("ChunkLoadStarted",{chunkName:Zc});const[{DiscoverFeed:i,DiscoverSurfaceHeader:r},{LPC:d}]=yield Promise.all([(0,c.mT)(Yc,Zc,n),(0,c.mT)(Xc,Zc,n)]);return a("ChunkLoadSucceeded",{chunkName:Zc}),t===s.S.Main||t===s.S.HorizontalBar?o.createElement(l.f,{namespaces:["channels","teamsAndChannels","funstuff","discoverSurface"],loaderRenderer:null},t===s.S.Main&&o.createElement(d,null,o.createElement(vn.p3,null,o.createElement(Qc.l8,null,o.createElement(i,null)))),t===s.S.HorizontalBar&&o.createElement(r,null)):o.createElement(e,null)})),getAppPhases:Jc,getAppViewEntities:jc,getAppViewEntitiesProps:Gc,getCommandScenarioName:Kc}}const td={id:"com.microsoft.teams.esp",name:"EspApp",supportedEntities:[u.p.esp],supportedRenderModes:[s.S.Modal],getDefaultCommand:()=>({type:u.p.esp,action:u.u.default}),windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}};var nd=n(332130),id=n(756375);const ad=()=>Promise.all([n.e(623025),n.e(579814),n.e(812409),n.e(602460),n.e(966725)]).then(n.bind(n,825468)),od=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return(0,c.mT)(ad,"esp-engine",e)}));var rd=n(341696),sd=n(649370);class ld{constructor(e,t){this.userBiService=e,this.logger=t.newLogger("esp-bi-telemetry","apps-esp")}recordEspPanelView(e,t,n){var i,a,o;const r=null===(a=null===(i=this.userBiService)||void 0===i?void 0:i.createDatabag)||void 0===a?void 0:a.call(i);r&&(r.identifier=t);const s={panelType:n?Ja.wh.EligibleEngagementSurface:Ja.wh.DisplayedEngagementSurface,panelRegion:(0,sd.v)(e),dataBag:r};null===(o=this.userBiService)||void 0===o||o.recordPanelView(s,this.logger),r&&r.dispose()}}function cd(e){const{client:t,coreSettings:n,entityCommanding:a,loggerFactory:o,platformService:r,scenarioFactory:s,userBiService:l,authenticationUser:c}=e;return{id:"start-esp",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e;const{enableEsp:d,enableEspAppReadyTrigger:u,enableEspWindowRenderTrigger:m,enableSetFirstLoginInformation:g}=n.get(L.J.Esp);if((null==c?void 0:c.type)===nd.Ch.Anonymous)return;if(g){const n="growth_growthplatform_start_esp_job",a=o.newLogger(n,"apps-esp");a.debug("start-esp started");const s=yield(0,rd.I1)(t,a);try{const e=yield function(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{clientType:i}=null!==(n=null==t?void 0:t.config)&&void 0!==n?n:{},a=i===Pe.Bh.Maglev&&!(null==e?void 0:e.maglev),o=i===Pe.Bh.Web&&!(null==e?void 0:e.WebNorthStar);return a?"maglev":o?"WebNorthStar":void 0}))}(s,r);e&&(yield(0,rd.Zm)(t,e,new Date,s,a))}catch(t){null===(e=a.errorToTelemetry)||void 0===e||e.call(a,"Failed to update first login information",n)}}if(!d||!u||m)return;const p=s.newScenario(it.RG.EspAppReady);try{const{displayEspSurface:e}=yield od(s),i=yield e(t,n,o,r,id.LQ.AppReady,new ld(l,o));if(p.stop(),i){const{entity:{id:e,type:t}}=i;e&&a.esp.launchDialog(e,t)}}catch(e){p.fail()}}))}}function dd(e){const{client:t,coreSettings:n,entityCommanding:a,loggerFactory:o,platformService:r,scenarioFactory:s,userBiService:l}=e;return{id:"start-esp-app-ready-hander",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i;const{enableEsp:c,enableEspAppReadyTrigger:d,enableEspWindowRenderTrigger:u,enableEspAppReadyWindowWarmTrigger:m}=n.get(L.J.Esp);if(c&&m&&!d&&!u&&e.isMainWindow){const e=o.newLogger("esp-engine/AppReady","apps-esp");try{const{displayEspSurface:e}=yield od(s),i=yield e(t,n,o,r,id.LQ.AppReady,new ld(l,o));if(i){const{entity:{id:e,type:t}}=i;e&&a.esp.launchDialog(e,t)}}catch(t){null===(i=e.errorToTelemetry)||void 0===i||i.call(e,"AppReady failed to show any surface","growth_growthplatform_esp_engine")}}}))}}function ud(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:n,coreSettings:i,entityCommanding:a,loggerFactory:o,platformService:r,scenarioFactory:s,userBiService:l}=t,{enableEsp:c,enableEspWindowRenderTrigger:d}=i.get(L.J.Esp);if(!c||!d||"main_window_rendered"!==e.type)return;const u=s.newScenario(it.RG.EspWindowRender);try{const{displayEspSurface:e}=yield od(s),t=yield e(n,i,o,r,id.LQ.AppReady,new ld(l,o));if(u.stop(),t){const{entity:{id:e,type:n}}=t;e&&a.esp.launchDialog(e,n)}}catch(e){u.fail()}}))}const md={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsEspTriggerSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"espTriggerEvent"}}]}}]};function gd(e){const{client:t,coreSettings:n,authenticationUser:a}=e;return{id:"esp-time-based-trigger-job",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableEsp:o,enableTimeBasedEspTrigger:r}=n.get(L.J.Esp);if(!o||!r)return;if((null==a?void 0:a.type)===nd.Ch.Anonymous)return;const s=t.subscribe({query:md,fetchPolicy:"no-cache"}).subscribe((()=>function(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:t,coreSettings:n,loggerFactory:i,platformService:a,scenarioFactory:o,userBiService:r}=e,s="esp_time_based_trigger_job",l=i.newLogger(s,"apps-esp");try{const{displayEspSurface:e}=yield od(o);yield e(t,n,i,a,id.LQ.Daily,new ld(r,i)),l.infoToTelemetry?l.infoToTelemetry("Daily Trigger was invoked",s):l.log("Daily Trigger was invoked")}catch(e){l.errorToTelemetry?l.errorToTelemetry("Daily Trigger has an error",s):l.error("Daily Trigger has an error")}}))}(e)));return()=>{s.unsubscribe()}}))}}const pd=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:t,entityCommand:{entity:{type:n,action:i,id:a},entityOptions:o},requestContext:{client:r,coreSettings:s,loggerFactory:l,platformService:c,scenarioFactory:d,userBiService:m}}=e,{enableEsp:g}=s.get(L.J.Esp),p=a||void 0;if(n===u.p.esp&&i===u.u.create){let e;if(g){const t=d.newScenario(it.RG.EspDisplaySurface);try{const{displayEspSurface:n}=yield od(d),{forceShow:i,triggerType:a,customParams:u}=o||{};e=yield n(r,s,l,c,a===id.LQ.FollowUp?id.LQ.FollowUp:id.LQ.Manual,new ld(m,l),{surfaceId:p,forceShow:i,customParams:u}),t.stop({surfaceId:p})}catch(e){t.fail({surfaceId:p})}}return e}return t})),vd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsEspSyntheticNotificationToastSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"syntheticNotificationToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderGivenName"}},{kind:"Field",name:{kind:"Name",value:"senderId"}},{kind:"Field",name:{kind:"Name",value:"subtype"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"campaignType"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}}]}}]}}]},hd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEspToastImageAsDataUriQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};var fd;function yd(e){const{client:t,coreSettings:n,i18n:a,entityCommanding:o,loggerFactory:r,authenticationUser:s}=e;return{id:"esp-synthetic-notification-toast-subscription-job",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableEsp:e,enableSyntheticNotificationToast:l}=n.get(L.J.Esp);if(!e||!l)return;if((null==s?void 0:s.type)===nd.Ch.Anonymous)return;const c=t.subscribe({query:vd,fetchPolicy:"no-cache"}).subscribe(function(e,t,n,a){return o=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i;const r=n.newLogger("SyntheticNotificationToastEventSubscription","apps-esp");if(o.errors){const e=(0,wi.u4)(o.errors.map((e=>e.message)).join());return void r.error(`${li.f.SubscriptionFailed} ${e}`)}if(!(null===(i=o.data)||void 0===i?void 0:i.syntheticNotificationToastEvent))return void r.error(li.f.EmptyEvent);const{syntheticNotificationToastEvent:s}=o.data,l=function(e,t,n){var i;return{conversationId:t.messageId,messageId:t.messageId,quickReply:!1,time:new Date(+t.timestamp),text:bd(e,t,"description",n),title:bd(e,t,"title",n),type:"SyntheticNotification",campaignType:null!==(i=t.campaignType)&&void 0!==i?i:void 0}}(t,s,r),c=yield Sd(a,r,s.imageUrl||void 0);return c&&(l.mainImage={alt:"",src:c}),e.toasts.showEspSyntheticNotification(s.correlationId,l)}))}(o,a,r,t));return()=>{c.unsubscribe()}}))}}function bd(e,t,n,i){const a=(()=>{switch(t.campaignType){case fd.meeting:return`activity_esp_meeting_recommendation_${n}`;case fd.chat:return`activity_esp_chat_recommendation_${n}`;case fd.upgrade:return`activity_esp_upgrade_recommendation_${n}`;case fd.files:return`activity_esp_files_recommendation_${n}`;default:return void i.error(`Campaign Type is not valid ${t.campaignType}`)}})();return a?e.stringTranslate("activity",a):""}!function(e){e.chat="chatCampaign",e.meeting="meetingCampaign",e.upgrade="upgradeCampaign",e.files="filesCampaign"}(fd||(fd={}));const Sd=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(n)try{const t=yield e.query({query:hd,fetchPolicy:"no-cache",variables:{url:n}});return(null==t?void 0:t.data.toastImageAsDataUri)||void 0}catch(e){return void t.error(li.f.ImageFetchFailed)}}));var kd=n(553285);const wd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsEspSurfaceShownSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"surfaceIds"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"espSurfaceShownEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"surfaceIds"},value:{kind:"Variable",name:{kind:"Name",value:"surfaceIds"}}}]}]}}]};class Cd{constructor(e,t,n,a,o,r,s,l){this.logger=a,this.entityCommanding=o,this.parseExpression=r,this.displaySurface=l;const c=t.getObservable(L.J.Esp);this.biSurfaces=this.toBiSurfaces(e),this.configSubscription=c.subscribe((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{surfaces:e}=yield s();this.biSurfaces=this.toBiSurfaces(e)})))),this.surfaceShownSubscription=n.subscribe({query:wd,variables:{surfaceIds:this.biSurfaces.map((e=>e.id))},fetchPolicy:"no-cache"}).subscribe((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{surfaces:e}=yield s();this.biSurfaces=this.toBiSurfaces(e)}))))}onSignal(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=this.biSurfaces.filter((t=>t.invoke(e))).map((e=>e.id));if(!t.length)return;let n=e.data["Panel.WindowID"];this.isEventFromSyntheticNotificationToast(e)&&(n=kd.f);const i=yield this.displaySurface(t,n);if(i){const{entity:{id:e,type:t}}=i;e&&this.entityCommanding.esp.launchDialog(e,t)}}))}unsubscribe(){this.configSubscription.unsubscribe(),this.surfaceShownSubscription.unsubscribe()}toBiSurfaces(e){return e.filter((e=>-1===e.recur||e.recur>e.displayed.length)).filter((e=>e.trigger===id.LQ.BIEvent)).map((e=>{try{const t=this.parseExpression(e.triggerFilter||"");return{id:e.id,invoke:e=>t.evaluate(e)}}catch(t){return void this.logger.error(`invalid BITrigger trigger filter value for surface ${e.id} with triggerFilter ${e.triggerFilter}`)}})).filter((e=>!!e))}isEventFromSyntheticNotificationToast(e){return"SyntheticNotification"===e.data["Panel.Type"]&&"toast"===e.data["Panel.Region"]}}const _d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsEspRecordCompletedActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actions"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recordEspCompletedActions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"actions"},value:{kind:"Variable",name:{kind:"Name",value:"actions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"completedActions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}}]}}]};var Td=n(538427);class Id{constructor(e,t,n,a,o,r){this.logger=t,this.parseExpression=n,this.client=a,this.coreSettings=o;const s=o.getObservable(L.J.Esp);this.actionRegistrations=this.getActionRegistrations(e),this.configSubscription=s.subscribe((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{espState:e}=yield r();this.actionRegistrations=this.getActionRegistrations(e)}))))}onSignal(e){const t=this.actionRegistrations.filter((t=>t.invoke(e))).map((e=>e.action));if(t.length){this.actionRegistrations=this.actionRegistrations.filter((e=>-1===t.indexOf(e.action)));const{enableEspStateApolloCache:e}=this.coreSettings.get(L.J.Esp);this.client.mutate({mutation:_d,variables:{actions:t},refetchQueries:e?[{query:Td.$,fetchPolicy:"no-cache"}]:void 0})}}unsubscribe(){this.configSubscription.unsubscribe()}getActionRegistrations(e){const t=e.userState.completedActions.reduce(((e,t)=>e.add(t.action)),new Set);return this.getEspTrackedActions(this.coreSettings).filter((e=>!t.has(e.action))).map((e=>{var t,n;try{const t=this.parseExpression(e.expression);return{action:e.action,invoke:e=>t.evaluate(e)}}catch(i){return void(null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`invalid data registration expression for action ${e.action} with expression ${e.expression}`,"esp_signal_handler"))}})).filter((e=>!!e))}getEspTrackedActions(e){const t=e.get(L.J.Esp),n=[];return Object.keys(t).forEach((e=>{const i=t[e];(null==i?void 0:i.trackedAction)&&!(null==i?void 0:i.disabled)&&n.push({action:i.trackedAction,expression:i.expression})})),n}}class Ed{onSignal(e){}unsubscribe(){}}function Nd(e){const{coreSettings:t,userBiService:n,scenarioFactory:a,client:o,loggerFactory:r,platformService:s,entityCommanding:l,authenticationUser:c}=e;return{id:"esp-signal-handler-job",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e;const{enableEsp:d,enableEspBiEventTrigger:u,enableEspCompletedActions:m}=t.get(L.J.Esp);if(!d)return;if((null==c?void 0:c.type)===nd.Ch.Anonymous)return;if(!u&&!m)return;const{getConfig:g,parseExpression:p,displayEspSurface:v}=yield od(a),h=r.newLogger("esp-signal-handler-job","apps-esp"),{surfaces:f,espState:y}=yield g(o,t,h),b=()=>g(o,t,h),S=u?new Cd(f,t,o,h,l,p,b,((e,i)=>v(o,t,r,s,id.LQ.BIEvent,new ld(n,r),{surfaceIds:e},i))):new Ed,k=m?new Id(y,h,p,o,t,b):new Ed,w=null===(e=null==n?void 0:n.observe)||void 0===e?void 0:e.call(n).subscribe({next:e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){k.onSignal(e),S.onSignal(e)}))});return()=>{null==w||w.unsubscribe(),S.unsubscribe()}}))}}const Ad=()=>Promise.all([n.e(893479),n.e(602460),n.e(939626),n.e(849736)]).then(n.bind(n,725582));function Fd(){const e=()=>null;return{manifest:td,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Modal){const e="esp-dialog";n("ChunkLoadStarted",{chunkName:e});const{EspDialogComponent:t}=yield(0,c.mT)(Ad,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)})),onPreWarm:e=>{const{context:t}=e;return[cd(t),gd(t),yd(t),Nd(t)]},onUserWindowPreWarm:e=>{const{context:t}=e;return[dd(t)]},onBeforeCommandHandled:pd,UNSAFE_onSignal:ud}}const Dd={id:"com.microsoft.teams.filePicker",name:"FilePickerApp",supportedEntities:[u.p.filepicker],supportedRenderModes:[s.S.Modal]},Rd=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(899405),n.e(287783),n.e(907784),n.e(838608),n.e(168904),n.e(687601),n.e(553211),n.e(522024),n.e(511402),n.e(274690),n.e(714133),n.e(92700),n.e(175868),n.e(990255),n.e(769229),n.e(68101),n.e(352769),n.e(623025),n.e(579814),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(929389),n.e(958163),n.e(301920),n.e(51566),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(152269),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(645508),n.e(317689),n.e(908915),n.e(365130),n.e(842905),n.e(975421),n.e(335938),n.e(327119),n.e(757052),n.e(546933),n.e(546894),n.e(451115),n.e(868123)]).then(n.bind(n,107391));function xd(){const e=()=>null;return{manifest:Dd,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a,loggerFactory:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=r.newLogger("FilePickerApp","apps-file-picker");if(t===s.S.Modal){const e="file-picker-app";i.log("chunk load start"),n("ChunkLoadStarted",{chunkName:e}),i.log("experimental import start");const{FilePickerComposeDialogRenderer:t}=yield(0,c.mT)(Rd,e,a);return i.log("report chunk load success"),n("ChunkLoadSucceeded",{chunkName:e}),i.log("Rendering file picker compose dialog"),o.createElement(t,null)}return o.createElement(e,null)}))}}const Md={id:"com.microsoft.teams.files",name:"FilesApp",supportedEntities:[u.p.file],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.file,action:u.u.error}),windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Od=({appRenderMode:e,coreSettings:t})=>{const n=new ht.H,{criticalPhaseTimeout:i,postCriticalPhaseTimeout:a}=t.get(L.J.Files),o=[];switch(e){case s.S.Main:o.push(ft.GZ.P2P_FILES_LIST_VIEW_RENDERED)}return n.registerAppPhase({phase:ft.nh.CRITICAL,signals:o,timeout:i||3e4}),n.registerAppPhase({phase:ft.nh.POST_CRITICAL,signals:[],timeout:a||1e4}),n.appPhases},Pd=({entity:e})=>e.type===u.p.file&&e.action===u.u.list?it.RG.P2PFilesListSwitch:it.RG.FilesAppSwitch,Ld=e=>{if(Ud(e))return jd(e)?{subNavEntity:$d(e),headerEntity:Bd(e),startEntity:Wd(e),mainEntity:Hd(e),endEntity:Vd(e)}:null},Ud=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=i===u.p.file,r=n&&[u.u.list,u.u.error].includes(n);return!!(a&&o&&r)},jd=()=>!0,$d=()=>null,Bd=()=>null,Wd=()=>null,Hd=({entity:e})=>e,Vd=()=>null,zd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsFilesPersonalSiteDetailsFromUploadQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getPersonalSiteInfoForUpload"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"listUrl"}}]}}]}}]},qd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsFilesRegisterTokenWarmingResourceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"service"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"registerTokenWarmingResource"},arguments:[{kind:"Argument",name:{kind:"Name",value:"service"},value:{kind:"Variable",name:{kind:"Name",value:"service"}}},{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}}]}]}}]},Gd=({context:{client:e,coreSettings:t}})=>[{id:"files-register-resources",runOncePerId:!0,job:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n;const{tenantSiteUrl:i}=t.get(L.J.Tenant),a=(null==i?void 0:i.webUrl)&&new URL(null==i?void 0:i.webUrl),o=a&&a.origin||void 0;o&&e.mutate({mutation:qd,variables:{service:"Files",resource:o}});const r=yield e.query({query:zd,fetchPolicy:"cache-first"}),{siteUrl:s}=null===(n=null==r?void 0:r.data)||void 0===n?void 0:n.getPersonalSiteInfoForUpload,l=s&&new URL(s),c=l&&l.origin||void 0;c&&e.mutate({mutation:qd,variables:{service:"PersonalFiles",resource:c}})}))}],Jd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsFileBrowserPreWarmAuthenticationTokenQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]};var Qd=n(764302);const Kd=()=>({result:"success"}),Yd=(e,t)=>(t.error("Error executing command in filebrowser pre warm: ".concat(e.message)),{result:"error",error:{code:e.code||"unknown",message:e.message}}),Xd=e=>({result:"error",error:{code:"unsupportedCommand",message:e.command}}),Zd=e=>t=>{e(t.data)},eu=(e,t,n)=>{const{close:a,authenticate:o}=t,r=(({sendAck:e,sendCommandResult:t,close:n,authenticate:a,logger:o})=>r=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){switch(r.type){case"command":e(r);const i=r.data;switch(i.command){case"close":n(i).then((()=>{t(r,Kd())}),(e=>{t(r,Yd(e,o))}));break;case"authenticate":a(i).then((e=>{t(r,e)}),(e=>{t(r,Yd(e,o))}));break;default:t(r,Xd(i))}}})))({sendAck:t=>{e&&e.postMessage({type:"acknowledge",id:t.id})},sendCommandResult:(t,n)=>{e&&e.postMessage({type:"result",id:t.id,data:n})},close:a,authenticate:o,logger:n});((e,t)=>{const n=Zd(t);e&&(e.addEventListener("message",n),e.start(),e.postMessage({type:"activate"}))})(e,r)},tu=(e,t,n,a,o,r,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const l=n.newLogger("fileBrowserPreWarm","components-file-browser-pre-warm"),c=t.findScenario(it.RG.FileBrowserPreWarm),{fileBrowserHiddenIframeCloseInterval:d}=r.get(L.J.Files),u=`${Math.random().toFixed(8)}`,m=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n,i;const{resource:o}=e,r=new URL(o).origin;l.log(`getAuthToken triggered for resource: ${o}`),null==c||c.mark(Qd.le.telemetry.markers.filebrowser_prewarm_auth_token_start);const s=null!==(i=null===(n=null===(t=(yield a.query({query:Jd,fetchPolicy:"network-only",variables:{resource:r}})).data)||void 0===t?void 0:t.authenticationToken)||void 0===n?void 0:n.token)&&void 0!==i?i:"";return null==c||c.mark(Qd.le.telemetry.markers.filebrowser_prewarm_auth_token_end),Promise.resolve(s)})),g=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const a=n.newLogger("fileBrowserPreWarm","components-file-browser-pre-warm"),r=t.findScenario(it.RG.FileBrowserPreWarm);null===(i=o.document.getElementById("filesAppIframe"))||void 0===i||i.remove(),a.log("Removed Hidden Iframe"),null==r||r.mark(Qd.le.telemetry.markers.filebrowser_prewarm_window_removed,void 0,e?"timeout":"success"),null==r||r.stop(),Promise.resolve()})),p=iu(o);p||(null==c||c.mark(Qd.le.telemetry.markers.filebrowser_prewarm_window_creation_failed),null==c||c.fail({errorMessage:"Failed to create iframe"}),Promise.resolve()),l.log("Created Hidden Iframe"),null==c||c.mark(Qd.le.telemetry.markers.filebrowser_prewarm_window_creation_successful);const{localeCode:v}=r.get(L.J.Platform),h=nu(e,o,u,null!=v?v:void 0);yield((e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,o;const r=new URL(t).origin,s=yield n({resource:r});if(s&&e){const n=e.document.createElement("form");e.document.body.appendChild(n);const o=e.document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name","access_token"),o.setAttribute("value",s),n.appendChild(o),n.setAttribute("action",t),n.setAttribute("method","POST"),n.submit(),null===(i=null==a?void 0:a.findScenario(it.RG.FileBrowserPreWarm))||void 0===i||i.mark("Form Created and submitted")}else null===(o=null==a?void 0:a.findScenario(it.RG.FileBrowserPreWarm))||void 0===o||o.fail({errorMessage:"Token fetch failed"})})))(p,h,m,t),au(d,o,g);const f=yield((e,t,n)=>{let i;return new Promise(((a,o)=>{let r;const s=e=>{if(e.source&&t&&e.source===t&&"initialize"===e.data.type){r&&(clearInterval(r),r=void 0);const t=e.ports&&e.ports[0];if(t)return i=t,void a(i);o(i)}};t?(r=setInterval((()=>{var a;i?(clearInterval(r),r=void 0):t.postMessage({type:"identify-parent",channelId:e},null===(a=n.document.location)||void 0===a?void 0:a.origin)}),100),n.addEventListener("message",s)):a(i)}))})(u,p,o),y=((e,t,n,a)=>({close:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;null==t||t.log("Close post meessage received"),null===(e=null==n?void 0:n.findScenario(it.RG.FileBrowserPreWarm))||void 0===e||e.mark(Qd.le.telemetry.markers.filebrowser_prewarm_close_post_message),a&&(yield a(!1))})),authenticate:a=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,o;null==t||t.log(`Authenticate post meessage received for ${a.resource}`),null===(i=null==n?void 0:n.findScenario(it.RG.FileBrowserPreWarm))||void 0===i||i.mark(Qd.le.telemetry.markers.filebrowser_prewarm_auth_post_message);const r=yield e({resource:a.resource});return r?{result:"token",scheme:"bearer",token:r}:(null==t||t.log("Not able to PreWarm the App"),null===(o=null==n?void 0:n.findScenario(it.RG.FileBrowserPreWarm))||void 0===o||o.mark(Qd.le.telemetry.markers.filebrowser_prewarm_auth_token_failed),{result:"error",error:{code:"NoTokenObtained",message:"Could not obtain a token for resource."}})}))}))(m,l,t,g);eu(f,y,l),null==s||s.set("FileAppPreWarmTimeStamp",Date.now().toString())})),nu=(e,t,n,i)=>{var a,o;return`${e}_layouts/15/filebrowser.aspx?app=TeamsFile&fileBrowser={"sdk":"8.0","messaging":{"origin":"${null!==(o=null===(a=null==t?void 0:t.location)||void 0===a?void 0:a.origin)&&void 0!==o?o:void 0}","channelId":"${n}"},"authentication":{},"entry":{"oneDrive":{"recent":{}}}}&scenario=OneDriveFiles&auth=none&locale=${i}&hostName=TeamsModern&preWarmFB=true`},iu=e=>{const t=e.document.createElement("iframe");return t&&(t.setAttribute("id","filesAppIframe"),t.style.display="none",t.setAttribute("target","_self"),e.document.body.appendChild(t)),t&&t.contentWindow||null},au=(e,t,n)=>{let i,a=12e3;e&&e>0&&(a=e),i=void 0,i=t.setTimeout((()=>{n(!0),t.clearTimeout(i)}),a)};const ou=({context:{coreSettings:e,hostCommunicationService:t,loggerFactory:n,scenarioFactory:a,client:o,localStorage:r,windowProvider:s,platformService:l}})=>{const c=[],{preWarmFileBrowser:d,fileBrowserRelaunchHiddenIframeInterval:u}=e.get(L.J.Files),m=n.newLogger("FilesAppPreWarmJob","apps-files"),g=null==a?void 0:a.newScenario(it.RG.FileBrowserPreWarmIdleStateTrigger);if(d){null==m||m.log("Entered Idle Experience path");const d=null==r?void 0:r.get("FileAppPreWarmTimeStamp");let p=!0;if(d){const e=null!=u?u:864e5,t=+d;p=Date.now()-t>e}p?(null==m||m.log("Push the Files App pre Warm Job"),null==g||g.stop({reason:"Job-pushed"}),c.push(function(e){const{loggerFactory:t,scenarioFactory:n,client:a,localStorage:o,windowProvider:r,coreSettings:s}=e;return{id:"files-app-pre-warm-job",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e,i;const l=n.newScenario(it.RG.FileBrowserPreWarm),c=t.newLogger("FilesAppPreWarmJob","apps-files");c.log("files_app_pre_warm_job triggered");try{const i=yield a.query({query:zd}),{siteUrl:c}=null===(e=null==i?void 0:i.data)||void 0===e?void 0:e.getPersonalSiteInfoForUpload;c?yield tu(c,n,t,a,r,s,o):l.incomplete({errorMessage:"Personal SiteInfo fetch failed"})}catch(e){const t=(null==e?void 0:e.errorCode)||(null==e?void 0:e.code),n=`Failed filesAppPreWarmJob with errorCode ${t}`;return null===(i=c.errorToTelemetry)||void 0===i||i.call(c,n,"files_app_pre_warm_job"),void l.fail({errorCode:t,message:null==e?void 0:e.message,errors:null==e?void 0:e.name})}}))}}({coreSettings:e,hostCommunicationService:t,loggerFactory:n,scenarioFactory:a,client:o,localStorage:r,windowProvider:s,platformService:l}))):(null==m||m.log("Skip the Files App pre Warm Job"),null==g||g.stop({reason:"Job-Skipped"}))}return c},ru={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case ln.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:mn(i)})}return Promise.resolve(void 0)}},su=()=>Promise.all([n.e(893479),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(687601),n.e(284790),n.e(137434),n.e(968204),n.e(623025),n.e(579814),n.e(110350),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(904642),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(152269),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(645508),n.e(908915),n.e(842905),n.e(975421),n.e(589835),n.e(954233),n.e(742008),n.e(959139)]).then(n.bind(n,318593)),lu=()=>Promise.all([n.e(893479),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(687601),n.e(284790),n.e(137434),n.e(968204),n.e(623025),n.e(579814),n.e(110350),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(904642),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(152269),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(645508),n.e(908915),n.e(842905),n.e(975421),n.e(589835),n.e(954233),n.e(742008),n.e(959139)]).then(n.bind(n,697633));function cu(){const e=()=>null,t="apps-files",n={chunkName:t};return{eventHandlers:ru,getAppPhases:Od,getAppViewEntities:Ld,getCommandScenarioName:Pd,manifest:Md,render:({appRenderMode:a,coreSettings:r,onRenderEvent:s,scenarioFactory:l,entity:d})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(d.type===u.p.file&&d.action===u.u.list){s("ChunkLoadStarted",n);const{enableEntityMoreInfo:e}=r.get(L.J.Core),i=({children:e})=>o.createElement(o.Fragment,null,e),{P2PFilesListViewsRenderer:d}=yield(0,c.mT)(su,t,l),{LPC:u}=e?{LPC:i}:yield(0,c.mT)(lu,t,l),m=e?i:vn.p3;return s("ChunkLoadSucceeded",n),o.createElement(u,null,o.createElement(m,null,o.createElement(d,{appRenderMode:a})))}return o.createElement(e,null)})),onPreWarm:Gd,onExperienceIdle:ou}}const du={id:"com.microsoft.teams.filesoneupviewer",name:"FilesoneupviewerApp",supportedEntities:[u.p.filesoneupviewer],supportedRenderModes:[s.S.HorizontalBar,s.S.Main]},uu=e=>{if(mu(e))return gu(e)?{subNavEntity:pu(e),headerEntity:vu(e),startEntity:hu(e),mainEntity:fu(e),endEntity:yu(e)}:null},mu=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.filesoneupviewer].includes(i),r=n&&[u.u.view].includes(n);return!!(a&&o&&r)},gu=()=>!0,pu=({entity:e,layoutMode:t})=>t===d.lO.focus?null:e,vu=({entity:e})=>e,hu=()=>null,fu=({entity:e})=>e,yu=({contextEntity:e})=>(null==e?void 0:e.type)===u.p.chats?e:null;var bu;!function(e){e.DeepLinkNotEnabled="deeplink-not-enabled-error",e.MissingFileId="missing-fileId-error"}(bu||(bu={}));const Su=(e,t)=>{const{fileId:n,fileType:i,threadId:a,objectUrl:o,serviceName:r,shareUrl:s,context:l}=e;return Promise.resolve({entityCommand:{entity:{type:u.p.filesoneupviewer,id:n,action:t},command:{visibilityState:d.fe.show,stateTransition:d.su.flush},entityOptions:{fileId:n,fileType:i,threadId:a,objectUrl:o,serviceName:r,shareUrl:s,context:l}},metadata:{allowAnonymous:!1}})},ku=[{filter:"/l/file",execute:({deeplinkUrl:e,context:{coreSettings:t}})=>{if(!wu(t))return Promise.reject({message:bu.DeepLinkNotEnabled});const{entityOptions:n}=(e=>{var t,n,i,a,o,r;const{pathname:s,searchParams:l}=e,c=s.split("/l/file/");return{entityOptions:{fileId:null!==(t=c[c.length-1])&&void 0!==t?t:"",fileType:null!==(n=l.get("fileType"))&&void 0!==n?n:"",threadId:null!==(i=l.get("threadId"))&&void 0!==i?i:"",objectUrl:null!==(a=l.get("objectUrl"))&&void 0!==a?a:"",serviceName:null!==(o=l.get("serviceName"))&&void 0!==o?o:"",shareUrl:null!==(r=l.get("emailHtmlLink"))&&void 0!==r?r:"",context:"bim"}}})(e);return n.fileId?Su(n,u.u.view):Promise.reject({message:bu.MissingFileId})}}],wu=e=>!!(null==e?void 0:e.get(L.J.Outlook).enableDeepLinkFilesOneUpViewer),Cu=()=>Promise.all([n.e(134315),n.e(284790),n.e(708204),n.e(795037)]).then(n.bind(n,746632));function _u(){return{getAppViewEntities:uu,manifest:du,render:({appRenderMode:e,onRenderEvent:t})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n="files-viewer-oneup";t("ChunkLoadStarted",{chunkName:n});const[{FilesViewerOneupViewsRenderer:i}]=yield Promise.all([(0,c.mT)(Cu,n)]);return t("ChunkLoadSucceeded",{chunkName:n}),o.createElement(i,{appRenderMode:e})})),onBeforeDeeplinkParsed:ku}}const Tu={id:"com.microsoft.teams.freemium-upgrade",name:"FreemiumUpgradeApp",supportedEntities:[u.p.freemiumupgrade],supportedRenderModes:[s.S.Main]},Iu=()=>n.e(877233).then(n.bind(n,618019));function Eu(){const e=()=>null;return{manifest:Tu,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="freemium-upgrade";n("ChunkLoadStarted",{chunkName:e});const{FreemiumUpgradeNotification:t}=yield(0,c.mT)(Iu,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)}))}}const Nu={id:"com.microsoft.teams.gallery",name:"GalleryApp",supportedEntities:[u.p.gallery],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.gallery,action:u.u.view}),windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Au=e=>{if(Fu(e))return Du(e)?{subNavEntity:Ru(e),headerEntity:xu(e),startEntity:Mu(e),mainEntity:Ou(e),endEntity:Pu(e)}:null},Fu=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.gallery].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},Du=()=>!0,Ru=()=>null,xu=()=>null,Mu=()=>null,Ou=({entity:e})=>e,Pu=()=>null,Lu=()=>Promise.all([n.e(921132),n.e(954233),n.e(424693),n.e(19753)]).then(n.bind(n,707662));function Uu(){const e=()=>null;return{getAppViewEntities:Au,manifest:Nu,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="gallery-app";n("ChunkLoadStarted",{chunkName:e});const{Gallery:t}=yield(0,c.mT)(Lu,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)}))}}const ju={id:"com.microsoft.teams.guardians",name:"GuardiansApp",supportedEntities:[u.p.guardians],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},$u=e=>{if(Bu(e))return Wu(e)?{subNavEntity:Hu(e),headerEntity:Vu(e),startEntity:zu(e),mainEntity:qu(e),endEntity:Gu(e)}:null},Bu=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.guardians].includes(i),r=n&&[u.u.list].includes(n);return!!(a&&o&&r)},Wu=()=>!0,Hu=({entity:e,layoutMode:t})=>t===d.lO.focus?null:e,Vu=({entity:e})=>e,zu=()=>null,qu=({entity:e})=>e,Gu=()=>null,Ju={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case ln.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:mn(i)})}return Promise.resolve(void 0)}},Qu=({appRenderMode:e})=>{const t=new ht.H,n=[],i=[];switch(e){case s.S.Main:Ku({criticalSignals:n,postCriticalSignals:i,featureFlags:{}});break;case s.S.HorizontalBar:case s.S.Rail:}return t.registerAppPhase({phase:ft.nh.CRITICAL,signals:n,timeout:3e4}),t.appPhases},Ku=({criticalSignals:e})=>{e.push(ft.GZ.GUARDIANS_APP_RENDERED)},Yu=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(907784),n.e(168904),n.e(687601),n.e(553211),n.e(511402),n.e(860024),n.e(34693),n.e(674881),n.e(92285),n.e(932639),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(604068),n.e(921132),n.e(757839),n.e(469330),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(398949),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(787970),n.e(842905),n.e(248361),n.e(675049),n.e(327119),n.e(262855),n.e(354066),n.e(369687),n.e(64113),n.e(302755),n.e(119751),n.e(181790),n.e(757052),n.e(245526),n.e(107052),n.e(335085),n.e(419347),n.e(314121),n.e(829861)]).then(n.bind(n,805148)),Xu=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(907784),n.e(168904),n.e(687601),n.e(553211),n.e(511402),n.e(860024),n.e(34693),n.e(674881),n.e(92285),n.e(932639),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(604068),n.e(921132),n.e(757839),n.e(469330),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(398949),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(787970),n.e(842905),n.e(248361),n.e(675049),n.e(327119),n.e(262855),n.e(354066),n.e(369687),n.e(64113),n.e(302755),n.e(119751),n.e(181790),n.e(757052),n.e(245526),n.e(107052),n.e(335085),n.e(419347),n.e(314121),n.e(829861)]).then(n.bind(n,697633));function Zu(){return{eventHandlers:Ju,getAppPhases:Qu,getAppViewEntities:$u,getCommandScenarioName:()=>it.RG.GuardiansAppLoad,manifest:ju,render:({appRenderMode:e,coreSettings:t,onRenderEvent:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="guardians-app";n("ChunkLoadStarted",{chunkName:i});const{enableEntityMoreInfo:a}=t.get(L.J.Core),r=({children:e})=>o.createElement(o.Fragment,null,e),{GuardiansAppViews:s}=yield(0,c.mT)(Yu,i),{LPC:l}=a?{LPC:r}:yield(0,c.mT)(Xu,i),d=a?r:vn.p3;return n("ChunkLoadSucceeded",{chunkName:i}),o.createElement(l,null,o.createElement(d,null,o.createElement(s,{appRenderMode:e})))}))}}const em=e=>{if(tm(e))return nm(e)?{subNavEntity:im(e),headerEntity:am(e),startEntity:om(e),mainEntity:rm(e),endEntity:sm(e)}:null},tm=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=Boolean(u.p.help===i),r=n&&[u.u.view].includes(n);return!!(a&&o&&r)},nm=()=>!0,im=()=>null,am=()=>null,om=()=>null,rm=()=>null,sm=()=>null,lm={id:"com.microsoft.teams.help",name:"HelpApp",supportedEntities:[u.p.help,u.p.whatsnewdialog],supportedRenderModes:[s.S.Modal,s.S.Main],windowFeatures:{minWidth:800,minHeight:600,width:800,height:600,offset:20,top:0,left:0}},cm=()=>Promise.all([n.e(893479),n.e(134315),n.e(602460),n.e(939626),n.e(524090)]).then(n.bind(n,205617)),dm=()=>Promise.all([n.e(893479),n.e(134315),n.e(602460),n.e(939626),n.e(524090)]).then(n.bind(n,693219)),um=()=>lm.windowFeatures||{};function mm(){const e=()=>null;return{getAppViewEntities:em,manifest:lm,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="help-app";if(t===s.S.Modal){n("ChunkLoadStarted",{chunkName:i});const{WhatsNewViewsRenderer:e}=yield(0,c.mT)(cm,i,a);return n("ChunkLoadSucceeded",{chunkName:i}),o.createElement(e,{appRenderMode:t})}if(t===s.S.Main){n("ChunkLoadStarted",{chunkName:i});const{HelpViewRenderer:e}=yield(0,c.mT)(dm,i,a);return n("ChunkLoadSucceeded",{chunkName:i}),o.createElement(e,{appRenderMode:t})}return o.createElement(e,null)})),getAppWindowFeatures:um}}const gm={id:"com.microsoft.teams.hybrid",name:"HybridApp",supportedEntities:[u.p.blank],supportedRenderModes:[s.S.Main]},pm=e=>{if(vm(e))return hm(e)?{subNavEntity:fm(e),headerEntity:ym(e),startEntity:bm(e),mainEntity:Sm(e),endEntity:km(e)}:null},vm=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.standard].includes(e),o={[u.p.blank]:[u.u.default,u.u.view]},r=n&&(o[i]||[]).includes(n);return!(!a||!r)},hm=()=>!0,fm=()=>null,ym=()=>null,bm=()=>null,Sm=({entity:e})=>e,km=()=>null,wm=({areEmptySlotsTransparent:e})=>({[C.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:e}}});function Cm(){const e=()=>null;return{getAppViewEntities:pm,getAppViewEntitiesProps:wm,manifest:gm,render:({onRenderEvent:t,entity:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return t("CriticalInitRender",{isBlanked:n.type===u.p.blank}),o.createElement(e,null)}))}}const _m={id:"com.microsoft.teams.linkedin",name:"LinkedInApp",supportedEntities:[u.p.linkedin],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Tm=e=>{if(Im(e))return Em(e)?{subNavEntity:Nm(e),headerEntity:Am(e),startEntity:Fm(e),mainEntity:Dm(e),endEntity:Rm(e)}:null},Im=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.linkedin].includes(i),r=n&&[u.u.create,u.u.default,u.u.list,u.u.view].includes(n);return!!(a&&o&&r)},Em=()=>!0,Nm=({entity:e,layoutMode:t})=>t===d.lO.focus?null:e,Am=({entity:e})=>e,Fm=()=>null,Dm=({entity:e})=>e,Rm=()=>null,xm=()=>Promise.all([n.e(129408),n.e(401764),n.e(71053),n.e(767433),n.e(633586)]).then(n.bind(n,77482));function Mm(){const e=()=>null;return{getAppViewEntities:Tm,manifest:_m,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="apps-linkedin";n("ChunkLoadStarted",{chunkName:e});const{LinkedIn:t}=yield(0,c.mT)(xm,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)}))}}const Om="meet",Pm="viewMeetApp",Lm=()=>({actor:Om,action:Pm}),Um={id:"com.microsoft.teams.meet",name:"MeetApp",actors:[Om],supportedEntities:[u.p.meet],supportedRenderModes:[s.S.Main]},jm=e=>{if($m(e))return Bm(e)?{subNavEntity:Wm(e),headerEntity:Hm(e),startEntity:Vm(e),mainEntity:zm(e),endEntity:qm(e)}:null},$m=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.meet].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},Bm=()=>!0,Wm=()=>null,Hm=()=>null,Vm=()=>null,zm=({entity:e})=>e,qm=()=>null,Gm=()=>({[C.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!0}}}),Jm={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case ln.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:mn(i)})}return Promise.resolve(void 0)}},Qm=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("MeetApp onCommandReceived","apps-meet");if(e.command.actor===Om)switch(n){case Pm:return{entity:{type:u.p.meet,action:u.u.default},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.Unknown}}};default:i.error(`Command action '${n}' is not supported at MeetApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by MeetApp.`)})),Km=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(899405),n.e(287783),n.e(907784),n.e(838608),n.e(168904),n.e(687601),n.e(553211),n.e(522024),n.e(511402),n.e(274690),n.e(714133),n.e(92700),n.e(175868),n.e(990255),n.e(769229),n.e(68101),n.e(352769),n.e(623025),n.e(579814),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(929389),n.e(958163),n.e(301920),n.e(51566),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(152269),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(645508),n.e(317689),n.e(908915),n.e(365130),n.e(842905),n.e(975421),n.e(335938),n.e(327119),n.e(757052),n.e(546933),n.e(546894),n.e(451115),n.e(868123)]).then(n.bind(n,831629)),Ym=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(899405),n.e(287783),n.e(907784),n.e(838608),n.e(168904),n.e(687601),n.e(553211),n.e(522024),n.e(511402),n.e(274690),n.e(714133),n.e(92700),n.e(175868),n.e(990255),n.e(769229),n.e(68101),n.e(352769),n.e(623025),n.e(579814),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(929389),n.e(958163),n.e(301920),n.e(51566),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(152269),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(645508),n.e(317689),n.e(908915),n.e(365130),n.e(842905),n.e(975421),n.e(335938),n.e(327119),n.e(757052),n.e(546933),n.e(546894),n.e(451115),n.e(868123)]).then(n.bind(n,697633));function Xm(){const e=()=>null;return{eventHandlers:Jm,getAppViewEntities:jm,getAppViewEntitiesProps:Gm,getPlatformAppIdForEntity:e=>e.type===u.p.meet?"957ed0e3-e5ca-4c82-9676-fd037185c4d8":void 0,manifest:Um,onCommandReceived:Qm,render:({appRenderMode:t,coreSettings:n,onRenderEvent:a,scenarioFactory:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="meet-app";a("ChunkLoadStarted",{chunkName:e});const{enableEntityMoreInfo:t}=n.get(L.J.Core),i=({children:e})=>o.createElement(o.Fragment,null,e);r.newScenario(it.RG.MeetAppRender),r.newScenario(it.RG.MeetAppUpcomingRender),r.newScenario(it.RG.MeetAppRecentRender);const{Meet:s}=yield(0,c.mT)(Km,e,r),{LPC:l}=t?{LPC:i}:yield(0,c.mT)(Ym,e,r),d=t?i:vn.p3;return a("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l,null,o.createElement(d,null,o.createElement(s,null)))}return o.createElement(e,null)})),getCommandScenarioName:Zm}}const Zm=()=>it.RG.MeetAppLaunch,eg=e=>{if(tg(e))return ng(e)?{subNavEntity:ig(e),headerEntity:ag(e),startEntity:og(e),mainEntity:rg(e),endEntity:sg(e)}:null},tg=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.attendancereport,u.p.meetinganalytics].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},ng=()=>!0,ig=()=>null,ag=()=>null,og=()=>null,rg=({entity:e})=>e,sg=()=>null,lg={id:"com.microsoft.teams.meetinganalytics",name:"MeetingAnalytics",supportedEntities:[u.p.attendancereport,u.p.meetinganalytics],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.meetinganalytics,action:u.u.view}),windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},cg=()=>Promise.all([n.e(893479),n.e(672617),n.e(134315),n.e(129408),n.e(899405),n.e(657777),n.e(222100),n.e(623025),n.e(579814),n.e(401764),n.e(709528),n.e(730588),n.e(998947),n.e(767546),n.e(365130),n.e(163395),n.e(586496),n.e(298368)]).then(n.bind(n,915267)),dg=()=>lg.windowFeatures||{};function ug(){const e=()=>null;return{getAppViewEntities:eg,getAppWindowFeatures:dg,manifest:lg,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="meeting-analytics-app";n("ChunkLoadStarted",{chunkName:e});const{MeetingAnalyticsRenderer:t}=yield(0,c.mT)(cg,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l.f,{namespaces:["meetingAnalytics"],loaderRenderer:null},o.createElement(t,null))}return o.createElement(e,null)}))}}const mg={getDefaultCommand:()=>({type:u.p.meetings,action:u.u.view}),id:"com.microsoft.teams.meeting-options",name:"MeetingOptionsApp",supportedRenderModes:[s.S.Main,s.S.Modal],supportedEntities:[u.p.meetings,u.p.meetingsettings,u.p.licenses,u.p.meetingoptionscreatedialog],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},gg=e=>{if(pg(e))return vg(e)?{subNavEntity:hg(e),headerEntity:fg(e),startEntity:yg(e),mainEntity:bg(e),endEntity:Sg(e)}:null},pg=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.meetings,u.p.meetingsettings,u.p.licenses,u.p.meetingoptionscreatedialog].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},vg=()=>!0,hg=()=>null,fg=()=>null,yg=()=>null,bg=({entity:e})=>e,Sg=()=>null,kg=()=>({[C.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!0}}}),wg=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(103640),n.e(53866),n.e(623025),n.e(579814),n.e(110350),n.e(305187),n.e(531850),n.e(931517),n.e(787479),n.e(375558)]).then(n.bind(n,728340));function Cg(){return{getAppViewEntities:gg,getAppViewEntitiesProps:kg,manifest:mg,onRegister:e=>{e.registerTask(new Se)},render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="meeting-options-app";t("ChunkLoadStarted",{chunkName:i});const{MeetingOptions:a}=yield(0,c.mT)(wg,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(_g,{scenarioFactory:n},o.createElement(a,{appRenderMode:e}))}))}}const _g=({scenarioFactory:e,children:t})=>(Tg(e),o.createElement(o.Fragment,null,t)),Tg=e=>{const t=o.useRef(e.findScenario(it.RG.MeetingOptionsStart));o.useEffect((()=>{t.current||(t.current=e.cancelExistingAndCreateScenario(it.RG.MeetingOptionsStart,"remount"))}),[e])},Ig=e=>{if(Eg(e))return Ng(e)?{subNavEntity:Ag(e),headerEntity:Fg(e),startEntity:Dg(e),mainEntity:Rg(e),endEntity:xg(e)}:null},Eg=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.meetingrecap].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},Ng=()=>!0,Ag=()=>null,Fg=()=>null,Dg=()=>null,Rg=({entity:e})=>e,xg=({contextEntity:e})=>e&&e.action&&e.type===u.p.meetingcollaboration?e:null,Mg={id:"com.microsoft.teams.meeting-recap",name:"MeetingRecap",supportedEntities:[u.p.meetingrecap,u.p.meetingrecaptab],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.meetingrecap,action:u.u.view}),windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},Og="deep-link";var Pg,Lg,Ug,jg;!function(e){e.recapMeeting="/l/meetingrecap"}(Pg||(Pg={})),function(e){e.FeatureNotEnabled="recap_on_before_deep_link_parsed_feature_not_enabled_error",e.InvalidContext="recap_on_before_deep_link_parsed_invalid_context_error"}(Lg||(Lg={})),function(e){e.FeatureNotEnabled="Feature for parsing recap deep links in T2.1 is not enabled",e.InvalidContext="Parsed recap deep link does not contain valid context query param"}(Ug||(Ug={})),function(e){e.ICalUid="iCalUid",e.ThreadId="threadId",e.timestamp="timestamp",e.defaultRightTab="defaultRightTab",e.organizerId="organizerId",e.tenantId="tenantId",e.meetingType="meetingType",e.recordingId="recordingId",e.subType="subType"}(jg||(jg={}));const $g=({deeplinkUrl:e,parsedDeeplinkHash:t,preferredCommandInput:n,context:{loggerFactory:i}})=>{var a;const o=i.newLogger("MeetingRecapApp onBeforeDeeplinkParsed","apps-meeting-recap");if(null==t?void 0:t.search){const{pathname:e}=t,n=e.split("/")[2];return Promise.resolve({entityCommand:{entity:{type:u.p.meetingrecap,action:u.u.view,id:n},command:{stateTransition:d.su.new,visibilityState:d.fe.show},entityOptions:{subType:Og,threadId:n}},metadata:{allowAnonymous:!1}})}const{searchParams:r}=e,s=r.get(jg.ThreadId)||"",l=r.get(jg.ICalUid)||"",c=r.get(jg.timestamp),m=r.get(jg.defaultRightTab),g=r.get(jg.organizerId),p=r.get(jg.tenantId),v=r.get(jg.meetingType),h=r.get(jg.recordingId),f=r.get(jg.subType)||"";if(!Boolean(s&&l))throw null===(a=o.errorToTelemetry)||void 0===a||a.call(o,Ug.InvalidContext,Lg.InvalidContext),Error(Ug.InvalidContext);return Promise.resolve({entityCommand:{entity:{type:u.p.meetingrecap,action:u.u.view,id:s},command:{stateTransition:d.su.new,visibilityState:d.fe.show},entityOptions:{subType:f?`${Og}-${f}`:Og,externalEntityKey:l,threadId:s,timestamp:c,defaultRightTab:m,organizerId:g,tenantId:p,meetingType:v,recordingId:h}},metadata:{allowAnonymous:!1}})},Bg=[{filter:Pg.recapMeeting,execute:$g},{filter:(e,t)=>Boolean(e.hash)&&((null==t?void 0:t.pathname)||"").startsWith("/meetingrecap/"),execute:$g}],Wg=()=>Promise.all([n.e(893479),n.e(672617),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(284790),n.e(137434),n.e(376585),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(507328),n.e(319187),n.e(705916),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(152269),n.e(597003),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(645508),n.e(365130),n.e(842905),n.e(335938),n.e(53807),n.e(896851),n.e(99252),n.e(588720),n.e(957960)]).then(n.bind(n,465304)),Hg=()=>Promise.all([n.e(893479),n.e(672617),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(284790),n.e(137434),n.e(376585),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(507328),n.e(319187),n.e(705916),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(152269),n.e(597003),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(645508),n.e(365130),n.e(842905),n.e(335938),n.e(53807),n.e(896851),n.e(99252),n.e(588720),n.e(957960)]).then(n.bind(n,697633)),Vg=()=>Mg.windowFeatures||{};function zg(){const e=()=>null;return{getAppViewEntities:Ig,getAppWindowFeatures:Vg,manifest:Mg,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a,coreSettings:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(a.cancelExistingAndCreateScenario(it.RG.MrNavigateSkeleton,"abandon",1e4),t===s.S.Main){const{MeetingRecapRenderer:e}=yield((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n="meeting-recap-app";t("ChunkLoadStarted",{chunkName:n});const[{MeetingRecapRenderer:i},{LPC:a}]=yield Promise.all([(0,c.mT)(Wg,n,e),(0,c.mT)(Hg,n,e)]);return t("ChunkLoadSucceeded",{chunkName:n}),{MeetingRecapRenderer:i,LPC:a}})))(a,n),{enableEntityMoreInfo:t}=r.get(L.J.Core),s=({children:e})=>o.createElement(o.Fragment,null,e),{LPC:d}=t?{LPC:s}:yield(0,c.mT)(Hg,"meeting-recap-app",a),u=t?s:vn.p3;return o.createElement(l.f,{namespaces:["meetingAnalytics","meetingRecap"],loaderRenderer:null},o.createElement(d,null,o.createElement(u,null,o.createElement(e,null))))}return o.createElement(e,null)})),onBeforeDeeplinkParsed:Bg}}const qg={id:"com.microsoft.teams.meeting-room-console",name:"MeetingRoomConsoleApp",supportedEntities:[u.p.meetingroomconsolecall,u.p.meetingroomallinone],supportedRenderModes:[s.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Gg=e=>{if(Jg(e))return Qg(e)?{subNavEntity:Kg(e),headerEntity:Yg(e),startEntity:Xg(e),mainEntity:Zg(e),endEntity:ep(e)}:null},Jg=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.meetingroomconsolecall,u.p.meetingroomallinone].includes(i),r=n&&[u.u.default,u.u.view,u.u.share].includes(n);return!!(a&&o&&r)},Qg=()=>!0,Kg=()=>null,Yg=()=>null,Xg=()=>null,Zg=({entity:e})=>e,ep=()=>null,tp=()=>{const e=new ht.H;return e.registerAppPhase({phase:ft.nh.CRITICAL,signals:[ft.GZ.MEETING_ROOM_MAIN_SCREEN_RENDERED],timeout:9e4}),e.appPhases},np=()=>n.e(434249).then(n.bind(n,438694));function ip(){const e=()=>null;return{getAppPhases:tp,getAppViewEntities:Gg,manifest:qg,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="meeting-room-console-app";n("ChunkLoadStarted",{chunkName:e});const{MeetingRoomEntry:t}=yield(0,c.mT)(np,e,a);return o.createElement(t,null)}return o.createElement(e,null)}))}}const ap={id:"com.microsoft.teams.meeting-room-front-of-room",name:"MeetingRoomFrontOfRoomApp",supportedEntities:[u.p.meetingroomfrontofroom,u.p.meetingroomfrontofroomcontent,u.p.meetingroomfrontofroomgallery],supportedRenderModes:[s.S.Main]},op=e=>{if(rp(e))return sp(e)?{subNavEntity:lp(e),headerEntity:cp(e),startEntity:dp(e),mainEntity:up(e),endEntity:mp(e)}:null},rp=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.meetingroomfrontofroom,u.p.meetingroomfrontofroomcontent,u.p.meetingroomfrontofroomgallery].includes(i),r=n&&[u.u.create].includes(n);return!!(a&&o&&r)},sp=()=>!0,lp=()=>null,cp=()=>null,dp=()=>null,up=({entity:e})=>e,mp=()=>null,gp=()=>{const e=new ht.H;return e.registerAppPhase({phase:ft.nh.CRITICAL,signals:[ft.GZ.MEETING_ROOM_FRONT_OF_ROOM_RENDERED],timeout:9e4}),e.appPhases},pp=()=>Promise.all([n.e(893479),n.e(672617),n.e(134315),n.e(284790),n.e(593492),n.e(845884),n.e(623025),n.e(579814),n.e(110350),n.e(452641),n.e(501749),n.e(41547),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(836083),n.e(699466),n.e(279439),n.e(510510),n.e(534311),n.e(874189),n.e(100240)]).then(n.bind(n,116857));function vp(){const e=()=>null;return{getAppPhases:gp,getAppViewEntities:op,manifest:ap,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="meeting-room-front-of-room-app";n("ChunkLoadStarted",{chunkName:e});const{MeetingRoomFrontOfRoomEntry:t}=yield(0,c.mT)(pp,e,a);return o.createElement(t,null)}return o.createElement(e,null)}))}}var hp=n(714385);const fp=new Set([u.p.chats,u.p.calls,u.p.taskmodule,u.p.hwctaskmodule,u.p.extensions]);var yp=n(517544),bp=n(938557);const Sp="/l/stage",kp="No DeeplinkPrefixType found for the specified deeplinkUrl",wp=e=>{const{pathname:t,search:n}=e,i=new URLSearchParams(n).get("context"),a=i&&JSON.parse(i),o=t.split(/[/?&]/),r=o.indexOf("stage");return{appId:o[r+1],deeplinkContext:a}},Cp=(e,t,n,i)=>{const{contentUrl:a,websiteUrl:o,title:r}=i,{phase1CollabStageScenario:s,endToEndScenario:l}=(0,yp.R3)(t,n,e,bp.mQ.deepLinkStageModal);return Promise.resolve({entityCommand:{entity:{id:e,type:u.p.platformstagemodal,action:u.u.view},command:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:kt.D.StageViewDeeplink}},entityOptions:{appId:e,tabInfo:JSON.stringify({tabInfo:{contentUrl:a,websiteUrl:o,name:r}}),convId:n,entryPoint:bp.mQ.deepLinkStageModal,launchScenarioId:l.id,phase1OnlyScenarioDetails:{scenarioMarkerName:s.name,scenarioMarkerId:s.id}}},metadata:{allowAnonymous:!1}})},_p={filter:e=>{if(!e.pathname.startsWith(Sp))return!1;try{const{appId:t,deeplinkContext:n}=wp(e),{contentUrl:i,websiteUrl:a}=n;return!!(t&&n&&i&&a)}catch(e){return!1}},execute:({deeplinkUrl:e,context:{loggerFactory:t,scenarioFactory:n,coreSettings:i},sourceViewEntity:a})=>{const o=t.newLogger("PlatformApp_parseStageDeeplink","apps-platform-app"),{enableReactStageModal:r}=i.get(L.J.Extensibility);if(!r)return Promise.reject("Stage modal feature flag is disabled");if(!e.pathname.startsWith(Sp))return o.log(kp),Promise.reject(kp);const s=null==a?void 0:a.id;if(!s)return o.log("sourceViewEntity id is not defined"),Promise.reject("sourceViewEntity id is not defined");const{appId:l,deeplinkContext:c}=wp(e);return Cp(l,n,s,c)}},Tp={reloadTrigger:!1},Ip="/l/entity",Ep="/l/task",Np="No DeeplinkPrefixType found for the specified deeplinkUrl",Ap={[Ip]:Os.DL.PlatformExtension},Fp=e=>{const{pathname:t,search:n}=e,i=new URLSearchParams(n),a=i.get("context"),o=i.get("tenantId"),r=a&&JSON.parse(a),s=null==r?void 0:r.channelId,l=null==r?void 0:r.chatId,c=null==t?void 0:t.split(/[/?&]/),d=null==c?void 0:c.indexOf("entity");return{tenantId:o,appId:null==c?void 0:c[d+1],entityId:null==c?void 0:c[d+2],channelId:s,chatId:l,deeplinkContext:r,pathname:t}},Dp=new Set([Ip]),Rp=(e,t,n,i,a,o,r,s)=>{var l;null==r||r.mark("create_deeplink_command"),a.log(`create_deeplink_command with appId: ${t} tabEntityId:${n} context: ${i}`),(null==i?void 0:i.channelId)||(Tp.reloadTrigger=!Tp.reloadTrigger);const c=null===(l=null==o?void 0:o.correlation)||void 0===l?void 0:l.source,d=!!c&&[kt.D.ActivityFeed,kt.D.ActivityFeedBellClick].includes(c),u=!(null==i?void 0:i.channelId)&&!(null==i?void 0:i.chatId)||d?(0,Ls.Pq)(t,!1,Tp.reloadTrigger,d,kt.D.PlatformPersonalAppDeepLink,n,o,null==i?void 0:i.subEntityId,void 0,e):(0,Ls.PO)(e,t,i.channelId||"",i.chatId||"",n,o,null==i?void 0:i.subEntityId),m={entityCommand:Object.assign({},u),metadata:{allowAnonymous:!1,tenantId:null!=s?s:void 0}};return null==r||r.mark("return_deeplink_command"),null==r||r.appendEventData({"PlatformTabDeeplink.generatedCommand":m.toString()}),Promise.resolve(m)},xp=()=>n.e(22463).then(n.bind(n,75309)),Mp=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{deeplinkUrl:t,preferredCommandInput:n,context:{coreSettings:i,loggerFactory:a,scenarioFactory:o}}=e,r=a.newLogger("platform-app","apps-platform-app"),{enablePlatformDeepLinkRouting:s,appIdList:l,disabledTabAppIds:c,isAllowedAppList:d}=i.get(L.J.Extensibility),u=l&&JSON.parse(l),{appId:m}=Fp(t),g=(0,hp.fk)(r,m,!1,c||[],u,d);if(s&&g)return Promise.reject(`App ${m} is not supported for deeplink navigation in T2.1`);const p=new URLSearchParams(t.search).get("context"),v=p&&JSON.parse(p);return!s&&(null==v?void 0:v.channelId)&&(null==v?void 0:v.chatId)?Promise.reject("Feature for parsing teams and channels deep links in T2.1 is not enabled"):((e,t,n,i,a)=>{var o,r,s,l;const{appId:c,entityId:d,deeplinkContext:u,pathname:m,tenantId:g}=Fp(e);let p;t.log(`Parsing deepLink for platform app - appId: ${c}, pathname: ${m}`),n&&(null===(o=null==a?void 0:a.findScenario(it.RG.PlatformTabDeeplinkHandling))||void 0===o||o.cancel(),p=null==a?void 0:a.newScenario(it.RG.PlatformTabDeeplinkHandling),p&&(null===(r=null==a?void 0:a.hoistScenarioToCore)||void 0===r||r.call(a,p)),null==p||p.appendEventData({"PlatformTabDeeplink.pathname":e.pathname,"PlatformTabDeeplink.search":e.search}));for(const n of Array.from(Dp))if(null==m?void 0:m.startsWith(n))return void 0===Ap[n]?(null===(s=t.errorToTelemetry)||void 0===s||s.call(t,Np,"platform_deeplink_prefix_type"),Promise.reject(Np)):Rp(e,c,d,u,t,i,p,g);return null===(l=t.errorToTelemetry)||void 0===l||l.call(t,Np,"platform_deeplink_prefix_type"),Promise.reject(Np)})(t,r,!!s,n,o)})),Op={filter:Ep,execute:({deeplinkUrl:e,context:{loggerFactory:t,scenarioFactory:n,coreSettings:i},sourceViewEntity:a})=>{const o=t.newLogger("PlatformApp_parseTaskModuleDeeplink","apps-platform-app");return Pp(e,i,o,n,a)}},Pp=(e,t,n,i,a)=>{if(e.pathname.startsWith(Ep)){const o=i.newScenario(it.RG.ExtDeeplinkToTaskModule),{enableDeepLinkToTaskModule:r}=t.get(L.J.Extensibility);if(!r)return o.stop({reason:it.ck.ExtDeeplinkToTaskModuleFeatureFlagDisabled}),n.log("ext_deeplink_to_task_module_featureflag_disabled"),Promise.reject("Deeplink to task module feature flag is disabled");if(!a)return o.stop({reason:it.ck.ExtDeeplinkToTaskModuleNotSupported}),n.log("ext_deeplink_to_task_module_not_supported"),Promise.reject("Deeplink to task module is not supported");const s=(0,Ye.v4)();return Promise.resolve({entityCommand:{entity:{type:u.p.taskmodule,action:u.u.create,id:s},command:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:kt.D.TaskModuleDeeplink}},entityOptions:{deeplinkSourceEntityInput:a,deeplinkUrl:e}},metadata:{allowAnonymous:!1}})}return n.log(Np),Promise.reject(Np)},Lp=[{filter:e=>{if(!e.pathname.startsWith(Ip))return!1;const{appId:t,chatId:n,entityId:i,deeplinkContext:a}=Fp(e);return!(!(t&&n&&i&&a)||"chat"!==a.contextType&&"meeting"!==a.contextType)},execute:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{context:{coreSettings:t}}=e,{enablePlatformDeepLinkRouting:n}=t.get(L.J.Extensibility);if(!(({deeplinkUrl:e,sourceViewEntity:t,context:{coreSettings:n}})=>{var i;if("false"===(null===(i=e.searchParams.get("openInMeeting"))||void 0===i?void 0:i.toLowerCase())||!n.get(L.J.Extensibility).handleDeepLinkToMeetingSidePanel||!t)return!1;const{type:a,action:o,linkedEntity:r}=t,s=t;return a===u.p.calls||!!s.options&&(a===u.p.extensions&&o===u.u.view&&(null==r?void 0:r.type)===u.p.calls?!!r.id:fp.has(a)&&s.options.includes("teamsCallId"))})(e)){if(n)return Mp(e);throw new Error("Groupchat/team scope tab deeplink disabled")}const{executeDeepLinkToGroupChatOrTeamTab:i}=yield(0,c.mT)(xp,"platform-app-execute-group-chat-or-team-scope-tab-deeplink");try{return yield i(e)}catch(t){if(n)return Mp(e);throw t}}))},{filter:e=>{try{const{appId:t}=Fp(e);return!!t}catch(e){return!1}},execute:Mp},Op,_p];var Up=n(165074),jp=n(961876);const $p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformAppButtonMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAppButtonSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Bp="platform",Wp="viewPlatformApp",Hp="loadPlatformChunks",Vp="openAppDetailsDialog",zp=(e,t)=>({actor:Bp,action:Wp,data:{appId:e,isMultiWindow:t}}),qp=()=>({actor:Bp,action:Hp}),Gp=(e,t)=>({actor:Bp,action:Vp,data:{appId:e,scrollToSection:t}}),{getIsFirstFlyoutClickAfterAppLoad:Jp,setIsFirstFlyoutClickAfterAppLoad:Qp}=(()=>{let e=!0;return{getIsFirstFlyoutClickAfterAppLoad:()=>e,setIsFirstFlyoutClickAfterAppLoad:t=>{e=t}}})();var Kp=n(564453);const Yp=()=>Promise.all([n.e(893479),n.e(672617),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(284790),n.e(302711),n.e(179826),n.e(827610),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(929389),n.e(523537),n.e(757663),n.e(59106),n.e(595162),n.e(501749),n.e(41547),n.e(991883),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(953808),n.e(463911),n.e(836083),n.e(699466),n.e(209103),n.e(279439),n.e(510510),n.e(981674),n.e(142483),n.e(652336),n.e(376488),n.e(693514),n.e(314171),n.e(386511),n.e(559067)]).then(n.bind(n,60373)),Xp=({commandInput:e,requestContext:{loggerFactory:t,scenarioFactory:n,executionContext:a,client:o,coreSettings:r}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var s,l,m,g;const p=e.command,v=p.action,{viewEntities:{mainEntity:h}}=a,f=t.newLogger("PlatformApp onCommandReceived","apps-platform-app");var y;if(e.command.actor===Bp)switch(v){case Wp:const{enableMRUSortingPersonalApps:t}=r.get(L.J.Extensibility);if("object"!=typeof(y=p.data)||null===y||!("appId"in y))return void f.error(`Command for action '${e.command.action}' requires an appId.`);const a=Zp(null==h?void 0:h.id,null==h?void 0:h.type,p.data.appId,f);if(a?((e,t,n,a)=>{(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!t)return;const i={appId:t,action:n};yield e.mutate({mutation:$p,variables:i}).catch((()=>{var e;return null===(e=a.errorToTelemetry)||void 0===e?void 0:e.call(a,`[AppId: ${t}] Failed to register app button to cache`,"platform_personal_app_app_button_api",void 0,!0)}))}))})(o,p.data.appId,v,f):(0,jp.ui)(n,p.data.appId,bp.mQ.personalApp,f,p.data.isMultiWindow),t){const e=p.data.appId;null===(s=f.infoToTelemetry)||void 0===s||s.call(f,`record app usage mutation called for appId ${e}`,"platform_record_app_mru_view_platform_app",{appId:e}),o.mutate({mutation:Kp.c,variables:{appId:e}}).catch((()=>{var t;null===(t=f.errorToTelemetry)||void 0===t||t.call(f,`failed to call mutate to record app usage on the appId ${e}`,"platform_record_app_mru_view_platform_app",void 0,!0)}))}return(0,Ls.Pq)(p.data.appId,p.data.isMultiWindow||!1,!0,!1,kt.D.AppBar,void 0,void 0,void 0,a);case Hp:const{enablePrewarmPlatformChunk:b}=r.get(L.J.Extensibility);return void(b&&Jp()&&(f.log("enablePrewarmPlatformChunk is enabled."),(0,c.mT)(Yp,"platform-app",n),Qp(!1)));case Vp:const S=p,k=null!==(m=null===(l=S.data)||void 0===l?void 0:l.appId)&&void 0!==m?m:"",w=null===(g=S.data)||void 0===g?void 0:g.scrollToSection;return{entityOptions:{appId:k,entryPoint:Up.RE.PersonalFlyoutAppSuggestions,viewOptions:{scrollToSection:w}},entity:{id:k,type:u.p.platformapp,action:u.u.create},command:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:kt.D.ExtensionCommanding}}};default:f.error(`Command action '${v}' is not supported at PlatformApp.`)}else f.error(`Command for actor '${e.command.actor}' cannot be handled by PlatformApp.`)})),Zp=(e,t,n,i)=>{var a;try{if(t===u.p.extensions&&e){return JSON.parse(e).appId===n}return!1}catch(t){return null===(a=i.errorToTelemetry)||void 0===a||a.call(i,`failed to parse main entity id ${e}`,"platform_personal_app_main_entity_parse",void 0,!0),!1}},ev={onEventReceived:({eventInput:e})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;switch(e.event.type){case Vi.uS.expandTab:{const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:zi.CN.expandTab(i)})}case Vi.uS.resetLayoutOverrides:return Promise.resolve({command:zi.CN.resetLayoutOverrides()});case Vi.uS.maximizeTab:return Promise.resolve({command:zi.CN.maximizeTab()})}return Promise.resolve(void 0)}))},tv=e=>{if(nv(e))return iv(e)?{subNavEntity:av(e),headerEntity:ov(e),startEntity:rv(e),mainEntity:sv(e),endEntity:lv(e)}:null},nv=({contextEntity:e,entity:t,coreSettings:n,layoutMode:i})=>{const{action:a=null,type:o}=Object.assign({},t);if(cv(t,e,n))return!1;const r=[d.lO.focus,d.lO.standard].includes(i),s=[u.p.platformapp,u.p.platformappdetails,u.p.incontextstore,u.p.platformapps,u.p.extensions].includes(o),l=a&&[u.u.create,u.u.default,u.u.list,u.u.view,u.u.update,u.u.manage].includes(a),c=e&&e.action;return!(!r||!s||!l&&!c)},iv=()=>!0,av=()=>null,ov=({contextEntity:e,entity:t,coreSettings:n})=>{const i=null==n?void 0:n.get(L.J.Extensibility).enablePlatformHeaderEntry;if(e&&e.action){if(e.type===u.p.chats)return t;if(e.type===u.p.extensions&&i)return e}return i?t:null},rv=()=>null,sv=({entity:e,contextEntity:t})=>t&&t.action&&(t.type===u.p.chats||t.type===u.p.extensions)?t:e,lv=()=>null,cv=(e,t,n)=>{const i=null==n?void 0:n.get(L.J.Extensibility).enablePlatformHeaderEntry;return e.type===u.p.extensions&&(null==t?void 0:t.type)===u.p.extensions&&!i},dv=({coreSettings:e})=>{var t;return{[C.tF7.headerEntity]:{[s.S.HorizontalBar]:{slotHeightOverrides:(null===(t=null==e?void 0:e.get(L.J.Extensibility))||void 0===t?void 0:t.enablePlatformPersonalAppHeaderLayout)?"auto":void 0}}}},uv={id:"com.microsoft.teams.platform-app",name:"Platform App",actors:[Bp],supportedEntities:[u.p.extensions,u.p.taskmodule,u.p.hwctaskmodule,u.p.platformapp,u.p.platformappdetails,u.p.platformappconsent,u.p.platformapps,u.p.platformsubscriptionplans,u.p.customapp,u.p.platformauthconsentdialog,u.p.workflows,u.p.selectMediaApi,u.p.viewImagesApi,u.p.platformtab,u.p.locationapi,u.p.selectpeoplepicker,u.p.stagedapps,u.p.platformTabGallery,u.p.manageapps,u.p.manageappswebhook,u.p.incontextstore,u.p.platformappdevicepermissions,u.p.settingsdialog,u.p.platformstagemodal],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Modal,s.S.Rail],windowFeatures:{width:800,height:600,minWidth:800,minHeight:600,offset:20}},mv=({appRenderMode:e,coreSettings:t})=>{const n=new ht.H,{platformAppCriticalPhaseTimeout:i}=t.get(L.J.Extensibility);return"Main"===e&&n.registerAppPhase({phase:ft.nh.CRITICAL,signals:[ft.GZ.PLATFORM_APP_CONTAINER_RENDERED,ft.GZ.PLATFORM_APP_FRAME_RENDERED,ft.GZ.PLATFORM_APP_FRAME_CONTENT_RENDERED],timeout:i||35e3}),n.appPhases},gv=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(273621),n.e(899405),n.e(284790),n.e(827610),n.e(88343),n.e(623025),n.e(579814),n.e(110350),n.e(709528),n.e(507328),n.e(757663),n.e(59106),n.e(595162),n.e(501749),n.e(41547),n.e(991883),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(836083),n.e(699466),n.e(279439),n.e(510510),n.e(652336),n.e(376488),n.e(467007),n.e(314171),n.e(360941)]).then(n.bind(n,955375)),pv=()=>Promise.all([n.e(893479),n.e(672617),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(284790),n.e(302711),n.e(179826),n.e(827610),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(929389),n.e(523537),n.e(757663),n.e(59106),n.e(595162),n.e(501749),n.e(41547),n.e(991883),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(953808),n.e(463911),n.e(836083),n.e(699466),n.e(209103),n.e(279439),n.e(510510),n.e(981674),n.e(142483),n.e(652336),n.e(376488),n.e(693514),n.e(314171),n.e(386511),n.e(559067)]).then(n.bind(n,60373)),vv=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(287783),n.e(907784),n.e(838608),n.e(553211),n.e(522024),n.e(274690),n.e(714133),n.e(92700),n.e(179826),n.e(195823),n.e(981484),n.e(779813),n.e(193693),n.e(852676),n.e(282671),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(730588),n.e(998947),n.e(929389),n.e(958163),n.e(301920),n.e(523537),n.e(757663),n.e(59106),n.e(264630),n.e(595162),n.e(568336),n.e(27890),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(953808),n.e(463911),n.e(836083),n.e(699466),n.e(209103),n.e(279439),n.e(302092),n.e(510510),n.e(981674),n.e(142483),n.e(652336),n.e(376488),n.e(459737),n.e(53807),n.e(693514),n.e(314171),n.e(18648),n.e(105672),n.e(492034),n.e(391656),n.e(169755),n.e(554648),n.e(835927),n.e(588919)]).then(n.bind(n,528417)),hv=({coreServices:e,host:t,screenState:n})=>{var i;const a=null===(i=null==e?void 0:e.coreSettings.get(L.J.Extensibility))||void 0===i?void 0:i.disablePlatformAppWindowFeatures,o=null==t?void 0:t.screen;if(a||!o)return null;const r={left:(null==t?void 0:t.screenX)||0,top:(null==t?void 0:t.screenY)||0},{height:s,minHeight:l,minWidth:c,offset:d=1,width:u}=uv.windowFeatures||{},m=((null==n?void 0:n.numOpenWindows)||1)*d;return{additionalFeatures:{minHeight:`${l}`,minWidth:`${c}`},left:(null==r?void 0:r.left)+m,top:(null==r?void 0:r.top)+m,minHeight:l,minWidth:c,height:s,width:u}};function fv(){const e=()=>null;return{getAppPhases:mv,getAppViewEntities:tv,getAppWindowFeatures:hv,getPlatformAppIdForEntity:e=>{if(e.type===u.p.extensions){const{appId:t}=e.id&&JSON.parse(e.id);return t}},getAppViewEntitiesProps:dv,onBeforeDeeplinkParsed:Lp,manifest:uv,onCommandReceived:Xp,onRegister:e=>{e.registerTask(new Se)},render:({appRenderMode:t,scenarioFactory:n,onRenderEvent:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,r;switch(t){case s.S.Modal:{const e="platform-modal",{Modal:t}=yield(0,c.mT)(vv,e,n);return o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(t,null))}case s.S.HorizontalBar:case s.S.Main:{const e="platform-app";null===(i=null==n?void 0:n.findScenario(it.RG.PlatformTabFrameLoading))||void 0===i||i.mark(it.ck.PlatformTabRenderBeforeChunkLoad),a("ChunkLoadStarted",{chunkName:e});const{PlatformAppViewsEntryRenderer:s}=yield(0,c.mT)(pv,e,n);return a("ChunkLoadSucceeded",{chunkName:e}),null===(r=null==n?void 0:n.findScenario(it.RG.PlatformTabFrameLoading))||void 0===r||r.mark(it.ck.PlatformTabRenderAfterChunkLoad),o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(s,{appRenderMode:t}))}case s.S.Rail:{const e="platform-app-rail",{PlatformTabPanel:t}=yield(0,c.mT)(gv,e,n);return o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(t,null))}default:return o.createElement(e,null)}})),eventHandlers:ev}}const yv={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case ln.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:mn(i)})}return Promise.resolve(void 0)}};var bv=n(726988);const Sv=()=>Promise.all([n.e(879622),n.e(822359),n.e(491645),n.e(331584),n.e(586060)]).then(n.bind(n,162213)),kv=e=>({id:"search-data-load",runOncePerId:!0,job:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.newLogger("dataResolverSearchJob","apps-search");t.log("[dataResolversSearchJob] Initializing calling service");try{yield(0,c.mT)(Sv,"search-data-resolvers")}catch(e){t.error("[dataResolversSearch] Error initializing bundle")}t.log("[dataResolversSearch] Calling service initialized")}))}),wv=({context:{loggerFactory:e}})=>[kv(e)];var Cv=n(318704);const _v=()=>Promise.all([n.e(893479),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(907784),n.e(168904),n.e(687601),n.e(511402),n.e(860024),n.e(34693),n.e(976830),n.e(90884),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(604068),n.e(264630),n.e(497606),n.e(540028),n.e(164010),n.e(875059),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(842905),n.e(248361),n.e(675049),n.e(262855),n.e(369687),n.e(459737),n.e(767433),n.e(491645),n.e(954233),n.e(979523),n.e(456904)]).then(n.bind(n,141421)),Tv=()=>Promise.all([n.e(623025),n.e(579814),n.e(822359),n.e(491645),n.e(79506)]).then(n.bind(n,875128)),Iv="search-app",Ev=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:t,entityCommand:{entity:{type:n,action:a},command:{stateTransition:o}},requestContext:r}=e,{client:s,coreSettings:l}=r,{enablePretriggerImprovement:d}=null==l?void 0:l.get(L.J.Serp),m=t.entityOptions||{},g=m.loadBundle,p=m.substrateSearchWarmUpInExpRenderer;if(n===u.p.search&&a===u.u.view&&g)return yield function(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,client:n,coreSettings:i}=e,{enableSerpServiceToPrewarm:a}=null==i?void 0:i.get(L.J.Serp),o=t.newLogger("SearchAppOnBeforeCommandHandled","apps-search");(0,c.mT)(Cv.t,"search-answer");const{pingSearch:r}=yield(0,c.mT)(_v,Iv);try{a&&(yield n.mutate({mutation:r,variables:{correlationId:(0,Ye.v4)()}}))}catch(e){o.error(`mutation pingSearch error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}(r),Promise.resolve(void 0);if(n===u.p.search&&a===u.u.view&&p){const{searchWarmup:e}=yield(0,c.mT)(_v,Iv);return yield s.query({query:e,variables:{scenario:"powerbar",cvid:m.conversationId}}),Promise.resolve(void 0)}if(d&&n===u.p.search&&a===u.u.view&&"flush"===o&&m.searchQuery){const{searchQuery:e,logicalId:t,conversationId:n,entrySource:i,navLocationContext:a,currentTab:o,filterSet:r}=m,{enableNavLocationContext:d}=null==l?void 0:l.get(L.J.Serp),u="backButton"===i,{searchServiceCache:g,Tabs:p}=yield(0,c.mT)(Tv,"services-io-search");g.clearAll(),d&&a&&g.setNavLocationContext(a);const v=(0,Ye.v4)(),h=(0,Ye.v4)();g.setUpstreamTelmetryIds(v,h);const{searchPreTriggerQuery:f,numberOfAllPageResults:y}=yield(0,c.mT)(_v,Iv);yield s.query({query:f,variables:{searchTerm:e,noOfResults:y,pageNumber:0,correlationId:v,allFilters:r?r[p.All]:{},messageFilters:r?r[p.All]:{},searchStartCorrelationId:h,currentTab:o,isBackButton:u,conversationId:n,logicalId:t}})}return Promise.resolve(t)}));const Nv=({appRenderMode:e})=>{const t=new ht.H,n=[],i=[];switch(e){case s.S.Main:Av({featureFlags:{},criticalSignals:n,postCriticalSignals:i})}return t.registerAppPhase({phase:ft.nh.CRITICAL,signals:n,timeout:1e4}),t.registerAppPhase({phase:ft.nh.POST_CRITICAL,signals:i,timeout:1e4}),t.appPhases},Av=({criticalSignals:e})=>{e.push(ft.GZ.SEARCH_RESULTS_RENDERED)},Fv=e=>{if(Dv(e))return Rv(e)?{subNavEntity:xv(e),headerEntity:Mv(e),startEntity:Ov(e),mainEntity:Pv(e),endEntity:Lv(e)}:null},Dv=({contextEntity:e,entity:t,layoutMode:n})=>{const{action:i=null,type:a}=Object.assign({},t),o=[d.lO.focus,d.lO.standard].includes(n),r=[u.p.search,u.p.openfeedbackdialog].includes(a),s=i&&[u.u.default,u.u.view].includes(i),l=e&&e.action&&e.type===u.p.chats;return!(!o||!r||!s&&!l)},Rv=()=>!0,xv=()=>null,Mv=({contextEntity:e})=>e&&e.action&&e.type===u.p.chats?e:null,Ov=()=>null,Pv=({entity:e,contextEntity:t})=>t&&t.action&&t.type===u.p.chats?t:e,Lv=()=>null,Uv={id:"com.microsoft.teams.search",name:"Search",getLocalizedName:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("search"),e.stringTranslate("search","search_app_name")})),supportedEntities:[u.p.search,u.p.openfeedbackdialog],supportedRenderModes:[s.S.Main,s.S.Modal],windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3}},jv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsSearchFloodgateLogActivityMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activityName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"increment"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"floodgateLogActivity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activityName"},value:{kind:"Variable",name:{kind:"Name",value:"activityName"}}},{kind:"Argument",name:{kind:"Name",value:"increment"},value:{kind:"Variable",name:{kind:"Name",value:"increment"}}}]}]}}]};class $v extends fe{constructor(){super(he.Yg.LogActivityTask,["client","hostCommunicationService","coreSettings","loggerFactory"])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:n,hostCommunicationService:i,coreSettings:a,loggerFactory:o}=e,r=(null==a?void 0:a.get(L.J.Serp).enableAutosuggestFps)||!1,s=null==a?void 0:a.get(L.J.SurveyForm).enableCsatTaskRegistration;if(r&&!s){const e=yield null==i?void 0:i.loadModule("search"),a=o.newLogger("LogActivityTaskRegistered","apps-search");null===(t=null==e?void 0:e.registerForLogActivity)||void 0===t||t.call(e,(e=>{a.log(`activity ${e.activityName} and increment ${e.incrementValue}`),"teamsSearchFps"===e.activityName&&(e=>{e.mutate({mutation:jv,variables:{activityName:"teamsSearchFps",increment:1}})})(n)}))}}))}}const Bv=()=>Promise.all([n.e(893479),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(907784),n.e(168904),n.e(687601),n.e(511402),n.e(860024),n.e(34693),n.e(976830),n.e(90884),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(604068),n.e(264630),n.e(497606),n.e(540028),n.e(164010),n.e(875059),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(842905),n.e(248361),n.e(675049),n.e(262855),n.e(369687),n.e(459737),n.e(767433),n.e(491645),n.e(954233),n.e(979523),n.e(456904)]).then(n.bind(n,141421)),Wv=()=>Promise.all([n.e(893479),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(907784),n.e(168904),n.e(687601),n.e(511402),n.e(860024),n.e(34693),n.e(976830),n.e(90884),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(604068),n.e(264630),n.e(497606),n.e(540028),n.e(164010),n.e(875059),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(842905),n.e(248361),n.e(675049),n.e(262855),n.e(369687),n.e(459737),n.e(767433),n.e(491645),n.e(954233),n.e(979523),n.e(456904)]).then(n.bind(n,697633)),Hv=()=>Promise.all([n.e(134315),n.e(287783),n.e(168904),n.e(522024),n.e(511402),n.e(274690),n.e(332201),n.e(488189),n.e(769415)]).then(n.bind(n,312059)),Vv=()=>Uv.windowFeatures||{};function zv(){const e=()=>null;return{eventHandlers:yv,getAppPhases:Nv,onRegister:e=>{e.registerTask(new Se),e.registerTask(new $v)},getAppViewEntities:Fv,getAppWindowFeatures:Vv,manifest:Uv,render:({appRenderMode:t,coreSettings:n,onRenderEvent:a,scenarioFactory:r,loggerFactory:d})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="search-app";a("ChunkLoadStarted",{chunkName:e});const{SearchViewsRenderer:t}=yield(0,c.mT)(Bv,e),{enableEntityMoreInfo:i}=n.get(L.J.Core),r=({children:e})=>o.createElement(o.Fragment,null,e),{LPC:s}=i?{LPC:r}:yield(0,c.mT)(Wv,e),d=i?r:vn.p3;a("ChunkLoadSucceeded",{chunkName:e});const u="search";return o.createElement(l.f,{namespace:"messaging",loaderRenderer:null},o.createElement(s,{appName:u},o.createElement(d,null,o.createElement(bv.r,null,o.createElement(t,null)))))}if(t===s.S.Modal){const e="feedback-renderer",t=d.newLogger(e,"apps-search");try{a("ChunkLoadStarted",{chunkName:e});const{FeedbackDialog:t}=yield(0,c.mT)(Hv,e,r);return a("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}catch(e){t.error(`chunk load failed with ${e}`)}}return o.createElement(e,null)})),onPreWarm:wv,onBeforeCommandHandled:Ev}}const qv={getDefaultCommand:()=>({type:u.p.messages,action:u.u.create}),id:"com.microsoft.teams.share",name:"ShareApp",supportedEntities:[u.p.messages,u.p.shareformdialog],supportedRenderModes:[s.S.Main,s.S.Modal],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}};var Gv=n(754645),Jv=n(313142),Qv=n(54427);const Kv=({children:e})=>{const t=Gv.YM,{unblockOutlookDesktopIE11:n,unblockSafari:i}=(0,Qv.NC)(L.J.Outlook);if(n&&(t.ie=`>=${Gv.Zz}`),i&&(t.safari=`>=${Gv.hh}`),!((0,Jv.H$)(t)||(0,Jv.L5)()&&i))throw(0,An.Tr)("UnsupportedBrowserCheck",he.jK.FeatureNotSupported,"render",void 0,"Unsupported Browser");if(!i&&(0,Jv.Qh)())throw(0,An.Tr)("UnsupportedBrowserCheck",he.jK.FeatureNotSupported,"render",{itpError:!0},"Unsupported Browser (ITP Enabled)");return o.createElement(o.Fragment,null,e)},Yv=e=>{if(Xv(e))return Zv(e)?{subNavEntity:eh(e),headerEntity:th(e),startEntity:nh(e),mainEntity:ih(e),endEntity:ah(e)}:null},Xv=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.messages,u.p.shareformdialog].includes(i),r=n&&[u.u.default,u.u.view,u.u.create].includes(n);return!!(a&&o&&r)},Zv=()=>!0,eh=()=>null,th=()=>null,nh=()=>null,ih=({entity:e})=>e,ah=()=>null,oh=({appRenderMode:e})=>{const t=new ht.H,n=[];return e===s.S.Main&&n.push(ft.GZ.SHARE_PAGE_RENDERED),t.registerAppPhase({phase:ft.nh.CRITICAL,signals:n,timeout:2e4}),t.appPhases},rh=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(284790),n.e(372269),n.e(549830),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(604068),n.e(346857),n.e(66571),n.e(290833),n.e(501749),n.e(41547),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(398949),n.e(463911),n.e(836083),n.e(699466),n.e(209103),n.e(141221),n.e(279439),n.e(393926),n.e(302092),n.e(510510),n.e(981674),n.e(142483),n.e(817586),n.e(302755),n.e(119751),n.e(36947),n.e(388828),n.e(307463),n.e(828729)]).then(n.bind(n,768953)),sh=()=>null;function lh(){return{getAppPhases:oh,getAppViewEntities:Yv,manifest:qv,onRegister:e=>{e.registerTask(new Se)},render:({appRenderMode:e,scenarioFactory:t})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e===s.S.Modal||e===s.S.Main){const e=yield(0,c.mT)(rh,"share-form",t),{ShareForm:n}=e;return o.createElement(Kv,null,o.createElement(n,null))}return o.createElement(sh,null)}))}}const ch={getDefaultCommand:()=>({type:u.p.email,action:u.u.create}),id:"com.microsoft.teams.share-email",name:"ShareEmailApp",supportedEntities:[u.p.email],supportedRenderModes:[s.S.Main],windowFeatures:{minWidth:530,width:748,minHeight:490,height:691}},dh=e=>{if(uh(e))return mh(e)?{subNavEntity:gh(e),headerEntity:ph(e),startEntity:vh(e),mainEntity:hh(e),endEntity:fh(e)}:null},uh=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.email].includes(i),r=n&&[u.u.default,u.u.create].includes(n);return!!(a&&o&&r)},mh=()=>!0,gh=()=>null,ph=()=>null,vh=()=>null,hh=({entity:e})=>e,fh=()=>null,yh=({appRenderMode:e})=>{const t=new ht.H,n=[];return e===s.S.Main&&n.push(ft.GZ.SHARE_PAGE_RENDERED),t.registerAppPhase({phase:ft.nh.CRITICAL,signals:n,timeout:2e4}),t.appPhases},bh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsShareEmailSttoInstallMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareToTeamsInstall"}}]}}]},Sh="share_to_teams_installed",kh=({context:{coreSettings:e,localStorage:t,authenticationUser:n,client:a,loggerFactory:o,scenarioFactory:r}})=>{const{enableSttoInstall:s}=e.get(L.J.Outlook);return[{id:"share-to-teams-outlook-install",runOncePerId:!0,job:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(s){const i=function(e){return e.cancelExistingAndCreateScenario(it.RG.STTOInstall,"Share to teams Install")}(r),{isOnCloud:s,isMailboxDiscoverable:l}=e.get(L.J.Messaging),c=o.newLogger("ShareToTeamsApp Install","apps-share-email"),d=a,u=(null==t?void 0:t.get(Sh))||!1,m=(null==n?void 0:n.role)===nd.w4.Guest;if(s&&l&&!m&&!u)try{const{data:e}=yield d.mutate({mutation:bh});(null==e?void 0:e.shareToTeamsInstall)?(c.log("ShareToTeams install successful"),null==t||t.setSafe(Sh,"true"),i.stop()):(c.log("ShareToTeams install not successful"),i.fail({errors:"ShareToTeams install not successful"}))}catch(e){c.log("ShareToTeams install mutation unexpectedly failed"),i.fail({errors:"ShareToTeams install mutation unexpectedly failed"})}else c.log("Skipping ShareToTeams install"),i.cancel({reason:"Skipping ShareToTeams install"})}}))}]};var wh;!function(e){e.DeepLinkNotEnabled="deeplink-not-enabled-error",e.MissingEmailRestId="missing-emailRestId-error"}(wh||(wh={}));const Ch=e=>{try{return JSON.parse(`[${e}]`)}catch(e){return[]}},_h=(e,t,n)=>{const{emailRestId:i,attachmentSize:a,attachmentCount:o,fileTypes:r,from:s,toRecipients:l,ccRecipients:c,cloudAttachments:m,outlookTid:g,outlookUid:p,outlookSmtpAddress:v}=e;return Promise.resolve({entityCommand:{entity:{type:u.p.email,id:i,action:n},command:{visibilityState:d.fe.show,stateTransition:d.su.new,correlation:{id:t,startTimestamp:Date.now(),source:kt.D.ShareEmail}},entityOptions:{emailRestId:i,correlationId:t,attachmentSize:a,attachmentCount:o,fileTypes:r,from:s,toRecipients:l,ccRecipients:c,cloudAttachments:m,outlookTid:g,outlookUid:p,outlookSmtpAddress:v}},metadata:{allowAnonymous:!1}})},Th=[{filter:"/l/share-email",execute:({deeplinkUrl:e,context:{coreSettings:t}})=>{if(!Ih(t))return Promise.reject({message:wh.DeepLinkNotEnabled});const{entityOptions:n,correlationId:i}=(e=>{var t,n,i,a,o,r,s,l,c,d,u,m;const{pathname:g,searchParams:p}=e,v=g.split("/"),h=v[v.length-1],f=Number(p.get("attachmentSize"))||0,y=Number(p.get("attachmentCount"))||0,b=null!==(n=null===(t=p.get("fileTypes"))||void 0===t?void 0:t.split(","))&&void 0!==n?n:[],S=null!==(i=p.get("from"))&&void 0!==i?i:"",k=null!==(o=null===(a=p.get("toRecipients"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[],w=null!==(s=null===(r=p.get("ccRecipients"))||void 0===r?void 0:r.split(","))&&void 0!==s?s:[],C=null!==(l=p.get("cloudAttachments"))&&void 0!==l?l:"";return{entityOptions:{emailRestId:h,attachmentSize:f,attachmentCount:y,fileTypes:b,from:S,toRecipients:k,ccRecipients:w,cloudAttachments:Ch(C),outlookTid:null!==(c=p.get("tid"))&&void 0!==c?c:"",outlookUid:null!==(d=p.get("uid"))&&void 0!==d?d:"",outlookSmtpAddress:null!==(u=p.get("userEmail"))&&void 0!==u?u:""},correlationId:null!==(m=p.get("correlationId"))&&void 0!==m?m:""}})(e);return n.emailRestId?_h(n,i,u.u.create):Promise.reject({message:wh.MissingEmailRestId})}}],Ih=e=>!!(null==e?void 0:e.get(L.J.Outlook).enableDeepLinkShareEmail),Eh=()=>Promise.all([n.e(893479),n.e(672617),n.e(239894),n.e(273621),n.e(137434),n.e(372269),n.e(46510),n.e(623025),n.e(579814),n.e(418676),n.e(604068),n.e(346857),n.e(66571),n.e(501749),n.e(41547),n.e(908331),n.e(9886),n.e(398949),n.e(393926),n.e(817586),n.e(302755),n.e(119751),n.e(36947),n.e(307463),n.e(463686)]).then(n.bind(n,191148)),Nh=e=>{e.registerTask(new Se)},Ah=({windowOptions:e})=>{var t,n,i,a;return e?{height:e.height,left:e.left,top:e.top,width:e.width}:{minHeight:null===(t=ch.windowFeatures)||void 0===t?void 0:t.height,minWidth:null===(n=ch.windowFeatures)||void 0===n?void 0:n.width,height:null===(i=ch.windowFeatures)||void 0===i?void 0:i.height,width:null===(a=ch.windowFeatures)||void 0===a?void 0:a.width}};function Fh(){const e=()=>null;return{getAppPhases:yh,getAppViewEntities:dh,getAppWindowFeatures:Ah,manifest:ch,onBeforeDeeplinkParsed:Th,onRegister:Nh,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const{ShareFormEmail:e}=yield(0,c.mT)(Eh,"share-form-email-entry",n);return o.createElement(e,null)}return o.createElement(e,null)})),onPreWarm:kh}}const Dh=e=>{if(Rh(e))return xh(e)?{subNavEntity:Mh(e),headerEntity:Oh(e),startEntity:Ph(e),mainEntity:Lh(e),endEntity:Uh(e)}:null},Rh=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.standard].includes(e),o={[u.p.brbfeedbackdialog]:[u.u.default,u.u.view],[u.p.tpndialog]:[u.u.default,u.u.view],[u.p.activecalldialog]:[u.u.default,u.u.view],[u.p.signoutdialog]:[u.u.default,u.u.view],[u.p.identitydialog]:[u.u.create],[u.p.joinlinkdialog]:[u.u.default,u.u.view],[u.p.bannerNotification]:[u.u.create,u.u.delete],[u.p.hybridplaceholder]:[u.u.default,u.u.view],[u.p.updatemsaprofileavatardialog]:[u.u.default,u.u.view],[u.p.updatemsaprofilenamedialog]:[u.u.default,u.u.view],[u.p.autobrbconfirmationdialog]:[u.u.default,u.u.view],[u.p.pearnotdefaultapp]:[u.u.view],[u.p.invitecoworkers]:[u.u.view]},r=n&&(o[i]||[]).includes(n);return!(!a||!r)},xh=()=>!0,Mh=({entity:e})=>e.type===u.p.pearnotdefaultapp?null:e,Oh=({entity:e})=>e.type===u.p.pearnotdefaultapp?null:e,Ph=({entity:e})=>e.type===u.p.pearnotdefaultapp?null:e,Lh=({entity:e})=>e,Uh=({entity:e})=>e.type===u.p.pearnotdefaultapp?null:e,jh=({areEmptySlotsTransparent:e,coreSettings:t})=>({[C.tF7.subNavEntity]:{[s.e.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e},[s.e.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==t?void 0:t.get(L.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}},[C.tF7.headerEntity]:{[s.e.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e}},[C.tF7.startEntity]:{[s.e.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e}},[C.tF7.mainEntity]:{[s.e.ThinHorizontalBar]:{isBackgroundTransparent:e},[s.e.TitleBar]:{isBackgroundTransparent:!0},[s.e.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==t?void 0:t.get(L.J.Core).enableTransparentAppBar)||e,isColorSchemeDefaultBackground6:!e}},[C.tF7.endEntity]:{[s.e.Rail]:{isBackgroundTransparent:e}}});var $h=n(545219);const Bh="viewActivityApp",Wh=()=>({actor:"activity",action:Bh}),Hh="teamsandchannels",Vh="viewTeamsAndChannelsApp",zh=()=>({actor:Hh,action:Vh}),qh="queues",Gh="viewDefaultQueuesApp",Jh=()=>({actor:qh,action:Gh}),Qh="store",Kh="viewStoreApp",Yh=()=>({actor:Qh,action:Kh}),Xh="viewHomepageApp",Zh=()=>({actor:"homepage",action:Xh});var ef=n(35492);const tf=(e,t)=>{if("platform"===e.platformType)return{appName:"platformApp",appViewCommand:{command:zp(e.tileID,e.launchOut||!1)}};switch(e.tileID){case nf.store:return{appName:"store",appViewCommand:{command:Yh()}};case nf.activity:return{appName:"activity",appViewCommand:{command:Wh()}};case nf.calendar:return{appName:"calendar",appViewCommand:{command:pt()}};case nf.callsmain:return{appName:"callsmain",appViewCommand:{command:To()}};case nf.channel:return{appName:"channel",appViewCommand:{command:zh()}};case nf.chat:return{appName:"chat",appViewCommand:{command:Js()}};case nf.communities:return{appName:"communities",appViewCommand:{command:xl()}};case nf.meet:case nf.meetForWork:return{appName:"meet",appViewCommand:{command:Lm()}};case nf.assignments:return{appName:"assignments",appViewCommand:{command:zp(nf.assignments,e.launchOut||!1)}};case nf.homepage:return{appName:"homepage",appViewCommand:{command:Zh()}};case nf.queues:return{appName:"queues",appViewCommand:{command:Jh()}};case nf.peopleApp:return{appName:"peopleApp",appViewCommand:{command:so()}};default:return void t.error(`Received an unknown core app id. Cannot launch app with id ${e.tileID}.`)}},nf={activity:"14d6962d-6eeb-4f48-8890-de55454bb136",chat:"86fcd49b-61a2-4701-b771-54728cd291fb",calendar:"ef56c0de-36fc-4ef8-b417-3d82ba9d073c",channel:"2a84919f-59d8-4441-a975-2a8c2643b741",callsmain:"20c3440d-c67e-4420-9f80-0e50c39693df",files:"5af6a76b-40fc-4ba1-af29-8f49b08e44fd",meet:"957ed0e3-e5ca-4c82-9676-fd037185c4d8",meetForWork:"a63f7012-8cc9-42d5-99c3-e35f526fab17",communities:"3b95919f-59d8-4441-a975-2a8c2643c852",assignments:"66aeee93-507d-479a-a3ef-8f494af43945",store:"ac40aa4a-fef1-4896-aea2-46d1c14dbfd5",homepage:"7133fca9-0853-4e7a-bb5d-32d4e5f6020a",queues:"a02e4d17-af86-4ceb-9c97-4c2626eb3587",peopleApp:"6c4d620d-f428-4c76-b539-9b1b774dc938"},af=e=>{const t=kt.D.AppBar;switch(e.tileID){case nf.activity:return{scenarioName:it.RG.ActivitySwitch,source:t};case nf.calendar:return{scenarioName:it.RG.CalendarSurfaceLoad,source:t};case nf.channel:return{scenarioName:it.RG.ChannelSwitchL1,source:t};case nf.chat:return{scenarioName:it.RG.ChatSwitch,source:t};case nf.callsmain:return{scenarioName:it.RG.CallsAppSwitch,source:t};case nf.homepage:return{scenarioName:it.RG.HomepageAppLoad,source:t};default:return{scenarioName:it.RG.EntityCommand,source:t}}},of=(e,t)=>{const n=e.event;switch(n.originator){case $h.DQ:case $h.Ol:return((e,t)=>{var n;const i=null===(n=e.data)||void 0===n?void 0:n.call(e);switch(e.type){case $h.iC.launch:case $h.iC.install:return e.data?af(i):void t.error("Received a launch event without data!");default:return void t.warn(`Received an unhandled Launch tile event, type: ${e.type}`)}})(n,t)}},rf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellGetBannerNotificationQueueQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bannerNotificationQueue"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bannerId"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"bannerScenario"}},{kind:"Field",name:{kind:"Name",value:"intentLevel"}},{kind:"Field",name:{kind:"Name",value:"cause"}},{kind:"Field",name:{kind:"Name",value:"props"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"command"}},{kind:"Field",name:{kind:"Name",value:"dismissOnAction"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"behavior"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissable"}},{kind:"Field",name:{kind:"Name",value:"dismissActionCommand"}},{kind:"Field",name:{kind:"Name",value:"duration"}}]}}]}}]}}]},sf={[C.XuV.MostSevere]:0,[C.XuV.Live]:1,[C.XuV.Severe]:2,[C.XuV.Positive]:3,[C.XuV.Neutral]:4},lf=e=>{var t,n,i,a;const{bannerId:o,source:r,bannerScenario:s,intentLevel:l,cause:c,props:{text:d,action:u},behavior:m}=e;return{__typename:"BannerNotification",bannerId:o,source:r,bannerScenario:null!=s?s:null,intentLevel:l,cause:null!=c?c:null,props:{__typename:"BannerNotificationProperties",text:null!=d?d:null,action:u?{__typename:"NotificationAction",command:u.command,text:null!==(t=u.text)&&void 0!==t?t:null,dismissOnAction:u.dismissOnAction}:null},behavior:{__typename:"BannerNotificationBehavior",dismissable:null!==(n=null==m?void 0:m.dismissable)&&void 0!==n&&n,dismissActionCommand:null!==(i=null==m?void 0:m.dismissActionCommand)&&void 0!==i?i:null,duration:null!==(a=null==m?void 0:m.duration)&&void 0!==a?a:0}}},cf=(e,t)=>{var n,i;let a=[];try{a=null!==(i=null===(n=t.readQuery({query:rf}))||void 0===n?void 0:n.bannerNotificationQueue)&&void 0!==i?i:[]}catch(t){e.error("Failed to read banner queue from data client cache. ",t)}return a.map(lf)},df=(e,t,n)=>{const i={bannerNotificationQueue:n.map(lf)};try{t.writeQuery({query:rf,data:i})}catch(t){e.error("Failed to write banner queue to data client cache. ",t)}},uf=(e,t,n)=>{let i=cf(e,t);i=i.filter((e=>e.bannerId!==n)),df(e,t,i)},mf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsShellReauthenticateMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"reauthenticateUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},gf=(e,t)=>{var n;return null===(n=t.mutate({mutation:mf}))||void 0===n?void 0:n.then((e=>{var t,n;return null===(n=null===(t=e.data)||void 0===t?void 0:t.reauthenticateUser)||void 0===n?void 0:n.success})).catch((t=>(e.error("Failed to perform reauthentication. ",t),Promise.resolve(void 0))))},pf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellGetToastNotificationQueueQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastNotificationQueue"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"intent"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"command"}},{kind:"Field",name:{kind:"Name",value:"dismissOnAction"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}}]},vf=e=>{var t;return e?{__typename:"NotificationAction",command:e.command,text:null!==(t=e.text)&&void 0!==t?t:null,dismissOnAction:e.dismissOnAction}:null},hf=e=>e?{__typename:"ConfirmationToastProperties",action:vf(e.action)}:null,ff=e=>{const{id:t,source:n,intent:i,title:a,body:o,duration:r}=e;return{__typename:"ToastNotification",id:t,intent:i,title:a,body:hf(null!=o?o:void 0),duration:null!=r?r:0,source:n}},yf=(e,t)=>{var n,i;let a=[];try{a=null!==(i=null===(n=t.readQuery({query:pf}))||void 0===n?void 0:n.toastNotificationQueue)&&void 0!==i?i:[]}catch(t){e.error("Failed to read toasts queue from data client cache. ",t)}return a.map(ff)},bf=(e,t,n)=>{const i={toastNotificationQueue:n.map(ff)};try{t.writeQuery({query:pf,data:i})}catch(t){e.error("Failed to write toast notifications queue to data client cache. ",t)}},Sf=(e,t)=>{if(!e)return;const n=e.toLowerCase();return n.includes("x86")?t.x86:n.includes("x64")||n.includes("amd64")||n.includes("intel64")?t.x64:n.includes("arm64")?t.arm64:void 0},kf={[u.u.create]:(e,t)=>{const{command:{correlation:{source:n}},entityOptions:a,entity:{id:o}}=t,{client:r,loggerFactory:s}=e,l=s.newLogger("addBannerNotificationToQueue","apps-shell"),c=a;if(c){const{text:e,action:t,dismissable:a,dismissActionCommand:s,duration:d}=c,u=(0,i.__rest)(c,["text","action","dismissable","dismissActionCommand","duration"]);let m;t&&(m=Object.assign(Object.assign({},t),{command:JSON.stringify(t.command)})),((e,t,n)=>{let i=cf(e,t);i=i.filter((e=>e.bannerId!==n.bannerId)),i.unshift(n),i=i.sort(((e,t)=>sf[e.intentLevel]-sf[t.intentLevel])),df(e,t,i)})(l,r,Object.assign(Object.assign({},u),{bannerId:o||"no-id",source:n,props:{text:e,action:m},behavior:{dismissable:a,dismissActionCommand:s?JSON.stringify(s):void 0,duration:d}}))}else l.error("entityOptions is missing IBannerNotificationOptions fields. ",a);return Promise.resolve(void 0)},[u.u.delete]:(e,t)=>{const{entity:{id:n}}=t,{client:i,loggerFactory:a}=e,o=a.newLogger("removeBannerNotificationFromQueue","apps-shell");return n&&uf(o,i,n),Promise.resolve(void 0)},[u.u.signin]:(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityOptions:n}=t,{client:i,loggerFactory:a}=e,o=a.newLogger("handleSignInBannerActionCommand","apps-shell"),r=n;return(yield gf(o,i))&&(null==r?void 0:r.bannerId)&&uf(o,i,r.bannerId),Promise.resolve(void 0)}))},wf={[u.u.create]:(e,t)=>{const{command:{correlation:{source:n}},entityOptions:a,entity:{id:o}}=t,{client:r,loggerFactory:s}=e,l=s.newLogger("addToastNotificationToQueue","apps-shell"),c=a;if(o&&c){const{body:e}=c,t=(0,i.__rest)(c,["body"]);let a;(null==e?void 0:e.action)&&(a=Object.assign(Object.assign({},null==e?void 0:e.action),{command:JSON.stringify(null==e?void 0:e.action.command)})),((e,t,n)=>{let i=yf(e,t);i=i.filter((e=>e.id!==n.id)),i.push(n),bf(e,t,i)})(l,r,Object.assign(Object.assign({},t),{id:o,source:n,body:{action:a}}))}else l.error("entityOptions is missing IToastNotificationParams fields. ",a);return Promise.resolve(void 0)},[u.u.delete]:(e,t)=>{const{entity:{id:n}}=t,{client:i,loggerFactory:a}=e,o=a.newLogger("removeToastNotificationFromQueue","apps-shell");return n&&((e,t,n)=>{let i=yf(e,t);i=i.filter((e=>e.id!==n)),bf(e,t,i)})(o,i,n),Promise.resolve(void 0)},[u.u.update]:(e,t)=>{const{command:{correlation:{source:n}},entityOptions:a,entity:{id:o}}=t,{client:r,loggerFactory:s}=e,l=s.newLogger("addToastNotificationToQueue","apps-shell"),c=a;if(o&&c){const{body:e}=c,t=(0,i.__rest)(c,["body"]);let a;(null==e?void 0:e.action)&&(a=Object.assign(Object.assign({},null==e?void 0:e.action),{command:JSON.stringify(null==e?void 0:e.action.command)})),((e,t,n)=>{const i=yf(e,t);let a=!1;for(let e=0;e<i.length;e++)if(i[e].id===n.id){i[e]=n,a=!0;break}a||i.push(n),bf(e,t,i)})(l,r,Object.assign(Object.assign({},t),{id:o,source:n,body:{action:a}}))}else l.error("entityOptions is missing IToastNotificationParams fields. ",a);return Promise.resolve(void 0)}},Cf={[u.u.view]:(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e=document.querySelector("[data-tid='me-control-avatar']");return null==e||e.click(),Promise.resolve(void 0)}))},_f=e=>{const{entityCommand:t,entityCommand:{entity:{type:n,action:a}},requestContext:o,windowProvider:r}=e;if(n===u.p.bannerNotification){const e=kf[a];if(e)return e(o,t)}else if(n===u.p.inAppToast){const e=wf[a];if(e)return e(o,t)}else if(n===u.p.memenu){const e=Cf[a];if(e)return e(o,t)}else if(n===u.p.updatedesktopapp&&a===u.u.confirm)return((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const{coreSettings:a,loggerFactory:o,scenarioFactory:r}=e,s=o.newLogger("downloadAppInstaller","apps-shell"),{enableDesktopMinimumVersionBanner:l}=a.get(L.J.Core);if(!l)return s.log("Sedimentation banner disabled by feature flag"),Promise.resolve(t);const{desktopAppInstallerLinks:c}=a.get(L.J.Core),{deviceInfo:d}=a.get(L.J.Platform),u=(null==d?void 0:d.cpuArchitecture)||void 0,m=Sf(u,c),g=null==r?void 0:r.findScenario(it.RG.MinimumVersionBannerMonitor);if(m)try{s.log(`Downloading the msix file for ${u}`);const e=null==n?void 0:n.document.createElement("a");return e.setAttribute("href",m),e.setAttribute("download",""),e.click(),e.remove(),null==g||g.mark("minimum_version_banner_clicked"),null==g||g.stop(),Promise.resolve(void 0)}catch(e){const n=`Failed to download msix file, where setup values is enableDesktopMinimumVersionBanner: \n    ${l}, cpuarch: ${u}, desktopAppInstallerLink: ${m}; \n    ${e.message}`;return null===(i=s.errorToTelemetry)||void 0===i||i.call(s,n,"unsupported-version-banner-job",{errorCode:e.name},!0),null==g||g.fail({errorCode:e.name,reason:"download-msix-file-error"}),Promise.resolve(t)}return s.log("Failed to download msix file - desktopAppInstallerLink not defined."),null==g||g.cancel({reason:"undefined-desktop-app-installer-link-event"}),Promise.resolve(t)})))(o,t,r);return Promise.resolve(t)},Tf=[{filter:"/notdefaultapp",execute:({context:{coreSettings:e,loggerFactory:t}})=>{const{enableAppSwitcher:n}=e.get(L.J.Core),i=t.newLogger("Shell:BeforeDeeplinkParsedCondition","apps-shell");return n?(i.log("execute command onBeforeDeeplinkParsed"),Promise.resolve({entityCommand:{entity:{type:u.p.pearnotdefaultapp,action:u.u.view},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,layoutMode:d.lO.standard}},metadata:{allowAnonymous:!0}})):(i.log(`app switcher is not enabled, enableAppSwitcher value is ${n}`),Promise.reject({message:"app-switcher-not-enabled"}))}}];var If,Ef;!function(e){e[e.NoOverride=0]="NoOverride",e[e.OverrideCloud=1]="OverrideCloud",e[e.OverrideIntent=2]="OverrideIntent",e[e.OverrideUserContext=3]="OverrideUserContext",e[e.TerminateNavigation=4]="TerminateNavigation"}(If||(If={})),function(e){e[e.MainWindow=0]="MainWindow",e[e.SourceWindow=1]="SourceWindow"}(Ef||(Ef={}));const Nf={filter:new Set([u.p.pearnotdefaultapp]),execute:({intent:e})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return{overrideType:If.OverrideIntent,intent:e}}))};function Af(e){const{hostCommunicationService:t,loggerFactory:n}=e,a=n.newLogger("auth-notification-job","apps-shell");return{id:"auth-notification",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e;const n=(0,Ye.v4)();try{a.debug(`Sending webAuthSucceeded notification start. CorrelationId: ${n}.`);const i=yield t.loadModule("auth");null===(e=null==i?void 0:i.webAuthSucceeded)||void 0===e||e.call(i,{correlationId:n}),a.debug(`Sending webAuthSucceeded notification complete. CorrelationId: ${n}.`)}catch(e){throw a.error(`Sending webAuthSucceeded notification failed. CorrelationId: ${n}. Error: ${(0,wi.u4)(e)}`),e}}))}}const Ff={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"OnAuthenticationStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationState"}}]}}]}}]},Df={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}}]}}]}}]},Rf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellAuthEndPagesDataQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userEndPageData"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"pictureBlob"}},{kind:"Field",name:{kind:"Name",value:"customError"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"subContext"}}]}}]}}]}}]};var xf=n(184717),Mf=n(710141);function Of(e,t){const{client:n,entityCommanding:a,i18n:o,loggerFactory:r,authenticationUser:s,coreSettings:l}=e,c=r.newLogger("auth-state-job","apps-shell"),d=n,u="auth-banner";let m=!0;return{id:"auth-state-subscription",job:()=>{d.subscribe({query:Ff}).filter((e=>{var t,n;return!!(null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.authenticationStateChanged)||void 0===n?void 0:n.authenticationState)})).subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var n,r,g,p;const v=yield d.query({query:Df});if(0===(null===(r=null===(n=null==v?void 0:v.data)||void 0===n?void 0:n.authenticationUsers)||void 0===r?void 0:r.length))return void c.warn("No authenticated user found, not displaying auth-banner.");const h=null===(p=null===(g=null==e?void 0:e.data)||void 0===g?void 0:g.authenticationStateChanged)||void 0===p?void 0:p.authenticationState;switch(h){case C.zGj.AADReconnecting:case C.zGj.SkypeReconnecting:!function(e,t,n,i){let a="",o="";t===C.zGj.AADReconnecting?(a=n.stringTranslate("auth","aad_reconnecting_text"),o="auth_aad_reconnecting"):t===C.zGj.SkypeReconnecting&&(a=n.stringTranslate("auth","skype_reconnecting_text"),o="auth_skype_reconnecting");i.shell.showBanner({id:e,source:kt.D.ShellAuthState,intentLevel:C.XuV.Neutral,text:a,dismissable:!0,duration:0,bannerScenario:o})}(u,h,o,a);break;case C.zGj.InteractionRequired:!function(e,t,n){n.shell.showBanner({id:e,source:kt.D.ShellAuthState,bannerScenario:"auth_sign_in_required",intentLevel:C.XuV.MostSevere,cause:C.lFB.AuthError,text:t.stringTranslate("auth","sign_in_required_text"),action:{text:t.stringTranslate("auth","sign_in_required_cta_text"),command:{entity:{type:C.pyR.bannerNotification,action:C.ukP.signin}},dismissOnAction:!1},dismissable:!1,duration:0})}(u,o,a);break;case C.zGj.LicenseError:yield function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableAuthEndPagesLicenseWarm:i}=(null==a?void 0:a.get(L.J.Auth))||{};if(!n||!i)return;const o=yield t.query({query:Rf,variables:{userContextId:n.id}}),{name:r,email:s,pictureBlob:l,customError:c}=null==o?void 0:o.data.userEndPageData;e.authentication.showAuthEndPage(kt.D.ShellAuthState,{error:(0,xf.MD)({authSubErrorCode:"LicenseError",errorCode:he.jK.Forbidden,errorMetaData:{accountId:n.id,name:r,email:s,pictureBlob:l,userLoggedIn:!0},name:"licenseEndPage",message:(null==c?void 0:c.message)||"",correlationId:(null==c?void 0:c.correlationId)||(0,Mf.pW)(),context:(null==c?void 0:c.context)||"auth-state-job",subContext:(null==c?void 0:c.subContext)||"show-license-error"})})}))}(a,d,s,l);break;case C.zGj.Up:default:!m&&a.shell.dismissBanner(u,kt.D.ShellAuthState)}t&&t(),m=!1}))))}}}var Pf=n(657345);const Lf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsShellCdlServicesStateSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appServiceStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appService"}},{kind:"Field",name:{kind:"Name",value:"previousState"}},{kind:"Field",name:{kind:"Name",value:"currentStateChangeTimestamp"}},{kind:"Field",name:{kind:"Name",value:"currentStateChangeReason"}},{kind:"Field",name:{kind:"Name",value:"currentStateChangeCode"}},{kind:"Field",name:{kind:"Name",value:"currentState"}}]}}]}}]};function Uf(e,t){const{client:n,entityCommanding:a,i18n:o,loggerFactory:r,coreSettings:s,networkState:l}=e,c=n,d="cdl-services-state-banner",u=r.newLogger("cdl-services-state-job","apps-shell");let m=!1;const g=(e,t,n,a,o,r)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){yield o.shell.showBanner({id:e,source:kt.D.ShellCDLServicesState,intentLevel:C.XuV.Neutral,text:n.stringTranslate("errors","chatsync_app_service_disconnected"),dismissable:!0,duration:0,bannerScenario:"cdl-service-state-disconnected-banner"}),a.infoToTelemetry&&a.infoToTelemetry("ChatSync app service is OFFLINE; displaying disconnected banner","cdl_app_state_chatsync_disconnected_banner_show",jf(t),!0),m=!0,r&&r(m)})),p=(e,t,n,a,o,r=!0)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){yield a.shell.dismissBanner(e,kt.D.ShellCDLServicesState),r&&n.infoToTelemetry&&n.infoToTelemetry("ChatSync app service is back up; dismissing existing banner","cdl_app_state_chatsync_disconnected_banner_dismiss",jf(t),!0),m=!1,o&&o(m)}));return{id:"cdl-services-state-subscription",job:()=>{const e=s.get(L.J.CdlWorker).disableTrouterDisconnectedBannerT2,n=!!s.get(L.J.CdlWorker).enableCdlAppStateService;if(e||!n)return void(u.infoToTelemetry&&u.infoToTelemetry("disableTrouterDisconnectedBanner killswitch is enabled or enableCdlAppStateService is disabled; not listening to app service state change events","cdl_app_state_chatsync_disconnected_banner"));const r=c.subscribe({query:Lf}).subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var n;if(!(null==e?void 0:e.data))return void(t&&t());const i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.appServiceStateChanged,{appService:r,currentState:s}=i;if(l.getState()===Pf.G.Online)switch(r){case"ChatSync":m||s!==C.YHP.OFFLINE?m&&s===C.YHP.ONLINE&&(yield p(d,i,u,a,t)):yield g(d,i,o,u,a,t)}else yield p(d,i,u,a,t,!1)}))));return()=>{r.unsubscribe()}}}}function jf(e){const{appService:t,currentState:n,currentStateChangeReason:i,currentStateChangeCode:a,previousState:o}=e;return{appService:t,currentState:n.toString(),currentStateChangeReason:i,currentStateChangeCode:a,previousState:null==o?void 0:o.toString()}}const $f="offline banner";function Bf(e){const{coreSettings:t,entityCommanding:n,i18n:i,loggerFactory:a,networkState:o}=e,r=a.newLogger("network-state-subscription-logger","apps-shell");let s=!0;return{id:"network-state-subscription",job:()=>{if(!t.get(L.J.Core).enableNetworkStateBannerSubscription)return void r.log("network state banner subscription is disabled");const e=o.observe().subscribe((e=>{e===Pf.G.Offline?(r.debug("showing offline banner"),n.shell.showBanner({id:$f,source:kt.D.ShellNetworkState,bannerScenario:"framework_offline_banner",intentLevel:C.XuV.Severe,cause:C.lFB.Offline,text:i.stringTranslate("framework","offline_banner_message"),dismissable:!1,duration:0})):s||(r.debug("dismissing offline banner"),n.shell.dismissBanner($f,kt.D.ShellNetworkState)),s=!1}));return()=>{e.unsubscribe()}}}}const Wf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"notifyWorkerSyncCanStart"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notifyWorkerSyncCanStart"}}]}}]};const Hf={id:"com.microsoft.teams.shell",name:"Shell",actors:[Qa],supportedEntities:[u.p.activecalldialog,u.p.bannerNotification,u.p.brbfeedbackdialog,u.p.hybridplaceholder,u.p.identitydialog,u.p.pearnotdefaultapp,u.p.signoutdialog,u.p.inAppToast,u.p.tpndialog,u.p.unsupporteddeeplinkdialog,u.p.updatemsaprofileavatardialog,u.p.updatemsaprofilenamedialog,u.p.joinlinkdialog,u.p.autobrbconfirmationdialog,u.p.framework,u.p.officeintegrationfredialog,u.p.memenu,u.p.updatedesktopapp,u.p.invitecoworkers],supportedRenderModes:[s.e.Main,s.e.Modal,s.e.Rail,s.e.ThinHorizontalBar,s.e.TitleBar,s.e.VerticalBar],windowFeatures:{minWidth:602,width:602,minHeight:520,height:520,offset:20}},Vf="identity",zf="signOut",qf="addNewAccount",Gf="switchAccount",Jf="switchTenants",Qf="openMeControl",Kf=()=>({actor:Vf,action:zf}),Yf=e=>({actor:Vf,action:Gf,data:{targetAccountId:e}}),Xf=e=>({actor:Vf,action:Jf,data:{targetTenantId:e}}),Zf=()=>({actor:Vf,action:Qf});var ey=n(387241);const ty="settings",ny="openScheduleOOF",iy={onEventReceived:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.requestContext.loggerFactory.newLogger("apps-shell-event-handler","apps-shell"),n=e.requestContext.userBiService,i=e.requestContext.scenarioFactory,a=e.eventInput.event;switch(a.originator){case $h.DQ:return((e,t,n)=>{var i,a;switch(e.type){case $h.iC.launch:if(!e.data)return void t.error("Received a launch event without data!");const o=e.data(),r=tf(o,t),s=null===(i=n.createDatabag)||void 0===i?void 0:i.call(n);return s&&(s.launchTileId=o.tileID,s.launchTilePosition=o.tilePosition,s.launchTileEventType=null===(a=o.reactEvent)||void 0===a?void 0:a.type,s.launchTileAppName=null==r?void 0:r.appName),n.recordPanelAction({actionGesture:Ja.uS.click,actionOutcome:Ja.$K.submit,actionScenario:Ja.Tk.openAppFromAppBar,actionScenarioType:Ja.Yu.appBar,moduleName:Ja.rA.novaAppBar,panelRegion:Ja.Ai.left,dataBag:s},t),null==s||s.dispose(),null==r?void 0:r.appViewCommand;case ef.S.CallingEvents.markAllAsRead:return n.recordPanelAction({actionGesture:Ja.uS.click,actionOutcome:Ja.$K.submit,actionScenario:Ja.Tk.markAllAsRead,actionScenarioType:Ja.Yu.appBar,moduleName:Ja.rA.novaAppBar,panelRegion:Ja.Ai.left},t),{command:Io()};default:return void t.warn(`Received an unhandled Launch tile event, type: ${e.type}`)}})(a,t,n);case $h.Ol:return((e,t,n)=>{var i;if(!e.data)return void t.error("Received a launch event without data!");const a=null===(i=n.createDatabag)||void 0===i?void 0:i.call(n),o=(0,Ue.J)();switch(e.type){case $h.iC.install:{const i=e.data();return a&&(a.launchTileId=i.tileID),n.recordPanelAction({actionGesture:Ja.uS.click,actionOutcome:Ja.$K.submit,actionScenario:Ja.Tk.launchAppDetailsFromPersonalFlyoutSuggestions,actionScenarioType:Ja.Yu.appBar,moduleName:Ja.rA.novaAppBar,panelRegion:Ja.Ai.left,dataBag:a},t),null==a||a.dispose(),{command:Gp(i.tileID)}}case $h.iC.privacy:{const i=e.data();return a&&(a.launchTileId=i.tileID),n.recordPanelAction({actionGesture:Ja.uS.click,actionOutcome:Ja.$K.submit,actionScenario:Ja.Tk.launchPrivacyLinkFromPersonalFlyoutSuggestions,actionScenarioType:Ja.Yu.appBar,moduleName:Ja.rA.novaAppBar,panelRegion:Ja.Ai.left,dataBag:a},t),null==a||a.dispose(),void o.open(i.privacyUrl)}case $h.iC.termsOfUse:{const i=e.data();return a&&(a.launchTileId=i.tileID),n.recordPanelAction({actionGesture:Ja.uS.click,actionOutcome:Ja.$K.submit,actionScenario:Ja.Tk.launchTermsOfUseLinkFromPersonalFlyoutSuggestions,actionScenarioType:Ja.Yu.appBar,moduleName:Ja.rA.novaAppBar,panelRegion:Ja.Ai.left,dataBag:a},t),null==a||a.dispose(),void o.open(i.termsOfUseUrl)}case $h.iC.permissions:{const i=e.data();return a&&(a.launchTileId=i.tileID),n.recordPanelAction({actionGesture:Ja.uS.click,actionOutcome:Ja.$K.submit,actionScenario:Ja.Tk.launchPermissionsLinkFromPersonalFlyoutSuggestions,actionScenarioType:Ja.Yu.appBar,moduleName:Ja.rA.novaAppBar,panelRegion:Ja.Ai.left,dataBag:a},t),null==a||a.dispose(),{command:Gp(i.tileID,"permissions")}}default:return void t.warn(`Received an unhandled Launch tile event, type: ${e.type}`)}})(a,t,n);case $h.tL:return{command:Yh()};case $h.Ug:if(a.type===$h.iC.appBarImpression&&i.stopScenarioIfActive(it.RG.AppBarLoad),a.type===$h.iC.renderError){let e;a.data&&(e=a.data()),t.errorToTelemetry&&t.errorToTelemetry("AppBar render failed!","webclient_framework_shell_appbar_render_failure_event"),t.error("AppBar Render Error:",null==e?void 0:e.error),t.error("AppBar React Error Info:",null==e?void 0:e.errorInfo);const n=i.findScenario(it.RG.AppBarLoad);return void(n&&n.fail())}if(a.type===$h.iC.flyoutOpened)return{command:qp()}}return a.originator===ey.CB?((e,t)=>{switch(e.type){case ey.BR.addNewAccount:return{command:{actor:Vf,action:qf,data:{commandSource:kt.D.AddAccountFromMeMenu}}};case ey.BR.switchTenant:const n=e.data?e.data().tenantId:void 0;return n?{command:Xf(n)}:void(t.errorToTelemetry&&t.errorToTelemetry("Me Control Switch Tenant called without tenant id.","webclient_framework_shell_event_handler_error"));case ey.BR.switchAccount:const i=e.data?e.data().accountId:void 0;return i?{command:Yf(i)}:void(t.errorToTelemetry&&t.errorToTelemetry("Me Control Switch account called without account id.","webclient_framework_shell_event_handler_error"));default:return}})(a,t):a.originator===ey.D_?(e=>{switch(e.type){case ey.BR.openMeControl:return{command:Zf()};case ey.BR.signOut:return{command:Kf()};default:return}})(a):a.originator===ey.ls?(e=>{switch(e.type){case ey.BR.updateDisplayName:return{command:to()};case ey.BR.updateProfilePicture:return{command:eo()};case ey.BR.scheduleOOF:return{command:{actor:ty,action:ny}};default:return}})(a):Promise.resolve(void 0)}))},ay=({commandInput:{command:e},requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n;const i=e.action,a=t.newLogger("ShellApp onCommandReceived","apps-shell");return i===Ka?"object"==typeof(o=e.data)&&null!==o&&"title"in o&&"intent"in o&&"dismissOnAction"in o?{command:{correlation:{source:kt.D.Nova},stateTransition:d.su.none,visibilityState:d.fe.show},entity:{type:u.p.inAppToast,action:u.u.create,id:(0,Ye.v4)()},entityOptions:e.data}:void(null===(n=a.errorNoPii)||void 0===n||n.call(a,`Command for action '${e.action}' requires title, intent and dismissOnAction.`)):i===Ya?{command:{correlation:{source:kt.D.Nova},stateTransition:d.su.extend,visibilityState:d.fe.show},entity:{type:u.p.updatemsaprofileavatardialog,action:u.u.view}}:i===Xa?{command:{correlation:{source:kt.D.Nova},stateTransition:d.su.extend,visibilityState:d.fe.show},entity:{type:u.p.updatemsaprofilenamedialog,action:u.u.view}}:void 0;var o})),oy=({type:e,appRenderMode:t})=>{const n=new ht.H,i=[];return e===u.p.pearnotdefaultapp&&t===s.S.Main&&i.push(ft.GZ.APP_SWITCHER_CONFIRMATION_RENDERED),n.registerAppPhase({phase:ft.nh.CRITICAL,signals:i,timeout:5e3}),n.appPhases};function ry(e){const{coreSettings:t,i18n:n,entityCommanding:a,loggerFactory:o,scenarioFactory:r}=e,s=o.newLogger("DesktopUnsupportedVersionCheckJob","apps-shell"),{enableDesktopMinimumVersionBanner:l}=t.get(L.J.Core),c=r.newScenario(it.RG.MinimumVersionBannerMonitor);return l?{id:"desktop-minimum-version-check-job",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){s.log("Checking unsupported desktop client versions...");(function(e,t){const{minimumDesktopVersion:n}=t.get(L.J.Core),{desktopVersion:i}=t.get(L.J.Host),{deviceInfo:a}=t.get(L.J.Platform),o=(null==a?void 0:a.cpuArchitecture)||void 0,r=(null==a?void 0:a.osName)||void 0,s=function(e,t,n,i){var a;if(t&&e){if(e.includes("macos"))return n.macOS;if(e.includes("windows"))switch(!0){case t.includes("x64")||t.includes("amd64")||t.includes("intel64"):return n.x64;case t.includes("x86"):return n.x86;case t.includes("arm64"):return n.arm64;default:null===(a=i.errorToTelemetry)||void 0===a||a.call(i,`Unknown cpuarch: ${t}`,"unsupported-version-banner-job",{},!0)}}}(null==r?void 0:r.toLowerCase(),null==o?void 0:o.toLowerCase(),n,e);var l;if(e.log(`Desktop client version is ${i}, minimum supported version is ${s}`),s&&i)return l=s,-1===i.localeCompare(l,void 0,{numeric:!0,sensitivity:"base"})&&(e.log("Unsupported desktop version detected."),!0);e.log("Desktop client versions not found. Desktop version check skipped.")})(s,t)&&(!function(e,t,n,i,a,o){t.shell.showBanner({id:e,source:kt.D.ShellVersionCheck,bannerScenario:a,intentLevel:C.XuV.Severe,cause:C.lFB.UnsupportedAppVersionDetected,text:n.stringTranslate("framework",a),action:{text:n.stringTranslate("framework",o),command:{entity:{type:u.p.updatedesktopapp,action:u.u.confirm,id:ei.Y.Notifications}},dismissOnAction:!0},dismissable:!0,duration:0}),i.log("Desktop sedimentation banner displayed")}("DesktopSedimentationBanner",a,n,s,"desktopapp_version_unsupported_generic_banner","more_options_menu_initiate_update"),null==c||c.mark("minimum_version_banner_shown"))}))}:(s.log("Sedimentation banner disabled by feature flag"),void c.stop({reason:"enableDesktopMinimumVersionBanner disabled"}))}var sy=n(329674),ly=n(918642);const cy={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellMeQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}}]}}]}}]},dy="presence-top-banner";function uy(e){const{i18n:t,entityCommanding:n,loggerFactory:a,authenticationUser:o,client:r,coreSettings:s}=e,l=a.newLogger("presence-state-subscription-logger","apps-shell"),c=r;return{id:"presence-prewarm-job",job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e;const{enablePresenceTopBanner:i}=s.get(L.J.Presence);if(!i)return;const a=yield c.query({query:cy}),r=c.subscribe({query:sy.c,variables:{userId:null===(e=a.data.me)||void 0===e?void 0:e.mri,source:C.W8Z.ups}}).subscribe((({data:e})=>{const{presenceUpdateEvent:i}=e||{},{availability:a,statusNote:r}=i||{},s="DoNotDisturb"===a,c=null==r?void 0:r.message.includes("<pinnednote></pinnednote>");s?function(e,t){const n=e.stringTranslate("presence","dnd_info_banner_message"),i=e.stringTranslate("presence","presence_info_banner_change_settings"),a={source:kt.D.ShellPresenceState},o={text:i,command:{entity:{type:u.p.settingsstore,action:u.u.view,id:ei.Y.Privacy},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:a},entityOptions:{correlation:a}},dismissOnAction:!1};my(t,C.lFB.PresenceDoNotDisturb,n,o)}(t,n):c?function(e,t,n){const i=e.stringTranslate("presence","status_note_info_banner_message",void 0!==n?{expiryTime:e.formatDateTime(new Date(n),ly.uF)}:{}),a={text:e.stringTranslate("presence","presence_info_banner_change_status"),command:{entity:{type:u.p.memenu,action:u.u.view}},dismissOnAction:!1};my(t,C.lFB.PresencePinnedStatusNote,i,a)}(t,n,(null==r?void 0:r.expiry)||void 0):n.shell.dismissBanner(dy,kt.D.ShellPresenceState),l.log(`### [Presence State Subscription] ID: ${null==o?void 0:o.id}`)}));return()=>{r.unsubscribe(),l.log("[Presence] unsubscribing ...")}}))}}function my(e,t,n,i){e.shell.showBanner({id:dy,source:kt.D.ShellPresenceState,intentLevel:C.XuV.Neutral,cause:t,text:n,action:i,dismissable:!0,duration:0})}const gy=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(273621),n.e(134315),n.e(287783),n.e(168904),n.e(687601),n.e(522024),n.e(511402),n.e(274690),n.e(869519),n.e(195823),n.e(193753),n.e(177041),n.e(453384),n.e(10143),n.e(986101),n.e(316401),n.e(295372),n.e(264630),n.e(52647),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(815994),n.e(305271)]).then(n.bind(n,194658)),py=()=>Promise.all([n.e(273621),n.e(134315),n.e(168904),n.e(511402),n.e(736461),n.e(602460),n.e(902140),n.e(897526)]).then(n.bind(n,666347)),vy=({host:e,screenState:t,isResize:n})=>{if(n){if(!Hf.windowFeatures)return null;const e=Hf.windowFeatures,{offset:t}=e;return(0,i.__rest)(e,["offset"])}const{height:a,minHeight:o,minWidth:r,offset:s,width:l}=Hf.windowFeatures||{},c={left:(null==e?void 0:e.screenX)||0,top:(null==e?void 0:e.screenY)||0},d=((null==t?void 0:t.numOpenWindows)||1)*(s||1);return{additionalFeatures:{minHeight:`${o}`,minWidth:`${r}`},height:a,left:(null==c?void 0:c.left)+d,minHeight:o,minWidth:r,top:(null==c?void 0:c.top)+d,width:l}};function hy(e){const t=null==e?void 0:e.isMainWindow;t&&(()=>{var e,t;null===(e=Hf.supportedRenderModes)||void 0===e||e.push(s.e.PartialOverlay),null===(t=Hf.supportedRenderModes)||void 0===t||t.push(s.e.OverlayThinHorizontalBar)})();return{getAppPhases:oy,getAppViewEntities:Dh,getAppViewEntitiesProps:jh,getAppWindowFeatures:vy,getEventScenarioData:of,manifest:Hf,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;if(t){const e="shell-app";n("ChunkLoadStarted",{chunkName:e}),i=(yield(0,c.mT)(gy,e,a)).T2ShellViewsRenderer,n("ChunkLoadSucceeded",{chunkName:e})}else{const e="mw-shell-app";n("ChunkLoadStarted",{chunkName:e}),i=(yield(0,c.mT)(py,e,a)).T1ShellViewsRenderer,n("ChunkLoadSucceeded",{chunkName:e})}return o.createElement(i,{appRenderMode:e})})),onPreWarm:e=>{const{context:t}=e,n=[Af(t),Of(t),Uf(t),Bf(t),uy(t)],i=function(e){const{client:t,coreSettings:n}=e,i=t;if(n.get(L.J.CdlWorker).enableStartupDeferral)return{id:"worker-start-sync",runOncePerId:!0,job:()=>{i.mutate({mutation:Wf,fetchPolicy:"no-cache",variables:{}})}}}(t);i&&n.push(i);const a=ry(t);return a&&n.push(a),n},onBeforeDeeplinkParsed:Tf,eventHandlers:iy,onBeforeIntentAuthenticated:Nf,onBeforeCommandHandled:_f,onCommandReceived:ay}}const fy=e=>{if(yy(e))return by(e)?{subNavEntity:Sy(e),headerEntity:ky(e),startEntity:wy(e),mainEntity:Cy(e),endEntity:_y(e)}:null},yy=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.signoutdialog,u.p.smartdeviceagendapage,u.p.smartdevicelogin].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},by=()=>!0,Sy=()=>null,ky=()=>null,wy=()=>null,Cy=({entity:e})=>e,_y=()=>null,Ty={id:"com.microsoft.teams.smart-devices",name:"SmartDevicesApp",supportedEntities:[u.p.smartdeviceagendapage,u.p.smartdevicelogin,u.p.smartdevicelogoutdialog],supportedRenderModes:[s.S.Main,s.S.Modal]},Iy=()=>n.e(779188).then(n.bind(n,607325)),Ey=()=>Promise.all([n.e(809326),n.e(623025),n.e(579814),n.e(110350),n.e(506205),n.e(54570),n.e(992338)]).then(n.bind(n,783259)),Ny=()=>Promise.all([n.e(893479),n.e(480859)]).then(n.bind(n,52488));function Ay(){const e=()=>null;return{getAppViewEntities:fy,manifest:Ty,render:({appRenderMode:t,loggerFactory:n,onRenderEvent:a,scenarioFactory:r,entity:d})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{type:i}=d,m=n.newLogger("SmartDevicesApp","apps-smart-devices"),g="smart-devices-app";if(t===s.S.Modal){const{SmartDeviceModal:e}=yield(0,c.mT)(Ny,g,r);return o.createElement(e,{entityType:i})}if(t===s.S.Main){let t;switch(i){case u.p.smartdeviceagendapage:const{SmartDeviceAgendaPage:e}=yield(0,c.mT)(Ey,g,r);t=o.createElement(e,null);break;case u.p.smartdevicelogin:const{SmartDeviceLogin:n}=yield(0,c.mT)(Iy,g,r);t=o.createElement(n,null)}return t?(a("ChunkLoadStarted",{chunkName:g}),a("ChunkLoadSucceeded",{chunkName:g}),m.log("render: loading smart devices app"),o.createElement(l.f,{namespace:"smartDevice",loaderRenderer:null},o.createElement(l.f,{namespace:"calling",loaderRenderer:null},t))):o.createElement(e,null)}return o.createElement(e,null)}))}}const Fy=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("StoreApp onCommandReceived","apps-store");if(e.command.actor===Qh)switch(n){case Kh:return{entity:{type:u.p.store,action:u.u.view},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.Unknown}}};default:i.error(`Command action '${n}' is not supported by StoreApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by StoreApp.`)})),Dy=e=>{if(Ry(e))return xy(e)?{subNavEntity:My(e),headerEntity:Oy(e),startEntity:Py(e),mainEntity:Ly(e),endEntity:Uy(e)}:null},Ry=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.store].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},xy=()=>!0,My=()=>null,Oy=()=>null,Py=()=>null,Ly=({entity:e})=>e,Uy=()=>null,jy={id:"com.microsoft.teams.store",name:"StoreApp",actors:[Qh],getLocalizedName:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("extensibility"),e.stringTranslate("extensibility","extensibility_apps_label")})),supportedEntities:[u.p.store,u.p.storefre],supportedRenderModes:[s.S.Main,s.S.Modal],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},$y=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(129408),n.e(899405),n.e(907784),n.e(838608),n.e(553211),n.e(714133),n.e(92700),n.e(779813),n.e(193693),n.e(282671),n.e(369229),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(730588),n.e(998947),n.e(958163),n.e(301920),n.e(523537),n.e(757663),n.e(59106),n.e(578339),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(953808),n.e(836083),n.e(699466),n.e(279439),n.e(510510),n.e(838267),n.e(652336),n.e(376488),n.e(18648),n.e(528187),n.e(105672),n.e(169755),n.e(377194),n.e(497130)]).then(n.bind(n,307410)),By=()=>Promise.all([n.e(893479),n.e(602460),n.e(939626),n.e(822099)]).then(n.bind(n,640817)),Wy=()=>Promise.all([n.e(698926),n.e(425270)]).then(n.bind(n,427561)),Hy=()=>Promise.all([n.e(523537),n.e(812302),n.e(659098)]).then(n.bind(n,901282));function Vy(){const e=()=>null;return{getPlatformAppIdForEntity:e=>e.type===u.p.store?"ac40aa4a-fef1-4896-aea2-46d1c14dbfd5":void 0,onCommandReceived:Fy,getAppViewEntities:Dy,manifest:jy,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="store-app";n("ChunkLoadStarted",{chunkName:e});const[{StoreEntryRenderer:t}]=yield Promise.all([(0,c.mT)($y,e,a),(0,c.mT)(Wy,e,a),(0,c.mT)(Hy,e,a)]);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(t,null))}if(t===s.S.Modal){const e="store-fre-modal";n("ChunkLoadStarted",{chunkName:e});const{Modal:t}=yield(0,c.mT)(By,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(t,null))}return o.createElement(e,null)}))}}const zy={id:"com.microsoft.teams.survey-form",name:"SurveyFormApp",supportedEntities:[u.p.survey,u.p.givefeedbackchoices],supportedRenderModes:[s.S.Main,s.S.Modal],windowFeatures:{[u.p.survey]:{minWidth:600,width:800,minHeight:400,height:640,offset:20},[u.p.givefeedbackchoices]:{minWidth:602,width:602,minHeight:500,height:500,offset:20}}},qy=e=>{if(Gy(e))return Jy(e)?{subNavEntity:Qy(e),headerEntity:Ky(e),startEntity:Yy(e),mainEntity:Xy(e),endEntity:Zy(e)}:null},Gy=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o={[u.p.givefeedbackchoices]:[u.u.default,u.u.view],[u.p.survey]:[u.u.default,u.u.view]},r=n&&(o[i]||[]).includes(n);return!(!a||!r)},Jy=()=>!0,Qy=()=>null,Ky=()=>null,Yy=()=>null,Xy=({entity:e})=>e,Zy=()=>null,eb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"bootstrapFloodgate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"firstLoginInformation"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bootstrapFloodgate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"firstLoginInformation"},value:{kind:"Variable",name:{kind:"Name",value:"firstLoginInformation"}}},{kind:"Argument",name:{kind:"Name",value:"userSurveyNotificationEnabled"},value:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}}}]}]}}]},tb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"onSurveySend"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"onSurveySend"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"coachmarkId"}}]}}]}}]},nb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategorySubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferencesChangedEventForCategory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userEnableSurveysNotification"}}]}}]}}]},ib={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsSurveyFormFloodgateUpdateUserSurveyNotificationEnabledMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"floodgateUpdateUserSurveyNotificationEnabled"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userSurveyNotificationEnabled"},value:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}}}]}]}}]},ab={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"firstLoginInfo"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"firstLoginInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Web"}}]}}]}.definitions]},ob={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategoryQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferencesForCategory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformationValue"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategoryFragment"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserEnableSurveysNotificationValue"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userEnableSurveysNotification"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategoryFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Web"}}]}}]}.definitions]},rb="telemetry_instrumentation_feedback_platform_app_job_setup_floodgate",sb=(e,t,n,a,o)=>({id:"bootstrap-floodgate",runOncePerId:!0,job:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var r,s,l;const c=n.newLogger("getBootstrapFloodgateJob","apps-suvey-form");c.log("[getBootstrapFloodgateJob] Initializing floodgate");try{let n;n=o?yield(d=e,(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e,t;const n=yield d.query({query:ob,variables:{category:"firstLoginInformation"}});return"FirstLoginInformationValue"===(null===(e=n.data)||void 0===e?void 0:e.userPreferencesForCategory.__typename)?null===(t=n.data)||void 0===t?void 0:t.userPreferencesForCategory.firstLoginInformation:null}))):yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;return null===(n=null===(t=(yield e.query({query:ab})).data)||void 0===t?void 0:t.userPreferences)||void 0===n?void 0:n.firstLoginInformation})))(e);const u=null!==(r=null==n?void 0:n.Web)&&void 0!==r?r:"",m=yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;const i=yield e.query({query:ob,variables:{category:"userEnableSurveysNotification"}});return"UserEnableSurveysNotificationValue"===(null===(t=i.data)||void 0===t?void 0:t.userPreferencesForCategory.__typename)?null===(n=i.data)||void 0===n?void 0:n.userPreferencesForCategory.userEnableSurveysNotification:null})))(e);u?null===(l=c.log)||void 0===l||l.call(c,"First login information is available! with enableUserPreferencesForCategoryQuery : "+(o?"enabled":"disabled"),rb):null===(s=c.errorToTelemetry)||void 0===s||s.call(c,"First login information is not available! with enableUserPreferencesForCategoryQuery : "+(o?"enabled":"disabled"),rb);const g=yield e.subscribe({query:tb,fetchPolicy:"no-cache"}).subscribe((({data:e,errors:n})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;if(n){c.error("[getBootstrapFloodgateJob] Error subscribing to floodgate. Stopping the subscription");try{g.unsubscribe()}catch(e){c.error("[getBootstrapFloodgateJob] Error stopping floodgate")}}null===(i=c.log)||void 0===i||i.call(c,`Activated survey: ${null==e?void 0:e.onSurveySend.id} with coachmark ${null==e?void 0:e.onSurveySend.coachmarkId}`,rb),(null==e?void 0:e.onSurveySend.coachmarkId)&&(yield t.esp.displaySurface(e.onSurveySend.coachmarkId),a.newScenario(it.RG.FloodgateSurvey).stop({context:JSON.stringify({surveyId:null==e?void 0:e.onSurveySend.id,coachmarkId:null==e?void 0:e.onSurveySend.coachmarkId})}))}))));yield e.mutate({mutation:eb,variables:{firstLoginInformation:u,userSurveyNotificationEnabled:m}});const p=yield e.subscribe({query:nb,variables:{category:"userEnableSurveysNotification"},fetchPolicy:"no-cache"}).subscribe((({data:t,errors:n})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;if(n){c.error("[getBootstrapFloodgateJob] Error subscribing to userSettings. Stopping the subscription");try{p.unsubscribe()}catch(e){c.error("[getBootstrapFloodgateJob] Error stopping userSurveyNotificationEnabledSubscription")}}const a=null===(i=null==t?void 0:t.userPreferencesChangedEventForCategory)||void 0===i?void 0:i.userEnableSurveysNotification;null!=a&&(yield e.mutate({mutation:ib,variables:{userSurveyNotificationEnabled:a}}))}))))}catch(e){c.error(`[getBootstrapFloodgateJob] Error initializing floodgate [error.name=${null==e?void 0:e.name}]`)}var d;c.log("[getBootstrapFloodgateJob] Floodgate initialized")}))}),lb=({context:{client:e,coreSettings:t,loggerFactory:n,entityCommanding:i,scenarioFactory:a}})=>{const{enableFloodgateService:o,enableUserPreferencesForCategoryQuery:r}=t.get(L.J.Feedback),s=[],l=e;return o&&s.push(sb(l,i,n,a,r)),s},cb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsSurveyFormFloodgateLogActivityMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activityName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"increment"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"floodgateLogActivity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activityName"},value:{kind:"Variable",name:{kind:"Name",value:"activityName"}}},{kind:"Argument",name:{kind:"Name",value:"increment"},value:{kind:"Variable",name:{kind:"Name",value:"increment"}}}]}]}}]};class db extends fe{constructor(){super(he.Yg.GeneralizedLogActivityTask,["client","hostCommunicationService","coreSettings","loggerFactory"])}execute(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:i,hostCommunicationService:a,coreSettings:o,loggerFactory:r}=e,s=r.newLogger("generalizedLogActivityTask","apps-suvey-form");if(null==o?void 0:o.get(L.J.SurveyForm).enableCsatTaskRegistration){if(!a)return;try{const e=yield a.loadModule("surveyform"),n=null===(t=null==e?void 0:e.registerForLogActivity)||void 0===t?void 0:t.call(e,(e=>{((e,t,n)=>{e.mutate({mutation:cb,variables:{activityName:t,increment:n}})})(i.client,e.activityName,e.incrementValue)}));return()=>{n&&n()}}catch(e){return void(null===(n=s.errorToTelemetry)||void 0===n||n.call(s,`Loading module surveyform failed with errorCode: ${e.errorCode}`,"generalized_log_activity_task"))}}}))}}const ub=()=>Promise.all([n.e(893479),n.e(76118),n.e(239894),n.e(124624),n.e(210199),n.e(649832),n.e(815994),n.e(211286)]).then(n.bind(n,877388)),mb=({host:e,entityType:t})=>{if(!e)return null;const{windowFeatures:n}=zy,i=t&&n&&n[t]?n[t]:null!=n?n:void 0,{height:a=1,width:o=1,minHeight:r,minWidth:s}=i||{},l={left:e.screenX,top:e.screenY};if(e.screen){return{left:Math.max((e.screen.availWidth-o)/2,0),top:Math.max((e.screen.availHeight-a)/2,0),additionalFeatures:{minHeight:`${r}`,minWidth:`${s}`},minHeight:r,minWidth:s,height:Math.min(a,e.screen.availHeight),width:Math.min(o,e.screen.availWidth)}}return{left:Math.max(l.left,0),top:Math.max(l.top,0),additionalFeatures:{minHeight:`${r}`,minWidth:`${s}`},minHeight:r,minWidth:s,height:a,width:o}};function gb(){return{getAppViewEntities:qy,getAppWindowFeatures:mb,manifest:zy,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="survey-form-entry";t("ChunkLoadStarted",{chunkName:i});const a=(yield(0,c.mT)(ub,i,n)).SurveyAppViewsRenderer;return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(l.f,{namespace:"survey",loaderRenderer:null},o.createElement(a,{appRenderMode:e}))})),onPreWarm:lb,onRegister:e=>{e.registerTask(new db)}}}const pb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}}]}}]}}]},vb={onEventReceived:({eventInput:e,requestContext:{client:t,viewEntity:n}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a,o,r,s,l;switch(e.event.type){case Vi.uS.expandTab:{const t=null===(a=(i=e.event).data)||void 0===a?void 0:a.call(i);return Promise.resolve({command:zi.CN.expandTab(t)})}case Vi.uS.resetLayoutOverrides:return Promise.resolve({command:zi.CN.resetLayoutOverrides()});case ln.uS.requestPersonMoreInfo:{const i=null===(r=(o=e.event).data)||void 0===r?void 0:r.call(o);let a=!1,s="";if(null==n?void 0:n.id){const{data:{chat:e}}=yield t.query({query:pb,variables:{convId:null==n?void 0:n.id}});a=!!(null==e?void 0:e.substrateGroupId),s=(null==e?void 0:e.tenantId)||""}const l=mn(Object.assign(Object.assign(Object.assign(Object.assign({},i),s&&{tenantId:s}),(null==n?void 0:n.id)&&{conversationId:null==n?void 0:n.id}),{isSharedChannel:a}));return Promise.resolve({command:l})}case ln.uS.requestTopicMoreInfo:{const t=null===(l=(s=e.event).data)||void 0===l?void 0:l.call(s);return Promise.resolve({command:gn(Object.assign({},t))})}}return Promise.resolve(void 0)}))};var hb,fb,yb,bb,Sb,kb=n(97600);!function(e){e.teamDashboard="/l/team-dashboard",e.channelDashboard="/l/channel-dashboard",e.pendingInvites="/l/manage-teams/myinvites",e.channel="/l/channel",e.replyChain="/l/message",e.team="/l/team"}(hb||(hb={})),function(e){e.FeatureNotEnabled="Feature for parsing T1 teams and channels deep links in T2.1 is not enabled",e.NoChannelId="Parsed teams and channels deep link does not contain the channel id",e.NoThreadId="Parsed teams and channels deep link does not contain the thread id",e.InvalidDeeplinkType="Parsed teams and channels deep link does not contain a valid deeplink type",e.NoTabId="Parsed teams and channels deep link does not contain the tab id"}(fb||(fb={})),function(e){e.FeatureNotEnabled="channel_on_before_deep_link_parsed_feature_not_enabled_error",e.NoChannelId="channel_on_before_deep_link_parsed_no_channel_id_error",e.NoThreadId="channel_on_before_deep_link_parsed_no_thread_id_error",e.InvalidDeeplinkType="channel_on_before_deep_link_parsed_invalid_deeplink_type_error",e.NoTabId="channel_on_before_deep_link_parsed_no_tab_id_error"}(yb||(yb={})),function(e){e.TeamDashboard="team-dashboard",e.ChannelDashboard="channel-dashboard",e.TeamsDashboard="manage-teams"}(bb||(bb={})),function(e){e.MembersId="td.members",e.SettingsId="td.settings",e.AppsId="td.apps",e.PendingRequestsId="td.joinRequests",e.ChannelsId="td.channels",e.AnalyticsId="td.analytics",e.SharedChannelPendingRequestsId="sharedChannelPendingRequests",e.TagsId="td.tags"}(Sb||(Sb={}));const wb=({deeplinkUrl:e,parsedDeeplinkHash:t,preferredCommandInput:n,context:{coreSettings:i,loggerFactory:a,scenarioFactory:o}})=>{var r,s;const l=a.newLogger("TeamsAndChannelsApp onBeforeDeeplinkParsed","apps-teams-and-channels"),{enablePlatformDeepLinkRouting:c}=i.get(L.J.Extensibility),{enableParseT1TeamsAndChannelsDeeplinks:d}=i.get(L.J.Channels);if(!d)throw null===(r=l.errorToTelemetry)||void 0===r||r.call(l,fb.FeatureNotEnabled,yb.FeatureNotEnabled),Error(fb.FeatureNotEnabled);let u,m,g,p,v,h,f={};if(null==t?void 0:t.search){const{search:e}=t;l.log(`Parsing parsedDeeplinkHash - channelId: ${e.threadId}, replyChainId: ${e.replyChainId}, messageId: ${e.messageId}, tenantId: ${e.tenantId}`),u=e.threadId,m=e.replyChainId,g=e.messageId,p=e.tenantId,h=e.groupId}else{const{pathname:t,search:n}=e;l.log(`Parsing deeplinkUrl - pathname: ${t}, search: ${n}`);const i=t.split("/"),a=null==t?void 0:t.split(/[/?&]/),o=null==a?void 0:a.indexOf("channel");v=null==a?void 0:a[o+Ls.ei];const r=i.findIndex((e=>e.startsWith(rr.at.SkypeSpacesThread)));u=i[r];const s=new URLSearchParams(n),c=s.get("context");f=c&&JSON.parse(c),m=s.get("parentMessageId")||void 0,g=r+1<i.length&&(0,kb.kz)(i[r+1])?i[r+1]:void 0,p=s.get("tenantId")||void 0,h=s.get("groupId")||void 0}if(u)return c&&(null==v?void 0:v.includes(Ls.pQ))?(l.log(`toPlatformTabNavigationIntent - tabId: ${v} channelId: ${u}, deeplinkContext: ${f}, tenantId: ${p}`),(0,Ls.Jj)(u,"",e,p,f,v,o)):(l.log(`toNavigationIntent - channelId: ${u}, replyChainId: ${m}, messageId: ${g}, tenantId: ${p}`),_b(u,m,g,p,h,n));throw null===(s=l.errorToTelemetry)||void 0===s||s.call(l,fb.NoChannelId,yb.NoChannelId),Error(fb.NoChannelId)},Cb=({deeplinkUrl:e,preferredCommandInput:t,context:{loggerFactory:n}})=>{var i,a,o;const r=n.newLogger("TeamsAndChannelsApp onBeforeDeeplinkParsed","apps-teams-and-channels"),{pathname:s}=e;r.log(`Parsing deeplinkUrl - pathname: ${s}`);const l=s.split("/"),c=l[2];let d;switch(c){case bb.TeamsDashboard:return r.log(`toNavigationTeamsDashboard - deeplinkType: ${c}`),Nb(t);case bb.TeamDashboard:case bb.ChannelDashboard:const e=l.findIndex((e=>e.startsWith(rr.at.SkypeSpacesThread))),n=l[e];if(!n)throw null===(i=r.errorToTelemetry)||void 0===i||i.call(r,fb.NoThreadId,yb.NoThreadId),Error(fb.NoThreadId);if(d=l[4],!d)throw null===(a=r.errorToTelemetry)||void 0===a||a.call(r,fb.NoTabId,yb.NoTabId),Error(fb.NoTabId);return r.log(`toNavigationThreadDashboard - deeplinkType: ${c}, threadId: ${n}, tab: ${d}`),Tb(c,n,d,t);default:throw null===(o=r.errorToTelemetry)||void 0===o||o.call(r,fb.InvalidDeeplinkType,yb.InvalidDeeplinkType),Error(fb.InvalidDeeplinkType)}},_b=(e,t,n,i,a,o)=>{var r,s;return Promise.resolve({entityCommand:{entity:{type:u.p.channels,action:u.u.view,id:JSON.stringify({channelId:e,replyChainId:t})},command:{stateTransition:null!==(r=null==o?void 0:o.stateTransition)&&void 0!==r?r:d.su.new,visibilityState:null!==(s=null==o?void 0:o.visibilityState)&&void 0!==s?s:d.fe.show},entityOptions:{deepLinkId:n,groupId:a}},metadata:{allowAnonymous:!1,tenantId:i}})},Tb=(e,t,n,i)=>{var a,o;const r=e===bb.TeamDashboard?Ib(n):Eb(n);return Promise.resolve({entityCommand:{entity:{type:r,action:u.u.view,id:t},command:{stateTransition:null!==(a=null==i?void 0:i.stateTransition)&&void 0!==a?a:d.su.flush,visibilityState:null!==(o=null==i?void 0:i.visibilityState)&&void 0!==o?o:d.fe.show}},metadata:{allowAnonymous:!1}})},Ib=e=>{switch(e){case Sb.AnalyticsId:return u.p.teamanalytics;case Sb.ChannelsId:return u.p.teamchannels;case Sb.SettingsId:return u.p.teamsettings;case Sb.AppsId:return u.p.teammanageapps;case Sb.PendingRequestsId:return u.p.teampendingrequests;case Sb.TagsId:return u.p.teammanagetags;default:return u.p.teammanage}},Eb=e=>{switch(e){case Sb.AnalyticsId:return u.p.channelanalytics;case Sb.SettingsId:return u.p.channelsettings;case Sb.SharedChannelPendingRequestsId:return u.p.channelinvitations;case Sb.MembersId:return u.p.channelmembers;case Sb.TagsId:return u.p.channeltags;default:return u.p.channelmanage}},Nb=e=>{var t,n;return Promise.resolve({entityCommand:{entity:{type:u.p.sharedchannelspendinginvites,action:u.u.view},command:{stateTransition:null!==(t=null==e?void 0:e.stateTransition)&&void 0!==t?t:d.su.flush,visibilityState:null!==(n=null==e?void 0:e.visibilityState)&&void 0!==n?n:d.fe.show}},metadata:{allowAnonymous:!1}})},Ab=[{filter:hb.teamDashboard,execute:Cb},{filter:hb.channelDashboard,execute:Cb},{filter:hb.pendingInvites,execute:Cb},{filter:hb.channel,execute:wb},{filter:hb.replyChain,execute:wb},{filter:hb.team,execute:wb},{filter:(e,t)=>{var n;return!!e.hash&&"channel"===(null===(n=null==t?void 0:t.search)||void 0===n?void 0:n.ctx)},execute:wb}],Fb={shouldAddEntitiesToWindowHistory:()=>!0,shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:e=>{if((null==e?void 0:e.type)===u.p.schoolteams)return!0;if((null==e?void 0:e.type)===u.p.discoversurface)return!0;if((null==e?void 0:e.type)!==u.p.channels)return!1;const{replyChainId:t}=(0,Pl.jd)((null==e?void 0:e.id)||"");return!t}},Db={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsChannelByIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"owningTeam"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isUserMember"}}]}}]}}]}}]},Rb=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{entityCommand:n,entityCommand:{entity:i,entityOptions:a},requestContext:{client:o,coreSettings:r,loggerFactory:s}}=e,{enableTeamJoinDialog:l}=r.get(L.J.TeamsAndChannels),c=s.newLogger("TeamsAndChannels CallingOnBeforeCommandHandled","apps-teams-and-channels");if(l&&n.command.correlation.source===kt.D.InternalDeeplink){const{channelId:e,replyChainId:r}=JSON.parse((null==i?void 0:i.id)||"{}"),s=a,l=null==s?void 0:s.groupId,m=Ob(null===(t=null==n?void 0:n.metadata)||void 0===t?void 0:t.deepLink);if(e)try{const{data:t,error:i}=yield o.query({query:Db,fetchPolicy:"network-only",nextFetchPolicy:"cache-first",variables:{conversationId:e}});if(i)return Mb(c,e),Promise.resolve(xb(n,l,e,r));if(t&&!t.channelByID.owningTeam.isUserMember)return Promise.resolve(Object.assign(Object.assign({},n),{entity:{type:u.p.teamjoindialog,action:u.u.view},command:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:n.command.correlation},entityOptions:{groupId:l,channelId:e,linkType:m,messageId:r||null}}))}catch(t){return Mb(c,e),Promise.resolve(xb(n,l,e,r,m))}}return Promise.resolve(n)})),xb=(e,t,n,i,a)=>Object.assign(Object.assign({},e),{entity:{type:u.p.teamjoindialog,action:u.u.view},command:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:e.command.correlation},entityOptions:{groupId:t,channelId:n,messageId:i,linkType:a,isError:!0}}),Mb=(e,t)=>{(null==e?void 0:e.errorToTelemetry)&&e.errorToTelemetry(`Error getting channel join information for ${t}`,"teams_and_channels_on_before_command_handled_error",void 0,!0)},Ob=e=>{const t=null==e?void 0:e.match(/\/(team|channel|message)\//i);return t&&t.length>1?t[1]:null};class Pb{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}default(e){return this.commandHandler({entity:{type:u.p.channels,action:u.u.default},command:e})}channelDeeplinkWithMessageId(e,t,n){return this.commandHandler({entity:{type:u.p.channels,action:u.u.view,id:e},command:t,entityOptions:n})}channelMessagesById(e,t,n,i,a,o){const r={channelId:e,replyChainId:t};return this.commandHandler({entity:{type:u.p.channels,action:u.u.view,id:JSON.stringify(r)},command:i,entityOptions:Object.assign(Object.assign({},a),{deepLinkId:n,source:null==i?void 0:i.correlation.source}),scenarioEventData:null==o?void 0:o.scenarioEventData})}toggleChannelInfoPane(e,t){const{channelId:n}=Lb(e),i=JSON.stringify({channelId:n});return this.commandHandler({entity:{type:u.p.channels,action:u.u.info,id:i},command:t})}toggleChannelInfoPaneExpandedView(e,t,n){const{channelId:i,replyChainId:a}=Lb(e),o=JSON.stringify({channelId:i,replyChainId:a});return this.commandHandler({entity:{type:n,action:u.u.info,id:o,linkedEntity:{id:e,type:u.p.channels}},command:t})}showDefaultNavigationDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.defaultchannelnavdialog,action:u.u.view},{entityCommand:t,entityOptions:e})}showJoinTeamDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.teamjoindialog,action:u.u.view},{entityCommand:t,entityOptions:e})}launchCrossPostChannelSelectionDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.crosspostchannelselectiondialog,action:u.u.view},{entityCommand:this.getDefaultEntityCommand(t,d.su.extend),entityOptions:{selectedChannelIds:e}})}launchCrossPostChannelSelectionDialogV2(e,t,n){return this.extensionCommanding.executeCommand({type:u.p.crosspostchannelselectiondialogV2,action:u.u.view},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:n}},entityOptions:{selectedChannelIds:e,currentChannelId:t}})}launchCrossPostDeleteDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.crosspostdeletedialog,action:u.u.view},{entityCommand:this.getDefaultEntityCommand(t,d.su.extend),entityOptions:e})}getDefaultEntityCommand(e,t=d.su.flush){return{stateTransition:t,visibilityState:d.fe.show,correlation:{source:e}}}}const Lb=e=>{if(!e)return{teamId:void 0,channelId:void 0,replyChainId:void 0};try{const{teamId:t,channelId:n,replyChainId:i}=JSON.parse(e);return{teamId:t,channelId:n,replyChainId:i}}catch(t){return{channelId:e}}},Ub=({coreSettings:e,userPreferences:t})=>{var n,i,a,o,r;if(null===(n=null==e?void 0:e.get(L.J.Edu))||void 0===n?void 0:n.enableDogfoodingInEduGridLayout)return!0;if(!(null===(i=null==e?void 0:e.get(L.J.TeamsAndChannels))||void 0===i?void 0:i.enableTeamLayoutSetting)&&!(null===(a=null==e?void 0:e.get(L.J.TeamsAndChannels))||void 0===a?void 0:a.enableTeamLayoutSettingOverride))return!1;switch(null===(o=null==t?void 0:t.teamLayout)||void 0===o?void 0:o.currentLayout){case C.$lW.grid:return!0;case C.$lW.list:return!1;default:return null===(r=null==e?void 0:e.get(L.J.TeamsAndChannels))||void 0===r?void 0:r.defaultTeamLayoutSettingIsGrid}},jb=e=>{if($b(e))return Bb(e)?{subNavEntity:Hb(e),headerEntity:Jb(e),startEntity:Qb(e),mainEntity:Kb(e),endEntity:Yb(e)}:null},$b=({layoutMode:e,contextEntity:t,entity:n})=>{const{action:i=null,type:a}=Object.assign({},n),{type:o,action:r}=t||{},s=[d.lO.standard,d.lO.focus].includes(e),l=[u.p.acceptsharedchannelinvitationdialog,u.p.archiveteam,u.p.callablechannels,u.p.channelanalytics,u.p.channelcalendar,u.p.channelconnectors,u.p.channelemailerror,u.p.channelemailv2,u.p.channelmanage,u.p.channelmembers,u.p.channels,u.p.channelsPinnedPost,u.p.channelsSystemMessage,u.p.channelsettings,u.p.channelinvitations,u.p.channeltags,u.p.channelcontextualsearch,u.p.createchanneldialog,u.p.crosspostchannelselectiondialog,u.p.crosspostchannelselectiondialogV2,u.p.deleteteam,u.p.filesoneupviewer,u.p.removechannelemail,u.p.restoreteam,u.p.schoolteams,u.p.sharedchanneldenyinvitation,u.p.sharewithteamyouowndialog,u.p.sharedchannelcreateinvitationsdialog,u.p.sharedchannelspendinginvites,u.p.showformemberdialogv2,u.p.staleteamsdialog,u.p.staleteamsdismiss,u.p.leaveteam,u.p.crossteamanalytics,u.p.teamslist,u.p.teamanalytics,u.p.teamchannels,u.p.teamjoindialog,u.p.teamdiscover,u.p.teammanage,u.p.teammanageapps,u.p.teammanagetags,u.p.teampendingrequests,u.p.teams,u.p.teamserrordialog,u.p.teamsettings,u.p.wiki].includes(a),c=i&&[u.u.create,u.u.default,u.u.info,u.u.list,u.u.view].includes(i),m=o&&[u.p.extensions,u.p.guardians,u.p.channelcalendar,u.p.callablechannels,u.p.filesoneupviewer,u.p.wiki].includes(o),g=r&&[u.u.view,u.u.list].includes(r);return!(!s||!l||!c&&!(g&&m))},Bb=()=>!0,Wb=e=>({action:u.u.list,type:u.p.schoolteams,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:e.options,windowOptions:null}),Hb=({layoutMode:e,entity:t,coreSettings:n,userPreferences:i,contextEntity:a})=>{var o,r,s,l,c;if(e===d.lO.focus)return null;if(t.type===u.p.teams&&t.action===u.u.create)return t;if(t.type===u.p.schoolteams&&(t.action===u.u.list||t.action===u.u.join))return null;if(!(null===(o=null==n?void 0:n.get(L.J.Host))||void 0===o?void 0:o.msgEnableChannelsV2))return null;const m=Vb(t,a);if(Ub({coreSettings:n,userPreferences:i})||(null===(r=null==n?void 0:n.get(L.J.Host))||void 0===r?void 0:r.isGridNavigationLayoutActive)){if(t.action===u.u.default)return null;const e=null!==(l=null!==(s=Gb(a))&&void 0!==s?s:Gb(t))&&void 0!==l?l:m,n=null!==(c=qb(a))&&void 0!==c?c:qb(t),i=n&&n!==e?(0,wi.u4)({teamId:n,channelId:e}):e;return{action:u.u.view,type:u.p.schoolteams,entityState:{flushableByLinkedEntity:!0},id:i,linkedEntity:null,options:t.options,windowOptions:null}}return{action:u.u.list,entityState:{flushableByLinkedEntity:!0},id:m,linkedEntity:null,options:t.options,type:u.p.channels,windowOptions:null}},Vb=(e,t)=>{if(t&&t.action===u.u.view)switch(t.type){case u.p.channelmanage:case u.p.teammanage:case u.p.teammanagetags:case u.p.teammanageapps:case u.p.teamsettings:case u.p.teamanalytics:case u.p.teampendingrequests:case u.p.teamchannels:case u.p.channelmembers:case u.p.channelsettings:case u.p.channelanalytics:case u.p.channeltags:case u.p.teamslist:case u.p.crossteamanalytics:case u.p.sharedchannelspendinginvites:return e.id}const n=e.type===u.p.channels&&e.action===u.u.view?e.id:null;if(!n)return null;const{channelId:i}=(0,Pl.jd)(n);return i},zb=[u.p.teamanalytics,u.p.teammanage,u.p.teammanagetags,u.p.teammanageapps,u.p.teampendingrequests,u.p.teamsettings,u.p.teamchannels],qb=e=>{if(!e)return;if(zb.includes(e.type))return e.id;if(e.hasOwnProperty("options")&&null!==e.options){return JSON.parse(e.options).parentTeamId}},Gb=e=>{if(e&&e.id)try{const{channelId:t}=(0,Pl.jd)(e.id);return t}catch(e){return}},Jb=({contextEntity:e,entity:t,coreSettings:n,userPreferences:i})=>{if(e&&e.action===u.u.view)switch(e.type){case u.p.channelmanage:case u.p.teammanage:case u.p.teammanagetags:case u.p.teammanageapps:case u.p.teamsettings:case u.p.teamanalytics:case u.p.teampendingrequests:case u.p.teamchannels:case u.p.channelmembers:case u.p.channelsettings:case u.p.channelanalytics:case u.p.channeltags:case u.p.teamslist:case u.p.crossteamanalytics:case u.p.sharedchannelspendinginvites:return e}return e&&t.type===u.p.schoolteams?e.type&&[u.p.guardians].includes(e.type)?Object.assign(Object.assign({},e),{action:u.u.view,type:u.p.extensions}):e:t.type===u.p.channels&&t.action===u.u.default&&Ub({coreSettings:n,userPreferences:i})?Wb(t):t},Qb=()=>null,Kb=({contextEntity:e,entity:t,coreSettings:n,userPreferences:i})=>{var a;return(null==e?void 0:e.type)&&[u.p.archiveteam,u.p.deleteteam,u.p.leaveteam,u.p.restoreteam,u.p.extensions,u.p.guardians,u.p.callablechannels,u.p.channelcalendar,u.p.channelconnectors,u.p.filesoneupviewer,u.p.wiki,u.p.teammanage,u.p.teammanagetags,u.p.teammanageapps,u.p.teamsettings,u.p.teamanalytics,u.p.teampendingrequests,u.p.teamchannels,u.p.channelemailv2,u.p.sharewithteamyouowndialog,u.p.channelmembers,u.p.channelmanage,u.p.channelsettings,u.p.channeltags,u.p.channelanalytics,u.p.removechannelemail,u.p.teamslist,u.p.teamserrordialog,u.p.crossteamanalytics,u.p.sharedchannelspendinginvites].includes(e.type)?e:t.type===u.p.channels&&t.action===u.u.view?(null===(a=null==n?void 0:n.get(L.J.Host))||void 0===a?void 0:a.msgEnableChannelsV2)?t:null:t.type===u.p.channels&&t.action===u.u.default&&Ub({coreSettings:n,userPreferences:i})?Wb(t):t},Yb=({entity:e,contextEntity:t,coreSettings:n,layoutMode:i,userPreferences:a})=>{var o,r,s,l;const c=(null==t?void 0:t.id)||e.id,m=JSON.parse(null!==(o=e.options)&&void 0!==o?o:"{}"),g=(null===(r=null==a?void 0:a.infoPane)||void 0===r?void 0:r.channels)?a.infoPane.channels===C.MwA.closed:!!(null===(s=null==n?void 0:n.get(L.J.Channels))||void 0===s?void 0:s.disableChannelInfoPaneOpenByDefault);if(!((e,t,n,i,a,o,r)=>{var s,l;const{enableChannelInfoPaneSearch:c,enableChannelInfoPane:m=!1}=null!==(s=null==i?void 0:i.get(L.J.Channels))&&void 0!==s?s:{},{enableInfoPaneAsResponsiveMenu:g=!1}=null!==(l=null==i?void 0:i.get(L.J.Core))&&void 0!==l?l:{};return!(!e||a!==d.lO.standard||t!==u.p.channels||(!c||r!==kt.D.ChannelContextualSearch&&(null==n?void 0:n.type)!==u.p.channelcontextualsearch)&&(o||!m||!g))})(c,e.type,t,n,i,g,m.source))return null;const{enableChannelInfoPaneSearch:p}=null!==(l=null==n?void 0:n.get(L.J.Channels))&&void 0!==l?l:{};if(m.source===kt.D.ChannelContextualSearch)return{id:c,action:u.u.info,type:u.p.channelcontextualsearch};const{replyChainId:v}=(e=>{if(!e)return{replyChainId:void 0};try{const{replyChainId:t}=JSON.parse(e);return{replyChainId:t}}catch(e){return{replyChainId:void 0}}})(null!=c?c:"");if(v&&(!p||(null==t?void 0:t.type)!==u.p.channelcontextualsearch))return null;if(t){const{action:e,type:n}=t;if(e===u.u.info&&Xb(n,!!p))return t;if(n!==u.p.channels)return null}const{channelId:h}=(0,Pl.jd)(null!=c?c:"");return{id:(0,wi.u4)({channelId:h}),action:u.u.info,type:u.p.channels}},Xb=(e,t)=>{switch(e){case u.p.channelsPinnedPost:case u.p.channelsSystemMessage:return!0;case u.p.channelcontextualsearch:return t;default:return!1}},Zb=({areEmptySlotsTransparent:e,coreSettings:t})=>({[C.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!!(null==t?void 0:t.get(L.J.Channels).enableMicaBackgroundForChannelPane)||e}},[C.tF7.headerEntity]:{[s.S.HorizontalBar]:{isBackgroundTransparent:!!(null==t?void 0:t.get(L.J.Channels).enableMicaBackgroundForChannelPane)||e}},[C.tF7.subNavEntity]:{[s.S.Rail]:{areSlotShadowsDisabled:!1,isBackgroundTransparent:!!(null==t?void 0:t.get(L.J.Core).enableTransparentLeftRail)||e}}}),eS=(e,t,n)=>{const{userPreferences:i,coreSettings:a,layoutMode:o}=t;if(!n)return;const r=n.mainEntity;if(r&&"options"in r&&r.options&&r.id)try{const e=JSON.parse(r.options),{channelId:t,replyChainId:n}=(0,Pl.jd)(r.id);if(e&&n&&t&&e.source===kt.D.ChannelPostMessage)return jb({contextEntity:null,coreSettings:a,entity:{id:t,type:u.p.channels,action:u.u.view,options:JSON.stringify({deepLinkId:n,source:kt.D.ChannelL2NavigateViaHistory})},layoutMode:o,userPreferences:i})}catch(e){return}},tS=[u.p.teammanage,u.p.teamchannels,u.p.teampendingrequests,u.p.teammanagetags],nS=[u.p.channelmanage,u.p.channelmembers,u.p.channelinvitations],iS=[u.p.sharedchannelspendinginvites],aS=({action:e,appRenderMode:t,coreSettings:n,type:i,logger:a})=>{const o=new ht.H,{enableComposeCriticalPhaseLoad:r=!1,enableComposeCriticalPhaseLoadForPopout:l=!1,enableComposeCriticalPhaseLoadSecondaryViewport:c=!1,enableComposeCriticalPhaseLoadSecondaryViewportGate:d=!1}=n.get(L.J.Messaging),{enableHybridChannelList:u=!1,msgEnableChannelsV2:m=!1,msgEnableChannelsV2Header:g=!1}=n.get(L.J.Host),{channelPhaseTimeoutSettings:p}=n.get(L.J.TeamsAndChannels),v=[],h=[];switch(t){case s.S.HorizontalBar:oS({action:e,type:i,logger:a,criticalSignals:v,featureFlags:{msgEnableChannelsV2Header:g,msgEnableChannelsV2:m},postCriticalSignals:h});break;case s.S.Main:rS({action:e,type:i,logger:a,criticalSignals:v,featureFlags:{enableComposeCriticalPhaseLoad:r,enableComposeCriticalPhaseLoadForPopout:l,enableComposeCriticalPhaseLoadSecondaryViewport:c,enableComposeCriticalPhaseLoadSecondaryViewportGate:d,msgEnableChannelsV2:m},postCriticalSignals:h});break;case s.S.Rail:sS({action:e,criticalSignals:v,featureFlags:{enableHybridChannelList:u},postCriticalSignals:h,type:i})}return o.registerAppPhase({phase:ft.nh.CRITICAL,signals:v,timeout:(null==p?void 0:p.critical)||25e3}),o.registerAppPhase({phase:ft.nh.POST_CRITICAL,signals:h,timeout:(null==p?void 0:p.postCritical)||1e4}),o.appPhases},oS=({action:e,criticalSignals:t,featureFlags:{msgEnableChannelsV2Header:n,msgEnableChannelsV2:i},type:a,logger:o})=>{a===u.p.schoolteams&&e===u.u.list?t.push(ft.GZ.TEAMS_GRID_VIEW_HEADER_RENDERED):i&&n&&a===u.p.channels&&(e===u.u.default||e===u.u.view)?t.push(ft.GZ.CHANNEL_HEADER_RENDERED):a&&tS.includes(a)?t.push(ft.GZ.TEAM_DASHBOARD_HEADER_RENDERED):a&&nS.includes(a)?t.push(ft.GZ.CHANNEL_DASHBOARD_HEADER_RENDERED):a&&iS.includes(a)?t.push(ft.GZ.TEAMS_DASHBOARD_HEADER_RENDERED):null==o||o.log(`Not adding header slot phase signals for action: ${e}, type: ${a}, msgEnableChannelsV2: ${i}, msgEnableChannelsV2Header: ${n}`)},rS=({action:e,criticalSignals:t,featureFlags:{enableComposeCriticalPhaseLoad:n,enableComposeCriticalPhaseLoadForPopout:i,enableComposeCriticalPhaseLoadSecondaryViewport:a,enableComposeCriticalPhaseLoadSecondaryViewportGate:o,msgEnableChannelsV2:r},postCriticalSignals:s,type:l,logger:c})=>{if(l===u.p.schoolteams&&e===u.u.list)t.push(ft.GZ.TEAMS_GRID_VIEW_RENDERED);else if(!r||l!==u.p.channels||e!==u.u.default&&e!==u.u.view)l&&tS.includes(l)?t.push(ft.GZ.TEAM_DASHBOARD_VIEW_RENDERED):l&&nS.includes(l)?t.push(ft.GZ.CHANNEL_DASHBOARD_VIEW_RENDERED):l&&iS.includes(l)?t.push(ft.GZ.TEAMS_DASHBOARD_VIEW_RENDERED):null==c||c.log(`Not adding main slot phase signals for action: ${e}, type: ${l}, msgEnableChannelsV2: ${r}`);else{t.push(ft.GZ.MESSAGES_RENDERED);const e=i&&o&&a;n||e?t.push(ft.GZ.COMPOSE_LOADED):s.push(ft.GZ.COMPOSE_LOADED),s.push(ft.GZ.MESSAGE_REACTIONS_RENDERED,ft.GZ.PRESENCES_RENDERED,ft.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED)}},sS=({action:e,criticalSignals:t,featureFlags:{enableHybridChannelList:n},type:i})=>{i===u.p.channels&&e===u.u.list?n&&t.push(ft.GZ.CHANNEL_LIST_ITEMS_RENDERED):i===u.p.schoolteams&&e===u.u.view&&t.push(ft.GZ.SINGLE_TEAM_VIEW_LEFT_RAIL_LOADED)};var lS=n(60097);const cS={id:lS.Hm,name:"TeamsAndChannelsApp",getLocalizedName:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("teamsAndChannels"),e.stringTranslate("teamsAndChannels","teams_and_channels_app_name")})),actors:[Hh],supportedEntities:[u.p.acceptsharedchannelinvitationdialog,u.p.addmembertoprivatechanneldialog,u.p.addmembertoteamdialog,u.p.archiveteam,u.p.channelanalytics,u.p.channelconnectors,u.p.channelemailerror,u.p.channelemailv2,u.p.channelmanage,u.p.channelmembers,u.p.channels,u.p.channelsPinnedPost,u.p.channelsSystemMessage,u.p.channelcontextualsearch,u.p.channelsettings,u.p.channelinvitations,u.p.channeltags,u.p.createchanneldialog,u.p.crosspostchannelselectiondialog,u.p.crosspostchannelselectiondialogV2,u.p.crosspostdeletedialog,u.p.defaultchannelnavdialog,u.p.deletechannelreactdialog,u.p.deleteteam,u.p.leaveteam,u.p.restoreteam,u.p.leavechanneldialog,u.p.leavechannellastownerdialog,u.p.pinunpinpost,u.p.getlinktoteamorchanneldialog,u.p.removechannelemail,u.p.restorechannelreactdialog,u.p.schoolteams,u.p.sharedchanneldenyinvitation,u.p.sharewithteamyouowndialog,u.p.sharedchannelcreateinvitationsdialog,u.p.sharedchannelspendinginvites,u.p.sharechannelwithuserdialog,u.p.showformemberdialogv2,u.p.stopsharingchannelwithteamreactdialog,u.p.showchannelowners,u.p.crossteamanalytics,u.p.teamchannels,u.p.teamdiscover,u.p.teamjoindialog,u.p.teammanage,u.p.teammanageapps,u.p.teammanagetags,u.p.teampendingrequests,u.p.teams,u.p.teamserrordialog,u.p.teamsettings,u.p.teamanalytics,u.p.teamslist,u.p.channelnotificationsettings,u.p.staleteamsdialog,u.p.staleteamsdismiss],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail,s.S.Modal],getDefaultCommand:e=>{const{enableHybridChannelList:t,msgEnableChannelsV2:n}=e.get(L.J.Host);if(t&&n)return{type:u.p.channels,action:u.u.default}},windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20,widthToScreenWidthRatio:.3,heightToWidthRatio:1.125}},dS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"}},{kind:"Field",name:{kind:"Name",value:"channelName"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"discardDuringMeetingsAndCalls"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"reaction"}},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderGivenName"}},{kind:"Field",name:{kind:"Name",value:"senderMri"}},{kind:"Field",name:{kind:"Name",value:"subtype"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}}]}}]}}]};var uS,mS;!function(e){e.Follow="Follow",e.Mention="Mention",e.Reaction="Reaction",e.Reply="Reply",e.ReplyToReply="ReplyToReply",e.TeamMembershipChange="TeamMembershipChange",e.DLP="DLP"}(uS||(uS={})),function(e){e.Person="Person",e.Team="Team",e.AddedToSharedChannel="AddedToSharedChannel",e.TeamShareTeamOwnerNotify="TeamShareTeamOwnerNotify",e.PromotedToSharedChannelOwner="PromotedToSharedChannelOwner",e.ChannelOwnerUnshareTeamOwnerNotify="ChannelOwnerUnshareTeamOwnerNotify",e.TeamOwnerUnshareChannelOwnerNotify="TeamOwnerUnshareChannelOwnerNotify",e.NotifySender="NotifySender"}(mS||(mS={}));const gS="new_channel_post_toast_header",pS="channel_reaction_toast_header",vS="channel_reply_toast_header",hS="channel_reply_to_reply_toast_header",fS="channel_mention_team_toast_header",yS="channel_mention_person_toast_header",bS="shared_channel_shared_with_a_user_header",SS="shared_channel_sharing_stopped_by_owner_header",kS="shared_channel_shared_with_a_team_header",wS="shared_channel_sharing_stopped_by_team_owner_header",CS="shared_channel_role_promotion_header",_S="dlp_notify_sender_header",TS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsMsaUserProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},IS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsToastImageAsDataUriQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};function ES(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const o=yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{data:i}=yield e.query({query:TS,variables:{userId:t,displayName:n,profilePictureSize:Sc.$D.Small}});return i.msaUserProfilePicture}))}(e,n,a);if(!o)return void t.error(li.f.ImageUrlGenerationFailed);const r=yield e.query({query:IS,variables:{url:o}});return(null==r?void 0:r.data.toastImageAsDataUri)||void 0}catch(e){return void t.error(li.f.ImageFetchFailed)}}))}const NS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchEmoticons"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchFilter"},value:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}}},{kind:"Argument",name:{kind:"Name",value:"exactMatch"},value:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}}},{kind:"Argument",name:{kind:"Name",value:"includeShortCuts"},value:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}}},{kind:"Argument",name:{kind:"Name",value:"includeKeywords"},value:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}}},{kind:"Argument",name:{kind:"Name",value:"maxResultCount"},value:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}}},{kind:"Argument",name:{kind:"Name",value:"categoryId"},value:{kind:"Variable",name:{kind:"Name",value:"categoryId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"unicode"}},{kind:"Field",name:{kind:"Name",value:"animation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment_animation"}}]}},{kind:"Field",name:{kind:"Name",value:"etag"}},{kind:"Field",name:{kind:"Name",value:"diverse"}},{kind:"Field",name:{kind:"Name",value:"shortcuts"}},{kind:"Field",name:{kind:"Name",value:"searchMatch"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment_animation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fps"}},{kind:"Field",name:{kind:"Name",value:"framesCount"}},{kind:"Field",name:{kind:"Name",value:"firstFrame"}}]}}]}.definitions]}.definitions]};function AS({reaction:e,channelName:t,teamName:n,type:a,subtype:o,senderDisplayName:r,senderGivenName:s},l,c,d){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const u=r||s;if(!u&&a!==uS.DLP)return"";if(a===uS.Mention&&!o)return"";if(a===uS.Reaction&&!e)return"";const m={channelName:t,senderDisplayName:u,teamName:n};switch(a){case uS.Follow:return FS(gS,m,l);case uS.Reply:return FS(vS,m,l);case uS.ReplyToReply:return FS(hS,m,l);case uS.Mention:return o===mS.Person?FS(yS,m,l):FS(fS,m,l);case uS.Reaction:const t=yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const{id:t}=(0,Br.M)(null==n?void 0:n.toLocaleLowerCase().trim());if(!t)return;const{data:i}=yield e.query({query:NS,variables:{searchFilter:t,exactMatch:!0}});return((null==i?void 0:i.searchEmoticons)||[])[0]}catch(e){return void t.error(li.f.ChannelToastEmoticonsQueryFailed)}}))}(c,d,e),n=(null==t?void 0:t.unicode)||void 0;return FS(pS,Object.assign(Object.assign({},m),{emoji:n}),l);case uS.TeamMembershipChange:return function(e,t,n){switch(e){case mS.AddedToSharedChannel:return FS(bS,t,n);case mS.ChannelOwnerUnshareTeamOwnerNotify:return FS(SS,t,n);case mS.PromotedToSharedChannelOwner:return FS(CS,t,n);case mS.TeamOwnerUnshareChannelOwnerNotify:return FS(wS,t,n);case mS.TeamShareTeamOwnerNotify:return FS(kS,t,n);default:return""}}(o,m,l);case uS.DLP:return FS(_S,m,l);default:return""}}))}function FS(e,{emoji:t,channelName:n,teamName:i,senderDisplayName:a},o){return o.stringTranslate("toastNotifications",e,{channelName:n,emoji:t,senderDisplayName:a,teamName:i})}function DS(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{conversationId:i,messageId:o,startTimestamp:r,replyChainId:s,teamName:l,channelName:c,senderMri:d,senderDisplayName:u}=e,m=e.type===uS.DLP?$r.Uw:yield ES(n,a,d,u||""),g=yield AS(e,t,n,a),p=function(e,t,n,i){switch(e.subtype){case mS.ChannelOwnerUnshareTeamOwnerNotify:return i.stringTranslate("toastNotifications","shared_channel_owner_unshare_team_owner_notify_text",{teamName:t});case mS.TeamOwnerUnshareChannelOwnerNotify:return i.stringTranslate("toastNotifications","shared_channel_team_owner_unshare_channel_owner_notify_text",{channelName:n});case mS.NotifySender:return i.stringTranslate("toastNotifications","dlp_notification_notify_sender_text",{teamName:t,channelName:n});default:return i.stringTranslate("toastNotifications","channel_toasts_text",{teamName:t,channelName:n})}}(e,l,c,t);return{conversationId:i,quickReply:!1,discardDuringMeetingsAndCalls:!!e.discardDuringMeetingsAndCalls,messageId:o,time:new Date(+r),replyChainId:s||"",text:p,title:g,mainImage:m?{alt:"",src:m}:void 0}}))}function RS(e,t){const n=e.newScenario(it.RG.CrossClientToastView);n.appendEventData({mainEntityType:u.p.channels}),n.fail(t)}function xS(e,t,n,a,o,r,s,l){const{enableCommandToHostCommService:c}=t.get(L.J.Core),{enableChannelsNotifications:d}=t.get(L.J.Notifications);return{id:"channel-toast-event-subscription",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const m=a.newLogger("ChannelToastEventSubscription","apps-teams-and-channels");c?d?(m.log(`${li.f.Subscribing}: subscribing to channel toasts resolver`),n.subscribe({query:dS,fetchPolicy:"no-cache"}).subscribe(function(e,t,n,a,o,r,s,l){const{enableToastCollections:c}=t.get(L.J.Notifications);return t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,d;if(t.errors){const e=(0,wi.u4)(t.errors.map((e=>e.message)).join());return n.error(`${li.f.SubscriptionFailed} ${e}`),void RS(a,{errorCode:li.f.SubscriptionFailed,errors:e})}const m=null===(i=t.data)||void 0===i?void 0:i.channelToastEvent;if(!m)return n.error(li.f.EmptyEvent),void RS(a,{errorCode:li.f.EmptyEvent});const g=a.newScenario(it.RG.CrossClientToastView,{startTime:+m.startTimestamp});g.clientId=m.correlationId,g.appendEventData({mainEntityType:u.p.channels,mainEntitySubtype:m.type});const p=yield DS(m,o,s,n);if(!p.title)return n.error(`${li.f.UnhandledType}: Dropping channel toast with type ${m.type}`),void g.incomplete({reason:li.f.UnhandledType});c&&(p.collectionId=ui(e,l,n)),null===(d=a.hoistScenarioToCore)||void 0===d||d.call(a,g),r.toasts.showChannelsNotification(m.correlationId,p),g.mark(it.ck.CrossClientEntityCommandTriggered),n.log(`${li.f.ToastCommandSent} type:${m.type} correlationId:${m.correlationId}`)}))}(e,t,m,o,r,s,n,l))):m.log(`${li.f.NotEnabled}: channel notifications are off`):m.log(li.f.NotEnabled)}))}}const MS=({context:{authenticationUser:e,client:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,i18n:o,entityCommanding:r,userTrackingService:s}})=>[xS(e,n,t,i,a,o,r,s)],OS=({commandInput:e,requestContext:{clientPreferences:t,coreSettings:n,executionContext:a,loggerFactory:o}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:i}}=e,r=o.newLogger("TeamsAndChannelsApp onCommandReceived","apps-teams-and-channels");if(e.command.actor===Hh)switch(i){case Vh:return a.isHandlingAppActiveApp&&Ub({coreSettings:n,userPreferences:t})?{entity:{type:u.p.schoolteams,action:u.u.list},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.SchoolTeams}}}:{entity:{type:u.p.channels,action:u.u.default},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.Unknown}}};default:r.error(`Command action '${i}' is not supported at TeamsAndChannelsApp.`)}else r.error(`Command for actor '${e.command.actor}' cannot be handled by TeamsAndChannelsApp.`)})),PS=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(907784),n.e(168904),n.e(687601),n.e(553211),n.e(511402),n.e(860024),n.e(34693),n.e(674881),n.e(533157),n.e(179826),n.e(92285),n.e(158057),n.e(509379),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(604068),n.e(921132),n.e(264630),n.e(757839),n.e(532640),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(398949),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(279439),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(787970),n.e(842905),n.e(975421),n.e(248361),n.e(675049),n.e(327119),n.e(262855),n.e(354066),n.e(838267),n.e(369687),n.e(64113),n.e(302755),n.e(119751),n.e(589835),n.e(181790),n.e(972813),n.e(757052),n.e(459737),n.e(245526),n.e(693514),n.e(107052),n.e(335085),n.e(214475),n.e(255937),n.e(419347),n.e(275240),n.e(386511),n.e(810439),n.e(531521),n.e(462030)]).then(n.bind(n,663816)),LS=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(907784),n.e(168904),n.e(687601),n.e(553211),n.e(511402),n.e(860024),n.e(34693),n.e(674881),n.e(533157),n.e(179826),n.e(92285),n.e(158057),n.e(509379),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(604068),n.e(921132),n.e(264630),n.e(757839),n.e(532640),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(708204),n.e(885212),n.e(443905),n.e(775729),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(953808),n.e(152269),n.e(398949),n.e(597003),n.e(797371),n.e(437184),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(279439),n.e(393926),n.e(302092),n.e(696652),n.e(645508),n.e(317689),n.e(908915),n.e(981674),n.e(142483),n.e(815768),n.e(644027),n.e(787970),n.e(842905),n.e(975421),n.e(248361),n.e(675049),n.e(327119),n.e(262855),n.e(354066),n.e(838267),n.e(369687),n.e(64113),n.e(302755),n.e(119751),n.e(589835),n.e(181790),n.e(972813),n.e(757052),n.e(459737),n.e(245526),n.e(693514),n.e(107052),n.e(335085),n.e(214475),n.e(255937),n.e(419347),n.e(275240),n.e(386511),n.e(810439),n.e(531521),n.e(462030)]).then(n.bind(n,697633)),US=({coreServices:e,host:t,screenState:n,windowOptions:i})=>{const{height:a,minHeight:o,minWidth:r,offset:s,width:l}=cS.windowFeatures||{},c={left:(null==t?void 0:t.screenX)||0,top:(null==t?void 0:t.screenY)||0},d=((null==n?void 0:n.numOpenWindows)||1)*(s||1);return Object.assign(Object.assign(Object.assign({additionalFeatures:{minHeight:`${o}`,minWidth:`${r}`},height:a,left:(null==c?void 0:c.left)+d,minHeight:o,minWidth:r,top:(null==c?void 0:c.top)+d,width:l},cS.windowFeatures),(null==e?void 0:e.coreSettings.get(L.J.Core).enableRatioToScreenBasedSizing)&&function(e,t){const{widthToScreenWidthRatio:n,heightToWidthRatio:i}=t||{};if(!e||!i||!n)return{};const a=n*e.screen.availWidth;return{height:a*i,width:a}}(t,cS.windowFeatures)),i)};function jS(){return{eventHandlers:vb,getAppPhases:aS,getAppViewEntities:jb,getAppViewEntitiesProps:Zb,getAppWindowFeatures:US,getCommandScenarioName:(e,t)=>{const{entity:n,command:i}=e,a=i.stateTransition===d.su.flush||i.stateTransition===d.su.forceFlush||i.stateTransition===d.su.new;if(n.type===u.p.channels&&(n.action===u.u.view||n.action===u.u.default)&&i.visibilityState===d.fe.show&&a)if(n.id){const e=(0,Pl.jd)(n.id,t);if(e)return i.stateTransition===d.su.new?e.replyChainId?it.RG.ChannelSwitchL2Popout:void 0:e.replyChainId?it.RG.ChannelSwitchL2:it.RG.ChannelSwitchL1}else if(n.action===u.u.default)return it.RG.ChannelSwitchL1;return n.type===u.p.schoolteams&&n.action===u.u.list?it.RG.TeamsGridLoad:n.type===u.p.channelcontextualsearch&&n.action===u.u.info&&i.visibilityState!==d.fe.hide?it.RG.ContextualSearchStart:void 0},getPlatformAppIdForEntity:e=>e.type===u.p.channels||e.type===u.p.schoolteams?"2a84919f-59d8-4441-a975-2a8c2643b741":void 0,onBeforeAddToNavigation:Fb,onBeforeCommandHandled:Rb,onBeforeNavigationFromHistory:eS,manifest:cS,onBeforeDeeplinkParsed:Ab,render:({appRenderMode:e,coreSettings:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="teams-and-channels-app";n("ChunkLoadStarted",{chunkName:i});const{enableEntityMoreInfo:r}=t.get(L.J.Core),s=({children:e})=>o.createElement(o.Fragment,null,e),l=r?s:vn.p3,{TeamsAndChannelsViewsRenderer:d}=yield(0,c.mT)(PS,i,a),{LPC:u}=r?{LPC:s}:yield(0,c.mT)(LS,i,a);return n("ChunkLoadSucceeded",{chunkName:i}),o.createElement(u,null,o.createElement(l,null,o.createElement(Qc.l8,null,o.createElement(d,{appRenderMode:e,coreSettings:t}))))})),onCommandReceived:OS,onPreWarm:MS}}const $S={id:"com.microsoft.teams.store.notifications.app",name:"TeamsStoreNotificationsApp",supportedEntities:[u.p.lobnotifications,u.p.onboardingnotifications,u.p.discoverappsnotifications,u.p.autoinstallnotification],supportedRenderModes:[s.S.Main,s.S.Rail]},BS=e=>{if(WS(e))return HS(e)?{subNavEntity:VS(e),headerEntity:zS(e),startEntity:qS(e),mainEntity:GS(e),endEntity:JS(e)}:null},WS=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.lobnotifications,u.p.onboardingnotifications].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},HS=()=>!0,VS=({entity:e})=>e,zS=()=>null,qS=()=>null,GS=({entity:e})=>e,JS=()=>null,QS=()=>Promise.all([n.e(377194),n.e(704171)]).then(n.bind(n,597027)),KS=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(259196),n.e(86052),n.e(302711),n.e(636762),n.e(499057),n.e(603286),n.e(836870),n.e(213104),n.e(384420),n.e(49750),n.e(181896),n.e(95235),n.e(803466),n.e(623025),n.e(579814),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(61627),n.e(4528),n.e(191280),n.e(86048),n.e(29311),n.e(481321),n.e(384848),n.e(674818),n.e(397914),n.e(860125),n.e(628212),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(398949),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(645508),n.e(317689),n.e(842905),n.e(196673),n.e(648558),n.e(764175),n.e(968634),n.e(530658),n.e(926721),n.e(905697),n.e(707902),n.e(858141),n.e(568740)]).then(n.bind(n,547886));function YS(){const e=()=>null;return{getAppViewEntities:BS,manifest:$S,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="teamsStoreNotifications";n("ChunkLoadStarted",{chunkName:e});const[{NotificationsEntry:t},{CallsTabContextProvider:i}]=yield Promise.all([(0,c.mT)(QS,e,a),(0,c.mT)(KS,e,a)]);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(i,null,o.createElement(t,null)))}return o.createElement(e,null)}))}}const XS=e=>{if(ZS(e))return ek(e)?{subNavEntity:tk(e),headerEntity:nk(e),startEntity:ik(e),mainEntity:ak(e),endEntity:ok(e)}:null},ZS=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.transcriptcontent].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},ek=()=>!0,tk=()=>null,nk=()=>null,ik=()=>null,ak=({entity:e})=>e,ok=()=>null,rk={id:"com.microsoft.teams.transcript-content",name:"TranscriptContentApp",supportedEntities:[u.p.transcriptcontent],supportedRenderModes:[s.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},sk="transcript-content-app",lk=()=>n.e(403275).then(n.bind(n,30568)),ck=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(259196),n.e(86052),n.e(302711),n.e(636762),n.e(499057),n.e(603286),n.e(836870),n.e(213104),n.e(384420),n.e(49750),n.e(181896),n.e(95235),n.e(803466),n.e(623025),n.e(579814),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(61627),n.e(4528),n.e(191280),n.e(86048),n.e(29311),n.e(481321),n.e(384848),n.e(674818),n.e(397914),n.e(860125),n.e(628212),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(398949),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(645508),n.e(317689),n.e(842905),n.e(196673),n.e(648558),n.e(764175),n.e(968634),n.e(530658),n.e(926721),n.e(905697),n.e(707902),n.e(858141),n.e(568740)]).then(n.bind(n,547886));function dk(){const e=()=>null;return{getAppViewEntities:XS,manifest:rk,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const[{TranscriptContentViews:e},{CallsTabContextProvider:t}]=yield Promise.all([(0,c.mT)(lk,sk,n),(0,c.mT)(ck,sk,n)]);return o.createElement(l.f,{namespace:"calling",loaderRenderer:null},o.createElement(t,null,o.createElement(e,null)))}return o.createElement(e,null)}))}}const uk={id:"com.microsoft.teams.virtual-events",name:"VirtualEventsApp",supportedEntities:[u.p.virtualevents],supportedRenderModes:[s.S.Main,s.S.Modal,s.S.HorizontalBar],windowFeatures:{minWidth:1241,width:1241,minHeight:720,height:720}},mk=e=>{if(gk(e))return pk(e)?{subNavEntity:vk(e),headerEntity:hk(e),startEntity:fk(e),mainEntity:yk(e),endEntity:bk(e)}:null},gk=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.virtualevents].includes(i),r=n&&[u.u.default,u.u.view,u.u.create,u.u.list].includes(n);return!!(a&&o&&r)},pk=()=>!0,vk=()=>null,hk=({entity:e})=>e,fk=()=>null,yk=({entity:e})=>e,bk=()=>null,Sk=()=>({[C.tF7.headerEntity]:{[s.S.HorizontalBar]:{slotHeightOverrides:"6.1rem"}}}),kk=({prevEntityType:e})=>e===u.p.virtualevents?null:uk.windowFeatures,wk=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(129408),n.e(899405),n.e(287783),n.e(838608),n.e(168904),n.e(522024),n.e(511402),n.e(274690),n.e(869519),n.e(779813),n.e(479574),n.e(769229),n.e(904248),n.e(623025),n.e(579814),n.e(401764),n.e(110350),n.e(709528),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(604068),n.e(346857),n.e(767546),n.e(981004),n.e(477486),n.e(931172),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(9886),n.e(491448),n.e(398949),n.e(393926),n.e(365130),n.e(163395),n.e(196673),n.e(817586),n.e(18648),n.e(586496),n.e(871552),n.e(905108)]).then(n.bind(n,318184));function Ck(){return{getAppViewEntities:mk,getAppViewEntitiesProps:Sk,getAppWindowFeatures:kk,manifest:uk,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="virtual-events-app";t("ChunkLoadStarted",{chunkName:i});const{VirtualEventsViewsRenderer:a}=yield(0,c.mT)(wk,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(l.f,{namespaces:["virtualEvents","webinar","messaging","meetingAnalytics","compose","calendar","extensibility"],loaderRenderer:null},o.createElement(a,{appRenderMode:e}))})),onRegister:e=>{e.registerTask(new Se)}}}const _k=e=>{if(Tk(e))return Ik(e)?{subNavEntity:Ek(e),headerEntity:Nk(e),startEntity:Ak(e),mainEntity:Fk(e),endEntity:Dk(e)}:null},Tk=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.registration].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},Ik=()=>!0,Ek=()=>null,Nk=()=>null,Ak=()=>null,Fk=({entity:e})=>e,Dk=()=>null,Rk={getDefaultCommand:()=>({type:u.p.registration,action:u.u.view}),id:"com.microsoft.teams.webinar-registration",name:"WebinarRegistrationApp",supportedRenderModes:[s.S.Main],supportedEntities:[u.p.registration],windowFeatures:{minWidth:1140,width:1140,minHeight:720,height:720}},xk=()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(899405),n.e(907784),n.e(838608),n.e(553211),n.e(714133),n.e(92700),n.e(479574),n.e(60441),n.e(623025),n.e(579814),n.e(709528),n.e(418676),n.e(101243),n.e(603612),n.e(604068),n.e(301920),n.e(346857),n.e(477486),n.e(991883),n.e(602460),n.e(902140),n.e(9886),n.e(491448),n.e(393926),n.e(365130),n.e(817586),n.e(871552),n.e(854937)]).then(n.bind(n,375337)),Mk=()=>Rk.windowFeatures||{};function Ok(){const e=()=>null;return{getAppViewEntities:_k,getAppWindowFeatures:Mk,manifest:Rk,render:({appRenderMode:t})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="webinar-registration-app",{WebinarRegistrationViewsRenderer:t}=yield(0,c.mT)(xk,e);return o.createElement(l.f,{namespaces:["compose","webinar"],loaderRenderer:null},o.createElement(t,null))}return o.createElement(e,null)}))}}const Pk={id:"com.microsoft.teamspace.tab.wiki",name:"WikiApp",supportedEntities:[u.p.wiki],supportedRenderModes:[s.S.Main]},Lk=e=>{if(Uk(e))return jk(e)?{subNavEntity:$k(e),headerEntity:Bk(e),startEntity:Wk(e),mainEntity:Hk(e),endEntity:Vk(e)}:null},Uk=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.wiki].includes(i),r=n&&[u.u.view].includes(n);return!!(a&&o&&r)},jk=()=>!0,$k=()=>null,Bk=()=>null,Wk=()=>null,Hk=({entity:e})=>e,Vk=()=>null,zk=()=>Promise.all([n.e(134315),n.e(775931)]).then(n.bind(n,365920)),qk=()=>Pk.windowFeatures||{};function Gk(){return{getAppViewEntities:Lk,getAppWindowFeatures:qk,getCommandScenarioName:Jk,manifest:Pk,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="wiki-app";t("ChunkLoadStarted",{chunkName:i});const{WikiViewsRenderer:a}=yield(0,c.mT)(zk,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(a,{appRenderMode:e})}))}}const Jk=()=>it.RG.WikiMigration,Qk={id:"com.microsoft.teams.entitymoreinfo",actors:["entitymoreinfo"],name:"EntityMoreInfoApp",supportedRenderModes:[s.S.Configurations]},Kk={gqlTypeName:"EntityMoreInfoAppViewState",queryFieldName:"entityMoreInfoAppViewState",navigationalFieldDefaultValues:{},nonNavigationalFieldDefaultValues:{readyToBootstrapLPC:!1},computedValues:void 0},Yk={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEntityMoreInfoUsersForConversationQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"PeoplePickerFiltersInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsersForConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriArray"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"isShortProfileRequested"},value:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"peoplePickerFilters"},value:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}}},{kind:"Argument",name:{kind:"Name",value:"isSharedChannel"},value:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}}},{kind:"Argument",name:{kind:"Name",value:"hostTenantId"},value:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"companyName"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"userType"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"xtapUser"}}]}}]}}]},Xk={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEntityMoreInfoLpcStateQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}}]}}]}}]},Zk={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEntityMoreInfoAuthenticationUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}}]}}]}}]};var ew=n(533207),tw=n(950364),nw=n(707570);const iw=e=>{const{ariaLabel:t,coreSettings:n,eventType:i,externalAppSessionCorrelationId:a,host:o,hostConversationId:r,hostTenantId:s,isSharedChannel:l,logger:c,personaType:d,shouldDeferCardOpenToParentWindow:u,tabIndex:m,userBiService:g,userId:p}=e;let v,h="Card";switch(i){case"mouseout":case"mousedown":v=tw.MW.MouseHover;break;case"click":case"dblclick":v=tw.MW.MouseClick,h="ExpandedView";break;case"keydown":v=tw.MW.KeyboardPress,h="ExpandedView";break;default:v=tw.MW.MouseHover}const f=!!n.get(L.J.People).isInIframe,y=void 0!==u?u:f,b=()=>{null==o||o.document.dispatchEvent(new MouseEvent("mousemove"))};return{cardParameters:{personaInfo:{identifiers:{PersonaType:d||"NotResolved",HostAppPersonaId:(0,nw.Bg)({userId:p,isSharedChannel:!!l,hostTenantId:s,hostConversationId:r}),TeamsMri:p}},behavior:{cardPlacementMode:"AnchorSide",locationToOpen:h,onCardOpen:()=>{null==o||o.document.addEventListener("mouseleave",b);const e={panelRegion:Ja.Ai.popover,panelType:Ja.wh.LivePersonaCard};null==g||g.recordPanelView(e,c)},onCardClose:()=>{null==o||o.document.removeEventListener("mouseleave",b);const e={actionGesture:Ja.uS.mouseleave,actionOutcome:Ja.$K.closePanel,actionScenarioType:Ja.Yu.people,actionScenario:Ja.Tk.closePanel,moduleName:Ja.rA.lpcClose,panelRegion:Ja.Ai.popover,panelType:Ja.wh.LivePersonaCard};null==g||g.recordPanelAction(e,c)},shouldDeferCardOpenToParentWindow:y},externalAppSessionCorrelationId:a,ariaLabel:t,clientScenario:"MicrosoftTeams_MultiWindow",openCardTriggerType:v},tabIndex:m}},aw=({commandData:{userId:e,isSharedChannel:t,conversationId:n},tenantId:a,coreSettings:o,client:r,logger:s,host:l})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const c=yield((e,t,n,a,o,r,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{enableTflSms:i}=o.get(L.J.Messaging),{showPersonCardForSMSUser:l,showPersonCardForXTapUser:c}=o.get(L.J.People),{isCallingScreenInteractive:d,disablePstnPersonaCard:u}=o.get(L.J.Calling),{enableFlyoutInlineChat:m,enableSimplifiedFeaturesInFlyoutChat:g}=o.get(L.J.Flyout);if(!d||m&&g)return!1;if(e&&Fr.eo.isTFLSmsMri(e))return!!i&&!!l;if(e&&Fr.eo.isTFLOffNetworkUser(e))return!1;if(u&&(0,ew.EG)(e))return!1;if(t&&!c){const t=(0,nw.we)(e,n,a,"lpc-persona-container",s);if(!t)return s.warn("xTap profile Query variables are not defined for a shared channel"),!1;const{data:i}=yield r.query({query:Yk,variables:t});if(!i||!i.getUsersForConversation)return s.warn("xTap profile Query returned null data"),!1;const o=i.getUsersForConversation,l=!!(o.length>0&&o[0]&&Fr.eo.isFederatedUser(o[0])&&o[0].xtapUser);return!l||!!c&&l}return!0})))(e,!!t,n,a,o,r,s),{data:{lpcState:d}}=yield r.query({query:Xk});return!!(e&&c&&(null==d?void 0:d.isLivePersonaCardInitialized)&&(null==l?void 0:l.LPC))||(s.warn(`Lpc is not ready, \n          userId: ${e},\n          isLpcAllowed: ${!c},\n          isLivePersonaCardInitialized: ${null==d?void 0:d.isLivePersonaCardInitialized}, \n          host.LPC:${!(null==l?void 0:l.LPC)}\n        `),!1)})),ow=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;const{data:{authenticationUsers:i}}=yield e.query({query:Zk,variables:{filter:{isAuthenticated:!0}}});return null===(n=null===(t=i[0])||void 0===t?void 0:t.profile)||void 0===n?void 0:n.tenantId})),rw=(e,t,n)=>null==n?void 0:n.LPC.openCard(new n.DOMRect(e.left,e.top,e.width,e.height),t);var sw=n(988358),lw=n(501539);const cw={onCommandReceived:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n,a;const{appViewState:o,commandInput:r,host:s,requestContext:{client:l,coreSettings:c,loggerFactory:d},userBiService:u}=e,{command:{action:m,actor:g,data:p}}=r,v=d.newLogger("EntityMoreInfo onCommandReceived","apps-entity-more-info");if(v.log(`Command {action:${r.command.action}} received.`),!(null===(t=Qk.actors)||void 0===t?void 0:t.includes(g)))return void v.error(`Command {action:${r.command.action}, actor:${r.command.actor}} is sent to the wrong App.`);const h=o;if(!(null===(n=h.readyToBootstrapLPC)||void 0===n?void 0:n.read()))return v.error(`Command failed, LPC is not bootstrapped for command: {action:${r.command.action}}}.`),void(null===(a=h.readyToBootstrapLPC)||void 0===a||a.update(!0));const f=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return!!(yield aw({client:l,commandData:e,coreSettings:c,host:s,logger:v,tenantId:t}))||(v.error(`Command failed, LPC is not ready for command: {action:${r.command.action}}}.`),!1)}));switch(m){case dn:{const e=p,t=e.tenantId||(yield ow(l));if(!(yield f(e,t)))return;const n=iw(Object.assign(Object.assign(Object.assign({},e),t&&{tenantId:t}),{coreSettings:c,externalAppSessionCorrelationId:(0,Ye.v4)(),host:s,logger:v,userBiService:u}));return void rw(e,n.cardParameters,s)}case un:{const e=p,t=e.tenantId||(yield ow(l));if(!(yield f(e,t)))return;const n=(({ariaLabel:e,contextId:t,conversationId:n,coreSettings:i,eventType:a,externalAppSessionCorrelationId:o,highlightedText:r,host:s,isSharedChannel:l,logger:c,tenantId:d,topicId:u,userBiService:m,userId:g,clientRequestId:p})=>{const v=iw({ariaLabel:e,coreSettings:i,eventType:a,externalAppSessionCorrelationId:o,host:s,hostConversationId:n,hostTenantId:d,isSharedChannel:l,logger:c,userBiService:m,userId:g}),h={contextId:t,highlightedText:r,hideEntityAndContextQuestion:!0,clientRequestId:p};return Object.assign(Object.assign({},v),{cardParameters:Object.assign(Object.assign({},v.cardParameters),{personaInfo:Object.assign(Object.assign({},v.cardParameters.personaInfo),{identifiers:Object.assign(Object.assign({},v.cardParameters.personaInfo.identifiers),{PersonaType:"Topic",TeamsMri:void 0,TopicId:u}),topicMetadata:h}),behavior:Object.assign(Object.assign({},v.cardParameters.behavior),{onCardOpen:()=>{var e,t;if(null===(t=(e=v.cardParameters.behavior).onCardOpen)||void 0===t||t.call(e),u){const e=(0,lw.I6)({userAadObjectId:g,tenantAadObjectId:d});null==e||e.logEvent(sw.z.TopicCardOpen,{topicId:u})}}})})})})(Object.assign(Object.assign(Object.assign({},e),t&&{tenantId:t}),{coreSettings:c,externalAppSessionCorrelationId:(0,Ye.v4)(),host:s,logger:v,userBiService:u}));return void rw(e,n.cardParameters,s)}default:v.error(`Command action ${m} is not supported at EntityMoreInfoApp.`)}})),viewStateRegistration:Kk};var dw=n(441550),uw=n(307831),mw=n(350478);const{useRef:gw,useEffect:pw}=r,vw=()=>Promise.all([n.e(698627),n.e(623025),n.e(579814),n.e(418676),n.e(101243),n.e(603612),n.e(929389),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(11495),n.e(645508),n.e(842905),n.e(285883)]).then(n.bind(n,697633)),hw=({logger:e,onRenderEvent:t,scenarioFactory:a})=>{const r=(0,dw.I)("readyToBootstrapLPC");e.log(`LpcLazyLoader: shouldBootstrapLPC=${r}`);const[s,l]=(0,o.useState)(null);return(e=>{const t=gw(),a=gw(),o=(0,uw.WD)(ft.nh.COMPLETE),{host:r,scenarioFactory:s}=(0,mw.SE)();pw((()=>{e&&o&&(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e=()=>n.e(739823).then(n.t.bind(n,625527,23));try{const{freeBootstrapperMemory:n}=yield(0,c.mT)(e,"lpc-teams-bootstrapper",s);t.current=n,a.current=r.__lpcWindowProxy}catch(e){}}))}),[r,o,s,e]),pw((()=>()=>t.current&&a.current&&t.current(a.current)),[])})(!!r),(0,o.useEffect)((()=>{if(r){const e="entity-more-info-app";t("ChunkLoadStarted",{chunkName:e}),(0,c.mT)(vw,e,a).then((e=>l((()=>e.LPC)))),t("ChunkLoadSucceeded",{chunkName:e})}}),[t,a,r]),s&&o.createElement(s,null)};function fw(){return Object.assign(Object.assign({},cw),{manifest:Qk,render:({coreSettings:e,loggerFactory:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=t.newLogger("EntityMoreInfoApp","apps-entity-more-info"),{enableEntityMoreInfo:r}=e.get(L.J.Core);return i.log(`render: loading EntityMoreInfoApp with enableEntityMoreInfo=${r}`),r?o.createElement(hw,{logger:i,onRenderEvent:n,scenarioFactory:a}):o.createElement(o.Fragment,null)}))})}const yw={id:lS.x8,name:"TeamsGalleryApp",supportedEntities:[u.p.teamsgallery],supportedRenderModes:[s.S.Main,s.S.Rail],getDefaultCommand:()=>({action:u.u.view,type:u.p.teamsgallery})},bw=e=>{if(Sw(e))return kw(e)?{subNavEntity:ww(e),headerEntity:Cw(e),startEntity:_w(e),mainEntity:Tw(e),endEntity:Iw(e)}:null},Sw=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[d.lO.focus,d.lO.standard].includes(e),o=[u.p.teamsgallery].includes(i),r=n&&[u.u.create,u.u.default,u.u.list,u.u.view].includes(n);return!!(a&&o&&r)},kw=()=>!0,ww=({entity:e})=>e,Cw=()=>null,_w=()=>null,Tw=({entity:e})=>e,Iw=()=>null,Ew=({areEmptySlotsTransparent:e,coreSettings:t})=>({[C.tF7.subNavEntity]:{[s.S.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==t?void 0:t.get(L.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}}}),Nw=()=>Promise.all([n.e(893479),n.e(770824),n.e(200244),n.e(214475),n.e(715369)]).then(n.bind(n,255630));function Aw(){return{getAppViewEntities:bw,getAppViewEntitiesProps:Ew,manifest:yw,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="teams-gallery-app";t("ChunkLoadStarted",{chunkName:i});const{TeamsGallery:a}=yield(0,c.mT)(Nw,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(a,{appRenderMode:e})}))}}var Fw=n(129756),Dw=n(955118),Rw=n(440429),xw=n(878563),Mw=n(147382),Ow=n(848378),Pw=n(70029),Lw=n(461525),Uw=n(532556),jw=n(432707),$w=n(22315),Bw=n(135822),Ww=n(862264),Hw=n(71386);const Vw="core_life_cycle_start_",zw="core_task_end_",qw="core_init_complete";var Gw;!function(e){e.activity="activity",e.alarm="alarm",e.alert="alert",e.attention="attention",e.busy="busy",e.error="error"}(Gw||(Gw={}));var Jw=n(968646),Qw=n(35931),Kw=n(495533),Yw=n(804436),Xw=n(517181),Zw=n(228303);const eC=(e,t,n,a)=>(0,Ow.z)((0,Xw.fU)(((n,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e[Symbol.iterator](),o=t[Symbol.iterator]();let r=i.next(),s=o.next();const l=[];for(;!s.done||!r.done;)s.done||!r.done&&s.value.id>r.value[0].id?(yield a(r.value[1]),r=i.next()):r.done||s.value.id<r.value[0].id?(l.push([s.value,n(s.value)]),s=o.next()):(l.push([s.value,r.value[1]]),r=i.next(),s=o.next());return l}))}(n,Array.from(o).sort(((e,t)=>e.id.localeCompare(t.id))),(t=>tC(t,e,a)),(e=>nC(e,t)))}))),[]),(0,Lw.U)((e=>iC(e,n))),(0,Zw.b)((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield e;return Promise.all(t)}))))),tC=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{return{type:"value",value:yield t(e)}}catch(t){return n&&n(e,t),{type:"error",error:t}}})),nC=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=yield e;if("error"!==n.type)return t(Promise.resolve(n.value))})),iC=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=[],i=yield Promise.all(e);for(const e of i){const i=yield e[1];"value"===i.type&&n.push(t(e[0],Promise.resolve(i.value)))}return n}));var aC=n(342116);var oC=n(422787);function rC(e){return Object.keys(e).reduce(((t,n)=>(t[n]=function(e){const t=(0,oC.QS)(e);return{update:e=>t(e),read:()=>t(),ref:t}}(e[n]),t)),{})}const sC=new Set([d.ab,d.Xt]);class lC{constructor(e,t,n){this._logger=e.newLogger("ReactiveValuesService","core-services-activator"),this._appViewStateForWindowMap=new Map,this._servicesAppsRegistry=t,this._config=n}getAppViewStateForWindow(e,t){var n,i,a;this._config.enableEmbedDataClient&&(e=he.ew);const o=null===(n=this._appViewStateForWindowMap.get(e))||void 0===n?void 0:n.get(t);if(!o){const n=this._servicesAppsRegistry.getAppByID(t);n&&"viewStateRegistration"in n&&n.viewStateRegistration&&(null===(a=(i=this._logger).errorToTelemetry)||void 0===a||a.call(i,`Unable to find appViewState for window ${e} app ${t}, registeredApps: ${this._appViewStateForWindowMap.get(e)}`,"webclient_framework_foundation_core_services_activator"))}return o}resetAllViewState(e){const t=this._appViewStateForWindowMap.get(e);t&&t.forEach(((e,t)=>{sC.has(t)||this.resetViewStateForApp(t,e)}))}setReactiveValuesForApp(e,t,n){var i;const a=null===(i=this._appViewStateForWindowMap.get(e))||void 0===i?void 0:i.get(t);if(this._logger.log(`Setting view state to apollo cache value for windowId ${e}, app ${t}`),a){const{navigationalReactiveValues:e,nonNavigationalReactiveValues:t}=a;Object.keys(n).forEach((i=>{let a=e[i];a||(a=t[i]),a.update(n[i])}))}}getRegisteredAppsTypePolicies(e){const t={typePolicies:{},defaultTypeName:[]};return this._appViewStateForWindowMap.set(e,new Map),this._servicesAppsRegistry.registeredApps.forEach((n=>{const i=n.manifest.id,a=n;if(a.viewStateRegistration){const{computedValues:n,navigationalFieldDefaultValues:o,nonNavigationalFieldDefaultValues:r,gqlTypeName:s,queryFieldName:l}=a.viewStateRegistration,c=rC(o),d=rC(r),u=this._appViewStateForWindowMap.get(e);null==u||u.set(i,{navigationalReactiveValues:c,nonNavigationalReactiveValues:d});const m=function(...e){const[t,n,i]=e,a={};for(const e of Object.keys(n)){const t=e,i=()=>n[t].read();a[t]={read:i}}if(i)for(const e of Object.keys(i)){const t=e,o=(e,a)=>{const{args:o}=a||{};return i[t](n,o)};a[t]={read:o}}return{[t]:{fields:a}}}(s,Object.assign(Object.assign({},c),d),n);t.typePolicies=Object.assign(Object.assign({},t.typePolicies),m),t.defaultTypeName.push({gqlTypeName:s,queryFieldName:l})}})),t}removeWindowViewState(e){this._appViewStateForWindowMap.delete(e)}resetViewStateForApp(e,t,n){const i=this._servicesAppsRegistry.getAppByID(e);if(i&&t&&"viewStateRegistration"in i&&i.viewStateRegistration){this._logger.log(`Resetting view state for app ${e}`);const{navigationalFieldDefaultValues:a,nonNavigationalFieldDefaultValues:o}=i.viewStateRegistration;Object.keys(a||{}).forEach((e=>{(null==n?void 0:n.includes(e))||t.navigationalReactiveValues[e].update(a[e])})),Object.keys(o).forEach((e=>{(null==n?void 0:n.includes(e))||t.nonNavigationalReactiveValues[e].update(o[e])}))}}}const cC={id:"com.microsoft.teams.corelayout",actors:["corelayout"],name:"CoreLayoutApp"},dC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutResizeSlotDimensionsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"width"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"slotName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SlotName"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resizeSlotDimensions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"Variable",name:{kind:"Name",value:"width"}}},{kind:"Argument",name:{kind:"Name",value:"slotName"},value:{kind:"Variable",name:{kind:"Name",value:"slotName"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};const uC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutResizeHeaderMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"height"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resizeHeaderSlot"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"height"},value:{kind:"Variable",name:{kind:"Name",value:"height"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},mC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutChangeSlotsVisibilityMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"slotNames"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SlotName"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isHidden"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSlotsVisibility"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"slotNames"},value:{kind:"Variable",name:{kind:"Name",value:"slotNames"}}},{kind:"Argument",name:{kind:"Name",value:"isHidden"},value:{kind:"Variable",name:{kind:"Name",value:"isHidden"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},gC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutChangeMonitorSlotMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityAction"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityAction"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeMonitorSlotContent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityType"},value:{kind:"Variable",name:{kind:"Name",value:"entityType"}}},{kind:"Argument",name:{kind:"Name",value:"entityAction"},value:{kind:"Variable",name:{kind:"Name",value:"entityAction"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},pC={eventHandlers:{onEventReceived:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n,i;const{appViewState:a,eventInput:o,requestContext:{client:r,loggerFactory:s},windowId:l}=e,c=s.newLogger("apps-core-layout","apps-core-layout"),d=o.event;if(!function(e){if(e.originator!==Vi.kn)return!1;for(const t in Vi.uS)if(t===e.type)return!0;return!1}(d))return c.error(`Unhandled event ${o} is not a core layout event`),Promise.reject(new Error(`Unhandled event ${o.event.type} is not a core layout event`));switch(d.type){case Vi.uS.criticalAppPhaseReached:return a.postCriticalPhaseReached.update(!1),void a.completePhaseReached.update(!1);case Vi.uS.postCriticalAppPhaseReached:return void a.postCriticalPhaseReached.update(!0);case Vi.uS.completeAppPhaseReached:return void a.completePhaseReached.update(!0);case Vi.uS.resizeSlot:return void r.mutate({mutation:dC,variables:{slotName:null===(t=d.data)||void 0===t?void 0:t.call(d).slotName,width:null===(n=d.data)||void 0===n?void 0:n.call(d).width,windowId:l}});case Vi.uS.updateAmsV2Domain:const{amsV2Domain:e}=d.data();return void(a.amsV2Domain.read()!==e&&a.amsV2Domain.update(e||""));case Vi.uS.updateBaseImageUrl:const{baseImageUrl:s}=d.data();return c.log(`Received baseImageUrl core-layout event with data ${s}`),void(a.baseImageUrl.read()!==s&&(c.log(`Updating baseImageUrl app view state ${s}`),a.baseImageUrl.update(s||"")));case Vi.uS.updateIsImageAuthCookieValid:const{isImageAuthCookieValid:u}=(null===(i=d.data)||void 0===i?void 0:i.call(d))||{};return void(void 0!==u&&a.isImageAuthCookieValid.read()!==u&&a.isImageAuthCookieValid.update(u));default:return c.error(`Unhandled event ${o}`),Promise.reject(new Error(`Unhandled event ${o.event.type}`))}}))},onCommandReceived:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{commandInput:n,requestContext:{client:i,loggerFactory:a},slotDimensionsOptions:o,windowId:r}=e,{command:{action:s,actor:l,data:c}}=n,d=a.newLogger("CoreLayoutApp onCommandReceived","apps-core-layout");if(!(null===(t=cC.actors)||void 0===t?void 0:t.includes(l)))return void d.error(`Command  ${n.command} is sent to the wrong App.`);const{header:{height:u}}=o,{collapsed:m,expanded:g}=u||{};switch(s){case zi.Nw.collapseHeader:i.mutate({mutation:uC,variables:{height:m,windowId:r}});break;case zi.Nw.expandHeader:i.mutate({mutation:uC,variables:{height:g,windowId:r}});break;case zi.Nw.expandTab:{const{excludeHeader:e}=c||{},t=e?[ft.WL.NOTIFICATIONS,ft.WL.SUBNAV]:[ft.WL.HEADER,ft.WL.NOTIFICATIONS,ft.WL.SUBNAV];i.mutate({mutation:mC,variables:{slotNames:t,windowId:r,isHidden:!0}});break}case zi.Nw.maximizeTab:i.mutate({mutation:mC,variables:{slotNames:[ft.WL.HEADER,ft.WL.NAV,ft.WL.NOTIFICATIONS,ft.WL.SUBNAV,ft.WL.TITLE_BAR],windowId:r,isHidden:!0}});break;case zi.Nw.resetLayoutOverrides:i.mutate({mutation:mC,variables:{slotNames:[ft.WL.HEADER,ft.WL.NAV,ft.WL.NOTIFICATIONS,ft.WL.SUBNAV,ft.WL.TITLE_BAR],windowId:r,isHidden:!1}});break;case zi.Nw.showMonitor:i.mutate({mutation:gC,variables:{windowId:r,entityType:C.pyR.floatingmonitor,entityAction:C.ukP.view,entityOptions:JSON.stringify(n.command.data)}});break;case zi.Nw.closeMonitor:i.mutate({mutation:gC,variables:{windowId:r,entityType:C.pyR.floatingmonitor,entityAction:C.ukP.leave}});break;case zi.Nw.hideMonitor:i.mutate({mutation:mC,variables:{slotNames:[ft.WL.MONITOR],windowId:r,isHidden:!0}});break;case zi.Nw.unhideMonitor:i.mutate({mutation:mC,variables:{slotNames:[ft.WL.MONITOR],windowId:r,isHidden:!1}});break;default:d.error(`Command action ${s} is not supported at CoreLayoutApp.`)}})),onViewUpdateCommandResolved:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){})),viewStateRegistration:{gqlTypeName:"CoreLayoutAppViewState",queryFieldName:"coreLayoutAppViewState",navigationalFieldDefaultValues:{},nonNavigationalFieldDefaultValues:{amsV2Domain:"",baseImageUrl:"",completePhaseReached:!1,isImageAuthCookieValid:!1,postCriticalPhaseReached:!1},computedValues:void 0}};const vC={[u.p.meetings]:["com.microsoft.teams.calling","com.microsoft.teams.meeting-options"]},hC=function(){const e=()=>null;return Object.assign(Object.assign({},pC),{manifest:cC,render:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return o.createElement(e,null)}))})}();class fC{constructor(e,t,n){this._loadedTasksMap=new Map,this._appIdToAppMap=void 0,this._logger=e.newLogger("AppsRegistryService","core-services-activator"),this._loadedApps=[],this._entityTypeToAppMap=new Map,this.initialize(n),this._reactiveValuesService=new lC(e,this,t)}get registeredApps(){return this._loadedApps}get registeredAppManifests(){return this._loadedApps.map((e=>e.manifest))}get registeredTasks(){return Array.from(this._loadedTasksMap.values())}getApp({entityType:e,renderMode:t}){if(e||t)return this.registeredApps.find((n=>(!e||function({supportedEntities:e},t){return!(!e||-1===e.indexOf(t))}(n.manifest,e))&&(!t||function({supportedRenderModes:e},t){return!(!e||-1===e.indexOf(t))}(n.manifest,t))))}getAppViewStateForWindow(e,t){return this._reactiveValuesService.getAppViewStateForWindow(e,t)}getAppByID(e){var t;return null===(t=this._appIdToAppMap)||void 0===t?void 0:t.get(e)}getPlatformAppIdForEntity(e){const t=this._entityTypeToAppMap.get(e.type);if(void 0===t)return void this._logger.error("getPlatformAppIdForEntity: Platform id requested for entity which has no registered app in this experience.",{entityType:e.type});if(void 0===t.getPlatformAppIdForEntity)return void this._logger.debug("getPlatformAppIdForEntity: An app is registered for this entity but has no function for getPlatformAppIdForEntity.",{appName:t.manifest.name,entityType:e.type});let n;try{n=t.getPlatformAppIdForEntity(e)}catch(n){this._logger.error("getPlatformAppIdForEntity: Error caught from app handler while mapping the id for this entity.",{appName:t.manifest.name,entityType:e.type})}if(void 0!==n)return n;this._logger.debug("getPlatformAppIdForEntity: App mapped the id for this entity to undefined.",{appName:t.manifest.name,entityType:e.type})}getAppByActor(e){if(e)return this.registeredApps.find((t=>function({actors:e},t){return!(!e||-1===e.indexOf(t))}(t.manifest,e)))}getDefaultCommand(e){var t,n;const{coldBootAppId:i}=e.get(L.J.Edu),{coreColdBootAppId:a,enableEDUColdBootApp:o}=e.get(L.J.Core),r=o?i:a;if(r){this._logger.debug(`Using cold boot appId of ${r} with enableEDUColdBootApp ${o}`);const i=this.getAppByID(r),a=null===(n=null==i?void 0:(t=i.manifest).getDefaultCommand)||void 0===n?void 0:n.call(t,e);if(a)return a;this._logger.debug(`No default command found ${r}`)}for(const t of this.registeredAppManifests)if(t.getDefaultCommand){const n=t.getDefaultCommand(e);if(n)return this._logger.debug(`Found a default command in ${t.name}`),n}}resetAllViewState(e){this._reactiveValuesService.resetAllViewState(e)}setReactiveValuesForApp(e,t,n){this._reactiveValuesService.setReactiveValuesForApp(e,t,n)}getRegisteredAppsTypePolicies(e){return this._reactiveValuesService.getRegisteredAppsTypePolicies(e)}removeWindowViewState(e){this._reactiveValuesService.removeWindowViewState(e)}registerTask(e){this._loadedTasksMap.set(e.id,e)}initialize(e){const t=new Map;if(!(e&&e.length>0))throw new Error(`initialize::${he.jK.Empty} - No apps registered`);-1===e.findIndex((e=>e.manifest.id===hC.manifest.id))&&e.length>0&&e.push(hC),e.forEach((e=>{var n;if(t.has(e.manifest.id))throw new Error(`Multiple apps found for appId ${e.manifest.id}`);t.set(e.manifest.id,e),null===(n=e.manifest.supportedEntities)||void 0===n||n.forEach((t=>{const n=vC[t];if(!n||!n.includes(e.manifest.id)){if(this._entityTypeToAppMap.has(t))throw new Error(`Multiple apps found for entity ${t}`);this._entityTypeToAppMap.set(t,e)}})),e.onRegister&&e.onRegister({registerTask:this.registerTask.bind(this)})})),this._loadedApps=Array.from(t.values()),this._appIdToAppMap=t}}var yC=n(902481);const bC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowForEntity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindowForEntity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindow"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindow"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveWindow"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}}]}}]}.definitions]};var SC=n(860125),kC=n(734876),wC=n(402393),CC=n(498383);const _C=new Set([d.ab,d.Xt]),TC=e=>"viewStateRegistration"in e,IC=e=>_C.has(e.manifest.id),EC=e=>{var t,n,i,a,o,r,s;return null!==(r=null!==(a=null!==(n=null===(t=e.current)||void 0===t?void 0:t.subNavEntity)&&void 0!==n?n:null===(i=e.current)||void 0===i?void 0:i.headerEntity)&&void 0!==a?a:null===(o=e.current)||void 0===o?void 0:o.startEntity)&&void 0!==r?r:null===(s=e.current)||void 0===s?void 0:s.mainEntity},NC=e=>e.manifest.id===d.vC,AC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"executeEntityCommand"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"executionContext"}},type:{kind:"NamedType",name:{kind:"Name",value:"ExecutionContextInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"command"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityCommandInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLaunchId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"WindowOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"executeEntityCommand"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"executionContext"},value:{kind:"Variable",name:{kind:"Name",value:"executionContext"}}},{kind:"Argument",name:{kind:"Name",value:"command"},value:{kind:"Variable",name:{kind:"Name",value:"command"}}},{kind:"Argument",name:{kind:"Name",value:"clientLaunchId"},value:{kind:"Variable",name:{kind:"Name",value:"clientLaunchId"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}},{kind:"Argument",name:{kind:"Name",value:"windowOptions"},value:{kind:"Variable",name:{kind:"Name",value:"windowOptions"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};function FC(e){return Object.assign(Object.assign({},e),{id:(t=e,t&&t.id||(0,Ye.v4)()),startTimestamp:DC(e),source:(null==e?void 0:e.source)||kt.D.StandAlone});var t}function DC(e){return e&&e.startTimestamp||Date.now()}function RC({appName:e,commandChangeReportingService:t,entityCommand:n,getCommandScenarioName:i,logger:a,coreSettings:o}){const r=n.command.correlation,s=void 0===r.scenarioName||r.scenarioName===it.RG.EntityCommand;if(i&&s){try{r.scenarioName=i(n,a,o)}catch(n){t.report({type:wC.B.Failure,context:{errorInfo:CC.y.GetCommandScenarioNameHookFailed,errorMessage:`App ${e} failed to execute entity command hook GetCommandScenarioName with ${n.name}`,target:"internal-command-handler"},correlationId:r.id})}a.log(`App ${e} is overwriting default scenario name to ${r.scenarioName} for command with entityType ${n.entity.type}`)}}function xC(e){return Object.assign(Object.assign({},e),{command:MC(e.command)})}function MC(e){return Object.assign(Object.assign({},e),{correlation:FC(e.correlation)})}function OC(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield t.query({query:bC,variables:{entity:e},fetchPolicy:"no-cache"});return null===(a=n.data.activeWindowForEntity)||void 0===a?void 0:a.id}catch(t){return void n.error(`query for entity failed. Entity: ${JSON.stringify(e)}, Error: ${t}`)}}))}function PC(e,t,n,i){const a=t.getValue().find((t=>t.id===e)),o=!(!a||!a.window.document.hasFocus()),r=n.getState(),s=r===yC.pk.LongInactive||r===yC.pk.Inactive,l=o&&!s;return l||i.log(`isWindowInView: Window considered to be not in view. Window is inactive ${s}, window has focus: ${o}`),l}function LC(e){return function(e,t){return(0,SC.sanitize)(e,t)}(e,function(e,t){return{ADD_ATTR:e,ADD_TAGS:t,RETURN_TRUSTED_TYPE:!0,WHOLE_DOCUMENT:!0}}(["content","focusable","nonce","onclick"],["link","meta","script","#comment","!doctype"]))}function UC(e){var t,n;return[null!==(t=null==e?void 0:e.findScenario(it.RG.ClientStart))&&void 0!==t?t:null,null!==(n=null==e?void 0:e.findScenario(it.RG.ExperienceReady))&&void 0!==n?n:null]}function jC(e,t){return e instanceof pe.G?e:new kC.G(kC.$.UNKNOWN,e,t)}function $C(e,t,n,i){return WC.bind(void 0,e,t,n,i)}function BC(e,t){var n;const i=null===(n=null==t?void 0:t.get(L.J.Core))||void 0===n?void 0:n.enableStackTraceCollection;return{errorCode:e instanceof pe.G&&pe.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():void 0,stack:i&&e instanceof pe.G?e.stack:void 0}}function WC(e,t,n,a){var o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i="";const s=null==e?void 0:e.host;s&&(i=`SessionId:\t${s.sessionId}\r\nDeviceId:\t${s.deviceId}\r\nHostVersion:\t${s.hostAppVersion}\r\n`);const l=null==e?void 0:e.config;l&&(i=`${i}WebVersion:\t${null==l?void 0:l.clientVersion}\r\n`);const c=null==t?void 0:t.locale;c&&(i=`${i}Language:\t${c}\r\n`);const d=null==a?void 0:a.get(L.J.Metadata);(null===(o=null==d?void 0:d.ring)||void 0===o?void 0:o.id)&&(i=`${i}Ring:\t${d.ring.id}\r\n`);const u=yield null===(r=null==n?void 0:n.getCachedUsers)||void 0===r?void 0:r.call(n,Object.assign(Object.assign({},FC({source:kt.D.Core})),{scenarioName:it.RG.AuthWebCachedUser}));if(null==u?void 0:u.length){i=`${i}Logged in users:\r\n`;for(const e of u)i=`${i}\t${e.userName}  ${e.profile.name}  TId:${e.profile.tid}  OId:${e.profile.oid}  UserId:${e.id}\r\n`}return i}))}class HC{constructor(e,t,n,i,a,o,r,s,l,c,d,u){this._loggerFactory=e,this._appsRegistryService=t,this._config=n,this._configLoader=i,this._coreTasks=o,this._diagnosticsService=r,this._logsCollectorService=s,this._waitForRenderingContextReady=l,this._isEntityInView=c,this._criticalDynamicImports=d,this._getPlatformConfigurationOverrides=u,this._logger=e.newLogger("TaskManagerService","core-services-activator"),this._appsRegistryService=t,this._taskContext=this.createNewContext(a)}notifyLifeCycleEvent(e,t={},n){var a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this.extractApplicableTasks(this._appsRegistryService.registeredTasks,e);this._logger.log(`notify::starting - lifeCycleEvent=${e}, taskCount=${i.length}`);const r=Object.assign(Object.assign({},this._taskContext),t);this.markCoreLifeCycleEventStart(r,e);const s={},l=null===(a=null===performance||void 0===performance?void 0:performance.timing)||void 0===a?void 0:a.navigationStart,c=new Map,d=[];let u=0;for(const t of i){const i=null===(o=null===performance||void 0===performance?void 0:performance.now)||void 0===o?void 0:o.call(performance),a=e=>{this._logger.error(`notify:: Task Execute Error - taskId ${he.Yg[t.id]}, code=${e.code} errorMsg=${(0,An.B9)((null==e?void 0:e.prevError)||e)}\n          .`),c.set(t.id,e)},m=()=>t instanceof fe?t.executeSafe(r,s):t.execute(r,s),g=e=>e?(0,Fn.E)(m(),e,`${he.Yg[t.id]} timed out.`):m(),p=yield g(this._config.coreTasksTimeoutMs).catch(a);p&&d.push({taskId:t.id,cleanupFn:p}),this.markCoreLifeCycleTaskCompleted(r,e,t,c,i,l,++u,n)}return this.logErrorSummary(e,c),this._logger.log(`notify::tasks complete - lifeCycleEvent=${e}, taskCount=${i.length}`),Object.assign(Object.assign(Object.assign({},s),r),{coreTaskErrors:Array.from(c.values()),cleanupFns:d})}))}destroyContext(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=e.cleanupFns.length;let i,a=0;for(;i=e.cleanupFns.pop();)try{yield i.cleanupFn(t),a++}catch(e){this._logger.error(`Cleanup failed for task: ${he.Yg[i.taskId]}`)}this._logger.log(`destroyContext complete: ${a}/${n} tasks succeeded.`)}))}hasTasks(e){return this.extractApplicableTasks(this._appsRegistryService.registeredTasks,e).length>0}markCoreLifeCycleEventStart(e,t){var n,i,a;const o=null===(n=e.altScenarioService)||void 0===n?void 0:n.altScenario,r=null===(i=e.altScenarioService)||void 0===i?void 0:i.clientStartScenario,s=`${Vw}${t}`;o||r?(o&&o.mark(s),r&&r.mark(s)):null===(a=null===performance||void 0===performance?void 0:performance.mark)||void 0===a||a.call(performance,s)}markCoreLifeCycleTaskCompleted(e,t,n,i,a,o,r,s){var l,c,d;const u=null===(l=e.altScenarioService)||void 0===l?void 0:l.altScenario,m=null===(c=e.altScenarioService)||void 0===c?void 0:c.clientStartScenario,g=i.get(n.id),p=BC(g).errorCode,v=`${t}_${he.Yg[n.id]}`;u||m?(u&&u.mark(`core_task_${v}`,g?{errorCode:p}:void 0),m&&m.mark(`core_task_${v}`,g?{errorCode:p}:void 0)):null===(d=null===performance||void 0===performance?void 0:performance.mark)||void 0===d||d.call(performance,`${zw}${v}`),this.addTaskDetailsToLocalStorage(g||{},a,o,v,r,e),null==s||s(n.id,g)}addTaskDetailsToLocalStorage(e,t,n,i,a,o){var r;try{const{windowProvider:s,config:l}=o;l.shouldTrackCoreInitTasks&&(null==s||s.localStorage.setItem(i,(0,wi.u4)({index:a,startTime:new Date(n+t).toISOString(),duration:(null===(r=null===performance||void 0===performance?void 0:performance.now)||void 0===r?void 0:r.call(performance))-t,error:e})))}catch(e){e.code===DOMException.QUOTA_EXCEEDED_ERR?this._logger.error("Error: Quota exceeded while writing core task details to local storage."):this._logger.warn(`Couldn't write core init task details to local storage: ${(0,An.B9)(e)}`)}}createNewContext(e){return{correlation:e,diagnosticsService:this._diagnosticsService,logsCollectorService:this._logsCollectorService,loggerFactory:this._loggerFactory,appsRegistryService:this._appsRegistryService,config:this._config,configLoader:this._configLoader,waitForRenderingContextReady:this._waitForRenderingContextReady,isEntityInView:this._isEntityInView,criticalDynamicImports:this._criticalDynamicImports,getPlatformConfigurationOverrides:this._getPlatformConfigurationOverrides}}extractApplicableTasks(e,t){var n,i;const a=[];if(e){const n=e.filter((e=>!e.lifeCycleSubscriptions&&t===he.sM.Initialization||e.lifeCycleSubscriptions&&-1!==e.lifeCycleSubscriptions.indexOf(t)));a.push(...n)}return((null===(i=(n=this._coreTasks)[t])||void 0===i?void 0:i.call(n))||[]).concat(a)}logErrorSummary(e,t){if(t.size>0){const n=(0,An.Tr)("TaskManagerService",he.jK.NotInitialized,`lifeCycleEvent=${e}`,{failedTaskErrors:t});this._logger.error(`Failed ${t.size} core tasks: ${Array.from(t.keys()).map((e=>he.Yg[e])).join()}, lifeCycleEvent=${e}: `,n)}}}const VC={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"windowOptionsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowOptions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]},zC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"monitorEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"clientLaunchId"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"isNotificationsWindow"}},{kind:"Field",name:{kind:"Name",value:"isInitialWindowStateHidden"}},{kind:"Field",name:{kind:"Name",value:"userContextId"}},{kind:"Field",name:{kind:"Name",value:"layoutConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"layoutMode"}}]}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowOptionsFields"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveWindows"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowOptionsFields"}}]}}]}},...VC.definitions]}.definitions,...VC.definitions]},qC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"authenticationUsersEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsersEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cloud"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"loginUserName"}},{kind:"Field",name:{kind:"Name",value:"homeAccountId"}}]}}]}}]}}]},GC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cloud"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"loginUserName"}},{kind:"Field",name:{kind:"Name",value:"homeAccountId"}}]}}]}}]};var JC=n(90984);const QC=new Set([Vn.quit,Vn.restart]);function KC({hostCommunicationService:e,logger:t,reason:n,renderingContextManager:a}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let o;const r=a.getDefaultRenderingContext();switch((null==r?void 0:r.scenarioFactory)&&(o=XC(n,r.scenarioFactory)),n){case"quit":try{yield a.removeAllRenderingContexts(n),null==o||o.mark(it.ck.RemoveAllRenderingContexts),yield function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o;try{i=yield t.loadModule("core")}catch(e){o="LoadModuleCoreFailed"}try{yield null===(a=null==i?void 0:i.reportReadyToQuit)||void 0===a?void 0:a.call(i)}catch(e){o="ReportReadyToQuitFailed"}o&&t_(o,e,n)}))}(t,e,o),null==o||o.stop()}catch(e){e_(e,t,o)}break;case"restart":try{yield a.cleanupWithPriority(n),null==o||o.stop()}catch(e){e_(e,t,o)}break;default:return}}))}function YC({coreSettings:e,logger:t,reason:n,renderingContextManager:a,user:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;try{const t=o&&(0,di.b4)(o);if(!t)throw new kC.G(kC.$.CLEANUP,new Error("signout::UserContextIdNotFound"));const r=yield a.getUserRenderingContext(t);(null==r?void 0:r.scenarioFactory)&&(i=XC(n,r.scenarioFactory)),yield a.removeUserRenderingContext(n,t),null==i||i.mark(it.ck.RemoveUserRenderingContext);if(!e.get(L.J.Auth).isLegacyCleanupCodeFlag){const e=["TestCookie","ringFinder"];!function(e){try{(0,Ue.J)().sessionStorage.clear()}catch(t){ZC(e,"ClearSessionStorageFailed")}}(i),function(e,t){try{Object.keys(JC.getJSON()).forEach((t=>{e.includes(t)||JC.remove(t)}))}catch(e){ZC(t,"DeleteCookiesFailed")}}(e,i)}null==i||i.stop()}catch(e){e_(e,t,i)}}))}function XC(e,t){const n=t.newScenario(it.RG.CoreCleanup),i={reason:e};return n.appendEventData(i),n}function ZC(e,t){const n={errorCode:t};e&&e.fail(n)}function e_(e,t,n){let i;i=e instanceof kC.G&&pe.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():e instanceof Error?`${kC.$.CLEANUP}::UnknownCleanupFailure::${null==e?void 0:e.name}::${null==e?void 0:e.message}`:`${kC.$.CLEANUP}::UnknownCleanupFailure::${(0,wi.u4)(e)}`,t_(i,t,n)}function t_(e,t,n){var i;n&&ZC(n,e),null===(i=t.errorToTelemetry)||void 0===i||i.call(t,e,"webclient_framework_foundation_core_services",void 0,!0)}var n_=n(295598),i_=n(836240),a_=n(459767),o_=n(739987),r_=n(803557),s_=n(615465),l_=n(137853);class c_{constructor(e,t,n){this.eventHandler=e,this.commandHandler=t,this.commandDelegator=n}bubble(e){return this.eventHandler(e,this.commandHandler,this.commandDelegator)}}const d_="internal-event-handler",u_=({commandChangeReportingService:e,correlation:t,type:n})=>{switch(n){case wC.B.DelegatedCommandReceived:e.report({type:n,correlationId:t.id,context:{target:d_,correlation:t}});break;default:e.report({type:n,correlationId:t.id,context:{target:d_}})}},m_=({commandChangeReportingService:e,correlation:t,errorInfo:n=CC.y.DelegatedCommandError,errorMessage:i,logger:a})=>{var o;null===(o=a.errorToTelemetry)||void 0===o||o.call(a,i,"webclient_framework_foundation_core_services_internal_command_delegator",void 0,!0),e.report({correlationId:t.id,type:wC.B.Failure,context:{target:d_,errorMessage:i,errorInfo:n}})};var g_=n(133332);const p_=({appsRegistryService:e,client:t,clientPreferences:n,commandChangeReportingService:a,commandHandler:o,commandInput:r,coreSettings:s,executionContext:l,loggerFactory:c,scenarioFactory:d,windowId:u,host:m,userBiService:g})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const p=c.newLogger("internalCommandDelegator","core-services-entity-commanding"),v=r.correlation||FC();u_({commandChangeReportingService:a,correlation:v,type:wC.B.DelegatedCommandReceived});const h=function(e,t){return e.getAppByActor(t.command.actor)}(e,r);if(!h){const e=`Command for actor ${r.command.actor} does not map to any registered app.`;return m_({commandChangeReportingService:a,correlation:v,errorMessage:e,logger:p}),Promise.resolve(void 0)}if(!h.onCommandReceived){const e=`Command for actor ${r.command.actor} maps to app ${h.manifest.name}, but the app hasn't registered onCommandReceived handler.`;return m_({commandChangeReportingService:a,correlation:v,errorMessage:e,logger:p}),Promise.resolve(void 0)}const{navigationalReactiveValues:f,nonNavigationalReactiveValues:y}=e.getAppViewStateForWindow(u||he.ew,h.manifest.id)||{};let b=!1,S={};f&&(S=Object.keys(f).reduce(((e,t)=>{const n=f[t];return Object.assign(Object.assign({},e),{[t]:{read:n.read,update:e=>{e!==n.read()&&(n.update(e),b=!0)}}})}),{}));const k=function(e,t,n,i,a,o,{viewEntitiesRef:r,viewEntity:s}={},l){var c,d,u;const m=r&&EC(r);return{client:e,clientPreferences:t.getAllPreferences(),coreSettings:n,loggerFactory:i,scenarioFactory:a,executionContext:{viewEntities:{endEntity:null===(c=null==r?void 0:r.current)||void 0===c?void 0:c.endEntity,mainEntity:null===(d=null==r?void 0:r.current)||void 0===d?void 0:d.mainEntity},viewEntity:s,isHandlingAppActiveApp:!!m&&(null===(u=o.getApp({entityType:m.type}))||void 0===u?void 0:u.manifest.id)===l}}}(t,n,s,c,d,e,l,h.manifest.id);let w;try{const e={commandInput:r,requestContext:k};u_({commandChangeReportingService:a,correlation:v,type:wC.B.BeforeOnCommandReceived});const n=Object.assign(Object.assign({},S),y);w=yield(({delegatedApp:e,reactiveValues:t,hookOptions:n,host:a,windowId:o,userBiService:r})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!e.onCommandReceived)return Promise.resolve(void 0);if(TC(e)&&IC(e)){if(t){const i=Object.assign(Object.assign({},n),{appViewState:t,host:a,slotDimensionsOptions:ft.Vi,windowId:o,userBiService:r});return e.onCommandReceived(i)}}else{if(!TC(e)){if(IC(e)){const t=Object.assign(Object.assign({},n),{windowId:o,slotDimensionsOptions:ft.Vi});return e.onCommandReceived(t)}return e.onCommandReceived(n)}if(t){const i=Object.assign(Object.assign({},n),{appViewState:t});return e.onCommandReceived(i)}}return Promise.resolve(void 0)})))({delegatedApp:h,reactiveValues:n,hookOptions:e,host:m,windowId:u,userBiService:g}),b&&(t.mutate({mutation:g_.E,variables:{windowId:u,appIds:[h.manifest.id]}}).catch((e=>{p.warn(`saveReactiveVarToHistory failed ${e.message}`)})),b=!1),u_({commandChangeReportingService:a,correlation:v,type:wC.B.AfterOnCommandReceived})}catch(e){const t=`Command for actor ${r.command.actor} encountered an error inside onCommandReceived of ${h.manifest.name}.`;return m_({commandChangeReportingService:a,correlation:v,errorMessage:t,logger:p}),Promise.reject(e)}if(!w)return u_({correlation:v,commandChangeReportingService:a,type:wC.B.CommandHandledByOnCommandReceived}),Promise.resolve(void 0);const C=Object.assign(Object.assign({},w),{command:Object.assign(Object.assign({},w.command),{correlation:v})});o(C)}));const v_="internal-event-handler",h_=({commandChangeReportingService:e,correlation:t,type:n})=>{switch(n){case wC.B.EventBubbled:e.report({type:n,correlationId:t.id,context:{target:v_,correlation:t}});break;default:e.report({type:n,correlationId:t.id,context:{target:v_}})}},f_=({commandChangeReportingService:e,correlation:t,errorMessage:n,logger:i})=>{var a;const o=CC.y.EventError;null===(a=i.errorToTelemetry)||void 0===a||a.call(i,n,"webclient_framework_foundation_core_services_internal_event_handler",void 0,!0),e.report({correlationId:t.id,type:wC.B.Failure,context:{target:v_,errorMessage:n,errorInfo:o}})},y_=({appsRegistryService:e,client:t,clientPreferences:n,commandChangeReportingService:a,commandDelegator:o,commandHandler:r,coreSettings:l,eventInput:c,executionContext:u,loggerFactory:m,notificationsHandler:g,scenarioFactory:p,userBiService:v,windowId:h})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var f;const y=m.newLogger("internalEventHandler","core-services-entity-commanding");let b=function(e,t){var n;return t?t&&e.getApp({entityType:null===(n=t.viewEntity)||void 0===n?void 0:n.type}):e.getAppByID(d.ab)}(e,u);const S=((e,t,n,i)=>{var a;const{scenarioName:o,id:r,source:s}=(null===(a=null==t?void 0:t.getEventScenarioData)||void 0===a?void 0:a.call(t,e,i))||{},l=FC({id:r,scenarioName:o,source:s,startTimestamp:Date.now()});return h_({commandChangeReportingService:n,correlation:l,type:wC.B.EventBubbled}),l})(c,b,a,y);if("com.microsoft.teams.search"===(null==b?void 0:b.manifest.id)&&"MeControl"===c.event.originator&&(b=e.getApp({renderMode:s.e.TitleBar})),!b){return f_({commandChangeReportingService:a,correlation:S,errorMessage:"Error mapping event to slot.",logger:y}),Promise.resolve(void 0)}if(!(null===(f=b.eventHandlers)||void 0===f?void 0:f.onEventReceived)){const e=`Event '${c.event.type}' was received for app ${b.manifest.name}, but it hasn't registered an event handler.`;return f_({commandChangeReportingService:a,correlation:S,errorMessage:e,logger:y}),Promise.resolve(void 0)}const k=function(e,t,n,i,a,o,r,{viewEntitiesRef:s,viewEntity:l}={},c){var d,u,m;const g=s&&EC(s);return{client:e,clientPreferences:t.getAllPreferences(),coreSettings:n,loggerFactory:i,scenarioFactory:a,userBiService:o,executionContext:{viewEntities:{endEntity:null===(d=null==s?void 0:s.current)||void 0===d?void 0:d.endEntity,mainEntity:null===(u=null==s?void 0:s.current)||void 0===u?void 0:u.mainEntity},viewEntity:l,isHandlingAppActiveApp:!!g&&(null===(m=r.getApp({entityType:g.type}))||void 0===m?void 0:m.manifest.id)===c}}}(t,n,l,m,p,v,e,u,b.manifest.id);let w;try{const n={eventInput:c,requestContext:k};h_({correlation:S,commandChangeReportingService:a,type:wC.B.BeforeOnEventReceived});const{navigationalReactiveValues:o,nonNavigationalReactiveValues:r}=e.getAppViewStateForWindow(h||he.ew,b.manifest.id)||{};let s=!1,l={};o&&(l=Object.keys(o).reduce(((e,t)=>{const n=o[t];return Object.assign(Object.assign({},e),{[t]:{read:n.read,update:e=>{e!==n.read()&&(n.update(e),s=!0)}}})}),{}));const d=(l||r)&&Object.assign(Object.assign({},l),r);w=yield(({sourceApp:e,reactiveValues:t,hookOptions:n,notificationsHandler:a,windowId:o})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;let r;if(!(null===(i=e.eventHandlers)||void 0===i?void 0:i.onEventReceived))return Promise.resolve(void 0);if(TC(e)&&IC(e)){if(t){const i=Object.assign(Object.assign({},n),{appViewState:t,windowId:o});r=yield e.eventHandlers.onEventReceived(i)}}else if(TC(e)){if(t){const i=Object.assign(Object.assign({},n),{appViewState:t});r=yield e.eventHandlers.onEventReceived(i)}}else if(IC(e)){const t=Object.assign(Object.assign({},n),{windowId:o});r=yield e.eventHandlers.onEventReceived(t)}else if(NC(e)&&a){const t=Object.assign(Object.assign({},n),{notificationsHandler:a});r=yield e.eventHandlers.onEventReceived(t)}else r=yield e.eventHandlers.onEventReceived(n);return Promise.resolve(r)})))({sourceApp:b,reactiveValues:d,hookOptions:n,notificationsHandler:g,windowId:h}),s&&(t.mutate({mutation:g_.E,variables:{windowId:h,appIds:[b.manifest.id]}}).catch((e=>{y.warn(`saveReactiveVarToHistory mutation failed ${e.message}`)})),s=!1),h_({correlation:S,commandChangeReportingService:a,type:wC.B.AfterOnEventReceived})}catch(e){const t=`Event '${c.event.type}' encountered an error inside onEventReceived of ${b.manifest.name}.`;return f_({commandChangeReportingService:a,correlation:S,errorMessage:t,logger:y}),Promise.reject(e)}if(!w)return h_({correlation:S,commandChangeReportingService:a,type:wC.B.EventHandled}),Promise.resolve(void 0);const C=Object.assign(Object.assign({},w),{correlation:S});return o(C,r)}));var b_=n(284442);const S_="DeepLink:: ";var k_,w_;!function(e){e.DecodeURIComponentFailed="DecodeURIComponentFailed",e.DeeplinkNotHandledByRegisteredApps="DeeplinkNotHandledByRegisteredApps",e.DeeplinkTerminatedByApp="DeeplinkTerminatedByApp",e.ExecuteFromUrlFailed="ExecuteFromUrlFailed",e.IntentServiceExecutionFailed="IntentServiceExecutionFailed",e.InvalidDeepLinkUrl="InvalidDeepLinkUrl",e.OnBeforeDeeplinkParsedFailed="OnBeforeDeeplinkParsedFailed",e.ToNavigationIntentFailed="ToNavigationIntentFailed",e.InvalidOrigin="InvalidOrigin"}(k_||(k_={})),function(e){e.NavigationIntentNotFound="NavigationIntentNotFound"}(w_||(w_={}));var C_=n(343087),__=n(499679);const T_="https://teams.microsoft.com/l",I_="/task/",E_="/stage/",N_="/entity/",A_="context",F_="application/vnd.microsoft.card.adaptive",D_=(e,t,n)=>{const i=e=>null==n?void 0:n(e);return e.executeCommand(t.entity,{entityCommand:t.command,entityOptions:t.entityOptions}).subscribe({complete:i,error:i}),Promise.resolve()},R_=(e,t,n,i,a,o)=>{const r=e.executeCommand(t.entity,{entityCommand:t.command,entityOptions:t.entityOptions}),s=n.newScenario(it.RG.ExtTaskModuleLaunch),l=C_.gV.DeepLink;return r.subscribe({complete:()=>{i.log(`task module complete for entrypoint ${l}`),s.stop(O_(a,l)),o&&o()},error:e=>{i.error(`error launching task module for entry point ${l}.  Error:`,e),s.fail(O_(a,l,e)),o&&o(e)},next:e=>{e.containerState===d.oq.Open&&s.stop(O_(a,l))}}),Promise.resolve()},x_=(e,t)=>{const n=new URL(e).pathname.split("/");if(n.length===t){const[,,e,t,i]=n;return!(!e||!t)}return!1},M_=e=>!(!e||!e.startsWith(T_)),O_=(e,t,n)=>{const i={};return e&&(i["App.Id"]=e),t&&(i["App.EntryPoint"]=C_.gV[t]),n&&(i.errors=n),i},P_=(e,t)=>{if(!t)throw new Error("Could not find app context");switch(e.type){case u.p.extensions:return Object.assign(Object.assign({},t),{type:__.p.tab});case u.p.channels:return Object.assign(Object.assign({},t),{type:__.p.channel});case u.p.chats:return Object.assign(Object.assign({},t),{type:__.p.chat});default:throw new Error("unsupported launch context")}},L_=e=>!!e&&"0"!==e,U_=e=>e?JSON.parse(e):{},j_=(e,t)=>{switch(e&&e.type){case u.p.extensions:return W_(e);case u.p.chats:return{chatId:e.id||""};case u.p.channels:{const{channelId:n,replyChainId:i}=U_(e.id);return{channelId:n,parentMessageId:i,chatId:B_(i,n,t),meetingId:$_(n,i),channelMeetingMessageId:i}}default:return}},$_=(e,t)=>{if(e){const n=e.split(";")[0];return L_(t)?btoa(`0#${n}#${t}`):btoa(`0#${n}#0`)}return""},B_=(e,t,n)=>L_(e)&&n?t.includes("messageid")?t:`${t};messageid=${e}`:t,W_=e=>{if(e.linkedEntity)switch(e.linkedEntity.type){case u.p.chats:return{chatId:e.linkedEntity.id};case u.p.channels:{const{channelId:t,replyChainId:n}=U_(e.linkedEntity.id);return{channelId:t,parentMessageId:n,channelMeetingMessageId:n}}case u.p.extensions:return e.linkedEntity.id?JSON.parse(e.linkedEntity.id):void 0}},H_=(e,t)=>{const n=e.search.indexOf("=")+1,i=e.search.substring(n)||"",a=decodeURIComponent(i),{contentUrl:o,websiteUrl:r,removeUrl:s,name:l}=JSON.parse(a);return{type:"tab/tabInfoAction",tabInfo:{contentUrl:o,websiteUrl:r,removeUrl:s,name:l,entityId:t}}},V_=e=>{const t=e.search.indexOf("?")+1;return(e.search.substring(t)||"").split("&").reduce(((e,t)=>{const[n,i]=t.split("="),o=decodeURIComponent(i);return Object.assign(Object.assign({},e),{[n]:(0,a.isString)(n)&&"card"===n.toLowerCase()?z_(o):o})}),{})},z_=e=>{try{const t=JSON.parse(e),n=(0,a.isString)(t.contentType)&&t.contentType.toLowerCase()===F_.toLowerCase(),i=(0,a.isString)(t.type)&&"adaptivecard"===t.type.toLowerCase();return n?{content:JSON.stringify(t.content),contentType:t.contentType}:i?{content:e,contentType:F_}:null}catch(e){return null}};class q_{constructor(e,t,n,i,a,o,r,s,l,c){this.host=e,this.commandHandler=t,this.extensionCommandingService=n,this.scenarioFactory=i,this.deeplinkService=o,this.coreSettings=r,this.userContextId=s,this.sourceViewEntity=l,this.clientLaunchId=c,this.logger=a.newLogger("DeepLinkCommandingService","core-services-entity-commanding")}checkForPendingDeeplink(e,t){return this.deeplinkService.checkForPendingIntent(e,this.clientLaunchId,null!=t?t:this.userContextId)}launchMainApp(e,t){return this.deeplinkService.launchMainApp(e,this.clientLaunchId,t)}switchAccount(e,t,n,i){return this.deeplinkService.switchAccount(e,t,this.clientLaunchId,n,i)}prewarmFlyout(e){return this.deeplinkService.prewarmFlyout(e)}executeFromUrlV2(e,t,n,a){var o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.allowV2Flow(e))return!1;try{return yield this.deeplinkService.executeFromUrlAsync(e,t,n,this.clientLaunchId,this.userContextId,this.sourceViewEntity,a)}catch(e){const t=`DeepLinkCommanding:: ${k_.ExecuteFromUrlFailed} ${(0,wi.u4)(e)}`;throw null===(r=(o=this.logger).errorToTelemetry)||void 0===r||r.call(o,t,"webclient_framework_foundation_core_services_deeplink",void 0,!0),new Error(t)}}))}executeDeepLinkFromUrl(e,t,n,a,o){var r,s,l,c;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=!!(null===(r=this.coreSettings.get(L.J.Core))||void 0===r?void 0:r.handleInternalDeepLinks),d=!!(null===(s=this.coreSettings.get(L.J.Extensibility))||void 0===s?void 0:s.enableChatIdChangeInGetContextCall);try{if(yield this.executeFromUrlV2(e,n,void 0,o))return}catch(e){null===(c=(l=this.logger).errorToTelemetry)||void 0===c||c.call(l,null==e?void 0:e.message,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}const m=this.createEntityCommandFromDeepLink(e,t,d);return m?((e,t,n,i,a,o,r)=>{switch(e.entity.type){case u.p.taskmodule:const s=new URL(t),[,,,l]=s.pathname.split("/");return R_(i,e,o,a,l,r);case u.p.platformStage:return D_(i,e,r);default:return n(e)}})(m,e,this.commandHandler,this.extensionCommandingService,this.logger,this.scenarioFactory,a):i?void this.host.open(e):this.host.opener.open(b_.B.OpenOnMainRenderer,b_._.DeepLink,{url:e})}))}executeIntent(e){return this.deeplinkService.executeIntent(e)}createEntityCommandFromDeepLink(e,t,n){return x_(e,4)&&(e=>{if(M_(e))return e.substr(T_.length).toLowerCase().substring(0,I_.length)===I_;return!1})(e)?((e,t,n)=>{const i=(0,Ye.v4)(),a=new URL(e),[,,,o]=a.pathname.split("/"),r={entryPoint:C_.gV.DeepLink,appId:o,taskInfo:V_(new URL(e))};return{entity:{id:i,type:u.p.taskmodule,action:u.u.create},command:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:kt.D.ExtensionCommanding}},entityOptions:{input:r,launchContext:P_(t,j_(t,n))}}})(e,t,n):(e=>x_(e,5))(e)&&(e=>!!M_(e)&&e.substr(T_.length).toLowerCase().substring(0,E_.length)===E_)(e)?(e=>{try{const t=new URL(e),[,,,n]=t.pathname.split("/"),i=(0,Ye.v4)();return{entity:{id:i,type:u.p.platformStage,action:u.u.view},command:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:kt.D.ExtensionCommanding}},entityOptions:{appId:n,tabInfo:JSON.stringify(H_(t,i))}}}catch(e){return null}})(e):null}allowV2Flow(e){var t,n;return!!(this.coreSettings.get(L.J.Extensibility).handleDeepLinkToMeetingSidePanel&&(e=>{if(!x_(e,5))return!1;const{searchParams:t}=new URL(e),n=t.has(A_)&&t.get(A_);if(!n)return!1;try{const e=JSON.parse(decodeURIComponent(n));return!(!e||!e.chatId||"chat"!==e.contextType&&"meeting"!==e.contextType||"false"===t.get("openInMeeting"))}catch(e){return!1}})(e)&&(n=e,M_(n)&&n.substring(T_.length).toLowerCase().substring(0,N_.length)===N_))||!!(null===(t=this.coreSettings.get(L.J.Core))||void 0===t?void 0:t.handleInternalDeepLinks)}}var G_=n(816195),J_=n(502302),Q_=n(398071),K_=n(809868),Y_=n(337036);const X_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesEntityCommandingActiveWindowContainerStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}}]}}]},Z_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowBlockingExtension"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"blockingEntityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]},eT={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addBlockingExtension"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"removeBlock"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addBlockingExtension"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}},{kind:"Argument",name:{kind:"Name",value:"removeBlock"},value:{kind:"Variable",name:{kind:"Name",value:"removeBlock"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class tT{constructor(e,t,n,i,a){this.commandHandler=e,this.client=t,this.windowId=n,this.scenarioFactory=i,this.onDestroy=new K_.xQ,this.logger=a.newLogger("ExtensionCommandingService","core-services-entity-commanding")}destroy(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{this.onDestroy.next(),this.reset()}catch(e){this.logger.warn(`Unable to destroy, error ocurred in persisting delete of extension entity. e.name: ${e.name}, e.message: ${e.message}`)}}))}executeCommand(e,t){const n=(null==t?void 0:t.entityCommand)||{stateTransition:d.su.none,visibilityState:d.fe.show,correlation:{source:kt.D.ExtensionCommanding}};n.stateTransition=d.su.extend;const i={entity:e,command:n,entityOptions:null==t?void 0:t.entityOptions};return this.processRequest(i)}addBlockingExtension(e,t,n=!1){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!n&&(yield this.isWindowBlocked()))return void this.logger.log("Window is currently blocked, addBlockingExtension no-op");this.logger.log(`addBlockingExtension, requesting an extension of type ${e.type} to block the window`);const i={entity:e,entityOptions:JSON.stringify(t),windowId:this.windowId,removeBlock:n};yield this.client.mutate({mutation:eT,variables:i})}))}isWindowBlocked(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{data:e}=yield this.client.query({query:Z_,variables:{windowId:this.windowId}});return!!e.activeWindow.blockingEntityExtension}))}pipeWhileStateIsValid(e){return e.pipe((0,G_.R)(this.onDestroy),(0,J_.o)((e=>e.hasEntityExtension),!0),(0,Q_.G)(),(0,J_.o)((([e,t])=>{const n=t.containerState,i=t.hasEntityExtension,a=e.containerState,o=n===d.oq.Confirmed,r=n===d.oq.Cancelled,s=n===d.oq.Error,l=n===d.oq.Closed,c=a===d.oq.Open;return i&&!o&&!r&&!s&&!(c&&l)}),!0),(0,Lw.U)((([,e])=>({containerState:e.containerState}))))}processRequest(e){this.scenarioFactory.newScenario(it.RG.ExtensionOpen);const t=this.observeContainerState(this.client,this.windowId),n=this.pipeWhileStateIsValid(t);this.commandHandler(e).then((()=>{n.subscribe({next:e=>{this.stopActiveScenario(e.containerState),this.nextSubscriber(e),e.containerState===d.oq.Error&&this.resetSubscriber((0,An.Tr)("ExtensionCommanding",he.jK.Unknown,`ExtendedContainerState ${e.containerState}`,void 0,"Error processing entity extension"))},complete:()=>{this.resetSubscriber()},error:e=>{this.resetSubscriber(e)}})})).catch((e=>{this.resetSubscriber(e)}));return new Y_.y((e=>{this.subscriber=e}))}nextSubscriber(e){this.subscriber&&this.subscriber.next(e)}resetSubscriber(e){const t=this.subscriber;this.reset(),e?(this.failActiveScenarios(),t&&t.error(e)):(this.stopActiveScenarios(),t&&t.complete())}reset(){this.subscriber=void 0}stopActiveScenarios(){var e,t;null===(e=this.scenarioFactory.findScenario(it.RG.ExtensionClose))||void 0===e||e.stop(),null===(t=this.scenarioFactory.findScenario(it.RG.ExtensionOpen))||void 0===t||t.stop()}failActiveScenarios(){var e,t;null===(e=this.scenarioFactory.findScenario(it.RG.ExtensionClose))||void 0===e||e.fail(),null===(t=this.scenarioFactory.findScenario(it.RG.ExtensionOpen))||void 0===t||t.fail()}stopActiveScenario(e){switch(e){case d.oq.Error:this.failActiveScenarios();break;case d.oq.Open:case d.oq.Closed:case d.oq.Cancelled:case d.oq.Confirmed:this.stopActiveScenarios();break;default:this.logger.errorToTelemetry&&this.logger.errorToTelemetry(`Unable to stop active scenario, no case mapped to container state provided: ${e}`,"webclient_framework_foundation_core_services_extension_commanding",void 0,!0)}}observeContainerState(e,t){return(0,aC.G)(this.watchActiveWindow(e,t)).pipe((0,Lw.U)((({data:e})=>{var t;return{containerState:e.activeWindow.extendedEntityContainerState.containerState,hasEntityExtension:!!(null===(t=e.activeWindow.activeEntities.entityExtension)||void 0===t?void 0:t.type)}})))}watchActiveWindow(e,t){return e.watchQuery({query:X_,variables:{windowId:t}})}}const nT=({appsRegistryService:e,client:t,commandChangeReportingService:n,coreSettings:a,entityCommandInput:o,executionContext:r,loggerFactory:s,platformService:l,scenarioFactory:c,windowId:m,clientLaunchId:g,windowProvider:p,userBiService:v,notificationsHandler:h})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var f,y;const b=s.newLogger("internalCommandHandler","core-services-entity-commanding"),S=null!==(y=null===(f=o.command)||void 0===f?void 0:f.__UNSAFE_windowId)&&void 0!==y?y:m;S!==m&&b.log(`window id overridden to ${S}`);let k=xC(function(e){const t=e.command||MC({stateTransition:d.su.none,visibilityState:d.fe.show,correlation:{source:kt.D.Unknown}});return Object.assign(Object.assign({},e),{command:t})}(o));const w=function(e,t){var n;return t&&e.getApp({entityType:null===(n=t.viewEntity)||void 0===n?void 0:n.type})}(e,r),C=function(e,t){return e.getApp({entityType:t.entity.type})}(e,k);!function({commandChangeReportingService:e,entityCommand:t,logger:n,sourceApp:i,renderingApp:a,coreSettings:o}){t.entity.type===u.p.default&&(t.command.correlation.scenarioName=it.RG.DefaultCommand),i&&RC({appName:i.manifest.name,commandChangeReportingService:e,entityCommand:t,getCommandScenarioName:i.getCommandScenarioNameFromSource,logger:n,coreSettings:o}),a&&RC({appName:a.manifest.name,commandChangeReportingService:e,entityCommand:t,getCommandScenarioName:a.getCommandScenarioName,logger:n,coreSettings:o})}({commandChangeReportingService:n,entityCommand:k,renderingApp:C,sourceApp:w,logger:b,coreSettings:a});const _=k.command.correlation.id;if(function({commandChangeReportingService:e,entityCommand:t,executionContextEntity:n}){const i=t.command.correlation.id;e.report({type:wC.B.CommandStart,correlationId:i,context:{target:"internal-command-handler",entityCommand:t,executionContextEntity:n}})}({commandChangeReportingService:n,entityCommand:k,executionContextEntity:null==r?void 0:r.viewEntity}),C){const e=function(e,t,n,i,a,o){return{client:e,coreSettings:t,loggerFactory:n,platformService:i,scenarioFactory:a,userBiService:o}}(t,a,s,l,c,v),o=p||void 0;k=yield function({app:e,commandChangeReportingService:t,entityCommand:n,hookRequestContext:a,logger:o,windowProvider:r,notificationsHandler:s}){var l;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i=n;if(e.onBeforeCommandHandled){const c=n.command.correlation,d=c.id,u="internal-command-handler-execute-before-command-handled-hook";t.report({type:wC.B.ApplicationHookReceivedCommand,context:{target:u},correlationId:d});try{const t={entityCommand:n,requestContext:a,windowProvider:r||void 0,notificationsHandler:NC(e)&&s?s:void 0};i=yield e.onBeforeCommandHandled(t)}catch(n){const i=`Command 'onBeforeCommandHandled' rejected. An attempt to handle the command was made by app:${e.manifest.name}, but failed. Error: ${(0,la.A)((0,An.VK)(n))}`;return null===(l=o.errorToTelemetry)||void 0===l||l.call(o,i,"webclient_framework_foundation_core_services_internal_command_handler",void 0,!0),t.report({type:wC.B.Failure,context:{errorInfo:CC.y.OnBeforeCommandHandledRejected,errorMessage:i,target:u},correlationId:d}),Promise.reject(n)}void 0!==i&&(t.report({type:wC.B.ApplicationHookContinuedCommand,context:{target:u},correlationId:d}),i.command.correlation=c,t.report({type:wC.B.CommandStart,correlationId:d,context:{target:u,entityCommand:i}}))}return Promise.resolve(i)}))}({app:C,commandChangeReportingService:n,entityCommand:k,hookRequestContext:e,logger:b,windowProvider:o,notificationsHandler:h})}return k?function({entityCommand:e,mutateContext:{client:t,executionContext:n,windowId:i,clientLaunchId:a}}){return t.mutate({mutation:AC,variables:Object.assign(Object.assign({},e),{entityOptions:JSON.stringify(e.entityOptions),executionContext:n,windowId:i,clientLaunchId:a}),fetchPolicy:"no-cache"}).then((e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.executeEntityCommand)||void 0===n?void 0:n.id}))}({entityCommand:k,mutateContext:{client:t,executionContext:r,windowId:S,clientLaunchId:g}}):(n.report({type:wC.B.CommandHandledPriorToResolution,context:{target:"internal-command-handler"},correlationId:_}),Promise.resolve(void 0))}));var iT=n(141330);class aT{constructor(e){this.commandHandler=e}trigger(e){return this.commandHandler({entity:rT(e.entity),command:dT(e.command)})}}const oT=e=>{switch(e){case iT.uk.view:return u.u.view;case iT.uk.list:return u.u.list;case iT.uk.default:return u.u.default;default:throw(0,An.Tr)(he.w5.Commanding,he.jK.NotImplemented,"Nova",void 0,`Mapping for Nova action type ${e} not implemented in Teams!`)}},rT=e=>{switch(e.type){case iT.py.identity:return sT(e);case iT.py.teams_chat:return{type:u.p.chats,id:e.entityId,action:oT(e.action)};case iT.py.teams_channel:return{type:u.p.channels,id:e.entityId,action:oT(e.action)};case iT.py.office_home:return{type:u.p.communitiesonboarding,id:e.entityId,action:oT(e.action)};case iT.py.office_people:return{type:u.p.homepage,id:e.entityId,action:oT(e.action)};case iT.py.teams_activity:return{type:u.p.activity,id:e.entityId,action:oT(e.action)};case iT.py.teams_calendar:return{type:u.p.calendar,id:e.entityId,action:oT(e.action)};case iT.py.teams_meet:return{type:u.p.meet,id:e.entityId,action:oT(e.action)};case iT.py.m365_app:return{type:u.p.extensions,id:e.entityId,action:oT(e.action)};case iT.py.teams_calling:return{type:u.p.callsmain,id:e.entityId,action:u.u.view};default:throw(0,An.Tr)(he.w5.Commanding,he.jK.NotImplemented,"Nova",void 0,`Mapping for Nova entity type ${e.type} not implemented in Teams!`)}},sT=e=>{switch(e.action){case iT.uk.signout:return{type:u.p.signoutdialog,id:e.entityId,action:u.u.view};case iT.uk.updateProfilePicture:return{type:u.p.updatemsaprofileavatardialog,id:e.entityId,action:u.u.view};case iT.uk.updateDisplayName:return{type:u.p.updatemsaprofilenamedialog,id:e.entityId,action:u.u.view};default:throw(0,An.Tr)(he.w5.Commanding,he.jK.NotImplemented,"Nova",void 0,`Mapping for Nova identity entity with action type ${e.action} not implemented in Teams!`)}},lT=e=>{switch(e){case iT.fe.hide:return d.fe.hide;case iT.fe.show:return d.fe.show;case iT.fe.toggle:return d.fe.toggle}},cT=e=>{switch(e){case iT.su.extend:return d.su.extend;case iT.su.flush:return d.su.flush;case iT.su.forceFlush:return d.su.forceFlush;case iT.su.new:return d.su.new;case iT.su.none:return d.su.none}},dT=e=>({visibilityState:lT(e.visibilityState),stateTransition:cT(e.stateTransition),correlation:{source:kt.D.Nova}});var uT,mT=n(961086),gT=n(109309),pT=n(187203);class vT{constructor(e,t,n,i,a,o,r){this.commandHandler=e,this.extensionCommanding=t,this.hostCommunicationService=n,this.windowId=i,this.host=a,this.coreSettings=o,this._logger=r.newLogger("ShellCommandingService","core-services-entity-commanding")}activeCallDialog(e){return this.extensionCommanding.executeCommand({type:u.p.activecalldialog,action:u.u.view},{entityCommand:e})}bringWindowToFront(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("osutils");return this._logger.log(`Performing action: bringWindowToFront on ${e}`),(null===(t=null==n?void 0:n.bringWindowToFront)||void 0===t?void 0:t.call(n,e))||Promise.resolve(!1)}))}desktopNotice(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("osutils");return this._logger.log("Performing action: desktopNotice"),null===(e=null==t?void 0:t.openThirdPartyNotice)||void 0===e?void 0:e.call(t)}))}dismissBanner(e,t=kt.D.Unknown){return this.dismissNotification(e,u.p.bannerNotification,t)}dismissToast(e,t=kt.D.Unknown){return this.dismissNotification(e,u.p.inAppToast,t)}executeNotificationAction(e,t,n,i,a){var o,r;let s;try{s=JSON.parse(i)}catch(e){return null===(r=(o=this._logger).errorNoPii)||void 0===r||r.call(o,`Notification command can't be parsed: ${i}`),Promise.resolve()}return a?this.dismissNotification(e,t,n):t===u.p.bannerNotification&&(s.entityOptions=Object.assign(Object.assign({},s.entityOptions),{bannerId:e})),this.commandHandler(s)}installAndLaunchT1(){var e,t,n,a,o,r,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("appswitcher"),l=yield null===(e=null==i?void 0:i.downloadAndInstallPearApp)||void 0===e?void 0:e.call(i,mT.OP.Teams1);switch(null==l?void 0:l.status){case mT.cw.DownloadedAndInstalled:yield this.launchT1AndQuitT2(!0),this._logger.log("T1 is downloaded and installed");break;case mT.cw.FailedToDownload:null===(n=(t=this._logger).errorNoPii)||void 0===n||n.call(t,`T1 failed to download: ${null==l?void 0:l.errorMessage}`);break;case mT.cw.FailedToInstall:null===(o=(a=this._logger).errorNoPii)||void 0===o||o.call(a,`T1 failed to install: ${null==l?void 0:l.errorMessage}`);break;default:null===(s=(r=this._logger).errorNoPii)||void 0===s||s.call(r,`T1 download and install failed: ${null==l?void 0:l.errorMessage}`)}}))}joinLinkDialog(e){return this.extensionCommanding.executeCommand({type:u.p.joinlinkdialog,action:u.u.view},{entityCommand:e})}launchT1AndQuitT2(e,t){var n,a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("appswitcher");e&&(this._logger.log("launchT1AndQuitT2, Switcher default app to T1"),yield null===(n=null==i?void 0:i.switchDefaultAppTo)||void 0===n?void 0:n.call(i,mT.OP.Teams1)),this._logger.log("launchT1AndQuitT2, launch T1"),yield null===(a=null==i?void 0:i.launchPearApp)||void 0===a?void 0:a.call(i,mT.OP.Teams1,t),this._logger.log("Flushing T2 telemetry events"),yield(0,pT.G)().flush(),this._logger.log("launchT1AndQuitT2, quit T2"),yield null===(o=null==i?void 0:i.quitApp)||void 0===o?void 0:o.call(i)}))}setWindowControlsTheme(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(t=null==n?void 0:n.setCustomFrameOptions)||void 0===t?void 0:t.call(n,this.windowId,{titleBarMode:gT.i$.ButtonsOnly,theme:e})}))}maximizeWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(L.J.Core).routeWindowActionsThroughHostComms)return this.host.maximize();const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: maximizeWindow on ${this.windowId}`),null===(e=null==t?void 0:t.maximize)||void 0===e?void 0:e.call(t,this.windowId)}))}minimizeWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(L.J.Core).routeWindowActionsThroughHostComms)return this.host.minimize();const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: maximizeWindow on ${this.windowId}`),null===(e=null==t?void 0:t.minimize)||void 0===e?void 0:e.call(t,this.windowId)}))}msaProfileAvatarUpdateDialog(e){return this.extensionCommanding.executeCommand({type:u.p.updatemsaprofileavatardialog,action:u.u.view},{entityCommand:e})}msaProfileNameUpdateDialog(e){return this.extensionCommanding.executeCommand({type:u.p.updatemsaprofilenamedialog,action:u.u.view},{entityCommand:e})}noticeDialog(e){return this.extensionCommanding.executeCommand({type:u.p.tpndialog,action:u.u.view},{entityCommand:e})}openFreDialog(e){return this.extensionCommanding.executeCommand({type:u.p.officeintegrationfredialog,action:u.u.info},{entityCommand:e})}restoreWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: restoreWindow on ${this.windowId}`),null===(e=null==t?void 0:t.restore)||void 0===e?void 0:e.call(t,this.windowId)}))}setMinimumWindowSize(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(n=null==i?void 0:i.setMinimumWindowSize)||void 0===n?void 0:n.call(i,this.windowId,e,t)}))}setWindowBounds(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(o=null==i?void 0:i.setWindowBounds)||void 0===o?void 0:o.call(i,this.windowId,e,t,n,a)}))}showContextMenu(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: showContextMenu on ${this.windowId} and position ${e}`),null===(t=null==n?void 0:n.showTitleBarContextMenu)||void 0===t?void 0:t.call(n,this.windowId,e)}))}showBanner(e){var{id:t,dismissable:n=!0,duration:a=4,source:o=kt.D.Unknown}=e,r=(0,i.__rest)(e,["id","dismissable","duration","source"]);return this.commandHandler({command:{correlation:{source:o},stateTransition:d.su.none,visibilityState:d.fe.show},entity:{type:u.p.bannerNotification,action:u.u.create,id:t},entityOptions:Object.assign(Object.assign({},r),{dismissable:n,duration:a})})}showToast(e){var{id:t,duration:n=7e3,source:a=kt.D.Unknown}=e,o=(0,i.__rest)(e,["id","duration","source"]);return this.commandHandler({command:{correlation:{source:a},stateTransition:d.su.none,visibilityState:d.fe.show},entity:{type:u.p.inAppToast,action:u.u.create,id:t},entityOptions:Object.assign(Object.assign({},o),{duration:n})})}signOutDialog(e){return this.extensionCommanding.executeCommand({type:u.p.signoutdialog,action:u.u.view},{entityCommand:e})}startWindowDragListener(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: startWindowDragListener on ${this.windowId}`),null===(e=null==t?void 0:t.startWindowDragListener)||void 0===e?void 0:e.call(t,this.windowId)}))}swapMeetingRoomFrontOfRoomWindows(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log("Performing action: swapMeetingRoomFrontOfRoomWindows"),null===(e=null==t?void 0:t.swapMeetingRoomFrontOfRoomWindows)||void 0===e?void 0:e.call(t)}))}switchDefaultAppTo(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("appswitcher");this._logger.log(`switchDefaultAppTo ${e}`),yield null===(t=null==n?void 0:n.switchDefaultAppTo)||void 0===t?void 0:t.call(n,e)}))}zoomInWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomInWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomIn)||void 0===e?void 0:e.call(t,this.windowId)}))}zoomOutWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomOutWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomOut)||void 0===e?void 0:e.call(t,this.windowId)}))}zoomResetWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomResetWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomReset)||void 0===e?void 0:e.call(t,this.windowId)}))}getScreenshots(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: getScreenshots on ${this.windowId}`),null===(n=null==i?void 0:i.getScreenshots)||void 0===n?void 0:n.call(i,e,t)}))}dismissNotification(e,t,n=kt.D.Unknown){return this.commandHandler({command:{correlation:{source:n},stateTransition:d.su.none,visibilityState:d.fe.hide},entity:{type:t,action:u.u.delete,id:e}})}}!function(e){e.unknown="unknown",e.toast="toast",e.activity="activity"}(uT||(uT={}));var hT=n(974630);class fT{constructor(e,t){this.commandHandler=e,this.userContextId=t}showMessage(e,{collectionId:t,conversationId:n,mainImage:i,discardDuringMeetingsAndCalls:a,messageId:o,quickReply:r,quickReplyButton:s,quickReplyPlaceholder:l,text:c,time:m,title:g,isUrgent:p}){const v={collectionId:t,isUrgent:p,mainImage:i,discardDuringMeetingsAndCalls:a,targetEntity:{action:Wn.view,dataOptions:{actionType:er.view,messageId:o,userContextId:this.userContextId},id:n,type:$n.chats},textInput:r?yT(n,s,l,this.userContextId):void 0,text:c,time:m,title:g},h={command:{correlation:{id:e,source:kt.D.Notifications,startTimestamp:m.valueOf()},stateTransition:d.su.new,visibilityState:d.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:v};return this.commandHandler(h)}showReminder(e,{collectionId:t,conversationId:n,mainImage:i,messageId:a,text:o,time:r,title:s,buttonText:l,type:c}){const m={collectionId:t,mainImage:i,targetEntity:{action:Wn.view,dataOptions:{actionType:er.view,messageId:a,userContextId:this.userContextId,toastType:c},id:n,type:$n.reminders},textInput:void 0,text:o,time:r,title:s,buttons:[{targetEntity:{action:Wn.view,dataOptions:{actionType:er.view,messageId:a,userContextId:this.userContextId},id:n,type:$n.reminders},text:l}]},g={command:{correlation:{id:e,source:kt.D.Notifications,startTimestamp:r.valueOf()},stateTransition:d.su.new,visibilityState:d.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:m};return this.commandHandler(g)}showChatTabEntityNotification(e,{collectionId:t,conversationId:n,mainImage:i,tabId:a,text:o,time:r,title:s}){const l={collectionId:t,mainImage:i,targetEntity:{id:a,type:$n.extensions,action:Wn.view,dataOptions:{actionType:er.unknown,userContextId:this.userContextId},linkedEntity:{id:n,action:Wn.view,type:$n.chats}},text:o,time:r,title:s},c={command:{correlation:{id:e,source:kt.D.Notifications,startTimestamp:r.valueOf()},stateTransition:d.su.flush,visibilityState:d.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:l};return this.commandHandler(c)}showChannelsNotification(e,{collectionId:t,conversationId:n,mainImage:i,discardDuringMeetingsAndCalls:a,messageId:o,text:r,time:s,title:l,replyChainId:c}){const m={collectionId:t,mainImage:i,discardDuringMeetingsAndCalls:a,targetEntity:{action:Wn.view,dataOptions:{actionType:er.view,messageId:o,userContextId:this.userContextId,focusOnLoad:ps.t.DoNotMove},id:JSON.stringify({channelId:n,replyChainId:c,deepLinkId:c}),type:$n.channels},text:r,time:s,title:l},g={command:{correlation:{id:e,source:kt.D.Notifications,startTimestamp:s.valueOf()},stateTransition:d.su.new,visibilityState:d.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:m};return this.commandHandler(g)}showCommunitiesNotifications(e,{collectionId:t,conversationId:n,mainImage:i,messageId:a,text:o,time:r,title:s,replyChainId:l,type:c}){const m={collectionId:t,mainImage:i,targetEntity:{action:Wn.view,dataOptions:{actionType:er.view,messageId:a,userContextId:this.userContextId,toastType:c,teamId:n,deepLinkId:a},id:JSON.stringify({channelId:n,replyChainId:l}),type:$n.communities},text:o,time:r,title:s},g={command:{correlation:{id:e,source:kt.D.Notifications,startTimestamp:r.valueOf()},stateTransition:d.su.new,visibilityState:d.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:m};return this.commandHandler(g)}showEspSyntheticNotification(e,{collectionId:t,mainImage:n,text:i,time:a,title:o,campaignType:r}){let s;switch(r){case hT.mL.files:const e="newchat";s={collectionId:t,mainImage:n,targetEntity:{type:$n.chats,action:Wn.view,id:e,dataOptions:{actionType:uT.toast,userContextId:this.userContextId,campaignType:r}},text:i,time:a,title:o};break;default:s={collectionId:t,mainImage:n,targetEntity:{type:$n.campaignnotifications,action:Wn.view,id:r,dataOptions:{actionType:uT.toast,userContextId:this.userContextId}},text:i,time:a,title:o}}const l={command:{correlation:{id:e,source:kt.D.Notifications,startTimestamp:a.valueOf()},stateTransition:d.su.flush,visibilityState:d.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:s};return this.commandHandler(l)}showGraphItemNotification(e,{collectionId:t,mainImage:n,discardDuringMeetingsAndCalls:i,text:a,time:o,title:r}){const s={collectionId:t,mainImage:n,discardDuringMeetingsAndCalls:i,targetEntity:{action:Wn.list,dataOptions:{actionType:er.view,userContextId:this.userContextId,focusOnLoad:ps.t.DeeplinkedMessage},id:"msGraph",type:$n.activity},text:a,time:o,title:r},l={command:{correlation:{id:e,source:kt.D.Notifications,startTimestamp:o.valueOf()},stateTransition:d.su.flush,visibilityState:d.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:s};return this.commandHandler(l)}showReEngageNudge(e,{conversationId:t,text:n,time:i,title:a,type:o}){const r={targetEntity:{action:Wn.view,dataOptions:{actionType:er.view,userContextId:this.userContextId,toastType:o},id:t,type:$n.reminders},textInput:void 0,text:n,time:i,title:a},s={command:{correlation:{id:e,source:kt.D.Notifications,startTimestamp:i.valueOf()},stateTransition:d.su.new,visibilityState:d.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:r};return this.commandHandler(s)}}const yT=(e,t,n,i)=>({placeholderText:n||"Send a quick reply",sendButton:{text:t||"Send",targetEntity:{action:Wn.mutate,type:$n.chats,dataOptions:{actionType:er.quickReply,convId:e,userContextId:i}}}});class bT{constructor(e){this.commandHandler=e}showAccounts(){return this.commandHandler({entity:{type:u.p.accounts,action:u.u.list}})}}class ST{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}default(e){return this.commandHandler({entity:{type:u.p.activity,action:u.u.default},command:e})}empty(e){return this.commandHandler({entity:{type:u.p.activity,action:u.u.empty},command:e})}launchDeleteActivityFeedItemDialog(e){return this.extensionCommanding.executeCommand({type:u.p.activity,action:u.u.delete},{entityCommand:e})}launchActivityErrorDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.activity,action:u.u.error},{entityCommand:t})}openEmptyFeedMainPane(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.activity,action:u.u.empty},command:t,scenarioEventData:n})}}var kT=n(334025);const wT={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataAuthUserAuthStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userAuthState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"reason"}},{kind:"Field",name:{kind:"Name",value:"customError"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"isExpected"}},{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}}]}}]}}]};class CT{constructor(e,t,n,i){this.commandHandler=e,this.extensionCommanding=t,this.deeplinkCommandingService=n,this.client=i}signinPage(e){return this.commandHandler({entity:{type:u.p.identity,action:u.u.default},command:e})}accountList(e){return this.commandHandler({entity:{type:u.p.identity,action:u.u.list},command:e})}switchAccount({correlation:e,userContextId:t,targetEntity:n}){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.client)throw new Error("client missing in switch account commanding");const{data:i}=(yield this.client.query({query:wT,variables:{userContextId:t},context:{correlation:e}}))||{},o=null==i?void 0:i.userAuthState;if(o&&o.state!==C.JEq.Up){let n;if(o.state===C.JEq.UnRedeemed&&(n=u.u.tenantRedemption),o.state===C.JEq.LoginError)switch(null===(a=o.customError)||void 0===a?void 0:a.errorCode){case kT.SM.TenantUnredeemed:n=u.u.tenantRedemption;break;case kT.SM.InteractionRequired:n=u.u.tenantLogin;break;default:n=u.u.error}if(n)return this.commandHandler({entity:{type:u.p.identitydialog,action:n},command:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:e},entityOptions:{correlation:e,userContextId:t,userAuthState:null==i?void 0:i.userAuthState}})}return this.deeplinkCommandingService.switchAccount(e,t,n)}))}signOutDialog(e){return this.extensionCommanding.executeCommand({type:u.p.signoutdialog,action:u.u.view},{entityCommand:e})}smartDeviceSignOutDialog(e){return this.extensionCommanding.executeCommand({type:u.p.smartdevicelogoutdialog,action:u.u.view},{entityCommand:e})}addAccountDialog(e){return this.commandHandler({entity:{type:u.p.identitydialog,action:u.u.create},command:{visibilityState:d.fe.show,stateTransition:d.su.extend,layoutMode:d.lO.focus,correlation:e.correlation},entityOptions:e})}addAccount(e){return this.commandHandler({entity:{type:u.p.identity,action:u.u.create},command:{visibilityState:d.fe.show,stateTransition:d.su.new,layoutMode:d.lO.focus,correlation:e},entityOptions:{correlation:e}})}closeAccountListDialog(e){return this.commandHandler({entity:{type:u.p.identitydialog,action:u.u.create},command:{visibilityState:d.fe.hide,stateTransition:d.su.flush,layoutMode:d.lO.focus,correlation:{source:e}}})}closeAccountLoginDialog(e){return this.commandHandler({entity:{type:u.p.identitydialog,action:u.u.tenantLogin},command:{visibilityState:d.fe.hide,stateTransition:d.su.flush,layoutMode:d.lO.focus,correlation:{source:e}}})}closeAddAccountListWindow(e){return this.commandHandler({entity:{type:u.p.identity,action:u.u.create},command:{visibilityState:d.fe.hide,stateTransition:d.su.flush,layoutMode:d.lO.focus,correlation:{source:e}}})}closeAccountListWindow(e){return this.commandHandler({entity:{id:d.lO.focus,type:u.p.identity,action:u.u.list},command:{visibilityState:d.fe.hide,stateTransition:d.su.flush,layoutMode:d.lO.focus,correlation:{source:e}}})}showAuthEndPage(e,t,n){return this.commandHandler({entity:{type:n?u.p.identitydialog:u.p.identity,action:u.u.error},command:{visibilityState:d.fe.show,stateTransition:n?d.su.extend:d.su.flush,layoutMode:n?d.lO.focus:d.lO.standard,correlation:{source:e}},entityOptions:{error:t.error}})}}class _T{constructor(e){this.commandHandler=e}viewAutoInstallNotification(e,t){return this.commandHandler({entity:{type:u.p.autoinstallnotification,action:u.u.view},command:t,entityOptions:e})}}class TT{constructor(e){this.commandHandler=e}navigateToFaceEnrollment(){return this.commandHandler({entity:{type:u.p.faceenrollment,action:u.u.view},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{startTimestamp:Date.now(),source:kt.D.FaceEnrollmentGetStartedButton}}})}navigateToVoiceEnrollment(){return this.commandHandler({entity:{type:u.p.voiceenrollment,action:u.u.view},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{startTimestamp:Date.now(),source:kt.D.VoiceEnrollmentGetStartedButton}}})}}class IT{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}brbFeedbackDialogInMainWindow(e,t){return this.commandHandler({entity:{type:u.p.brbfeedbackdialog,action:u.u.view},command:e,entityOptions:t})}brbFeedbackDialog(e){return this.extensionCommanding.executeCommand({type:u.p.brbfeedbackdialog,action:u.u.view},{entityCommand:e})}autoBrbConfirmationDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.autobrbconfirmationdialog,action:u.u.view},{entityCommand:e,entityOptions:t})}}class ET{constructor(e){this.commandHandler=e}openBreakoutRooms(e,t){return this.commandHandler({entity:{type:u.p.breakoutrooms,action:u.u.view},entityOptions:t,command:e})}openBreakoutRoomsInChat(e,t){return this.commandHandler({entity:{type:u.p.breakoutrooms,action:u.u.view,linkedEntity:{type:u.p.chats,id:e}},command:t})}showAssignmentDialog(e){return this.showDialog(u.p.breakoutroomsassignment,e)}showAssignmentTypeDialog(e){return this.showDialog(u.p.breakoutroomsassignmenttype,e)}showCreateRoomsDialog(e){return this.showDialog(u.p.breakoutroomscreaterooms,e)}showDeleteRoomDialog(e){return this.showDialog(u.p.breakoutroomsdeleteroom,e)}showDeleteRoomsDialog(e){return this.showDialog(u.p.breakoutroomsdeleterooms,e)}showEditRoomDialog(e){return this.showDialog(u.p.breakoutroomseditroom,e)}showSettingsDialog(e){return this.showDialog(u.p.breakoutroomssettings,e)}showDialog(e,t){return this.commandHandler({entity:{type:e,action:u.u.view},command:{stateTransition:d.su.extend,correlation:{source:kt.D.ExtensionCommanding},visibilityState:t}})}}class NT{constructor(e){this.commandHandler=e}qnaPanelById(e,t){return this.commandHandler({entity:{type:u.p.broadcastqna,action:u.u.view,id:e,linkedEntity:{type:u.p.calls,id:e}},command:t})}broadcastQnaPanelById(e,t){return this.commandHandler({entity:{type:u.p.eventsbroadcastqna,action:u.u.view,id:e,linkedEntity:{type:u.p.calls,id:e}},command:t})}infoPanelById(e,t){return this.commandHandler({entity:{type:u.p.broadcasts,action:u.u.info,id:e,linkedEntity:{type:u.p.calls,id:e}},command:t})}broadcastById(e,t,n){return this.commandHandler({entity:{type:u.p.broadcasts,action:u.u.view,id:e},command:t,entityOptions:n})}broadcastFeedbackById(e,t,n){return this.commandHandler({entity:{type:u.p.broadcastfeedback,action:u.u.view,id:e},command:t,entityOptions:n})}broadcastLeave(e,t,n){return this.commandHandler({entity:{type:u.p.broadcasts,action:u.u.leave,id:e},command:t,entityOptions:n})}joinBroadcastAsAttendee(e){return this.commandHandler(e)}}class AT{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}meetingDetails(e,t,n,i){const a=i||u.p.schedulingform;return this.commandHandler({entity:{type:a,action:u.u.view,id:e},command:t,entityOptions:n})}openCalendarSurface(e,t,n,i){return this.commandHandler({entity:{type:u.p.calendar,action:u.u.view,id:e,linkedEntity:i},command:t,entityOptions:n})}openCalendarAgendaView(e,t,n){return this.commandHandler({entity:{type:u.p.calendar,action:u.u.list,linkedEntity:n},command:e,entityOptions:t})}openChannelCalendarSurface(e,t,n,i){const a={entity:{action:u.u.view,id:e,linkedEntity:i,type:u.p.channelcalendar},command:t,entityOptions:n};return this.commandHandler(a)}openSchedulingFormInMainWindow(e,t,n){return this.commandHandler({entity:{type:u.p.schedulingform,action:u.u.create,id:e},command:t,entityOptions:n})}openBroadcast(e,t,n,i){const a={type:u.p.broadcastliveevent,id:e,action:t};return this.extensionCommanding.executeCommand(a,{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.none,correlation:{source:n}},entityOptions:i})}closeSchedulingForm(e,t,n){return this.commandHandler({entity:e,command:t,entityOptions:n})}showCalendarErrorModal(e){return this.extensionCommanding.executeCommand({type:u.p.calendar,action:u.u.error},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:kt.D.CalendarEventAction}},entityOptions:e})}addBlockingConfirmationDialog(e,t){return this.extensionCommanding.addBlockingExtension({type:u.p.calendar,action:u.u.confirm},e,t)}showConfirmationDialog(e){return this.extensionCommanding.executeCommand({type:u.p.calendar,action:u.u.confirm},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:kt.D.CalendarEventAction}},entityOptions:e})}showShareDialog(e){return this.extensionCommanding.executeCommand({type:u.p.calendar,action:u.u.share},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:kt.D.CalendarEventAction}},entityOptions:e})}showEmbedDialog(e){return this.extensionCommanding.executeCommand({type:u.p.calendar,action:u.u.info},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:kt.D.CalendarEventAction}},entityOptions:e})}openConnectedCalendarDialog(e){return this.extensionCommanding.executeCommand({type:u.p.connectedcalendardialog,action:u.u.view},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:kt.D.CalendarSettings}},entityOptions:e})}openConnectedCalendarSurfaceDialog(e){return this.extensionCommanding.executeCommand({type:u.p.connectedcalendarsurfacedialog,action:u.u.view},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:kt.D.Calendar}},entityOptions:e})}}class FT{constructor(e,t,n){this.commandHandler=e,this.extensionCommanding=t,this.userContextId=n}call(e,t){return this.commandHandler({entity:{type:u.p.calls,action:u.u.list,id:e},command:t})}callDebug(e){return this.commandHandler({entity:{type:u.p.calls,action:u.u.info},command:e})}dialPad(e){return this.commandHandler({entity:{type:u.p.calls,action:u.u.join},command:e})}callById(e,t,n,i,a){let o;return n&&(o={type:u.p.chats,id:n}),a&&(o={type:u.p.callingdeeplink,id:a}),this.commandHandler({entity:{type:i||u.p.calls,action:u.u.view,id:e,linkedEntity:o},command:t})}callStageContentById(e,t){return this.commandHandler({entity:{type:u.p.stagecontent,action:u.u.view},entityOptions:t,command:e})}callList(e){return this.commandHandler({entity:{type:u.p.calls,action:u.u.list},command:e})}deviceSettingsById(e,t,n={useCall:!0}){return this.commandHandler({entity:{type:u.p.devicesettings,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},entityOptions:n,command:t})}callNotification(e,t,n,i){var a;const o=e.entityOptions;return o.targetEntity.dataOptions.userContextId=this.userContextId,null===(a=o.buttons)||void 0===a||a.forEach((e=>{e.targetEntity.dataOptions.userContextId=this.userContextId})),i===C.KRy.Hide?this.commandHandler({entity:{id:t,action:u.u.view,type:u.p.toasts},command:{correlation:{id:n,source:kt.D.Calling},stateTransition:d.su.new,visibilityState:d.fe.hide},entityOptions:o}):this.commandHandler({entity:{action:u.u.view,type:u.p.toasts,id:t},command:e.command,entityOptions:o})}cameraEffectsSettingsById(e,t){return this.commandHandler({entity:{type:u.p.cameraeffects,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},entityOptions:{commandSource:null==t?void 0:t.correlation.source},command:t})}customVideoBackgroundSettingsById(e,t){return this.commandHandler({entity:{type:u.p.videobackgrounds,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}styleMyRoomPanelById(e,t){return this.commandHandler({entity:{type:u.p.stylemyroom,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callRosterById(e,t){return this.commandHandler({entity:{type:u.p.roster,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callDetailsById(e,t,n){return this.commandHandler({entity:{type:u.p.meetingdetails,action:u.u.view,linkedEntity:{type:u.p.calls,id:e},id:e},entityOptions:{didMeetingNotesAutoOpen:n},command:t})}callInfoById(e,t){return this.commandHandler({entity:{type:u.p.calls,action:u.u.info,linkedEntity:{type:u.p.calls,id:e}},command:t})}callNotesById(e,t){return this.commandHandler({entity:{type:u.p.notes,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}transcriptPanelById(e,t){return this.commandHandler({entity:{type:u.p.transcript,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callHealthPanelById(e,t){return this.commandHandler({entity:{type:u.p.calls,action:u.u.health,linkedEntity:{type:u.p.calls,id:e}},command:t})}mediaStreamsPanelById(e,t){return this.commandHandler({entity:{type:u.p.mediastreams,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callBreakoutRoomById(e,t){return this.commandHandler({entity:{type:u.p.breakoutroomspanel,action:u.u.view,linkedEntity:{type:u.p.calls,id:e},id:e},command:t})}callDeeplinkDialog(e){return this.commandHandler({entity:{type:u.p.callingdeeplinkDialog,action:u.u.view},command:e})}createById(e,t,n,i){return this.commandHandler({entity:{id:e,type:t,action:u.u.create},command:n,windowOptions:i})}callMonitorById(e,t,n){return this.commandHandler({entity:{type:u.p.callsmonitor,action:u.u.view},entityOptions:e&&{callingIntentId:e},command:t,windowOptions:n})}callShareMeetingInviteDialogById(e,t,n){return this.extensionCommanding.executeCommand(e,{entityOptions:t,entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:n}}})}callsKeypad(e,t){return this.commandHandler({entity:{type:u.p.callskeypad,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callMeetingOptionsById(e,t){return this.commandHandler({entity:{type:u.p.meetings,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callsTransfer(e,t){return this.commandHandler({entity:{type:u.p.callstransfer,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}contentCameraSetupDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.contentcamerasetup,action:u.u.create},{entityOptions:t,entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.none,correlation:{source:n}}})}startMeetingStream(e,t){return this.extensionCommanding.executeCommand({type:u.p.meetingstream,action:u.u.create},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.none,correlation:{source:e}},entityOptions:t})}stagingRoomStartMeetingConfirmationDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.stagingroomstartmeetingconfirmationdialog,action:u.u.create},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:t}},entityOptions:n})}openDialog(e,t,n){return this.extensionCommanding.executeCommand(e,{entityOptions:n,entityCommand:t})}callableChannelById(e,t,n){return this.commandHandler({entity:{id:t,type:u.p.callablechannels,action:u.u.list,linkedEntity:{id:e,type:u.p.channels,action:u.u.view}},command:n})}toggleRoomRemote(e,t,n){return this.commandHandler({entity:{type:u.p.roomremote,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},entityOptions:n,command:t})}accessibilityPanelById(e,t){return this.commandHandler({entity:{type:u.p.accessibilitypanel,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}closedCaptionsSettingsPanelById(e,t,n={allowTranslatedCaptions:!1}){return this.commandHandler({entity:{type:u.p.closedcaptionssettings,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},entityOptions:n,command:t})}openCopilot(e,t,n){return this.commandHandler({entity:{type:u.p.meetingcollaboration,action:u.u.view,id:t||e.callId,linkedEntity:{type:u.p.calls,id:t||e.callId}},entityOptions:e,command:n})}presenterToolbarById(e,t){return this.commandHandler({entity:{type:u.p.presentertoolbar,action:u.u.view},entityOptions:e&&{callingIntentId:e},command:t})}pstnCallMeDialogToggle(e,t,n){return this.extensionCommanding.executeCommand(e,{entityOptions:n,entityCommand:t})}}class DT{constructor(e){this.commandHandler=e}navigateById(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.commandHandler({entity:{type:u.p.campaignnotifications,action:u.u.view,id:e},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand,scenarioEventData:null==t?void 0:t.scenarioEventData})}))}}var RT=n(782037);class xT{constructor(e,t,n,i){this.commandHandler=e,this.extensionCommanding=t,this.coreSettings=n,this._logger=i.newLogger("ChatCommandingService","core-services-entity-commanding")}default(e){return this.handleCommandWithChecks({entity:{type:u.p.chats,action:u.u.default},command:e})}empty(e){return this.handleCommandWithChecks({entity:{type:u.p.chats,action:u.u.empty},command:e})}chatList(e,t){return this.handleCommandWithChecks({entity:{type:u.p.chats,action:u.u.list},entityOptions:null==t?void 0:t.entityOptions,command:e})}chatById(e,t){return this.handleCommandWithChecks({entity:{type:u.p.chats,action:u.u.view,id:e},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand,scenarioEventData:null==t?void 0:t.scenarioEventData})}chatChannelConversationById(e,t,n){const i={channelId:e,replyChainId:t};return this.handleCommandWithChecks({entity:{type:u.p.chatschannelconv,action:u.u.view,id:JSON.stringify(i)},entityOptions:null==n?void 0:n.entityOptions,command:null==n?void 0:n.entityCommand,scenarioEventData:null==n?void 0:n.scenarioEventData})}chatWithUsers(e){const t=(0,RT.Mf)((null==e?void 0:e.userIds)||[],null==e?void 0:e.entityCommand);return this.handleCommandWithChecks(Object.assign(Object.assign({},t),{entityOptions:null==e?void 0:e.entityOptions}))}chatWithGuardians(e,t,n,i,a,o){const r=(0,RT.Mf)(t||[],o),s={groupName:n,isGuardiansChat:!0,guardiansChatGroupId:e,guardiansChatStudentId:i,guardiansPreferredToAlternateMriMappings:a};return this.handleCommandWithChecks(Object.assign(Object.assign({},r),{entityOptions:s}))}orgChat(e,t){return this.handleCommandWithChecks({entity:{type:u.p.extensions,action:u.u.view,id:d.oz.organization,linkedEntity:{type:u.p.chats,id:(0,RT.f$)([e])}},command:t})}linkedIn(e,t){return this.handleCommandWithChecks({entity:{type:u.p.extensions,action:u.u.view,id:d.oz.linkedin,linkedEntity:{type:u.p.chats,id:(0,RT.f$)([e])}},command:t})}openLpcInMainWindow(e,t){return this.commandHandler({entity:{type:u.p.livepersonacard,action:u.u.view},command:t,entityOptions:e})}launchAltText(e,t){return this.extensionCommanding.executeCommand({type:u.p.alttext,action:u.u.view},{entityCommand:t,entityOptions:{element:e}})}launchAddNewComponentFluid(e){return this.extensionCommanding.executeCommand({type:u.p.fluid,action:u.u.confirm},{entityCommand:e})}launchInsertHyperlink(e,t,n){return this.extensionCommanding.executeCommand({type:u.p.hyperlink,action:u.u.view},{entityCommand:n,entityOptions:{displayText:e,address:t}})}launchDiscardCodeSnippet(e){return this.extensionCommanding.executeCommand({type:u.p.codesnippet,action:u.u.delete},{entityCommand:e})}launchTranslationFeedbackDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.translationfeedback,action:u.u.view},{entityCommand:t,entityOptions:e})}launchTwoWaySmsFriendlyNameDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.twowaysmsfriendlyname,action:u.u.view},{entityCommand:t,entityOptions:e})}launchDeleteChat(e,t){return this.extensionCommanding.executeCommand({type:u.p.deletechat,action:u.u.delete},{entityCommand:t,entityOptions:e})}launchDiscardFluid(e,t){return this.extensionCommanding.executeCommand({type:u.p.fluid,action:u.u.delete},{entityCommand:t,entityOptions:{isCompose:e}})}launchPastePermissionsFluid(e,t){return this.extensionCommanding.executeCommand({type:u.p.fluid,action:u.u.manage},{entityCommand:t,entityOptions:{displayText:e}})}launchUpdatePermissionsFluid(e,t){return this.extensionCommanding.executeCommand({type:u.p.fluid,action:u.u.update},{entityCommand:t,entityOptions:{recipientList:e}})}launchUnpinMessageFromChat(e){return this.extensionCommanding.executeCommand({type:u.p.pinnedconversationitems,action:u.u.delete},{entityCommand:e})}launchReplaceMessageFromChat(e){return this.extensionCommanding.executeCommand({type:u.p.pinnedconversationitems,action:u.u.update},{entityCommand:e})}launchDiscardMessageDraft(e,t){return this.extensionCommanding.executeCommand({type:u.p.messagedraft,action:u.u.delete},{entityCommand:t,entityOptions:{isBranded:e}})}launchGiphyConsent(e){return this.extensionCommanding.executeCommand({type:u.p.giphyconsent,action:u.u.view},{entityCommand:e})}launchLeaveChat(e){return this.extensionCommanding.executeCommand({type:u.p.leavechat,action:u.u.delete},{entityCommand:e})}launchSendFeedback(e,t,n,i,a){return this.extensionCommanding.executeCommand({type:e,action:u.u.view},{entityCommand:t,entityOptions:{traceId:n,convId:i,endpoint:a}})}launchChatInviteConfirmation(e){return this.extensionCommanding.executeCommand({type:u.p.chatInviteConfirmation,action:u.u.view},{entityCommand:e})}launchMaxPinnedChatsReached(e,t){return this.extensionCommanding.executeCommand({type:u.p.pinnedchatsmaxreached,action:u.u.view},{entityCommand:t,entityOptions:{maxPinnedChats:e}})}launchUpdateGroupChatAvatar(e,t){return this.extensionCommanding.executeCommand({type:u.p.updategroupchatavatar,action:u.u.view},{entityCommand:t,entityOptions:{threadId:e}})}launchTfwUpdateGroupChatAvatar(e,t){return this.extensionCommanding.executeCommand({type:u.p.tfwupdategroupchatavatar,action:u.u.view},{entityCommand:t,entityOptions:{threadId:e}})}launchRemoveChatUser(e,t,n){return this.extensionCommanding.executeCommand({type:u.p.removechatuser,action:u.u.delete},{entityCommand:n,entityOptions:{userName:e,isRemoveTfwUserInTflChat:t}})}launchShareChatLink(e,t,n,i,a,o,r,s){return this.extensionCommanding.executeCommand({action:u.u.view,id:e,type:u.p.sharechatlink},{entityCommand:s,entityOptions:{chatTitle:t,tenantId:n,hasError:i,sharedLink:a,cfet:o,panelType:r}})}launchChatError(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.chats,action:u.u.error},{entityCommand:t})}launchStreamCamera(e){return this.extensionCommanding.executeCommand({type:u.p.streamcamera,action:u.u.default,id:null==e?void 0:e.correlation.id},{entityCommand:e})}launchStreamCameraInChannels(e){return this.extensionCommanding.executeCommand({type:u.p.streamcamerainchannels,action:u.u.default,id:null==e?void 0:e.correlation.id},{entityCommand:e})}launchStreamCameraInCommunities(e){return this.extensionCommanding.executeCommand({type:u.p.streamcameraincommunities,action:u.u.default,id:null==e?void 0:e.correlation.id},{entityCommand:e})}meetingRecapTab(e,t,n){return this.handleCommandWithChecks({entity:{type:n||u.p.meetingrecaptab,action:u.u.view,id:e.threadId},command:t,entityOptions:e})}transcriptTab(e,t,n,i,a,o,r){return this.handleCommandWithChecks({entity:{type:u.p.transcripttab,action:u.u.view,id:t},entityOptions:{conversationId:e,storageId:n,teamsCallId:i,meetingOrganizerId:a,meetingTenantId:o,eventId:r}})}launchReportConcern(e,t){return this.extensionCommanding.executeCommand({type:u.p.reportConcern,action:u.u.create},{entityCommand:t,entityOptions:e})}launchForwardMessage(e,t){return this.extensionCommanding.executeCommand({type:u.p.forwardMessage,action:u.u.create},{entityCommand:t,entityOptions:e})}launchReportConcernV2(e,t){return this.extensionCommanding.executeCommand({type:u.p.reportConcernForTFW,action:u.u.create},{entityCommand:t,entityOptions:e})}launchReportConcernTY(e){return this.extensionCommanding.executeCommand({type:u.p.reportConcern,action:u.u.info},{entityCommand:e})}launchReportConcernV2Confirmation(e){return this.extensionCommanding.executeCommand({type:u.p.reportConcernForTFW,action:u.u.info},{entityCommand:e})}launchDlpDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.dlp,action:u.u.view},{entityCommand:t,entityOptions:e})}chatInfoPane(e,t,n){return this.handleCommandWithChecks({entity:{type:u.p.chatsInfoView,action:u.u.info,id:e},command:t,entityOptions:n})}chatContextualSearch(e,t,n){return this.handleCommandWithChecks({entity:{type:u.p.chatContextualSearch,action:u.u.info,id:e},command:t,entityOptions:n})}chatHighlightsDetails(e,t,n){return this.handleCommandWithChecks({entity:{type:u.p.chatHighlightsDetails,action:u.u.info,id:e},command:t,entityOptions:n})}manage(e,t){return this.handleCommandWithChecks({entity:{type:u.p.chatManageApps,action:u.u.manage,id:e,linkedEntity:{type:u.p.chats,id:e}},command:t})}chatInfoPaneDetails(e,t,n){return this.handleCommandWithChecks({entity:{type:u.p.chatsInfo,action:u.u.infoDetails,id:e},command:t,entityOptions:n})}launchBlockChatDialog(e){return this.extensionCommanding.executeCommand({type:u.p.blockChat,action:u.u.view},{entityCommand:e})}launchLeaveGroupAndBlockUserDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.leaveGroupAndBlockUser,action:u.u.view},{entityCommand:t,entityOptions:e})}launchCustomizeReactions(e){return this.extensionCommanding.executeCommand({type:u.p.customizereactions,action:u.u.view},{entityCommand:e})}handleCommandWithChecks(e){return this.checkPolicies(e),this.commandHandler(e)}checkPolicies(e){var t,n,i;if(this.coreSettings.get(L.J.Messaging).allowUserChat||(null===(t=e.entity.id)||void 0===t?void 0:t.startsWith("19:meeting")))return;const{type:a,action:o}=e.entity,r=`${he.w5.Commanding}::${he.jK.PolicyCheckFailed}::Chat command not allowed due to policy (allowUserChat=false)`;null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,r,"messaging_command_policy_violation",{mainEntityType:a,mainEntityAction:o})}}class MT{constructor(e){this.commandHandler=e}coachReport(e,t){return this.commandHandler({entity:{type:u.p.coachreport,action:u.u.view,linkedEntity:{type:u.p.chats,id:t?t.threadId:""}},command:e,entityOptions:t})}}class OT{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}showAddMemberDialog(e,t){return this.commandHandler({entity:{id:e,type:u.p.communitiesaddmember,action:u.u.view},entityOptions:{},command:t})}showCreateChannelDialog(e,t){return this.commandHandler({entity:{id:e,type:u.p.communitiescreatechannel,action:u.u.view},entityOptions:{},command:t})}showCommunityLinkDialog(e,t){return this.commandHandler({entity:{action:u.u.view,id:e,type:u.p.sharecommunitieslink},entityOptions:{},command:t})}showCommunityGuidelinesDialog(e,t){return this.commandHandler({entity:{action:u.u.view,id:e,type:u.p.communitiesguidelinesdialog},entityOptions:{},command:t})}showCommunityGetAppDialog(e){return this.commandHandler({entity:{action:u.u.view,type:u.p.communitiesgetappdialog},entityOptions:{},command:e})}showCommunitiesCreateDialog(e){return this.commandHandler({entity:{action:u.u.view,type:u.p.communitiescreatedialog},entityOptions:{},command:e})}showCommunitiesEditDialog(e,t){return this.commandHandler({entity:{action:u.u.view,type:u.p.communitieseditdialog,id:e},entityOptions:{},command:t})}showReportConcernDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.reportconcerncommunities,action:u.u.create},{entityCommand:t})}showReportConcernTY(e,t){return this.commandHandler({entity:{type:u.p.reportconcerncommunities,action:u.u.view,id:e},entityOptions:{},command:t})}showSendPostAsEmailDialog(e,t){return this.commandHandler({entity:{type:u.p.communitiessendpostasemaildialog,action:u.u.view,id:e},entityOptions:{},command:t})}showLeaveCommunityDialog(e,t){return this.commandHandler({entity:{id:e,type:u.p.leavecommunity,action:u.u.view},entityOptions:{},command:t})}communityMessagesById(e,t,n,i,a,o,r){const s={channelId:e,replyChainId:t};return localStorage.setItem("communities-selected-id",e),localStorage.setItem("communities-selected-reply-id",t||""),this.commandHandler({entity:{type:u.p.communities,action:null!=r?r:u.u.view,id:JSON.stringify(s)},command:i,entityOptions:Object.assign(Object.assign({},a),{deepLinkId:n}),scenarioEventData:null==o?void 0:o.scenarioEventData})}getCommunityEvents(e){const t={stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:kt.D.CommunitiesEventsButton}};return this.commandHandler({entity:{type:u.p.communitiesevents,action:u.u.view,id:JSON.stringify({channelId:e})},command:t})}showCreateCommunityEvent(e){const t={stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:kt.D.CommunitiesCreateEventButton}};return this.commandHandler({entity:{type:u.p.communitiescreateevent,action:u.u.view,id:JSON.stringify({channelId:e})},command:t,entityOptions:{isGroup:!0,conversationId:e}})}getOnboardingView(e,t,n){return this.getView(u.p.communitiesonboarding,null!=e?e:u.u.view,t,n,kt.D.CommunitiesOnboarding)}navigateToCommunityId(e,t,n){const i={stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:n||kt.D.Unknown}};return this.communityMessagesById(e,void 0,void 0,i,void 0,void 0,t?u.u.default:void 0)}showCommunitiesManage(e,t){return localStorage.setItem("current-enitity-type",u.p.communitiesmembers),this.commandHandler({entity:{type:u.p.communitiesmembers,action:u.u.view,id:e},command:{stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:t||kt.D.CommunitiesManage}}})}showCommunitiesManageMemberRequests(e){return this.commandHandler({entity:{type:u.p.communitiesjoinrequest,action:u.u.view,id:e},command:{stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:kt.D.CommunitiesManage}}})}showCommunityJoinView(e,t,n,i,a){return this.commandHandler({entity:{type:u.p.communitiesjoininviteview,action:u.u.join,id:e},command:t,entityOptions:Object.assign(Object.assign({},n),{inviteLinkType:Os.DL.Community,inviteLinkUrl:`${a}${e}`}),scenarioEventData:null==i?void 0:i.scenarioEventData})}showPerCommunityNotificationSettingsDialog(e,t){return this.commandHandler({entity:{action:u.u.view,id:e,type:u.p.percommunitynotificationsettingsdialog},entityOptions:{},command:t})}getView(e,t,n,i,a){return this.commandHandler(Object.assign({entity:{type:e,action:null!=t?t:u.u.default},command:{stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:a||kt.D.ChannelListItem}}},t===u.u.join?{entityOptions:{inviteLinkType:n,inviteLinkUrl:i}}:{}))}}class PT{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}openContactsSyncPopout(e){return this.commandHandler({entity:{type:u.p.contactssync,action:u.u.default,id:"default"},command:(null==e?void 0:e.entityCommand)||{stateTransition:d.su.new,visibilityState:d.fe.show,correlation:{source:kt.D.Flyout}},windowOptions:null==e?void 0:e.windowOptions})}openContactsSyncModal(){return this.extensionCommanding.executeCommand({type:u.p.contactssync,action:u.u.view,id:"default"})}launchContactsModal(e,t){return this.extensionCommanding.executeCommand({type:u.p.contactssync,action:u.u.info,id:e},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:t}})}showHideContactsView(e,t,n){return this.commandHandler({entity:{type:u.p.contactssync,action:u.u.view,id:e},command:{stateTransition:d.su.flush,visibilityState:n?d.fe.show:d.fe.hide,correlation:t}})}}class LT{constructor(e){this.commandHandler=e}discoverApps(e,t){return this.commandHandler({entity:{type:u.p.discoverappsnotifications,action:u.u.view},command:t,entityOptions:e})}}class UT{constructor(e,t){this.commandHandler=e,this.loggerFactory=t,this.logger=this.loggerFactory.newLogger("DiscoverSurfaceCommandingService","core-services-entity-commanding")}showDiscoverSurface(e){return this.logger.log(`showDiscoverSurface: called with - ${u.p.discoversurface}:${u.u.view}`),this.commandHandler({entity:{type:u.p.discoversurface,action:u.u.view},command:null==e?void 0:e.entityCommand,entityOptions:null==e?void 0:e.entityOptions})}}class jT{constructor(e){this.commandHandler=e}launchErrorApp(e){return this.commandHandler({entity:{type:u.p.error,action:u.u.view},command:{stateTransition:d.su.forceFlush,visibilityState:d.fe.show,correlation:{source:kt.D.LayoutError}},entityOptions:{errorReason:e.code}})}}class $T{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t,this.entityAllowList=[u.p.esp,u.p.help,u.p.storefre,u.p.whatsnewdialog]}displaySurface(e,t,n){return this.commandHandler({entity:{type:u.p.esp,action:u.u.create,id:e},entityOptions:{forceShow:t,customParams:n}})}displayFollowUpSurface(e,t){const n=C.LQM.FollowUp;return this.commandHandler({entity:{type:u.p.esp,action:u.u.create,id:e},entityOptions:{forceShow:t,espTrigger:n}})}launchDialog(e,t){let n=u.p.esp;if(t){if(!this.entityAllowList.includes(t))throw new Error("launchDialog must be called with Entity from the allow list.");n=t}return this.extensionCommanding.executeCommand({id:e,type:n,action:u.u.view})}closeDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:null!=t?t:u.p.esp,action:u.u.view},{entityCommand:{visibilityState:d.fe.hide,stateTransition:d.su.extend,correlation:{source:kt.D.ExtensionCommanding}}})}navigate(e,t,n){return this.commandHandler({entity:e,command:t,entityOptions:n})}}class BT{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}surveyDialogWithObserver(e,t){return this.extensionCommanding.executeCommand({action:u.u.view,type:u.p.survey,id:e},{entityCommand:t})}surveyDialog(e,t){var n;const i={source:null===(n=null==t?void 0:t.correlation)||void 0===n?void 0:n.source,entityStateTransition:null==t?void 0:t.stateTransition};return this.commandHandler({entity:{type:u.p.survey,action:u.u.view,id:e},command:t,entityOptions:i})}giveFeedbackDialog(e){return this.commandHandler({entity:{type:u.p.givefeedbackchoices,action:u.u.view},command:e})}}class WT{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}galleryImage(e,t){const n=e.galleryId,i={type:u.p.galleryImages,action:u.u.view,id:n};return this.commandHandler({entity:i,command:t,entityOptions:e})}galleryImageExtended(e,t){const n=e.galleryId,i={type:u.p.galleryImages,action:u.u.view,id:n};return this.extensionCommanding.executeCommand(i,{entityCommand:t,entityOptions:e})}fileById(e){const t=e.fileId;return this.commandHandler({entity:{type:u.p.file,action:u.u.view,id:t},entityOptions:e})}launchFileViewApp(e,t,n=kt.D.FileViewer){const i={subEntityId:JSON.stringify(t)};return this.commandHandler({entity:{type:u.p.extensions,action:u.u.view,id:JSON.stringify({appId:e}),linkedEntity:{id:JSON.stringify(i),type:u.p.extensions}},command:{visibilityState:d.fe.show,stateTransition:t.shouldOpenInMultiWindow?d.su.new:d.su.flush,correlation:{source:n}}})}openInOneup(e,t=kt.D.FileViewer){const n=e.fileId;let i,a;if("channelsPDFTab"===e.context){const t={channelId:e.threadId,replyChainId:void 0};a={type:u.p.filesoneupviewer,action:u.u.view,id:e.entityId,linkedEntity:{id:JSON.stringify(t),type:u.p.channels}},i=kt.D.ChannelHeader}else"chatPDFTab"===e.context?(a={type:u.p.filesoneupviewer,action:u.u.view,id:e.entityId,linkedEntity:{id:e.threadId?e.threadId:"",type:u.p.chats}},i=kt.D.ChatHeader):(a={type:u.p.filesoneupviewer,action:u.u.view,id:n},i=t);return this.commandHandler({entity:a,command:{visibilityState:d.fe.show,stateTransition:e.shouldOpenInMultiWindow?d.su.new:d.su.flush,correlation:{id:(0,Ye.v4)(),source:i}},entityOptions:e})}closeOneup(e,t=kt.D.FileViewer){return this.commandHandler({entity:{type:u.p.filesoneupviewer,action:u.u.view,id:e},command:{visibilityState:d.fe.hide,stateTransition:d.su.flush,correlation:{source:t}}})}fileOpenSettingsSuggestion(e){return this.commandHandler({entity:{type:u.p.fileopensettings,action:u.u.info},entityOptions:e})}fileOpenSettingsUpdate(e){return this.commandHandler({entity:{type:u.p.fileopensettings,action:u.u.update},entityOptions:e})}chatFilesList(e,t){return this.commandHandler({entity:{id:null,type:u.p.file,action:u.u.list,linkedEntity:{type:u.p.chats,id:e}},command:t})}photosList(e,t){return this.commandHandler({entity:{id:null,type:u.p.gallery,action:u.u.view,linkedEntity:{type:u.p.chats,id:e}},command:t})}launchFilePicker(e,t,n,i){return this.extensionCommanding.executeCommand({type:u.p.filepicker,action:u.u.view},{entityCommand:n,entityOptions:{fileContainerKey:e,filePickerContext:t,filePickerConfigurationOverrides:i}})}launchCloudStorageDialog(e,t,n){return this.extensionCommanding.executeCommand({type:u.p.cloudStorageDialog,action:u.u.view},{entityCommand:n,entityOptions:{addcloudStorageFolderData:e,channelId:t}})}}class HT{constructor(e){this.commandHandler=e}launchFlyoutHomePage(){const e={id:(0,Ye.v4)(),source:kt.D.Flyout,startTimestamp:Date.now()};return this.commandHandler({entity:{type:u.p.flyout,action:u.u.default},command:{correlation:e,stateTransition:d.su.flush,visibilityState:d.fe.show,layoutMode:d.lO.minimal}})}}class VT{constructor(e){this.commandHandler=e}freemiumUpgrade(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.commandHandler({entity:{type:u.p.freemiumupgrade,action:u.u.view},command:e,entityOptions:t})}))}}class zT{constructor(e){this.commandHandler=e}guardiansTabInChannelById(e,t,n,i){const a={type:u.p.guardians,action:u.u.list,id:e,linkedEntity:n};return this.commandHandler({entity:a,command:t,entityOptions:i})}}class qT{constructor(e){this.commandHandler=e}launchTflHomepage(){const e={id:(0,Ye.v4)(),source:kt.D.Homepage,startTimestamp:Date.now()};return this.commandHandler({entity:{type:u.p.homepage,action:u.u.default},command:{correlation:e,stateTransition:d.su.flush,visibilityState:d.fe.show}})}}class GT{constructor(e){this.extensionCommanding=e}showCreatePostDialog(e,t,n,i){return this.extensionCommanding.executeCommand({type:u.p.classesintegrationcontent,action:u.u.create},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:kt.D.LmsCourseTeams}},entityOptions:{teamId:e,teamName:t,groupId:n,tenantId:i}})}}class JT{constructor(e){this.commandHandler=e}viewLobNotifications(e,t){return this.commandHandler({entity:{type:u.p.lobnotifications,action:u.u.view},command:t,entityOptions:e})}}class QT{constructor(e){this.commandHandler=e}analytics(e,t){return this.commandHandler({entity:{type:u.p.meetinganalytics,action:u.u.view},command:e,entityOptions:t})}openAttendanceTabInSchedulingForm(e,t,n="",i=0){return this.commandHandler({entity:{type:u.p.attendancereport,action:u.u.view,linkedEntity:{type:u.p.schedulingform,action:u.u.view,id:JSON.stringify({eventId:(0,RT.cW)(n),providerType:i})}},command:e,entityOptions:Object.assign(Object.assign({},t),{eventId:(0,RT.cW)(n)})})}openAnalyticsInSchedulingForm(e,t,n="",i=0){return this.commandHandler({entity:{type:u.p.meetinganalytics,action:u.u.view,linkedEntity:{type:u.p.schedulingform,action:u.u.view,id:JSON.stringify({eventId:(0,RT.cW)(n),providerType:i})}},command:e,entityOptions:Object.assign(Object.assign({},t),{eventId:(0,RT.cW)(n)})})}openAttendanceTabInMeetingChat(e,t){return this.commandHandler({entity:{type:u.p.meetinganalytics,action:u.u.view},command:e,entityOptions:{threadId:t}})}}class KT{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}meetingOptionsFormView(e,t,n,i,a,o){return this.commandHandler({entity:{type:u.p.meetings,action:u.u.view,id:this.serializeMeetingCoordinates(e,t,n,i,a)},command:o})}meetingOptionsCreateViewDialog(e,t,n){const i={type:u.p.meetingoptionscreatedialog,id:e.id,action:e.action};return this.extensionCommanding.executeCommand(i,{entityCommand:t,entityOptions:n})}serializeMeetingCoordinates(e,t,n,i,a){return JSON.stringify({tenantId:e,organizerId:t,threadId:n,messageId:i,additionalMessageId:a})}}class YT{constructor(e){this.commandHandler=e}recapTabInMeetingChat(e,t,n){return this.commandHandler({entity:{type:u.p.meetingrecap,action:u.u.view,linkedEntity:n?{type:u.p.chats,action:u.u.view,id:(null==t?void 0:t.threadId)||""}:null},command:e,entityOptions:t})}recapTabInSchedulingForm(e,t,n){return this.commandHandler({entity:{type:u.p.meetingrecap,action:u.u.view,linkedEntity:{type:u.p.schedulingform,action:u.u.view,id:JSON.stringify({eventId:(0,RT.cW)((null==t?void 0:t.externalEntityKey)||""),providerType:n})}},command:e,entityOptions:t})}popOutMeetingRecap(e,t,n){const i={id:(0,Ye.v4)(),source:kt.D.ChatListItem,startTimestamp:Date.now()};return this.commandHandler({entity:{type:u.p.meetingrecap,action:u.u.view},command:{stateTransition:d.su.new,visibilityState:d.fe.show,correlation:i},entityOptions:{threadId:e,subType:"popup",externalEntityKey:t,defaultRightTab:n}})}}var XT,ZT=n(765395);class eI{constructor(e){this.commandHandler=e}meetingRoomConsoleInCallById(e,t,n){return this.commandHandler({entity:{type:u.p.meetingroomconsolecall,action:u.u.view,id:e},entityOptions:t,command:n})}meetingRoomNewCall(){return this.commandHandler({entity:{type:u.p.meetingroomconsolecall,action:u.u.create},entityOptions:{stateParams:{isPstnCall:!0},createCallType:ZT.f.Dialpad},command:{stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:kt.D.Calling}}})}meetingRoomSmartDeviceJoinByCode(e){return this.commandHandler({entity:{type:u.p.meetingroomconsolecall,action:u.u.create},entityOptions:{createCallType:ZT.f.SmartDeviceJoinByCode},command:e})}meetingRoomJoinByCode(e){return this.commandHandler({entity:{type:u.p.meetingroomconsolecall,action:u.u.create},entityOptions:{createCallType:ZT.f.JoinByCode},command:e})}meetingRoomHome(){return this.commandHandler({entity:{type:u.p.meetingroomconsolecall,action:u.u.list},entityOptions:{},command:{stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:kt.D.Calling}}})}}class tI{constructor(e){this.commandHandler=e}viewOnboardingNotifications(e,t){return this.commandHandler({entity:{type:u.p.onboardingnotifications,action:u.u.view},command:t,entityOptions:e})}}class nI{constructor(e,t,n){this.commandHandler=e,this.extensionCommanding=t,this.coreSettings=n}launchTaskModule(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return n.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.taskmodule,action:u.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.taskModuleOptions})}launchHWCTaskModule(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return n.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.hwctaskmodule,action:u.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.taskModuleOptions})}launchStage(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformStage,action:u.u.view},{entityCommand:t,entityOptions:null==e?void 0:e.stageOptions})}launchReactStageModal(e,t,n){const i=n||this.getDefaultExtensionCommand();return this.extensionCommanding.executeCommand({id:e,type:u.p.platformstagemodal,action:u.u.view},{entityCommand:i,entityOptions:t})}launchStageMW(e){return this.commandHandler({entity:{id:e.id,type:u.p.platformStage,action:u.u.create,linkedEntity:e.linkedEntity},command:{stateTransition:d.su.new,visibilityState:d.fe.show,correlation:{source:kt.D.PlatformExtension}},entityOptions:e.stageOptions})}launchTabGallery(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformTabGallery,action:u.u.view},{entityCommand:t,entityOptions:null==e?void 0:e.tabGalleryOptions})}launchUnsupportedDeeplinkDialog(e){return this.extensionCommanding.executeCommand({type:u.p.unsupporteddeeplinkdialog,action:u.u.view},{entityOptions:{originalDeeplink:e}})}launchAppDetails(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return n.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformapp,action:u.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.platformAppDetailsOptions})}launchAppDetailsTutorial(e){const t=this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformappdetails,action:u.u.info},{entityCommand:t,entityOptions:e})}launchAppRevokeConsent(e){const t=this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformappconsent,action:u.u.delete},{entityCommand:t,entityOptions:e})}appDetailsPostInstall(e){const t=this.getDefaultExtensionCommand();return t.stateTransition=d.su.none,this.commandHandler({entity:{type:u.p.platformappdetails,action:u.u.config},command:t,entityOptions:e})}appDetailsOnDone(e,t){const n=this.getDefaultExtensionCommand();return n.stateTransition=d.su.none,this.commandHandler({entity:{id:e,type:u.p.platformappdetails,action:u.u.update},command:n,entityOptions:t})}launchInContextStore(e){const t=this.getDefaultExtensionCommand();return this.extensionCommanding.executeCommand({type:u.p.incontextstore,action:u.u.view},{entityCommand:t,entityOptions:e})}inContextStorePostInstall(e){const t=this.getDefaultExtensionCommand();return t.stateTransition=d.su.none,this.commandHandler({entity:{type:u.p.incontextstore,action:u.u.config},command:t,entityOptions:e})}inContextStoreOnDone(e,t){const n=this.getDefaultExtensionCommand();return n.stateTransition=d.su.none,this.commandHandler({entity:{id:e,type:u.p.incontextstore,action:u.u.update},command:n,entityOptions:t})}launchAppStore(e,t){return this.commandHandler({entity:{type:u.p.platformapps,action:u.u.list},command:t,entityOptions:e})}launchPersonalApp(e){const t=this.getDefaultExtensionCommand();return t.stateTransition=d.su.none,this.commandHandler({entity:{type:u.p.platformapp,action:u.u.view},command:t,entityOptions:e})}launchAppUninstall(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return n.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformapp,action:u.u.delete},{entityCommand:n,entityOptions:null==t?void 0:t.uninstallOptions})}launchAppError(e){const t=this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformapp,action:u.u.error},{entityCommand:t,entityOptions:e})}launchUploadCustomApp(){const e=this.getDefaultExtensionCommand();return e.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.customapp,action:u.u.view},{entityCommand:e})}launchRequestSubmittedDialog(){const e=this.getDefaultExtensionCommand();return e.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.customapp,action:u.u.info},{entityCommand:e})}launchLocationDialog(e){const t=this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.locationapi,action:u.u.create},{entityCommand:t,entityOptions:e})}launchSelectMediaDialog(e){const t=this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.selectMediaApi,action:u.u.create},{entityCommand:t,entityOptions:e})}launchViewImagesDialog(e){const t=this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.viewImagesApi,action:u.u.create},{entityCommand:t,entityOptions:e})}launchSelectPeoplePickerDialog(e){const t=this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.selectpeoplepicker,action:u.u.view},{entityCommand:t,entityOptions:e})}launchAppConfig(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return n.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformapp,action:u.u.config},{entityCommand:n,entityOptions:null==t?void 0:t.launchAppConfigOptions})}launchTabInfo(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return n.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformtab,action:u.u.info},{entityCommand:n,entityOptions:null==t?void 0:t.launchTabInfoOptions})}launchStagedApps(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.stagedapps,action:u.u.info},{entityCommand:t,entityOptions:null==e?void 0:e.launchStagedAppsOptions})}launchAppAuthConsent(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return n.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformauthconsentdialog,action:u.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.launchAuthConsentOptions})}platformTabById(e,t,n,i){return this.commandHandler({entity:{id:e,type:u.p.extensions,action:u.u.view,linkedEntity:n},command:t,entityOptions:i})}launchPersonalPlatformApp(e,t,n,i,a){return this.commandHandler({entity:{id:JSON.stringify({appId:e,tabEntityId:n}),type:u.p.extensions,action:u.u.view,linkedEntity:a},command:{visibilityState:d.fe.show,stateTransition:t?d.su.new:d.su.flush,correlation:{source:null!=i?i:kt.D.AppBar,startTimestamp:Date.now()}},entityOptions:{isMultiWindow:t,entryPoint:bp.mQ.personalApp}})}platformAppById(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.extensions,action:u.u.view,linkedEntity:n},command:t})}navigateToManageApps(e){return this.commandHandler({entity:{type:u.p.platformapps,action:u.u.manage},entityOptions:e})}launchSubscriptionPlansDialog(e,t,n){const i=n||this.getDefaultExtensionCommand();return i.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformsubscriptionplans,action:u.u.info},{entityCommand:i,entityOptions:t})}launchAngularAppDetails(e,t,n){const{enableAppDetailsAngularFeatureParity:i}=this.coreSettings.get(L.J.Host);if(i)return this.launchAppDetails(e,{platformAppDetailsOptions:t,entityCommand:n});const a=n||this.getDefaultExtensionCommand();return a.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformapp,action:u.u.info},{entityCommand:a,entityOptions:t})}launchCustomAppFilePicker(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.customapp,action:u.u.create},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:n||kt.D.Store}},entityOptions:t})}launchWorkflowsDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.workflows,action:u.u.create},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:n||kt.D.Store}},entityOptions:t})}launchManageWorkflows(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.workflows,action:u.u.manage},entityOptions:t,command:{visibilityState:d.fe.show,stateTransition:d.su.none,correlation:{source:n||kt.D.Store}}})}launchSettingsDialog(e,t,n){const i={visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:n||kt.D.Card}};return this.extensionCommanding.executeCommand({id:e,type:u.p.settingsdialog,action:u.u.view},{entityCommand:i,entityOptions:t})}updatePlatformTabById(e,t,n,i){return this.commandHandler({entity:{id:e,type:u.p.extensions,action:u.u.update,linkedEntity:n},command:t,entityOptions:i})}videoEffectsCustomizationPanelById(e,t){return this.commandHandler({entity:{type:u.p.videoeffectscustomization,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}videoEffectsMoreViewPanelById(e,t,n){return this.commandHandler({entity:{type:u.p.videoeffectsmoreview,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t,entityOptions:n})}videoEffectsAndAvatarPanelById(e,t,n){return this.commandHandler({entity:{type:u.p.videoeffectsandavatar,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t,entityOptions:n})}meshAvatarPanelById(e,t){return this.commandHandler({entity:{type:u.p.meshavatar,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}launchManageAppsUninstall(e,t){const n=this.getDefaultExtensionCommand();return n.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.manageapps,action:u.u.delete},{entityCommand:n,entityOptions:t})}launchManageAppsWebhook(e,t){const n=this.getDefaultExtensionCommand();n.visibilityState=d.fe.show;const i=t.editMode?u.u.update:u.u.create;return this.extensionCommanding.executeCommand({id:e,type:u.p.manageappswebhook,action:i},{entityCommand:n,entityOptions:t})}launchManageAppsWebhookConfirmation(e){const t=this.getDefaultExtensionCommand(),n={webhookToken:e};return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.manageappswebhook,action:u.u.info},{entityCommand:t,entityOptions:n})}selectAppEntity(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultExtensionCommand();return t.visibilityState=d.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformTabGallery,action:u.u.create},{entityCommand:t,entityOptions:null==e?void 0:e.selectAppEntityOptions})}launchAppDevicePermissions(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.platformappdevicepermissions,action:u.u.create},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:t})}launchAppDevicePermissionsFirstRun(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.platformappdevicepermissions,action:u.u.update},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:t})}launchRefreshConfirmationAfterAppDevicePermissionsUpdate(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.platformappdevicepermissions,action:u.u.confirm},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:t})}hideExtension(e){return this.extensionCommanding.executeCommand(e,{entityCommand:{visibilityState:d.fe.hide,stateTransition:d.su.extend,correlation:{source:kt.D.ExtensionCommanding}}})}getDefaultExtensionCommand(){return{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:kt.D.ExtensionCommanding}}}}class iI{constructor(e,t){this.commandHandler=e,this.coreSettings=t}registration(e){const{enableMultiWindowWebinarRegistration:t}=this.coreSettings.get(L.J.WebinarRegistration);return t?this.commandHandler({entity:{action:u.u.view,id:e,type:u.p.registration},command:{visibilityState:d.fe.show,stateTransition:d.su.new,correlation:{source:kt.D.Calendar}}}):((0,Ue.J)().open(`${(0,Ue.J)().location.origin}/registration/${e}?mode=edit`,"_blank"),Promise.resolve())}}class aI{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}showTeamsGrid(e){return this.commandHandler({entity:{type:u.p.schoolteams,action:u.u.list},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.SchoolTeams}},entityOptions:{lastVisitedTeamId:e}})}gridTeamDiscover(){return this.commandHandler({entity:{type:u.p.schoolteams,action:u.u.join},command:{stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:kt.D.SchoolTeams}}})}showSingleTeam(e){return this.commandHandler({entity:{type:u.p.channels,action:u.u.view,id:e},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.SchoolTeams}}})}showUnlockDialog(e){return this.extensionCommanding.executeCommand({type:u.p.schoolteams,action:u.u.update,id:e},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:kt.D.UnlockTeam}}})}}class oI{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t,this.updateSearchState=e=>this.commandHandler({entity:{id:e&&e.searchQuery,type:u.p.search,action:u.u.view},command:{correlation:{id:(0,Ye.v4)(),startTimestamp:Date.now(),source:kt.D.Search},stateTransition:d.su.none,visibilityState:d.fe.show},entityOptions:e}),this.updateSearchStateRW=e=>this.commandHandler({entity:{id:e&&e.searchQuery,type:u.p.search,action:u.u.view},command:{correlation:{id:(0,Ye.v4)(),startTimestamp:Date.now(),source:kt.D.Search},stateTransition:d.su.flush,visibilityState:d.fe.show},entityOptions:e}),this.open3SFeedback=e=>this.commandHandler({entity:{type:u.p.open3sfeedback,action:u.u.view},command:{correlation:{source:kt.D.Search},stateTransition:d.su.new,visibilityState:d.fe.show},entityOptions:e}),this.exitSearchState=()=>this.commandHandler({entity:{type:u.p.search,action:u.u.view,id:"search"},command:{correlation:{source:kt.D.Search},stateTransition:d.su.forceFlush,visibilityState:d.fe.hide}})}openFeedback(e,t){return this.extensionCommanding.executeCommand({type:u.p.openfeedbackdialog,action:u.u.view},{entityCommand:e,entityOptions:t})}}class rI{constructor(e){this.commandHandler=e}launch(e){return this.commandHandler({entity:{type:u.p.settingsstore,action:u.u.default},command:e})}launchSection(e,t,n,i){return this.commandHandler({entity:{type:null!=i?i:u.p.settingsstore,action:u.u.view,id:e},command:t,entityOptions:Object.assign(Object.assign({},n),{commandSource:null==t?void 0:t.correlation.source})})}}class sI{constructor(e){this.extensionCommanding=e}launchShareFormDialog(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=d.fe.show,n.stateTransition=d.su.extend,this.extensionCommanding.executeCommand({id:e,type:u.p.shareformdialog,action:u.u.view},{entityCommand:n,entityOptions:null==t?void 0:t.entityOptions})}getDefaultCommand(){return{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:kt.D.ExtensionCommanding}}}}class lI{constructor(e){this.commandHandler=e}viewStore(e,t,n){return this.commandHandler({entity:{type:u.p.store,action:u.u.view,id:e},command:n,entityOptions:t})}showStoreFre(e,t){return this.commandHandler({entity:{type:u.p.storefre,action:u.u.view,id:t},command:{visibilityState:e?d.fe.show:d.fe.hide,stateTransition:d.su.extend,correlation:{source:kt.D.ExtensionCommanding}}})}viewManageAppsTab(e,t){return this.commandHandler({entity:{type:u.p.store,action:u.u.manage},command:t,entityOptions:e})}}!function(e){e.User="user",e.Team="team",e.TeamOwned="teamowned"}(XT||(XT={}));class cI{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}editTeamPicture(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teampicture,action:u.u.view})}viewTeamJoinCode(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamjoincode,action:u.u.view},{entityOptions:{teamJoinCode:t}})}viewTeamRenewal(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamrenewal,action:u.u.view},{entityOptions:{expiryTime:t}})}channelById(e,t){const n={channelId:e};return this.commandHandler({entity:{type:u.p.channels,action:u.u.view,id:JSON.stringify(n)},entityOptions:Object.assign(Object.assign({},null==t?void 0:t.entityOptions),{parentTeamId:null==t?void 0:t.parentTeamId,pinned:null==t?void 0:t.pinned}),command:null==t?void 0:t.entityCommand})}editTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamedit,action:u.u.view},{entityOptions:t})}addMember(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.addmember,action:u.u.view})}addMemberToTeamDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.addmembertoteamdialog,action:u.u.view},{entityOptions:t})}addMemberToPrivateChannelDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.addmembertoprivatechanneldialog,action:u.u.view},{entityOptions:t})}shareChannelWithUserDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.sharechannelwithuserdialog,action:u.u.view},{entityOptions:t})}addMemberToNewTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.addmembernewteam,action:u.u.view},{entityOptions:t})}addChannel(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.addchannel,action:u.u.view})}createChannel(e){return this.extensionCommanding.executeCommand({type:u.p.createchanneldialog,action:u.u.view},{entityOptions:e})}manageApps(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teammanageapps,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTags(e,t,n,i){return this.commandHandler({entity:{id:e,type:u.p.teammanagetags,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:Object.assign(Object.assign({},null==i?void 0:i.entityOptions),{tagId:n}),scenarioEventData:null==i?void 0:i.scenarioEventData,command:(null==i?void 0:i.entityCommand)||this.getDefaultEntityCommand(null!=t?t:kt.D.ChannelListItem)})}leaveTeam(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamleave,action:u.u.view})}createTeam(){return this.extensionCommanding.executeCommand({type:u.p.teamcreate,action:u.u.view})}archiveTeam(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamarchive,action:u.u.view})}restoreTeam(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamrestore,action:u.u.view})}launchConfirmPinUnpinPost(e,t){return this.extensionCommanding.executeCommand({type:u.p.pinunpinpost,action:u.u.view},{entityCommand:t,entityOptions:e})}createTeamOnMainView(e,t){const n=(null==e?void 0:e.source)||Os.IC.template;return this.commandHandler({entity:{id:n,type:u.p.teams,action:u.u.create},entityOptions:e,command:this.getDefaultEntityCommand(null!=t?t:kt.D.ChannelList)})}showListView(){return this.commandHandler({entity:{type:u.p.channels,action:u.u.view},command:this.getDefaultEntityCommand(kt.D.SchoolTeams)})}teamDiscover(){return this.commandHandler({entity:{type:u.p.teamdiscover,action:u.u.view},command:this.getDefaultEntityCommand(kt.D.ChannelListItem)})}manageTeam(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teammanage,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeams(e){return this.commandHandler({entity:{type:u.p.teams,action:u.u.config},command:this.getDefaultEntityCommand(e)})}manageSharedChannelsPendingInvites(e,t,n){return this.commandHandler({entity:{id:n,type:u.p.sharedchannelspendinginvites,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(n)},command:(null==t?void 0:t.entityCommand)||this.getDefaultEntityCommand(e),scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:(null==t?void 0:t.entityOptions)||{commandSource:e}})}manageTeamsList(e,t,n){return this.commandHandler({entity:{id:n,type:u.p.teamslist,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(n)},command:(null==t?void 0:t.entityCommand)||this.getDefaultEntityCommand(e),scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:(null==t?void 0:t.entityOptions)||{commandSource:e}})}crossTeamAnalytics(e,t,n){return this.commandHandler({entity:{id:n,type:u.p.crossteamanalytics,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(n)},command:(null==t?void 0:t.entityCommand)||this.getDefaultEntityCommand(e),scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:null==t?void 0:t.entityOptions})}acceptInvitation(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.sharedchannelacceptinvitation,action:u.u.view},{entityOptions:t})}declineInvitation(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.sharedchanneldeclineinvitation,action:u.u.view},{entityOptions:t})}teamDeepLink(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamdeeplink,action:u.u.view})}channelDeepLink(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channeldeeplink,action:u.u.view})}viewChannelEmail(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channelemail,action:u.u.view})}viewChannelEmailV2(e,t){return this.extensionCommanding.executeCommand({type:u.p.channelemailv2,action:u.u.view},{entityCommand:t,entityOptions:e})}removeChannelEmail(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.removechannelemail,action:u.u.view},{entityCommand:t})}launchChannelEmailErrorDialog(e){return this.extensionCommanding.executeCommand({type:u.p.channelemailerror,action:u.u.view},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:kt.D.ChannelEmail}},entityOptions:{errorCode:e}})}manageChannelConnectors(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.channelconnectors,action:u.u.view},{entityCommand:n,entityOptions:t})}deleteChannel(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.channeldelete,action:u.u.view},{entityOptions:t})}editChannel(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.channeledit,action:u.u.view},{entityOptions:t})}channelModerators(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channelmoderators,action:u.u.view})}manageChannel(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channelmanage,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:{parentTeamId:null==t?void 0:t.parentTeamId},command:this.getDefaultEntityCommand(n||kt.D.ChannelListItem)})}manageChannelAnalytics(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channelanalytics,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelMembers(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channelmembers,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelSettings(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channelsettings,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelInvitations(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channelinvitations,action:u.u.view},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelTags(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channeltags,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId,tagId:null==n?void 0:n.tagId}),command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(null!=t?t:kt.D.ChannelListItem),scenarioEventData:null==n?void 0:n.scenarioEventData})}addChannelMember(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channelroster,action:u.u.manage})}leaveChannel(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channels,action:u.u.leave})}channelNotificationSettings(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.channelnotificationsettings,action:u.u.view},{entityCommand:this.getDefaultEntityCommand(t||kt.D.ChannelListItem),entityOptions:{commandSource:t||kt.D.ChannelListItem,teamName:null==n?void 0:n.teamName,channelName:null==n?void 0:n.channelName}})}shareChannelWithUser(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channels,action:u.u.share},{entityOptions:{shareWith:XT.User}})}shareChannelWithTeam(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channels,action:u.u.share},{entityOptions:{shareWith:XT.Team}})}shareChannelWithTeamOwned(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channels,action:u.u.share},{entityOptions:{shareWith:XT.TeamOwned}})}manageTeamSettings(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teamsettings,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeamAnalytics(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teamanalytics,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeamChannels(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teamchannels,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeamPendingJoinRequest(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teampendingrequests,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}deleteTeam(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teams,action:u.u.delete})}restoreChannel(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.restorechannel,action:u.u.view},{entityOptions:null==t?void 0:t.entityOptions})}showChannelOwners(e){return this.extensionCommanding.executeCommand({type:u.p.showchannelowners,action:u.u.view},{entityOptions:e})}showForMemberDialog(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.showformemberdialog,action:u.u.view})}getChannelLinkedEntity(e){return{id:e||"",type:u.p.channels,action:u.u.list}}getDefaultEntityCommand(e,t=d.su.flush){return{stateTransition:t,visibilityState:d.fe.show,correlation:{source:e}}}}class dI{constructor(e){this.commandHandler=e}openTranscriptTab({entityCommand:e,messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r},s){return this.commandHandler({entity:{type:u.p.transcriptcontent,action:u.u.view},command:e,entityOptions:{messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r,eventId:s}})}openTranscriptInSchedulingForm({entityCommand:e,messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r},s,l){return this.commandHandler({entity:{type:u.p.transcriptcontent,action:u.u.view,linkedEntity:{type:u.p.schedulingform,action:u.u.view,id:JSON.stringify({eventId:(0,RT.cW)(s),providerType:l})}},command:e,entityOptions:{messageId:t,threadId:n,transcriptId:i,isOrganizer:a,eventId:(0,RT.cW)(s),meetingOrganizerId:o,meetingTenantId:r}})}openTranscriptInChatApp({entityCommand:e,messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r},s,l){return this.commandHandler({entity:{id:i,type:u.p.transcriptcontent,action:u.u.view,linkedEntity:l?{type:u.p.chats,action:u.u.view,id:n||""}:null},command:e,entityOptions:{eventId:s?(0,RT.cW)(s):"",isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r,messageId:t,threadId:n,transcriptId:i}})}}class uI{constructor(e,t,n,i){this.extensionCommanding=e,this.commandHandler=t,this.host=n,this.coreSettings=i}virtualEventsList(e){return this.commandHandler({entity:{type:u.p.virtualevents,action:u.u.list},command:e})}virtualEventById(e,t){const{useMeetingExperienceForSchedulingVirtualEvents:n,virtualEventByIdLinkUrl:i}=this.coreSettings.get(L.J.VirtualEvents);return n&&(null==t?void 0:t.stateTransition)===d.su.new?(this.host.open(null==i?void 0:i.replace("{eventId}",e)),Promise.resolve()):this.commandHandler({entity:{type:u.p.virtualevents,action:u.u.view,id:e},command:t})}createVirtualEvent(e,t){const{eventType:n}=e,{useMeetingExperienceForSchedulingVirtualEvents:i,createVirtualEventsLinkUrl:a}=this.coreSettings.get(L.J.VirtualEvents);return i?(this.host.open(null==a?void 0:a.replace("{eventType}",n)),Promise.resolve()):this.commandHandler({entity:{type:u.p.virtualevents,action:u.u.create},command:t,entityOptions:e})}showConfirmationDialog(e){return this.extensionCommanding.executeCommand({type:u.p.virtualevents,action:u.u.confirm},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:kt.D.VirtualEventDetails}},entityOptions:e})}showShareDialog(e){return this.extensionCommanding.executeCommand({type:u.p.virtualevents,action:u.u.share},{entityCommand:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:kt.D.VirtualEventDetails}},entityOptions:e})}}class mI{constructor(e){this.commandHandler=e}openWikiTab(e,t,n,i){const a={entity:{action:u.u.view,id:e,linkedEntity:i,type:u.p.wiki},command:t,entityOptions:n};return this.commandHandler(a)}}class gI{constructor(e){this.commandHandler=e}qnaById(e,t,n){return this.commandHandler({entity:{type:u.p.yammerqna,action:u.u.view,id:e},command:t,entityOptions:n})}}class pI{constructor(e){this.commandHandler=e}launch(e){return this.commandHandler({entity:{type:u.p.teamsgallery,action:u.u.view},command:e})}launchSection(e){return this.commandHandler({entity:{type:u.p.teamsgallery,action:u.u.view,id:e},command:{stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:kt.D.TeamsGallery}}})}launchTeamsGallery(){return this.commandHandler({entity:{type:u.p.teamsgallery,action:u.u.view,id:""},command:{stateTransition:d.su.flush,visibilityState:d.fe.show,correlation:{source:kt.D.TeamsGallery}}})}}class vI{constructor(e){this.commandHandler=e}callList(e,t){return this.commandHandler({entity:{id:e,type:u.p.callsmain,action:u.u.view},command:t})}contactList(e,t){return this.commandHandler({entity:{type:u.p.callsmain,action:u.u.list},command:e,entityOptions:null==t?void 0:t.entityOptions,scenarioEventData:null==t?void 0:t.scenarioEventData})}}class hI{constructor(e){this.extensionCommanding=e}launchUnifiedConsent(e){this.extensionCommanding.executeCommand({type:u.p.unifiedconsentdialog,action:u.u.view},{entityOptions:Object.assign({},e)})}}class fI{constructor(e){this.extensionCommanding=e}stopSharingChannelWithTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.stopsharingchannelwithteam,action:u.u.view},{entityOptions:null==t?void 0:t.entityOptions})}createSharedChannelInvitationDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.sharedchannelcreateinvitationsdialog,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:t}},entityOptions:n})}acceptSharedChannelInvitationDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.acceptsharedchannelinvitationdialog,action:u.u.view},{entityOptions:t})}shareWithTeamYouOwnDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.sharewithteamyouowndialog,action:u.u.view},{entityOptions:t})}showForMemberDialogV2(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.showformemberdialogv2,action:u.u.view},{entityOptions:t})}getChannelLinkedEntity(e){return{id:e||"",type:u.p.channels,action:u.u.list}}}class yI{constructor(e){this.extensionCommanding=e}launchTeamsErrorDialog(e,t,n,i,a){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamserrordialog,action:u.u.view},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:a}},entityOptions:{titleString:t,contentString:n,buttonString:i}})}getLinkToTeamOrChannelDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.getlinktoteamorchanneldialog,action:u.u.view},{entityCommand:t,entityOptions:e})}denyInvitationConfirmDialog(){return this.extensionCommanding.executeCommand({type:u.p.sharedchanneldenyinvitation,action:u.u.view},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:kt.D.ChannelInvitations}}})}launchConfirmLeaveChannel(e,t){return this.extensionCommanding.executeCommand({type:u.p.leavechanneldialog,action:u.u.view},{entityCommand:t,entityOptions:e})}launchLeaveChannelLastOwnerDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.leavechannellastownerdialog,action:u.u.view},{entityCommand:t,entityOptions:e})}launchRestoreChannelDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.restorechannelreactdialog,action:u.u.view},{entityCommand:t,entityOptions:e})}launchDeleteChannelDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.deletechannelreactdialog,action:u.u.view},{entityCommand:t,entityOptions:e})}launchStopSharingChannelWithTeamDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.stopsharingchannelwithteamreactdialog,action:u.u.view},{entityCommand:t,entityOptions:e})}archiveTeamT2(e,t,n,i){return this.extensionCommanding.executeCommand({id:t,type:u.p.archiveteam,action:u.u.view},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:i}},entityOptions:{teamName:n,groupId:e,threadId:t}})}deleteTeamT2(e,t,n,i){return this.extensionCommanding.executeCommand({id:t,type:u.p.deleteteam,action:u.u.view},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:i}},entityOptions:{teamName:n,groupId:e,threadId:t}})}leaveTeamT2(e,t,n,i){return this.extensionCommanding.executeCommand({id:t,type:u.p.leaveteam,action:u.u.view},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:i}},entityOptions:{teamName:n,groupId:e,threadId:t}})}restoreTeamT2(e,t,n,i){return this.extensionCommanding.executeCommand({id:t,type:u.p.restoreteam,action:u.u.view},{entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:i}},entityOptions:{teamName:n,groupId:e,threadId:t}})}}const bI=(e,t,n,i,a,o,r,s,l,c,d,u=he.ew,m,g)=>{const p=new tT(e,i,u,r,s),v=new q_(o,e,p,r,s,l,a,d,m,g);return{entityCommanding:{account:new bT(e),activity:new ST(e,p),authentication:new CT(e,p,v,i),autoinstallnotification:new _T(e),biometricEnrollment:new TT(e),brbFeedback:new IT(e,p),breakoutRooms:new ET(e),broadcast:new NT(e),calendar:new AT(p,e),call:new FT(e,p,d),callsMain:new vI(e),campaignNotifications:new DT(e),channel:new Pb(e,p),chat:new xT(e,p,a,s),coachReport:new MT(e),contacts:new PT(e,p),deepLink:v,destroy:()=>p.destroy(),discoverSurface:new UT(e,s),discoverappsnotifications:new LT(e),error:new jT(e),esp:new $T(e,p),feedback:new BT(e,p),file:new WT(p,e),flyout:new HT(e),freemiumUpgrade:new VT(e),guardians:new zT(e),homepage:new qT(e),meetingAnalytics:new QT(e),meetingRecap:new YT(e),meetingRoom:new eI(e),meetingOptions:new KT(e,p),nova:new aT(e),platform:new nI(e,p,a),registration:new iI(e,a),school:new aI(e,p),search:new oI(e,p),settings:new rI(e),shareForm:new sI(p),shell:new vT(e,p,c,u,o,a,s),store:new lI(e),lobnotifications:new JT(e),lms:new GT(p),onboardingnotifications:new tI(e),teamsAndChannels:new cI(e,p),teamsAndChannelsDialogs:new fI(p),teamsAndChannelsConfirmationDialogs:new yI(p),teamsGallery:new pI(e),toasts:new fT(e,d),transcript:new dI(e),unifiedConsent:new hI(p),virtualEvents:new uI(p,e,o,a),yammerQna:new gI(e),wiki:new mI(e),communities:new OT(e,p)},eventing:new c_(n,e,t)}},SI=new Set(["com.microsoft.teams.activity","com.microsoft.teams.calling"]);class kI{constructor(e,t,n,i,a,o,r,s){this._appsRegistry=e,this._client=t,this._commandResultChangeReportingService=n,this._coreSettings=i,this._entityCommanding=a,this._loggerFactory=o,this._scenarioFactory=r,this._userContextId=s}init(){this._changes&&this.destroy(),this._changes=this._commandResultChangeReportingService.observeChanges().pipe((0,jw.h)((e=>e.userContextId===this._userContextId))).subscribe((e=>this.executeOnCommandResultAppHooks(e)))}destroy(){var e;null===(e=this._changes)||void 0===e||e.unsubscribe(),this._changes=void 0}executeOnCommandResultAppHooks({context:{entityCommand:e,error:t},type:n}){var i,a;if(!e)return;const o=e.command.correlation.scenarioName===it.RG.ActivitySwitch,r=e.entity.type,s=r&&this._appsRegistry.getApp({entityType:o?u.p.activity:r}),l=null==s?void 0:s.onCommandResult;if(s&&SI.has(s.manifest.id)&&l)try{l({requestContext:{client:this._client,coreSettings:this._coreSettings,entityCommanding:this._entityCommanding,error:t,loggerFactory:this._loggerFactory,scenarioFactory:this._scenarioFactory},entityCommand:e,result:n})}catch(e){null===(a=(i=this._loggerFactory.newLogger("command-result-hooks-service","core-services-entity-commanding")).errorToTelemetry)||void 0===a||a.call(i,`App ${null==s?void 0:s.manifest.name} failed to execute entity command hook 'OnAfterCommandResolved' with ""${e.name}"" error`,"entity_command_hook",{errors:`${e.name}`},!0)}}}var wI=n(257065),CI=n(283202),_I=n(871543);function TI(e){return function(e){const t=EI(e),n=1,i=2,a=3;if(!t)return e;if(t[a])return t[n].replace(t[i],t[a]);return t[n]}(e)}function II(e){return e.message&&(e.message=TI(e.message)),e.stack&&(e.stack=function(e){if(EI(e.message))return"Sanitized due to potential PII leaks.";return e.stack}(e)),e}function EI(e){return new RegExp(/(Can't find field ((chat)\(.*\)|.*) on object)/).exec(e)}const NI=/-extension:\/\//;function AI(e){return e===he.jK.TimedOut}class FI{constructor(e,t,n,a,o,r){this.host=e,this.scenarioFactory=t,this.platformService=n,this.networkStateProvider=a,this.diagnosticsService=o,this.coreSettings=r,this._onWindowError=e=>{if(function(e){return e&&("resizeobserver loop limit exceeded"===e.message.toLowerCase()||NI.test(e.filename))}(e))return!0;const{colno:t,filename:n,lineno:i,message:a}=e;let{error:o}=e;const r=!!o&&AI(o.code);return o=o?II(o):new Error(TI(a)),this._reportError(it.RG.GlobalWindowError,Object.assign(o,{colno:t,filename:n,lineno:i}),he.jK.UndefinedWindowError,r),!0},this._onUnhandledPromiseRejection=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{reason:t}=e,n=!!t&&AI(t.code);return this._reportError(it.RG.UnhandledRejection,t,he.jK.UnhandledPromiseRejection,n)})),e.addEventListener(n_.cr.UnhandledRejection,this._onUnhandledPromiseRejection),e.addEventListener(n_.cr.GlobalWindowError,this._onWindowError)}dispose(){this.host.removeEventListener(n_.cr.UnhandledRejection,this._onUnhandledPromiseRejection),this.host.removeEventListener(n_.cr.GlobalWindowError,this._onWindowError)}set error(e){this.persistDiagnostics(),void 0!==e&&(this._error=e,this._reportError(it.RG.FatalError,e,he.jK.UndefinedGlobalError,!0))}get error(){return this._error}_reportError(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{code:o=n,context:r=""}=t||{},s=""===r?`${o}`:`${r}:${o}`,l=(0,An._S)((0,la.A)((0,An.B9)(t)));let c="";try{c=this.extractError(t)}catch(e){c="Stringifying error failed"}const d=`[${c}]`;this.scenarioFactory.newScenario(e).fail({message:l,errorCode:s,errors:d,showOops:a,"AppInfo.NetworkState":this.networkStateProvider.isOnline()?"Online":"Offline"});let u=Promise.resolve();if(a){const e=1e3;u=(0,Fn.E)(CI.ip.getInstance().flush(),e),this.persistDiagnostics()}const m=this.platformService.config.clientVersion;return u.catch((()=>this.diagnosticsService.pushDiagnosticsEvent(wI.i.Warn,"Could not flush telemetry logs in time",!0))).then((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{disableSendingLogsToHost:e}=this.coreSettings.get(L.J.Diagnostics);if(!e){const e=yield this.diagnosticsService.getDiagnosticsEvents(1e3);this.host.opener.postMessage(n_.rY.WindowErrored,{errorCode:s,errorDescription:l,errorMsg:c,logs:e,showOops:a,clientVersion:m})}}))))}))}extractError(e){const{scrubStackTrace:t}=this.coreSettings.get(L.J.Core),n=t?[]:[_I.A4.SmtpAddress,_I.A4.IPV4Address,_I.A4.IPv6Address,_I.A4.PhoneNumber];return(0,la.A)(JSON.stringify(e,(0,An.cm)()),n)}persistDiagnostics(){this.diagnosticsService.persistDiagnostics()}}var DI=n(420990);const RI={[DI.vW.Background]:"background",[DI.vW.UserVisible]:"user-visible"};class xI{constructor(e,t,n){this.host=e,this.postTaskSchedulerDiagnosticsService=n,this.postTaskMap=new Map,this.logger=t.newLogger("PostTaskScheduler","core-services-scheduling")}schedule(e,t,n,i){const a=RI[t.priority],o=new AbortController;return this.host.scheduler.postTask((()=>(this.postTaskSchedulerDiagnosticsService.markTaskDequeued(i,t.id),e())),{signal:o.signal,priority:a}).then((()=>{this.postTaskMap.delete(i)})).catch((()=>{var e,n;this.postTaskMap.delete(i),null===(n=(e=this.logger).errorToTelemetry)||void 0===n||n.call(e,`PostTaskScheduler: Job failed ${i}, ${t.id}`,"webclient_framework_foundation_core_services_scheduling")})),this.postTaskMap.set(i,{controller:o}),this.postTaskSchedulerDiagnosticsService.markTaskEnqueued(i,t.id),i}cancel(e){const{controller:t}=this.postTaskMap.get(e)||{};t&&(t.abort(),this.postTaskMap.delete(e))}destroy(){this.postTaskMap.forEach(((e,t)=>{this.cancel(t),this.postTaskMap.delete(t)}))}}var MI;!function(e){e.JobChange="job_change"}(MI||(MI={}));class OI{constructor(e,t,n,i,a,o,r){this._jobHandle=e,this._changes=t,this._meta=n,this._job=i,this._windowId=o,this._correlationId=r,this._timing={received:0,started:0,completed:0,canceled:0},this._execution=DI.Tf.None,this._logger=a.newLogger("Scheduled Job","core-services-scheduling")}receive(){this._timing.received=Date.now(),this._execution=DI.Tf.Received,this.reportJobChange()}execute(){if(this._execution===DI.Tf.Canceled)return;if(this._execution!==DI.Tf.Received)throw new Error("Unable to execute a job that has not been received");let e;this._timing.started=Date.now(),this._execution=DI.Tf.Started;try{this.reportJobChange();const t=this._job();e=t instanceof Promise?t:Promise.resolve(t)}catch(t){this._logger.error(`Job with ID:${this._meta.id} failed to execute or rejected with error: ${t.message?t.message:t}`),e=Promise.reject(t)}this.complete(e)}equals(e){return this._jobHandle===e}cancel(){return this._timing.canceled=Date.now(),this._execution=DI.Tf.Canceled,this.reportJobChange(),{meta:this._meta,job:this._job}}complete(e){const t=e=>{let t;return this._timing.completed=Date.now(),this._execution=DI.Tf.Complete,this.isError(e)&&(t={message:e.message,code:e.code,context:e.context,name:e.name}),this.reportJobChange(t),e};e.then(t).catch(t)}isError(e){return!!e&&e instanceof Error}reportJobChange(e){this._changes.report({correlationId:this._correlationId,type:MI.JobChange,context:Object.assign(Object.assign({},this.toChangeState()),{target:"job",error:e}),windowId:this._windowId})}toChangeState(){return{handle:this._jobHandle,timing:this._timing,execution:this._execution,meta:this._meta}}}var PI=n(424413);class LI extends PI.default{remove(e,t){const n=[];let i;return this.forEach((a=>{t(a,e)?i=a:n.push(a)})),i&&(this.clear(),n.forEach((e=>this.enqueue(e)))),i}}const UI=(e,t)=>e.equals(t),jI=()=>0;class $I{constructor(e,t,n,i){this._jobExecutor=e,this._supportedPriority=t,this._changes=n,this._loggerFactory=i,this._logger=i.newLogger("GreedyJobExecutionQueue","core-services-scheduling"),this._queue=new LI(jI)}clearExecutionSchedule(){this._jobExecutor.clearExecutionSchedule(),this._queue.clear()}cancel(e){const t=this._queue.remove(e,UI);return t&&t.cancel()}enqueue(e,t,n,i,a){if(n.priority!==this._supportedPriority)return this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job priroty [${DI.vW[n.priority]}] not supported by this queue, this queue supports [${DI.vW[this._supportedPriority]}]`,"webclient_framework_foundation_core_services_scheduling",void 0,!0),!1;const o=new OI(e,this._changes,n,t,this._loggerFactory,i,a);return this._queue.enqueue(o)?(o.receive(),this._jobExecutor.scheduleExecution({getJob:()=>this._queue.dequeue()}),!0):(this._logger.errorToTelemetry&&this._logger.errorToTelemetry("PriorityQueue did not enqueue the job","webclient_framework_foundation_core_services_scheduling",void 0,!0),!1)}}class BI{constructor(e,t,n){this._schedule=e,this._clearSchedule=t,this._logger=n}clearExecutionSchedule(){this._executionHandle&&this._clearSchedule(this._executionHandle)}scheduleExecution(e){this._executionHandle||(this._executionHandle=this._schedule((()=>{this._executionHandle=void 0,this.execute(e)})))}execute({getJob:e}){let t;for(;t=e();)try{t.execute()}catch(e){this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job executor caught an exception executing a job. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0)}}}class WI{constructor(e,t,n,i){this._changes=e,this._loggerFactory=n,this._windowId=i,this._logger=n.newLogger("QueueScheduler","core-services-scheduling"),this._queues=new Map,this.createQueues(t)}destroy(){this._queues.forEach((e=>{e.clearExecutionSchedule()}))}schedule(e,t,n,i){const a=this._queues.get(t.priority);return a?(a.enqueue(i,e,t,this._windowId,n),i):(this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job priority [${DI.vW[t.priority]}] supplied by ${t.scheduledById} not supported by scheduling`,"webclient_framework_foundation_core_services_scheduling",void 0,!0),DI.o_)}cancel(e){let t;if(e===DI.o_)return t;const n=Array.from(this._queues.values());for(const i of n)if(t=i.cancel(e),t)break;return t}createQueues(e){this.createQueue(DI.vW.Macro,(t=>e.setTimeout(t)),(t=>e.clearTimeout(t))),this.createQueue(DI.vW.RenderBlocking,(t=>e.requestAnimationFrame(t)),(t=>e.cancelAnimationFrame(t)))}createQueue(e,t,n){const i=new BI(t,n,this._logger),a=new $I(i,e,this._changes,this._loggerFactory);this._queues.set(e,a)}}var HI;!function(e){e.PostTask="PostTask",e.Queue="Queue"}(HI||(HI={}));const VI={[DI.vW.Background]:HI.PostTask,[DI.vW.Macro]:HI.Queue,[DI.vW.RenderBlocking]:HI.Queue,[DI.vW.UserVisible]:HI.PostTask};class zI{constructor(e,t,n,i,a){const o=new WI(e,t,n,i),r=new xI(t,n,a);this.activeSchedulers=new Map([[HI.PostTask,r],[HI.Queue,o]])}static get nextJobHandle(){return this._nextJobHandle===Number.MAX_SAFE_INTEGER&&(this._nextJobHandle=0),++this._nextJobHandle}destroy(){this.activeSchedulers.forEach((e=>{e.destroy()}))}schedule(e,t,n){return this.findScheduler(t.priority).schedule(e,t,n,zI.nextJobHandle)}cancel(e){for(const t of this.activeSchedulers.values()){const n=t.cancel(e);if(n)return n}}findScheduler(e){const t=this.activeSchedulers.get(VI[e]);if(!t)throw new Error("No scheduler found for priority");return t}}zI._nextJobHandle=0;const qI=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const[i,o]=yield Promise.all([t.getUser({correlation:n}),GI(t,n,a)]);if(o)for(const t of o)e.setContext("UserInfo.IsMRU",void 0,void 0,t.id);e.setContext("UserInfo.IsMRU",!0,void 0,i.id)})),GI=(e,t,n)=>{if(n)return Promise.resolve(n);const i=e.getCachedUsers;return i?i(t):void 0},JI=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,r,s;const l={id:a.id,source:a.source,scenarioName:it.RG.AuthWebUser};try{const[a,o]=yield Promise.all([null===(i=n.getCachedUsers)||void 0===i?void 0:i.call(n,l,{isAllCachedUsers:!0,isAuthenticated:!0}),null===(r=n.getCachedUsers)||void 0===r?void 0:r.call(n,l,{isPrimaryUser:!0})]);if(qI(t,n,l,a),Array.isArray(a)){for(const e of a)t.setContext("UserInfo.IsPrimary",void 0,void 0,e.id);const e=a.filter((e=>e.profile.isHomeAccount)).length;t.setCoreContext("uniqueCredentialCount",e),t.setCoreContext("mtmaAccounts",a.length)}if(Array.isArray(o)){const[n,i]=o;e?t.setContext("UserInfo.IsPrimary",!0,void 0,n.id):(t.setCoreContext("primaryUserInfoId",n.profile.oid),t.setCoreContext("primaryUserInfoTenantId",n.profile.tid))}}catch(e){null===(s=o.errorToTelemetry)||void 0===s||s.call(o,"Failed to update MRU or sync mtma context","telemetry_instrumentation_update_user_context")}})),QI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"performWindowHistoryNavigation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"navigationDirection"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NavigationDirection"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"performWindowHistoryNavigation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"navigationDirection"},value:{kind:"Variable",name:{kind:"Name",value:"navigationDirection"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},KI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"navigateToWindowHistoryIndex"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowHistoryIndex"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"navigateToWindowHistoryIndex"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"windowHistoryIndex"},value:{kind:"Variable",name:{kind:"Name",value:"windowHistoryIndex"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class YI{constructor(e,t,n,a){this._client=e,this._host=t,this._coreSettings=n,this._windowId=a,this.onPopState=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t;this.navigateTo((null===(t=e.state)||void 0===t?void 0:t.windowHistoryIndex)||0)}))}init(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.hostHistoryNavigationEnabled&&this._host.addEventListener("popstate",this.onPopState)}))}destroy(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.hostHistoryNavigationEnabled&&this._host.removeEventListener("popstate",this.onPopState)}))}navigate(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.mutate(QI,{navigationDirection:e})}))}navigateTo(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.mutate(KI,{windowHistoryIndex:e})}))}get hostHistoryNavigationEnabled(){var e;return(null===(e=this._coreSettings.get(L.J.Core))||void 0===e?void 0:e.enableHostHistoryNavigation)||!1}mutate(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this._client.mutate({mutation:e,variables:Object.assign(Object.assign({},t),{windowId:this._windowId}),fetchPolicy:"no-cache"})}))}}var XI=n(732436);const ZI={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},eE={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"windowStateEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowStateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isFocused"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"shouldClose"}}]}}]}}]};class tE{report(e){if(!this._changes||0===this._changes.observers.length)return;const t=e.changeCorrelationId||(0,Ye.v4)();this.changes.next(Object.assign(Object.assign({},e),{changeCorrelationId:t}))}observeChanges(){return this.changes.asObservable()}get changes(){return this._changes||(this._changes=new K_.xQ),this._changes}}class nE{constructor(e,t){this.parentContext=e,this.pulsarLibraryInstance=t}startSignal(e,t){return this.pulsarLibraryInstance.startSignal(e,t,this.parentContext)}}class iE{constructor(e,t,n,i){this.logger=e,this.span=t,this.pulsarLibraryInstance=i,this.pulsarLibraryInstance.otlDependencies?this.signalContext=this.pulsarLibraryInstance.otlDependencies.trace.setSpan(n,t):this.logger.error("PulsarSignal: otlDependencies is not defined")}stop(e){this.span.setStatus(e),this.span.end()}appendEventData(e,t){this.span.setAttributes(iE.eventDataToAttributes(e,t))}addEvent(e){this.span.addEvent(e)}getPulsarContext(){return new nE(this.signalContext,this.pulsarLibraryInstance)}propagate(){if(!this.signalContext)return void this.logger.error("propagate: signalContext is not defined");const{W3CTraceContextPropagator:e,defaultTextMapSetter:t}=this.pulsarLibraryInstance.otlDependencies,n={};return(new e).inject(this.signalContext,n,t),n}static eventDataToAttributes(e,t){const n={};return Object.keys(t).forEach((i=>{n[`${e}.${i}`]=t[i]})),n}}var aE,oE,rE;!function(e){e.TEAMS_CORE="Teams.Core",e.TEAMS_RENDERING="Teams.Rendering",e.TEAMS_RESOLVER="Teams.Resolver"}(aE||(aE={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(oE||(oE={})),function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(rE||(rE={}));class sE{constructor(e,t){this.exporter=e,this.otlDependencies=t,this._shutdownOnce=new this.otlDependencies.BindOnceFuture(this._shutdown,this)}forceFlush(){return Promise.resolve()}onStart(e){this.export(e,"onStart")}onEnd(e){this._shutdownOnce.isCalled||0!=(e.spanContext().traceFlags&rE.SAMPLED)&&this.export(e,"onEnd")}shutdown(){return this._shutdownOnce.call()}export(e,t){const{context:n,suppressTracing:i,ExportResultCode:a,globalErrorHandler:o}=this.otlDependencies;n.with(i(n.active()),(()=>{this.exporter.export([e],(e=>{var t;e.code!==a.SUCCESS&&o(null!==(t=e.error)&&void 0!==t?t:new Error(`PulsarSpanProcessor: span export failed (status ${e})`))}),t)}))}_shutdown(){return this.exporter.shutdown()}}var lE=n(796868);class cE{constructor(e,t){this.serviceName=e,this.config=t,this.consumerNotificationObserver=new K_.xQ,this.logger=t.loggerFactory.newLogger("PulsarLib","frameworks-pulsar"),this.sessionId=t.sessionId}initialize(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield this.importOTLDependencies(),this.initOTL()}))}shutdown(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield null===(e=this.provider)||void 0===e?void 0:e.shutdown()}))}startSignal(e,t,n){if(!this.tracer)return void this.logger.error("startSignal: tracer is not initialized");const i=n||this.otlDependencies.ROOT_CONTEXT,a=this.tracer.startSpan(e,t,i);return a.setAttribute("sessionId",this.sessionId),new iE(this.logger,a,i,this)}startSignalFromCarrier(e,t,n){if(!t)return;if(!this.otlDependencies)return void this.logger.error("startSignalFromCarrier: OTL dependencies are not initialized");const{W3CTraceContextPropagator:i,ROOT_CONTEXT:a,defaultTextMapGetter:o}=this.otlDependencies,r=(new i).extract(a,t,o);return this.startSignal(e,n,r)}observeConsumerNotifications(){return this.consumerNotificationObserver.asObservable()}initOTL(){if(!this.otlDependencies)return void this.logger.error("initOTL: OTL dependencies are not initialized");const{WebTracerProvider:e,Resource:t,SemanticResourceAttributes:n,SimpleSpanProcessor:i,OTLPTraceExporter:a}=this.otlDependencies;this.provider=new e({resource:new t({[n.SERVICE_NAME]:this.serviceName})}),this.config.spanExporter.registerConsumerNotificationCallback((e=>{this.consumerNotificationObserver.next(e)})),this.provider.addSpanProcessor(new sE(this.config.spanExporter,this.otlDependencies)),this.config.logToOTLCollector&&this.provider.addSpanProcessor(new i(new a({url:"http://localhost:4318/v1/traces"}))),this.tracer=this.provider.getTracer("pulsar-tracer")}importOTLDependencies(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.otlDependencies=yield(0,lE.m)()}))}}class dE{constructor(){this.hasShutdown=!1,this.telemetryProvider=(0,pT.G)(),this.telemetryProvider.registerPulsarBackchannelListener(this.notify.bind(this))}export(e,t,n){this.hasShutdown||e.forEach((e=>{switch(n){case"onStart":this.telemetryProvider.sendPulsarSignal({type:"onStart",span:this.sanitizeSpan(e)});break;case"onEnd":this.telemetryProvider.sendPulsarSignal({type:"onEnd",span:this.sanitizeSpan(e)})}}))}registerConsumerNotificationCallback(e){this.consumerNotificationCallback=e}shutdown(){return this.hasShutdown=!0,Promise.resolve()}notify(e){var t;null===(t=this.consumerNotificationCallback)||void 0===t||t.call(this,e)}sanitizeSpan(e){return Object.assign(Object.assign({},e),{_spanProcessor:void 0,_clock:void 0})}}const uE=(e,t,n)=>{const{enableThemePreferenceResolution:i}=t.get(L.J.Core),{environment:a}=t.get(L.J.Metadata);if(i){const t=(0,XI.R6)(null!=a?a:s_.s.prod);return(0,XI.u_)(e,n,t)}return t.get(L.J.Host).theme||"default"},mE=(e,t)=>e.subscribe({query:eE,variables:{windowId:t}}),gE=(e,t,n,i,a,o,r)=>{const{isFocused:s,shouldClose:l,correlation:c}=e&&e.data&&e.data.windowStateEvent;let d;const u=null==c?void 0:c.id;l?(t.close(),r.log(`host.close() called through window state event with correlationId ${u}`),d=wC.B.Close):s&&(t.isFocused()?(r.log(`host.isFocused() returns true with correlationId ${u}`),d=wC.B.AlreadyFocused):(t.focus(),r.log(`host.focus() called through window state event with correlationId ${u}`),d=wC.B.Focus,o.loadModule("windowcontrols").then((e=>{var t;null===(t=null==e?void 0:e.focus)||void 0===t||t.call(e,n),r.log(`HostComms focus() called through window state event with correlationId ${u}`)})))),d&&u&&(i.report({context:{target:"handle-window-state-event"},correlationId:u,type:d}),a.report({type:l_.FV.WindowStateChange,context:{target:"context-providers-handle-window-event"},correlationId:u,windowId:n}))},pE=(e,t)=>(0,Lw.U)((n=>((e,t,n)=>(n&&(e._cleanupFns||(e._cleanupFns=[]),e._cleanupFns.push(n)),Object.assign(Object.assign({},e),t)))(n,e(n),t))),vE=e=>pE((t=>({regenerateEntityCommandingServices:(n,i,a)=>(({appsRegistryService:e,client:t,clientPreferences:n,clientLaunchId:i,commandChangeReportingService:a,coreSettings:o,deeplinkService:r,hostCommunicationService:s,loggerFactory:l,notificationsHandler:c,platformService:d,scenarioFactory:u,userContextId:m,viewEntitiesRef:g,viewEntity:p,viewEntityName:v,windowId:h,windowProvider:f,userBiService:y})=>bI((n=>nT({appsRegistryService:e,client:t,clientLaunchId:i,commandChangeReportingService:a,coreSettings:o,entityCommandInput:n,loggerFactory:l,platformService:d,scenarioFactory:u,windowId:h,executionContext:{userContextId:m,viewEntity:p,viewEntityName:v},windowProvider:f,userBiService:y,notificationsHandler:c})),((r,s)=>p_({appsRegistryService:e,client:t,clientPreferences:n,clientLaunchId:i,commandChangeReportingService:a,coreSettings:o,commandInput:r,commandHandler:s,loggerFactory:l,scenarioFactory:u,windowId:h,executionContext:{userContextId:m,viewEntitiesRef:g,viewEntity:p,viewEntityName:v},host:f,userBiService:y})),((r,s,d)=>y_({appsRegistryService:e,client:t,clientPreferences:n,clientLaunchId:i,commandChangeReportingService:a,coreSettings:o,eventInput:r,commandDelegator:d,commandHandler:s,loggerFactory:l,notificationsHandler:c,scenarioFactory:u,userBiService:y,windowId:h,executionContext:{userContextId:m,viewEntitiesRef:g,viewEntity:p,viewEntityName:v}})),t,o,f,u,l,r,s,m,h,p,i))({appsRegistryService:t.appsRegistryService,client:t.client,clientPreferences:t.clientPreferences,clientLaunchId:t.correlation.clientLaunchId||void 0,commandChangeReportingService:t.commandChangeReportingService,coreSettings:t.coreSettings,deeplinkService:t.deeplinkService,hostCommunicationService:t.hostCommunicationService,loggerFactory:t.loggerFactory,notificationsHandler:t.notificationsHandler,platformService:t.platformService,scenarioFactory:t.scenarioFactory,userContextId:t.authenticationUser?(0,di.b4)(t.authenticationUser):void 0,viewEntitiesRef:n,viewEntity:i,viewEntityName:a,cdlWorkerRegistrarService:t.cdlWorkerRegistrarService,windowId:e,windowProvider:t.windowProvider,userBiService:t.userBiService})}))),hE=(e,t,n,i,a,o,r,s)=>e.pipe((e=>e.pipe((e=>pE((()=>({windowProvider:e}))))(o),(e=>pE((t=>({loggerFactory:new Kw.m(t.diagnosticsService,e)}))))(n),((e,t)=>pE((({loggerFactory:n,postTaskSchedulerDiagnosticsService:i})=>({scheduler:new zI(new tE,t,n,e,i)})),(({scheduler:e})=>e.destroy())))(n,o),((e,t)=>pE((n=>{const i=n.windowProvider.viewportContext,a=t.type,o=n.coreSettingsContext.createContextForViewport({id:e,viewportContext:i,entityType:a}),r=o.getCoreSettings();return{coreSettingsContext:o,coreSettings:r}}),(({coreSettingsContext:e})=>e.cleanup())))(n,s),(e=>pE((()=>({scenarioFactory:e})),(({scenarioFactory:e})=>e.destroy())))(t),(e=>pE((t=>({userBiService:t.telemetryService.createUserBiService(t,e,{id:t.correlation.id,startTimestamp:+t.correlation.startTimestamp||0,source:t.correlation.source})})),(({userBiService:e})=>e.destroy())))(n),((e,t)=>pE((({experienceChangeReportingService:n,authenticationUser:i})=>({experienceChangeReportingService:Object.assign(Object.assign({},n),{report:a=>{n.report(Object.assign({windowId:e,isMainWindow:t,userContextId:i?(0,di.b4)(i):void 0},a))}})}))))(n,i),((e,t)=>pE((({appBarService:n,appsRegistryService:i,appStateService:a,authenticationService:o,authenticationUser:r,cacheStorage:s,cdlWorkerService:l,client:c,clientPreferences:d,clientState:u,commandChangeReportingService:m,coreSettings:g,dataCleanupService:p,discover:v,experienceChangeReportingService:h,hostCommunicationService:f,localStorage:y,loggerFactory:b,notificationsHandler:S,offlineCacheManager:k,platformService:w,rebootService:C,scenarioFactory:_,user:T,userBiService:I,windowProvider:E,i18n:N,brbServiceManager:A,entityCommanding:F,pulsar:D,cdlAppStateService:R})=>{var x,M;const O=c,P={appBarService:n,appsRegistryService:i,appStateService:a,authenticationService:o,authenticationUser:r,cacheStorage:s,cdlWorkerService:l,clientPreferences:d,clientState:u,commandChangeReportingService:m,coreSettings:g,dataCleanupService:p,discover:v,entityType:t,experienceChangeReportingService:h,hostCommunicationService:f,localStorage:y,loggerFactory:b,notificationsHandler:S,offlineCacheManager:k,platformService:w,pubsub:O.getServices().pubsub,rebootService:C,scenarioFactory:_,user:T,userBiService:I,windowId:e,windowProvider:E,i18n:N,brbServiceManager:A,entityCommanding:F,pulsar:D,cdlAppStateService:R},{enableViewSchema:U}=g.get(L.J.Core);return{client:O.clone(P),viewSchemaClient:U?null===(M=(x=O).cloneForViewSchema)||void 0===M?void 0:M.call(x,P):null}}),(({client:e,entityCommanding:t,viewSchemaClient:n,coreSettings:i})=>(null==n||n.destroy(),e.destroy(),i.get(L.J.Core).enableMTMA&&(null==e||e.clearCache()),t.destroy()))))(n,s.type))),(e=>e.pipe(((e,t)=>pE((n=>(e&&n.notificationsHandler.isCustomNotificationEnabled()&&n.notificationsHandler.initialize(t),{notificationsHandler:n.notificationsHandler})),(()=>{})))(a,n),((e,t)=>pE((n=>{var i;const{appsRegistryService:a,authenticationUser:o,client:r,commandResultChangeReportingService:s,coreSettings:l,correlation:{clientLaunchId:c},deeplinkService:d,hostCommunicationService:u,loggerFactory:m,scenarioFactory:g}=n,{entityCommanding:p,eventing:v}=bI((t=>nT({appsRegistryService:n.appsRegistryService,client:n.client,clientLaunchId:n.correlation.clientLaunchId||void 0,commandChangeReportingService:n.commandChangeReportingService,coreSettings:n.coreSettings,entityCommandInput:t,loggerFactory:n.loggerFactory,notificationsHandler:n.notificationsHandler,platformService:n.platformService,scenarioFactory:n.scenarioFactory,executionContext:{userContextId:n.authenticationUser?(0,di.b4)(n.authenticationUser):void 0},windowId:e,userBiService:n.userBiService}).then()),((i,a)=>p_({appsRegistryService:n.appsRegistryService,client:n.client,clientPreferences:n.clientPreferences,commandChangeReportingService:n.commandChangeReportingService,coreSettings:n.coreSettings,commandInput:i,commandHandler:a,loggerFactory:n.loggerFactory,scenarioFactory:n.scenarioFactory,windowId:e,host:t,userBiService:n.userBiService})),((t,i,a)=>y_({appsRegistryService:n.appsRegistryService,client:n.client,clientPreferences:n.clientPreferences,commandChangeReportingService:n.commandChangeReportingService,commandDelegator:a,commandHandler:i,coreSettings:n.coreSettings,eventInput:t,loggerFactory:n.loggerFactory,notificationsHandler:n.notificationsHandler,scenarioFactory:n.scenarioFactory,userBiService:n.userBiService,windowId:e})),r,l,t,g,m,d,u,o?(0,di.b4)(o):void 0,e,void 0,c||void 0);let h=n.commandResultHooksService;return h&&(null===(i=l.get(L.J.Core))||void 0===i?void 0:i.enableStandaloneCommandReportingService)&&(h=new kI(a,r,s,l,p,m,g,n.authenticationUser&&(0,di.b4)(n.authenticationUser)),h.init()),{entityCommanding:p,eventing:v,commandResultHooksService:h}}),(({commandResultHooksService:e})=>null==e?void 0:e.destroy())))(n,o),pE((e=>({errorState:new FI(e.windowProvider,e.scenarioFactory,e.platformService,e.networkState,e.diagnosticsService,e.coreSettings)})),(({errorState:e})=>e.dispose())),(e=>pE((()=>({clientState:e}))))(r),vE(n),(e=>pE((t=>{const n=new YI(t.client,t.windowProvider,t.coreSettings,e);return n.init(),{windowHistoryNavigationService:n}}),(({windowHistoryNavigationService:e})=>e.destroy())))(n),pE((e=>{const{enablePulsarTelemetry:t,logToOTLCollector:n}=e.coreSettings.get(L.J.Pulsar),i=new cE(aE.TEAMS_RENDERING,{sessionId:e.platformService.host.sessionId,spanExporter:new dE,loggerFactory:e.loggerFactory,logToOTLCollector:!!n});return t&&i.initialize(),{pulsar:i}}),(({pulsar:e})=>e.shutdown())))),(e=>e.pipe(((e,t,n)=>pE((i=>(i.authenticationUser&&i.experienceLifecycleManager.manageWindow(e,i.authenticationUser.id,Object.assign(Object.assign({},i),{isMainWindow:t,isNotificationsWindow:n})),{})),(t=>t.authenticationUser&&t.experienceLifecycleManager.removeWindow(t.authenticationUser.id,e,"window_closed"))))(n,i,a)))),fE=(e,t,n,i,a,o,r,s,l)=>{const c=s.pipe((0,o_.g)("userContextId"),(0,r_.w)((({userContextId:e,correlation:t})=>l(e||void 0).pipe((0,Lw.U)((e=>({context:e,correlation:t})))))),(0,o_.g)("context"),(0,Bw.b)((({context:e,correlation:t})=>o&&yE(e,t))),(0,Lw.U)((({context:e,correlation:t})=>Object.assign(Object.assign({},e),{correlation:t}))));return hE(c,e,t,o,r,n,i,a)},yE=(e,t)=>{var n,i,a,o;const{coreSettings:r,cdlWorkerRegistrarService:s}=e,l=null===(n=null==r?void 0:r.get(L.J.Core))||void 0===n?void 0:n.enableMTMA,c=!!(null===(i=null==r?void 0:r.get(L.J.CdlWorker))||void 0===i?void 0:i.enableUserContextWorkerRegistration),d={id:t.id,source:t.source,scenarioName:t.scenarioName||"auth_switch_account"};e.authenticationUser&&l&&(null===(o=(a=e.authenticationService).updateMostRecentUser)||void 0===o||o.call(a,{accountId:(0,di.b4)(e.authenticationUser),correlation:d}).then((()=>{d.scenarioName=it.RG.AuthWebUser,qI(e.telemetryContextService,e.authenticationService,d)})).then((()=>{c&&e.authenticationUser&&s.setMainWindowWorkerByUserId((0,di.b4)(e.authenticationUser))})))},bE=(e,t,n)=>{n.log(`Removing window ${e} from apollo cache`),t.client.mutate({mutation:ZI,variables:{windowId:e}}).catch((e=>n.error("Error in removing window: ",e)))},SE=(e,t,n,i,a="")=>{var o;return e.telemetryService.createScenarioFactory(e,t,{id:n.id,startTimestamp:parseInt(n.startTimestamp,10)||0,source:n.source},null!==(o=n.clientLaunchId)&&void 0!==o?o:void 0,i,a)},kE=(e,t)=>e.markStep(it.RG.WindowLaunchTime,t);var wE=n(298672);const CE={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"setWindowFullscreen"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isFullscreen"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setWindowFullscreen"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"isFullscreen"},value:{kind:"Variable",name:{kind:"Name",value:"isFullscreen"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var _E=n(950828);const TE=(e,t)=>e.opener.postMessage(n_.Gx.Destroy,{windowId:t});function IE(e,t,n,a,o,r,s,l){return(0,i.__awaiter)(this,void 0,void 0,(function*(){kE(a,it.ck.BeginWindowCreation);const i=e.windowProvider;if(t===he.ew)return i;const c=yield function(e,t,n,i){return new Promise(((a,o)=>{const r=e.setTimeout((()=>{o("New Frame did not report in 10000ms")}),1e4),s=e.self;return s.frameResolvers=s.frameResolvers||{},s.frameResolvers[t]=n=>{e.clearTimeout(r),ME(e,t),a(n)},e.opener.postMessage(n_.Gx.Create,{windowId:t,correlation:n,activeEntities:i})}))}(i,t,o,l);if(!c)return i;const d=(0,wE.dP)(c,e,t,r,s),u=d.getHostedWindowContext();return Object.assign(d,{getHostedWindowContext:()=>Object.assign(Object.assign({},u),{windowId:t}),viewportContext:i_.R.iFrame}),kE(a,it.ck.EndWindowCreation),PE(c,t,d.viewportContext,l),PE(d,t,d.viewportContext,l),EE(c,d,e,t,n),d.close=()=>TE(i,t),d}))}const EE=(e,t,n,i,a,o)=>{NE(n,e,t);const r="onpagehide"in t?"pagehide":"unload",s=t.onFullscreen().subscribe((e=>{n.client.mutate({mutation:CE,variables:{isFullscreen:e,windowId:i}})})),l=()=>{e&&LE(e),LE(t),bE(i,n,a),o&&o(),t.removeEventListener(r,l),s.unsubscribe()};t.addEventListener(r,l)},NE=(e,t,n)=>{var i;const a=null===(i=e.leakDetectorService)||void 0===i?void 0:i.create();null==a||a.track(_E.I.UnwrappedIFrame,t),null==a||a.track(_E.I.IFrameWrapper,n)},AE=({id:e,activeEntities:t},n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{window:i,context$:a}=yield n;return{id:e,window:i,context$:a,activeEntities:t}})),FE=(e,t,n)=>(0,Ow.z)(eC((a=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return RE(a,e,t,n)}))),(e=>function(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{window:i,subscription:a,clientState:o}=yield t,r=null===(n=i.location.hash)||void 0===n?void 0:n.slice(1);r?TE(i,r):i.close(),a&&a.unsubscribe(),o&&o.dispose(),null==e||e.cleanup(),i.destroy(0)}))}(t.leakDetectorService,e)),AE,((e,n)=>((e,t,n)=>{const i=n.loggerFactory.newLogger("IframeStateManager","core-services-activator");i.error(`Creation for window ${e.id} failed with ${t}. Removing window from cache`),n.commandChangeReportingService.report({context:{target:"iframe-state-manager",errorInfo:CC.y.CreateWindowError},correlationId:e.correlation.id,type:wC.B.Failure}),bE(e.id,n,i)})(e,n,t)))),DE=(e,t,n,a,o,r,s,l,c,d,u)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return e&&t?Promise.resolve(((e,t,n,i,a,o,r)=>{const s=t.windowProvider,l=s.open(void 0,e,"width=600px,height=500px,toolbar=no,menubar=no,location=no");if(r){const{clientPreferences:e,coreSettings:n}=t,i=r({theme:uE(e,n,s),viewportContext:i_.R.iFrame});l.document.write(i),l.document.close()}const c=()=>{const e=new URL(s.location.href);e.searchParams.append("random",Date.now().toString()),e.hash=[s.location.pathname,i.mainEntity.type,encodeURIComponent(i.mainEntity.id)].join("/"),l.location.href=decodeURIComponent(e.href)};s.addEventListener("unload",c);let d=(0,wE.dP)(l,t,e,a,o);return d=Object.assign(d,{getHostedWindowContext:()=>({startReason:a_.zF.userInitiated,panelContext:a_.QP.secondary})}),PE(l,e,d.viewportContext,i),PE(d,e,d.viewportContext,i),EE(l,d,t,e,n,(()=>{s.removeEventListener("unload",c)})),d})(a,n,o,l,c,d,u)):IE(n,a,o,r,s,c,d,l)})),RE=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{id:i,correlation:o,activeEntities:r,isMainWindow:s,layoutConfig:{layoutMode:l}}=e,{coreSettings:c}=n,d=o.source===kt.D.PopOutButton,{enablePopOutChats:u}=c.get(L.J.Messaging),m=new Kw.m(n.diagnosticsService,i),g=m.newLogger("IframeStateManager","core-services-activator"),p=Object.assign(Object.assign({},n),{loggerFactory:m}),v=SE(p,i,o,i_.R.iFrame);return xE(t,p,g,i,o,r,d,u,v,s,l,a)})),xE=(e,t,n,a,o,r,s,l,c,d,u,m)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=yield DE(l,s,t,a,n,c,o,r,d,u,m),g=mE(t.client,a).subscribe((e=>gE(e,i,a,t.commandChangeReportingService,t.experienceChangeReportingService,t.hostCommunicationService,n))),p=t.clientState.getChildWindowStateProvider(i,t.loggerFactory,t.coreSettings),{mainEntity:v}=r,h=OE(i,a,d,g,p,e,c,o,v);return kE(c,it.ck.WindowContextProvider),h})),ME=(e,t)=>e.opener.postMessage(n_.Gx.Acquired,{windowId:t}),OE=(e,t,n,i,a,o,r,s,l)=>({window:e,subscription:i,clientState:a,context$:hE(o(void 0).pipe((0,Lw.U)((e=>Object.assign(Object.assign({},e),{correlation:s})))),r,t,n,!1,e,a,l)}),PE=(e,t,n,i)=>{e.iframeLeakInfo={iframeLeakInfoStartTime:(new Date).toISOString(),iframeLeakInfoEntities:Object.keys(i).reduce(((e,t)=>{const n=i[t],a=n&&"object"==typeof n&&"type"in n?null==n?void 0:n.type:void 0;return a&&(e[t]=a),e}),{}),iframeLeakInfoViewportContext:n,iframeLeakInfoWindowId:t}},LE=e=>{e.iframeLeakInfo||(e.iframeLeakInfo={}),e.iframeLeakInfo.iframeLeakInfoEndTime=(new Date).toISOString()};var UE=n(148827),jE=n(247889);const $E=(e,t,n)=>{e.opener.postMessage(n_.rY.ShouldShowChatNotification,{shouldShowChatNotification:t,windowId:n})};var BE=n(588640),WE=n(520850),HE=n(297055),VE=n(15721),zE=n(802788);const qE=(e,t)=>!!(e===t||!e&&!t||e&&t&&e.id===t.id&&e.type===t.type&&e.action===t.action);function GE(e,t){var n,i;if(!t||!t.activeEntities)return!1;const a=null===(n=t.activeEntities)||void 0===n?void 0:n.mainEntity,o=null===(i=e.activeEntities)||void 0===i?void 0:i.mainEntity;return!qE(o,a)&&!function(e,t){const n=["subNavEntity","headerEntity","startEntity","mainEntity","endEntity"];for(const i of n)if(e[i]||t[i])return qE(e[i],t[i]);return!1}(e.activeEntities,t.activeEntities)}const JE=e=>({isChanged:QE,execute:t=>{e.dataCleanupService.markDataForWindowAsInactive(t.id)}});function QE(e,t){return function(e){var t;return!!e.isMainWindow&&(null===(t=e.layoutConfig)||void 0===t?void 0:t.layoutMode)===d.lO.standard}(e)&&function(e,t){var n,i;if(!t||!t.activeEntities)return!1;const a=null===(n=t.activeEntities)||void 0===n?void 0:n.mainEntity,o=null===(i=e.activeEntities)||void 0===i?void 0:i.mainEntity;return!qE(o,a)}(e,t)}const KE=e=>({isChanged:(e,t)=>!e.isMainWindow&&!e.isNotificationsWindow&&GE(e,t),execute:(t,n)=>function(e,t,n){var i;const a=t.activeEntities.mainEntity,o=null==n?void 0:n.activeEntities.mainEntity,r=e.appsRegistryService.getApp({entityType:a.type});if(!r)throw new Error("Entity does not match to an existing app");const s=null===(i=r.getAppWindowFeatures)||void 0===i?void 0:i.call(r,{coreServices:e,host:t.window,isResize:!0,prevEntityType:null==o?void 0:o.type,entityType:null==a?void 0:a.type});if(!s)return;const{width:l,height:c,minWidth:d,minHeight:u}=s,{window:m}=t;e.loggerFactory.newLogger("WindowResizeCommand","core-services-activator").log(`From ${null==o?void 0:o.type} of height ${m.innerHeight} and width ${m.innerWidth}, to ${a.type} of height ${c} and width ${l}`),d&&u&&(m.setMinimumSize&&m.setMinimumSize(d,u),e.hostCommunicationService.loadModule("windowcontrols").then((e=>{var n;return null===(n=null==e?void 0:e.setMinimumWindowSize)||void 0===n?void 0:n.call(e,t.id,d,u)})));l&&c&&(m.setBounds&&m.setBounds({x:m.screenX,y:m.screenY,width:l,height:c}),e.hostCommunicationService.loadModule("windowcontrols").then((e=>{var n;return null===(n=null==e?void 0:e.setWindowBounds)||void 0===n?void 0:n.call(e,t.id,m.screenX,m.screenY,l,c)})))}(e,t,n)});const YE=e=>({isChanged:(e,t)=>!(!e.isMainWindow||e.layoutConfig&&e.layoutConfig.layoutMode!==d.lO.standard||e.userContextId===(null==t?void 0:t.userContextId)),execute:t=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n;if((0,VE._)(e.coreSettings,e.platformService)&&t.userContextId){const i=yield e.hostCommunicationService.loadModule("core");null===(n=null==i?void 0:i.setUserContextIdOnWindow)||void 0===n||n.call(i,t.userContextId,t.id)}}))});const XE=(e,t)=>{switch(t){case C.lOW.standard:return(0,HE.ZN)(e,"window",a_.d.main);case C.lOW.minimal:return(0,HE.ZN)(e,"window",a_.d.flyout);case C.lOW.minimode:return(0,HE.ZN)(e,"window",a_.d.minimode);default:return e}},ZE=(e,t,n,a,o,r,s,l,c,d,u,m,g,p,v)=>{var h,f;let y="",b="about:blank";const{coreSettings:S,platformService:k}=t;b=k.config.clientType!==Pe.Bh.Web?(0,HE.ZN)(b,"entityType",s.type):b;const w={url:b,windowId:n,windowFeatures:y,globalWindow:e,coreServices:t,logger:a,scenarioFactory:o,windowState:r,isMainWindow:c,isNotificationsWindow:d,layoutMode:u,userContextId$:g,templateGenerator:v};if(k.config.clientType===Pe.Bh.Maglev){const{addWindowIdQsp:e}=t.coreSettings.get(L.J.Core),{enablePinchToZoomTouchpad:i}=t.coreSettings.get(L.J.Calling);e&&(b=(0,HE.ZN)(b,"windowId",n)),i&&(b=(0,HE.ZN)(b,"pinchzoom","true"));const a=g.value.userContextId;if((0,VE._)(S,k)&&a&&(b=(0,HE.ZN)(b,"userContextId",a)),b=((e,t)=>t?(0,HE.ZN)(e,"show","false"):e)(b,m),c){if(u===C.lOW.standard){const{flushViewSchemaClient:e}=t.coreSettings.get(L.J.Core);e&&(null===(f=null===(h=t.client)||void 0===h?void 0:h.viewSchemaClient)||void 0===f||f.clearStore()),b=(0,HE.ZN)(b,"customframetheme","main")}else u===C.lOW.minimode&&(b=(0,HE.ZN)(b,"customframetheme","nobuttons"));return eN(Object.assign(Object.assign({},w),{url:XE(b,u)}))}d&&(b=(0,HE.ZN)(b,"window",a_.d.notifications)),b=(0,HE.ZN)(b,"customframetheme","default")}return({url:b,windowFeatures:y}=function(e,t,n,a,o,r,s){var l;const c=e.appsRegistryService.getApp({entityType:n});if(!c)throw new Error("Entity does not match to an existing app");const d=(null===(l=c.getAppWindowFeatures)||void 0===l?void 0:l.call(c,{coreServices:e,host:t,screenState:o,windowOptions:a,entityType:n}))||{},{additionalFeatures:u={}}=d,m=(0,i.__rest)(d,["additionalFeatures"]);let g=Object.keys(m).reduce(((e,t)=>`${e}${e?",":""}${t}=${m[t]}`),"");return g=e.platformService.config.clientType===Pe.Bh.Web?`${g},toolbar=no,menubar=no,location=no`:g,s=Object.keys(u).reduce(((e,t)=>u?(0,HE.ZN)(e,t,u[t]):e),s),r.log(`windowFeatures: ${g}, url: ${s}`),{url:s,windowFeatures:g}}(t,e,s.type,null!=p?p:s.windowOptions,l,a,b)),eN(Object.assign(Object.assign({},w),{url:b,windowFeatures:y}))},eN=({url:e,windowId:t,windowFeatures:n,globalWindow:i,coreServices:a,logger:o,scenarioFactory:r,windowState:s,isMainWindow:l,isNotificationsWindow:c,layoutMode:d,userContextId$:u,templateGenerator:m})=>{const g=i.open(e,t,n||void 0);if(!g)throw new kC.G(kC.$.WINDOW_UNDEFINED);const p=(0,wE.dP)(g,a,t,l,d);vN(g,t,p.viewportContext,e),vN(p,t,p.viewportContext,e),o.log(`windowState: ${JSON.stringify(s)}`);const{minWidth:v=0,minHeight:h=0}=s;p.setMinimumSize&&p.setMinimumSize(v,h),tN(i,p,a,m),kE(r,it.ck.EndWindowCreation),nN(g,p,a,d,r,u,t,o),iN(a,p,g);const{enableHostHistoryNavigation:f}=a.coreSettings.get(L.J.Core);return f||c||p.history.pushState("defaultBrowserHistory",""),p},tN=(e,t,n,i)=>{if(!i)return;if(!!t.document.getElementById("app"))return;const{clientPreferences:a,coreSettings:o,platformService:r}=n,s=r.config.clientVersion.split("/").pop(),l=LC(i({theme:uE(a,o,e),osPlatform:r.config.osPlatform,cspNonce:e.__webpack_nonce__,publicPathScript:`window.__webpack_public_path__="${r.config.publicPath}"`,containerVer:s,environment:o.get(L.J.Metadata).environment||"",viewportContext:t.viewportContext,shouldStubConsoleError:!0}));t.document.write(l),t.document.close()},nN=(e,t,n,i,a,o,r,s)=>{const{disableMainWindowMouseListeners:l,enableActiveWindowsHistoryRecovery:c}=n.coreSettings.get(L.J.Core),d=()=>{t.opener.postMessage(n_.rY.UnhandledMouseEvent,{type:"mousemove"})},u=()=>{t.opener.postMessage(n_.rY.UnhandledMouseEvent,{type:"click"})},m=e=>{if(!(e=>{var t,n;const i=e.target,a=null===(t=i.nodeName)||void 0===t?void 0:t.toLowerCase(),o=null===(n=i.type)||void 0===n?void 0:n.toLowerCase();return!(!i||!(i.isContentEditable||"textarea"===a||"input"===a&&/^(?:text|email|number|search|tel|url|password)$/i.test(o)))})(e))return e.preventDefault(),!1},g="onpagehide"in t?"pagehide":"unload",p=(e=>{const{disableContextMenu:t}=e.coreSettings.get(L.J.Core);return!!t})(n),v=t.onFullscreen().subscribe((e=>{n.client.mutate({mutation:CE,variables:{isFullscreen:e,windowId:r}})})),h=()=>{if(o.isStopped)return;const{correlation:{id:e},userContextId:i}=o.value;n.experienceChangeReportingService.report({correlationId:e,type:l_.FV.WindowOptionsChange,userContextId:i||void 0,windowId:r,context:{target:"window-state-manager",height:t.innerHeight,left:t.screenX,top:t.screenY,width:t.innerWidth}})},f=c&&n.platformService.config.clientType===Pe.Bh.Maglev&&i===C.lOW.focus&&r!==he.ew,y=f&&(0,UE.R)(t,"resize").pipe((0,BE.b)(500)).subscribe(h),b=f&&o.pipe((0,BE.b)(500)).subscribe(h),S=()=>{s.log(`${g} called for window ${r}`),e&&hN(e),hN(t),gN(a),bE(r,n,s),t.document.removeEventListener("mouseenter",d),t.document.removeEventListener("click",u),p&&t.removeEventListener("contextmenu",m),t.removeEventListener(g,S),s.log(`blur/unload listeners removed for windowId: ${r}`),pN(n,t,s,r),v.unsubscribe(),y&&y.unsubscribe(),b&&b.unsubscribe()};r!==he.ew||l||(t.document.addEventListener("mouseenter",d),t.document.addEventListener("click",u)),t.addEventListener(g,S),p&&t.addEventListener("contextmenu",m)},iN=(e,t,n)=>{var i;const a=null===(i=e.leakDetectorService)||void 0===i?void 0:i.create();null==a||a.track(_E.I.UnwrappedWindow,n),null==a||a.track(_E.I.WindowWrapper,t)},aN=(e,t,n)=>{return(0,Ow.z)((0,zE.j)((i=>oN(i,e,t,n)),(e=>lN(e,t)),cN,((e,n)=>((e,t,n)=>{let i,a;const o=n.loggerFactory.newLogger("WindowStateManager","core-services-activator");t instanceof kC.G&&pe.G.isFunction(t.toTelemetryEntry)?(i=t.code,a=t.toTelemetryEntry()):(i=CC.y.CreateWindowError,a=(0,wi.u4)(t)),o.error(`Creation for window ${e.id} failed with ${a}. Removing window from cache`),n.commandChangeReportingService.report({context:{target:"window-state-manager",errorInfo:i,errorMessage:a},correlationId:e.correlation.id,type:wC.B.Failure}),bE(e.id,n,o)})(e,n,t))),mN([YE(t),KE(t),JE(t)]),(i=t.platformService.config.clientType===Pe.Bh.Web,a=e=>uN(e,t),e=>i?e.pipe((0,Bw.b)((e=>a(e)))):e));var i,a},oN=(e,t,n,i)=>{const{id:a,activeEntities:o,correlation:r,screenState:s,isMainWindow:l,isNotificationsWindow:c,layoutConfig:{layoutMode:d},isInitialWindowStateHidden:u,userContextId:m,windowOptions:g}=e,{mainEntity:p,endEntity:v}=o,h=new Kw.m(n.diagnosticsService,a),f=h.newLogger("WindowStateManager","core-services-activator"),y=Object.assign(Object.assign({},n),{loggerFactory:h}),b=SE(y,a,r,(0,wE.YR)(l,d),m||""),S=b.findScenario(it.RG.WindowLaunchTime);null==S||S.appendEventData({mainEntityType:p.type,endEntityType:null==v?void 0:v.type});const k=((e,t,n)=>{var i;const a=e.appsRegistryService.getApp({entityType:t.type});return(null===(i=null==a?void 0:a.getAppWindowFeatures)||void 0===i?void 0:i.call(a,{coreServices:e,isResize:!0,entityType:t.type,windowOptions:n}))||{}})(y,p,null!=g?g:p.windowOptions);return rN(t,m,y,a,p,f,b,k,r,s,l,c,d,u,g,i)},rN=(e,t,n,i,a,o,r,s,l,c,d,u,m,g,p,v)=>{const h=new xw.X({userContextId:t,correlation:l}),f=((e,t,n,i,a,o,r,s,l,c,d,u,m,g)=>{kE(i,it.ck.BeginWindowCreation),n.log(`mainEntityId: ${o.id}, mainEntityType: ${o.type}, mainEntityAction: ${o.action}`);const p=e.windowProvider;return t===he.ew?(nN(void 0,p,e,c,i,u,t,n),p):ZE(p,e,t,n,i,a,o,r,s,l,c,d,u,m,g)})(n,i,o,r,s,a,c,d,u,m,g,h,p,v),y=((e,t,n,i)=>mE(e.client,t).subscribe((a=>gE(a,n,t,e.commandChangeReportingService,e.experienceChangeReportingService,e.hostCommunicationService,i))))(n,i,f,o),b=n.clientState.getChildWindowStateProvider(f,n.loggerFactory,n.coreSettings),S=sN(f,i,h,y,b,e,r,a,d&&m===C.lOW.standard,u,n.loggerFactory,n.leakDetectorService);return kE(r,it.ck.WindowContextProvider),n.commandChangeReportingService.report({context:{target:"window-state-manager-create-window",layoutMode:m},correlationId:l.id,type:wC.B.WindowCreated,isMainWindow:d,userContextId:t}),S},sN=(e,t,n,i,a,o,r,s,l,c,d,u)=>({id:t,window:e,windowStateSubscription:i,clientState:a,leakDetectorService:u,loggerFactory:d,userContextId$:n,context$:fE(r,t,e,a,s,l,c,n,o)}),lN=({clientState:e,id:t,window:n,windowStateSubscription:i,loggerFactory:a,leakDetectorService:o},r)=>{const s=a.newLogger("WindowStateManager","core-services-activator");s.log(`Destroy called on window ${t}`),t!==he.ew&&(n&&n.close(),s.log(`Window.close() called for window ${t}`),null==n||n.destroy(500)),null==i||i.unsubscribe(),null==o||o.cleanup(),e.dispose(),r.appsRegistryService.removeWindowViewState(t)},cN=({activeEntities:e,correlation:t,id:n,isMainWindow:i,isNotificationsWindow:a,layoutConfig:o,userContextId:r},{context$:s,window:l,userContextId$:c})=>(c.next({userContextId:r,correlation:t}),{activeEntities:e,context$:s,id:n,isMainWindow:i,isNotificationsWindow:a,layoutConfig:o,userContextId:r,window:l});let dN;const uN=(e,t)=>{const n=t.loggerFactory.newLogger("WindowStateManager","core-services-activator"),{isChatHybridArchitectureEnabled:i}=t.coreSettings.get(L.J.Host);if(i){if(!e.find((e=>e.id===he.ew)))return}const a=t.windowProvider,o="onpagehide"in a?"pagehide":"unload";a.removeEventListener(o,dN),dN=()=>{n.log(`Global window unload handler called for ${e.length} windows`),e.forEach((e=>{e.id!==he.ew&&e.window.close()}))},a.addEventListener(o,dN,{once:!0})},mN=e=>(0,WE.R)(((t,n)=>(n.forEach((n=>{const i=t.find((e=>e.id===n.id));e.forEach((e=>{e.isChanged(n,i)&&e.execute(n,i)}))})),n)),[]),gN=e=>{e.stopScenarioIfActive(it.RG.WindowLaunchTime,{},"abandoned")},pN=(e,t,n,i)=>{(e=>{const{enableCdlRegistration:t}=e.coreSettings.get(L.J.Core);return!!t})(e)&&(t.opener.postMessage(n_.rY.CdlRegistration,{childWindowId:i,eventType:"unregister"}),n.log(`CdlRegistration: windowId: '${i}', eventType: unregister`))},vN=(e,t,n,i)=>{const a=new URL(i);e.windowLeakInfo={windowLeakInfoStartTime:(new Date).toISOString(),windowLeakInfoEntityType:a.searchParams.get("entityType")||i,windowLeakInfoViewportContext:n,windowLeakInfoWindowId:t}},hN=e=>{e.windowLeakInfo||(e.windowLeakInfo={}),e.windowLeakInfo.windowLeakInfoEndTime=(new Date).toISOString()},fN=["/convene/events","/convene/meet","/embed-client/chats","/l/auth/google","/l/calendar/scheduling-form","/l/channel-dashboard","/l/channel","/l/chat","/l/claim","/l/community/invite","/l/community","/l/entity","/l/file","/l/fileshare","/l/invite/","/l/manage-teams/myinvites","/l/meeting/new","/l/meeting/details","/l/meetingrecap","/l/meetup-join","/l/message","/l/present","/l/share-email","/l/task","/l/team-dashboard","/l/team","/meet","/notdefaultapp","/l/stage"];var yN,bN;!function(e){e[e.SourceWindowAccount=0]="SourceWindowAccount",e[e.MainWindowAccount=1]="MainWindowAccount",e[e.UserChoiceFallback=2]="UserChoiceFallback"}(yN||(yN={})),function(e){e.core="core",e.flyout="flyout",e.default="default"}(bN||(bN={}));var SN=n(460136),kN=n(785722);const wN=new Map,CN=/^\/|\/$/g;function _N(e){return e.toLowerCase()}function TN(e){const{hash:t,search:n}=e;let i=n;if(t&&!(0,a.isEmpty)(t)){const e=t.indexOf("?");e>=0&&(i=t.substr(e+1,t.length-1))}const o=function(e){return(0,kN.parse)(e||"")}(i);let r;return o.correlationId&&o.startTimestamp&&o.source&&(r={id:o.correlationId,startTimestamp:o.startTimestamp,source:o.source}),r}function IN({clientLaunchId:e,location:t}){var n;return null!==(n=null!=e?e:t&&NN(t,"clientId"))&&void 0!==n?n:(0,Ye.v4)()}function EN(e,t){let n=TN(e);return n=n||FC({id:NN(e,"deeplinkId"),scenarioName:it.RG.NavigationCommand,source:t}),n}function NN(e,t){const{hash:n}=e;if(n){const e=FN(n);return e&&e[t]}}function AN(e){const{action:t,id:n,type:i}=e;if(t===u.u.default)switch(e.type){case u.p.default:return bN.default;case u.p.flyout:return bN.flyout}return n?`/${i}/${n}/${t}`:`/${i}/${t}`}function FN(e){const{deepLink:t,crash:n,relaunch:i,source:a,clientId:o,deeplinkId:r,userContextId:s}=(0,kN.parse)(e);return{deepLink:"string"==typeof t?t:"",crash:"true"===n,relaunch:"true"===i,source:"string"==typeof a?SN.d[a]:void 0,clientId:"string"==typeof o?o:void 0,deeplinkId:"string"==typeof r?r:void 0,userContextId:"string"==typeof s?s:void 0}}function DN(e){if(!e||0===e.length)return;const t=wN.get(e);if(t)return t;const n=e.replace(CN,"");if(0===n.length)return;const i=n.split("/");try{let t;if(i){let e=i.length-1;for(;e>=0;){const t=i[e].toLowerCase();if(u.p[t])break;e--}e>=0&&(t=function(e){let t;switch(e.length){case 3:t={type:_N(e[0]),id:e[1],action:_N(e[2])};break;case 2:{const n=e[1].toLowerCase();t=u.u[n]?{type:_N(e[0]),action:_N(e[1])}:{type:_N(e[0]),id:e[1],action:u.u.view};break}default:throw new Error("Invalid entity fragment format found. Valid type, id or action is required.")}return t}(i.splice(e)))}return wN.size<=1e3&&t&&wN.set(e,t),t}catch(e){throw new Error(`Unable to parse path into proper command. ${e.message}`)}}var RN=n(429071);const xN=new Set([C.pyR.chats,C.pyR.channels]),MN="active_windows_history";class ON{constructor(e,t,n,i,a,o,r,s){this._client=t,this._experienceChangeReportingService=n,this._localStorage=i,this._rebootService=a,this._scenarioFactory=o,this._userContextId=r,this._windowProvider=s,this.cleanup=e=>{switch(e){case"quit":case"restart":this.unsubscribe();break;case"signout":default:this.unsubscribe(),this.clearCache()}},this.unsubscribe=()=>{var e,t;null===(e=this._activeWindowsSubscription)||void 0===e||e.unsubscribe(),null===(t=this._windowOptionsSubscription)||void 0===t||t.unsubscribe()},this._logger=e.newLogger("ActiveWindowsHistoryService","core-services-active-windows-history"),this._logger.log("ActiveWindowsHistoryService:: constructed")}initialize(){const e=this.cleanup;this._rebootService.registerCleanupCallback(e);const{crash:t,relaunch:n}=FN(this._windowProvider.location.hash);this._logger.log(`ActiveWindowsHistoryService:: crash: ${t} or relaunch: ${n}`),this.restoreWindows(t||n)&&this.subscribeWindows()}restoreWindows(e){if(!e)return this.clearCache(),!0;const t=this._scenarioFactory.newScenario(it.RG.ActiveWindowsHistoryRestore),n=e=>{this.cleanup();const n={reason:e};t.fail(n)},i=(0,RN.F$)(this._client);if(!i)return n("Failed to read activeWindows from Apollo."),!1;const a=this.filterWindows(i),o=this.readCache();if(!o)return n("Failed to read from localStorage."),!1;const r=o.filter((e=>!a.find((t=>t.activeEntities.mainEntity.id===e.activeEntities.mainEntity.id))));return r.length&&(r.forEach((e=>{e.activeEntities.entityExtension=null})),!(0,RN.bF)(this._client,i.concat(r)))?(n("Failed to write activeWindows to Apollo."),!1):a.length&&!this.persistCache(a.concat(r))?(n("Failed to write to localStorage."),!1):(t.stop(),!0)}subscribeWindows(){this._activeWindowsSubscription=(0,RN.OB)(this._client).subscribe((({errors:e,loading:t,data:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,a,o,r;if(t)return;if(e)return void(null===(a=(i=this._logger).errorToTelemetry)||void 0===a||a.call(i,`subscribeWindows::watchActiveWindows::${(0,wi.u4)(e)}`,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0));const{activeWindows:s=[]}=n,l=this.filterWindows(s);this.persistCache(l)||(this.cleanup(),null===(r=(o=this._logger).errorToTelemetry)||void 0===r||r.call(o,`Failed to write ${l.length} windows to localStorage.`,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0))})))),this._windowOptionsSubscription=this._experienceChangeReportingService.observeChanges().subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e.type!==l_.FV.WindowOptionsChange||!e.windowId||this._userContextId&&e.userContextId!==this._userContextId)return;const t=e=>{var t,n;this.cleanup(),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,e,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0)},n=this.readCache();if(!n)return void t("subscribeWindows::windowOptions::Failed to read from localStorage.");const i=n.find((t=>t.id===e.windowId));if(!i)return;const{height:a,left:o,top:r,width:s}=e.context;i.windowOptions={__typename:"WindowOptions",height:a,left:o,top:r,width:s},this.persistCache(n)||t(`subscribeWindows::windowOptions::Failed to write ${n.length} windows to localStorage.`)}))))}filterWindows(e){return e.filter((e=>((e,t)=>e.layoutConfig.layoutMode===C.lOW.focus&&!e.isMainWindow&&(!t||t===e.userContextId)&&xN.has(e.activeEntities.mainEntity.type))(e,this._userContextId)))}clearCache(){this._logger.log("ClearCache::ACTIVE_WINDOWS_HISTORY_STORAGE_KEY"),this._localStorage.remove(MN,Ct.f.UserAndExperience)}persistCache(e){return this._logger.debug(`Persist ${e.length} windows to cache.`),this._localStorage.setSafe(MN,JSON.stringify(e),Ct.f.UserAndExperience)}readCache(){try{const e=JSON.parse(this._localStorage.get(MN,Ct.f.UserAndExperience)||"[]");return this._logger.debug(`Read ${e.length} windows from cache.`),e}catch(e){return}}}class PN extends fe{constructor(){super(he.Yg.CreateActiveWindowsHistoryTask,["authenticationUser","coreSettings","client","experienceChangeReportingService","localStorage","loggerFactory","rebootService","scenarioFactory","windowProvider"]),this.isAuthenticatedUser=e=>(null==e?void 0:e.role)===nd.w4.Member||(null==e?void 0:e.role)===nd.w4.Guest}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n}=e,i=null==n?void 0:n.get(L.J.Core);if(!(null==i?void 0:i.enableActiveWindowsHistoryRecovery)||!this.isAuthenticatedUser(t))return;const{client:a,experienceChangeReportingService:o,localStorage:r,loggerFactory:s,rebootService:l,scenarioFactory:c,windowProvider:d}=e,u=(0,di.b4)(t);e.activeWindowsHistoryService=new ON(s,a,o,r,l,c,u,d)}))}}var LN=n(74017);const UN={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CoreServicesAppbarUpdateApplicationInUseFragment_applicationIsInUse"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"M365Application"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isInUse"}}]}}]},jN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesAppbarUpdateApplicationInUseQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"m365Apps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesAppbarUpdateApplicationInUseFragment_applicationsWithInUseStatus"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CoreServicesAppbarUpdateApplicationInUseFragment_applicationsWithInUseStatus"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"M365ApplicationConnection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesAppbarUpdateApplicationInUseFragment_applicationIsInUse"}}]}}]}}]}},...UN.definitions]}.definitions]};function $N(e,t,n,i){e.writeFragment({id:`${n}:${t}`,fragment:UN,data:{__typename:n,id:t,isInUse:i}})}class BN{constructor(e,t,n,i){this._experienceChangeReportingService=e,this._userContextId=t,this._client=n,this._logger=i,this._appBarObservable=this._experienceChangeReportingService.observeChanges().pipe((0,jw.h)((e=>e.userContextId===this._userContextId&&e.type===l_.yU.AppSelectionChanged&&e.context.appId!==this._currentValue)),(0,Lw.U)((e=>{this._previousValue=this._currentValue;const t=e;return this._currentValue=t.context.appId,this._client.viewSchemaClient?function(e,t,n){try{const t=e.readQuery({query:jN});if(t){let i,o;for(const[,e]of(0,a.entries)(t))if(i||(i=e.edges.find((e=>e.node.isInUse))),o||(o=e.edges.find((e=>e.node.id===n))),i&&o)break;if((null==i?void 0:i.node.id)===(null==o?void 0:o.node.id))return;i&&$N(e,i.node.id,i.node.__typename,!1),o&&$N(e,o.node.id,o.node.__typename,!0)}}catch(e){t.error("Error thrown updating Nova AppBar selection.")}}(this._client.viewSchemaClient,this._logger,this._currentValue):this._logger.error("Viewclient store isn't available for updating  AppBar selection."),{previousApplicationSelection:this._previousValue,newApplicationSelection:this._currentValue}}))).pipe((0,LN.B)()),this._appBarSubscription=this._appBarObservable.subscribe()}cleanup(){var e;null===(e=this._appBarSubscription)||void 0===e||e.unsubscribe()}observe(){return this._appBarObservable}current(){return this._currentValue}}class WN extends fe{constructor(){super(he.Yg.CreateAppBarServiceTask,["client","authenticationUser","experienceChangeReportingService","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,experienceChangeReportingService:n,client:i,loggerFactory:a}=e,o=a.newLogger("AppBarService","core-services-tasks"),r=new BN(n,(0,di.b4)(t),i,o);return e.appBarService=r,()=>{r.cleanup()}}))}}var HN=n(678413);function VN(e){switch(e){case he.eT.InCall:case he.eT.InBroadcast:case he.eT.Presenting:return yC.pk.VeryActive;case he.eT.Interactive:return yC.pk.Active;case he.eT.Inactive:return yC.pk.Inactive;case he.eT.LongInactive:return yC.pk.LongInactive;case he.eT.Disabled:return yC.pk.Unrecoverable;default:return}}var zN,qN=n(557435);class GN{constructor(e,t,n,i,a){this._host=t,this.timesToSendUntilIdle=2,this._logger=n.newLogger("ClientStateSender","core-services-client-state");const{appIdleTimeoutInMs:o}=i.get(L.J.Core);this.msUntilResend=o?Math.round(o/this.timesToSendUntilIdle):a,this._subscriptionToStateChange=e.pipe((0,qN.x)()).subscribe((e=>this.handleStateChange(e))),this._logger.log("Initialized")}dispose(){this.stopRecurringSending(),this._subscriptionToStateChange.unsubscribe()}handleStateChange(e){try{e===yC.pk.Active||e===yC.pk.VeryActive?this.sendStateRecurringly(e):(this.stopRecurringSending(),this.sendState(e))}catch(t){this._logger.error(`Failed to send client state update: ClientState=${e}, Error: ${t}`)}}sendStateRecurringly(e){this._logger.log(`Starting recurring sending of client state: ${e}`);try{this.sendStateAndStartTimer(e)}catch(t){this._logger.error(`Failed to start recurring sending of client state: ClientState=${e}, Error: ${t}`)}}stopRecurringSending(){this.stopTimer(),this._logger.log("Stopped recurring client state sending")}stopTimer(){if(void 0!==this._recurringSendCountdownTimer)try{this._host.clearInterval(this._recurringSendCountdownTimer),this._recurringSendCountdownTimer=void 0}catch(e){this._logger.error(`Failed to stop sending of client state: ${e}`)}}sendStateAndStartTimer(e){this.sendState(e),this.stopTimer(),this._recurringSendCountdownTimer=this._host.setInterval((()=>this.sendState(e)),this.msUntilResend)}sendState(e){const t=function(e){switch(e){case yC.pk.Unrecoverable:return he.eT.Disabled;case yC.pk.Inactive:return he.eT.Inactive;case yC.pk.LongInactive:return he.eT.LongInactive;case yC.pk.VeryActive:return he.eT.InCall;default:return he.eT.Interactive}}(e);this._logger.log(`Sending state to main window: ${t} (ClientState=${e})`),this._host.opener.postMessage(n_.rY.UpdateWindowState,{childSettings:{appState:t}})}}class JN{constructor(e,t,n,i){this._coreClientStateObservable=e,this._idleTracker=n,this._initialClientState=i,this._coreClientStateSubscription=null,this._logger=t.newLogger("ChildClientStateProvider","core-services-client-state"),this._logger.log(`Initializing clientState with state=${this._initialClientState}`),this._childClientStateBehaviorSubject=new xw.X(this._initialClientState),this._coreClientStateSubscription=this._coreClientStateObservable.subscribe((e=>{e!==this.getState()&&(this._logger.log(`Client state is ${e}.`),this._childClientStateBehaviorSubject.next(e))})),this._logger.log("Initialized")}observe(){return this._childClientStateBehaviorSubject.asObservable()}getState(){return this._childClientStateBehaviorSubject.value}getChildWindowStateProvider(e,t,n){const i=this._idleTracker.createChildWindowIdleTracker(e,t,n);return new JN(this._coreClientStateObservable,t,i,this.getState())}dispose(){var e;this._idleTracker.dispose(),null===(e=this._coreClientStateSubscription)||void 0===e||e.unsubscribe(),this._childClientStateBehaviorSubject.complete()}}class QN{constructor(e,t,n,i,a,o){this._host=e,this._idleTracker=n,this._defaultClientState=yC.pk.Active,this._initializing=!0,this._clientStateSubscription=null,this._idleTrackerStateSubscription=null,this.handleAppStateSyncMessage=e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.appState;void 0!==n&&(this._logger.log(`Handling pushed host appState update change to ${n}.`),this.handleMainWindowStateChange(n))},this._logger=t.newLogger("ClientStateProvider","core-services-client-state");let r=this._defaultClientState;if(void 0!==o){const e=VN(o);void 0!==e&&(r=e)}this._logger.log(`Initializing clientState with state=${r}`),this._clientStateBehaviorSubject=new xw.X(r),this._setupEventHandlers(t,i,a),this.restartIdleTimerWhenActiveState(),this._initializing=!1,this._logger.log("Initialized")}observe(){return this._clientStateBehaviorSubject.asObservable()}getState(){return this._clientStateBehaviorSubject.value}getChildWindowStateProvider(e,t,n){const i=this._idleTracker.createChildWindowIdleTracker(e,t,n);return new JN(this.observe(),t,i,this.getState())}dispose(){var e,t;this._host.opener.removeEventListener(n_.rY.AppStateSyncMessage,this.handleAppStateSyncMessage),this._idleTracker.dispose(),this._stateSender&&this._stateSender.dispose(),this._clientStateBehaviorSubject.complete(),null===(e=this._clientStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this._idleTrackerStateSubscription)||void 0===t||t.unsubscribe()}startVeryActive(e){this._logger.log(`startVeryActive(): Client state is set to very active by ${e}.`),this.setClientState(yC.pk.VeryActive)}stopVeryActive(e){this._logger.log(`stopVeryActive(): Client state is set to active by ${e}.`),this.setClientState(yC.pk.Active)}_setupEventHandlers(e,t,n){var i;this._clientStateSubscription=this.observe().subscribe((e=>{this._logger.log(`Client state is ${e}.`)})),this._host.opener.addEventListener(n_.rY.AppStateSyncMessage,this.handleAppStateSyncMessage),this._idleTrackerStateSubscription=this._idleTracker.observe().subscribe((e=>this.handleIdleChange(e))),n&&t&&(null===(i=t.get(L.J.Core))||void 0===i?void 0:i.enableUpdateAngularOnClientStateChange)&&(this._stateSender=new GN(this.observe(),this._host,e,t,HN.u.MsUntilIdleDefault))}handleIdleChange(e){this._logger.log(`Handling idleness change to ${e}.`),this._clientStateBehaviorSubject.value!==yC.pk.VeryActive&&(this._initializing||this.setClientState(function(e){switch(e){case HN.R.Inactive:return yC.pk.Inactive;case HN.R.LongInactive:return yC.pk.LongInactive;default:return yC.pk.Active}}(e),!1))}setClientState(e,t=!0){e!==yC.pk.Active&&e!==yC.pk.VeryActive||!t||this._idleTracker.restartIdleTimer(),e===yC.pk.Inactive&&this._clientStateBehaviorSubject.value===yC.pk.LongInactive||this._clientStateBehaviorSubject.value!==e&&(this._logger.log(`Updating client state from=${this._clientStateBehaviorSubject.value} to=${e}.`),this._clientStateBehaviorSubject.next(e))}handleMainWindowStateChange(e){const t=VN(e);t!==yC.pk.Active&&t!==yC.pk.VeryActive||this.setClientState(t)}restartIdleTimerWhenActiveState(){this.getState()!==yC.pk.Active&&this.getState()!==yC.pk.VeryActive||this._idleTracker.restartIdleTimer()}}!function(e){e.Initializing="Initializing",e.Unrecoverable="Unrecoverable",e.LongInactive="LongInactive",e.Inactive="Inactive",e.Active="Active",e.VeryActive="VeryActive"}(zN||(zN={}));class KN{constructor(e=he.eT.Interactive){this._appState$=new xw.X(e);(0,Ue.J)().opener.addEventListener(n_.rY.AppStateSyncMessage,(e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.appState;this.setAppState(n)}))}observe(){return this._appState$.asObservable().pipe((0,qN.x)())}getState(){return this._appState$.value}setAppState(e){void 0!==e&&e!==this.getState()&&this._appState$.next(e)}}var YN,XN;!function(e){e.LoadModuleCoreFailed="LoadModuleCoreFailed",e.LoadModuleOsUtilsFailed="LoadModuleOsUtilsFailed",e.LoadModuleScenarioFailed="LoadModuleScenarioFailed",e.LoadModuleTelemetryFailed="LoadModuleTelemetryFailed",e.LoadModuleWebClientStatesFailed="LoadModuleWebClientStatesFailed",e.ExecuteCommandFailed="ExecuteCommandFailed",e.RegisterForAppStateChangedFailed="RegisterForAppStateChangedFailed",e.ReportReadyToQuitFailed="ReportReadyToQuitFailed"}(YN||(YN={})),function(e){e.LoadModuleCoreSuccess="LoadModuleCoreSuccess",e.ExecuteCommandSuccess="ExecuteCommandSuccess"}(XN||(XN={}));var ZN=n(650007);class eA{constructor(e,t,n){this.handleMachineLockUpdate=e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.isMachineLocked;void 0!==n&&(this._logger.log(`Handling pushed machineLock update change: isMachineLocked = ${n}.`),this.updateMachineLockState(n))},this._logger=t.newLogger("HostStateProvider","core-sercices-host-state"),this._hostStateSubject=new xw.X({windowState:yC.kZ.InFocus,machineLockState:yC.UV.Active,suspendedState:yC.V9.Resumed}),this.registerForStateChanges(e,n)}observe(){return this._hostStateSubject.asObservable()}getState(){return Object.assign({},this._hostStateSubject.value)}dispose(){var e;null===(e=this._machineStateChangedSubscription)||void 0===e||e.call(this)}registerForStateChanges(e,t){e.opener.addEventListener(n_.rY.AppStateSyncMessage,this.handleMachineLockUpdate),t.loadModule("osutils").then((e=>{var t;this._machineStateChangedSubscription=null===(t=null==e?void 0:e.registerForSessionStateChanged)||void 0===t?void 0:t.call(e,(e=>{this._logger.log(`Handling pushed machineLock update change: machine SessionStatus= ${e.status}.`),e.status===ZN.$.Suspending||e.status===ZN.$.Resumed?this.updateSuspendedState(e.status===ZN.$.Suspending):this.updateMachineLockState(e.status===ZN.$.Locked)}))}))}updateMachineLockState(e){const t=e?yC.UV.Locked:yC.UV.Active,n=this.getState().machineLockState;if(t!==n){this._logger.log(`Updating machine lock state from=${n} to=${t}.`);const e=this.getState();e.machineLockState=t,this._hostStateSubject.next(e)}}updateSuspendedState(e){const t=e?yC.V9.Suspending:yC.V9.Resumed,n=this.getState().suspendedState;if(t!==n){this._logger.log(`Updating machine suspended state from=${n} to=${t}.`);const e=this.getState();e.suspendedState=t,this._hostStateSubject.next(e)}}}var tA=n(624683),nA=n(173409);class iA extends nA.c{constructor(e,t,n){super(e),this.label=t,this.onOverrideLastState=n,this.handleNetworkStateNotification=e=>{this.logger.debug(`${this.label} received ${Pf.G[e]}`),this.getLastState()!==e&&(this.logger.log(`${this.label} network state is ${Pf.G[e]}`),this.notifyAboutStateChange(e))}}overrideLastState(e){const t=this.getLastState();this.logger.debug(`EndpointsNetworkStateListener state is overriden from ${void 0===t?"undefined":Pf.G[t]} to ${Pf.G[e]}`),this.doOverrideOfLastState(e),this.onOverrideLastState(e)}cleanUpSubscriptions(){super.cleanUpSubscriptions()}}var aA=n(822993),oA=n(916561),rA=n(181612);class sA extends nA.c{constructor(e){super(e),this.failed_to_fetch_subContext="rejectHttpError",this.processResponse=e=>{void 0!==e.status&&e.status!==oA.qb.NOT_MODIFIED&&e.status!==oA.qb.GATEWAY_TIMEOUT&&this.handleNetworkStateNotification(Pf.G.Online)},this.processResponseError=e=>{e&&(e.serverResponse?this.handleNetworkStateNotification(Pf.G.Online):e.context===he.w5.RejectHttpError&&e.code===he.jK.RemoteOperationFailed&&e.subContext===this.failed_to_fetch_subContext?this.handleNetworkStateNotification(Pf.G.Offline):this.logger.log(`Not network related error: ${e.message||e}`))},this.handleNetworkStateNotification=e=>{this.logger.debug(`Send network state is ${Pf.G[e]}`),this.getLastState()!==e&&(this.logger.log(`Send network state listener is ${Pf.G[e]}`),this.notifyAboutStateChange(e))},this.unsubscribeFromSendTracking=(0,rA.z)(this.processResponse,this.processResponseError)}overrideLastState(e){const t=this.getLastState();this.logger.debug(`Send state listener's state is overriden from ${void 0===t?"undefined":Pf.G[t]} to ${Pf.G[e]}`),this.doOverrideOfLastState(e)}cleanUpSubscriptions(){super.cleanUpSubscriptions(),this.unsubscribeFromSendTracking&&this.unsubscribeFromSendTracking(),this.unsubscribeFromSendTracking=void 0}}var lA=n(635424);const cA=(e,t)=>Promise.resolve({apiName:t,constructRequest:n=>{const i=e();return i.searchParams.set("cb",Date.now().toString()),{apiName:t,url:i.href,method:"HEAD",timeout:1e4,headers:{"cache-control":"no-store"},cancellationToken:n.token}},transformResponse:e=>e.status===oA.qb.GATEWAY_TIMEOUT?Promise.reject("GATEWAY_TIMEOUT"):Promise.resolve()}),dA=e=>{const{coreSettings:t,platformService:n}=e;return{serviceName:lA.EJ.NetworkPing,models:{getNetworkStatus:cA((()=>new URL(t.get(L.J.Core).networkPingUrl||"/diagnostics/network",n.config.currentUrl)),"networkPing"),getNetworkStatusFallback:cA((()=>new URL(t.get(L.J.Core).networkPingFallbackPingUrl||"/evergreen-assets/icons/1x1-000000ff.png",n.config.staticsPath)),"networkFallbackPing")}}};var uA=n(362809),mA=n(510553);const gA=[5e3,1e4,3e4],pA="cancelled_ping";class vA{constructor(e,t,n,a,o){this.coreSettings=e,this.endpointsManager=t,this.scenarioFactory=n,this.host=a,this.ping=()=>{const e=this.coreSettings.get(L.J.Core).networkPingDisableFallback||!1,t=this.scenarioFactory.newScenario(it.RG.NetworkPing);let n=this.endpointsManager.createCancelToken(),i=!1;const a=()=>i;return{promise:this.pingEndpoint("initial ping",(()=>this.endpoints.getNetworkStatus(n)),t,!e,a).then((i=>i||e?Promise.resolve(i):(n=this.endpointsManager.createCancelToken(),this.pingEndpoint("fallback ping",(()=>this.endpoints.getNetworkStatusFallback(n)),t,!1,a)))),cancel:()=>(n.cancel(),void(i=!0))}},this.pingEndpoint=(e,t,n,a,o)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){n.appendEventData({operation:e});try{return yield t(),o()?this.markPingScenarioCancelled(e,n):this.markPingScenarioSuccess(e,n)}catch(t){return o()?this.markPingScenarioCancelled(e,n):(null==t?void 0:t.serverResponse)?this.markPingScenarioSuccess(e,n):((null==t?void 0:t.reason)===uA.A.TimedOut?this.logger.log(`${e} timed out`):this.logger.log(`${e} failed`),!a&&this.markPingScenarioFailed(e,t,n))}})),this.getRetryIntervals=()=>{const e=this.coreSettings.get(L.J.Core).networkPingRetryIntervals||gA;return Object.assign([],e)},this.updatePingResult=e=>{this.latestPingResult={isOnline:e,timestamp:Date.now()}},this.logger=o.newLogger("NetworkPingService","core-services-network-state"),this.endpoints=t.createApi(dA),this.logger.log("Initialized")}detectCurrentNetworkStatus(){const e=this.coreSettings.get(L.J.Core).networkPingDebounceDelay||3e4;return!(this.coreSettings.get(L.J.Core).networkPingDisableDebounce||!1)&&this.latestPingResult&&this.latestPingResult.isOnline&&this.latestPingResult.timestamp&&Date.now()-this.latestPingResult.timestamp<e?(this.logger.log(`Skipping network detection as last online check succeeded less than ${e}ms ago.`),{promise:Promise.resolve(!0),cancel:()=>{}}):(this.logger.log("doing network ping"),this.ping())}whenNetworkOnline(){if(this.whenNetworkOnlinePromise)return this.whenNetworkOnlinePromise;const e=this.getRetryIntervals();let t=!1;const n=()=>{this.whenNetworkOnlinePromise=void 0,t=!0};let a;const o=new Promise(((o,r)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;a=()=>{null==i||i(),n(),r(pA)};let s=e[0];for(let n=0;!t;n++){const{promise:a,cancel:o}=this.ping();i=()=>{null==o||o(),i=()=>{}};try{const o=yield a;if(i=()=>{},o||t)break;n<e.length&&(s=e[n]),yield(0,mA._)(s,this.host)}catch(e){this.logger.log("whenNetworkOnline ping rejected")}}n(),o()}))));return this.whenNetworkOnlinePromise={promise:o,cancel:()=>null==a?void 0:a()},this.whenNetworkOnlinePromise}markPingScenarioSuccess(e,t){return t.stop({message:`${e} successful!`},"success"),this.logger.log(`${e} successful!`),this.updatePingResult(!0),!0}markPingScenarioFailed(e,t,n){var i;const a=(null==t?void 0:t.reason)?t.reason:"undefined",o=null===(i=null==t?void 0:t.serverResponse)||void 0===i?void 0:i.status;return n.fail({errors:`${e} failed. error reason: ${a}. Response status: ${o}`}),this.updatePingResult(!1),!1}markPingScenarioCancelled(e,t){return t.stop({message:`${e} cancelled`},"abandoned"),this.logger.log(`${e} cancelled`),this.updatePingResult(!0),Promise.reject(pA)}}class hA extends tA.s{constructor(e,t,n,i,a,o){var r,s;super(e,"NetworkStateProvider",n),this.loggerFactory=e,this.coreSettings=t,this.host=i,this.clientStateProvider=a,this._defaultNetworkOnlineDetectionTimeoutInMs=15e3,this.coreContextID="",this._contextListeners=new Map,this._isFirstSignal=!0,this.createNetworkStateTracker=(e,t,n)=>{const i=new iA(this.logger,t,n),a={next:i.handleNetworkStateNotification,dispose:i.cleanUpSubscriptions};return this._addToContextListeners(e,i),i.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`${t} network state is ${Pf.G[e]}`))),a},this._handleNetworkStateUpdate=(e,t)=>{if(this.logger.debug(`Update network to ${Pf.G[e]} due to ${t}`),e===Pf.G.Offline){if(this.getState()===Pf.G.Offline)return;this._suspectOffline()}else this._cancelNetworkOnlineDetection(t),this.getState()!==e?this.setNetworkState(e,t):(this.setDetailedNetworkState(Pf.T.Online),this._updateAllListenersTo(Pf.G.Online));this._isFirstSignal&&(this._isFirstSignal=!1)},this._handleWindowOnline=()=>{this.logger.log("browser network online"),this.isOnline()||(this._updateAllListenersTo(Pf.G.Offline),this._kickOffNetworkOnlineDetection(Pf.G.Online))},this._handleWindowOffline=()=>{if(this.logger.log("browser network offline"),this.coreSettings.get(L.J.Core).disableWindowEventsNetworkDetectionV2){if(this.getState()===Pf.G.Offline)return;this.setNetworkState(Pf.G.Offline,"browser offline"),this._updateAllListenersTo(Pf.G.Offline),this._kickOffNetworkOnlineDetection(Pf.G.Offline)}else this._suspectOffline()},this._subscribeToSendNetworkState(),this.subscribeToEndpointsNetworkStateTracking(this.coreContextID,o.networkState),this._subscribeToWindowNetworkEvents();try{this._networkPingService=new vA(this.coreSettings,o,n,this.host,this.loggerFactory)}catch(e){null===(s=(r=this.logger).errorNoPii)||void 0===s||s.call(r,"NetworkPingService initialization has failed")}}dispose(){super.dispose(),this._cancelNetworkOnlineDetection("dispose"),this.disposeAllContexts(),this._unsubscribeFromWindowNetworkEvents()}disposeContext(e){const t=this._contextListeners.get(e);t&&(t.forEach((e=>{e.cleanUpSubscriptions()})),this._contextListeners.delete(e))}subscribeToEndpointsNetworkStateTracking(e,t){const n=new aA.f(this.logger,t);return this._addToContextListeners(e,n),n.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`Endpoints network state is ${Pf.G[e]}`)))}setNetworkState(e,t){super.setNetworkState(e,t),this._updateAllListenersTo(e)}_subscribeToSendNetworkState(){const e=new sA(this.logger);this._addToContextListeners(this.coreContextID,e),e.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`Send network state is ${Pf.G[e]}`)))}_subscribeToWindowNetworkEvents(){this.host.addEventListener("online",this._handleWindowOnline),this.host.addEventListener("offline",this._handleWindowOffline)}_unsubscribeFromWindowNetworkEvents(){this.host.removeEventListener("online",this._handleWindowOnline),this.host.removeEventListener("offline",this._handleWindowOffline)}_updateAllListenersTo(e){this._contextListeners.forEach((t=>t.forEach((t=>{var n;return null===(n=t.overrideLastState)||void 0===n?void 0:n.call(t,e)}))))}_addToContextListeners(e,t){var n;this._contextListeners.has(e)?null===(n=this._contextListeners.get(e))||void 0===n||n.push(t):this._contextListeners.set(e,[t])}_suspectOffline(){const{enableSkipNetworkDetectionTimeoutOnOfflineStart:e,useVeryActiveForNetworkOnlineDetection:t,enableNetworkOnlineDetectionTimeout:n,networkOnlineDetectionTimeoutInMs:i}=this.coreSettings.get(L.J.Core);if(t&&this.clientStateProvider.getState()===yC.pk.VeryActive)return this.logger.log("Network detection cancelled due to VeryActive client state."),this._updateAllListenersTo(Pf.G.Online),void this.setDetailedNetworkState(Pf.T.Online);const a=this._isFirstSignal&&!!e;if(!(this._networkDetectionTimeout&&!a||this._detectCurrentNetworkStatusPromise||this._networkPing))if(this._updateAllListenersTo(Pf.G.Offline),this.setDetailedNetworkState(Pf.T.SuspectedOffline),n&&!a){const e=i||this._defaultNetworkOnlineDetectionTimeoutInMs;void 0!==this._networkDetectionTimeout||this._detectCurrentNetworkStatusPromise||(this.logger.log(`Starting ${e}ms timeout before kicking off network online detection.`),this._networkDetectionTimeout=this.host.setTimeout((()=>{this._networkDetectionTimeout=void 0,this.logger.log("Timeout expired."),this._kickOffNetworkOnlineDetection(Pf.G.Offline)}),e))}else this._kickOffNetworkOnlineDetection(Pf.G.Offline)}_kickOffNetworkOnlineDetection(e){if(!this._networkPingService||!this._canPerformPing())return void(this.getState()!==e&&this.setNetworkState(e));if(this._detectCurrentNetworkStatusPromise||this._networkPing)return;this.logger.log("Kicking off network status detection.");const t=this._networkPingService;this._detectCurrentNetworkStatusPromise=t.detectCurrentNetworkStatus(),this._detectCurrentNetworkStatusPromise.promise.then((e=>{void 0!==this._detectCurrentNetworkStatusPromise?(this._detectCurrentNetworkStatusPromise=void 0,e?(this.logger.log("Network status verified as online."),this.setNetworkState(Pf.G.Online,"http online")):(this.setNetworkState(Pf.G.Offline,"http offline"),this._startNetworkPing(t))):this.logger.log("Network detection cancelled, ignoring result.")})).catch((e=>{e===pA?this.logger.log("Network detection is cancelled"):this.logger.warn(`Network status verification error: ${e}`),this._detectCurrentNetworkStatusPromise=void 0}))}_canPerformPing(){const{enablePingService:e}=this.coreSettings.get(L.J.Core);return!!e||(this.logger.warn("Network detection is disabled."),!1)}_startNetworkPing(e){this.logger.log("Started recurring network ping."),this._networkPing=e.whenNetworkOnline(),this._networkPing.promise.then((()=>{this._networkPing?(this._networkPing=void 0,this.getState()!==Pf.G.Online&&this.setNetworkState(Pf.G.Online,"Network ping succeded")):this.logger.log("Network ping cancelled, ignoring result.")})).catch((e=>{this.logger.log(`network detection by ping terminated due to ${(null==e?void 0:e.message)?e.message:e}`)}))}_cancelNetworkPing(e){var t,n;this._networkPing&&(this.logger.log(`Cancelling network ping due to ${e}`),null===(n=(t=this._networkPing).cancel)||void 0===n||n.call(t),this._networkPing=void 0)}_cancelNetworkOnlineDetection(e){var t,n;void 0!==this._networkDetectionTimeout&&(this.logger.log(`Cancelling network detection timeout due to ${e}`),this.host.clearTimeout(this._networkDetectionTimeout),this._networkDetectionTimeout=void 0),this._detectCurrentNetworkStatusPromise&&(this.logger.log(`Cancelling network detection due to ${e}`),null===(n=(t=this._detectCurrentNetworkStatusPromise).cancel)||void 0===n||n.call(t),this._detectCurrentNetworkStatusPromise=void 0),this._cancelNetworkPing(e)}disposeAllContexts(){this._contextListeners.forEach((e=>{e.forEach((e=>{e.cleanUpSubscriptions()}))})),this._contextListeners.clear()}}class fA extends nA.c{constructor(e,t){super(e),this.handleLegacyApplicationStateChange=e=>{const t=this.isOnlineAndConnectedInternal(e);this.logger.log(`LegacyApplicationState changed to ${he.eT[e]}`),this.notifyAboutStateChange(t)},this.isOnlineAndConnectedInternal=e=>{switch(e){case he.eT.Disabled:case he.eT.Offline:return Pf.G.Offline;default:return Pf.G.Online}},this.legacyApplicationStateSubscription=t.observe().pipe((0,qN.x)()).subscribe(this.handleLegacyApplicationStateChange)}cleanUpSubscriptions(){super.cleanUpSubscriptions(),this.legacyApplicationStateSubscription&&(this.legacyApplicationStateSubscription.unsubscribe(),this.legacyApplicationStateSubscription=void 0)}}class yA extends tA.s{constructor(e,t,n,o,r,s){super(t,"LegacyNetworkStateProvider",n),this.hostCommunicationService=s,this._legacyAppStateListener=void 0,this._suspectedStateListeners=[],this._handleNetworkListenerUpdate=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){e!==this.getState()?(this.logger.debug(`Network suspected ${Pf.G[e]}${t?" due to ":""}${t}`),yield this._sendSuspectedNetworkStateThrottled(this._convertToIsOnline(e))):void 0!==this._suspectedIsOnline&&this.convertToIsOnline(e)!==this._suspectedIsOnline&&this._resetSuspectedState()})),this._sendSuspectedNetworkState=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log(`Sending network state to main window: ${e}`);const t=yield this.hostCommunicationService.loadModule("core");(null==t?void 0:t.notifyCoreStateChanged)?t.notifyCoreStateChanged({isNetworkOnline:e}):this.logger.warn("notifyCoreStateChanged is missing in HostComms")})),this._initSuspectedThrottleFunc=()=>{this._throttledSuspectedIsOnline=(0,a.throttle)(this._sendSuspectedNetworkState,2e3)},this._convertToIsOnline=e=>e!==Pf.G.Offline,this._updateSuspectedStateListenersTo=e=>this._suspectedStateListeners.forEach((t=>{var n;return null===(n=t.overrideLastState)||void 0===n?void 0:n.call(t,e)})),this._subscribeToLegacyAppStateTracking(e),this._subscribeToSuspectedNetworkState(r,o)}dispose(){var e;super.dispose(),null===(e=this._legacyAppStateListener)||void 0===e||e.cleanUpSubscriptions(),this._legacyAppStateListener=void 0,this._suspectedStateListeners.forEach((e=>e.cleanUpSubscriptions())),this._suspectedStateListeners=[],this._clearSuspectedState(),this._throttledSuspectedIsOnline=void 0}_subscribeToLegacyAppStateTracking(e){this._legacyAppStateListener=new fA(this.logger,e);const t=this;this._legacyAppStateListener.subscribeToStateChange((e=>t._updateNetworkState(e,`LegacyApplicationState changed to ${Pf.G[e]}`)));const n=this._legacyAppStateListener.getLastState();void 0!==n&&this._updateNetworkState(n,"initial LegacyApplicationState")}_subscribeToSuspectedNetworkState(e,t){const{enableNetworkTrackingForLegacyNetworkState:n}=t.get(L.J.Core);n&&(this._initSuspectedThrottleFunc(),this._subscribeToSendNetworkState(),this._subscribeToEndpointsNetworkStateTracking(e.networkState))}_subscribeToSendNetworkState(){const e=new sA(this.logger);this._suspectedStateListeners.push(e),e.subscribeToStateChange((e=>this._handleNetworkListenerUpdate(e,`Send network state is ${Pf.G[e]}`)))}_subscribeToEndpointsNetworkStateTracking(e){const t=new aA.f(this.logger,e);this._suspectedStateListeners.push(t),t.subscribeToStateChange((e=>this._handleNetworkListenerUpdate(e,`Endpoints network state is ${Pf.G[e]}`)))}_updateNetworkState(e,t){this.logger.log(`Update network to ${Pf.G[e]}${t?" due to ":""}${t}`),this.getState()!==e&&(this.setNetworkState(e),this._resetSuspectedState())}_sendSuspectedNetworkStateThrottled(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e!==this._suspectedIsOnline?(this._resetSuspectedState(),this._suspectedIsOnline=e):this._updateSuspectedStateListenersTo(this.getState()),this._throttledSuspectedIsOnline&&(yield this._throttledSuspectedIsOnline(e))}))}_clearSuspectedState(){var e;void 0!==this._suspectedIsOnline&&(this._suspectedIsOnline=void 0),null===(e=this._throttledSuspectedIsOnline)||void 0===e||e.cancel(),this._updateSuspectedStateListenersTo(this.getState())}_resetSuspectedState(){this._clearSuspectedState(),this._initSuspectedThrottleFunc()}}class bA extends fe{constructor(){super(he.Yg.CreateAppState,[]),this.clientStateStorageKey="tmp.clientState",this._updateTelemetryOnClientStateChange=(e,t)=>{e.observe().subscribe((e=>{t.setCoreContext("AppInfo.ClientState",e)}))},this._updateTelemetryOnNetworkStateChange=(e,t)=>{e.observeIsOnline().subscribe((e=>{const n=e?"Online":"Offline";t.setCoreContext("AppInfo.NetworkState",n)}));e.observeDetailedNetworkState().subscribe((e=>{t.setCoreContext("AppInfo.DetailedNetworkState",e)}))},this._updateHostOnClientStateChange=(e,t,n)=>{const i=n.newLogger("updateHostOnClientStateChange","core-services-tasks");e.observe().subscribe((e=>t.loadModule("webclientstates").then((t=>{if(t&&t.notifyWebClientStateChange){const n=zN[e];t.notifyWebClientStateChange(n),i.log(`messaged host new ClientState (${e}). WebClientState sent: ${n}`)}else i.warn(`${YN.LoadModuleWebClientStatesFailed} or webclientstates.notifyWebClientStateChange is not loaded`)})).catch((e=>{i.errorToTelemetry&&i.errorToTelemetry(`Error happened: ${e.message||e}`,"webclient_framework_host_comms",void 0,!0)}))))},this._trackClientStateForGlassjar=(e,t)=>{e.observe().subscribe((e=>t.localStorage.setItem(this.clientStateStorageKey,e)))}}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:n,hostCommunicationService:i,hostSettings:a,loggerFactory:o,platformService:r,scenarioFactory:s,telemetryService:l,windowProvider:c}=e,d=null===(t=null==a?void 0:a.hostSettings)||void 0===t?void 0:t.appState,u=void 0!==d?d:he.eT.Inactive;e.appStateService=new KN(u);const m=new HN.u(c,o,n);e.hostState=new eA(c,o,i),e.clientState=new QN(c,o,m,n,e.hostState,d);const g=this._createNetworkStateProvider(e,e.clientState,e.appStateService);e.networkState=g,e.errorState=new FI(c,s,r,g,e.diagnosticsService,n),this._updateTelemetryOnClientStateChange(e.clientState,l),this._updateTelemetryOnNetworkStateChange(g,l);const{enableUpdateHostOnClientStateChange:p}=n.get(L.J.Core);p&&this._updateHostOnClientStateChange(e.clientState,i,o);const{isRunningGlassjar:v}=n.get(L.J.Test);v&&this._trackClientStateForGlassjar(e.clientState,c)}))}_createNetworkStateProvider(e,t,n){const{coreSettings:i,loggerFactory:a,scenarioFactory:o,windowProvider:r,endpointsManager:s,hostCommunicationService:l}=e,{enableNetworkOnlineDetection:c}=i.get(L.J.Core);return c?new hA(a,i,o,r,t,s):new yA(n,a,o,i,s,l)}}var SA=n(741502),kA=n(449856),wA=n(19435);class CA{constructor(e,t,n){var i;this._coreSettings=t,this._accountId=n,this.skypeState=SA.Q.Success,this._criticalResources=[],this.cleanup=new K_.xQ,this.currentAuthState=new xw.X(SA.j.Up),this.skypeTokenState=new xw.X(SA.Q.Unknown),this.resourceTokenStates=new Map,this.logSubscriptions=[],this.stateChangeLogs=[],this.defaultAuthStateChangeTimeout=3e4,this._logger=e.newLogger("AuthStateProvider","core-services-auth"),this._logger.log("[AuthState] Initializing auth state to Up.");const{criticalResources:a,authStateChangeTimeout:o}=(null===(i=this._coreSettings)||void 0===i?void 0:i.get(L.J.Auth))||{};this._criticalResources=a||[],this._authStateChangeTimeout=null!=o?o:this.defaultAuthStateChangeTimeout,this.badTokenStates=new Map,this.skypeLogSubscription=this.skypeTokenState.pipe((0,G_.R)(this.cleanup)).pipe((0,qN.x)()).subscribe((e=>{this._logger.log(`[AuthState] Skype token state changed to: ${e}`),this.recordStateChange("SkypeToken",e)})),this.telemetryInterval=globalThis.window.setInterval((()=>{this.publishAuthStateTelemetry()}),kT.rF.ONE_HOUR),n&&(0,wA.kh)(this.currentAuthState.value,n)}observe(){return this.currentAuthState}getState(){return this.currentAuthState.value}getInteractionRequiredResource(){const e=this.badTokenStates.entries();let t=e.next();for(;!t.done;){if(t.value[1]===SA.Q.InteractionRequired)return t.value[0];t=e.next()}}reportResourceTokenState(e,t,n){this._criticalResources.includes(e)&&(this.updateTokenStateMap(e,t),t===SA.Q.Success?this.badTokenStates.has(e)&&(this.badTokenStates.clear(),this.skypeState=t):this.badTokenStates.set(e,t),this.evaluateCurrentState(n))}observeResourceTokenState(e){if(!this._criticalResources.includes(e))throw new Error("Unsupported resource, contact Auth team if you need your resource added.");let t=this.resourceTokenStates.get(e);return t||(t=this.updateTokenStateMap(e,SA.Q.Unknown)),t.pipe((0,G_.R)(this.cleanup)).pipe((0,qN.x)())}reportSkypeTokenState(e,t){this.skypeTokenState.next(e),e!==this.skypeState&&(this.skypeState=e,this.evaluateCurrentState(t))}observeSkypeTokenState(){return this.skypeTokenState.pipe((0,G_.R)(this.cleanup)).pipe((0,qN.x)())}getSkypeTokenState(){return this.skypeTokenState.value}cleanupObservables(){var e;this._logger.log("[AuthState] Cleanup function called."),this.publishAuthStateTelemetry(),null===(e=null===globalThis||void 0===globalThis?void 0:globalThis.window)||void 0===e||e.clearInterval(this.telemetryInterval),this.cleanup.next(!0),this.cleanup.complete(),this.skypeTokenState.complete(),this.resourceTokenStates.forEach((e=>e.complete())),this.resourceTokenStates.clear(),this.skypeLogSubscription.unsubscribe(),this.logSubscriptions.forEach((e=>e.unsubscribe())),this.logSubscriptions=[]}recordStateChange(e,t){t!==SA.Q.Unknown&&this.stateChangeLogs.push(`${Date.now()}|${e}->${t}`)}publishAuthStateTelemetry(){if(this.stateChangeLogs.length<1)return;const e=kA.cv.create({subContext:"AuthState",correlation:{id:(0,Mf.pW)(),source:"auth-state-provider",scenarioName:it.RG.AuthPublishState}});e.addEventData(this.stateChangeLogs),e.closeScenario(),this.stateChangeLogs=[]}updateTokenStateMap(e,t){let n=this.resourceTokenStates.get(e);return n?n.next(t):(n=new xw.X(t),this.resourceTokenStates.set(e,n),this.logSubscriptions.push(n.pipe((0,G_.R)(this.cleanup)).pipe((0,qN.x)()).subscribe((t=>{this._logger.log(`[AuthState] ${e} token state changed to: ${t}`),this.recordStateChange(e,t)})))),n}evaluateCurrentState(e){let t;if(0===this.badTokenStates.size)t=this.skypeState===SA.Q.LicenseError?SA.j.LicenseError:this.skypeState!==SA.Q.Success?SA.j.SkypeReconnecting:SA.j.Up;else{const e=this.badTokenStates.values();let n=e.next();for(;!n.done;){if(n.value===SA.Q.InteractionRequired){t=SA.j.InteractionRequired;break}t=SA.j.AADReconnecting,n=e.next()}}t&&this.changeAuthState(t,e)}changeAuthState(e,t){if(this.shouldChangeStateToImmediately(e))this.pendingStateClearTimeout&&(globalThis.window.clearTimeout(this.pendingStateClearTimeout),this.pendingState=void 0,this.pendingError=void 0,this.pendingStateClearTimeout=void 0),this.changeTo(e,t);else if(this.pendingState)this.pendingState=e,this.pendingError=t;else{if(e===this.currentAuthState.value)return;this.pendingState=e,this.pendingError=t,this.pendingStateClearTimeout=globalThis.window.setTimeout((()=>{this.pendingState&&this.changeTo(this.pendingState,this.pendingError),this.pendingState=void 0,this.pendingError=void 0,this.pendingStateClearTimeout=void 0}),this._authStateChangeTimeout)}}shouldChangeStateToImmediately(e){switch(e){case SA.j.Up:case SA.j.InteractionRequired:case SA.j.LicenseError:return!0;default:return!1}}changeTo(e,t){e!==this.currentAuthState.value&&(this._logger.warn(`[AuthState] Transition from ${this.currentAuthState.value} to ${e}`),this.recordStateChange("AuthState",e),this.currentAuthState.next(e),this._accountId&&(0,wA.kh)(e,this._accountId,t))}}var _A=n(872826),TA=n(329214),IA=n(475368),EA=n(763785),NA=n(663045),AA=n(366800);const FA="Login Rate limit exceeded",DA={AdminUserLicenseNotPresentForbidden:"AdminUserLicenseNotPresentForbidden",AdminTeamsDisabledForTenantForbidden:"AdminTeamsDisabledForTenantForbidden",UserLicenseNotPresentForbidde:"UserLicenseNotPresentForbidde",TeamsDisabledForTenantForbidden:"TeamsDisabledForTenantForbidden",UserLicenseNotPresentTrialEligible:"UserLicenseNotPresentTrialEligible",TrialLicenseTenantNotReady:"TrialLicenseTenantNotReady",NewFederatedUsersNotAllowed:"NewFederatedUsersNotAllowed"},RA=(e,t)=>(t<0||Date.now()-t>=Nr.gT.MILLISECONDS_PER_HOUR)&&((0,An.o7)(e)||[oA.qb.THROTTLED,oA.qb.NOT_AUTHORIZED,-1].indexOf(e)>-1),xA=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const r=(0,IA.uc)(a),{serverResponse:{status:s,body:l}={}}=e;null==r||r.appendEventData({statusCode:s}),(0,An.o7)(null!=s?s:0)?null==r||r.fail({message:(0,Mf.VK)(e),errorCode:he.jK.ServiceUnavailable,statusCode:s}):-1!==s?((null===(i=l.message)||void 0===i?void 0:i.indexOf(FA))>-1&&(null==r||r.incomplete({message:(0,Mf.VK)(e),errorCode:FA,statusCode:s}),o.error(`DiscoverRetryPolicy: Delaying skype token fetch for ${AA.b3.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD}' .`),(0,EA._)(AA.b3.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD)),yield MA(e,t,n,a,o)):null==r||r.incomplete({message:(0,Mf.VK)(e),errorCode:he.jK.TimedOut,statusCode:s})})),MA=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,r;const s=(0,IA.uc)(a),{serverResponse:{status:l,body:c,headers:d}={}}=e;let u;try{const e=yield c.json();u=null===(i=null==e?void 0:e.error)||void 0===i?void 0:i.code}catch(e){o.error(`Body jsonify failed: ${e}`)}switch(o.error(`Getting errorCode: [${u}] from response`),l){case oA.qb.NOT_AUTHORIZED:yield PA(d,n,o,null===(r=t.options)||void 0===r?void 0:r.userIdentifier),null==s||s.incomplete({message:(0,Mf.VK)(e),errorCode:null!=u?u:he.jK.Unauthorized,statusCode:l});break;case oA.qb.FORBIDDEN:((e,t)=>e===oA.qb.FORBIDDEN&&!!t&&t in DA)(l,u)&&OA(u,t,a),null==s||s.cancel({message:(0,Mf.VK)(e),errorCode:null!=u?u:he.jK.Forbidden,statusCode:l});break;case oA.qb.THROTTLED:default:null==s||s.incomplete({message:(0,Mf.VK)(e),errorCode:null!=u?u:he.jK.Throttled,statusCode:l})}})),OA=(e,t,n)=>{const i=(0,IA.uc)(n);if(e===DA.NewFederatedUsersNotAllowed)return t.headerUpdate||(t.headerUpdate={strongConsistencyValue:(a=AA.vu.strongConsistencyMsInternalUserSignup,AA.vu.strongConsistencyDefaultValue.replace("{id}",a))}),void(null==i||i.mark(DA.NewFederatedUsersNotAllowed));var a;e===DA.UserLicenseNotPresentTrialEligible?(null==i||i.mark(DA.UserLicenseNotPresentTrialEligible),t.lastLicenseErrorTime=-1):t.lastLicenseErrorTime=Date.now()},PA=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;e&&0!==(null===(i=Object.keys(e))||void 0===i?void 0:i.length)?yield t(e,a):n.error("DiscoverUnauthorizeError: header is empty")}));const LA=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return UA(e,t,jA)({policy:n,delay:n.createDelay(),retryCount:0,retriesTable:{},startTime:Date.now().valueOf(),forever:n.foreverCheck,headerUpdate:void 0,lastLicenseErrorTime:-1,options:{userIdentifier:null!=a?a:void 0}})})),UA=(e,t,n)=>a=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){for(var i;;){const o=t;(null===(i=a.headerUpdate)||void 0===i?void 0:i.strongConsistencyValue)&&(o.headers||(o.headers={}),o.headers.ConsistencyLevel=a.headerUpdate.strongConsistencyValue);try{return yield e(o)}catch(e){yield n(e,a)}}})),jA=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!e.serverResponse)throw e;const n=!(yield t.forever()),{serverResponse:{status:i}}=e;if(-1!==t.startTime&&Date.now().valueOf()-t.startTime>=t.policy.retryMaxTimeMs&&(t.startTime=-1,t.policy.retryMaxTimeCallback(n)),i&&t.policy.isOnline()&&(t.retryCount++<t.policy.maxRetryCount&&!n||n)&&t.policy.shouldRetry(i,t.lastLicenseErrorTime))return t.retriesTable[i]=(t.retriesTable[i]||0)+1,t.policy.errorHandler(e,t);throw e}));var $A=n(729690),BA=n(471608),WA=n(662239),HA=n(307826),VA=n(214166),zA=n(536947);class qA{constructor(e,t,n,a,o,r,s,l,c,d,u,m,g,p=(0,Ue.J)()){var v,h,f,y,b;this._authenticationService=e,this._coreSettings=a,this._scenarioFactory=o,this._networkStateProvider=r,this._hostCommunicationService=s,this._i18n=l,this._authStateProvider=c,this.onDiscoverSuccess=d,this.onDiscoverFail=u,this.isCDLWorker=m,this.cdlAuthClient=g,this.globalScope=p,this._skypeToken=new xw.X(null),this._localStorageKeys=[],this.clearDiscoveryCacheForLogout=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,BA.Xx)(e);this.clearDiscoveryCache(t,["^fn:clearDiscoveryCacheForLogout"])})),this.clearDiscoveryCache=(e,t,n)=>{this._skypeToken=new xw.X(null),WA.Jt.del((0,IA.Z2)(e)),null==t||t.push("skypeCacheClear"),n||(WA.Jt.del((0,IA.Mu)(e)),null==t||t.push("userDetailsCacheClear"),WA.Jt.del((0,IA.S9)(e)),null==t||t.push("regionGtmsCacheClear")),this._clearFromLocalStorage(n),null==t||t.push("localstorageCacheClear"),this._logger.log(`[clearDiscoveryCache] Discover cache cleared, tokenOnly: ${!!n}.`)},this._getDiscoverResponse=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,i,a,o;const{correlationId:r=(0,Mf.pW)(),eventData:s=[]}=e;null==s||s.push("_getDiscoverResponse|startScenario");const l=this._scenarioFactory.newScenario(it.RG.GetSkypeToken);let c;try{if(!this._isAppOnline())throw(0,xf.Tr)(Object.assign(Object.assign({},IA.bO),{correlationId:r}));if((null===(t=this._authStateProvider)||void 0===t?void 0:t.getState())===SA.j.InteractionRequired)throw(0,xf.Tr)(Object.assign(Object.assign({},IA.BD),{correlationId:r}));c=yield this._discoverProvider(Object.assign(Object.assign({},e),{eventData:s})),(0,IA.nH)(c,this._coreSettings,this._telemetryProvider,this._logger)}catch(e){const t=e.errorCode||e.code,{serverResponse:{status:o}={}}=e;throw o===oA.qb.FORBIDDEN?(null===(n=this._authStateProvider)||void 0===n||n.reportSkypeTokenState(SA.Q.LicenseError,e),null==s||s.push("authState:license-error")):t!==kT.SM.InteractionRequired?(null===(i=this._authStateProvider)||void 0===i||i.reportSkypeTokenState(SA.Q.Failure),null==s||s.push("authState:0")):null===(a=this._authStateProvider)||void 0===a||a.reportSkypeTokenState(SA.Q.InteractionRequired),this.onDiscoverFail&&this.onDiscoverFail(!!this._bootstrapData),(0,IA.lm)(e,s,this._isAppOnline(),l,this._logger,this._coreSettings)}null===(o=this._authStateProvider)||void 0===o||o.reportSkypeTokenState(SA.Q.Success);const d=(0,IA.ZC)(c,this._logger);yield(0,IA.ut)(e.userIdentifier,d,s,r,this._logger,this._scenarioFactory,this.globalScope,this._hostCommunicationService,this._coreSettings);const u=yield(0,IA.qW)(this._authenticationService,this._logger,s);return(0,BA.FG)(null==e?void 0:e.userIdentifier,u)||!(null==e?void 0:e.userIdentifier)?this._skypeToken.next(c.skypeToken):this._logger.error(`[_getDiscoverResponse][${r}] option uid:${null==e?void 0:e.userIdentifier}`),null==l||l.stop({reason:s.join(";")}),this.onDiscoverSuccess&&this.onDiscoverSuccess(),c})),this._isSkypeTokenValidInMemory=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=null!=e?e:yield(0,IA.qW)(this._authenticationService,this._logger,[]);return!!WA.Jt.getValue((0,IA.Z2)(t))})),this._retryMaxTimeCallback=e=>{var t;return e?(null===(t=this._authStateProvider)||void 0===t||t.reportSkypeTokenState(SA.Q.Failure),this._logger.error("[_retryMaxTimeCallback]Reporting skype token failure to authState"),!1):(this._logger.warn("[_retryMaxTimeCallback] Reached retry max time."),!1)},this._getResponseFromLocalStorage=(e,t)=>{if(!t||!e)return;const n=this._getFromLocalStorage(e,t,"auth.gtm.table"),i=this._getFromLocalStorage(e,t,"auth.skype.token");return n&&i?Object.assign(Object.assign({},i.userDetails),{skypeToken:i.skypeToken,expires:new Date(i.expiration),regionGtms:n}):void 0},this._getCachedResponseWrapper=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n;return this._getResponseFromLocalStorage(null===(t=null==e?void 0:e.profile)||void 0===t?void 0:t.oid,null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.tid)})),this._acquireSkypeTokenWeb=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,i,a;null===(t=e.eventData)||void 0===t||t.push("fn:_acquireSkypeTokenWeb");let o=yield this._authenticationService.getUser({accountId:e.userIdentifier.id,userIdentifier:e.userIdentifier,correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:it.RG.AuthWebUser}});if(null===(n=e.eventData)||void 0===n||n.push("user:"+ +!!o,"uid:"+ +!!e.userIdentifier),!o){if(o=yield this._authenticationService.getUser({correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:it.RG.AuthWebUser}}),!o)throw(0,xf.Tr)({context:AA.xm,subContext:"_acquireSkypeTokenWeb",errorCode:kT.SM.UserNotFoundError,message:"User not found for provided userIdentifier nor globally.",correlationId:e.correlationId,isExpected:!1});(0,IA.nD)(e,o,this._logger)}const r=yield this._getCachedResponseWrapper(o);if(r)return null===(i=e.eventData)||void 0===i||i.push("cache:1"),r;const s=WA.Jt.getValue((0,IA.Mu)((0,BA.Xx)(o))),l=(0,IA.TB)(o,e.correlationId,this._coreSettings,this._logger,this._i18n,!!s),c=this._scenarioFactory.findScenario(it.RG.GetSkypeToken);null==c||c.mark(AA.j.SKYPE_SEND_REQUEST,(0,IA.nd)(e.eventData,this._isAppOnline(),this._coreSettings));const d=yield this.send({userIdentifier:e.userIdentifier,correlationId:e.correlationId})(l);return null===(a=e.eventData)||void 0===a||a.push("response:1"),null==c||c.mark(AA.j.SKYPE_RECEIVED_RESPONSE,(0,IA.nd)(e.eventData,this._isAppOnline(),this._coreSettings)),c&&(c.eventData.authzCorrelationId=d.headers["correlation-id"],c.eventData.correlationTags=d.headers["correlation-tags"],c.eventData.correlationId=null==e?void 0:e.correlationId),(0,IA.Qe)(d,e,this._logger)})),this._acquireSkypeTokenDesktop=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,i,a;null===(t=e.eventData)||void 0===t||t.push("fn:_acquireSkypeTokenDesktop");const o=yield this._authenticationService.getUser({accountId:e.userIdentifier.id,userIdentifier:e.userIdentifier,correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:it.RG.AuthWebUser}}),r=yield this._getCachedResponseWrapper(o);if(r)return r;null===(n=e.eventData)||void 0===n||n.push("cache:0");const s=this._scenarioFactory.findScenario(it.RG.GetSkypeToken);null==s||s.mark(AA.j.SKYPE_SEND_REQUEST_DESKTOP);const l=yield this.globalScope.opener.requestMessage(n_.rY.GetStateData,{requestType:"skypeToken",timeout:Nr.lP.ACQUIRE_TOKEN_TIMEOUT});null==s||s.mark(AA.j.SKYPE_RECEIVED_RESPONSE);const c=null==l?void 0:l.skypeTokenData;s&&(s.eventData.correlationId=null==l?void 0:l.correlationId);return{userId:(0,IA.LO)(null===(i=null==c?void 0:c.token)||void 0===i?void 0:i.skypeToken,this._logger),userDetails:null==c?void 0:c.userDetails,skypeToken:null===(a=null==c?void 0:c.token)||void 0===a?void 0:a.skypeToken,regionGtms:null==c?void 0:c.regionGtms,expires:new Date(null==c?void 0:c.token.expiration)}})),this._acquireSkypeTokenWorker=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{eventData:t}=e;if(t.push("fn:_acquireSkypeTokenWorker"),!this.cdlAuthClient)throw(0,xf.Tr)({context:AA.xm,subContext:"_acquireSkypeTokenWorker",errorCode:he.jK.NotPresent,message:"CDL worker auth client unavailable",correlationId:e.correlationId,isExpected:!1});const n=!1!==e.forceRenew,i=this._scenarioFactory.findScenario(it.RG.GetSkypeToken);null==i||i.mark(AA.j.SKYPE_SEND_REQUEST_WORKER);const a=yield this.cdlAuthClient.getSkypeToken(n);return null==i||i.mark(AA.j.SKYPE_TOKEN_RECEIVED_WORKER),Object.assign(Object.assign({userId:(0,IA.LO)(a.skypeToken,this._logger)},a.userDetails),{skypeToken:a.skypeToken,regionGtms:a.regionGtms,expires:new Date(a.expiration)})})),this._getRetryForSend=e=>{const{authzResource:t,disableRetryInDiscoverV2:n}=this._coreSettings.get(L.J.Auth);return a=>{var o;if(!this._authenticationService.authorizeV2)throw(0,xf.Tr)({context:AA.xm,subContext:"_getRetryForSend",errorCode:"AuthorizeV2NotFound",message:"AuthorizeV2 endpoint not accessible",correlationId:null!==(o=a.correlationId)&&void 0!==o?o:(0,Mf.pW)(),isExpected:!1});const r=this._authenticationService.authorizeV2.bind(this._authenticationService),s=()=>(0,TA.B)(r(e,t||Nr.ej.MT_AAD_KEY,{userIdentifier:a.userIdentifier}),oA.qb.OK);return n?s():function(e,t,n){return i=>LA(e,i,t,n)}(s(),((e,t,n,a,o,r)=>({shouldRetry:RA,errorHandler:(a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=(0,IA.uc)(t),{serverResponse:{status:r,headers:s}={}}=a;if(!r||!o.retriesTable[r])throw a.reason=Object.assign(Object.assign({},a.reason),{scenarioStep:"fail"}),a.message=`dicoverRetryPolicy: retry count for ${r} is empty`,a;const l=null==s?void 0:s["correlation-id"],c=null==s?void 0:s["correlation-tags"];null==i||i.appendEventData({authzCorrelationId:l,correlationTags:c}),o.headerUpdate=void 0,yield xA(a,o,n,t,e),e.error(`[DiscoverRetryPolicy]: retrying '[${o.retryCount}]' times due to response status - '[${r}], wait for '[${o.delay.next()}] for next retry..'`);const d=yield o.forever();if(o.retryCount>=o.policy.maxRetryCount&&d)throw e.log(`[DiscoverRetryPolicy]: maxTimeReached count: ${o.retryCount} and tokenValid, cancel forever`),a.reason=["LoggedAlready"],a;return(0,EA._)(o.delay.next())})),retryMaxTimeMs:Nr.lP.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS,maxRetryCount:Nr.lP.DEFAULT_SKYPE_MAX_RETRY_COUNT,createDelay:()=>new NA.df(Nr.lP.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS,Nr.lP.DEFAULT_SKYPE_EXP_DELAY_FACTOR,Nr.lP.DEFAULT_SKYPE_MAX_DELAY_TIME_MS),isOnline:a,retryMaxTimeCallback:o,foreverCheck:r}))(this._logger,this._scenarioFactory,this.unauthorizedErrorHandler,this._isAppOnline,this._retryMaxTimeCallback,this._isSkypeTokenValidInMemory),a.userIdentifier)}},this._isRefreshInBackgroundRequired=(e,t,n,i)=>{(null==e?void 0:e.shouldRefresh)&&(null==n||n.push("shouldrefreshbg"),this._debouncedGetDiscoverResponse((0,wi.u4)(t),{userIdentifier:t,correlationId:i,eventData:n}).catch((e=>{(0,IA.H)(e,null==e?void 0:e.message,n,this._logger)})))},this._populateDiscoverResponseFromBootstrapdata=()=>{this._bootstrapData=this._coreSettings.get(L.J.Host).authBootstrapData,this._bootstrapData},this._isAppOnline=()=>this._networkStateProvider.getState()===Pf.G.Online,this.unauthorizedErrorHandler=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){(0,IA.qO)(e,t,this._authenticationService,this._coreSettings,this._logger)})),this._logger=t.newLogger(AA.xm,"core-services-discover"),(0,HA.g)(this,"DiscoverV2",this._getConfig("mockApi"),this._getConfig("enableMockApi")),this.send=this._getRetryForSend(n),this._debouncedGetDiscoverResponse=(0,VA.k)(this._getDiscoverResponse),(0,WA.ky)(p),this._populateDiscoverResponseFromBootstrapdata(),this._discoverProvider=this.resolveProvider(),null===(h=null===(v=this._authenticationService)||void 0===v?void 0:v.registerCleanUpOnLogoutCallback)||void 0===h||h.call(v,kt.D.Discover,this.clearDiscoveryCacheForLogout),this._tokenObserver=null===(b=null===(y=(f=this._authenticationService).observeMiddleTierToken)||void 0===y?void 0:y.call(f))||void 0===b?void 0:b.subscribe((e=>{void 0===e&&(0,IA.qW)(this._authenticationService,this._logger,[]).then((e=>{e&&WA.Jt.del((0,IA.Z2)(e))}))})),this._telemetryProvider=(0,pT.G)(),this._logger.log("[ctor]Service initialized.")}observeSkypeToken(){return this._skypeToken.pipe((0,jw.h)((e=>null!==e)),(0,qN.x)())}shouldThrowErrorIfSkypeTokenIsEmpty(){return!this._coreSettings.get(L.J.Auth).disableThrowingErrorIfSkypeTokenIsEmpty}getSettingToDisableSkypeTokenValidation(e,t){return(0,IA.wh)(e,t,this._coreSettings,this._logger,this._scenarioFactory)}regionGtm(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=(0,Mf.pW)(),i=["^fn:regionGtm:uid:"+ +!!t];try{const a=null!=t?t:yield(0,IA.qW)(this._authenticationService,this._logger,i);let o=WA.Jt.getValue((0,IA.S9)(a));if(!o){this._logger.log(`[regionGtm][${n}] No cached regionGtm, start network call..`),null==i||i.push("cache:0");const e=yield this._debouncedGetDiscoverResponse((0,wi.u4)(a),{userIdentifier:a,correlationId:n,eventData:i});o=null==e?void 0:e.regionGtms,null==i||i.push(`InResponse:${!!o}`)}const r=null==o?void 0:o[e];if(r)return r===AA.sW?r:(0,HE.m)(r);throw(0,xf.Tr)({correlationId:n,message:`${AA.xm}[regionGtm][${n}] ${e} not found in regionGtms table`,isExpected:!0,context:AA.xm,subContext:"regionGtm",errorCode:"RegionGtmNotFoundInRespone"})}catch(e){throw(0,IA.WA)(e,"regionGtm",n),(0,IA.H)(e,null==e?void 0:e.message,i,this._logger)}}))}skypeid(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,Mf.pW)(),n=["^fn:skypeid:uid:"+ +!!e];try{const n=yield this.getUser(t,e);if(!n){const e=`[skypeid][${t}] No userDetail for getting skypeId`;throw this._logger.error(e),new Error(`${AA.xm} No user for getting skypeId`)}return n.id}catch(e){throw(0,IA.WA)(e,"skypeid",t),(0,IA.H)(e,null==e?void 0:e.message,n,this._logger)}}))}validateSkypeToken(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield this.validateSkypeTokenV2(e)).skypeToken}))}validateSkypeTokenV2(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,Mf.pW)(),o=["^fn:validateSkypeToken:uid:"+ +!!(null==e?void 0:e.userIdentifier)];try{const r=null!==(t=null==e?void 0:e.userIdentifier)&&void 0!==t?t:yield(0,IA.qW)(this._authenticationService,this._logger,o),s=WA.Jt.get((0,IA.Z2)(r)),l=null==s?void 0:s.item;if(o.push(`cache:${!!l}`),l&&(yield(0,$A.p)(l,this.globalScope,this._scenarioFactory,this._hostCommunicationService,this._coreSettings)),(null==r?void 0:r.accountType)===nd.Ch.Anonymous&&(null==l?void 0:l.skypeToken)&&!this._coreSettings.get(L.J.Auth).disableIgnoringForceRenewForAnon)return null===(n=this._authStateProvider)||void 0===n||n.reportSkypeTokenState(SA.Q.Success),{skypeToken:l.skypeToken,fromCache:!0};const c=null==e?void 0:e.forceRenew,d=null==e?void 0:e.invalidSkypeToken;if(!c&&l&&l.skypeToken&&l.skypeToken!==d&&l.expiration&&l.expiration>Date.now())return this._isRefreshInBackgroundRequired(s,r,o,i),this._skypeToken.value||this._skypeToken.next(l.skypeToken),null===(a=this._authStateProvider)||void 0===a||a.reportSkypeTokenState(SA.Q.Success),{skypeToken:l.skypeToken,fromCache:!0};this.clearDiscoveryCache(r,o,!0),this._logger.log(`[validateSkypeToken][${i}] Skype token not valid during ping of forceRenew:${c}, clear old cache and start wire request.`);const u=yield this._debouncedGetDiscoverResponse((0,wi.u4)(r),{userIdentifier:r,correlationId:i,eventData:o});return this._logger.log(`[validateSkypeToken][${i}] SkypeToken fetched from network.`),o.push(`InResponse:${!!u.skypeToken}`),{skypeToken:u.skypeToken,fromCache:!1}}catch(e){throw(0,IA.WA)(e,"validateSkypeToken",i),(0,IA.H)(e,null==e?void 0:e.message,o,this._logger)}}))}getRegion(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,Mf.pW)(),n=["^fn:getRegion:uid:"+ +!!e];try{const i=null!=e?e:yield(0,IA.qW)(this._authenticationService,this._logger,n),a=WA.Jt.getValue((0,IA.Mu)(i));if(a)return a.region;n.push("cache:0"),this._logger.log(`[getRegion][${t}] No user details found in cache. Getting it from request.`);const o=yield this._debouncedGetDiscoverResponse((0,wi.u4)(i),{userIdentifier:i,correlationId:t,eventData:n});return n.push(`InResponse:${!!o.region}`),o.region}catch(e){throw(0,IA.WA)(e,"getRegion",t),(0,IA.H)(e,null==e?void 0:e.message,n,this._logger)}}))}getUserRegionForMultiGeo(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,Mf.pW)(),n=["^fn:getUserRegionForMultiGeo:uid:"+ +!!e];try{const i=null!=e?e:yield(0,IA.qW)(this._authenticationService,this._logger,n),a=WA.Jt.getValue((0,IA.Mu)(i));if(a)return null==a?void 0:a.userRegion;n.push("cache:0"),this._logger.log(`[getUserRegionForMultiGeo][${t}] No user details found in cache. Getting it from request.`);const o=yield this._debouncedGetDiscoverResponse((0,wi.u4)(i),{userIdentifier:i,correlationId:t,eventData:n});return n.push(`InResponse:${!!o.userRegion}`),null==o?void 0:o.userRegion}catch(e){throw(0,IA.WA)(e,"userRegion",t),(0,IA.H)(e,null==e?void 0:e.message,n,this._logger)}}))}getUser(e=(0,Mf.pW)(),t){var n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=["^fn:getUser:uid:"+ +!!t];try{const o=null!=t?t:yield(0,IA.qW)(this._authenticationService,this._logger,i);let r=WA.Jt.getValue((0,IA.Mu)(o));if(r||(this._logger.log(`[getUser][${e}]No cache, start network call...`),i.push("cache:0"),i.push(`IsCDL:${this.isCDLWorker&&this.cdlAuthClient}`),r=this.isCDLWorker&&this.cdlAuthClient?null===(n=yield this.cdlAuthClient.getUserDetails())||void 0===n?void 0:n.userDetails:(0,IA.br)(i,this._bootstrapData,this._logger)||(null===(a=yield this.getSkypeTokenInfoFromDiscoveryResponse({silent:!1,correlationId:e,userIdentifier:t,eventData:i}))||void 0===a?void 0:a.userDetails)),!r)throw new Error(`${AA.xm}[getUser][${e}] UserDetails fetched failure from network request`);return(0,IA.wC)(r)}catch(t){(0,IA.WA)(t,"getUser",e);const n=(0,IA.H)(t,null==t?void 0:t.message,i,this._logger);throw new zA.l(n)}}))}getSkypeTokenInfoFromDiscoveryResponse(e){var t,n,a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{correlationId:i=(0,Mf.pW)(),userIdentifier:r}=e||{},s=null!==(t=null==e?void 0:e.eventData)&&void 0!==t?t:[];null==s||s.push("fn:getSkypeTokenInfoFromDiscoveryResponse");try{const t=null!=r?r:yield(0,IA.qW)(this._authenticationService,this._logger,s),l=null==e?void 0:e.forceRenew,c=WA.Jt.get((0,IA.Z2)(t));if((null==t?void 0:t.accountType)===nd.Ch.Anonymous&&(null===(n=null==c?void 0:c.item)||void 0===n?void 0:n.skypeToken)&&!this._coreSettings.get(L.J.Auth).disableIgnoringForceRenewForAnon)return null===(a=this._authStateProvider)||void 0===a||a.reportSkypeTokenState(SA.Q.Success),c.item;let d;if(c&&c.item&&!l)this._isRefreshInBackgroundRequired(c,t,s,i),d=c.item;else{null==s||s.push("cache:0"),this._logger.log(`[getSkypeTokenInfoFromDiscoveryResponse][${i}] No response retrieved from cache.`),this.clearDiscoveryCache(t,s,!0);const n=yield this._debouncedGetDiscoverResponse((0,wi.u4)(t),Object.assign(Object.assign({},e),{userIdentifier:t,eventData:s}));d=(0,IA.ZC)(n,this._logger)}return null===(o=this._authStateProvider)||void 0===o||o.reportSkypeTokenState(SA.Q.Success),d}catch(e){throw(0,IA.WA)(e,"getSkypeTokenInfoFromDiscoveryResponse",i),(0,IA.H)(e,null==e?void 0:e.message,s,this._logger)}}))}unsubscribeMtToken(){var e;null===(e=this._tokenObserver)||void 0===e||e.unsubscribe()}getConsumerLicenseDetails(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=(0,Mf.pW)(),i=["^fn:getConsumerLicenseDetails:uid:"+ +!!e];try{const a=null!=e?e:yield(0,IA.qW)(this._authenticationService,this._logger,i);if(!(a.accountType===nd.Ch.MsaLife))return this._logger.log(`[getConsumerLicenseDetails][${n}] User account type is not MsaLife.`),Promise.resolve(void 0);const o=WA.Jt.getValue((0,IA.Mu)(a)),r=null===(t=null==o?void 0:o.licenseDetails)||void 0===t?void 0:t.consumerLicenseDetails;if(r)return r;i.push("cache:0"),this._logger.log(`[getConsumerLicenseDetails][${n}] No user license details found in cache. Getting it from request.`);const s=yield this._debouncedGetDiscoverResponse((0,wi.u4)(a),{userIdentifier:a,correlationId:n,eventData:i});return i.push(`InResponse:${!!(null==s?void 0:s.consumerLicenseDetails)}`),null==s?void 0:s.consumerLicenseDetails}catch(e){throw(0,IA.WA)(e,"getConsumerLicenseDetails",n),(0,IA.H)(e,null==e?void 0:e.message,i,this._logger)}}))}_clearFromLocalStorage(e){var t;(null===(t=this.globalScope)||void 0===t?void 0:t.localStorage)&&(e?this._localStorageKeys.forEach((e=>{e.indexOf("auth.skype.token")>-1&&this.globalScope.localStorage.removeItem(e)})):this._localStorageKeys.forEach((e=>{this.globalScope.localStorage.removeItem(e)})),this._localStorageKeys=[])}resolveProvider(){return this._bootstrapData?this._acquireSkypeTokenDesktop:this.isCDLWorker?this._acquireSkypeTokenWorker:this._acquireSkypeTokenWeb}_getFromLocalStorage(e,t,n){var i;if(!(null===(i=this.globalScope)||void 0===i?void 0:i.localStorage))return;let a=`ts.${t}-${e}.${n}`,o=this.globalScope.localStorage.getItem(a);if(o||(a=`ts.${e}.${n}`,o=this.globalScope.localStorage.getItem(a)),o){this._localStorageKeys.push(a);try{return JSON.parse(o)}catch(e){this._logger.error(`[_getFromLocalStorage] ${e}`)}}}_getConfig(e){return this._coreSettings.get(L.J.Auth)[e]}}const GA=(e,t,n,i,a,o,r,s,l,c,d,u,m,g,p,v)=>{const{enableRequireDiscoverV2:h}=i.get(L.J.Auth);return h?new qA(e,t,n,i,a,r,s,l,c,u,m,g,p,v):new _A.Jq(e,t,n,i,a,o,d,u,m,g,p,v)};var JA=n(177768);class QA extends fe{constructor(){super(he.Yg.CreateAuthMTMA,["appStateService","loggerFactory","scenarioFactory","networkState","coreSettings","authenticationService","authenticationUser","telemetryService","i18n","deeplinkService","userBiService","hostCommunicationService"])}execute(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appStateService:i,loggerFactory:a,scenarioFactory:o,networkState:r,coreSettings:s,authenticationService:l,authenticationUser:c,telemetryService:d,i18n:u,deeplinkService:m,userBiService:g,hostCommunicationService:p}=e,{enableUserAuthT2:v}=s.get(L.J.Auth)||{};if(!v)return;(0,kA.u)(null==c?void 0:c.id,g);const h=KA(c);try{if(!c)throw new Error("No AuthenticationUserContext found during User Auth init.");if(!l.createUserAuth)throw new Error("No User Auth Creation API exposed.");const n=new CA(a,s,c.id);e.authStateProvider=n,h.addEventData(["authState:created"]);const g=null===(t=l.createUserAuth)||void 0===t?void 0:t.call(l,c,"create-auth-mtma-task",n,m);e.authenticationService=g,h.addEventData(["userAuth:created"]);const v=(0,JA.Gg)(i);let f;s.get(L.J.Telemetry).useTelemetryServicesCache&&(f=d.getTelemetryServicesCache().get(c.id),h.setUserToTelemetryContext({id:c.id,oid:c.profile.objectId,tid:c.profile.tenantId,type:c.type,role:c.role,subType:c.subType}));const y=GA(g,a,ye.l,s,(null==f?void 0:f.coreScenarioFactory)||o,v,r,p,u,n,void 0,void 0,void 0,void 0,void 0);return e.discover=y,h.addEventData(["discover:created"]),y.validateSkypeToken(),s.get(L.J.Telemetry).useTelemetryServicesCache&&y.getRegion().then((e=>h.setUserDetailsToTelemetryContext({region:e||""}))),h.closeScenario(),e=>{switch(e){case"quit":case"restart":break;case"signout":default:null==n||n.cleanupObservables()}}}catch(e){const t=e instanceof zA.l?e:new zA.l(e);throw h.closeScenario({error:null!==(n=t.prevError)&&void 0!==n?n:e}),t}}))}}const KA=e=>{const t={id:(0,Mf.pW)(),scenarioName:it.RG.AuthUserInit,source:"create-auth-mtma-task::execute"};return kA.cv.create({correlation:t,subContext:"createAuthMTMATask",timeoutMs:kT.rF.ONE_HOUR,scenarioEventData:{context:`id:${!!(null==e?void 0:e.id)}`,accountId:null==e?void 0:e.id}})};var YA=n(289887),XA=n(962687);const ZA=(e,t,n)=>{var i;const{environment:a}=null!==(i=n.get(L.J.Metadata))&&void 0!==i?i:{},{clientType:o,currentUrl:r,hostingParent:s,isInIframe:l,isInCypressFrame:c,browser:d,browserVersion:u,osPlatform:m,osVersion:g}=t.config;return Object.assign(Object.assign({},e),{clientType:o,currentUrl:r,hostingParent:s,isInIframe:l,isInCypressFrame:c,browser:d,browserVersion:u,osPlatform:m,osVersion:g,environment:a})},eF=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){e.initializeAuthenticationService&&(yield e.initializeAuthenticationService())})),tF=(e,t,n,i)=>{const a={id:(0,Mf.pW)(),scenarioName:it.RG.AuthStart,source:"core-auth-tasks::init"};return WA.Jt.put(YA.Jl.authSessionId,a.id),kA.cv.create({correlation:a,subContext:"createAuthenticationServiceInstance",timeoutMs:kT.rF.ONE_HOUR,scenarioEventData:{context:`env:${e}||host:${t}||v2:${+!!n}||global:${+!!i}`}})},nF=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;null===(i=e.registerCleanUpOnLogoutCallback)||void 0===i||i.call(e,"BatchAuthTelemetry",(e=>(0,XA.mM)(t,n,null==e?void 0:e.id)))}));class iF extends fe{constructor(){super(he.Yg.CreateAuth,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.authenticationService=yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,i,a;const{loggerFactory:o,scenarioFactory:r,config:s,appStateService:l,coreSettings:d,windowProvider:u,platformService:m,authStateProvider:g,hostCommunicationService:p,telemetryService:v,i18n:h,rebootService:f,userBiService:y}=e,b=(0,WA.ky)(u);(0,kA.Tu)(r,b,v),(0,kA.u)(void 0,y);const S=ZA(s,m,d),k=(0,JA.Gg)(l),{enableAuthV2:w,enableUserAuthT2:C}=(null==d?void 0:d.get(L.J.Auth))||{},_=tF(null!==(t=S.environment)&&void 0!==t?t:"",null===(i=null==u?void 0:u.location)||void 0===i?void 0:i.hostname,!!w,!!C);let T;try{T=w?C?new((yield(0,c.mT)((()=>Promise.all([n.e(671326),n.e(322203),n.e(745698),n.e(608983)]).then(n.bind(n,170561))),"global-auth",r)).GlobalAuthService)(o,r,S,u,p,h,d,f):new((yield(0,c.mT)((()=>Promise.all([n.e(671326),n.e(322203),n.e(745698),n.e(496106)]).then(n.bind(n,568218))),"auth_v2",r)).AuthenticationService)(o,r,S,u,p,h,g,d):new((yield(0,c.mT)((()=>Promise.all([n.e(680217),n.e(671326),n.e(469648),n.e(159818)]).then(n.bind(n,156370))),"auth",r)).AuthenticationService)(o,r,k,S,u,v,d,p),yield eF(T);const{enableBatchScenario:e}=(null==d?void 0:d.get(L.J.Auth))||{};e&&(yield nF(T,r,b)),_.closeScenario()}catch(e){const t=e instanceof zA.l?e:new zA.l(e);throw _.closeScenario({error:null!==(a=t.prevError)&&void 0!==a?a:e}),t}return T})))(e)}))}}var aF=n(774279);const oF=(e,t,n,i)=>{var a;if(null===(a=null==i?void 0:i.get(L.J.Auth))||void 0===a?void 0:a.enableMtoCoachMark){(null==t?void 0:t.some((e=>"DefaultHidden"===(null==e?void 0:e.userTenantState)&&"MTO"===(null==e?void 0:e.tenantRelationship))))&&(null==e||e.recordAuthUserBiTelemetry(n,{scenario:aF.dX.authMtoUser}))}},rF=(e,t)=>kA.cv.create({correlation:e,subContext:"createAuthTenantsTask",timeoutMs:kT.rF.ONE_HOUR,scenarioEventData:{accountId:null==t?void 0:t.id}});class sF extends fe{constructor(){super(he.Yg.CreateAuthTenants,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e;yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{coreSettings:n,authenticationUser:i,endpointsManager:a,authenticationService:o}=e,{enableUserAuthT2:r,enableMultiTenants:s}=n.get(L.J.Auth)||{},{testAutomation:l}=n.get(L.J.Test)||{};if(!r||!s)return;const c={id:(0,Mf.pW)(),scenarioName:it.RG.AuthWebSetUpTenants,source:"create-auth-tenants-task::setupTenantService"},d=rF(c,i);try{if(!i)throw new Error("No AuthenticationUserContext found during OnUserAuthenticated_MTMA hook");if(!o.setUpTenantsService||!o.getTenants)throw new Error("No TenantsService Set Up found duringGetTenants Task");const e={accountId:i.id,correlation:d.correlation,forceRefresh:!l};try{yield o.setUpTenantsService(a,e)}catch(e){return void d.closeScenario({error:e})}d.addEventData(["tenantService:created"]),o.getTenants(e).then((e=>{d.appendScenarioEventData({tenantCount:null==e?void 0:e.length}),oF(d,e,i.id),d.closeScenario()})).catch((e=>{d.closeScenario({error:e})}))}catch(e){const n=e instanceof zA.l?e:new zA.l(e);throw d.closeScenario({error:null!==(t=n.prevError)&&void 0!==t?t:e}),n}})))(t);const{enableTenantPolling:n}=t.coreSettings.get(L.J.Auth);if(!n)return;const a=yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{coreSettings:n,authenticationService:a,windowProvider:o,authenticationUser:r,correlation:s}=e;if(!r)throw new Error("No AuthenticationUserContext found during OnUserAuthenticated_MTMA hook");if(!(yield a.getUser()).profile.isHomeAccount)return;const l=(null===(t=n.get(L.J.Auth))||void 0===t?void 0:t.tenantPollingMiliseconds)||kT.rF.ONE_DAY,c=o.setInterval((()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e={id:s.id,scenarioName:it.RG.AuthWebGetTenantsInterval,source:"create-auth-tenants-task::tenantPollingInterval"},t=rF(e,r);try{const i={accountId:r.id,forceRefresh:!0,correlation:e};if(!a.getTenants)throw new Error("No valid getTenants function inside tenant polling interval");const o=yield a.getTenants(i);oF(t,o,r.id,n),t.addEventData(["tenantService:AuthWebTenantPolling"]),t.appendScenarioEventData({tenantCount:null==o?void 0:o.length}),t.closeScenario()}catch(e){t.closeScenario({error:e}),o.clearInterval(c)}}))),l);return Promise.resolve(c)})))(t);return e=>{if(a)switch(e){case"signout":t.windowProvider.clearInterval(a);break;case"quit":case"restart":default:return}}}))}}var lF=n(736121);class cF extends fe{constructor(){super(he.Yg.CreateAuthenticationResources,["authenticationService","discover","coreSettings"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.authenticationResources=new lF.I(e.authenticationService,e.discover,e.coreSettings)}))}}class dF extends fe{constructor(){super(he.Yg.CreateAuthStateTask,["loggerFactory","coreSettings","telemetryService"]),this._updateTelemetryOnClientStateChange=(e,t)=>{e.observe().subscribe((e=>{t.setCoreContext("AppInfo.AuthState",e)}))}}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,coreSettings:n,telemetryService:i}=e,{enableAuthState:a,enableUserAuthT2:o}=n.get(L.J.Auth);if(!a||o)return;const r=new CA(t,n);e.authStateProvider=r,this._updateTelemetryOnClientStateChange(r,i)}))}}class uF extends fe{constructor(){super(he.Yg.CreateCacheClearing,["clientState","windowProvider"]),this._clearCacheOnClientStateChangeToInactive=(e,t)=>{e.observe().subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var n;e===yC.pk.Inactive&&(yield null===(n=this.dataEvictionService)||void 0===n?void 0:n.evict(),t.clearCache())}))))}}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,windowProvider:n,dataEvictionService:i}=e;this.dataEvictionService=i,this._clearCacheOnClientStateChangeToInactive(t,n)}))}}var mF=n(268406),gF=n(726989);class pF extends fe{constructor(){super(he.Yg.CreateCacheStorageAndCacheManagers,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,windowProvider:n,config:i,loggerFactory:a}=e;t&&(e.cacheStorage=new mF.E(n.caches,t.profile.tenantId,t.profile.objectId,i.experienceName)),e.cacheStorage&&(e.offlineCacheManager=new gF.G(e.cacheStorage,a))}))}}var vF=n(480250),hF=n(512975);class fF{constructor(e){this.context=e,this._appServiceStateMap=this._newAppServiceStateMap(),this._logger=e.loggerFactory.newLogger("CDLApplicationStateService","core-services-app-state")}notifyServiceUp(e,t,n){this.notifyAppServiceStateChange(e,t,hF.l.ONLINE,n)}notifyServiceDown(e,t,n,i){this.notifyAppServiceStateChange(e,t,hF.l.OFFLINE,n,i)}observeAppServiceState(){const e=Array.from(Object.values(this._appServiceStateMap)).map((e=>e.asObservable().pipe((0,qN.x)())));return(0,vF.T)(...e)}_newAppServiceStateMap(){return Object.values(hF.Q).reduce(((e,t)=>{var n;return e[t]=(n=t,new xw.X({appService:n,currentState:hF.l.UNKNOWN})),e}),{})}notifyAppServiceStateChange(e,t,n,i,a){var o,r,s,l,c;if(!!this.context.coreSettings.get(L.J.CdlWorker).enableUserContextWorkerRegistration&&(null===(o=this.context.cdlWorkerRegistrarService)||void 0===o?void 0:o.mainWindowWorkerId)!==e.workerId)return void(null===(s=(r=this._logger).infoToTelemetry)||void 0===s||s.call(r,`Filtered out appService state changed from worker (originating worker = ${e.workerId}, main window worker id = ${this.context.cdlWorkerRegistrarService.mainWindowWorkerId})`,"cdl_app_state_notification_filtered_out",{origin:e.workerId,target:this.context.cdlWorkerRegistrarService.mainWindowWorkerId,context:t},!0));const d=this._appServiceStateMap[t],u={appService:t,previousState:d.getValue().currentState,currentState:n,currentStateChangeTimestamp:new Date,currentStateChangeReason:i,currentStateChangeCode:a};null===(c=(l=this._logger).infoToTelemetry)||void 0===c||c.call(l,`Received appService state change for ${t} (current state = ${u.currentState}, previous state = ${u.previousState}) from worker '${e.workerId}'`,"cdl_app_state_change_notification",{origin:e.workerId,target:this.context.cdlWorkerRegistrarService.mainWindowWorkerId,context:t},!0),d.next(u)}}var yF=n(768685);const bF=(e,t,n,i,a,o,r,s,l,c,d,u)=>{let m={};return e&&(m={experienceName:e}),t&&(m=Object.assign(Object.assign({},m),{ring:t})),n&&(m=Object.assign(Object.assign({},m),{environment:n})),i&&(m=Object.assign(Object.assign({},m),{sessionId:i})),a&&(m=Object.assign(Object.assign({},m),{platformId:a})),o&&(m=Object.assign(Object.assign({},m),{buildVersion:o})),r&&(m=Object.assign(Object.assign({},m),{localeCode:r})),s&&(m=Object.assign(Object.assign({},m),{workerId:s})),l&&(m=Object.assign(Object.assign({},m),{preAuthUserId:l})),u&&(m=Object.assign(Object.assign({},m),{publicPath:u})),void 0!==d?m=Object.assign(Object.assign({},m),{userConsoleLogLevel:d}):void 0!==c&&(m=Object.assign(Object.assign({},m),{preECSConsoleLogLevel:c})),JSON.stringify(m)};let SF;const kF=(e,t,n,i,a)=>class{constructor(o){const r=i?`${o}#${i}`:o,s=typeof e==typeof Worker?"cdlWorker":"cdlsharedWorker";wF(t,r,!1,s,n),null==a||a(r);const l=((e,t)=>{var n,i;if(SF)return SF;try{return SF=null===(n=window.trustedTypes)||void 0===n?void 0:n.createPolicy("@msteams/core-cdl-worker-common#create-cdl-worker",{createScriptURL:e=>CF(e,t)}),SF}catch(n){null===(i=t.errorToTelemetry)||void 0===i||i.call(t,`Create CDL worker URL trustedType policy failed. This is not a critical error, falling back to function validation. Error ${n}`,"cdl_worker_startup_error_trusted_policy",{endpointUrl:e},!0)}})(r,t);if(l){const t=l.createScriptURL(r);return new e(t)}const c=CF(r,t);return new e(c)}},wF=(e,t,n,i,a)=>{e.log(`{"hostRendererId":${i},"component":${a} Creating CDL Worker with ${n?"passed":"determined"} url ${t} }`)};function CF(e,t){var n;try{const t=new URL(e,_F().location.origin);let n=!0,i="CDL Web worker URL is invalid.";if(t.origin!==_F().location.origin&&(i=i.concat("OriginValidationFailed"),n=!1),n)return e;throw new Error(i)}catch(i){throw null===(n=t.errorToTelemetry)||void 0===n||n.call(t,"CDL web worker url is not valid","cdl_worker_startup_error_invalid_url",{endpointUrl:e},!0),(0,An.Tr)(i.message,he.jK.InvalidUrl,"",void 0)}}function _F(){return window}var TF=n(22899),IF=n(278313),EF=n(811017),NF=n(335637);const AF="MainRenderer",FF="GQL_STOP";class DF extends NF.Q{constructor(e,{rendererId:t,windowId:n},i,a){super(e,{rendererId:t,windowId:n},i,a)}sendFilteredAppStateRequest(e){const t=e.context.appState;return this._rendererId===AF&&(e.context.appState=this.filterWorkerAppState(t)),super.sendRequest(e)}filterWorkerAppState(e){return e}}class RF{constructor(){this.onResponseReceived=e=>{if(this.onMessage){const t=this.transformLegacyClientFields(e.payload.dataLayer);this.onMessage(t)}}}transformLegacyClientFields(e){return e.error&&(e.errors=e.error),e.extensions||(e.extensions={}),e.perfStats&&(e.extensions.perfStats=e.perfStats),e}}class xF extends RF{constructor(e,{rendererId:t,windowId:n},i,a){super(),this._context=i,this._loggingContext={hostRendererId:t,component:"CDLClient",requestWindowId:n},this.sendMessage=t=>e({requestId:t.requestId,rendererId:t.rendererId,windowId:t.windowId,payload:t.request,operationName:t.operationName,type:a,cdlOperationCustomContext:t.cdlOperationCustomContext})}handleResponse(e){var t;return this._context.bootstrapServices.logger.debug("Received message",Object.assign(Object.assign({},this._loggingContext),{requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId})),Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e.rendererId,requestId:e.requestId,windowId:e.windowId,data:e.response.data,errors:e.response.errors?e.response.errors:void 0,errorCode:null===(t=e.response)||void 0===t?void 0:t.errorCode,extensions:e.response.extensions}}}))}}var MF=n(68555);class OF extends MF.D{transitionState(e,t){switch(e){case"authLoaded":this.execute("authServiceInjected",t,void 0);break;case"authServiceInjected":this.completeStateMachine(!0)}}}class PF extends MF.D{transitionState(e,t){switch(e){case"appService:Loaded":this.execute("appService:Injected",t,void 0);break;case"appService:Injected":this.completeStateMachine(!0)}}}var LF,UF,jF,$F=n(634988),BF=n(802319);class WF{constructor(e){this._requestUtility=new $F.H("CDLAuthHandler");let t=[];t=e===AF?[{requestType:BF.m.AadGetToken,handlerFunc:WF.getAadTokensAngular},{requestType:BF.m.AadGetCurrentUser,handlerFunc:WF.getUserInformationAngular},{requestType:BF.m.GetSkypeTokens,handlerFunc:WF.getSkypeTokensAngular},{requestType:BF.m.GetUserDetails,handlerFunc:WF.getUserDetailsAngular},{requestType:BF.m.SubscribeToAuthState,handlerFunc:WF.subscribeToAuthState}]:[{requestType:BF.m.AadGetToken,handlerFunc:WF.getAadTokens},{requestType:BF.m.AadGetCurrentUser,handlerFunc:WF.getUserInformation},{requestType:BF.m.GetSkypeTokens,handlerFunc:WF.getSkypeTokens},{requestType:BF.m.GetUserDetails,handlerFunc:WF.getUserDetails},{requestType:BF.m.SubscribeToAuthState,handlerFunc:WF.subscribeToAuthState}],this._requestUtility.addHandlers(t)}injectDependentServices(e){return new Promise((t=>{if(!e)throw new TypeError("Cannot injectDependentServices of undefined");if("function"==typeof e.getAuthTokens&&(e={authenticationService:e,discover:void 0}),!e.authenticationService)throw new TypeError("Cannot inject authentication service that is not defined");if(this._authenticationService)throw new TypeError("injectDependentServices has been called again, even though it's already initialized");return this._authenticationService=e.authenticationService,this._discover||(this._discover=e.discover),this._authStateProvider||(this._authStateProvider=e.authStateProvider),t()}))}handle(e,t,n){return this._requestUtility.handle(e,t,n,this._authenticationService,this._discover,this._authStateProvider)}static convertAngularPromise(e){return new Promise(((t,n)=>{e.then((e=>t(e))).catch((e=>n(e)))}))}static handleAuthResult(e,t,n){const i=t.bootstrapServices.newScenario(it.RG.AuthHandlerRequest);return i.appendEventData({operation:n}),e.then((e=>{if(null==e){const e="response payload is empty";throw i.fail({message:e}),new Error(e)}const t={statusMsg:`${n} request in main renderer has been processed`,data:e};return i.stop(),t})).catch((e=>{const a=WF.getErrorMessage(n,e),o=!!(0,An.Wc)(e);$F.H.onHandlerError(t,he.jK.UnhandledPromiseRejection,"the auth handler has exception",a,"CDLAuthHandler",!o&&"response payload is empty"!==(null==e?void 0:e.message)),e.isExpected?i.incomplete({message:a}):i.fail({message:a});try{"string"==typeof e&&(e=new Error(e)),e.reason||(e.reason={}),e.reason.cdlClient="auth"}catch(n){t.bootstrapServices.logger.warn(`Failed to handle auth error. Original error: ${(0,An.VK)(e)}. Handling error: ${(0,An.VK)(n)}`,Object.assign({component:"CDLAuthHandler"},t.loggingContext))}throw e}))}static getAadTokensAngular(e,t,n){var i;const a=e.context.resource,o=e.context.options;return WF.logStartHandle(e,t,a),WF.handleAuthResult(WF.convertAngularPromise(n.getAuthToken(a,null==o?void 0:o.claim,null==o?void 0:o.silent,null===(i=e.context)||void 0===i?void 0:i.forceRenew)).then((e=>{if(!e)return;return{token:e.token,expires:e.expiration,tokenType:e.tokenType,fromCache:!1}})),t,BF.m.AadGetToken)}static getAadTokens(e,t,n){const{resource:i,options:a}=e.context;let o;return WF.logStartHandle(e,t,i),o=n.acquireTokenV2?n.acquireTokenV2(i,a):n.acquireToken(i,a).then((e=>({token:e}))),WF.handleAuthResult(o,t,BF.m.AadGetToken)}static getUserInformationAngular(e,t,n){return WF.logStartHandle(e,t),WF.handleAuthResult(WF.convertAngularPromise(n.getUserInformation()),t,BF.m.AadGetCurrentUser)}static getUserDetailsAngular(e,t,n){return WF.logStartHandle(e,t),WF.handleAuthResult(WF.convertAngularPromise(n.getUserDetails()),t,BF.m.GetUserDetails)}static getUserDetails(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){WF.logStartHandle(e,t);const n=yield a.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:!!(null===(o=e.context)||void 0===o?void 0:o.forceRenew)}),i=n?{userDetails:n.userDetails,id:n.userDetails.id}:void 0;return WF.handleAuthResult(Promise.resolve(i),t,BF.m.GetUserDetails)}))}static subscribeToAuthState(e,t,n,a,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!o){t.bootstrapServices.logger.log("Auth-Handler - auth state provider not provided. Not subscribing.",Object.assign({component:"CDLAuthHandler"},t.loggingContext));const e=(0,An.Tr)("AuthStateProvider not provided - This will should be an error in the RWC experience",he.jK.MissingParameter,"Auth-Handler");return Promise.reject(e)}const e=o.observe().subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield WF.handleAuthResult(Promise.resolve(e),t,BF.m.SubscribeToAuthState);$F.H.callResponseCallback(r,n,"success")}))),(e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){$F.H.callResponseCallback(r,{statusMsg:WF.getErrorMessage(BF.m.SubscribeToAuthState,e),data:e},"failure")}))),(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){e.unsubscribe(),$F.H.callResponseCallback(r,{statusMsg:"AuthStateProvider Completed",data:void 0},"failure")}))));return WF.handleAuthResult(Promise.resolve(o.getState()),t,BF.m.SubscribeToAuthState)}))}static getSkypeTokensAngular(e,t,n){var i;WF.logStartHandle(e,t);const a=n.getSkypeTokens(!!(null===(i=e.context)||void 0===i?void 0:i.forceRenew)).then((e=>{if(!e)return;return{expiration:e.tokenExpiration||0,skypeToken:e.skypeToken,userDetails:e.userDetails,regionGtms:e.regionGtms}}));return WF.handleAuthResult(a,t,BF.m.GetSkypeTokens)}static getSkypeTokens(e,t,n,i){var a;return WF.logStartHandle(e,t),WF.handleAuthResult(i.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:!!(null===(a=e.context)||void 0===a?void 0:a.forceRenew)}),t,BF.m.GetSkypeTokens)}static getUserInformation(e,t,n){return WF.logStartHandle(e,t),WF.handleAuthResult(n.getUser({correlation:{source:"AuthHandlerRequest",id:"na",scenarioName:"CentralDataLayerBootstrapAuthGetUser"}}),t,BF.m.AadGetCurrentUser)}static logStartHandle(e,t,n){const i=n?` for resource ${n}`:"";t.bootstrapServices.logger.log(`Auth handler started serving request ${e.requestOperationtype}${i}`,Object.assign({component:"CDLAuthHandler"},t.loggingContext))}}WF.getErrorMessage=(e,t)=>`the request type for ${e} failed due to ${(0,An.VK)(t)}`,function(e){e.MachineActive="MachineActive",e.MachineInactive="MachineInactive",e.MachineLongInactive="MachineLongInactive",e.MachineLocked="MachineLocked"}(LF||(LF={})),function(e){e.NotifyAppState="NotifyAppState",e.NotifyCoreClientState="NotifyCoreClientState",e.NotifyCoreMachineState="NotifyCoreMachineState",e.NotifyCoreSuspendedState="NotifyCoreSuspendedState",e.NotifyServiceUp="NotifyServiceUp",e.NotifyServiceDown="NotifyServiceDown"}(UF||(UF={})),function(e){e[e.ChatSync=0]="ChatSync",e[e.Presence=1]="Presence",e[e.Files=2]="Files",e[e.OneNote=3]="OneNote",e[e.Groups=4]="Groups",e[e.Video=5]="Video",e[e.MasterTab=6]="MasterTab",e[e.IndexDb=7]="IndexDb",e[e.AdalTokens=8]="AdalTokens",e[e.AdalLogin=9]="AdalLogin",e[e.AdalReauth=10]="AdalReauth",e[e.SkypeTokens=11]="SkypeTokens",e[e.SkypeLicense=12]="SkypeLicense",e[e.SupportedBrowser=13]="SupportedBrowser",e[e.MSAGuestLicense=14]="MSAGuestLicense",e[e.AppSession=15]="AppSession",e[e.CSAStartup=16]="CSAStartup"}(jF||(jF={}));class HF{constructor(e,t){this.workerId=t,this._requestUtility=new $F.H("CDLAppServiceHandler");let n=[];n=e===AF?[{requestType:UF.NotifyServiceUp,handlerFunc:HF.notifyServiceUpAngular},{requestType:UF.NotifyServiceDown,handlerFunc:HF.notifyServiceDownAngular}]:[{requestType:UF.NotifyServiceUp,handlerFunc:HF.notifyServiceUp},{requestType:UF.NotifyServiceDown,handlerFunc:HF.notifyServiceDown}],this._requestUtility.addHandlers(n)}injectAppState(e){return new Promise((t=>{if(this.appService)throw new TypeError("injectAppStateService has been called again, even though it's already initialized");return this.appService=e,t()}))}handle(e,t,n){return this._requestUtility.handle(e,t,n,this.appService,this.workerId)}static notifyServiceUp(e,t,n,i){return new Promise((a=>{t.bootstrapServices.logger.log(`App service change is received (worker ${i}), ${e.context.appService} is up and running`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:o,reason:r}=e.context,s={workerId:i};return n.notifyServiceUp(s,o,r),a()}))}static notifyServiceUpAngular(e,t,n){return new Promise((i=>{t.bootstrapServices.logger.log(`App service change is received, ${e.context.appService} is up and running. Notifying Angular.`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:o}=e.context,r=jF[a];return n.notifyServiceUp(r,o),i()}))}static notifyServiceDown(e,t,n,i){return new Promise((a=>{t.bootstrapServices.logger.log(`App service change is received (worker ${i}), ${e.context.appService} is down`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:o,reason:r,code:s}=e.context,l={workerId:i};return n.notifyServiceDown(l,o,r,s),a()}))}static notifyServiceDownAngular(e,t,n){return new Promise((i=>{t.bootstrapServices.logger.log(`Angular app service change is received, ${e.context.appService} is down. Notifying Angular.`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:o,code:r}=e.context,s=jF[a];return n.notifyServiceDown(s,o,r),i()}))}}class VF{constructor(e){this.workerId=e}handle(e,t,n){return new Promise((i=>{var a;n.bootstrapServices.logger.log(`Network state received from CDL worker ${this.workerId}. Network state: ${e.payload.networkState}`,Object.assign({component:"NetworkStateHandler"},n.loggingContext)),null===(a=this.networkStateChangeHandler)||void 0===a||a.next(e.payload.networkState);i(t({response:{statusMsg:"Network state received success.",data:void 0},status:"success"}))}))}injectNetworkStateTracker(e){return new Promise((t=>{if(this.networkStateChangeHandler)throw new TypeError("injectNetworkStateTracker has been called again, even though it's already initialized");return this.networkStateChangeHandler=e,t()}))}}class zF extends MF.D{transitionState(e,t){switch(e){case"networkState:Loaded":this.execute("networkState:Injected",t,void 0);break;case"networkState:Injected":this.completeStateMachine(!0)}}}class qF{constructor(){this._componentName="EndpointsHealthMessageHandler"}handle(e,t,n){return new Promise((i=>{var a,o;(!e.payload||void 0===e.payload.healthState&&void 0===e.payload.endpointHealth)&&(this.log("Endpoints health message received from CDL. Payload is empty.",n),i(t(this.getSuccessMessage()))),e.payload.endpointHealth&&(this.log(`Endpoints health message received from CDL. Update: ${JSON.stringify(e.payload.endpointHealth)}.`,n),null===(a=this.endpointsHealthUpdateHandler)||void 0===a||a.handleEndpointHealthUpdate(e.payload.endpointHealth),i(t(this.getSuccessMessage()))),e.payload.healthState&&(this.log("Endpoints state dump message received from CDL.",n),null===(o=this.endpointsHealthUpdateHandler)||void 0===o||o.handleStateDump(e.payload.healthState),i(t(this.getSuccessMessage())))}))}injectEndpointsHealthUpdateHandler(e){return new Promise((t=>{if(this.endpointsHealthUpdateHandler)throw new TypeError("injectEndpointsHealthUpdateHandler has been called again, even though endpointsHealthUpdateHandler is already initialized");return this.endpointsHealthUpdateHandler=e,t()}))}log(e,t){t.bootstrapServices.logger.log(e,Object.assign({component:this._componentName},t.loggingContext))}getSuccessMessage(){return{response:{statusMsg:"Endpoints health received success.",data:void 0},status:"success"}}}class GF extends MF.D{transitionState(e,t){switch(e){case"endpointsHealthUpdateHandler:Loaded":this.execute("endpointsHealthUpdateHandler:Injected",t,void 0);break;case"endpointsHealthUpdateHandler:Injected":this.completeStateMachine(!0)}}}function JF(e,t,n,i){const{authStateMachine:a,authHandler:o}=QF(e,t,i),{appServiceStateMachine:r,appServiceMessageHandler:s}=KF(e,t,i,n),{networkStateHandlerStateMachine:l,networkStateHandler:c}=YF(e,t,i,n),{endpointsHealthHandlerStateMachine:d,endpointsHealthHandler:u}=XF(e,t,i);return new Map([[EF.k.auth,{stateMachine:a,requestHandler:o}],[EF.k.appService,{stateMachine:r,requestHandler:s}],[EF.k.networkState,{stateMachine:l,requestHandler:c}],[EF.k.endpointHealth,{stateMachine:d,requestHandler:u}]])}const QF=(e,t,n)=>{const i=new WF(t),a={action:i.injectDependentServices.bind(i)},o=new Map;o.set("authServiceInjected",a);return{authHandler:i,authStateMachine:new OF(n,o,"authLoaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"auth",component:"CreateWorkerStateAndRequestHandlers"}},"auth")}},KF=(e,t,n,i)=>{const a=new HF(t,i),o={action:a.injectAppState.bind(a)},r=new Map;r.set("appService:Injected",o);return{appServiceMessageHandler:a,appServiceStateMachine:new PF(n,r,"appService:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"appService",component:"CreateWorkerStateAndRequestHandlers"}},"appService")}},YF=(e,t,n,i)=>{const a=new VF(i),o={action:a.injectNetworkStateTracker.bind(a)},r=new Map;r.set("networkState:Injected",o);return{networkStateHandler:a,networkStateHandlerStateMachine:new zF(n,r,"networkState:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:EF.k.networkState,component:"CreateWorkerStateAndRequestHandlers"}},"networkState")}},XF=(e,t,n)=>{const i=new qF,a={action:i.injectEndpointsHealthUpdateHandler.bind(i)},o=new Map;o.set("endpointsHealthUpdateHandler:Injected",a);return{endpointsHealthHandler:i,endpointsHealthHandlerStateMachine:new GF(n,o,"endpointsHealthUpdateHandler:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:EF.k.endpointHealth,component:"CreateWorkerStateAndRequestHandlers"}},"endpointsHealth")}};const ZF=e=>({loaded:e.hasReachedCheckpoint("loaded")?1:0,healthCheck:e.hasReachedCheckpoint("health_checked")?1:0,syncEngine:e.hasReachedCheckpoint("syncEngine:Initialized")?1:e.hasReachedCheckpoint("syncEngine:FailedToInitialize")?2:0,authLoaded:e.hasReachedCheckpoint("authLoaded")?1:0}),eD=120*Nr.gT.MILLI_PER_SECOND,tD="CDLWorkerManager";function nD(e,t,i,a,o,r,s,l,c,d,u,m,g){var p;let v;const h=function(){const e=new Map;return e.set(EF.k.appState,DF),e.set(EF.k.control,NF.Q),e.set(EF.k.database,NF.Q),e.set(EF.k.diagnostics,NF.Q),e.set(EF.k.endpointHealth,NF.Q),e.set(EF.k.graphql,xF),e.set(EF.k.networkState,NF.Q),e.set(EF.k.syncEngine,NF.Q),e.set(EF.k.supportedResolvers,NF.Q),e.set(EF.k.telemetry,NF.Q),e}();return null===(p=e.workerCacheManager)||void 0===p||p.saveWorkerStatusToCacheStorage({state:"InProgress",stepName:"CreateCDLWorker"}),v=i?function(e,t,i,a,o,r,s,l,c,d,u,m,g,p){var v,h;if(c){wF(e.logger,c,!0,e.hostRendererId,tD);const n=null===(h=null===(v=null==g?void 0:g.loader)||void 0===v?void 0:v.getSharedWorker)||void 0===h?void 0:h.call(v),d=n||new SharedWorker(c);return iD(e,a,o,l,t,i,(e=>d.port.postMessage(e)),(e=>{d.port.onmessage=t=>e(t,(e=>d.port.postMessage(e)))}),(e=>{d.onerror=t=>e(t)}),"shared-worker",r,s,m,p,null==u?void 0:u.workerId)}const f=bF(null==u?void 0:u.experienceName,null==u?void 0:u.ring,null==u?void 0:u.environment,null==u?void 0:u.sessionId,null==u?void 0:u.platformId,null==u?void 0:u.buildVersion,null==u?void 0:u.localeCode,null==u?void 0:u.workerId,void 0,null==u?void 0:u.preECSConsoleLogLevel,null==u?void 0:u.userConsoleLogLevel,null==u?void 0:u.publicPath),y=SharedWorker;SharedWorker=kF(y,e.logger,tD,f,d);const b=new SharedWorker(n.tu(new URL("/multi-window/worker/"+n.u(272346),n.b)));return SharedWorker=y,iD(e,a,o,l,t,i,(e=>b.port.postMessage(e)),(e=>{b.port.onmessage=t=>e(t,(e=>b.port.postMessage(e)))}),(e=>{b.onerror=t=>e(t)}),"shared-worker",r,s,m,p,null==u?void 0:u.workerId)}(e,t,h,a,o,r,s,l,c&&c.cdlSharedWorkerUrl,(e=>{c&&(c.cdlSharedWorkerUrl=e)}),d,u,m):function(e,t,i,a,o,r,s,l,c,d,u,m,g,p){var v,h;if(c){wF(e.logger,c,!0,e.hostRendererId,tD);const n=null===(h=null===(v=null==g?void 0:g.loader)||void 0===v?void 0:v.getWorker)||void 0===h?void 0:h.call(v),d=n||new Worker(c);return iD(e,a,o,l,t,i,(e=>d.postMessage(e)),(e=>{d.onmessage=t=>e(t,(e=>d.postMessage(e)))}),(e=>{d.onerror=t=>e(t)}),"web-worker",r,s,m,p,null==u?void 0:u.workerId)}const f=bF(null==u?void 0:u.experienceName,null==u?void 0:u.ring,null==u?void 0:u.environment,null==u?void 0:u.sessionId,null==u?void 0:u.platformId,null==u?void 0:u.buildVersion,null==u?void 0:u.localeCode,null==u?void 0:u.workerId,null==u?void 0:u.preAuthUserId,null==u?void 0:u.preECSConsoleLogLevel,null==u?void 0:u.userConsoleLogLevel,null==u?void 0:u.publicPath),y=Worker;Worker=kF(y,e.logger,tD,f,d);const b=new Worker(n.tu(new URL("/multi-window/worker/"+n.u(377294),n.b)));return Worker=y,iD(e,a,o,l,t,i,(e=>b.postMessage(e)),(e=>{b.onmessage=t=>e(t,(e=>b.postMessage(e)))}),(e=>{b.onerror=t=>e(t)}),"web-worker",r,s,m,p,null==u?void 0:u.workerId)}(e,t,h,a,o,r,s,l,c&&c.cdlWebWorkerUrl,(e=>{c&&(c.cdlWebWorkerUrl=e)}),d,u,m,g),v}function iD(e,t,n,a,o,r,s,l,c,d,u,m,g,p,v="default"){return new Promise(((h,f)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const y={hostRendererId:o,component:"CDLWorker"},b=new TF.q({bootstrapServices:e,loggingContext:y});b.setState("bootstrapped"),null==g||g.mark(it.ck.CdlWorkerBootstrapped);const S=(0,IF.U)(e,{postMessageCallback:e=>s(e),clients:r},{globalState:b,requestAndStateHandlers:JF(e,o,v,b)},o);S.workerServer.start(),l(((e,t)=>S.onMessageCallback(e,t,-1))),c((t=>{f(aD(t,e,y,"workerOnError",m,k.state))}));const k={workerServer:S.workerServer,workerClientResponseRouter:S.workerClientResponseRouter,state:b,workerType:d,syncEngineInitializationPromise:u};k.state.setState("loaded");try{yield function(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=t.workerClientResponseRouter.cdlControlClient.sendRequest({type:"health_check",bootstrapData:a,initiatorExperience:n});let r;r=o?(yield i).response:(yield(0,Fn.E)(i,e)).response,t.cdlWorkerSessionId=r.cdlWorkerSessionId,t.cdlWorkerSupportedResolvers=r.cdlWorkerSupportedResolvers,t.state.setState("health_checked")}))}(t||eD,k,n,a,p)}catch(t){f(aD(t,e,y,"healthCheckException",m,k.state))}h(k)}))))}function aD(e,{logger:t,workerCacheManager:n},i,a,o,r){const s=((e,t)=>{if(e.hasOwnProperty("code")){const t=e;if(t.code!==he.jK.Unknown)return t.code}return t.hasReachedCheckpoint("loaded")?t.hasReachedCheckpoint("syncEngine:FailedToInitialize")?he.jK.NotInitialized:t.hasReachedCheckpoint("health_checked")&&t.hasReachedCheckpoint("syncEngine:Initialized")?he.jK.UnhandledRuntimeException:he.jK.TimedOut:he.jK.ScriptLoadError})(e,r),l=(e=>{const t=ZF(e);return`LD${t.loaded}:HC${t.healthCheck}:SE${t.syncEngine}:AL${t.authLoaded}`})(r),c=`err: ${(0,An.VK)(e.error)};message: ${(0,An.VK)(e.message)}`,d=(0,An.Tr)(he.w5.DataLayerClient,s,c,void 0,`Uncaught ${a} in Worker: ${(0,An.VK)(e.message)} Auth: ${o} WorkerState: ${l}`),u=`CDL Worker OnError for ${a}::Auth${o}::workerState:${l}::${(e=>e&&e.message&&e.message.includes("AsyncIterableObserver buffer is full")?"AsyncIterableBufferOverflow":"Unknown")(e)}`;return t.errorToTelemetry?t.errorToTelemetry(u,"cdl_worker_startup_error",(e=>{const t=ZF(e);return{"WorkerStartupState.Loaded":1===t.loaded,"WorkerStartupState.HealthCheck":1===t.healthCheck,"WorkerStartupState.SyncEngine":t.syncEngine,"WorkerStartupState.AuthLoaded":1===t.authLoaded}})(r),!0):t.error(u,i,s),null==n||n.saveWorkerStatusToCacheStorage({state:"Failure",stepName:"CDLWorkerOnError",error:c}),d}var oD=n(524841),rD=n(559127),sD=n(402527),lD=n(337790),cD=n(648297),dD=n(693541);const uD=(0,lD.p)(cD.A),mD=()=>{let e;return(t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(void 0===e){const i=yield gD(t,n,a);return e=i,i}return e}))},gD=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a,o,r,s;if(!e)return t.log("WebWorkerURL is undefined",n),!0;let l;null===(i=t.infoToTelemetry)||void 0===i||i.call(t,"Pinging PDS / ServiceWorker to verify if worker script is up","cdl_worker_startup_error_verify_worker_script",{endpointUrl:e});const c=new Date,d=performance.now();try{l=yield uD({url:e,method:"HEAD"})}catch(e){return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,e.toString(),"cdl_worker_startup_error_verify_worker_script",{statusCode:-1},!0),!1}const u=performance.now()-d;if(null===(o=t.infoToTelemetry)||void 0===o||o.call(t,"Finished pinging PDS / ServiceWorker","cdl_worker_startup_error_verify_worker_script",{totalRequestTime:u,statusCode:l.status,size:Number(l.headers["content-length"]||-1),correlationId:l.headers["x-msedge-ref"],callId:l.headers["x-ms-request-id"],contentType:l.headers["x-cache"]}),t.log(`precompiled-web-worker header x-msedge-ref: ${l.headers["x-msedge-ref"]}`,n),function(e,t){const n="Ref C: ";if(!e)return!0;let i;if(!(i=e.indexOf(n)))return!0;const a=e.slice(i+n.length),o=new Date(a);if(!(0,dD.q)(o))return!0;return t.getTime()<o.getTime()}(l.headers["x-msedge-ref"],c)||t.log("Request is likely served from service worker, since PDS response time is before the request time",n),l.status!==oA.qb.OK)return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,`PDS returned ${l.status} for worker script`,"cdl_worker_startup_error_verify_worker_script",void 0,!0),!1;return!l.headers["content-length"]||Number(l.headers["content-length"])<1e3?(null===(s=t.errorToTelemetry)||void 0===s||s.call(t,`PDS returned smaller than expected worker script, of size ${l.headers["content-length"]}`,"cdl_worker_startup_error_verify_worker_script",void 0,!0),!1):(t.log("Worker script fetched successfully.",n),!0)}));const pD=(e,t,n,a,o,r,s,l,c,d,u,m,g,p,v,h)=>new Promise(((f,y)=>{const b=performance.now();let S=null==g?void 0:g.workerStartupScenario,k=null==g?void 0:g.workerStartupScenarioTimeout;const w=vD(t);if(!S){const e=hD(n.newScenario,r,w,n.workerCacheManager,u,m,v,n.logger);S=e.workerStartupScenario,k=e.workerStartupScenarioTimeout}S.appendEventData({origin:s});const C=S;u&&n.logger.log(`Initializing worker manager from renderer with host: ${u.location.host} protocol: ${u.location.protocol} port: ${u.location.port}`,{hostRendererId:e,component:"CDLWorkerManager"});const _=mD();let T;p||(T=null==u?void 0:u.setTimeout((()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=bD(e);if(!(yield _(w?null==a?void 0:a.cdlSharedWorkerUrl:null==a?void 0:a.cdlWebWorkerUrl,n.logger,t))){const t=(0,An.Tr)("CDL worker script load error",he.jK.ScriptLoadError,"cdl_worker_startup_error_script_load_error"),i=yield yD(t,n,e,C,w,a,_,!1,!!p);y(i)}}))),4e4)),function(e,t,n,a,o,r,s,l,c,d,u,m,g,p,v,h,f,y){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let b=!1;v&&t.logger.log(`Initializing worker manager from renderer with host: ${v.location.host} protocol: ${v.location.protocol} port: ${v.location.port}`,{hostRendererId:e,component:"CDLWorkerManager"});try{const u=(0,ci.P)();d.appendEventData({newState:"beforeCreateCDLWorker"});const f=yield nD(t,e,r,a,o,u.promise,h?h.getState():SA.j.Up,m,n,g,void 0,v,y).finally((()=>{var e,t,n;null===(e=null==v?void 0:v.clearTimeout)||void 0===e||e.call(v,c),null==v||v.clearTimeout(l),null===(n=null===(t=null==v?void 0:v.loader)||void 0===t?void 0:t.clearWorker)||void 0===n||n.call(t)}));return b=!0,d.appendEventData({newState:it.ck.CdlWorkerManagerHealthChecked,searchSessionId:f.cdlWorkerSessionId}),f.state.setState("initialized"),SD(d),d.mark("CDLWorkerManagerInitialized"),function(e,t,n,a,o,r,s,l){var c,d,u,m,g,p,v,h,f,y;(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=bD(n);try{const{response:n}=yield e.workerClientResponseRouter.cdlSyncEngineClient.sendRequest({type:"startup_info",subType:"Messaging",params:void 0}),r=n;if(r&&"string"!=typeof r&&"error"===r.type){const e="string"==typeof r.details?r.details:JSON.stringify(r.details);throw t.logger.warn(`Sync engine for Messaging strategy: ${e}`,i),e}null==l||l.appendEventData({messagingSyncEngineStartupMode:r,appLaunchMode:"clean"===r?"cold":"warm",workerResponseTime:performance.now()-s}),o.resolve({isSyncEngineInitialized:!0,bootType:(0,oD.n)(r)}),e.state.setState("syncEngine:Initialized"),SD(a),a.stop({dataSource:r})}catch(n){const s=yield fD(r,t.workerCacheManager),l="Init SyncEngine failed",b=`err: ${(0,An.VK)(n)}`,S=n.code||he.jK.Unknown;null===(d=(c=t.logger).errorToTelemetry)||void 0===d||d.call(c,`${l}:: ${b}`,"cdl_worker_manager_get_messaging_sync_engine_startup_info_error",Object.assign(Object.assign({},(0,rD.n)(i)),{errorCode:S}),!0),null===(m=(u=t.logger).errorToTelemetry)||void 0===m||m.call(u,`${l}:: WSM: ${s}`,"cdl_worker_manager_get_messaging_sync_engine_startup_info_error",Object.assign(Object.assign({},(0,rD.n)(i)),{errorCode:S}),!0),SD(a);const k=`${l}:: WSM: ${s}:: ${b}`,w=(null===(p=null===(g=n.response)||void 0===g?void 0:g.error)||void 0===p?void 0:p.isExpected)||!1,C={errors:k,isAccepted:w,errorCode:S,dataSource:null===(h=null===(v=n.response)||void 0===v?void 0:v.error)||void 0===h?void 0:h.startupMode,reason:null===(y=null===(f=n.response)||void 0===f?void 0:f.error)||void 0===y?void 0:y.message};w?a.cancel(C):a.fail(C),e.state.setState("syncEngine:FailedToInitialize"),o.resolve({isSyncEngineInitialized:!1})}}))}(f,t,e,d,u,r,s,p),f}catch(i){throw yield yD(i,t,e,d,r,n,u,!b,!!f)}}))}(e,n,a,o,s,w,b,T,k,S,_,l,c,d,u,m,p,h).then((e=>f(e))).catch((e=>y(e)))})),vD=e=>"electron"===e||"sharedworker"===e;function hD(e,t,n,i,a,o,r,s){var l;const c=300*sD.kg,d=t||c,u=e(it.RG.CentralDataLayerWorkerManagerStartup,d);let m=!0;(null==r?void 0:r.getUser)&&(m=!1,null==r||r.getUser().then((()=>m=!0)));const g=null===(l=null==a?void 0:a.setTimeout)||void 0===l?void 0:l.call(a,(()=>{m||(null==s||s.warn("Worker startup - getUser is still not available. Cancelling Worker Scenario"),u.cancel({reason:"GetUser"}));(o?o.getState():SA.j.Up)===SA.j.InteractionRequired&&(null==s||s.warn("Worker startup - User is in InteractionRequired state. Cancelling Worker Scenario"),u.cancel({reason:"InteractionRequired"})),fD(n,i).then((e=>{u.appendEventData({errors:e})}))}),d-500);return{workerStartupScenario:u,workerStartupScenarioTimeout:g}}function fD(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=e?"shared-worker":"web-worker";let i="";if(t)try{const e=yield t.getWorkerStartupStatus(n);return"WorkerStartupStatus: "+(e?`lastError: ${JSON.stringify(e.lastError)}:: lastState: ${JSON.stringify(e.lastState)}`:"Unable to get CDL worker startup status")}catch(e){i=`Unable to get CDL worker startup status. Reason: ${(0,An.VK)(e)}`}else i="Unable to get CDL worker startup status. Reason: workerCacheManager is undefined";return i}))}function yD(e,t,n,a,o,r,s,l,c){var d,u,m,g,p;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield fD(o,t.workerCacheManager),v=`Failed to initialize CDL Worker :: err: ${(0,An.VK)(e)}`,h=`${v} :: ${i}`,f=bD(n);let y={errors:h,errorCode:t.workerCacheManager?e.code:he.jK.NotInitialized};if(l&&!c)try{(yield s(o?null==r?void 0:r.cdlSharedWorkerUrl:null==r?void 0:r.cdlWebWorkerUrl,t.logger,f))||(e.code=he.jK.ScriptLoadError,y={errors:"CDL Worker Script load error",errorCode:he.jK.ScriptLoadError})}catch(t){e.code=he.jK.ScriptLoadError,y={errors:`CDL Worker Script load error :: ${t.message}`,errorCode:he.jK.ScriptLoadError}}const b=(0,An.Tr)("CDLWorkerManager",e.code,JSON.stringify(f),void 0,h);return null===(u=(d=t.logger).errorToTelemetry)||void 0===u||u.call(d,v,"cdl_worker_manager_handle_initialize_worker_manager_failure_error",Object.assign(Object.assign({},(0,rD.n)(f)),{errorCode:b.code}),!0),null===(g=(m=t.logger).errorToTelemetry)||void 0===g||g.call(m,i,"cdl_worker_manager_handle_initialize_worker_manager_failure_error",Object.assign(Object.assign({},(0,rD.n)(f)),{errorCode:b.code}),!0),SD(a),e&&e.code===he.jK.TimedOut?a.stop(y,"timeout"):a.fail(y),null===(p=t.workerCacheManager)||void 0===p||p.saveWorkerStatusToCacheStorage({state:"Failure",stepName:"CreateCDLWorker",error:h}),b}))}function bD(e){return{hostRendererId:e,component:"CDLWorkerManager"}}function SD(e){e.appendEventData({"Thread.Id":"",threadId:""})}var kD=n(766088);function wD(e,t,n,o,r,s,l,c,d,u,m,g,p,v,h,f){var y,b,S,k,w,C,_,T,I,E;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{workerStartScenarioTimeoutInMs:N}=s.get(L.J.CdlWorker),A=(e,t,n)=>r.newScenario(e,{callback:n,timeoutMs:t}),F=(0,kD.L)(t.experienceName,o.newLogger("CDL:DataClientCoreWorkerManager","core-services-cdl-worker"),r),D=_D(d,s),R=hD(A,N,vD(D),F,e,g,l,u),x=(null===(y=e.loader)||void 0===y?void 0:y.getCdlSharedWorkerUrl)?null===(b=e.loader)||void 0===b?void 0:b.getCdlSharedWorkerUrl():TD(s,e,r,u),M=(null===(S=e.loader)||void 0===S?void 0:S.getCdlWorkerUrl)?null===(k=e.loader)||void 0===k?void 0:k.getCdlWorkerUrl():void 0,O=CD(d,s,r,e,u);R.workerStartupScenario.appendEventData({contentType:O.toString(),newState:"beforeBootstrapData"}),function(e,t,n,i){i.log(`Initializing workerType ${e} ${t?"as Worker host":`as non-Worker host with sharedWorkerUrl ${n}`}`)}(D,O,x,u);try{let r;O&&(r=yield function(e,t,n,a,o,r,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){r.appendEventData({newState:"beforeAuthBootstrapData"});const l=yield function(e,t,n,a,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;o.appendEventData({newState:"beforeAuthUserData"});const s=1e4,l=r.get(L.J.CdlWorker).timeToGetUserFromAuthMs||s;try{i=yield(0,Fn.E)(e.getUser(),l)}catch(e){n.error(`Worker bootstrap authentication error - cannot authenticationService.getUser: ${null==e?void 0:e.code}`)}if(!i)return{};let c;o.appendEventData({newState:"beforeDiscoverUserData"});try{c=yield(0,Fn.E)(t.getUser(),l)}catch(e){n.error(`Worker bootstrap authentication error - cannot discover.getUser: ${null==e?void 0:e.code}`)}if(!c)return{userInformation:i};const d=null==c?void 0:c.id;return{userInformation:i,userDetails:{userDetails:{licenseDetails:c,id:d},id:d},authState:(null==a?void 0:a.getState())||SA.j.Up}}))}(e,t,n,a,r,s);return{hostSettings:o.hostSettings,auth:l}}))}(l,c,u,g,n,R.workerStartupScenario,s)),R.workerStartupScenario.appendEventData({newState:"beforeInitializeWorkerManagerFromDataClientCore"});const y=yield function(e,t,n,o,r,s,l,c,d,u,m,g,p,v,h,f,y,b,S){var k,w;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{ring:i,environment:C}=m.get(L.J.Metadata),{sessionId:_}=m.get(L.J.Platform),{enablePassingPlatformIdInWorkerUrlHash:T}=m.get(L.J.Core),{workerStartTimeoutInMs:I,workerStartScenarioTimeoutInMs:E,disablePingingPDSIfWorkerStartupFails:N,shouldDisableHealthCheckTimeout:A}=m.get(L.J.CdlWorker),F=C?(0,a.get)(s_.s,C):void 0;return f.workerStartupScenario.appendEventData({newState:"beforeInitializeWorkerManager"}),pD(e,t,{logger:new yF.V(c.newLogger("CDL:DataClientCoreWorkerManager","core-services-cdl-worker")),newScenario:h,offlineCacheManager:l,workerCacheManager:u,hostRendererId:e},{cdlSharedWorkerUrl:n||"",cdlWebWorkerUrl:o||""},I||void 0,E||void 0,r,s,{experienceName:r,ring:(null==i?void 0:i.id)||void 0,environment:F,platformId:T?d.config.platformId:void 0,sessionId:_||void 0,buildVersion:d.config.buildVersion,localeCode:y,workerId:v,publicPath:g.__webpack_public_path__,preECSConsoleLogLevel:null===(k=g.defaultConsoleLogLevel)||void 0===k?void 0:k.preECSConsoleLogLevel,userConsoleLogLevel:null===(w=g.defaultConsoleLogLevel)||void 0===w?void 0:w.userConsoleLogLevel},b,g,p,f,!!N,S,!!A)}))}(t.clientId,D,x,M,t.experienceName,r,m,o,d,F,s,e,g,v,A,R,h,f,l);return!!(null===(w=null==s?void 0:s.get(L.J.CdlWorker))||void 0===w?void 0:w.enableUserContextWorkerRegistration)&&(v&&(null===(C=null==r?void 0:r.auth.userDetails)||void 0===C?void 0:C.id)?p.mapUserIdToRegisteredWorker(v,r.auth.userDetails.id):null===(_=u.errorToTelemetry)||void 0===_||_.call(u,`Unable to register worker '${v}' to user through worker registrar for userId '${null===(T=null==r?void 0:r.auth.userDetails)||void 0===T?void 0:T.id}'`,"cdl_worker_init_register_user_context",{origin:v,userId:null===(I=null==r?void 0:r.auth.userDetails)||void 0===I?void 0:I.id},!0)),y}catch(e){return void(null===(E=u.errorToTelemetry)||void 0===E||E.call(u,`Failed to start CDL Worker from DataClientCore: ${(0,An.VK)(e)}`,"cdl_services_worker_worker_service_start_client_core_cdl_worker_error",void 0,!0))}}))}const CD=(e,t,n,i,a)=>{const o=_D(e,t),r=TD(t,i,n,a);return"webworker"===o||"web"===o||!r};function _D(e,t){let n=e.config.clientType===Pe.Bh.Web?"webworker":"sharedworker";const i=t.get(L.J.Host).cdlWorkerType,a=t.get(L.J.CdlWorker).cdlWorkerType;return i?n=i:a&&(n=a),n}function TD(e,t,n,i){var a;let{cdlSharedWorkerUrl:o}=e.get(L.J.Host);const r=t.localStorage.getItem("ts.cdlSharedWorkerJsUrl");if(o&&r&&o!==r){null===(a=i.errorToTelemetry)||void 0===a||a.call(i,`Worker URL saved in TSW:${o} is different from worker url in TMP:${r}`,"cdl_services_worker_worker_service_get_cdl_shared_worker_url_error",void 0,!0);n.newScenario(it.RG.HostSettingsSync).fail({reason:JSON.stringify({cdlSharedWorkerUrl:o,storedWorkerUrl:r})}),o=r}return o}var ID=n(119824);class ED extends fe{constructor(){super(he.Yg.CreateCDLWorkerAppServiceTask,["windowProvider","scenarioFactory","coreSettings","platformService","loggerFactory","cdlWorkerService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,ID.Q6)(e.coreSettings),n=!!e.coreSettings.get(L.J.CdlWorker).enableCdlAppStateService;if(!t||!n)return Promise.resolve();const i=new fF(e);return e.cdlAppStateService=i,function(e,t,n,i,a,o,r){CD(i,n,t,e,a)&&o.getCDLWorkerManager().then((e=>{null==e||e.state.setState("appService:Loaded",r)}))}(e.windowProvider,e.scenarioFactory,e.coreSettings,e.platformService,e.loggerFactory.newLogger("CDLWorkerManager","core-services-tasks"),e.cdlWorkerService,i)}))}}class ND extends fe{constructor(){super(he.Yg.CreateCDLWorkerAuthTask,["cdlWorkerRegistrarService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,ID.Q6)(e.coreSettings),{cdlWorkerService:n,cdlWorkerRegistrarService:a}=e;if(t&&n){!function(e,t,n,i,a,o,r,s,l,c){CD(o,n,t,e,r)&&s.getCDLWorkerManager().then((e=>{null==e||e.state.setState("authLoaded",{authenticationService:i,discover:a,authStateProvider:c,cdlWorkerRegistrarService:l})}))}(e.windowProvider,e.scenarioFactory,e.coreSettings,e.authenticationService,e.discover,e.platformService,e.loggerFactory.newLogger("CDLWorkerManager","core-services-tasks"),n,a,e.authStateProvider);if(!e.coreSettings.get(L.J.CdlWorker).enableCleanUpOnLogout)return;return t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(t){case"signout":yield n.logoutCurrentUser(e.coreSettings);break;default:return}}))}}))}}class AD{constructor(e,t,n,i){this.cdlWorkerService=i,this._logger=n.newLogger("CDLWorkerStateSender","core-services-cdl-worker"),this._clientStateSubscription=e.observe().subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:UF.NotifyCoreClientState,context:{appState:e}}))),this._machineLockStateSubscription=t.observe().pipe((0,qN.x)(((e,t)=>e.machineLockState===t.machineLockState))).subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:UF.NotifyCoreMachineState,context:{appState:e.machineLockState}}))),this._suspendedStateSubscription=t.observe().pipe((0,qN.x)(((e,t)=>e.suspendedState===t.suspendedState))).subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:UF.NotifyCoreSuspendedState,context:{appState:e.suspendedState}})))}dispose(){this._clientStateSubscription&&(this._clientStateSubscription.unsubscribe(),this._clientStateSubscription=void 0),this._machineLockStateSubscription&&(this._machineLockStateSubscription.unsubscribe(),this._machineLockStateSubscription=void 0),this._suspendedStateSubscription&&(this._suspendedStateSubscription.unsubscribe(),this._suspendedStateSubscription=void 0)}sendAppStateChangeToWorker(e){var t,n,a,o,r,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,wi.u4)(e);let l;try{l=yield this.getCdlAppStateClient()}catch(e){return void(null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,`Failed to send app state change ${i} to CDL. Reason: failed to obtain a CDLAppStateClient. See initialization failures earlier in the logs.`,"cdl_services_worker_worker_state_sender_send_app_state_get_client_error",void 0,!0))}if(l){this._logger.log(`Alerting CDL Worker of host state change: ${i}`);try{yield l.sendFilteredAppStateRequest(e)}catch(e){null===(s=(r=this._logger).errorToTelemetry)||void 0===s||s.call(r,`Failed to send app state change ${i} to CDL. Reason: ${(0,wi.u4)(e)}`,"cdl_services_worker_worker_state_sender_send_app_state_send_request_error",void 0,!0)}}else null===(o=(a=this._logger).errorToTelemetry)||void 0===o||o.call(a,`Failed to send app state change ${i} to CDL. Reason: CDLAppStateClient does not exist. See initialization failures earlier in the logs.`,"cdl_services_worker_worker_state_sender_send_app_state_get_client_undefined_error",void 0,!0)}))}getCdlAppStateClient(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.cdlWorkerService.getCDLWorkerManager();return null==e?void 0:e.workerClientResponseRouter.cdlAppStateClient}))}}class FD extends RF{constructor(e,t){super(),this.workerClientResponseRouter=e,this.logger=t.loggerFactory.newLogger("CDLControlPlaneCommunicator","cdl-control-plane-communicator")}sendMessage(e){this.getRequestForOperationName(e).then((t=>this.handleResponse(e.rendererId,e.requestId,this.extractPerfStats(t)))).catch((t=>this.handleResponse(e.rendererId,e.requestId,void 0,(0,wi.u4)(t)||"Unknown Error")))}getRequestForOperationName(e){const t=e.operationName;if(!t)return Promise.reject(`Request could not be sent: operationName unavailable. RequestId: ${e.requestId}.`);switch(this.logger.log(`Converting GQL operation ${t} to CDL Worker control plane message.`),t){case"notifyWorkerSyncCanStart":return this.workerClientResponseRouter.cdlControlClient.sendRequest({type:"sync_can_start"});case"AppsChatNotifyActiveContextChangedMutation":const t=e.request.variables;return this.workerClientResponseRouter.cdlControlClient.sendRequest({type:"active_context_changed",activeContextChangedData:{activeContextId:t.activeContextId,activeContextType:t.activeContextType}})}}handleResponse(e,t,n,i){return Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e,requestId:t,data:!i,errors:i,extensions:{perfStats:n}}}}))}extractPerfStats(e){return{workerResponseTime:e.workerResponseTime||0,dataStorePerfStats:[]}}}var DD=n(850032),RD=n(397987);const xD={activity:["activityCustomizations","enableActivityAppCommandResultHook","enableActivityDotBadge","enableActivityFeedItemDeletion","enableCommunitiesFeedItems","enableMTMAMissedNotificationsDotBadge","enableMTMANotificationsUnseenBehavior","enableUnreadToggle","enableVoicemailFeedItems","enabledCommunitiesActivities"],activityNotification:["notificationFeedSettingsNoiseThreshold"],ageConsent:["ageGroup"],auth:["allowCdlWorkerToUpdateSetting","disableSTMFallback","disableSkypeTokenOnCsa","disableSkypeTokenToMtInGtm","enableCachedUser","enableConsumingSTMFallbackmap","enableMTO","enableRegionAndSTMHeadersOnCsa","enableSkypeTokenMigrationForMT","enableSkypeTokenMigrationForTrouter","sendMigrationHeaderToMtInGtm","skypeTokenMigrationEnabled","skypeTokenMigrationServiceInfo","stmSourceList"],autosuggest:["enableDomainScopingV1","enableExternalSearchSuggestions","enableSubstrateInstrumentation"],calendar:["enableCalendarInviteRouting"],calling:["allowNonE164Mri","allowPrivateCallingPolicy","dialPlanPolicy","enableCallHistoryExternalTagging","enableCallsAppPhaseStateMachine","enableCapiV3Contacts","enableDialPlans","enableFixForDtmfTone","enableFormattingFixForExtension","enableMeetingStartedNotificationV2","enableNewCallsBadging","enableNovaSpeedDial","enablePstnWithExtnFix","enableSLABossTabsForMW","enableUpdatedGetVoicemailsPath","sharedVoicemailServiceSettings","voicemailServiceSettings"],cdlWorker:["enableMTMAUserDataInMaglevStorage"],chatList:["disablePinnedChatsInUserPreferences","enableShowMissedActivitiesInChatList"],communities:["enableCommunitiesApp","enableCommunitiesCreate","enableCommunitiesDetailedBadgeCount","enableCommunitiesJoinFlyout","enableMemberThreadDetailsSync","showTextScanDeletedPost"],compose:["enableDesignerInChannelAnnouncementPost","enableSendPostAsEmail"],core:["coreColdBootAppId","enable1JSGraphqlSearchBox","enableCommunitiesBadgeCount","enableLocaleFilterForFeatureFlags","enablePersonalFlyoutSearch","enablePersonalFlyoutSuggestions","enablePlatformAppsBadgeCount","enablePoliciesPushUpdates","searchBoxSuggestions"],diagnostics:["clientExtendedDiagnosticsData","consoleLogLevel","diagnosticsLogsThrottling","disableExtendedDiagnosticsDataToggle","enableWorkerStoreDiagnosticsLogsInIDB","logReporterSendCountInterval","logReporterSendErrorCountInterval","logReporterSendTimeInterval","loggerReportCountInterval","loggerReportTimeInterval","loggerThrottleList","logsMarkInterval","savingLogsIntoIDBThrottleTime","throttleCapacity","throttleWindowSizeMs","workerDiagnosticsLogBufferArraySize","workerDiagnosticsLogsIDBObjectCount"],edu:["enableAssignmentsApp"],extensibility:["botDynamicCommandDebounceMaxWaitMs","botDynamicCommandDebounceMs","botDynamicCommandsSyncStrategyRefreshIntervalInMs","disableMessageExtensionsInMeeting","disabledTabAppIds","enableBotDynamicCommandsSyncEngine","enableBotSsoV2","enableFilterPinnedAppsBasedOnPolicy","enableMessageExtensionInTFLCommunities","enableReactTaskModuleForBIM","workflowApp"],flyout:["enableOverflowMenuInFlyout"],homepage:["enableTflHomepage"],meet:["disableThumbnailFromMCO","disableUpcomingPagination","enableFetchUserProfilesInBatch","enableMCUMeetAppScenario","enableMeetForWork","enableMeetForWorkCDL","enableMeetForWorkRecentRefreshStrategy","enableMockCalendarFetchError","enableMockMCOFetchError","enableMockMCUFetchError","enableMockMREFetchError","enableNativeMeetApp","graphqlBaseUrl","insightsProviderVersion","mcuFlights","meetForWorkCDLSettings","substrateBaseUrl"],meetingArtifacts:["allowEngagementReportPolicy","enableBypassingEngagementReportPolicy","enableHidingOneOnOneMeetingAttendanceReportEntrances"],messaging:["commCopilotSummarizationRequestConfig","enableConsumerConversations","enableOnDemandTranslation","msgEnableSfbCloudFromBVD"],metadata:["region"],people:["allowScopedPeopleSearchandAccess","enableLPCOneGQLPerson","enableLPCPhotoViaOneGQLPerson","enableLokiContactModifiedOnPersonMutation","enableTaglessNameForAnonConsumerUser"],peopleTargeting:["customTagMode","disallowedSources","enableScheduledTags","enableTagsInPrivateChannels","ownersCanOverwriteTagSettings","suggestedTags","tagPermissions"],phonelinkSms:["enablePhonelinkSms","phonelinkSmsDCGEndpoint","phonelinkSmsDCGResource"],platform:["deviceInfo"],sync:["messageSyncColdBootMaxCallCount"],teamsAndChannels:["enableAutoFavoriteChannel","enableReactJoinTeamsGallery","enableRecommendedTeamsSync","enableT2ChannelsAtMentionBadging","enableT2ChannelsBadgingAppBar","enableUserResolutionForChannelModeratorList","recommendedTeamsCacheIntervalInHours"],test:["testAutomation"],userResources:["isSfbCloud","isSfbCloudInBVD","isSipEnabled","isSipEnabledInBVD"],whatsNew:["chatViaSms","communitiesBeta","communitiesCreate","contactsSync","designerInChannelAnnouncementPost","enableEntryPointPromotions","enableWhatsNew","flyoutInlineChat","flyoutV2","maxFeaturesInOverlayCount","maxValidFromDaysToBeShown","mobileDownloadQrPromo","onDemandTranslations","phonelinkSms","polls","sendPostAsEmail","togetherEmojisHighFive"],windowsSignatureExperiences:["enableHighFiveTogetherEmojis"]};class MD{constructor(e,t,n,i,a,o,r){this.configLoader=e,this.coreSettings=t,this.coreSettingsContext=n,this.platformService=a,this.primaryUser=o,this.locale=r,this._settings={},this.cdlWorkerSettingsAllowlist=xD,this.logger=i.newLogger("CDLWorkerHostSettingsAggregator","core-services-cdl-worker")}get hostSettings(){return 0===Object.keys(this._settings).length&&(this._settings=this.getAllWorkerSettings()),this._settings}startNotifyingCDLWorkerForHostSettingsChanges(e){const{disableNotifyingCdlWorkerFirstForSettingsChanges:t}=this.coreSettings.get(L.J.Core);if(t){let t=[L.J.Activity,L.J.Auth,L.J.Calendar,L.J.CdlWorker,L.J.Channels,L.J.Communities,L.J.Core,L.J.CsaService,L.J.Diagnostics,L.J.DiscoverSurface,L.J.Esp,L.J.Extensibility,L.J.ExternalAccounts,L.J.Files,L.J.Flyout,L.J.Guardians,L.J.Host,L.J.Meet,L.J.MeetingArtifacts,L.J.Messaging,L.J.Metadata,L.J.People,L.J.PeopleTargeting,L.J.Platform,L.J.Presence,L.J.TeamsAndChannels,L.J.WhatsNew,L.J.WindowsSignatureExperiences];t=t.concat(Object.keys(this.cdlWorkerSettingsAllowlist)),t=[...new Set(t)];const n=t.map((e=>this.coreSettings.getObservable(e))),i=(0,vF.T)(...n);this.settingsChangedSubscription=i.subscribe((t=>{this.notifyCDLWorkerForSettingsChanges(e)}))}else{const t=this.coreSettings.getObservableForAnySettingsChangeForCdlWorker();this.settingsChangedSubscription=t.subscribe((()=>{this.notifyCDLWorkerForSettingsChanges(e)}))}}cleanup(){var e;null===(e=this.settingsChangedSubscription)||void 0===e||e.unsubscribe(),this.settingsChangedSubscription=void 0}notifyCDLWorkerForSettingsChanges(e){const t=this.getAllWorkerSettings();(0,a.isEqual)(this._settings,t)||(this._settings=t,this.logger.log("Notifying CDL Worker of host settings changes: ",t),e.sendRequest({type:"host_settings_updated",hostSettings:t}))}getAllWorkerSettings(){const e=this.getCdlWorkerSettings(this.coreSettings);return Object.assign(Object.assign({},e),{[L.J.Host]:(0,a.mergeWith)(e.host||{},this.aggregateHostSettings(),RD.g)})}aggregateHostSettings(){var e;this.logger.debug("aggregateHostSettings called...");const{enableNetworkStateCommsBetweenCoreAndWorker:t,enableMTMA:n}=this.coreSettings.get(L.J.Core),{electronVersion:i,enableHybridChannelList:a=!1,msgEnableChannelsV2:o=!1,msgEnableChannelsV2Header:r=!1,msgEnableSelfChat:s=!1,userType:l="",windowsInsiderChannel:c}=this.coreSettings.get(L.J.Host),d=this.coreSettingsContext,{enableTPSSyncStrategy:u,enableTPSUpdatesOverTrouter:m,tpsSyncStrategyPollingIntervalMs:g,enablePinnedChannelUpdatesOverTPS:p}=this.coreSettings.get(L.J.CdlWorker);let v=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({enableNetworkStateCommsBetweenCoreAndWorker:!!t,enableMTMA:!!n,policiesNamespaces:this.configLoader("policies").namespaces||[],enableSyncEngine:(0,ID.Q6)(this.coreSettings),enableProfileManagerStore:(0,ID.bE)(this.coreSettings),enableMessagingNotificationsOverTrouter:this.isMessagingNotificationsOverTrouterEnabled(),imageCookieAuthEnabled:!this.coreSettings.get(L.J.Auth).skipAmsAuthRequest,msgEnableChannelsV2:o,msgEnableChannelsV2Header:r,msgEnableSelfChat:s,enableHybridChannelList:a,enableEspInWorker:!!this.coreSettings.get(L.J.Esp).enableEsp,espIrisExperimentFlightIds:this.coreSettings.get(L.J.Esp).espIrisExperimentFlightIds,espIrisPlacementId:this.coreSettings.get(L.J.Esp).espIrisPlacementId,ecsHostUrl:this.platformService.ecsOverrides.hostUrl,desktopVersion:this.platformService.host.hostAppVersion,initialWorkerHostLocationUrl:this.platformService.config.currentUrl,serviceSwitcherSelectedServiceId:d.getServiceSwitcherApiKey(),electronVersion:i,locale:this.locale||he.ZW,userType:l,windowsInsiderChannel:c,enableTPSSyncStrategy:!!u,enableTPSUpdatesOverTrouter:!!m,enablePinnedChannelUpdatesOverTPS:!!p,tpsSyncStrategyPollingIntervalMs:g},this.getCdlWorkerHostSettings(this.coreSettings)),this.getActivityHostSettings(this.coreSettings)),this.getActivityNotificationHostSettings(this.coreSettings)),this.getEndpointsHealthHostSettings(this.coreSettings)),this.getPeopleHostSettings(this.coreSettings)),this.getMessagingHostSettings(this.coreSettings)),this.getTeamsAndChannelsHostSettings(this.coreSettings)),this.getCalendarHostSettings(this.coreSettings)),this.getExternalAccountHostSettings(this.coreSettings)),this.getPresenceHostSettings(this.coreSettings)),this.getDataStoreHostSettings(this.coreSettings)),this.getFilesHostSettings(this.coreSettings)),this.getAuthHostSettings(this.coreSettings)),this.getDiscoverSurfaceHostSettings(this.coreSettings)),this.getMtmaSpecificHostSettings()),this.getGuardiansHostSettings(this.coreSettings)),h=this.getCoreSettingsTestOverrides(this.coreSettingsContext);const{isRunningGlassjar:f}=this.coreSettings.get(L.J.Test);if(this.platformService.config.isInCypressFrame||f){const t={authOverrides:{authzEndpointUrl:this.coreSettings.get(L.J.Auth).authzEndpointUrl},csaOverrides:{csaHostUrl:null===(e=this.coreSettings.get(L.J.CsaService).apiConstants)||void 0===e?void 0:e.host}};v=Object.assign(Object.assign({},v),t),h={localStorageTestOverrides:Object.assign(Object.assign({},h.localStorageTestOverrides),{test:{}}),qspTestOverrides:h.qspTestOverrides}}return Object.assign(Object.assign({},v),h)}getCdlWorkerSettings(e){var t;const n=this.getAllowlistedCdlWorkerSettings(),i={[L.J.Messaging]:{allowUserChat:this.getAllowUserChat(e)},[L.J.Calling]:{callGroupMembershipSettings:null===(t=this.coreSettings.get(L.J.Calling).voiceAdminSettings)||void 0===t?void 0:t.callGroupMembershipSettings}};let o={};return Object.values(L.J).forEach((e=>{const t=(0,a.merge)({},n[e],i[e]);Object.keys(t).length>0&&(o=Object.assign(Object.assign({},o),{[e]:t}))})),o}getAllowlistedCdlWorkerSettings(){const e={};return Object.keys(this.cdlWorkerSettingsAllowlist).forEach((t=>{var n;const i=this.coreSettings.get(t),o={};null===(n=this.cdlWorkerSettingsAllowlist[t])||void 0===n||n.forEach((e=>{const t=(0,a.get)(i,e);(0,a.isNil)(t)||(0,a.set)(o,e,t)})),Object.keys(o).length>0&&(e[t]=o)})),e}getAllowUserChat(e){const{allowUserChat:t,messagingPolicy:n}=e.get(L.J.Messaging);return"boolean"==typeof t||!!n?!!t:void 0}getPresenceHostSettings(e){const{enablePresenceInWorker:t,enablePresenceNotificationsOverTrouter:n,enableReportingUserActivityThroughTrouterByPresence:i,enablePriorityContactsSettings:a,enableSendPresenceTokenToUPS:o,upsTrouterConnectEndpointRecreateDelayInMs:r,priorityContactsRefreshIntervalInMs:s}=e.get(L.J.Presence);return{enablePresenceInWorker:Boolean(t),enablePresenceNotificationsOverTrouter:Boolean(n),enableReportingUserActivityThroughTrouterByPresence:Boolean(i),enablePriorityContactsSettings:Boolean(a),enableSendPresenceTokenToUPS:Boolean(o),upsTrouterConnectEndpointRecreateDelayInMs:null!=r?r:0,priorityContactsRefreshIntervalInMs:null!=s?s:0}}getAuthHostSettings(e){const{skypeTokenValidationDisabled:t}=e.get(L.J.Auth);return{skypeTokenValidationDisabled:!!t}}getCdlWorkerHostSettings(e){const t=e.get(L.J.CdlWorker);return{enableClassBasedErrors:!!t.enableClassBasedErrors,enablePoliciesSyncEngine:!!t.enablePoliciesSyncEngine,enableCrossTenantPoliciesSyncEngine:!!t.enableCrossTenantPoliciesSyncEngine,enableOpenWindowsSettingsMaglev:!!t.enableOpenWindowsSettingsMaglev,enableConversationReminderEngine:!!t.enableConversationReminderEngine,enableSendNudgeAfterInactivityPeriod:!!t.enableSendNudgeAfterInactivityPeriod,enableMeetNowLinksReminder:!!t.enableMeetNowLinksReminder,enableNotificationsEngine:!!t.enableNotificationsEngine,enableAppsUsageSyncEngine:!!t.enableAppsUsageSyncEngine,enableUserPreferencesWorkerFetch:!!t.enableUserPreferencesWorkerFetch,enableAppsPlatformSyncEngine:!!t.enableAppsPlatformSyncEngine,enableChatWithUserNetworkFetch:!!t.enableChatWithUserNetworkFetch,enableOfflineActionsSyncEngine:!!t.enableOfflineActionsSyncEngine,enableStartupDeferral:!!t.enableStartupDeferral,enableTenantSyncStrategy:!!t.enableTenantSyncStrategy,enableSearchTopNPopulateStrategy:!!t.enableSearchTopNPopulateStrategy,enableSensitivityLabelSync:!!t.enableSensitivityLabelSync,enableWaitOnAuthUp:!!t.enableWaitOnAuthUp,enableStartupUsingPartialData:!!t.enableStartupUsingPartialData,enableNonRecentChatsStartup:!!t.enableNonRecentChatsStartup,nonRecentChatsStartupPageSize:t.nonRecentChatsStartupPageSize,nonRecentChatsStartupMaxCalls:t.nonRecentChatsStartupMaxCalls,nonRecentChatsStartupWorkflowTimeoutInMS:t.nonRecentChatsStartupWorkflowTimeoutInMS,chatsStartupJobPageSize:t.chatsStartupJobPageSize,chatListCacheDaysThreshold:t.chatListCacheDaysThreshold,partialDataStartupChatsLimit:t.partialDataStartupChatsLimit,partialDataStartupSkipNonRecentMeeting:t.partialDataStartupSkipNonRecentMeeting,skipMeetingChatsInGroupChatSync:!!t.skipMeetingChatsInGroupChatSync,enableChatTitleCache:!!t.enableChatTitleCache,enableMruChannelsMemoryPruning:!!t.enableMruChannelsMemoryPruning,disableUnknownTitleFallback:!!t.disableUnknownTitleFallback,disableTitleCacheRefreshOnDisplayNameChange:!!t.disableTitleCacheRefreshOnDisplayNameChange,disablePartialLoadConversationNetworkFetch:!!t.disablePartialLoadConversationNetworkFetch,enableMultipleReplyChainsUpdatesFromWorker:!!t.enableMultipleReplyChainsUpdatesFromWorker,enableMTMAAggregator:!!t.enableMTMAAggregator,disablePingingPDSIfWorkerStartupFails:t.disablePingingPDSIfWorkerStartupFails,currentConversationTableVersion:t.currentConversationTableVersion,disableMessageContentWrapperDiv:t.disableMessageContentWrapperDiv,enablePriorityJobRunner:!!t.enablePriorityJobRunner,scheduleChannelsConversationSyncAtBackgroundPriority:!!t.scheduleChannelsConversationSyncAtBackgroundPriority,trouterNotifyServiceDownTimerMs:t.trouterNotifyServiceDownTimerMs,chatServiceMaxPageSize:t.chatServiceMaxPageSize,chatReplyChainsToFetch:t.chatReplyChainsToFetch,preloadNamespaces:t.preloadNamespaces,enableBypassSortAndDedupe:!!t.enableBypassSortAndDedupe}}getActivityHostSettings(e){const t=e.get(L.J.Activity);return{enableActivityManagerStore:!!t.enableActivityManagerStore,enableActivityBellCount:!!t.enableActivityBellCount,feedItemsCountOnAppLoad:t.paginationFirstLoad||0,maxActivityFeedLatency:t.maxActivityFeedLatency||0,clientStableBufferTimeForAPT:t.clientStableBufferTimeForAPT||0,enableOrderFeedsReplyChainsByMaxVersion:!!t.enableOrderFeedsReplyChainsByMaxVersion,enableChannelFeedItems:!!t.enableChannelFeedItems,enableActivityTranslationInCDL:!!t.enableActivityTranslationInCDL,enableMarkAllAsReadLogic:!!t.enableMarkAllAsReadLogic,enableSharedChannelFeedItems:!!t.enableSharedChannelFeedItems,enableUrgentFeedItems:!!t.enableUrgentFeedItems,enableSyntheticNotificationProcessor:!!t.enableSyntheticNotificationProcessor,enableGraphFeedItems:!!t.enableGraphFeedItems,disableIncomingPstnActivityFeed:!!t.disableIncomingPstnActivityFeed,enableMTMAMissedNotifications:!!t.enableMTMAMissedNotifications,mtmaNotificationsPollingInterval:t.mtmaNotificationsPollingInterval||MD.mtmaNotificationsPollingIntervalDefault}}getActivityNotificationHostSettings(e){const{enableNewSettingsApiUse:t,enableMissedActivityEmails:n}=e.get(L.J.ActivityNotification);return{enableNewSettingsApiUse:!!t,enableMissedActivityEmails:!!n}}getPeopleHostSettings(e){const t=e.get(L.J.People);return{enableBuddyListService:!!t.enableBuddyListService,buddyListRefreshTimeoutInMilliSeconds:t.buddyListRefreshTimeoutInMilliSeconds||0,blockedListRefreshIntervalInMs:t.blockedListRefreshIntervalInMs||0,blockedListPendingActionQueueChunkSize:t.blockedListPendingActionQueueChunkSize||0,enableContactsSync:!!t.enableContactsSync,enableMultipleAliasesForContactsSync:!!t.enableMultipleAliasesForContactsSync,maxNumberOfRoamingDevices:t.maxNumberOfRoamingDevices||0,enableInstantSyncForRoamingDevices:!!t.enableInstantSyncForRoamingDevices,fetchTFLContactsRefreshInterval:t.fetchTFLContactsRefreshInterval||[],enableEndpointsManagerOnAcceptListService:!!t.enableEndpointsManagerOnAcceptListService,enableEndpointsManagerOnBuddyService:!!t.enableEndpointsManagerOnBuddyService,enableEndpointsManagerOnBlockService:!!t.enableEndpointsManagerOnBlockService,contactsSyncDeltaRefreshIntervalInMs:t.contactsSyncDeltaRefreshIntervalInMs||0,contactsSyncFullRefreshIntervalInMs:t.contactsSyncFullRefreshIntervalInMs||0,contactsSyncKeepAliveIntervalInMs:t.contactsSyncKeepAliveIntervalInMs||0,maxBatchSizeforSCDDeletion:t.maxBatchSizeforSCDDeletion||0,lokiTokenResourceUrl:t.lokiTokenResourceUrl||"",buddyServiceEndpointManagerMaxRetries:t.buddyServiceEndpointManagerMaxRetries||0,enableTflTfwFederation:!!t.enableTflTfwFederation,enableProfilePicturesWithObjectId:!!t.enableProfilePicturesWithObjectId,enableMeProfileSyncStrategy:!!t.enableMeProfileSyncStrategy,checkProfileExpiryAndRefreshIntervalInMs:t.checkProfileExpiryAndRefreshIntervalInMs||0,enableTfwToTfwFederatedInviteFree:!!t.enableTfwToTfwFederatedInviteFree,enableBlockedContactsDataStore:!!t.enableBlockedContactsDataStore,enableM365Endpoint:!!t.enableM365Endpoint,enableExtendedDirectory:!!t.enableExtendedDirectory,enableCapiv3ContactsSync:!!t.enableCapiv3ContactsSync,enableSharedChannelPeoplePickerErrorMessages:!!t.enableSharedChannelPeoplePickerErrorMessages,enableProfileFetchFromWorkingSet:!!t.enableProfileFetchFromWorkingSet,enableAtMentionEveryoneInGroupChat:!!t.enableAtMentionEveryoneInGroupChat,enableAtMentionEveryoneInMeetingChat:!!t.enableAtMentionEveryoneInMeetingChat}}getMessagingHostSettings(e){const t=e.get(L.J.Messaging);return{enableChatWithNonTflUsers:!!t.enableChatWithNonTflUsers,enableCSAChatSummarization:!!t.enableCSAChatSummarization,enableCSAChatSummarizationV2:!!t.enableCSAChatSummarizationV2,enableTflSmsCreate:!!t.enableTflSmsCreate,enableTfwTflFederation:!!t.enableTfwTflFederation,enableTfwFederationOnTfl:!!t.enableTfwFederationOnTfl,enableTFLSmsFriendlyNameSearch:!!t.enableTFLSmsFriendlyNameSearch,tflSmsAllowedPhoneNumberRegionCodes:t.tflSmsAllowedPhoneNumberRegionCodes||[],disableMessagingSyncEngine:!!t.disableMessagingSyncEngine,enableAutoSendV2:!!t.enableAutoSendV2,disableRendererSideSanitization:!!t.disableRendererSideSanitization,enableTranslationSettings:!!t.enableTranslationSettings,enableSingleInbox:!!t.enableSingleInbox,enableTagsMention:!!t.enableTagsMention}}getTeamsAndChannelsHostSettings(e){const t=e.get(L.J.Channels),n=e.get(L.J.TeamsAndChannels);return{enablePinnedChannelsSyncEngine:!!n.enablePinnedChannelsSyncEngine,maximumPinnedChannelLimit:n.maximumPinnedChannelLimit,pinnedChannelsSyncIntervalInMs:n.pinnedChannelsSyncIntervalInMs,enableFixingPinnedChannelsConflict:!!n.enableFixingPinnedChannelsConflict,enableUserResolutionForChannelModeratorList:!!n.enableUserResolutionForChannelModeratorList,enableRecommendedTeamsSync:!!n.enableRecommendedTeamsSync,allowChannelSharingToExternalUser:!!n.allowChannelSharingToExternalUser,enableChannelInfoPane:!!t.enableChannelInfoPane,enableUseT1LocaleInTranslation:!!t.enableUseT1LocaleInTranslation,enableChannelsUserResolutionInT21:!!t.enableChannelsUserResolutionInT21,allowGuestUser:!!n.allowGuestUser}}getCalendarHostSettings(e){const t=e.get(L.J.Calendar);return{autodiscoverSettings:t.autodiscoverSettings,calendarRESTEnabledAPIs:t.calendarRESTEnabledAPIs,connectedCalendarSettingsRefreshIntervalInMs:t.connectedCalendarSettingsRefreshIntervalInMs||0,enableCalendarSyncEngine:!!t.enableCalendarSyncEngine,enableCalendarV2ApiService:!!t.enableCalendarV2ApiService,enableCalendarV2ApiServiceEnterprise:!!t.enableCalendarV2ApiServiceEnterprise,enableClientStateCheckForCalendarPolling:!!t.enableClientStateCheckForCalendarPolling,enableClientStateCheckForMultipleCalendarPolling:!!t.enableClientStateCheckForMultipleCalendarPolling,enableClientStateCheckForUnifiedCalendarPolling:!!t.enableClientStateCheckForUnifiedCalendarPolling,enableMultipleCalendarSyncEngine:!!t.enableMultipleCalendarSyncEngine,enableUnifiedCalendarSyncEngine:!!t.enableUnifiedCalendarSyncEngine,enableConnectedCalendar:!!t.enableConnectedCalendar,enableConnectedCalendarSettingsSync:!!t.enableConnectedCalendarSettingsSync,enableCourseCalendarSyncEngine:t.enableCourseCalendarSyncEngine,enableEventFetchOptimizationUsingLastSync:t.enableEventFetchOptimizationUsingLastSync,enableMeetingArtifactsCollaborationData:t.enableMeetingArtifactsCollaborationData,enablePrefetchCourseCalendarEventsOnStartUp:t.enablePrefetchCourseCalendarEventsOnStartUp,isOnCloud:t.isOnCloud,maxRoomListsToFetch:t.maxRoomListsToFetch,maxRoomsInRoomListToFetch:t.maxRoomsInRoomListToFetch,maxRoomsToFetch:t.maxRoomsToFetch,enableThirdPartyCalendar:!!t.enableThirdPartyCalendar,calendarEventsPollIntervalInMs:t.calendarEventsPollIntervalInMs,calendarEventsPollIntervalWithPushInMs:t.calendarEventsPollIntervalWithPushInMs,isLmsCourseCalendar:!!t.isLmsCourseCalendar,enablePrefetchCalendarEventsOnStartUp:!!t.enablePrefetchCalendarEventsOnStartUp,enableSensitivityLabelInCalendar:!!t.enableSensitivityLabelInCalendar,enableCalendarPushNotifications:!!t.enableCalendarPushNotifications,enableCalendarPollingWithPushNotifications:!!t.enableCalendarPollingWithPushNotifications,enableCalendarGCVOptimizations:!!t.enableCalendarGCVOptimizations,enableCalendarMailBoxDiscoveryHandler:!!t.enableCalendarMailBoxDiscoveryHandler}}getExternalAccountHostSettings(e){const{enableExternalAccounts:t,requestSource:n,enableUnifiedHardDelete:i}=e.get(L.J.ExternalAccounts);return{enableExternalAccounts:!!t,requestSource:n,enableUnifiedHardDelete:!!i}}getEndpointsHealthHostSettings(e){const{enableWorkerEndpointsHealthMonitor:t,enableWorkerEndpointsHealthService:n}=e.get(L.J.Core);return{enableWorkerEndpointsHealthMonitor:!!t,enableWorkerEndpointsHealthService:!!n}}getDataStoreHostSettings(e){const t=e.get(L.J.CdlWorker);return{enableDbOpenTimeout:!!t.enableDbOpenTimeout,dbOpenTimeoutLengthSeconds:t.dbOpenTimeoutLengthSeconds||60,dataStoreMapType:t.dataStoreMapType||"",disableDataStoreInMemoryProvider:!!t.disableDataStoreInMemoryProvider,disableDataStoreDbProvider:!!t.disableDataStoreDbProvider,rollbackSupportInDataStoreInMemoryProvider:!!t.rollbackSupportInDataStoreInMemoryProvider,disableReplyChainManagerPrefetch:!!t.disableReplyChainManagerPrefetch,dataStoreCreationResiliencyConfig:t.dataStoreCreationResiliencyConfig||{enable:!1},dataStoreDbOperationResiliencyConfig:t.dataStoreDbOperationResiliencyConfig,enableConversationTypeIndex:!!t.enableConversationTypeIndex}}getCoreSettingsTestOverrides(e){const t=e;return{localStorageTestOverrides:t.getLocalStorageTestOverrides()||{},qspTestOverrides:t.getQspTestOverrides()||{}}}getFilesHostSettings(e){const{preferGraphOverVroom:t,vroomEndpointBaseUrl:n,graphEndpointBaseUrl:i,graphAuthScope:a,vroomAuthScope:o}=e.get(L.J.Files);return{filesOverrides:{preferGraphOverVroom:!!t,vroomEndpointBaseUrl:n||"",graphEndpointBaseUrl:i||"",graphAuthScope:a||"",vroomAuthScope:o||""}}}getDiscoverSurfaceHostSettings(e){const t=e.get(L.J.DiscoverSurface);return{enableHybridDiscoverSurface:!!t.enableHybridDiscoverSurface,discoverSurfaceTopItemsCount:t.discoverSurfaceTopItemsCount||DD.$.defaultItemsToFetch,discoverSurfaceDefaultSection:t.discoverSurfaceDefaultSection||DD.$.defaultSection,enableDiscoverSurfaceDebugMenu:!!t.enableDiscoverSurfaceDebugMenu,serverCacheRetentionTimeInHrsSinceFirstCall:t.serverCacheRetentionTimeInHrsSinceFirstCall||DD.$.defaultServerCacheRetentionTimeInHrsSinceFirstCall,enableDiscoverBadging:!!t.enableDiscoverBadging,dataSyncIntervalTime:t.dataSyncIntervalTime||DD.$.defaultDataSyncIntervalTime,enableDiscoverSurfaceSyncEngine:!!t.enableDiscoverSurfaceSyncEngine}}getMtmaSpecificHostSettings(){const{enableMTMA:e}=this.coreSettings.get(L.J.Core);return e&&this.primaryUser&&this.primaryUser.profile?{primaryUserProfile:{oid:this.primaryUser.profile.objectId,tid:this.primaryUser.profile.tenantId}}:{}}isMessagingNotificationsOverTrouterEnabled(){const e=this.coreSettings.get(L.J.Host).enableMessagingNotificationsOverTrouter;return(0,a.isNil)(e)?!!this.coreSettings.get(L.J.CdlWorker).enableMessagingNotificationsOverTrouter:e}getGuardiansHostSettings(e){const{enableGuardiansPreferredMethodAndSmsInvite:t}=e.get(L.J.Guardians);return{enableGuardiansPreferredMethodAndSmsInvite:t}}}MD.mtmaNotificationsPollingIntervalDefault=3e5;var OD=n(307624);class PD{constructor(){this.perfDataByOperationName=new Map,this.cdlSubscriptionAggregatorAllowList=["chatServiceEvent","DataResolversBrowserChatServiceEventsChatServiceBatchEventSubscription","DataResolversBrowserChatServiceEventsChatServiceEventSubscription"]}static getInstance(){return this.subscriptionEventAggregatorSingleton||(this.subscriptionEventAggregatorSingleton=new PD),this.subscriptionEventAggregatorSingleton}init(e,t,n,i){var a;this.logger=e.newLogger("SubscriptionEventAggregator","core-cdl-data-layer-client"),n&&(this.cdlSubscriptionAggregatorAllowList=n),null===(a=this.logger)||void 0===a||a.log(`Initialized CDLSubscriptionEventAggregator Allow List: ${this.cdlSubscriptionAggregatorAllowList.join(",")}`),this.intervalCancellationToken=setInterval((()=>{this.logStats(t)}),i||sD.A_)}addToTimeline(e,t,n,i,a,o,r){if(this.intervalCancellationToken||this.init(n,i,a,r),!t)return void(this.logger&&this.logger.log("Received subscription perf stat without responseSendTime. Ignoring."));const s=Date.now()-t;if(!(s<0)&&(e&&!this.perfDataByOperationName.has(e)&&this.perfDataByOperationName.set(e,{ipcTimes:[],customIdentifierCount:{}}),e)){const t=this.perfDataByOperationName.get(e);if(!t)return void(this.logger&&this.logger.warn(`SubscriptionEventAggregator: No perf data found for operationName ${e}`));if(t.ipcTimes.push(s),o){let e={};e="string"==typeof o?{[o]:1}:o,Object.keys(e).forEach((n=>{const i=e[n];t.customIdentifierCount[n]||(t.customIdentifierCount[n]=0),t.customIdentifierCount[n]+=i}))}}}logStats(e){const t=Array.from(this.perfDataByOperationName.entries());this.perfDataByOperationName.clear();for(const[n,i]of t){if(!this.cdlSubscriptionAggregatorAllowList.includes(n))continue;const t={operationName:n,numberOfRequests:i.ipcTimes.length,averageIPCTimeOneWay:i.ipcTimes.reduce(((e,t)=>e+t),0)/i.ipcTimes.length},o=e.newScenario(it.RG.CentralDataLayerSubscription);(0,a.keys)(i.customIdentifierCount).forEach((e=>{o.mark(e,{size:i.customIdentifierCount[e],type:e})})),o.stop(t)}}}function LD(e,t,n,i,a){var o,r;let s;if(function(e,t,n){return!e.some((e=>{var i,a;const o=t.getEntriesByName(e);return null===(i=n.infoToTelemetry)||void 0===i||i.call(n,`Marker performance information ${e}!`,"telemetry_instrumentation_capture_perf_measurement",void 0,!1),o.length<=0&&(null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`Measure ${e} was never created!`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0),!0)}))}([t,n],i,a))try{i.measure(e,t,n);const a=i.getEntriesByName(e)[0];s=null==a?void 0:a.duration,s&&(s=Math.round(s)),i.clearMeasures(e)}catch(e){null===(o=a.errorToTelemetry)||void 0===o||o.call(a,`Failed to capture measurement between ${t} and ${n}: ${e}`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0)}else null===(r=a.errorToTelemetry)||void 0===r||r.call(a,`Can not capture measurement between ${t} and ${n}, at least one of them not exist`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0);return s}function UD(e,t,n,i){e.measure(t,n,i),e.clearMeasures(t),e.clearMarks(n),i&&e.clearMarks(i)}class jD{constructor(e,t,n){this.isResponse=t,this.internalPerfStat={operationName:n,requestStartTime:{perf:performance.now(),date:Date.now()},responseReceivedTime:{perf:performance.now(),date:Date.now()},workerResponseTime:0,dataStorePerfStats:[]},this.operationName=n||"",this.operationType=e,performance.mark(`${this.getPerformanceName()}-start`)}stopMeasurement(e,t,n){this.internalPerfStat=Object.assign(Object.assign(Object.assign({},this.internalPerfStat),e),{responseReceivedTime:{perf:performance.now(),date:Date.now()}});const i=this.getPerformanceName(),a=`${i}-start`,o=`${i}-end`;!function(e,t){void 0===function(e,t){const n=t.getEntriesByName(e);if(n&&n.length>0)return n[0]}(e,t)&&t.mark(e)}(a,performance),performance.mark(o),UD(performance,i,a,o);const{requestStartTime:r,requestReceivedTime:s,responseSendTime:l,responseReceivedTime:c,workerResponseTime:d}=this.internalPerfStat,u={totalRequestTime:Math.round(c.perf-r.perf),workerResponseTime:Math.round(d),requestTime:Math.round(r.perf),responseTime:Math.round(c.perf)};return(null==t?void 0:t.length)&&(u.otherResponsesReceivedWhileInTransit=t),n&&(u.responseReceiveLatency=n),s&&(u.requestIPCTime=s-r.date),l&&(u.responseIPCTime=c.date-l),u}static markSubscriptionRequest(e){const t=`subscription_request_start_${e}`,n=`subscription_request_${e}`;performance.mark(t),UD(performance,n,t)}static addSubscriptionResponse(e,t,n,i,a,o,r){PD.getInstance().addToTimeline(e,t,n,i,o,a,r)}getPerformanceName(){return`cdl-${this.isResponse?"response":"request"}-${this.operationName||this.operationType}`}}const $D=["callParticipantsVoiceLevelsChangedEvent","callParticipantsChangedEvent"],BD=["callingIntent","chat","messageList"],WD=["putConversations"],HD="debug";class VD{constructor(e,t,n,i,a,o,r,s,l,c,d,u=[],m,g,p,v,h,f){var y;if(this.variables=n,this._logger=o,this.loggerFactory=r,this.scenarioFactory=s,this.syncEngineInitializationPromise=l,this.rendererId=c,this.requestHealthMonitor=m,this.enableClassBasedErrors=g,this.cdlOperationCustomContext=v,this.splitFetchWaitMarkerInWLT=h,this.dataLayerClientSettings=f,this._perfStats=null,this._perfStatsForResponseProcessing=null,this._scenario=void 0,this._startTime=Date.now(),this._lastUpdateTime=null,this._requestId=e,this._windowId=d,this._requestType=t,"subscription"!==t?this._perfStats=new jD(t,!1,a):jD.markSubscriptionRequest(a),this._requestComplete=!1,this._operationName=a,this._loggingContext={requestId:e,component:"RequestHandler",requestRendererId:this.rendererId,requestWindowId:this.windowId,hostRendererId:i,operationType:t,operationName:a},u=u&&u.length?u:WD,this.subject=new OD.x(this._logger,this._loggingContext),this.logRequest(),a&&!u.includes(a)&&"subscription"!==t){this._scenario=this.scenarioFactory.newScenario(it.RG.CentralDataLayerRequest),this._scenario.clientName=a;const e=this.getActiveCPM();if(this._scenario.appendEventData({operationName:a,operationType:t,context:this.rendererId,"Panel.WindowID":this.windowId,target:p,correlationId:null==v?void 0:v.callerScenarioId,origin:null==v?void 0:v.callerInfo,activeCPM:e}),this.isRequestFromWindowLaunch(a,s)){s.startStep(it.RG.WindowLaunchTime,it.ck.FetchWait);const e=this.scenarioFactory.findScenario(it.RG.WindowLaunchTime);this._wltTimestampsAtInit=null==e?void 0:e.timestamps.length}}null===(y=this.requestHealthMonitor)||void 0===y||y.requestCreated(this),this.syncEngineInitializationPromise.then((e=>{var t;if(!e.isSyncEngineInitialized)throw Error();null===(t=this._scenario)||void 0===t||t.appendEventData({messagingSyncEngineStartupMode:e.bootType})})).catch((()=>{var e;null===(e=this._scenario)||void 0===e||e.appendEventData({messagingSyncEngineStartupMode:"Error"})}))}get requestId(){return this._requestId}get windowId(){return this._windowId}get response(){return this.subject.observable}get requestType(){return this._requestType}get operationName(){return this._operationName}isComplete(){return this._requestComplete}setResponseAndEndScenario(e,t,n){var i,a,o;const r=!e.errors&&e.data;this._otherResponsesReceivedWhileInTransit=t,this._responseReceiveLatency=n,r?(this._perfStatsForResponseProcessing=new jD(this.requestType,!0,this.operationName),this.onSuccess(e)):this.onError(e),this.onComplete(r?"success":"error"),r&&(null===(i=e.extensions)||void 0===i?void 0:i.perfStats)&&(null===(a=this._perfStatsForResponseProcessing)||void 0===a||a.stopMeasurement(null===(o=e.extensions)||void 0===o?void 0:o.perfStats,t,n))}cancel(){this._requestComplete||(this._requestComplete=!0,this._scenario&&this._scenario.incomplete(),this.onComplete("cancelled"))}toLog(){return{requestId:this.requestId,requestType:this.requestType,operationName:this.operationName,isComplete:this.isComplete(),variables:(0,a.mapValues)(this.variables,((e,t)=>this.variableToLog(t,e))),customContext:this.cdlOperationCustomContext,startTime:this._startTime,lastUpdateTime:this._lastUpdateTime}}onComplete(e){var t;this._requestComplete&&(this.subject.onComplete(),null===(t=this.requestHealthMonitor)||void 0===t||t.requestCompleted(this,e))}onSuccess(e){this.mergeAndEndStatsSnapshot(e.extensions),this.logResponse(),this.subject.onNext(e)}onError(e){var t,n,i;this._requestComplete=!0;const a=(null==e?void 0:e.errors)||"Unexpected: data layer query response missing both data and error",o=Array.isArray(a)?a.map((e=>(0,An.VK)(e))).join():(0,An.VK)(a);if(this.mergeAndEndStatsSnapshot(e.extensions,o),this.enableClassBasedErrors)this.subject.onNext(e);else{let a=e.errorCode;!a&&(null===(t=e.errors)||void 0===t?void 0:t.length)&&(a=e.errors[0].name||he.jK.RemoteOperationFailed),a||(a=he.jK.InvalidResponse);const r=(0,An.Tr)(he.w5.DataLayerClient,a,"onError",void 0,o);null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,`error while processing ${this._requestId}: ${r.message} (reason: ${r.reason})`,"cdl_data_layer_client_request_on_error",Object.assign(Object.assign({},(0,rD.n)(this._loggingContext)),{errorCode:a}),!0),this.subject.onError(r)}}mergeAndEndStatsSnapshot(e,t){var n,i,a,o;let r;e&&e.perfStats&&(this._perfStats&&(r=this._perfStats.stopMeasurement(e.perfStats,this._otherResponsesReceivedWhileInTransit,this._responseReceiveLatency)),"subscription"===this.requestType&&(this._lastUpdateTime=Date.now(),jD.addSubscriptionResponse(this.operationName,e.perfStats.responseSendTime,this.loggerFactory,this.scenarioFactory,e.subscriptionCustomIdentifier,null===(n=this.dataLayerClientSettings)||void 0===n?void 0:n.cdlSubscriptionAggregatorAllowList,null===(i=this.dataLayerClientSettings)||void 0===i?void 0:i.cdlSubscriptionAggregatorLogIntervalMS))),e&&(null===(a=this._scenario)||void 0===a||a.appendEventData({dataSource:e.dataSource,size:null===(o=e.perfStats)||void 0===o?void 0:o.payloadLength})),this._scenario&&(t?this.syncEngineInitializationPromise.then((e=>{var n,i,a;null===(n=this._scenario)||void 0===n||n.appendEventData(Object.assign(Object.assign({},r),{errors:(0,la.A)(t)})),e.isSyncEngineInitialized?null===(i=this._scenario)||void 0===i||i.fail():null===(a=this._scenario)||void 0===a||a.incomplete()})):(this._scenario.stop(r),this.isRequestFromWindowLaunch(this.operationName,this.scenarioFactory)&&this.createWltSteps(r)))}logResponse(){this._logger[this.getLogLevel()]("Received response data for request",this._loggingContext)}createWltSteps(e){const t=this.scenarioFactory.findScenario(it.RG.WindowLaunchTime);if(t&&t.currentStep!==it.ck.FetchProcessResponse){if(e){const{requestIPCTime:n,responseIPCTime:i,workerResponseTime:a}=e;if(n&&i&&this.splitFetchWaitMarkerInWLT){if(this._wltTimestampsAtInit&&t.timestamps.length>this._wltTimestampsAtInit)return;t.mark(it.ck.FetchWaitRequestIPC,{offsetCurrentTimeInMs:Math.round(a)+i}),t.mark(it.ck.FetchWaitWorker,{offsetCurrentTimeInMs:i}),t.mark(it.ck.FetchWaitResponseIPC)}else t.mark(it.ck.FetchWaitIPC,{offsetCurrentTimeInMs:Math.round(a)}),t.mark(it.ck.FetchWaitWorker)}t.startStep(it.ck.FetchProcessResponse)}}isRequestFromWindowLaunch(e,t){return!!t.findScenario(it.RG.WindowLaunchTime)&&BD.indexOf(e)>-1}logRequest(){this._logger.debug("Created new request",this._loggingContext)}getLogLevel(){var e;return $D.indexOf(null!==(e=this._loggingContext.operationName)&&void 0!==e?e:"")>=0?HD:"log"}getActiveCPM(){const e=[it.RG.ChatSwitch,it.RG.ChannelSwitchL1,it.RG.ChannelSwitchL2,it.RG.ChannelL1Deeplink,it.RG.ChannelL2Deeplink,it.RG.ActivitySwitch,it.RG.ApplicationLaunchTime,it.RG.WindowLaunchTime];if(this.scenarioFactory.doesScenariosExist){const t=this.scenarioFactory.doesScenariosExist(e);if(t.length)return t.join(",")}}variableToLog(e,t){var n,i;return(null===(i=null===(n=this.dataLayerClientSettings)||void 0===n?void 0:n.loggableOperationVariablesAllowList)||void 0===i?void 0:i.includes(e))||(0,a.isBoolean)(t)||(0,a.isNumber)(t)||(0,a.isNil)(t)?t:"N/A"}}class zD extends VD{onSuccess(e){super.onSuccess(e),this._requestComplete=!0}}class qD extends VD{onSuccess(e){super.onSuccess(e),this._requestComplete=!0}}class GD extends VD{onSuccess(e){super.onSuccess(e)}}var JD=n(59773);class QD{constructor(e,t,n,i,a){this.config=t,this.timeoutProvider=n,this.syncEngineInitializationPromise=i,this.dataLayerTarget=a,this.isRequestInProcess=!1,this.requestTimer=null,this.openRequests=new Map,this.timedOutDistinctRequestCount=0,this.failedDistinctRequestCount=0,this.timedOutOperationNames=new Set,this.failedOperationNames=new Set,this.lastSucceededRequest=this.firstTimedOutRequest=QD.DefaultRequestLoggingData,this.logger=e.newLogger("RequestHealthMonitor","core-cdl-data-layer-client")}requestCreated(e){if(!this.shouldMonitor(e))return;let t;null!==this.requestTimer||this.isRequestInProcess?t=!1:(this.startTimer(),t=!0),this.openRequests.set(e.requestId,{operationName:e.operationName,shouldTimeout:t,timeAdded:Date.now()})}requestCompleted(e,t){if(!this.shouldMonitor(e))return;this.openRequests.delete(e.requestId)||this.logger.warn(`Unknown request completed. Possibly timed out. RequestId ${e.requestId}, OperationName ${e.operationName}, Target ${this.dataLayerTarget}.`),0===this.openRequests.size&&null!==this.requestTimer&&this.clearTimer(),"success"===t&&this.onSuccess(e),"error"===t&&this.onError(e)}onSuccess(e){this.lastSucceededRequest={requestId:e.requestId,operationName:e.operationName},this.timedOutDistinctRequestCount=0,this.failedDistinctRequestCount=0,this.timedOutOperationNames.clear(),this.failedOperationNames.clear(),this.firstTimedOutRequest=QD.DefaultRequestLoggingData}onError(e){this.failedOperationNames.has(e.operationName)||(this.failedDistinctRequestCount++,this.failedOperationNames.add(e.operationName),this.failedDistinctRequestCount===this.failureCountThreshold&&this.indicateTargetUnhealthy("error"))}onTimeout(){let e=QD.DefaultRequestLoggingData,t=Number.MAX_SAFE_INTEGER;this.openRequests.forEach(((n,i)=>{if(n.shouldTimeout){const a=n.operationName;n.timeAdded<t&&(t=n.timeAdded,e={operationName:a,requestId:i}),this.logger.warn(`Request reached time out in health monitor. RequestId ${i}, OperationName ${a}, Target ${this.dataLayerTarget}.`),this.openRequests.delete(i),this.timedOutOperationNames.has(a)||(this.timedOutDistinctRequestCount++,this.timedOutOperationNames.add(a),this.timedOutDistinctRequestCount===this.timedOutCountThreshold&&this.indicateTargetUnhealthy("timedOut"))}else n.shouldTimeout=!0})),this.firstTimedOutRequest===QD.DefaultRequestLoggingData&&(this.firstTimedOutRequest=e),this.requestTimer=null,this.isRequestInProcess=!1,this.openRequests.size>0&&this.startTimer()}startTimer(){null!==this.requestTimer&&(this.logger.warn(`Health monitor timer already running when attempting to start new. Clearing old timer. Target ${this.dataLayerTarget}.`),this.timeoutProvider.clearTimeout(this.requestTimer)),this.isRequestInProcess=!0,this.syncEngineInitializationPromise.then((e=>{e.isSyncEngineInitialized&&(this.requestTimer=this.timeoutProvider.setTimeout((()=>this.onTimeout()),this.timeOutLengthMs))}))}clearTimer(){null!==this.requestTimer?(this.timeoutProvider.clearTimeout(this.requestTimer),this.requestTimer=null,this.isRequestInProcess=!1):this.logger.warn(`Health monitor timer tried to cancel non-existent timer. Ignoring. Target ${this.dataLayerTarget}.`)}indicateTargetUnhealthy(e){var t,n,i,a;let o="error"===e?`ErrorCount: ${this.failureCountThreshold}.`:`TimedOutCount: ${this.timedOutCountThreshold}. TimeOutMs: ${this.timeOutLengthMs}.`;this.config.memoryMapType&&(o=`${o} MemoryMapType: ${this.config.memoryMapType}.`);const r=`Last succeeded operation: ${this.lastSucceededRequest.operationName}, ${this.lastSucceededRequest.requestId}.`,s=`First timeout operation: ${this.firstTimedOutRequest.operationName}, ${this.firstTimedOutRequest.requestId}`,l=`RequestHealthMonitor: DataLayer is unhealthy due to successive requests failing with ${e}. Target: ${this.dataLayerTarget}. ${o} ${r} ${s}`;null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,l,"cdl_data_layer_client_request_health_monitor_unhealthy_target",void 0,!0),null===(a=(i=this.config).unhealthyDataLayerCallback)||void 0===a||a.call(i,l)}shouldMonitor(e){return"subscription"!==e.requestType}get failureCountThreshold(){return this.config.failureCountThreshold||QD.DefaultFailureCountThreshold}get timeOutLengthMs(){return(this.config.timeoutLengthSeconds||QD.DefaultTimeoutLengthSeconds)*sD.NO}get timedOutCountThreshold(){return this.config.timeoutCountThreshold||QD.DefaultTimeoutCountThreshold}}QD.DefaultFailureCountThreshold=5,QD.DefaultTimeoutCountThreshold=5,QD.DefaultTimeoutLengthSeconds=60,QD.DefaultRequestLoggingData={operationName:"na",requestId:"na"};class KD{constructor(e,t,n,i,a,o,r,s,l,c,d,u,m){var g;this.logger=e,this.scenarioFactory=n,this.syncEngineInitializationPromise=a,this.leakDetectorService=o,this.dataLayerCommunicatorTarget=r,this.timeoutProvider=s,this.enableClassBasedErrors=c,this.trackingOperationsDuringWaitConfig=d,this.dataClientTrackingService=u,this.dataLayerClientSettings=m,this.requestMap=new Map,this.recentlyCancelledRequests=new Map,this.loggingContext={hostRendererId:t,component:"RequestRegistrar"},this.leakDetector=null===(g=this.leakDetectorService)||void 0===g?void 0:g.create(),l&&l.enableRequestHealthMonitor&&s&&(this.requestHealthMonitor=new QD(i,l,s,this.syncEngineInitializationPromise,r))}createRequest(e,t,n,i,a,o,r,s,l){var c;const d=class{static createDataLayerRequest(e,t,n,i,a,o,r,s,l,c,d,u,m,g,p,v,h){const f=[e,t,n,i,a,o,r,s,l,c,d,void 0,u,m,g,p,v,h];switch(t){case"mutation":return new zD(...f);case"query":return new qD(...f);case"subscription":return new GD(...f)}}}.createDataLayerRequest(e,t,i,this.loggingContext.hostRendererId,n,this.logger,a,this.scenarioFactory,this.syncEngineInitializationPromise,o,r,this.requestHealthMonitor,this.enableClassBasedErrors,this.dataLayerCommunicatorTarget,s,l,this.dataLayerClientSettings);return null===(c=this.leakDetector)||void 0===c||c.track(`Request-${d.requestType}-${n}`,d),this.requestMap.set(e,d),JD.Q.Instance.processRequest(t,n,e),d}reconcileResponse(e,t){var n,i,a,o,r;const s=this.requestMap.get(e),l=t.data?t.data&&Object.keys(t.data).toString():"";if(this.recentlyCancelledRequests.has(e))return void this.logger.log(`Received response to a requestId that was recently cancelled. RequestId: ${e}. OperationNameHints: ${l}.`,this.loggingContext);if(!s)return void(null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,`Received response to a requestId that cannot be found in the map. operationName ${l}`,"cdl_request",{operationName:l,windowId:t.windowId,callId:t.requestId,contextId:t.rendererId,target:this.dataLayerCommunicatorTarget},!0));const c=t.extensions&&t.extensions.perfStats;let d,u;if(c||this.logger.warn(`Received response without perfStats for request. RequestId: ${e} RendererId: ${t.rendererId}, WindowId: ${t.windowId}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext),(null===(a=this.trackingOperationsDuringWaitConfig)||void 0===a?void 0:a.enableTrackingCdlOperationsDuringWait)&&c&&c.responseSendTime){this.markResponse(s);const e=c.responseSendTime,t=Date.now();if(u=t-e,u>((null===(o=this.trackingOperationsDuringWaitConfig)||void 0===o?void 0:o.trackingCdlOperationsDuringWaitThresholdInMs)||100)){d=this.getResponsesBetweenStartAndLast(e);const n=null==d?void 0:d.reduce(((e,t)=>{const n=e.find((e=>(null==e?void 0:e.name)===t));return n?n.count++:e.push({name:t,count:1}),e}),[]);(null===(r=this.trackingOperationsDuringWaitConfig)||void 0===r?void 0:r.enableLoggingCdlOperationsDuringWait)&&this.logger.log(`${null==s?void 0:s.operationName}, sendtime: ${e}, receivetime: ${t}, latency: ${t-e}, responses received between send and receive: ${JSON.stringify(n)}`,this.loggingContext)}}const m=c;s.setResponseAndEndScenario(t,d,u),s.isComplete()&&(this.requestMap.delete(e),JD.Q.Instance.processResponse(e,m&&m.workerResponseTime))}cancelRequest({requestId:e,rendererId:t,windowId:n}){const i=this.requestMap.get(e);i?(i.cancel(),this.requestMap.delete(e),this.recentlyCancelledRequests.set(e,(new Date).getTime()),this.scheduleCancelledRequestsMapCleanup()):this.logger.debug(`Nothing to cancel, request no longer in map. RequestId: ${e} RendererId: ${t}, WindowId: ${n}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext)}getLogs(){return JSON.stringify((0,a.map)(Array.from(this.requestMap.values()),(e=>e.toLog())),null,2)}scheduleCancelledRequestsMapCleanup(){var e;if(!this.recentlyCancelledRequestsTimer){const t=2,n=(new Date).getTime();this.recentlyCancelledRequestsTimer=null===(e=this.timeoutProvider)||void 0===e?void 0:e.setTimeout((()=>this.cleanRecentlyCancelledRequestsMap(n)),t*sD.A_)}}cleanRecentlyCancelledRequestsMap(e){this.recentlyCancelledRequests.forEach(((t,n)=>{t<e&&this.recentlyCancelledRequests.delete(n)})),this.recentlyCancelledRequestsTimer=void 0}markResponse(e){var t;null===(t=this.dataClientTrackingService)||void 0===t||t.markResponse(e.operationName)}getResponsesBetweenStartAndLast(e){var t;return(null===(t=this.dataClientTrackingService)||void 0===t?void 0:t.getResponsesBetweenStartAndLast(e))||[]}}var YD=n(109458),XD=n(696758),ZD=n(17094);class eR{constructor(e,t,n,i,a,o,r,s,l=!1,c=Promise.resolve({isSyncEngineInitialized:!0}),d,u,m,g){this.hostRendererId=e,this.loggerFactory=t,this.scenarioFactory=n,this.dataLayerCommunicator=i,this.leakDetectorService=a,this.splitFetchWaitMarkerInWLT=m,this.loggingContext={component:"DataLayerClient",hostRendererId:e},this.logger=new yF.V(t.newLogger("CDL","core-cdl-data-layer-client")),this.logger.log("logger created for renderer",this.loggingContext),this.dataLayerCommunicator.onMessage=this.onMessageReceived.bind(this),this.requestRegistrar=new KD(this.logger,e,this.scenarioFactory,this.loggerFactory,c,this.leakDetectorService,o,r,s,l,d,u,g),this.requestId=new ZD.L("graphql")}execute(e,t,n,i,a,o){const r=(0,YD.S)(e,n),s=r&&r.operation||"query",l=this.requestId.next(s),c=this.requestRegistrar.createRequest(l,s,n||s,t,this.loggerFactory,i,a,o,this.splitFetchWaitMarkerInWLT);this.logger.log("executing graphql request to data layer",Object.assign(Object.assign({requestId:c.requestId},this.loggingContext),{operationType:s,operationName:n,hostRendererId:this.hostRendererId,requestRendererId:i,requestWindowId:a})),this.dataLayerCommunicator.sendMessage({requestId:l,windowId:a,rendererId:this.hostRendererId,request:{graphqlQuery:(0,XD.S)(e),variables:t},cdlOperationCustomContext:o,operationName:n});return function(e,t){const n=e.subscribe;return e.subscribe=i=>{const a=n.call(e,i),o=a.unsubscribe;return a.unsubscribe=()=>(t(),o.call(a)),a},e}(c.response,this.onUnsubscribe(c,n))}getRequestLogs(){return this.requestRegistrar.getLogs()}onUnsubscribe(e,t){return()=>{e.isComplete()||(this.logger.log("Notifying server of unsubscription",Object.assign(Object.assign({},this.loggingContext),{requestId:e.requestId,requestType:FF,operationName:t})),this.dataLayerCommunicator.sendMessage({requestId:e.requestId,rendererId:this.hostRendererId,windowId:e.windowId,request:{graphqlQuery:FF,variables:void 0},operationName:t}),this.requestRegistrar.cancelRequest({requestId:e.requestId,rendererId:this.hostRendererId,windowId:e.windowId}))}}onMessageReceived(e){this.requestRegistrar.reconcileResponse(e.requestId,e)}}class tR{constructor(e,t,n,i,a,o,r,s,l,c,d,u,m,g,p,v,h,f,y,b){this.host=e,this.config=t,this.loggerFactory=i,this.scenarioFactory=a,this.coreSettings=o,this.dataClientTrackingService=y,this.isDisposed=!1,this.logger=i.newLogger("DataClientCoreCDLWorkerService","core-services-cdl-worker"),this.cdlWorkerHostSettingsAggregator=new MD(n,o,r,i,c,m,g),this.cdlWorkerManagerInitializationPromise=wD(e,t,this.cdlWorkerHostSettingsAggregator,i,a,o,s,l,c,this.logger,p,v,h,f,g,b);if(CD(c,o,a,e,this.logger)){this.cdlWorkerStateSender=new AD(d,u,i,this);const{disableCDLWorkerHostSettingsUpdates:e}=o.get(L.J.Core);e||this.startNotifyingCDLWorkerForHostSettingsChanges()}}getCDLWorkerManager(){return this.cdlWorkerManagerInitializationPromise}getDataLayerClient(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.dataLayerClient){const e=yield this.getCDLWorkerManagerOrThrow("getDataLayerClient"),t=this.coreSettings.get(L.J.CdlWorker),{logCdlOperationsDuringWaitSettings:n}=this.coreSettings.get(L.J.Core);this.dataLayerClient=new eR(this.config.clientId,this.loggerFactory,this.scenarioFactory,e.workerClientResponseRouter.cdlGraphQLClient,void 0,"Worker",this.host,{enableRequestHealthMonitor:!!t.enableRequestHealthMonitor,failureCountThreshold:t.requestHealthMonitorFailureCountThreshold,timeoutCountThreshold:t.requestHealthMonitorTimeoutCountThreshold,timeoutLengthSeconds:t.requestHealthMonitorTimeoutLengthSeconds,memoryMapType:(0,ID.qo)(this.coreSettings)},!!t.enableClassBasedErrors,e.syncEngineInitializationPromise,{enableLoggingCdlOperationsDuringWait:null==n?void 0:n.enableLoggingCdlOperationsDuringWait,enableTrackingCdlOperationsDuringWait:null==n?void 0:n.enableTrackingCdlOperationsDuringWait,trackingCdlOperationsDuringWaitThresholdInMs:null==n?void 0:n.trackingCdlOperationsDuringWaitThresholdInMs},this.dataClientTrackingService,!!t.splitFetchWaitMarkerInWLT,{cdlSubscriptionAggregatorAllowList:t.cdlSubscriptionAggregatorAllowList||void 0,loggableOperationVariablesAllowList:t.loggableOperationVariablesAllowList||void 0,cdlSubscriptionAggregatorLogIntervalMS:t.cdlSubscriptionAggregatorLogIntervalMS||void 0})}return this.dataLayerClient}))}getControlPlaneCommunicator(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.controlPlaneCommunicator){const e=yield this.getCDLWorkerManagerOrThrow("getControlPlaneCommunicator");this.controlPlaneCommunicator=new FD(e.workerClientResponseRouter,{loggerFactory:this.loggerFactory})}return this.controlPlaneCommunicator}))}dispose(){this.cdlWorkerStateSender&&this.cdlWorkerStateSender.dispose(),this.cdlWorkerHostSettingsAggregator.cleanup(),this.isDisposed=!0}logoutCurrentUser(e){var t,n,a,o,r,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.get(L.J.CdlWorker).maxLogoutTime||5e3;if(this.isDisposed)return void(null===(n=(t=this.logger).warnToTelemetry)||void 0===n||n.call(t,"Unable to cleanup CDL Worker: Already disposed.","cdl_services_worker_worker_service_logout_current_user_error",void 0,!0));const l=yield this.getCDLWorkerManager();if(l)try{yield(0,Fn.E)(l.workerClientResponseRouter.cdlSyncEngineClient.sendRequest({type:"logout",subType:"",params:void 0}),i,`logout request to CDL worker timed out after ${i} ms`)}catch(e){null===(s=(r=this.logger).errorToTelemetry)||void 0===s||s.call(r,`Failed to cleanup CDL Worker on logout. ${e&&e.code===he.jK.TimedOut?e.message:""}`,"cdl_services_worker_worker_service_logout_current_user_error",void 0,!0)}else null===(o=(a=this.logger).warnToTelemetry)||void 0===o||o.call(a,"Unable to cleanup CDL Worker: Worker manager not available.","cdl_services_worker_worker_service_logout_current_user_error",void 0,!0)}))}getDebugService(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.debugService){const{DataClientCoreCDLWorkerDebugService:e}=yield n.e(583194).then(n.bind(n,403406));this.debugService=new e(this.loggerFactory,this)}return this.debugService}))}getDataLayerRequestLogs(){var e,t;if(!this.dataLayerClient)return"Data layer client unavailable.";if(this.coreSettings.get(L.J.CdlWorker).disableOperationsInLogFiles)return"Data layer request logs disabled by setting 'disableOperationsInLogFiles'.";try{return(null===(t=(e=this.dataLayerClient).getRequestLogs)||void 0===t?void 0:t.call(e))||"Data layer client has not implemented request logs."}catch(e){return`Data layer client failed to get logs: ${(0,An.VK)(e)}.`}}startNotifyingCDLWorkerForHostSettingsChanges(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let n;try{n=yield this.getCDLWorkerManager()}catch(n){return void(null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,`Unable to start notifying CDL Worker for host settings changes: getCDLWorkerManager failed: ${n.message}.`,"cdl_services_worker_worker_service_notify_worker_host_settings_changes_error",void 0,!0))}n?(this.cdlWorkerHostSettingsAggregator.startNotifyingCDLWorkerForHostSettingsChanges(n.workerClientResponseRouter.cdlControlClient),this.logger.log("Start notifying CDL Worker for host settings changes.")):this.logger.log("Unable to start notifying CDL Worker for host settings changes: Worker manager not available.")}))}getCDLWorkerManagerOrThrow(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getCDLWorkerManager();if(!t)throw(0,An.Tr)(tR.ComponentName,he.jK.NotInitialized,e,void 0,"Worker manager is not initialized");return t}))}}tR.ComponentName="DataClientCoreCDLWorkerService";var nR=n(408552),iR=n(739085),aR=n(136501);class oR{constructor(e,t,n,i,a){this.cdlWorkerManager=e,this.logger=t,this.authenticationService=n,this.getDataLayerRequestLogs=i,this.cacheStorage=a,this.logsProviderName="CdlWorkerLogsProvider"}getLogsFiles(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let t;const n=this.getWorkerDiagnosticsLogsFromCdlWorkerManager(),i=this.getVerboseWorkerLogs(this.cdlWorkerManager.workerType),a=yield this.authenticationService.getUser();if(a&&a.isAuthenticated)t=this.getSyncEngineLogsFromCdlWorkerManager();else{const e="Sync logs cannot be retrieved for unauthenticated users.";t=Promise.resolve([{isPiiFree:!0,fileName:"sync-failure-logs.txt",content:e}]),this.logger.warn(e)}const o=yield n;return[{isPiiFree:!o.diagnosticsEvents||!!e,fileName:"cdl-worker-diagnostics-logs.txt",content:o.diagnosticsEvents?(0,aR.Mf)(e?o.diagnosticsEvents.filter((e=>e.isPiiFree)):o.diagnosticsEvents):"No logs found"},{isPiiFree:!0,fileName:"cdl-worker-settings.json",content:o.coreSettingsSnapshot},{isPiiFree:!1,fileName:"cdl-worker-requests.txt",content:this.getDataLayerRequestLogs()},...yield t,...yield i]}))}getVerboseWorkerLogs(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(this.cacheStorage){const t=new iR.d(this.cacheStorage,this.logger),n=yield t.getWorkerVerboseLog(e);if(""!==n)return Promise.resolve([{isPiiFree:!1,fileName:"verbose-worker-logs.txt",content:n}])}return Promise.resolve([])}))}getWorkerDiagnosticsLogsFromCdlWorkerManager(){var e,t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this.cdlWorkerManager.workerClientResponseRouter.cdlDiagnosticsClient;try{const t=yield i.sendRequest("get_logs");if(null===(e=null==t?void 0:t.response)||void 0===e?void 0:e.data)return t.response.data;this.logger.warn("Diagnostic event list empty or ill-formed")}catch(e){const i=yield this.getSyncEngineInitResultFromCdlWorkerManager(),a=`Unable to retrieve worker diagnostics logs. ${(0,An.VK)(e)}.`,o=`syncEnginePromiseResult: ${i}`;return null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`${a}::${o}`,"cdl_worker_diagnostics_logs_error",{errorMessage:a,errors:o},!0),{diagnosticsEvents:[{message:a,level:wI.i.Error,isPiiFree:!0,levelName:"error",timeStamp:new Date},{message:o,level:wI.i.Error,isPiiFree:!0,levelName:"error",timeStamp:new Date}],coreSettingsSnapshot:""}}return{diagnosticsEvents:void 0,coreSettingsSnapshot:""}}))}getSyncEngineInitResultFromCdlWorkerManager(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const e=yield this.cdlWorkerManager.syncEngineInitializationPromise;return JSON.stringify(e)}catch(e){return(0,An.VK)(e)}}))}getSyncEngineLogsFromCdlWorkerManager(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=[];for(const t of(0,a.values)(nR.C))t!==nR.C.NoLog&&t!==nR.C.Diagnostics&&e.push(this.getSyncEngineLogsForTypeFromCdlWorkerManager(t));return Promise.all(e)}))}getSyncEngineLogsForTypeFromCdlWorkerManager(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=this.cdlWorkerManager.workerClientResponseRouter.cdlSyncEngineClient;let n;try{const i=yield t.sendRequest({type:"get_logs",subType:e,params:{conversationId:void 0}});(null==i?void 0:i.response)?n=i.response:(this.logger.warn(`Sync engine logs empty. LogType: ${e}`),n="No logs available.")}catch(e){const t=`Unable to retrieve sync diagnostics logs. ${(0,An.VK)(e)}`;this.logger.error(t),n=t}return{isPiiFree:!1,fileName:`sync-${this.syncEngineLogTypeToFileName(e)}-logs.txt`,content:n}}))}syncEngineLogTypeToFileName(e){switch(e){case nR.C.Messaging:return"messaging";case nR.C.AllConversations:return"all_conversations";case nR.C.People:return"people";case nR.C.Presence:return"presence";case nR.C.Calendar:return"calendar";case nR.C.AppsPlatform:return"apps-platform";case nR.C.Activities:return"activities";case nR.C.ChannelInfoPane:return"channel-info-pane";case nR.C.MTMAAggregator:return"mtma-aggregator";case nR.C.UserPreferences:return"user-preferences";case nR.C.TeamsAndChannels:return"teams-and-channels";case nR.C.Files:return"files";case nR.C.MeetForWork:return"meet-for-work"}}}function rR(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=new tR(e.windowProvider,e.config,e.configLoader,e.loggerFactory,e.scenarioFactory,e.coreSettings,e.coreSettingsContext,e.authenticationService,e.discover,e.platformService,e.clientState,e.hostState,e.primaryUser,null===(t=e.i18NextWrapper)||void 0===t?void 0:t.locale,e.offlineCacheManager,e.authStateProvider,e.cdlWorkerRegistrarService,e.workerId,e.dataClientTrackingService,null===(n=e.altScenarioService)||void 0===n?void 0:n.altScenario);return function(e,t){const n=null==e?void 0:e.altScenario;n&&n.appendEventData({dataStoreName:(0,ID.qo)(t)})}(e.altScenarioService,e.coreSettings),i.getCDLWorkerManager().then((t=>{if(t){const{authenticationService:n,authenticationUser:a,cacheStorage:o,cdlWorkerRegistrarService:r,loggerFactory:s,logsCollectorService:l,workerId:c}=e,d=new oR(t,s.newLogger("CdlWorkerLogsProvider","core-services-tasks"),n,(()=>i.getDataLayerRequestLogs()),o),u=a&&(0,di.b4)(a);l.registerUserLogsProvider(u||"",d),r.registerWorker(c),function(e,t){var n,i;const{enableNetworkStateCommsBetweenCoreAndWorker:a}=e.coreSettings.get(L.J.Core);if(a){const a=n=>{const i={networkState:e.networkState.getState(),baselineNetworkStateOverride:n};t.workerClientResponseRouter.cdlNetworkStateClient.sendRequest(i)},o=e.authenticationUser&&(0,di.b4)(e.authenticationUser)||"",r=null===(i=(n=e.networkState).createNetworkStateTracker)||void 0===i?void 0:i.call(n,o,`CDL Worker EM [${o}]`,a);r&&t.state.setState("networkState:Loaded",r);return function(e,t){return()=>{e.unsubscribe(),t.dispose()}}(e.networkState.observe().subscribe((e=>{const n={networkState:e};t.workerClientResponseRouter.cdlNetworkStateClient.sendRequest(n)})),r)}}(e,t),function(e,t){const{enableEndpointsHealthCommsBetweenCoreAndWorker:n}=e.coreSettings.get(L.J.Core);if(n){const n=e.endpointsHealthService;if(null==n?void 0:n.getEndpointsHealthUpdateHandler){const e=n.getEndpointsHealthUpdateHandler();t.state.setState("endpointsHealthUpdateHandler:Loaded",e),e.onStateDumpRequest((()=>{const e="get_health_state";t.workerClientResponseRouter.cdlEndpointsHealthClient.sendRequest(e)}))}}}(e,t),function(e){(0,pT.G)().setCdlContextCallback(((t,n,i)=>{e.workerClientResponseRouter.telemetryClient.sendRequest({requestOperationtype:"setContext",context:{[t]:n},userContextId:i})}))}(t)}})),yield(0,EA._)(1),i}))}function sR(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield lR(e);return!!n&&!!t&&n.id===t.id}))}function lR(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield null===(t=null==e?void 0:e.getCachedUsers)||void 0===t?void 0:t.call(e,Object.assign(Object.assign({},FC({source:kt.D.Core})),{scenarioName:it.RG.AuthWebCachedUser}),{isPrimaryUser:!0}),i=null==n?void 0:n[0];if(i)return(0,di.KQ)(i)}))}class cR extends fe{constructor(){super(he.Yg.CreateCDLWorkerOnAuthUserTask,["altScenarioService","authenticationService","clientState","config","configLoader","coreSettings","coreSettingsContext","diagnosticsService","discover","endpointsHealthService","hostState","i18NextWrapper","loggerFactory","logsCollectorService","networkState","platformService","scenarioFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{altScenarioService:t,authenticationService:n,clientState:a,config:o,configLoader:r,coreSettings:s,coreSettingsContext:l,diagnosticsService:c,discover:d,endpointsHealthService:u,hostState:m,i18NextWrapper:g,loggerFactory:p,logsCollectorService:v,networkState:h,platformService:f,scenarioFactory:y,windowProvider:b}=e,{authenticationUser:S,authStateProvider:k,cacheStorage:w,cdlWorkerRegistrarService:C,dataClientTrackingService:_,offlineCacheManager:T}=e,I=p.newLogger("CreateCDLWorkerOnAuthUserTask","core-services-tasks"),E=(0,ID.Q6)(s),{enableMTMA:N,disableExperience:A}=s.get(L.J.Core);if(!E||!N)return I.warn(`Not creating worker as cdl worker or mtma is not enabled. isCdlWorkerEnabled: ${E}, isMTMAEnabled: ${N}`),Promise.resolve();if(!S||!C)return I.warn("Not creating worker as authenticated user is not available or cdl worker registrar service is undefined."),Promise.resolve();if(A)return I.warn("Not creating worker as experience is disabled for the user."),Promise.resolve();const F=null==S?void 0:S.id;if(C.isWorkerRegistered(F)||C.useInitTaskWorker)return I.log(`Not creating a worker as we already have created worker workerId: ${F} for the user oid: ${S.profile.objectId},\n         tid: ${S.profile.tenantId}`),void(C.useInitTaskWorker=!1);let D;return I.log(`Creating a worker with id: ${F} for the user oid: ${S.profile.objectId},\n       tid: ${S.profile.tenantId}`),N&&(D=yield lR(n)),e.cdlWorkerService=yield rR({altScenarioService:t,authenticationService:n,authenticationUser:S,authStateProvider:k,cacheStorage:w,cdlWorkerRegistrarService:C,clientState:a,config:o,configLoader:r,coreSettings:s,coreSettingsContext:l,dataClientTrackingService:_,diagnosticsService:c,discover:d,endpointsHealthService:u,hostState:m,i18NextWrapper:g,loggerFactory:p,logsCollectorService:v,networkState:h,offlineCacheManager:T,platformService:f,primaryUser:D,scenarioFactory:y,windowProvider:b,workerId:F}),e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t;switch(e){case"signout":null===(t=C.activeWorkers)||void 0===t||t.delete(F);break;default:return}}))}))}}class dR extends fe{constructor(){super(he.Yg.CreateCDLWorkerOnInitTask,["altScenarioService","authenticationService","clientState","config","configLoader","coreSettings","coreSettingsContext","diagnosticsService","discover","endpointsHealthService","hostState","i18NextWrapper","loggerFactory","logsCollectorService","networkState","platformService","scenarioFactory","windowProvider","cdlWorkerRegistrarService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{altScenarioService:t,authenticationService:n,clientState:i,config:a,configLoader:o,coreSettings:r,coreSettingsContext:s,diagnosticsService:l,discover:c,endpointsHealthService:d,hostState:u,i18NextWrapper:m,loggerFactory:g,logsCollectorService:p,networkState:v,platformService:h,scenarioFactory:f,windowProvider:y,cdlWorkerRegistrarService:b}=e,{authenticationUser:S,authStateProvider:k,cacheStorage:w,dataClientTrackingService:C,offlineCacheManager:_}=e,T=g.newLogger("CreateCDLWorkerOnInitTask","core-services-tasks");if(!(0,ID.Q6)(r))return void T.warn("Not creating worker as CDL worker is not enabled");const I=S?S.id:(0,Ye.v4)();let E;const{enableMTMA:N}=r.get(L.J.Core);if(N){if(!b)return void T.warn("Not creating worker as cdlWorkerRegistrarService is undefined");T.log(`Creating CDL worker with id ${I} for user oid:${null==S?void 0:S.profile.objectId}, tid: ${null==S?void 0:S.profile.tenantId}`),E=yield lR(n)}else T.log("MTMA is not enabled. Creating a CDL worker with default workerId");e.cdlWorkerService=yield rR({altScenarioService:t,authenticationService:n,authenticationUser:S,authStateProvider:k,cacheStorage:w,cdlWorkerRegistrarService:b,clientState:i,config:a,configLoader:o,coreSettings:r,coreSettingsContext:s,dataClientTrackingService:C,diagnosticsService:l,discover:c,endpointsHealthService:d,hostState:u,i18NextWrapper:m,loggerFactory:g,logsCollectorService:p,networkState:v,offlineCacheManager:_,platformService:h,primaryUser:E,scenarioFactory:f,windowProvider:y,workerId:I})}))}}var uR,mR=n(595068);class gR{constructor({loggerFactory:e}){this.initTaskWorkerId="",this.mainWindowWorkerId=void 0,this.useInitTaskWorker=!0,this.activeWorkers=new Set,this.userRegisteredActiveWorkers=new Map,this.formatUserId=e=>e.replace(mR.V.User,""),this.logger=e.newLogger("DataClientCoreCDLWorkerRegistrarService","core-services-cdl-worker")}setMainWindowWorkerByUserId(e){var t,n;e=this.formatUserId(e),this.userRegisteredActiveWorkers.has(e)?this.mainWindowWorkerId=this.userRegisteredActiveWorkers.get(e):null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`No registered active worker for user id ${e}`,"cdl_registrar_service_no_registered_active_worker",void 0,!0)}isWorkerRegistered(e){return this.activeWorkers.has(e)}mapUserIdToRegisteredWorker(e,t){var n,i;t=this.formatUserId(t),this.isWorkerRegistered(e)||(null===(i=(n=this.logger).warnToTelemetry)||void 0===i||i.call(n,`${e} wasn't tracked yet was registered to active user. Tracking worker.`,"cdl_registrar_service_map_user_worker_not_registered",void 0,!0),this.registerWorker(e)),this.userRegisteredActiveWorkers.set(t,e)}registerWorker(e){var t,n;this.isWorkerRegistered(e)?null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`${e} is already being tracked by cdl worker registrar service; skipping.`,"cdl_registrar_service_worker_already_registered",void 0,!0):(this.activeWorkers.add(e),this.initTaskWorkerId||(this.initTaskWorkerId=e,this.mainWindowWorkerId=e))}}class pR extends fe{constructor(){super(he.Yg.CreateCDLWorkerRegistrarServiceTask,["loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t}=e;return e.cdlWorkerRegistrarService=new gR({loggerFactory:t}),Promise.resolve()}))}}!function(e){e.LifeCycleScopeChange="LifeCycleScopeChange"}(uR||(uR={}));class vR extends fe{constructor(){super(he.Yg.CreateChangeReporting,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.schedulerChangeReporting=new tE,e.experienceChangeReportingService=new tE,e.lifeCycleScopeChangeReportingService=new tE,e.commandResultChangeReportingService=new tE,e.commandChangeReportingService=new tE}))}}var hR=n(961993);class fR extends fe{constructor(){super(he.Yg.CreateClientPreferences,["localStorage","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{localStorage:t,loggerFactory:n}=e;e.clientPreferences=new hR.l(n,{set:(e,n)=>t.set(e,n,Ct.f.Experience),get:e=>t.get(e,Ct.f.Experience)})}))}}class yR extends fe{constructor(){super(he.Yg.CreateCommandDelegator,["appsRegistryService","client","clientPreferences","commandChangeReportingService","coreSettings","loggerFactory","scenarioFactory","userBiService","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,clientPreferences:i,commandChangeReportingService:a,coreSettings:o,loggerFactory:r,scenarioFactory:s,userBiService:l,windowProvider:c}=e;e.commandDelegator=(e,d)=>p_({appsRegistryService:t,client:n,clientPreferences:i,commandChangeReportingService:a,commandHandler:d,commandInput:e,coreSettings:o,loggerFactory:r,scenarioFactory:s,host:c,userBiService:l})}))}}class bR extends fe{constructor(){super(he.Yg.CreateCommandHandler,["appsRegistryService","client","commandChangeReportingService","coreSettings","loggerFactory","platformService","scenarioFactory","userBiService","notificationsHandler"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandChangeReportingService:i,coreSettings:a,loggerFactory:o,platformService:r,scenarioFactory:s,userBiService:l,notificationsHandler:c}=e;e.commandHandler=(e,d)=>nT({appsRegistryService:t,client:n,commandChangeReportingService:i,coreSettings:a,entityCommandInput:e,loggerFactory:o,platformService:r,scenarioFactory:s,clientLaunchId:d,userBiService:l,notificationsHandler:c})}))}}const SR=[wC.B.Abandoned,wC.B.Close,wC.B.IntentTransferredCrossCloud],kR=[wC.B.Incomplete,wC.B.WindowNotUpdated],wR=[wC.B.Blanked,wC.B.CommandHandledByOnCommandReceived,wC.B.CommandHandledPriorToResolution,wC.B.EventHandled,wC.B.Hidden,wC.B.LayoutRendered,wC.B.LayoutRenderUpdated,wC.B.NotHandled,wC.B.Toggled],CR=[wC.B.Failure,wC.B.SlotPhasedRenderingTimedOut];function _R(e){switch(e){case wC.B.ApplicationHookReceivedCommand:case wC.B.CommandBeforeGetAppViewEntities:case wC.B.RenderStarted:case wC.B.ChunkLoadStarted:case wC.B.ChunkLoadSucceeded:case wC.B.Rendered:return!0;default:return!1}}const TR={[it.RG.ClientStart]:24e4},IR="command-result-service";class ER{constructor(e,t,n,i){this.commandChangeReportingService=t,this.commandResultChangeReportingService=n,this.host=i,this.logger=e.newLogger(IR,"core-services-entity-commanding"),this.pendingCommands=new Map}init(){this.commandChangeSubscription=this.setUpCommandChangeSubscriptions()}destroy(){var e;this.pendingCommands.clear(),null===(e=this.commandChangeSubscription)||void 0===e||e.unsubscribe()}registerForCommandTimeOut(e,t){const n=this.pendingCommands.get(e);n&&(n.onCommandTimeOut=t)}unRegisterForCommandTimeOut(e){const t=this.pendingCommands.get(e);t&&(t.onCommandTimeOut=void 0)}onCommandChange(e){switch(e.type){case wC.B.ScenarioEventDataAppended:case wC.B.ScenarioMarked:case wC.B.Rendered:break;case wC.B.CommandMetaDataAdded:{const{context:{contentExistsAndHasChanged:t},correlationId:n}=e,i=this.pendingCommands.get(n);i&&void 0!==t&&(this.logger.log(`CommandMetaDataAdded: contentExistsAndHasChanged=${t}`),i.contentExistsAndHasChanged=t);break}case wC.B.DelegatedCommandReceived:case wC.B.EventBubbled:{const{context:{correlation:t},correlationId:n}=e;let i=this.pendingCommands.get(n);i||(i=this.createPendingCommand({correlation:t}),this.pendingCommands.set(n,i));break}case wC.B.CommandStart:{const{correlationId:t,context:{entityCommand:n},userContextId:i}=e;let a=this.pendingCommands.get(t);a?a.entityCommand=n:a=this.createPendingCommand({entityCommand:n,userContextId:i}),this.pendingCommands.set(t,a);break}case wC.B.NavigationCommandStart:{const{correlationId:t,context:{correlation:n},userContextId:i}=e;let a=this.pendingCommands.get(t);a||(a=this.createPendingCommand({correlation:n,userContextId:i})),this.pendingCommands.set(t,a);break}case wC.B.Incomplete:case wC.B.Failure:{const{correlationId:t,context:{errorInfo:n,errorMessage:i,showOops:a,eventData:o},userContextId:r}=e,s=this.pendingCommands.get(t);s&&this.calculateCommandResult(s,e.type,r,{errorInfo:n,errorMessage:i,showOops:a,eventData:o});break}default:{const{type:t,correlationId:n,context:{eventData:i}}=e,a=this.pendingCommands.get(n);if(a&&a.previousEvents.has(t))break;a&&this.calculateCommandResult(a,e.type,e.userContextId,{eventData:i});break}}}createPendingCommand({correlation:e,entityCommand:t,userContextId:n}){if(!(e=null!=e?e:null==t?void 0:t.command.correlation)){const e=new Error("correlation cannot be undefined. A valid entityCommand or correlation should be passed.");throw this.logger.errorToTelemetry&&this.logger.errorToTelemetry(e.message,"webclient_framework_foundation_command_reporting_service_event",void 0,!0),e}const i=e.id,a=this.host.setTimeout(this.getCommandTimeoutHandler(i,n),this.getCommandTimeout(e));return{contentExistsAndHasChanged:void 0,correlation:e,entityCommand:t,previousEvents:new Set,timeoutId:a}}getCommandTimeoutHandler(e,t){return()=>{var n;const i=this.pendingCommands.get(e);if(i){const{previousStep:a}=i,o=function(e){return e&&_R(e)?CC.y.TimeoutRunningApp:CC.y.TimeoutRunningCore}(a);null===(n=i.onCommandTimeOut)||void 0===n||n.call(i),this.logger.error(`Command error, correlationId: ${e}, reason ${o}, previousStep: ${a}`),this.onCommandResult(Ta.Failure,e,o,a,t,{errorCode:o})}}}setUpCommandChangeSubscriptions(){return this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e)))}getCommandTimeout({id:e,scenarioName:t}){return t&&TR[t]?(this.logger.log(`Increasing the command timeout (${TR[t]}) during ${t}, correlationId: ${e}`),TR[t]):12e4}calculateCommandResult(e,t,n,i){var a;const{previousStep:o,correlation:{id:r}}=e;if(e.previousEvents.add(t),e.previousStep=t,function(e){return wR.includes(e)}(t))this.onCommandResult(Ta.Success,r,t,o,n,{eventData:null==i?void 0:i.eventData});else if(function(e){return CR.includes(e)}(t)){const e=(s=t,l=null==i?void 0:i.errorInfo,s===wC.B.SlotPhasedRenderingTimedOut?CC.y.SlotPhasedRenderingTimedOut:l||CC.y.UnknownCommandError),c=(null==i?void 0:i.errorMessage)||(null===(a=null==i?void 0:i.eventData)||void 0===a?void 0:a.errors);this.logger.error(`Command error, correlationId: ${r}, reason ${e}, previousStep: ${o}`),this.onCommandResult(Ta.Failure,r,e,o,n,{errorCode:e,errorMessage:c,eventData:null==i?void 0:i.eventData})}else if(function(e,t){return e===wC.B.RenderStarted&&!1===t}(t,e.contentExistsAndHasChanged)){const e=CC.y.AlreadyRendered;this.onCommandResult(Ta.Incomplete,r,e,o,n,{errorCode:e,eventData:null==i?void 0:i.eventData})}else if(function(e){return SR.includes(e)}(t)){const e=function(e,t){return e===wC.B.Close?t&&_R(t)?CC.y.WindowCloseRunningApp:CC.y.WindowCloseRunningCore:e===wC.B.Abandoned?wC.B.Abandoned:CC.y.UnknownCommandError}(t,o);this.onCommandResult(Ta.Canceled,r,e,o,n,{errorCode:e,eventData:null==i?void 0:i.eventData}),this.logger.error(`Command abandoned, correlationId: ${r}, reason ${e}, previousStep: ${o}`)}else if(function(e){return kR.includes(e)}(t)){const e=(null==i?void 0:i.errorInfo)||t;this.onCommandResult(Ta.Incomplete,r,e,o,n,{errorCode:e,eventData:null==i?void 0:i.eventData}),this.logger.error(`Command incomplete, correlationId: ${r}, reason ${t}, previousStep: ${o}`)}var s,l}onCommandResult(e,t,n,i,a,o){const r=this.pendingCommands.get(t);r&&(this.reportCommandResult(t,a,e,n,i,r,o),this.cleanUpPendingCommand(t,r))}cleanUpPendingCommand(e,{timeoutId:t}){this.host.clearTimeout(t),this.pendingCommands.delete(e)}reportCommandResult(e,t,n,i,a,o,r){const{entityCommand:s}=o;this.commandResultChangeReportingService.report({correlationId:e,userContextId:t,context:{entityCommand:s,error:(null==r?void 0:r.errorCode)||(null==r?void 0:r.errorMessage)?{errorCode:null==r?void 0:r.errorCode,errorMessage:null==r?void 0:r.errorMessage}:void 0,previousStep:a,reason:i,target:IR,eventData:null==r?void 0:r.eventData},type:n})}}var NR;!function(e){e.ExpLoader="ExpLoader",e.Core="Core",e.App="App"}(NR||(NR={}));const AR={eventId:"executeEntityCommand"};function FR(e,t,n,i){const{replyContent:a}=e,{id:o,type:r}=t;if(i)switch(r){case u.p.chats:return function({actionType:e,convId:t,userContextId:n,toastType:i},a,o){let r=er.unknown;switch(e){case"quickReply":r=er.quickReply;break;default:const e=`HostComms:: ${li.f.RequiredFieldMissing} Toast activation command received from host with unknown chats action Type`;o.errorToTelemetry&&o.errorToTelemetry(e,"webclient_framework_host_comms",void 0,!0)}return{actionType:r,convId:t||void 0,message:a,userContextId:n,toastType:i}}(i,a,n);case u.p.calls:return function({actionType:e,userContextId:t,toastType:n},i,a){return e||(a.errorToTelemetry&&a.errorToTelemetry(`HostComms:: ${li.f.RequiredFieldMissing} Toast activation command received from host with unknown calls action type`,"webclient_framework_host_comms",void 0,!0),e="Unknown"),{actionType:e,toastId:i||void 0,toastType:n,userContextId:t}}(i,o,n);case u.p.communities:return function({actionType:e,userContextId:t,toastType:n,teamId:i,messageId:a},o){return n||(o.errorToTelemetry&&o.errorToTelemetry(`HostComms:: ${li.f.RequiredFieldMissing} Toast activation command received from host with unknown communities toast type`,"webclient_framework_host_comms",void 0,!0),n="Unknown"),{actionType:e,toastType:n,userContextId:t,messageId:a,teamId:i}}(i,n);default:return void(n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${li.f.RequiredFieldMissing} Unkown target entity type received from host for toast activation command`,"webclient_framework_host_comms",void 0,!0))}else n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${li.f.RequiredFieldMissing} Toast activation command received from host without target host entity options`,"webclient_framework_host_comms",void 0,!0)}function DR(e,t){switch(e){case Wn.mutate:return u.u.mutate;case Wn.view:return u.u.view;case Wn.list:return u.u.list;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${li.f.RequiredFieldMissing} Toast activation command received from host with unknown entity action. Defaulting to view.`,"webclient_framework_host_comms",void 0,!0),u.u.view}}function RR(e,t){const{entity:n,entityOptions:i,command:a}=e,{visibilityState:o,correlation:r}=a,{id:s,startTimestamp:l,source:c}=r,d=null==i?void 0:i.toastActivationEntityOptions;if(t.log(`Converting host entity command, type ${null==n?void 0:n.type}, action ${null==n?void 0:n.action}, id ${null==n?void 0:n.id}`),t.log(`toastActivationEntityOptions ${d}, visibilityState ${o}`),!d)return AR;if(!n)return AR;const{optionsJson:u}=n,m=function(e,t){const{id:n,type:i,action:a,linkedEntity:o}=e;return{action:DR(a,t),id:n,linkedEntity:VR(o,t),type:MR(i,t)}}(n,t),g=u?(0,Bt.D)(u,void 0):void 0;return Object.assign(Object.assign({},AR),{payload:{entity:m,command:{visibilityState:OR(o,t),correlation:{id:s,startTimestamp:l?l.getTime():void 0,source:c,scenarioName:it.RG.ToastActivation},stateTransition:zR(n.type,t)},entityOptions:xR(g),dataOptions:n.action===Wn.mutate||n.type===$n.communities||n.type===$n.reminders?FR(d,m,t,g):{userContextId:g.userContextId}}})}function xR(e){if(null==e?void 0:e.deepLinkId)return{deepLinkId:e.deepLinkId};if(null==e?void 0:e.campaignType)return{campaignType:e.campaignType};if(!(null==e?void 0:e.messageId))return;const{messageId:t,focusOnLoad:n}=e;return{messageId:t,focusOnLoad:n}}function MR(e,t){switch(e){case $n.chats:case $n.reminders:return u.p.chats;case $n.calls:return u.p.calls;case $n.extensions:return u.p.extensions;case $n.activity:return u.p.activity;case $n.campaignnotifications:return u.p.campaignnotifications;case $n.channels:return u.p.channels;case $n.communities:return u.p.communities;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${li.f.RequiredFieldMissing} Toast activation command received from host with unknown entity type. Defaulting to chats`,"webclient_framework_host_comms",void 0,!0),u.p.chats}}function OR(e,t){switch(e){case Bn.show:return d.fe.show;case Bn.hide:return d.fe.hide;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${li.f.RequiredFieldMissing} Toast activation command received from host with unknown visibility state. Defaulting to show`,"webclient_framework_host_comms",void 0,!0),d.fe.show}}function PR(e,t){var n;const{command:i}=e,{correlation:a,visibilityState:o}=i;let r;return(null==a?void 0:a.startTimestamp)&&(r=new Date(+a.startTimestamp),r=JR(r)?r:void 0),{correlation:{id:null!==(n=null==a?void 0:a.id)&&void 0!==n?n:(0,Ye.v4)(),startTimestamp:r,source:jn.toastFromWeb},visibilityState:HR(o,t)}}function LR(e,t){try{const{entity:n}=e,{action:i,id:a,type:o}=n;return{action:UR(i,t),id:a,type:BR(o)}}catch(e){throw t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${(0,wi.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),e}}function UR(e,t){switch(e){case u.u.mutate:return Wn.mutate;case u.u.view:return Wn.view;case u.u.list:return Wn.list;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${li.f.RequiredFieldMissing}: EntityAction. Defaulting to HostEntityAction.view`,"webclient_framework_host_comms",void 0,!0),Wn.view}}function jR(e){const{id:t,linkedEntity:n,action:i,type:a,dataOptions:o}=e;return{action:i,id:t,linkedEntity:n,type:a,optionsJson:(0,wi.u4)(o)}}function $R(e){!function(e){if(!e)throw(0,An.Tr)(he.w5.Commanding,li.f.RequiredFieldMissing,u.p.toasts,void 0,`${li.f.RequiredFieldMissing}: entityOptions`);const t=e;if(!(t.targetEntity&&t.targetEntity.action&&t.targetEntity.type&&t.targetEntity.dataOptions&&t.time&&(t.title||""===t.title)))throw(0,An.Tr)(he.w5.Commanding,li.f.RequiredFieldMissing,u.p.toasts,void 0,`${li.f.RequiredFieldMissing}: hostEntityOptions?.toastEntityOptions`)}(e);const{buttons:t,targetEntity:n,textInput:i,time:a,isUrgent:o,bypassOsLevelDoNotDisturb:r}=e;return{toastEntityOptions:Object.assign(Object.assign({},e),{isUrgent:o||r,targetEntity:jR(n),time:a,buttons:GR(t),textInput:WR(i)})}}function BR(e){switch(e){case u.p.toasts:return $n.toasts;default:throw(0,An.Tr)(he.w5.Commanding,li.f.RequiredFieldMissing,u.p.toasts,void 0,`${li.f.RequiredFieldMissing}: EntityType`)}}function WR(e){if(!e)return;const{placeholderText:t,sendButton:n}=e;return{placeholderText:t,sendButton:n?qR(n):void 0}}function HR(e,t){switch(e){case d.fe.hide:return Bn.hide;case d.fe.show:return Bn.show;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${li.f.RequiredFieldMissing}: EntityVisibilityState. Defaulting to HostEntityVisibilityState.show`,"webclient_framework_host_comms",void 0,!0),Bn.show}}function VR(e,t){if(!e)return;const{id:n,type:i,action:a}=e;return{action:a?DR(a,t):void 0,id:n,type:MR(i,t)}}function zR(e,t){switch(e){case $n.chats:case $n.channels:return d.su.new;case $n.calls:case $n.campaignnotifications:return d.su.new;case $n.extensions:case $n.reminders:case $n.activity:case $n.communities:return d.su.flush;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${li.f.RequiredFieldMissing} Toast activation command received from host with unhandled host entity type - ${e}.`,"webclient_framework_host_comms",void 0,!0),d.su.new}}function qR(e){const{image:t,targetEntity:n,text:i,preferImageOnly:a,style:o}=e;return{image:t,preferImageOnly:a,style:o,targetEntity:jR(n),text:i}}function GR(e){if(e)return e.map(qR)}const JR=e=>e instanceof Date&&!isNaN(e.getTime());function QR(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e.entity.type!==u.p.toasts)return;let r,s,l;if((null===(o=e.command.correlation)||void 0===o?void 0:o.id)&&(r=a.findScenarioByNameAndId(it.RG.CrossClientToastView,e.command.correlation.id),s=a.findScenarioByNameAndId(it.RG.WebToastShow,e.command.correlation.id)),e.entityOptions){const t=e.entityOptions;(null==t?void 0:t.crossClientScenarioName)&&(null==t?void 0:t.callId)&&(l=a.findScenarioByNameAndId(null==t?void 0:t.crossClientScenarioName,null==t?void 0:t.callId))}const c=yield function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let n;try{n=yield e.loadModule("core"),t.log(`HostComms:: ${XN.LoadModuleCoreSuccess}`)}catch(e){const n=`HostComms:: ${YN.LoadModuleCoreFailed} ${(0,wi.u4)(e)}`;t.errorToTelemetry&&t.errorToTelemetry(n,"webclient_framework_host_comms",void 0,!0)}return n}))}(t,n);if(!c||!c.executeCommand)return n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${YN.LoadModuleCoreFailed}`,"webclient_framework_host_comms",void 0,!0),null==r||r.fail({errorCode:YN.LoadModuleCoreFailed}),null==s||s.fail({errorCode:YN.LoadModuleCoreFailed}),void(null==l||l.fail({errorCode:YN.LoadModuleCoreFailed}));try{const t=function(e,t){return{command:PR(e,t),entity:LR(e,t),entityOptions:$R(null==e?void 0:e.entityOptions)}}(e,n);yield null==c?void 0:c.executeCommand(t),n.log(`HostComms:: ${XN.ExecuteCommandSuccess}`),null==r||r.mark(it.ck.CrossClientHostEventSent),null==l||l.mark(it.ck.CrossClientHostEventSent),null==s||s.stop()}catch(e){n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${YN.ExecuteCommandFailed} ${(0,wi.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),null==r||r.fail({errorCode:YN.ExecuteCommandFailed}),null==s||s.fail({errorCode:YN.ExecuteCommandFailed}),null==l||l.fail({errorCode:YN.ExecuteCommandFailed})}}))}class KR{constructor(e,t,n,i){this.commandChangeReportingService=e,this.commandResultChangeReportingService=t,this.scenarioFactory=n,this.pendingCommands=new Map,this.logger=i.newLogger("CommandTelemetryService","core-services-entity-commanding"),this.commandSequence=0}init(){this.commandChangeSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e))),this.commandResultChangeSubscription=this.commandResultChangeReportingService.observeChanges().subscribe((e=>this.onCommandResultChange(e)))}destroy(){var e,t,n;this.pendingCommands.clear(),null===(e=this.commandChangeSubscription)||void 0===e||e.unsubscribe(),null===(t=this.commandResultChangeSubscription)||void 0===t||t.unsubscribe(),null===(n=this.lifeCycleScopeChangeSubscription)||void 0===n||n.unsubscribe()}onCommandChange(e){switch(e.type){case wC.B.ScenarioEventDataAppended:{const{correlationId:t,context:{eventData:n}}=e;this.appendScenarioEventData(t,n);break}case wC.B.ScenarioMarked:{const{correlationId:t,context:{step:n,eventData:i,status:a,monitoringData:o}}=e;this.addScenarioMark(t,n,e.type,i,a,o);break}case wC.B.Rendered:case wC.B.CommandMetaDataAdded:break;case wC.B.DelegatedCommandReceived:case wC.B.EventBubbled:{const{context:{correlation:t}}=e;this.startCommandTelemetry(t.id,{correlation:t});break}case wC.B.CommandStart:{const{correlationId:t,context:{entityCommand:n}}=e,{scenarioEventData:i}=n;this.startCommandTelemetry(t,{entityCommand:n}),i&&this.appendScenarioEventData(t,i);break}case wC.B.NavigationCommandStart:{const{correlationId:t,context:{clientLaunchId:n,correlation:i,eventData:a}}=e;this.startCommandTelemetry(t,{correlation:i,clientLaunchId:n}),a&&this.appendScenarioEventData(t,a);break}default:{const{type:t,correlationId:n,context:{eventData:i}}=e,a=this.pendingCommands.get(n);if(a&&a.previousEvents.has(t))break;null==a||a.previousEvents.add(t),_R(t)&&(null==a||a.commandScenario.appendEventData({scenarioPhase:NR.App})),i&&this.appendScenarioEventData(n,i),this.addScenarioMark(n,t,t,i);break}}}findExistingNavigationCommandScenario(e,t){const n=t.scenarioName||it.RG.NavigationCommand;let i=this.scenarioFactory.findScenarioByNameAndId(n,e);return(null==i?void 0:i.eventData["EventInfo.CorrelationId"])!==t.id&&(i=null),i||t.scenarioName!==it.RG.ClientStart||(i=this.scenarioFactory.findScenario(it.RG.ClientStart)),i||void 0}findExistingActivitySwitchScenario(e){const t=null==e?void 0:e.id;if((null==e?void 0:e.source)===kt.D.ActivityFeedBellClick){const e=Array.from(this.pendingCommands.values());for(const n of e)if(n.correlation.scenarioName===it.RG.ActivitySwitch||n.correlation.scenarioName===it.RG.NavigationCommand){const e=n.correlation.id;this.logger.log(`Command was sent by activity app as a result of a bell click, correlationId ${t}. Combining scenario with existing activity_switch of correlationId ${e}`);const i=n.commandScenario;return this.pendingCommands.delete(e),i}}}startCommandTelemetry(e,{entityCommand:t,correlation:n,clientLaunchId:i}){let a,o=this.pendingCommands.get(e);i&&n&&(a=this.findExistingNavigationCommandScenario(i,n)),a||(a=this.findExistingActivitySwitchScenario(n||(null==t?void 0:t.command.correlation))),o?t&&(this.logger.log(`Updating command\n\tscenarioName: ${o.commandScenario.name}\n\tcorrelationId: ${e}\n\tentityType: ${t.entity.type}\n\tentityAction: ${t.entity.action}`),o.commandScenario.appendEventData({mainEntityAction:t.entity.action,mainEntityType:t.entity.type})):o=this.createPendingCommand(e,{commandScenario:a,entityCommand:t,correlation:n,clientLaunchId:i}),this.pendingCommands.set(e,o)}createPendingCommand(e,{entityCommand:t,correlation:n,clientLaunchId:i,commandScenario:a}){var o;if(!(n=null!=n?n:null==t?void 0:t.command.correlation)){const e=new Error("correlation cannot be undefined. A valid entityCommand or correlation should be passed.");throw this.logger.errorToTelemetry&&this.logger.errorToTelemetry(e.message,"webclient_framework_foundation_command_reporting_service_event",void 0,!0),e}if(n.scenarioName=null!==(o=n.scenarioName)&&void 0!==o?o:it.RG.EntityCommand,!a){this.logger.log(`Creating new scenario with scenarioName: ${n.scenarioName}, correlationId ${e}`);const{startTimestamp:o}=n,r=o&&JR(new Date(+o))?+o:void 0;a=this.scenarioFactory.newScenario(n.scenarioName,{startTime:r}),void 0!==i&&(a.clientId=i),a.appendEventData({"EventInfo.CorrelationId":e,commandSequence:++this.commandSequence,commandSource:n.source,mainEntityAction:null==t?void 0:t.entity.action,mainEntityType:null==t?void 0:t.entity.type,scenarioPhase:NR.Core})}return this.logger.log(`Starting to track a new command\n\tscenarioName: ${n.scenarioName}\n\tcorrelationId: ${e}\n\tentityType: ${null==t?void 0:t.entity.type}\n\tentityAction: ${null==t?void 0:t.entity.action}`),{correlation:n,commandScenario:a,previousEvents:new Set}}appendScenarioEventData(e,t){const n=this.pendingCommands.get(e);n&&n.commandScenario.appendEventData((0,a.omitBy)(t,a.isUndefined))}addScenarioMark(e,t,n,i,o,r){const s=this.pendingCommands.get(e);s&&(n!==wC.B.ScenarioMarked&&this.logger.log(`${s.commandScenario.name} addScenarioMark, correlationId: ${e}, step: ${t}, eventData: ${JSON.stringify(i)}`),s.commandScenario.mark(t,i&&(0,a.omitBy)(i,a.isUndefined),o,r))}onCommandResultChange(e){const{context:{error:t,reason:n,previousStep:i,eventData:o,entityCommand:r},correlationId:s,type:l}=e,c=this.pendingCommands.get(s);if(!c)return void this.logger.error(`Command Result of ${n} and correlationId ${s} was reported but no pending command was found`);const d=null==c?void 0:c.commandScenario,u=(0,a.omitBy)(r&&KR.overrideMainEntityForExtensionCommand(o,r)||o,a.isUndefined);switch(l){case Ta.Canceled:{const{errorCode:e}=t||{};this.logger.warn(`${d.name} Cancelled, correlationId: ${s}, reason: ${e}, previousStep: ${i}`),d.cancel(Object.assign({errorCode:e,reason:e},u));break}case Ta.Failure:{const{errorCode:e,errorMessage:n}=t||{};this.logger.error(`${d.name} Failed, correlationId: ${s}, reason: ${e}, errorMessage: ${n}, previousStep: ${i}`),d.fail(Object.assign({errorCode:e,reason:e,errors:n&&(0,la.A)(n)},u));break}case Ta.Incomplete:{const{errorCode:e}=t||{};this.logger.warn(`${d.name} Incomplete, correlationId: ${s}, reason: ${e}, previousStep: ${i}`),d.incomplete(Object.assign({errorCode:e,reason:e},u));break}case Ta.Success:this.logger.log(`${d.name} Successful, correlationId: ${s}, reason: ${n}, previousStep: ${i}`),d.stop(Object.assign({reason:n},u))}this.pendingCommands.delete(s)}static overrideMainEntityForExtensionCommand(e,t){return t.command.stateTransition!==d.su.extend?e:Object.assign(Object.assign({},e),{modalEntityType:t.entity.type,modalEntityAction:t.entity.action})}}const YR=[wC.B.ApplicationHookReceivedCommand,wC.B.ApplicationHookContinuedCommand],XR=[wC.B.ChunkLoadStarted,wC.B.ChunkLoadSucceeded,wC.B.ScenarioEventDataAppended,wC.B.ScenarioMarked];class ZR{constructor(e,t){this._host=t,this.commandTimedOutAtHostHandler=e=>{const{correlationId:t,reason:n}=e.payload,i=this._pendingCommands.get(t);i&&(i.onCommandTimeOut&&i.onCommandTimeOut(n),this.cleanUpPendingCommand(t))},this._logger=e.newLogger("CommandReportingServiceHybrid","core-services-entity-commanding"),this._pendingCommands=new Map,this._host.opener.addEventListener(n_.rY.EntityCommandTimedOutAtHost,this.commandTimedOutAtHostHandler)}registerNavigationCommandStart(){}registerCommandStart(e){var t;const n=e.command.correlation.id;if(!n)return void this._logger.error("registerCommandStart called without a command correlation id");const i=this._pendingCommands.get(n);i&&(this._logger.log(`registerCommandStart called with a pending command with correlation id ${n}, overwriting and starting new timeout interval`),this._host.clearTimeout(i.timeoutId));const a=null===(t=null==i?void 0:i.entityCommand.entityOptions)||void 0===t?void 0:t.timeout,o=a||9e4,r=this._host.setTimeout((()=>{this.reportCommandEvent(n,wC.B.CommandReportingTimedOut),this.cleanUpPendingCommand(n)}),o);this._logger.log(`Starting to track command with correlation Id ${n}`),this._pendingCommands.set(n,{entityCommand:e,timeoutId:r,previousEvents:new Set})}appendCommandEventData(e,t){const n=this._pendingCommands.get(e);n?this._pendingCommands.set(e,Object.assign(Object.assign({},n),{eventData:Object.assign(Object.assign({},n.eventData),t)})):this._logger.warn(`appendCommandEventData called with correlationId ${e}, but there was no such pending command`)}reportCommandEvent(e,t,n,i,a,o){const r=this._pendingCommands.get(e);if(!r)return;if(!XR.includes(t)&&r.previousEvents.has(t))return;r.previousEvents.add(t);const{entityCommand:s,eventData:l}=r,c=Object.assign(Object.assign(Object.assign({entityCommand:s,commandEvent:t},l),n),{timestamp:Date.now(),scenarioEventData:i,step:a,status:o});t===wC.B.CommandReportingTimedOut||YR.includes(t)||this._logger.log(`Command event reported ${t} for correlation id ${e}`),YR.includes(t)||this._host.opener.postMessage(Hw.W.CommandChangeType,c)}registerForCommandTimeOut(e,t){const n=this._pendingCommands.get(e);n&&(n.onCommandTimeOut=t)}unRegisterForCommandTimeOut(e){const t=this._pendingCommands.get(e);t&&(t.onCommandTimeOut=void 0)}appendScenarioEventData(e,t){this.reportCommandEvent(e,wC.B.ScenarioEventDataAppended,void 0,t)}addScenarioMark(e,t,n,i){this.reportCommandEvent(e,wC.B.ScenarioMarked,void 0,n,t,i)}cleanUpPendingCommand(e){const t=this._pendingCommands.get(e);t&&(this._host.clearTimeout(t.timeoutId),this._pendingCommands.delete(e))}}class ex{constructor(e,t){this.legacyCommandReportingService=e,this.commandChangeReportingService=t,this.commandChangeSubscription=this.setUpCommandChangeSubscriptions()}destroy(){this.commandChangeSubscription.unsubscribe()}changeToCommandReportingService(e){switch(e.type){case wC.B.AfterOnCommandReceived:case wC.B.AfterOnEventReceived:case wC.B.BeforeOnCommandReceived:case wC.B.BeforeOnEventReceived:case wC.B.CommandHandledByOnCommandReceived:case wC.B.EventBubbled:case wC.B.EventHandled:case wC.B.DelegatedCommandReceived:break;case wC.B.ScenarioEventDataAppended:{const{context:{eventData:t},correlationId:n}=e;this.legacyCommandReportingService.appendScenarioEventData(n,t);break}case wC.B.ScenarioMarked:{const{context:{step:t,eventData:n,status:i,monitoringData:a},correlationId:o}=e;this.legacyCommandReportingService.addScenarioMark(o,t,n,i,a);break}case wC.B.CommandStart:{const{context:{entityCommand:t,executionContextEntity:n},correlationId:i}=e,{scenarioEventData:a}=t;this.legacyCommandReportingService.registerCommandStart(t),a&&this.legacyCommandReportingService.appendScenarioEventData(i,a),this.legacyCommandReportingService.reportCommandEvent(i,wC.B.CommandReceived,{executionContextEntity:n});break}case wC.B.NavigationCommandStart:{const{context:{clientLaunchId:t,correlation:n,eventData:i},correlationId:a}=e;this.legacyCommandReportingService.registerNavigationCommandStart(t,n),this.legacyCommandReportingService.addScenarioMark(a,wC.B.DeeplinkReceived),i&&this.legacyCommandReportingService.appendScenarioEventData(a,i);break}case wC.B.CommandMetaDataAdded:{const t=e.context,{target:n}=t,a=(0,i.__rest)(t,["target"]),{correlationId:o}=e;this.legacyCommandReportingService.appendCommandEventData(o,a);break}case wC.B.NotHandled:{const{correlationId:t,type:n}=e;this.legacyCommandReportingService.reportCommandEvent(t,n);break}default:{const t=e.context,{target:n,eventData:a}=t,o=(0,i.__rest)(t,["target","eventData"]),{correlationId:r,type:s}=e;this.legacyCommandReportingService.reportCommandEvent(r,s,o,a);break}}}setUpCommandChangeSubscriptions(){return this.commandChangeReportingService.observeChanges().subscribe((e=>this.changeToCommandReportingService(e)))}}class tx{constructor(e,t,n){this.commandChangeReportingService=e,this.lifeCycleScopeChangeReportingService=t,this.logger=n.newLogger("CommandAppLifeCycleListenerService","core-services-entity-commanding"),this.lifeCycleScopeChangeSubscription=this.subscribeToLifeCycleScopeChange()}destroy(){var e;null===(e=this.lifeCycleScopeChangeSubscription)||void 0===e||e.unsubscribe()}subscribeToLifeCycleScopeChange(){return this.lifeCycleScopeChangeReportingService.observeChanges().pipe((0,Lw.U)((({correlationId:e,context:{apps:t}})=>{let n=!1;return t.forEach((({id:t,type:i})=>{i===l_.c4.Initialized&&(n=!0,this.logger.log(`${t} initialized, correlationId: ${e}`))})),{appInitialized:n,correlationId:e}})),(0,jw.h)((({appInitialized:e})=>e))).subscribe((({correlationId:e,appInitialized:t})=>{this.commandChangeReportingService.report({correlationId:e,type:wC.B.ScenarioEventDataAppended,context:{target:"commandAppLifeCycle",eventData:{appInitialized:t}}})}))}}class nx{constructor(e){this._cap=e,this._map=new Map}entries(){return this._map.entries()}get(e){return this._map.get(e)}set(e,t){if(this._map.size>=this._cap){const e=this._map.keys().next().value;this._map.delete(e)}return this._map.set(e,t)}}class ix{constructor(e){this.commandChangeReportingService=e}init(){this.commandsHistory&&this.destroy(),this.commandsHistory=new nx(30),this.initCommandChangeReportingSubscription()}destroy(){var e;null===(e=this.commandChangeReportingSubscription)||void 0===e||e.unsubscribe(),this.commandChangeReportingSubscription=void 0,this.commandsHistory=void 0}get CommandsHistory(){return this.commandsHistory}initCommandChangeReportingSubscription(){this.commandChangeReportingSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e)))}onCommandChange(e){const{correlationId:t}=e;if(this.commandsHistory)if(e.type===wC.B.CommandStart){const{context:{entityCommand:n}}=e;let i=this.commandsHistory.get(t);const a={entityCommand:n,isCommandTargetedToMainWindow:!1,steps:[]};i=i?Object.assign(Object.assign({},i),{entityCommand:n}):a,this.commandsHistory.set(t,i)}else if(e.type===wC.B.CommandMetaDataAdded){const{correlationId:t,context:{isCommandTargetedToMainWindow:n}}=e,i=this.commandsHistory.get(t);i&&n&&this.commandsHistory.set(t,Object.assign(Object.assign({},i),{isCommandTargetedToMainWindow:n}))}else{const n=this.commandsHistory.get(t);null==n||n.steps.push({event:e.type,timestamp:Date.now()-(parseInt(n.entityCommand.command.correlation.startTimestamp,10)||0)})}}}function ax(e,t,...n){var i;const{coreSettings:a}=t,o=null!==(i=null==a?void 0:a.get(L.J.Core).enableCoreErrorsV2)&&void 0!==i&&i,r=[];for(const i of n)if(!t[i]&&(r.push(i),!o)){const t=`${e}: ${i} is missing`;throw(0,An.Tr)(he.w5.Core,he.jK.CoreServiceMissing,e,void 0,t)}if(o&&r.length>0)throw ve.fromMissingDependencies(e,r);return t}class ox extends fe{constructor(){super(he.Yg.CreateCommandReportingService,[])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n="CreateCommandReportingServiceTask",{commandChangeReportingService:i,coreSettings:a,lifeCycleScopeChangeReportingService:o,loggerFactory:r,scenarioFactory:s,windowProvider:l}=ax(n,e,"coreSettings","commandChangeReportingService","lifeCycleScopeChangeReportingService","loggerFactory","scenarioFactory","windowProvider");if(null===(t=a.get(L.J.Core))||void 0===t?void 0:t.enableStandaloneCommandReportingService){const{commandResultChangeReportingService:t}=ax(n,e,"commandResultChangeReportingService"),o=new ER(r,i,t,l);o.init(),e.commandResultService=o,new KR(i,t,s,r).init(),this.initCommandHistoryService(e,i,a)}else e.commandReportingService=new ZR(r,l),new ex(e.commandReportingService,i);new tx(i,o,r),this.initCommandHistoryService(e,i,a)}))}initCommandHistoryService(e,t,n){e.commandHistoryService=new ix(t),(null==n?void 0:n.get(L.J.Diagnostics).isDiagnosticsPanelEnabled)&&e.commandHistoryService.init()}}class rx extends fe{constructor(){super(he.Yg.CreateCommandResultHooksService,[])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:n,coreSettings:i,client:a,commandResultChangeReportingService:o,entityCommanding:r,loggerFactory:s,scenarioFactory:l}=ax("CreateCommandReportingServiceTask",e,"appsRegistryService","client","commandResultChangeReportingService","coreSettings","entityCommanding","loggerFactory","scenarioFactory");return(null===(t=i.get(L.J.Core))||void 0===t?void 0:t.enableStandaloneCommandReportingService)&&(e.commandResultHooksService=new kI(n,a,o,i,r,s,l,e.authenticationUser&&(0,di.b4)(e.authenticationUser)),e.commandResultHooksService.init()),Promise.resolve()}))}}var sx=n(41094);const lx=(e,t,n,i)=>{const a=`${e}::TypeError::`;try{return new URL(t,n||void 0)}catch(e){let o=`${a}base::${n}`;throw i&&(o=o.concat(`::url::${t}`)),new sx.Y("URL_PARSE_FAILED",new Error(o))}},cx=(e,t,n)=>{let i=!1,a=!1,o=!1,r=!1,s=!1,l=`${e}::`;const c="ProtocolValidationFailed::",d="OriginValidationFailed::";if(t.protocol&&n.protocol?a=!0:l=l.concat(`${c}EmptyProtocol::'${t.protocol}'::'${n.protocol}'`),t.protocol!==n.protocol?l=l.concat(`${c}'${t.protocol}' !== '${n.protocol}'`):o=!0,t.origin&&n.origin?r=!0:l=l.concat(`${d}EmptyOrigin::'${t.origin}'::'${n.origin}'`),t.origin!==n.origin?l=l.concat(`${d}'${t.origin}' !== '${n.origin}'`):s=!0,i=a&&o&&r&&s,!i)throw new sx.Y("URL_VALIDATION_FAILED",new Error(l))},dx=[{id:"@msteams/components-calling-ppt-sharing#components-calling-ppt-sharing",getConfig:e=>({createScriptURL:(t,n)=>{var i;const a="pptLivePolicy",o=null!==(i=e.get(L.J.Security).pptLiveAllowedOrigin)&&void 0!==i?i:[];if(!Array.isArray(o)||0===o.length)throw new sx.Y("URL_VALIDATION_FAILED",new Error("pptLivePolicy::TypeError::allowedOriginList pptLiveAllowedOrigin is undefined or empty"));let r;const s=lx(a,t,n,!0);for(const e of o)try{const t=lx(a,e,void 0,!0);return cx(a,s,t),s.href}catch(e){r=e}throw r}})}],ux=[{id:"@msteams/no-op",getConfig:()=>({createHTML:e=>e,createScriptURL:e=>e})},{id:"@msteams/services-utilities-common#ChunkLoader",getConfig:e=>({createScriptURL:(t,n)=>{var i;const a="chunkLoaderPolicy";let o,r,s,l=!1,c=!1;const d=lx(a,t,n,!0),u=null!==(i=e.get(L.J.Platform).staticsPath)&&void 0!==i?i:"";if(!u)throw new sx.Y("URL_PARSE_FAILED",new Error(`${a}::TypeError::allowListUrl staticsPath is undefined`));try{s=lx(a,u,void 0,!0),cx(a,d,s),l=!0}catch(e){o=e}if(l)return d.href;try{s=lx(a,gx,void 0,!0),cx(a,d,s),c=!0}catch(e){r=e}if(c)return d.href;if(o)throw o;throw r}})},{id:"@msteams/services-io-browser-web-client-update#register-service-worker",getConfig:()=>({createScriptURL:(e,t)=>{const n="registerServiceWorkerPolicy";let i,a,o=!1;const r=lx(n,e,t,!0);try{a=lx(n,gx,void 0,!0),cx(n,r,a),o=!0}catch(e){i=e}if(o)return r.pathname;throw i}})},{id:"@msteams/core-services-telemetry-worker#TelemetryWorker",getConfig:e=>({createScriptURL:(e,t)=>{const n="telemetryWorkerPolicy";let i,a,o=!1;const r=lx(n,e,t,!0);try{a=lx(n,gx,void 0,!0),cx(n,r,a),o=!0}catch(e){i=e}if(o)return r.pathname;throw i}})}];function mx(){return window}const gx=mx().location.origin;class px{constructor(e,t){this.coreSettings=e,this.logger=t.newLogger("CoreSecurityService","core-services-security"),this.configMap=new Map,this.policyMap=new Map,this.initializeTrustedTypeConfigMap(),this.setIsTrustedTypePoliciesEnabled()}getTrustedTypePolicy(e){var t,n,i;let a;if(this.isTrustedTypePoliciesEnabled||(e="@msteams/no-op"),a=this.policyMap.get(e),a)return a;if(a=this.createTrustedTypePolicyOnDemand(e),a)return this.policyMap.set(e,a),a;const o=new sx.Y("POLICY_NOT_FOUND",new Error(`${e}`));throw null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}::${null===(i=o.prevError)||void 0===i?void 0:i.message}`,"webclient_framework_foundation_core_services_security",void 0,!0),o}createTrustedTypePolicyOnDemand(e){var t,n,i;const a=this.configMap.get(e);if(!a)return;const o=mx().trustedTypes;if(!this.isTrustedTypePoliciesEnabled||!o)return this.getOptionsAsTrustedTypePolicy(a);try{return o.createPolicy(a.id,a.getConfig(this.coreSettings))}catch(a){const o=new sx.Y("CREATE_POLICY_FAILED",new Error(`${e}${null==a?void 0:a.message}`));throw null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}::${null===(i=o.prevError)||void 0===i?void 0:i.message}`,"webclient_framework_foundation_core_services_security",void 0,!0),o}}getOptionsAsTrustedTypePolicy(e){return e.getConfig(this.coreSettings)}initializeConfigs(){dx.forEach((e=>{this.setConfig(e)}))}initializeCoreConfigs(){ux.forEach((e=>{this.setConfig(e)}))}initializeTrustedTypeConfigMap(){this.initializeCoreConfigs(),this.initializeConfigs()}setConfig(e){if(this.configMap.has(e.id))throw new sx.Y("DUPLICATE_POLICY_FOUND",new Error(`CoreSecurityService::${e.id}`));this.configMap.set(e.id,e)}setIsTrustedTypePoliciesEnabled(){const{enableTrustedTypePolicies:e}=this.coreSettings.get(L.J.Core);this.isTrustedTypePoliciesEnabled=!!e}}class vx extends fe{constructor(){super(he.Yg.CreateCoreSecurityTask,["coreSettings","loggerFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,windowProvider:i}=e,a=n.newLogger("CoreSecurityService","core-services-tasks"),o=new px(t,n);e.coreSecurityService=o,i.chunkLoader.configureCoreSecurityService(o),a.log("CoreSecurityService Initialized")}))}}var hx=n(339897);class fx extends fe{constructor(){super(he.Yg.CreateSettings,[]),this.registerShellHandlers=(e,t)=>{var n;null===(n=e.opener)||void 0===n||n.addEventListener(n_.rY.GetSettings,(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return t.getCurrentSettingsSnapshot().then((t=>e.opener.postMessage(n_.rY.GetSettings,{settings:t})),(()=>e.opener.postMessage(n_.rY.GetSettings,{settings:""})))}))))}}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{hostSettings:t}=e,{clientPreferences:n,config:i,configLoader:a,diagnosticsService:o,loggerFactory:r,logsCollectorService:s,platformService:l,windowProvider:c,localStorage:d,postTaskSchedulerDiagnosticsService:u}=ax("CreateCoreSettingsTask",e,"clientPreferences","config","configLoader","diagnosticsService","loggerFactory","logsCollectorService","platformService","windowProvider","localStorage","postTaskSchedulerDiagnosticsService"),m=yield hx.v.createContext(n,i,a,r,l,c,d,t),g=m.getCoreSettings();m.initializeProvidersWithCachedPrimaryUser();const p=m.getLogsProvider();e.coreSettingsContext=m,e.coreSettings=g,o.subscribeToCoreSettings(g),s.subscribeToCoreSettings(g),u.subscribeToCoreSettings(g);g.get(L.J.Core).enableMTMA||s.registerUserLogsProvider("",p),this.registerShellHandlers(c,p)}))}}class yx extends fe{constructor(){super(he.Yg.CreateSettingsUserContext,["authenticationUser","coreSettingsContext","logsCollectorService","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettingsContext:n,logsCollectorService:i,windowProvider:a}=e,o=yield n.createContextForUser(t,a);e.coreSettingsContext=o,e.coreSettings=o.getCoreSettings();const r=o.getLogsProvider();return i.registerUserLogsProvider(t.id,r),e=>{switch(e){case"quit":case"signout":o.cleanup(e);break;default:return}}}))}}class bx{constructor(e,t,n,i,a,o){this._commandHandler=e,this._client=t,this._experienceChangeReportingService=n,this._authenticationUser=i,this._hostCommunicationService=a,this._loggerFactory=o,this._logger=this._loggerFactory.newLogger("core-shortcut-service","core-shortcut-service"),this._registeredDesktopShortcuts=[],this._registeredGlobalShortcuts=[]}addDesktopClientShortcut(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!a)return void this._logger.warn(`Missing windowId for command: ${t}`);const i=yield this._hostCommunicationService.loadModule("windowcontrols"),r=yield null===(o=null==i?void 0:i.addShortcut)||void 0===o?void 0:o.call(i,a,e);return r&&(this._logger.log(`Added desktop shortcut for command ${t} and shortuctId ${r}`),this._registeredDesktopShortcuts.push({commandId:t,shortcutId:r,commandHandler:n,windowId:a})),r}))}removeDesktopClientShortcut(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this._logger.debug(`Removing desktop shortcut for commandId ${e}`);const i=this._registeredDesktopShortcuts.find((n=>n.commandId===e&&n.windowId===t));if(i){const a=yield this._hostCommunicationService.loadModule("windowcontrols");yield null===(n=null==a?void 0:a.removeShortcut)||void 0===n?void 0:n.call(a,i.windowId,i.shortcutId),this._logger.log(`Removed desktop shortcut for command ${e} and shortuctId ${i.shortcutId}`),this._registeredDesktopShortcuts=this._registeredDesktopShortcuts.filter((n=>!(n.commandId===e&&n.windowId===t)))}}))}addGlobalShortcut(e,t,n){var a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(e=>e.windows)(e),r=0===this._registeredGlobalShortcuts.length;this._logger.log(`Adding global shortcut for command ${t} and shortuct ${i}. ${this._registeredGlobalShortcuts.length} shortcuts active`);const s=yield this._hostCommunicationService.loadModule("globalshortcuts"),l=this._registeredGlobalShortcuts.filter((e=>e.keys===i));if(l.length>0){this._logger.log("Global shortcut already registered, removing");for(const e of l)yield null===(a=null==s?void 0:s.removeGlobalShortcut)||void 0===a?void 0:a.call(s,e.shortcutId),this._logger.log(`Removed global shortcut for command ${t} and shortuct ${i}`),this._registeredGlobalShortcuts=this._registeredGlobalShortcuts.filter((t=>t.shortcutId!==e.shortcutId))}const c=yield null===(o=null==s?void 0:s.addGlobalShortcut)||void 0===o?void 0:o.call(s,e);return c&&(this._registeredGlobalShortcuts.push({commandId:t,shortcutId:c,commandHandler:n,keys:i}),this._logger.log(`Added global shortcut for command ${t} and shortuctId ${c}. ${this._registeredGlobalShortcuts.length} shortcuts active`),r&&(this._logger.log("First global shortcut added, registering callback"),yield this.registerForGlobalShortcutActivated())),c}))}removeGlobalShortcut(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this._logger.log(`Removing global shortcut for commandId ${e}. ${this._registeredGlobalShortcuts.length} shortcuts active`);const i=this._registeredGlobalShortcuts.filter((t=>t.commandId===e));if(i.length>0){const n=yield this._hostCommunicationService.loadModule("globalshortcuts");for(const a of i)this._logger.log(`Removing global shortcut for commandId ${e} with keys ${a.keys}`),yield null===(t=null==n?void 0:n.removeGlobalShortcut)||void 0===t?void 0:t.call(n,a.shortcutId),this._logger.log(`Removed global shortcut for command ${e}`),this._registeredGlobalShortcuts=this._registeredGlobalShortcuts.filter((e=>e.shortcutId!==a.shortcutId));this._logger.log(`Removed ${i.length} global shortcut for command ${e}. ${this._registeredGlobalShortcuts.length} shortcuts active`)}0===this._registeredGlobalShortcuts.length&&(this._logger.log("Last global shortcut removed, disposing registration"),null===(n=this._disposeGlobalShortcutActivatedEventRegistration)||void 0===n||n.call(this),this._disposeGlobalShortcutActivatedEventRegistration=void 0)}))}addEventListener(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield(0,RN.jW)(this._client);(null==n?void 0:n.id)===e&&(this._mainShortcutServiceCallback=t)}))}processEvent(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){(yield(0,RN.jW)(this._client))?null===(n=this._mainShortcutServiceCallback)||void 0===n||n.call(this,e):(this._mainShortcutServiceCallbackWithPayload=()=>{var t;null===(t=this._mainShortcutServiceCallback)||void 0===t||t.call(this,e)},this._subscribeToChangeReportingService()),yield this.openMainApp()}))}registerForDesktopClientKeyDownShortcuts(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this._hostCommunicationService.loadModule("windowcontrols");this._disposeDesktopShortcutKeyDowEventRegistration=null===(e=null==t?void 0:t.registerForKeyDown)||void 0===e?void 0:e.call(t,(e=>this._handleDesktopShortcut(e)))}))}registerForGlobalShortcutActivated(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(this._disposeGlobalShortcutActivatedEventRegistration)return;const t=yield this._hostCommunicationService.loadModule("globalshortcuts");this._disposeGlobalShortcutActivatedEventRegistration=null===(e=null==t?void 0:t.registerForGlobalShortcutActivated)||void 0===e?void 0:e.call(t,(e=>this._handleGlobalShortcut(e)))}))}destroy(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){null===(e=this._disposeDesktopShortcutKeyDowEventRegistration)||void 0===e||e.call(this);const t=yield(0,RN.XD)(this._client),n=t.find((e=>e.isMainWindow&&e.layoutConfig.layoutMode===d.lO.standard));n||(this._mainShortcutServiceCallback=void 0),0!==t.length&&this._authenticationUser&&(null==n?void 0:n.userContextId)===(0,di.b4)(this._authenticationUser)||(this._mainShortcutServiceCallbackWithPayload=void 0,this._mainShortcutServiceCallback=void 0,this._subscription&&this._subscription.unsubscribe())}))}openMainApp(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this._commandHandler({entity:{type:u.p.default,action:u.u.default},command:{visibilityState:d.fe.show,stateTransition:d.su.flush,correlation:{source:kt.D.Core}}})}))}_handleDesktopShortcut(e){const t=this._registeredDesktopShortcuts.find((t=>t.shortcutId===e.shortcutId));t?(this._logger.debug(`Executing command handler for desktop shortcut: ${t.commandId} / ${e.shortcutId}`),t.commandHandler()):this._logger.warn(`Can't execute desktop shortcut with id ${e.shortcutId}. No record found.`)}_handleGlobalShortcut(e){const t=this._registeredGlobalShortcuts.find((t=>t.shortcutId===e));t?(this._logger.debug(`Executing command handler for global shortcut: ${t.commandId} / ${t.shortcutId}`),t.commandHandler()):this._logger.warn(`Can't execute global shortcut with id ${e}. No record found.`)}_subscribeToChangeReportingService(){const e=this._experienceChangeReportingService.observeChanges();this._subscription=e.pipe((0,Lw.U)((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e.type!==l_.FV.LayoutRenderComplete)return;const t=yield(0,RN.jW)(this._client);e.windowId===(null==t?void 0:t.id)&&this._onMainWindowLayoutRenderComplete()}))))).subscribe()}_onMainWindowLayoutRenderComplete(){var e;null===(e=this._mainShortcutServiceCallbackWithPayload)||void 0===e||e.call(this),this._mainShortcutServiceCallbackWithPayload=void 0,this._subscription&&this._subscription.unsubscribe()}}class Sx extends fe{constructor(){super(he.Yg.CreateCoreShortcutService,["commandHandler","client","coreSettings","experienceChangeReportingService","hostCommunicationService","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,commandHandler:n,client:i,coreSettings:a,experienceChangeReportingService:o,hostCommunicationService:r,loggerFactory:s}=e;a.get(L.J.Shortcuts).enableShortcutPropagation&&(e.coreShortcutService=new bx(n,i,o,t,r,s))}))}}class kx extends fe{constructor(){super(he.Yg.CreateCoreUtilities,["isEntityInView"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{isEntityInView:t}=e;e.coreUtilities={isEntityInView:t}}))}}class wx{constructor(e,t){this.channelName=e,this.host=t,this.subscriptions=[],this.hostResumeEventHandler=()=>{this.closeChannel(),this.initializeChannel()},this.initializeChannel(),this.subcribeToHostLifecycleEvents()}canPostMessage(){return!!this.broadcastChannel}postMessage(e){return this.broadcastChannel?(this.broadcastChannel.postMessage(e),"success"):"failure"}subscribeToMessage(e){var t;this.subscriptions.push(e),null===(t=this.broadcastChannel)||void 0===t||t.addEventListener("message",(t=>e(t.data)))}dispose(){this.unsubscribeFromHostLifecycleEvents(),this.closeChannel(),this.subscriptions=[]}initializeChannel(){const e=new BroadcastChannel(this.channelName);this.broadcastChannel=e,this.subscriptions.forEach((t=>e.addEventListener("message",(e=>t(e.data)))))}closeChannel(){var e;null===(e=this.broadcastChannel)||void 0===e||e.close(),this.broadcastChannel=void 0}subcribeToHostLifecycleEvents(){this.host.addEventListener("resume",this.hostResumeEventHandler)}unsubscribeFromHostLifecycleEvents(){this.host.removeEventListener("resume",this.hostResumeEventHandler)}}var Cx=n(40603);class _x{constructor(e,t){var n,i;this.host=t,this.subscriptions=new Map,this.logger=e.newLogger("CrosstabService","services-io-browser-crosstabs"),this.channel=new wx(_x.CrossTabsCommsBusKey,this.host),this.initializeSubscriptions(),null===(i=(n=this.logger).logNoPii)||void 0===i||i.call(n,"Initialized")}postMessage(e,t){if(!this.channel.canPostMessage())return"failure";const n=this.toCrossTabsMessagePayload(e,t);return this.channel.postMessage(n)}subscribeToMessage(e,t){const n=this.subscriptions.get(e)||new Set;n.add(t),this.subscriptions.set(e,n);const i=()=>{const n=this.subscriptions.get(e);(null==n?void 0:n.has(t))&&n.delete(t)};return()=>i()}areOtherTabsDetected(){return new Promise((e=>{this.channel.canPostMessage()||e(!1);let t=0;const n=this.subscribeToMessage("SearchTabsResponse",(()=>{t&&this.host.clearTimeout(t),n(),e(!0)}));this.postMessage("SearchTabs",{responseRequired:!0}),t=this.host.setTimeout((()=>{e(!1)}),1e3)}))}dispose(){this.channel.dispose(),this.subscriptions.clear()}broadcastedMessageHandler(e){var t,n;null===(n=(t=this.logger).logNoPii)||void 0===n||n.call(t,`Message received: type=${e.messageType}, id={${e.messageId}}, correlationId={${e.correlationId}}`);const i=e.messageType;if(i){const t=this.subscriptions.get(i);t&&t.forEach((t=>t(Object.assign({},e))))}}initializeSubscriptions(){this.channel.subscribeToMessage((e=>this.broadcastedMessageHandler(e))),this.subscribeToMessage("SearchTabs",(e=>{var t,n;this.postMessage("SearchTabsResponse",{correlationId:e.correlationId}),null===(n=(t=this.logger).logNoPii)||void 0===n||n.call(t,`SearchTabs received. CorrelationId: ${e.correlationId}`)}))}toCrossTabsMessagePayload(e,t){return Object.assign({messageType:e,timestamp:Date.now(),messageId:(0,Cx.GW)(),correlationId:(null==t?void 0:t.responseRequired)?(0,Cx.GW)():void 0},t)}}_x.CrossTabsCommsBusKey="CrossTabsBus";var Tx=n(438234);class Ix extends fe{constructor(){super(he.Yg.CreateCrossTabsService,["coreSettings","localStorage","loggerFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,localStorage:n,loggerFactory:i,windowProvider:a}=e,{enableCrossTabsCommunication:o}=t.get(L.J.Core,["enableCrossTabsCommunication"]);if(o){const t=function(e,t){var n;try{return new _x(e,t)}catch(t){const i=e.newLogger("CrosstabService","services-io-browser-crosstabs"),a="Can't be initialized.";return null===(n=i.errorToTelemetry)||void 0===n||n.call(i,a,"cross_tabs_init_failed"),void i.error(a,t)}}(i,a);e.crossTabsService=t,t&&t.subscribeToMessage("T2WebOptOut",(()=>this.onT2WebOptOut(i,n,t)))}}))}onT2WebOptOut(e,t,n){var i;const a=e.newLogger("T2WebOutOutMessageHandler","t2-web-opt-out-message-handler");null===(i=a.logNoPii)||void 0===i||i.call(a,"T2WebOptOut message received, redirecting this tab to T1");new Tx.B(t,e,n).redirectThisTabToT1()}}var Ex=n(981364),Nx=n(549426);const Ax=["activeCalls","activeMeetings","activeWindow","activeWindowForEntity","activeWindows","allClientPreferences","appsInstalledByCurrentUser","appsUsage","bannerNotificationQueue","cachedAppList","callingScreenLayout","callingScreenStatus","currentCallingState","clientPreferences","fetchDynamicCommandsV2","localizationSettings","lockedTiles","meetingRoomLayoutToggleState","mostRecentlyUsedTiles","pinnedMeetings","pinnedTiles","pptSharingSession","recentMeetings","requestImmersiveReader","whiteboardSharingSession","attendeeCaptionsVisibility","meetingRoomFrontOfRoomCallPanelsState","espState","currentEspSurfaceId"],Fx=["addSharedPlatformCachedApps","executeEntityCommand","changeMonitorSlotContent","changeSlotsVisibility","performWindowHistoryNavigation","navigateToWindowHistoryIndex","recordAppActionUsage","recordAppSceneUsage","recordAppUsage","removeSharedPlatformCachedApps","removeUserActiveWindows","removeWindow","resizeHeaderSlot","resizeSlotDimensions","saveReactiveVarsToHistory","setActiveCalls","setCallingScreenLayout","setCallingScreenStatus","toggleHideMyselfVideo","togglePinMyself","toggleMyselfInGrid","toggleParticipantPin","updateActiveCalls","updateAttendeeCaptionsVisibility","updateClientPreferences","updateCurrentLocale","updateEntity","updateEntityState","updateExtendedEntityContainerState","updateMeetingRoomLayoutToggleState","updateSharedPlatformCachedApps","setMeetingRoomFrontOfRoomCallPanelsState","recordEspCompletedActions","recordDisplayedSurface","recordEligibleSurface"],Dx=["appsInstalledByCurrentUserEvent","appsUsageUpdateEvent","callParticipantPinnedEventv2","dynamicCommandsUpdateEvent","launchTileUpdatedEvent"],Rx=["activeWindow","activeWindowForEntity","activeWindows","allClientPreferences","cachedAppList","clientPreferences","localizationSettings","espGlobalState","currentEspSurfaceId"],xx=[...Rx,"activeCalls","activeMeetings","appsInstalledByCurrentUser","appsUsage","bannerNotificationQueue","callingScreenLayout","callingScreenStatus","currentCallingState","fetchDynamicCommandsV2","lockedTiles","meetingRoomLayoutToggleState","mostRecentlyUsedTiles","pinnedMeetings","pinnedTiles","pptSharingSession","recentMeetings","requestImmersiveReader","whiteboardSharingSession","espState"],Mx=["addSharedPlatformCachedApps","executeEntityCommand","changeMonitorSlotContent","changeSlotsVisibility","removeWindow","resizeHeaderSlot","performWindowHistoryNavigation","navigateToWindowHistoryIndex","removeSharedPlatformCachedApps","removeUserActiveWindows","resizeSlotDimensions","saveReactiveVarsToHistory","updateClientPreferences","updateCurrentLocale","updateEntity","updateEntityState","updateExtendedEntityContainerState","updateSharedPlatformCachedApps","setEspGlobalState","createNotificationsWindow"],Ox=[...Mx,"setActiveCalls","setCallingScreenLayout","setCallingScreenStatus","toggleParticipantPin","toggleHideMyselfVideo","toggleMyselfInGrid","togglePinMyself","updateActiveCalls","updateMeetingRoomLayoutToggleState","recordEspCompletedActions","recordDisplayedSurface","recordEligibleSurface","recordAppActionUsage","recordAppSceneUsage","recordAppUsage"],Px=[],Lx=[...Px,"appsInstalledByCurrentUserEvent","appsUsageUpdateEvent","callParticipantPinnedEventv2","callHideMyselfVideoEvent","dynamicCommandsUpdateEvent","launchTileUpdatedEvent","callMyselfVideoPinnedEvent"],Ux=["chat","messages","installedAppsV2"],jx=[...Ax,"lpcState","pinnedChannels","joinedTeamsAndChannels"],$x=(e,t,n)=>{const i=(0,Ex.p$)(e),{operation:a,selectionSet:{selections:o},variableDefinitions:r}=i,s=Wx[a],l=(null==r?void 0:r.some((e=>!!e.defaultValue)))?function(e,t={}){const n={};for(const i of e){const e=i.variable.name.value;t.hasOwnProperty(e)?n[e]=t[e]:i.defaultValue&&(n[e]=(0,Nx.M)(i.defaultValue))}return n}(r,t):t;return o.filter((e=>"Field"===e.kind&&!jx.includes(e.name.value))).map((e=>({id:s,fieldName:e.name.value,args:Bx(e,l),schemaId:n})))};function Bx(e,t){var n;if(!(null===(n=null==e?void 0:e.arguments)||void 0===n?void 0:n.length))return;const i={};for(const n of e.arguments){const e=(0,Nx.M)(n.value,t);void 0!==e&&(i[n.name.value]=e)}return i}const Wx={query:"ROOT_QUERY",mutation:"ROOT_MUTATION",subscription:"ROOT_SUBSCRIPTION"};var Hx;!function(e){e[e.DefaultSchema=0]="DefaultSchema",e[e.ViewSchema=1]="ViewSchema"}(Hx||(Hx={}));var Vx=n(580438);const zx=n(540642);var qx=n(296055);class Gx{constructor(e){this._inactiveOperations=new Map,this._forcedActiveOperations=new Map,this._windowToDataMap=new Map,this._dataToWindowMap=new Map,this._activeOperations=(null==e?void 0:e.activeOperationLimit)?new qx.Z({maxSize:e.activeOperationLimit,onEviction:this.markLeastRecentlyUsedOperation.bind(this)}):new Map}trackOperation(e,t,n=Hx.DefaultSchema,i){const{fetchPolicy:a,variables:o}=e,r=e.query||e.mutation;if("no-cache"===a)return;if(e.mutation&&!e.keepRootFields)return;$x(r,o,n).forEach((e=>{const n=(e=>{const t=zx(e);return(0,Vx.Z)(t)})(e);this._activeOperations.set(n,e),"boolean"==typeof i&&this.forceActive(n,i),this.addDataForWindow(t,n),this._inactiveOperations.has(n)&&this._inactiveOperations.delete(n)}))}markDataForWindowAsInactive(e){const t=this._windowToDataMap.get(e)||[];this._windowToDataMap.delete(e),t.forEach((t=>{const n=this._dataToWindowMap.get(t);if(n&&(n.delete(e),n.size))return;const i=this._activeOperations.get(t);i&&this._inactiveOperations.set(t,i),this._dataToWindowMap.delete(t),this._activeOperations.delete(t)}))}flush(e=this._inactiveOperations.size){const t=[],n=[];let i=0;return this._inactiveOperations.forEach(((a,o)=>{i>=e||(t.push(a),n.push(o),Ux.includes(a.fieldName)&&(i=e),i++)})),n.forEach((e=>this._inactiveOperations.delete(e))),{descriptors:t,hasMore:!!this._inactiveOperations.size}}DEBUG_ONLY_getInactiveOperations(){return this._inactiveOperations}addDataForWindow(e,t){let n=this._windowToDataMap.get(e);n||(n=new Set,this._windowToDataMap.set(e,n)),n.add(t);let i=this._dataToWindowMap.get(t);i||(i=new Set,this._dataToWindowMap.set(t,i)),i.add(e)}forceActive(e,t){var n;const i=(null!==(n=this._forcedActiveOperations.get(e))&&void 0!==n?n:0)+(t?1:-1);0!==i?this._forcedActiveOperations.set(e,i):this._forcedActiveOperations.delete(e)}markLeastRecentlyUsedOperation(e,t){var n;(null!==(n=this._forcedActiveOperations.get(e))&&void 0!==n?n:0)>0?this._activeOperations.set(e,t):this._inactiveOperations.set(e,t)}}class Jx{constructor(e,t,n,i){this.dataOpsRepository=e,this.scenarioFactory=t,this.windowProvider=i,this.clients=new Set,this.logger=n.newLogger("EvictionService","data-client-core")}register(e){this.clients.add(e)}unregister(e){this.clients.delete(e)}evict(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.lastEvictionResult={entriesEvicted:0,entriesNotEvicted:0,entriesGCed:0};let e=!0;do{e=yield this.evictByWindowRequestIdleCallback()}while(e)}))}DEBUG_ONLY_getInactiveOperations(){return this.dataOpsRepository.DEBUG_ONLY_getInactiveOperations()}DEBUG_ONLY_getClients(){return this.clients}DEBUG_ONLY_lastResult(){return this.lastEvictionResult}evictByWindowRequestIdleCallback(){return new Promise((e=>{this.windowProvider.requestIdleCallback((t=>{let n=!1,i=0;do{const e=performance.now(),a=t.timeRemaining();this.logger.debug("Time remaining at start",a);const o=this.scenarioFactory.newScenario(it.RG.CacheEviction);n=this.evictInternal(o);const r=t.timeRemaining(),s=performance.now();i=r>0?r:a-(s-e);const l={"Eviction.TimeRemaining":i};o.stop(l),this.logger.debug("Time remaining at end",i)}while(n&&i>10);e(n)}))}))}evictInternal(e){const{descriptors:t,hasMore:n}=this.dataOpsRepository.flush(10);let i=0,a=0;const o=this.groupCachesBySchema(),r=new Set;t.forEach((e=>{var t;const n=null!==(t=o.get(e.schemaId))&&void 0!==t?t:[];let s=!1;n.forEach((t=>{t.evict(e)&&(r.add(t),s=!0)})),s?i++:a++}));const s={"Eviction.EntriesEvicted":i,"Eviction.EntriesNotEvicted":a};e.mark("eviction",s);let l=0;r.forEach((e=>{const t=e.gc();l+=t.length}));const c={"Eviction.EntriesCollected":l};return e.mark("gc",c),this.logger.debug("Eviction results",{entriesEvicted:i,entriesNotEvicted:a,entriesGCed:l}),this.lastEvictionResult&&(this.lastEvictionResult.entriesEvicted+=i,this.lastEvictionResult.entriesNotEvicted+=a,this.lastEvictionResult.entriesGCed+=l),n}groupCachesBySchema(){const e=new Map;return this.clients.forEach((t=>{let n=e.get(t.schemaId);n||(n=new Set,e.set(t.schemaId,n)),n.add(t.cache)})),e}}var Qx=n(5020),Kx=n(962400),Yx=n(836704),Xx=n(243171),Zx=n(275123),eM=n(42307),tM=n(845306),nM=n(486172),iM=n(371825);function aM(e){return function(t,{args:n,toReference:i,canRead:a}){if(a(t))return t;const o=e(n);return a(o)?i(o):void 0}}const oM={merge:["prejoinState","callTranscriptState","activeWindow","activeWindowForEntity","messages","userPreferences"],replace:["activeWindows","callingAlerts","workWeekDays","dateRange","activeCalls","listBreakoutRoomsWithDetails"]},rM={Query:{fields:Object.assign(Object.assign({user:aM((e=>({__typename:"User",id:null==e?void 0:e.userId}))),presence:aM((e=>({__typename:"Presence",id:`${null==e?void 0:e.userId}_ups`}))),call:aM((e=>({__typename:"Call",id:null==e?void 0:e.id}))),streamDetails:aM((e=>({__typename:"StreamDetailsInfo",id:null==e?void 0:e.id}))),breakoutRoomsDetails:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]],read:aM((e=>({__typename:"BreakoutRoomsDetails",id:null==e?void 0:e.coordinates.threadId})))},searchForMentionV2:{keyArgs:["teamId","searchQuery","includeBots","channelText","teamText","generalText","channelType","hostTenantId","enableScheduledTags","enableOwnersTag"]},breakoutRoomSettings:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},listBreakoutRoomsWithDetails:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},breakoutRoomsClientState:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},localizationSettings:{keyArgs:["currentLocale"]},searchConversation:{keyArgs:["searchTerm","conversationId","filters"],merge:(e,t)=>t?e?Object.assign(Object.assign({},t),{Results:[...e.Results,...t.Results]}):t:e}},oM.merge.reduce(((e,t)=>Object.assign({[t]:{merge:!0}},e)),{})),oM.replace.reduce(((e,t)=>Object.assign({[t]:{merge:!1}},e)),{}))},Subscription:{fields:{chatServiceEvent:{merge:!1},callRecordingStateChangedEvent:{merge:!1},callingServiceEvent:{merge:!1}}},CallParticipantsCounts:{keyFields:["teamsCallId"]},ParticipantCountsChanged:{keyFields:["teamsCallId"]},ParticipantsChanged:{keyFields:["teamsCallId"]},MessagesResult:{keyFields:!1},WindowHistoryItem:{keyFields:!1},SelectedDevices:{keyFields:!1},Window:{fields:{windowHistory:{merge:!1},activeEntities:{merge:!0},correlation:{merge:!0},extendedEntityContainerState:{merge:!0}}},DeviceList:{fields:{cameras:{merge:!1},camerasSupportingAutoFraming:{merge:!1},microphones:{merge:!1},selectedDevices:{merge:!0}}},Call:{fields:{extendedCallType:{merge:!0},capabilities:{merge:!0},breakoutRoomDetails:{merge:!0}}},RoomCoordinates:{keyFields:["threadId"]},BasicParticipant:{keyFields:["participantId"]},BreakoutRoomsDetails:{fields:{breakoutRooms:{merge:!1}}},BreakoutRoom:{fields:{clientActionState:{read:e=>e||null},participants:{merge:!1}}},CalendarEvent:{keyFields:["objectId"]},InDayEvents:{keyFields:["mailboxAddress","date"],fields:{events:{merge:!1}}},AllDayEvents:{keyFields:["mailboxAddress","date"],fields:{events:{merge:!1}}},Building:{keyFields:["address"]},RecurrenceEvents:{keyFields:["mailboxAddress","cleanGlobalObjectId"]},MeetingCompositeKey:{keyFields:["conversationId","messageId","eventId","modifiedStamp"]},Translation:{keyFields:!1},DiagnosticInfo:{keyFields:!1},EmailUser:{keyFields:["smtp"]},AuthenticationUserProfile:{keyFields:["objectId","tenantId"]},FluidPendingMention:{keyFields:["atMentionId"]},Participant:{keyFields:["participantId"]},Rectangle:{keyFields:!1},AudienceSceneExtent:{keyFields:!1},AudienceSceneParticipant:{keyFields:!1},ChatMessageMentionType:{keyFields:!1},Feed:{fields:{section:{keyArgs(e,{variables:t}){if(t)return t.section},merge(e,t){var n,i;return e?(null===(n=null==t?void 0:t.deltaRequestDetails)||void 0===n?void 0:n.deltaRequestId)&&t.deltaRequestDetails.deltaRequestId===(null==e?void 0:e.requestId)?Object.assign(Object.assign({},t),{dataReceivedOnClientTimestamp:e.dataReceivedOnClientTimestamp,items:[...e.items,...t.items]}):(null===(i=t.deltaRequestDetails)||void 0===i?void 0:i.deltaRequestId)?e:t:t}}}},FeedItemType:{keyFields:["uri"]},FilesListResult:{keyFields:["threadId"]},PaymentDetails:{keyFields:["eventId"]},Channel:{fields:{defaultFileSettings:{merge:!0},membershipSummary:{merge:!0},spaceAdminSettings:{merge:!0}}},Team:{fields:{membershipSummary:{merge:!0},teamSettings:{merge:!0},teamGuestSettings:{merge:!0},teamSiteInformation:{merge:!0},sensitivityLabel:{merge:!0}}},TeamSettings:{fields:{funControl:{merge:!0}}}};function sM(e,t,n,i,a){if(n){const{config:{publicPath:n,buildType:o,buildVersion:r}}=i;if(!n)return;const s=window;if(s.__APOLLO_CLIENTS__||(s.__APOLLO_CLIENTS__=[]),s.__APOLLO_KEY_FIELDS__||(s.__APOLLO_KEY_FIELDS__=function(){const e={};for(const t of Object.keys(rM))rM[t].keyFields&&(e[t]=rM[t].keyFields);return e}()),"production"===o)"multi-window"===a?s.__REMPL_APOLLO_DEVTOOLS_URL__=`/multi-window/apollo-devtools?version=${r}`:"react-web-client"===a&&(s.__REMPL_APOLLO_DEVTOOLS_URL__="/v2/apollo-devtools");else{const e=n.endsWith("/")?n:n.concat("/");s.__REMPL_APOLLO_DEVTOOLS_URL__=`${e}apollo-devtools.html`}s.__APOLLO_GLOBAL_OPERATIONS__||(s.__APOLLO_GLOBAL_OPERATIONS__={globalMutations:Fx,globalQueries:Ax,globalSubscriptions:Dx}),s.__APOLLO_CLIENTS__.push({client:e,clientId:t})}}class lM extends Error{constructor(e,t){super(`Accessing client ${e}/${t} after destroy`)}}const cM=new nM.i((()=>{throw new Error("This client has been destroyed!")}));class dM{constructor(e,t,n,i,a){var o,r;this.name=i,this.storeType=a,this.disposed=!1,this.schemaId=Hx.DefaultSchema,this.ctx=t,this.services=e,this._client=n,null===(o=this.services.leakDetector)||void 0===o||o.track(_E.I.DataClient,this),this.services.dataOpsTracker&&this.setupWatchQueryTracking(this.client),this.services.dataEvictionService&&(null===(r=this.services.dataEvictionService)||void 0===r||r.register(this)),this.registerClient(this.client)}get client(){if(!this._client)throw new lM(this.constructor.name,this.name);return this._client}get cache(){return this.client.cache}updateContext(e,t){var n;this.ctx=e,null===(n=this._client)||void 0===n||n.setLink(t)}destroy(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){(null===(e=this.services)||void 0===e?void 0:e.dataEvictionService)&&this.services.dataEvictionService.unregister(this),yield this.destroyClient(),this.ctx=void 0,this.services=void 0}))}clearCache(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield null===(e=this._client)||void 0===e?void 0:e.clearStore()}))}getServices(){return this.services}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:null,selfIsMainClient:!1}}mutate(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this.getApolloClientInstance(e.mutation);null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kx.z.mutate);const i=this.patchOptions(e),a=yield n.mutate(i);return this.trackReadOperation(n,e),a}))}query(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this.getApolloClientInstance(e.query);null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kx.z.query);const i=this.patchOptions(e),a=yield n.query(i);return this.trackReadOperation(n,e),a}))}readQuery(e,t){var n;const i=this.getApolloClientInstance(e.query);null===(n=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===n||n.trackCall(this.storeType,Kx.z.readQuery);const a=i.readQuery(e,t);return this.trackReadOperation(i,e),a}subscribe(e){var t;const n=this.getApolloClientInstance(e.query);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kx.z.subscribe),n.subscribe(e).map((t=>{var i;return this.trackReadOperation(n,e),null===(i=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===i||i.trackSubscribeEvent(this.storeType),t}))}watchQuery(e){var t;try{const n=this.getApolloClientInstance(e.query);null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kx.z.watchQuery);const i=this.patchOptions(e);return n.watchQuery(i)}catch(e){return new iM.y((t=>t.error(e)))}}writeQuery(e){var t;const n=this.getApolloClientInstance(e.query);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kx.z.writeQuery),this.trackWriteOperation(n,e),n.writeQuery(e)}writeFragment(e){var t;const n=this.getApolloClientInstance(e.fragment);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,Kx.z.writeFragment),this.trackWriteOperation(n,e),n.writeFragment(e)}readFragment(e,t){var n;const i=this.getApolloClientInstance(e.fragment);return null===(n=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===n||n.trackCall(this.storeType,Kx.z.readFragment),i.readFragment(e,t)}get defaultOptions(){return this.client.defaultOptions}set defaultOptions(e){this.client.defaultOptions=e}get disableNetworkFetches(){return this.client.disableNetworkFetches}set disableNetworkFetches(e){this.client.disableNetworkFetches=e}getApolloClientInstance(e){return this.client}patchOptions(e){const{context:t,patched:n}=e,a=(0,i.__rest)(e,["context","patched"]);return n?e:Object.assign(Object.assign({},a),{context:Object.assign(Object.assign({},this.ctx),t),patched:!0})}registerClient(e){e.dataClients||(e.dataClients=[]),e.dataClients.push(this)}unregisterClient(e){var t,n,i;return e.dataClients=null===(t=e.dataClients)||void 0===t?void 0:t.filter((e=>e!==this)),0===(null!==(i=null===(n=e.dataClients)||void 0===n?void 0:n.length)&&void 0!==i?i:0)}disposeClient(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this.unregisterClient(e);if(i&&((0,eM.$Z)(e),(0,eM.$Z)(e.cache),function(e){let t=window;for(t.__APOLLO_CLIENTS__&&(t.__APOLLO_CLIENTS__=t.__APOLLO_CLIENTS__.filter((t=>t.client!==e)));t;)t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__&&t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__.ApolloClient===e&&(t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__.ApolloClient=void 0),t.__APOLLO_CLIENT__&&t.__APOLLO_CLIENT__===e&&(t.__APOLLO_CLIENT__=void 0),t=t.parent===t?null:t.parent}(e)),i&&t){const{scenarioFactory:t}=null!==(n=this.services)&&void 0!==n?n:{},i=null==t?void 0:t.newScenario(it.RG.ApolloClientDisposion);try{e.stop(),yield e.clearStore(),e.setLink(cM),e.setResolvers([]),null==i||i.stop()}catch(e){null==i||i.fail({reason:String(e)})}}}))}disposeClients(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this._client&&(yield this.disposeClient(this._client,e),e&&(this._client=void 0))}))}destroyClient(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.disposed){this.disposed=!0;const{enableApolloClientDisposion:n}=null!==(t=null===(e=this.services)||void 0===e?void 0:e.coreSettings.get(L.J.Core))&&void 0!==t?t:{};yield this.disposeClients(null!=n&&n)}}))}setupWatchQueryTracking(e){const t=e.cache;if(dM.patchedCaches.has(t))return;const n=t.watch;t.watch=(i,...a)=>{this.trackReadOperation(e,i,!0);const o=n.call(t,i,...a);return()=>(this.trackReadOperation(e,i,!1),o())},dM.patchedCaches.set(t,n)}trackReadOperation(e,t,n){var i;this.ctx&&this.services&&(e instanceof dM||null===(i=this.services.dataOpsTracker)||void 0===i||i.trackOperation(t,this.name,this.schemaId,n))}trackWriteOperation(e,t){var n;this.ctx&&this.services&&(e instanceof dM||null===(n=this.services.dataReleaseService)||void 0===n||n.trackWriteOperation(t))}maybeGetGraphQLStoreStatsReporterService(e){var t,n;return e instanceof dM||!(null===(t=this.services)||void 0===t?void 0:t.graphqlStoreStatsReporterService)?null:null===(n=this.services)||void 0===n?void 0:n.graphqlStoreStatsReporterService}}dM.patchedCaches=new WeakMap;const uM=e=>e;class mM extends dM{constructor(e,t,n,i,a,o){super(e,i,n,a||"INVALID",o),this.parent=t}getApolloClientInstance(e){const t=(0,Ex.p$)(e);if("OperationDefinition"===t.kind||"FragmentDefinition"===t.kind){const{selectionSet:{selections:n}}=t,i=this.getSharedGlobalOperationsList(t),a=n.map((e=>"Field"===e.kind&&-1===i.indexOf(e.name.value)));if(a.every(uM))return this.client;if(a.some(uM)){const t=(0,An.Tr)(this.className,he.jK.InvalidInput,"route",{operation:e},"Operation contains mix of shared and window private selections");throw console.log(t),t}}return this.parent}getSharedGlobalOperationsList(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation?this.parentMutations:"OperationDefinition"===e.kind&&"subscription"===e.operation?this.parentSubscriptions:this.parentQueries}}class gM extends mM{constructor(e,t,n,i,a){super(e,t,n,i,i.windowId,a)}get parentQueries(){return Ax}get parentSubscriptions(){return Dx}get parentMutations(){return Fx}get className(){return"ChildDataClient"}clone(e){throw new Error("Trying to clone child instance")}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}}class pM extends dM{constructor(e,t,n,i){super(e,n,t,n.windowId||"INVALID",i)}clone(e){throw new Error("Trying to clone child instance")}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:null,selfIsMainClient:!!this.ctx&&this.ctx.windowId===he.ew}}}class vM extends pM{constructor(){super(...arguments),this.schemaId=Hx.ViewSchema}subscribe(e){const t=this.getApolloClientInstance(e.query),n=this.patchOptions(e);return t.subscribe(n)}}var hM=n(388294);class fM extends dM{constructor(e,t,n,i){super(e,n,t({windowId:n.windowId||he.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"core",storeType:Kx.t.core}),n.windowId||he.ew,Kx.t.core),this.createApolloClient=t,this.overrideLink=null,this.viewSchemaClient=null,this.overrideLink=null,i&&(this.viewSchemaClient=i({windowId:n.windowId||he.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"core-viewSchema",storeType:Kx.t.viewSchema}),this.registerClient(this.viewSchemaClient))}updateContext(e,t){super.updateContext(e,t),this.overrideLink=t}clone(e){return e.windowId===he.ew?new pM(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType):new gM(this.getServices(),this,this.createApolloClient({windowId:e.windowId,entityType:e.entityType,viewportContext:e.windowProvider.viewportContext,name:`child-${e.windowId}`,overrideLink:this.overrideLink,storeType:Kx.t.window}),Object.assign(Object.assign({},this.ctx),e),Kx.t.window)}cloneForViewSchema(e){return hM(this.viewSchemaClient,"View schema must be avaliable"),new vM(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),Kx.t.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class yM extends dM{constructor(e,t,n){super(e,n,t,n.windowId||he.ew,Kx.t.embed)}clone(e){return new pM(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType)}}var bM=n(710099),SM=n(939052),kM=n(211550),wM=n(373697);const CM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"WriteCallingDefaults"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingDebugTool"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"passiveBarHiddenParticipantsCount"}}]}},{kind:"Field",name:{kind:"Name",value:"streamPermissionsDebug"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"acknowledged"}},{kind:"Field",name:{kind:"Name",value:"acknowledgementRequired"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"Field",name:{kind:"Name",value:"pptSharingSession"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"_"}}]}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"calls"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};const _M={callingDebugTool:{__typename:"CallingDebugTool",visible:!0,passiveBarHiddenParticipantsCount:0},streamPermissionsDebug:{__typename:"StreamPermissionsDebug",acknowledged:!1,acknowledgementRequired:!1,url:"https://www.microsoft.com/"},pptSharingSession:{__typename:"ActivePptSession",_:!1},isFake:!1,calls:[]},TM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}},{kind:"Field",name:{kind:"Name",value:"lastLoggedInUserMri"}}]}}]}}]},IM={Query:{lpcState:(e,t,{cache:n})=>n.readQuery({query:TM})},Mutation:{setLpcState(e,{newLpcState:t},{cache:n}){const i={lpcState:Object.assign(Object.assign({},t),{__typename:"LpcState"})};return n.writeQuery({query:TM,data:i}),i.lpcState}}};var EM=n(752823);const NM=(e,t,n)=>{(0,EM.k)(e),function(e,t){const n=t.newLogger("writeCallingDefaults","data-client-calling");(0,bM.tW)(e),(0,bM.bC)(e);try{e.writeQuery({query:CM,data:_M})}catch(e){n.error(`Fail to write calling defaults - ${e}`)}try{e.writeQuery({query:SM.a,data:{shouldShowVideoEffectsPreview:!1}})}catch(e){n.error(`Fail to write default value of shouldShowVideoEffectsPreview - ${e}`)}try{e.writeQuery({query:kM.z,data:{shouldKeepPreviewWindowInSidePanelOpen:!1}})}catch(e){n.error(`Fail to write default value of shouldKeepPreviewWindowInSidePanelOpen - ${e}`)}try{e.writeQuery({query:wM.Q,data:{shouldAvatarMenuItemSelected:!0}})}catch(e){n.error(`Fail to write default value of shouldAvatarMenuItemSelected - ${e}`)}}(e,t),function(e){e.writeQuery({query:TM,data:{lpcState:{__typename:"LpcState",isLivePersonaCardInitialized:!1,lastLoggedInUserMri:null}}})}(e),n&&AM(e,n,t)},AM=(e,t,n)=>{const i=n.newLogger("appDefaults","data-client-core"),a=t.length;i.log(`Writing ${a.toString()} app default values to the Apollo cache.`),t.forEach((t=>{var n,a;try{const{queryFieldName:n,gqlTypeName:i}=t,a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:`${i}DefaultQuery`},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:n},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}}]},o={[n]:{__typename:i}};e.writeQuery({query:a,data:o})}catch(e){const o=`Failed to write ${t.gqlTypeName} to cache as Query field ${t.queryFieldName}.`;null!==(a=null===(n=i.errorToTelemetry)||void 0===n?void 0:n.call(i,o,"webclient_framework_foundation_core_services_active_application_hooks",void 0,!0))&&void 0!==a||i.error(o)}}))};class FM extends RF{constructor(e){super(),this.shellWindow=e,this.shellWindow.opener.addEventListener(n_.rY.CentralDataLayerResponse,(e=>{this.onResponseReceived(e)}))}sendMessage(e){this.shellWindow.opener.postMessage(n_.rY.CentralDataLayerRequest,{dataLayer:e})}}function DM(e){return new nM.i((t=>{const{query:n,variables:i,operationName:a}=t,o=t.getContext(),r={callerInfo:null==o?void 0:o.callerInfo,callerScenarioId:null==o?void 0:o.callerScenarioId};return e.execute(n,i,a,null==o?void 0:o.rendererId,null==o?void 0:o.windowId,r)}))}const RM={mutation:new Set(["notifyWorkerSyncCanStart","notifyActiveContextChangedToCDLWorker"])};var xM=n(579612),MM=n(517668);function OM({resolvers:e,contextValue:t}){return new nM.i(((n,i)=>{const a=function(e,t){const{query:n}=e,i=(0,Ex.p$)(n);if("OperationDefinition"!==i.kind)return;const{operation:a,selectionSet:{selections:o}}=i;if("mutation"!==a)return;const r=function(e,t){let n;return e.forEach((e=>{if("Field"===e.kind){const i=function(e,t){let n;return t.forEach((({Mutation:t})=>{t[e]&&(n=n||t[e])})),n}(e.name.value,t);if(i){if(n)throw new Error("There cannot be more than 1 matching forward resolver for a document");n={selection:e,resolver:i}}}})),n}(o,t);if(!r)return;return function(e){if(!e.arguments.every((({name:e,value:t})=>"Variable"!==t.kind||t.name.value===e.value))){const t=e.arguments.map((e=>e.name.value)).join(","),n=e.arguments.map((e=>e.value.name.value)).join(",");throw new Error(`Argument name mismatch. Mutation queries, which have forward mutation resolvers should \n                    have a 1-1 name match between the document variable names and the field resolver variable names.\n                    Allowed argument names ${t} does not match the supplied argument names ${n}`)}}(r.selection),r.resolver}(n,e);if(!a)return i(n);const o=n.getContext();return(0,MM.p)(a(n.variables,Object.assign(Object.assign({},t),o))).flatMap((e=>(n.variables=e,i(n))))}))}var PM=n(513830);function LM(){return new nM.i(((e,t)=>t(e).map((t=>{if(!t.data||!e.query)return t;const{definitions:n}=e.query,i=n.find((e=>e.kind===PM.h.OPERATION_DEFINITION));if(!i||!i.selectionSet)return t;try{const e=i.selectionSet.selections,n=UM(jM(t.data),e);return t.data=n,t}catch(e){return t}}))))}function UM(e,t){for(const n of t){if(n.kind!==PM.h.FIELD)continue;const t=n.name.value;if("__typename"!==t)if(t in e){if(null!==e[t]&&n.selectionSet&&n.selectionSet.selections){e[t]=jM(e[t]);const i=n.selectionSet.selections;UM(e[t],i)}}else e[t]=null}return e}function jM(e){return Array.isArray(e)?e.slice():"object"==typeof e?Object.assign({},e):e}var $M=n(804117);function BM(e){return"subscription"===e.operationType}function WM(e){const{operation:t,graphQLErrors:n,operationType:i}=e,a=t.getContext(),o={operationName:t.operationName,operationType:i,rendererId:a.windowId};return n&&n.length>0&&(o.errors=n.map((e=>function(e,t){let n=he.jK.UnhandledRuntimeException;const i={path:t};if(!e)return i;e.code?n=e.code:"Failed to fetch"===e.message&&(n=he.jK.FailedToFetch);if(i.code=n,e.hasOwnProperty("serverResponse")&&e.serverResponse){"number"==typeof e.serverResponse.status&&(i.status=e.serverResponse.status),i.mscv=e.serverResponse.headers["ms-cv"],i.xmsCorrelationId=e.serverResponse.headers["x-ms-correlation-id"];try{i.contextId=JSON.stringify(e.serverResponse.headers.contextid)}catch(e){}}return i}(e.originalError,e.path&&e.path.join("::"))))),o}function HM(e,t,n){!VM(e)&&n&&function(e,t,n){const i=WM(e);if(i.errors&&i.errors.length>0){!function(e,t){const{operation:n,operationType:i}=e;t.error(`'${n.operationName}' operation of type '${i}' failed.`)}(e,t);const a=Object.assign(Object.assign({},i),{errors:"","Panel.WindowID":i.rendererId});i.errors[0].code===he.jK.FailedToFetch?n.cancel(a):n.fail(a)}else n.stop({operationName:i.operationName,operationType:i.operationType,"Panel.WindowID":i.rendererId})}(e,t,n)}function VM(e){return BM(e)}function zM(e,t,n,i,a){const o=e.newLogger("TrackRequestLink","data-resolvers-browser-common");return new nM.i(((e,r)=>{const{query:s}=e,{operation:l}=(0,YD.S)(s,null),c=r(e);let d;return n&&(null==a||a.addOperation(e.operationName,l,"Request")),i&&(d=function(e,t){let n;return VM(e)||(n=t.newScenario(it.RG.QueryExecution)),n}({operationType:l,operation:e},t)),new iM.y((t=>{let r;try{r=c.subscribe({next:r=>{i&&(r.errors&&r.errors.length>0?HM({operation:e,operationType:l,graphQLErrors:r.errors,response:r},o,d):function(e,t){if(!BM(e)&&t){const n=WM(e);t.mark(it.ck.QueryResult,{operationName:n.operationName,operationType:n.operationType,"Panel.WindowID":n.rendererId})}}({operation:e,operationType:l,response:r},d)),n&&(null==a||a.addOperation(e.operationName,l,"Response")),t.next(r)},error:r=>{const s=(e=>e&&e.result?e.result.errors:e instanceof Error?[new $M._("Unhandled exception",void 0,void 0,void 0,void 0,e)]:[new $M._("Unknown error payload provided from forward link")])(r);i&&HM({operation:e,operationType:l,graphQLErrors:s},o,d),n&&(null==a||a.addOperation(e.operationName,l,"Error")),t.error(r)},complete:()=>{i&&HM({operationType:l,operation:e},o,d),d=void 0,t.complete()}})}catch(t){throw i&&HM({operationType:l,operation:e,graphQLErrors:[new $M._("Unhandled exception in forward link",void 0,void 0,void 0,void 0,t)]},o,d),d=void 0,t}return()=>{i&&HM({operationType:l,operation:e},o,d),d=void 0,r&&r.unsubscribe()}}))}))}const qM=new class{constructor(){this.map=new Map}destroy(e){const t=this.map.get(e);t&&(t.subscriptions.forEach((e=>{e.next(void 0),e.complete()})),t.subscriptions.length=0,this.map.delete(e))}register(e){if(!this.map.has(e)){const t=new iM.y((t=>{const{subscriptions:n}=this.map.get(e)||{};n&&n.push(t)}));this.map.set(e,{cancellationObservable:t,subscriptions:[]})}return this.map.get(e).cancellationObservable}};function GM(e){qM.destroy(e)}function JM(e,t){const n=e.newLogger("TrackSubscriptionLinks","data-resolvers-browser-common");return new nM.i(((e,i)=>{const{eventsWithoutCancellationListener:a}=t.get(L.J.Calling),{operationName:o,query:r}=e,{operation:s}=(0,YD.S)(r,null);if("subscription"!==s||(null==a?void 0:a.includes(o)))return i(e);const l=(0,Ye.v4)(),c=qM.register(l);return n.debug(`Forwarding request ${l} for operation ${o}`),e.setContext((e=>Object.assign(Object.assign({},e),{cancellationListener:c}))),new iM.y((t=>{let n;try{const a=i(e);n=a.subscribe({next:e=>{var n;(null===(n=null==e?void 0:e.errors)||void 0===n?void 0:n.length)&&GM(l),t.next(e)},error:e=>{GM(l),t.error(e)},complete:()=>{GM(l),t.complete()}})}catch(e){throw GM(l),e}return()=>{GM(l),n&&n.unsubscribe()}}))}))}function QM(e){qM.destroy(e)}function KM(e,t,n=!1){const i=new Map,a=new Map;if(!e)throw new Error("Need an operation name to support");return new nM.i(((o,r)=>{if(!((e,t)=>{const{query:n}=e,i=(0,Ex.p$)(n);if(!i||"OperationDefinition"!==i.kind)return!1;const{selectionSet:{selections:a}}=i,{operation:o}=(0,YD.S)(n,null);if("subscription"!==o)return!1;if(a.length>1)throw new Error("There cannot be more than 1 selection for this link");const r=a[0];if("Field"===r.kind&&r.name.value===t){if(r.arguments.every((({name:e,value:t})=>"Variable"!==t.kind||t.name.value===e.value)))return!0;throw new Error("Argument name must match value")}return!1})(o,e))return r(o);const s=(l=o.variables,JSON.stringify(Object.keys(l).sort().map((e=>{const t=l[e];if(-1!==["boolean","string"].indexOf(typeof t)||null===t||Number.isSafeInteger(t))return[e,t];throw new Error("Unsupported argument type")}))));var l;return new iM.y((e=>{const l=i.get(s);if(l)l.observersCollection.push(e),n&&a.has(s)&&e.next(a.get(s));else{let l="";if(t&&t.get(L.J.Calling).enableSubscriptionCancellationListener){l=(0,Ye.v4)();const e=qM.register(l);o.setContext((t=>Object.assign(Object.assign({},t),{cancellationListener:e})))}try{const t=r(o).subscribe({next:e=>{n&&a.set(s,e);i.get(s).observersCollection.slice().forEach((t=>{t.next(e)}))},error:e=>{const{observersCollection:t}=i.get(s);i.delete(s);for(const n of t)n.error(e)},complete:()=>{const{observersCollection:e}=i.get(s);i.delete(s);for(const t of e)t.complete()}});i.set(s,{observersCollection:[e],forwardSubscription:t,requestId:l})}catch(e){throw null!==l&&""!==l&&QM(l),e}}return()=>{const t=i.get(s);if(!t)return;const{observersCollection:n,forwardSubscription:o,requestId:r}=t,l=n.indexOf(e);-1!==l&&(n.splice(l,1),0===n.length&&(i.delete(s),a.delete(s),null!==r&&""!==r&&QM(r),o&&o.unsubscribe()))}}))}))}var YM=n(951412);function XM(e){const t=e();return new nM.i(((e,n)=>{const i=t.then((t=>t.request(e,n)));return new iM.y((e=>{let t;return i.then((n=>{e.closed||(t=null==n?void 0:n.subscribe(e))}),(t=>{e.closed||e.error(t)})),()=>null==t?void 0:t.unsubscribe()}))}))}var ZM=n(251795),eO=n(706900),tO=n(122393);const nO=(e,t="resolverUncaughtErrorBoundary__doNotAssignToGraphQLTeam")=>(0,tO.q)((({graphQLErrors:n})=>{const i=e.newLogger(t,"data-client-core");n&&n.forEach((({path:e})=>{if(e){const t=function(e){return e.map((e=>"number"==typeof e?`[${e.toString()}]`:`${e}`)).join(".")}(e);i.error(`Uncaught error in a GraphQL resolver, at field selection path: ${t}`)}else i.error("Unknown uncaught error in a GraphQL resolver")}))}));function iO(e,t,n){if(!t||0===Object.keys(t).length)return!1;const{query:i}=e,a=(0,Ex.p$)(i);if(!a||a&&"OperationDefinition"!==a.kind)return!1;const{selectionSet:{selections:o}}=a,r=(0,YD.S)(i,null);if(!r)return!1;const s=r.operation;let l=!1;return o.every((e=>{if("Field"===e.kind){if(t[s]&&t[s].has(e.name.value))return l=!0,!0;if(l){n.newLogger("isDataLayerClientOperationSupported","data-client-core").error(`Unexpected partially supported operation - unsupported selection = ${e.name.value}`)}}return!1}))}class aO{static createSingletonLink(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(aO._singletonLink)throw new Error("Links are already created");return aO._singletonLink=nM.i.from(yield aO.createDefaultLinks(e)),aO._singletonLink}))}static createLink(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return nM.i.from(yield aO.createDefaultLinks(e))}))}static get singletonLink(){return aO._singletonLink}static createViewSchemaLink(e){return this._viewSchemaImportPromise||(this._viewSchemaImportPromise=Promise.all([n.e(87306),n.e(933181)]).then(n.bind(n,996450))),nM.i.from([nO(e.loggerFactory,"apolloViewSchemaLinkCatchedErrors"),this.createLazyViewSchemaTerminatingLink(e,this._viewSchemaImportPromise)])}static createLazyViewSchemaTerminatingLink(e,t){let n;return this._viewSchemaImport&&this._viewSchemaExecutor?this._viewSchemaImport.createViewSchemaTerminatingLink(e,this._viewSchemaExecutor):new nM.i(((i,a)=>new iM.y((o=>{let r,s=!1;return t.then((t=>(this._viewSchemaExecutor||(this._viewSchemaExecutor=new t.ViewSchemaExecutor),this._viewSchemaImport||(this._viewSchemaImport=t),n||(n=t.createViewSchemaTerminatingLink(e,this._viewSchemaExecutor)),n))).then((e=>{var t;s||(r=null===(t=e.request(i,a))||void 0===t?void 0:t.subscribe({next:o.next.bind(o),error:o.error.bind(o),complete:o.complete.bind(o)}))})).catch(o.error.bind(o)),()=>{s=!0,r&&r.unsubscribe()}}))))}static createPatchVariablesLink(e){return OM({contextValue:e,resolvers:[xM.s]})}static createTerminatingLink({config:e,contextValue:t,cdlWorkerService:a,dataClientTrackingService:o,loggerFactory:r,scenarioFactory:s,coreSettings:l,leakDetectorService:d,windowProvider:u},m){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const g=aO.createMainRendererTerminatingLink(e.clientId,r,s,u,l,d,o),{enableClassBasedErrors:p,enableSupermassiveWebLink:v}=l.get(L.J.Core),h={contextValue:t,enableClassBasedErrors:!!p},f=v?function(e,t){return XM((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield(0,c.mT)((()=>Promise.all([n.e(87306),n.e(438309),n.e(355884),n.e(253506)]).then(n.bind(n,53350))),"supermassive-incremental-link",t)).supermassiveIncrementalSchemaLink(e,t)}))))}(h,s):nM.i.concat(function(e,t){return XM((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield(0,c.mT)((()=>Promise.all([n.e(438309),n.e(355884),n.e(4387)]).then(n.bind(n,812374))),"incremental-link",t)).incrementalSchemaLink(e,t)}))))}(h,s),(0,YM.c)()),y=r.newLogger("createTerminatingLink","data-client-core"),b=(0,eO.Om)(l,y);let S=nM.i.split((e=>function(e,t,n,i){const{enableCentralDataLayer:a}=n.get(L.J.Host);return!!a&&iO(e,t,i)}(e,b,l,r)),(0,ZM.z)(LM(),g),f);return(0,ID.Q6)(l)&&!m&&(S=yield aO.createCDLWorkerTerminatingLink(a,e,r,s,l,y,S)),S}))}static createMainRendererTerminatingLink(e,t,n,i,a,o,r){const s=a.get(L.J.Cdl),{logCdlOperationsDuringWaitSettings:l}=a.get(L.J.Core),c=this.createDataLayerClientSettings(a);return DM(new eR(e,t,n,new FM((0,Ue.J)()),o,"Angular",i,{enableRequestHealthMonitor:!!s.enableRequestHealthMonitor,failureCountThreshold:s.requestHealthMonitorFailureCountThreshold,timeoutCountThreshold:s.requestHealthMonitorTimeoutCountThreshold,timeoutLengthSeconds:s.requestHealthMonitorTimeoutLengthSeconds},void 0,void 0,{enableLoggingCdlOperationsDuringWait:null==l?void 0:l.enableLoggingCdlOperationsDuringWait,enableTrackingCdlOperationsDuringWait:null==l?void 0:l.enableTrackingCdlOperationsDuringWait,trackingCdlOperationsDuringWaitThresholdInMs:null==l?void 0:l.trackingCdlOperationsDuringWaitThresholdInMs,trackingCdlOperationsDuringWaitBufferSize:null==l?void 0:l.trackingCdlOperationsDuringWaitBufferSize},r,void 0,c))}static createDataLayerClientSettings(e){const{cdlSubscriptionAggregatorAllowList:t,loggableOperationVariablesAllowList:n,cdlSubscriptionAggregatorLogIntervalMS:i}=e.get(L.J.CdlWorker);return{cdlSubscriptionAggregatorAllowList:t||void 0,loggableOperationVariablesAllowList:n||void 0,cdlSubscriptionAggregatorLogIntervalMS:i||void 0}}static createCDLWorkerTerminatingLink(e,t,n,a,o,r,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e)return r.warn("Not creating CDL Worker terminating link. Worker is enabled, but service is unavailable."),s;const i=yield e.getCDLWorkerManager();if(!i)return r.warn("Not creating CDL Worker terminating link. Worker is enabled, service is available but workerManager is not defined."),s;const l=DM(yield e.getDataLayerClient()),c=(0,eO.Ng)(o,r,i.cdlWorkerSupportedResolvers);return s=nM.i.split((e=>function(e,t,n){return iO(e,t,n)}(e,c,n)),(0,ZM.z)(LM(),l),s),o.get(L.J.CdlWorker).enableControlPlaneLink&&(s=yield aO.createCDLWorkerControlPlaneTerminatingLink(e,t,n,a,s,o)),s}))}static createCDLWorkerControlPlaneTerminatingLink(e,t,n,a,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield e.getControlPlaneCommunicator(),s=DM(new eR(t.clientId,n,a,i,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.createDataLayerClientSettings(r)));return o=nM.i.split((e=>function(e,t){return iO(e,RM,t)}(e,n)),(0,ZM.z)(LM(),s),o)}))}}aO._singletonLink=null,aO._viewSchemaExecutor=null,aO.createDefaultLinks=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{contextValue:t,loggerFactory:n,scenarioFactory:i,coreSettings:a,noCDLTerminatingLink:o}=e,r=yield aO.createTerminatingLink(e,o),s=aO.createPatchVariablesLink(t),l=a.get(L.J.Core).enableGraphQlOpsCount,c=a.get(L.J.Core).enableTrackRequestsLink,d=l||c?[zM(n,i,l,c,t.graphqlOpsCountService)]:[],u=a.get(L.J.Calling).enableSubscriptionCancellationListener?[JM(n,a)]:[],m=KM("presenceUpdateEvent",a,!0),g=KM("callParticipantUpdatedEvent",a),p=KM("callParticipantsChangedEvent",a),v=KM("callParticipantsVoiceLevelsChangedEvent",a),h=KM("chatServiceEvent",a),f=KM("blockedContactChangedEvent",a,!0);return[...d,...u,s,nO(n),m,g,p,v,h,f,r]}));var oO=n(486998);const rO=()=>(0,oO.ZB)(["filter","typeFilter"]);function sO(e,t){return t("timestamp",e||{})||""}const lO=()=>{const e=(0,oO.ZB)(!1),{read:t,merge:n}=e,o=(0,i.__rest)(e,["read","merge"]);return Object.assign(Object.assign({},o),{merge:(e,t,i)=>{var o,r;if("function"==typeof n){const s=n(e,t,i),{readField:l}=i;let c=(0,a.uniqBy)(s.edges,(e=>l("id",e.node)));return c=c.filter((e=>!l("deleteTime",e.node))),Object.assign(Object.assign({},s),{edges:c,pageInfo:Object.assign(Object.assign({},null==s?void 0:s.pageInfo),{startCursor:l("timestamp",null===(o=(0,a.head)(c))||void 0===o?void 0:o.node),endCursor:l("timestamp",null===(r=(0,a.last)(c))||void 0===r?void 0:r.node)})})}return n},read:(...e)=>{const n=e[0],{readField:i}=e[1];if(!n||!t)return;if(!n.edges)return n;const a=[...n.edges].sort(((e,t)=>function(e,t,n){const i=null==e?void 0:e.node,a=null==t?void 0:t.node,o=sO(i,n),r=sO(a,n);return o?r?parseInt(r,10)-parseInt(o,10):-1:1}(e,t,i)));return Object.assign(Object.assign({},t(...e)),{edges:a})}})};const cO=()=>{const e=(0,oO.ZB)(!1),{merge:t}=e,n=(0,i.__rest)(e,["merge"]);return Object.assign(Object.assign({},n),{merge:(e,n,i)=>{if(dO(t)){if(!e)return n;const{readField:o}=i,r=t(e,n,i),s="objectId",l=(0,a.uniqBy)(r.edges,(e=>o(s,e.node)));return Object.assign(Object.assign({},r),{edges:l,pageInfo:Object.assign({},r.pageInfo)})}return t}})},dO=e=>"function"==typeof e,uO=e=>{const t=rM.Query||{fields:{}};return Object.assign(Object.assign(Object.assign({},rM),e),{Query:Object.assign(Object.assign({},t),{fields:Object.assign(Object.assign({},t.fields),{chats:rO(),recentsChats:rO(),pinnedChats:rO(),activities:lO(),suggestedContactsInChatList:(0,oO.ZB)(["filter","typeFilter"]),replyChainMessages:Object.assign(Object.assign({},(0,oO.ZB)(["channelId","replychainId"])),{read:e=>e}),replyChainSummaries:Object.assign(Object.assign({},(0,oO.ZB)(["channelId"])),{read:e=>e}),fluidMessages:{merge:(e,t)=>[...t]},feed:{merge:!0},calendarEventsV3WithPagination:cO(),pinnedChannels:{merge:!1}})})})},mO=e=>"cache-and-network"===e||"network-only"===e?"cache-first":e;var gO=n(486403);const pO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quotedReply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quotedReply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}}]};var vO=n(844943);var hO=n(867634);var fO=n(183481),yO=n(367243),bO=n(445682),SO=n(652941);const kO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chat"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingInformationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}}]}},...fO.T.definitions,...yO.v.definitions,...bO.f.definitions,...SO.qL.definitions]},wO=e=>({__typename:"ChatDisabledContext",isUIDisabled:e.isUIDisabled,disabledReason:e.disabledReason,extendedData:e.extendedData,lastUpdatedTime:e.lastUpdatedTime}),CO=()=>({__typename:"ChatDisabledContext",isUIDisabled:!1,disabledReason:C.Z4B.UnknownReason,extendedData:null,lastUpdatedTime:null}),_O=()=>({__typename:"ChatDisabledContext",isUIDisabled:!1,disabledReason:C.Z4B.ChatDisabledDueToBotStatus,extendedData:null,lastUpdatedTime:null}),TO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidMessages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}}]}}]}}]},IO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidManifestEntries"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidManifestEntries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"entries"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}}]},EO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidPendingMentions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"componentHash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidPendingMentions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"componentHash"},value:{kind:"Variable",name:{kind:"Name",value:"componentHash"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"atMentionId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"contentId"}},{kind:"Field",name:{kind:"Name",value:"navigationPath"}}]}}]}}]};const NO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"composeState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"composeState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isExpanded"}}]}}]}}]},AO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"imageAltText"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"imageAltText"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var FO=n(930262),DO=n(675953);const RO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messagePaneScrolledToStartState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messagePaneScrolledToStartState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isScrolledToStart"}}]}}]}}]},xO={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForTranslation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}}]}}]}}]},MO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"twoWaySmsFriendlyName"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"twoWaySmsFriendlyName"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var OO=n(252959);const PO={Query:{fluidManifestEntries:(e,{locale:t},{cache:n,loggerFactory:i})=>((e,t,n)=>{try{const n=e.readQuery({query:IO,variables:{locale:t}});return null==n?void 0:n.fluidManifestEntries}catch(e){return void n.newLogger("fluid-manifest-entries","data-client-chat").error("Failed to retrieve the cached fluid manifest json")}})(n,t,i)||null,requestImmersiveReader:(e,{conversationId:t,messageId:n,setFocusOnClose:i},a)=>function(e,t,n){return(0,Ue.J)().opener.open(b_.B.OpenOnMainRenderer,b_._.ImmersiveReader,{conversationId:e,messageId:t,setFocusOnClose:n}),!0}(t,n,i)},Conversation:Object.assign({isFederated(e){var t;return null!==(t=e.isFederated)&&void 0!==t?t:(0,kb.eX)(e.id)},isMeeting(e){var t;return null!==(t=e.isMeeting)&&void 0!==t?t:(0,kb.e9)(e.id)},isSfB(e){var t;return null!==(t=e.isSfB)&&void 0!==t?t:(0,vO.Jn)(e.id)},chatDisabledContext:e=>(e=>{if(!e)return null;if(!e.chatDisabledContext){const t=e;return t&&t.isDisabled&&t.isOneOnOne&&t.hasBotMember?_O():CO()}return e.chatDisabledContext})(e)},{isHighImportance:()=>null,isUrgentImportance:()=>null,activeCallsCount:()=>null,datatid:()=>null,displayName:()=>null,hasActiveCalls:()=>null,hasFailedMessages:()=>null,otherMemberMris:()=>null,isNewChat:()=>null,isBotBlocked:()=>null,isBotUser:()=>null,isHidden:()=>null,isContactTagged:()=>null,pictureUpn:()=>null,pinnedIndex:()=>null,showAtMention:()=>null,showMarkers:()=>null,tooltipTitle:()=>null,longTitle:()=>null,pictureGroup:()=>null,lastMessageTime:()=>null,messagePreview:()=>null,messagePreviewAria:()=>null,isLastMessageText:()=>null,plGroupKey:()=>null,presenceSource:()=>null,hasActions:()=>null,canBeDiscarded:()=>null,canBotBeBlocked:()=>null,canBePinned:()=>null,canBeMuted:()=>null,canBeLeft:()=>null,canBeHidden:()=>null,canBeFavorited:()=>null,canTagContact:()=>null,canPopOut:()=>null,canManageApps:()=>null}),Mutation:{untranslateMessage:(e,{messageId:t},{cache:n,loggerFactory:i})=>function(e,t,n){if(!t)return null;const i=hO.Ps`
    fragment originalMessageFields on Message {
      id
      content
    }
  `;try{const n=e.readFragment({id:`Message:${t}`,fragment:i});return n?n.content:null}catch(e){return n.error(`Failed to get message from cache: ${e}`),null}}(n,t,i.newLogger("untranslateMessage","data-client-chat")),updateChatDisabledContext:(e,{convId:t,isUIDisabled:n,disabledReason:i,extendedData:a},{cache:o})=>((e,t,n,i,a)=>{const o={convId:t},r={__typename:"ChatDisabledContextResponse",message:"",success:!1,chatDisabledContext:CO()};try{const t=e.readQuery({query:kO,variables:o});if(!t||!t.chat)return r.message="Could not update chatDisabledContext for a null chat conversation",r;const s=Date.now().toString();t.chat.chatDisabledContext&&(r.chatDisabledContext=Object.assign({},t.chat.chatDisabledContext));const l={__typename:"ChatDisabledContext",isUIDisabled:n,disabledReason:i,extendedData:a,lastUpdatedTime:s},c={chat:Object.assign(Object.assign({},t.chat),{chatDisabledContext:l})};e.writeQuery({query:kO,variables:o,data:c}),r.success=!0,c&&c.chat&&c.chat.chatDisabledContext&&(r.chatDisabledContext=wO(c.chat.chatDisabledContext))}catch(e){r.message=`Exception: Failed to update chatDisabledContext for conversation ${t}. Exception Details: ${e.message}`}return r})(o,t,n,i,a),resetQuotedReply:(e,{convId:t},{cache:n})=>((e,t)=>(t.writeQuery({query:pO,variables:{convId:e},data:{quotedReply:null}}),!0))(t,n),setQuotedReply:(e,{convId:t,quotedReply:n},{cache:i})=>((e,{displayName:t,from:n,messageId:i,preview:a,timestamp:o},r)=>{const s={quotedReply:{__typename:"QuotedReply",displayName:t,from:n,messageId:i,preview:a,timestamp:o}};return r.writeQuery({query:pO,variables:{convId:e},data:s}),!0})(t,n,i),updateComposeState(e,{id:t,isExpanded:n},{cache:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"ComposeMessageState",id:t,isExpanded:n};try{a.writeQuery({query:NO,variables:{id:t},data:{composeState:Object.assign(Object.assign({},e),{__typename:"ComposeMessageState"})}})}catch(e){o.newLogger("update-compose-state","data-client-chat").error(`Failed to write to client cache the compose state query. Error: ${e.message}`)}return e}))},setImageAltText(e,{altText:t},{cache:n,loggerFactory:a}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={imageAltText:t};try{n.writeQuery({query:AO,data:e})}catch(e){a.newLogger("update-image-alt-text","data-client-chat").error(`Failed to write to client cache the image alt text query. Error: ${e.message}`)}return!0}))},insertHyperlink(e,{displayText:t,address:n},{cache:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"FluidInsertedHyperlink",displayText:t,address:n};try{a.writeQuery({query:FO.D,data:{insertedHyperlink:Object.assign(Object.assign({},e),{__typename:"FluidInsertedHyperlink"})}})}catch(e){o.newLogger("insert-hyperlink-dialog-data","data-client-chat").error(`Failed to write to client cache the insert hyperlink dialog data query. Error: ${e.message}`)}return!0}))},setTwoWaySmsFriendlyName(e,{twoWaySmsFriendlyName:t},{cache:n,loggerFactory:a}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={twoWaySmsFriendlyName:t};try{n.writeQuery({query:MO,data:e})}catch(e){a.newLogger("update-tfl-two-way-sms-friendly-name","data-client-chat").error(`Failed to write to client cache the tfl two way sms friendly name query. Error: ${e.message}`)}return!0}))},updateMessagePaneScrolledToStartState(e,{id:t,isScrolledToStart:n},{cache:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"MessagePaneScrolledToStartState",id:t,isScrolledToStart:n};try{a.writeQuery({query:RO,variables:{id:t},data:{messagePaneScrolledToStartState:Object.assign(Object.assign({},e),{__typename:"MessagePaneScrolledToStartState"})}})}catch(e){o.newLogger("update-chat-bottom-state","data-client-chat").error(`Failed to write to client cache the chat bottom state query. Error: ${e.message}`)}return e}))},setDlpDialogData(e,{isReport:t,isOverride:n,justification:a},{cache:o,loggerFactory:r}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"DlpDialogData",isReport:t,isOverride:n,justification:a};try{o.writeQuery({query:DO.C,data:{dlpDialogData:Object.assign(Object.assign({},e),{__typename:"DlpDialogData"})}})}catch(e){r.newLogger("set-dlp-dialog-data","data-client-chat").error(`Failed to write to client cache the set dlp dialog data query. Error: ${e.message}`)}return e}))},setFluidMessage:(e,{fluidMessage:t,remove:n},{cache:i,loggerFactory:a})=>(({messageId:e,originalArrivalTime:t},n,i,a)=>{try{const a=i.readQuery({query:TO}),o=n?function(e,t){var n;return{fluidMessages:(null===(n=null==e?void 0:e.fluidMessages)||void 0===n?void 0:n.filter((e=>e.messageId!==t)))||[]}}(a,e):function(e,t,n){const i=[],a={__typename:"FluidMessage",id:t,messageId:t,originalArrivalTime:n};let o=!1;if(null==e?void 0:e.fluidMessages)for(const t of e.fluidMessages)t.originalArrivalTime<a.originalArrivalTime&&!o&&(i.push(a),o=!0),i.push(t);return o||i.push(a),{fluidMessages:i}}(a,e,t);return i.writeQuery({query:TO,data:o}),!0}catch(e){return a.newLogger("set-fluid-messages-pending-load","data-client-chat").error(`Failed to write to client cache the set fluid message pending load query. Error: ${e.message}`),!1}})(t,!!n,i,a),setFluidManifestEntries:(e,{locale:t,entries:n},{cache:i,loggerFactory:a})=>((e,t,n,i)=>{try{const i={fluidManifestEntries:{__typename:"FluidManifestEntries",locale:e,entries:t,timestamp:Date.now()}};return n.writeQuery({query:IO,variables:{locale:e},data:i}),!0}catch(e){return i.newLogger("fluid-manifest-entries","data-client-chat").error(`Failed to write to client cache that set fluid manifest json query. Error: ${e.message}`),!1}})(t,n,i,a),updateFluidPendingMentions:(e,{componentHash:t,pendingMention:n,remove:i},{cache:a,loggerFactory:o})=>((e,t,n,i,a)=>{try{const a=Object.assign({__typename:"FluidPendingMention"},t),o={componentHash:e},r=i.readQuery({query:EO,variables:o}),s=((null==r?void 0:r.fluidPendingMentions)||[]).filter((e=>a.userPrincipalName!==e.userPrincipalName)),l=n?s:[...s,a];return i.writeQuery({query:EO,variables:o,data:{fluidPendingMentions:l}}),!0}catch(e){return a.newLogger("fluid-resolvers-update-pending-fluid-mentions","data-client-chat").error(`Failed to write pending mentions to the cache, error="${e.message}"`),!1}})(t,n,!!i,a,o),clearFluidPendingMentions:(e,{componentHash:t},{cache:n,loggerFactory:i})=>((e,t,n)=>{try{const n={componentHash:e};return t.writeQuery({query:EO,variables:n,data:{fluidPendingMentions:[]}}),!0}catch(e){return n.newLogger("fluid-resolvers-clear-fluid-pending-mentions","data-client-chat").error(`Failed to clear pending mentions from the cache, error="${e.message}"`),!1}})(t,n,i),resetSmartReplyFileSuggestion:(e,{convId:t},{cache:n,loggerFactory:i})=>((e,t,n)=>{const i={smartReplyFileSuggestion:null};try{return t.writeQuery({query:OO.v,variables:{convId:e},data:i}),!0}catch(e){return n.newLogger("ResetSmartReplyFileSuggestion","data-client-chat").error(`Failed to reset smart reply file suggestion in cache: ${e}`),!1}})(t,n,i),setSmartReplyFileSuggestion:(e,{convId:t,fileSuggestion:n},{cache:i,loggerFactory:a})=>((e,{fileName:t,url:n},i,a)=>{try{const a={smartReplyFileSuggestion:{__typename:"SmartReplyFileSuggestion",fileName:t,url:n}};return i.writeQuery({query:OO.v,variables:{convId:e},data:a}),!0}catch(e){return a.newLogger("SetSmartReplyFileSuggestion","data-client-chat").error(`Failed to set smart reply file suggestion in cache: ${e}`),!1}})(t,n,i,a)},Message:{deletionInfo:(e,t,{cache:n})=>(0,gO.sE)(n,e),translation:(e,t,{cache:n})=>{var i;try{const t=`Message:${e.id}`,a=null===(i=n.readFragment({id:t,fragment:xO}))||void 0===i?void 0:i.translation;return a?Object.assign(Object.assign({},a),{__typename:"Translation"}):null}catch(e){return null}},diagnosticInfo:()=>({__typename:"DiagnosticInfo",diagnosticErrorCode:-1,diagnosticMessage:null})}},LO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormBlockingTasksQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormBlockingTasks"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}}]}}]},UO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormTerminatingActionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormTerminatingAction"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},jO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormActiveTabQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormActiveTab"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},$O={Query:{schedulingFormActiveTab(e,t,{cache:n,loggerFactory:i}){var a,o;try{const e=n.readQuery({query:jO});return null!==(a=null==e?void 0:e.schedulingFormActiveTab)&&void 0!==a?a:null}catch(e){const t=i.newLogger("scheduling-form-active-tab","data-client-calendar");return null===(o=t.errorToTelemetry)||void 0===o||o.call(t,"schedulingFormActiveTab: Failed to fetch scheduling form active tab from cache.","calendar_form_active_tab"),null}},schedulingFormBlockingTasks(e,t,{cache:n,loggerFactory:i}){var a,o;try{const e=n.readQuery({query:LO});return null!==(a=null==e?void 0:e.schedulingFormBlockingTasks)&&void 0!==a?a:[]}catch(e){const t=i.newLogger("scheduling-form-blocking-task","data-client-calendar");return null===(o=t.errorToTelemetry)||void 0===o||o.call(t,"schedulingFormBlockingTasks: Failed to fetch scheduling form blocking task from cache.","calendar_form_blocking_tasks"),[]}},schedulingFormTerminatingAction(e,t,{cache:n,loggerFactory:i}){var a,o,r;try{return null!==(o=null===(a=n.readQuery({query:UO}))||void 0===a?void 0:a.schedulingFormTerminatingAction)&&void 0!==o?o:null}catch(e){const t=i.newLogger("scheduling-form-terminating-action","data-client-calendar");return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,"schedulingFormTerminatingAction: Failed to fetch scheduling form terminating action from cache.","calendar_form_terminating_action"),null}}},Mutation:{addSchedulingFormBlockingTask(e,{input:{task:t}},{cache:n,loggerFactory:i}){var a,o,r,s;const l=i.newLogger("add-scheduling-form-blocking-task","data-client-calendar"),c=(0,Ye.v4)();try{const e=null!==(o=null===(a=n.readQuery({query:LO}))||void 0===a?void 0:a.schedulingFormBlockingTasks)&&void 0!==o?o:[],i=e.find((e=>e.type===t.type));if(i&&i.state===C.vDg.Active)return null===(r=l.errorToTelemetry)||void 0===r||r.call(l,"addSchedulingFormBlockingTask: Failed to write scheduling form blocking task in cache. Existing active task of same type already exists.","calendar_form_blocking_tasks"),null;const s=(i?e.filter((e=>e.type!==t.type)):e).concat([Object.assign(Object.assign({__typename:"SchedulingFormTask"},t),{id:c})]);n.writeQuery({query:LO,data:{schedulingFormBlockingTasks:s}})}catch(e){return null===(s=l.errorToTelemetry)||void 0===s||s.call(l,"addSchedulingFormBlockingTask: Failed to write scheduling form blocking task in cache.","calendar_form_blocking_tasks"),null}return Object.assign(Object.assign({},t),{id:c,__typename:"SchedulingFormTask"})},updateSchedulingFormBlockingTask(e,{input:{type:t,state:n}},{cache:i,loggerFactory:a}){var o,r,s,l;const c=a.newLogger("update-scheduling-form-blocking-task","data-client-calendar");try{let e=-1;const a=(null!==(r=null===(o=i.readQuery({query:LO}))||void 0===o?void 0:o.schedulingFormBlockingTasks)&&void 0!==r?r:[]).map(((i,a)=>(null==i?void 0:i.type)===t?(e=a,Object.assign(Object.assign({},i),{state:n})):i));return-1===e?(null===(s=c.errorToTelemetry)||void 0===s||s.call(c,"updateSchedulingFormBlockingTask: Failed to update scheduling form blocking task in cache. Task does not exist.","calendar_form_blocking_tasks"),null):a[e]}catch(e){return null===(l=c.errorToTelemetry)||void 0===l||l.call(c,"updateSchedulingFormBlockingTask: Failed to update scheduling form blocking task in cache.","calendar_form_blocking_tasks"),null}},removeSchedulingFormBlockingTask(e,{input:{type:t}},{cache:n,loggerFactory:i}){var a,o,r;const s=i.newLogger("remove-scheduling-form-blocking-task","data-client-calendar");try{const e=null!==(o=null===(a=n.readQuery({query:LO}))||void 0===a?void 0:a.schedulingFormBlockingTasks)&&void 0!==o?o:[],i=e.find((e=>e.type===t));if(!i)return null;const r=e.filter((e=>(null==e?void 0:e.type)!==t));return n.writeQuery({query:LO,data:{schedulingFormBlockingTasks:r}}),i}catch(e){return null===(r=s.errorToTelemetry)||void 0===r||r.call(s,"removeSchedulingFormBlockingTask: Failed to remove scheduling form blocking task from cache.","calendar_form_blocking_tasks"),null}},setSchedulingFormActiveTab(e,{input:t},{cache:n,loggerFactory:i}){var a;const o=null===t?null:Object.assign(Object.assign({},t),{__typename:"SchedulingFormTab"});try{return n.writeQuery({query:jO,data:{schedulingFormActiveTab:o}}),o}catch(e){const t=i.newLogger("scheduling-form-active-tab","data-client-calendar");return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,"setSchedulingFormActiveTab: Failed to set scheduling form active tab in cache.","calendar_form_active_tab"),null}},setSchedulingFormTerminatingAction(e,{input:{type:t}},{cache:n,loggerFactory:i}){var a;const o=i.newLogger("set-scheduling-form-terminating-action","data-client-calendar");try{n.writeQuery({query:UO,data:{schedulingFormTerminatingAction:t}})}catch(e){return null===(a=o.errorToTelemetry)||void 0===a||a.call(o,"setSchedulingFormTerminatingAction: Failed to update scheduling form terminating task in cache.","calendar_form_terminating_action"),!1}return!0}}};var BO=n(35587);var WO=n(297774);const HO={Mutation:{addFileUpload(e,{fileToAdd:t},{cache:n}){const{fileContainerId:i}=t,a=(({uploadId:e,fileName:t,serviceName:n,context:i})=>({title:t,status:C.XXy.PROGRESS,id:e,itemId:null,type:(0,BO.mD)(t),objectUrl:"",baseUrl:"",progress:1,fileId:"",isReferencedFile:!1,shareUrl:"",shareId:"",previewUrl:"",chicletBreadcrumbs:null,context:null!=i?i:null,permissionScope:null,previewHeight:null,previewWidth:null,progressComplete:null,state:C.cj1.active,hasUploadFailed:!1,serviceName:n,externalFileShareInfo:"",sharepointIds:null,publication:null,site:null,__typename:"FileUpload"}))(t);return(0,WO.zz)([a],n,i),!0},removeFileUpload(e,{input:t},{cache:n}){const{uploadId:i,fileContainerId:a}=t;return(0,WO.Fj)(i,a,n),!0}}};var VO=n(752906);const zO=e=>{if(e){const{appIcon:t,appId:n,appName:i,contentType:a,content:o,locale:r}=e;return{__typename:"PlatformCard",appIcon:t||null,appId:n||null,appName:i||null,content:o,contentType:a,locale:r||null}}return null};var qO=n(666223);var GO=n(689288);var JO=n(598706);var QO=n(627109);const KO={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"platformAppsFetchPolicyFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicy"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"forceNetworkFetch"}},{kind:"Field",name:{kind:"Name",value:"scope"}},{kind:"Field",name:{kind:"Name",value:"convId"}}]}}]},YO="PlatformAppsFetchPolicy",XO="PlatformAppsFetchPolicyMetadata",ZO=hO.Ps`
  fragment PlatformAppsFetchPolicyMetadata_FetchPolicyIds on PlatformAppsFetchPolicyMetadata {
    fetchPolicyIds
  }
`,eP=hO.Ps`
  fragment PlatformAppsFetchPolicy_ForceNetwork on PlatformAppsFetchPolicy {
    forceNetworkFetch
  }
`,tP=(e,t)=>{let n=`${YO}:${e}`;return t&&(n=`${n}:${t}`),n},nP=(e,t,n,i)=>{let a=!0;try{const a=tP(t.scope,t.convId);e.writeFragment({id:a,fragment:KO,data:t});const{enableContextlessFetchPolicyUpdates:o}=n.get(L.J.Extensibility);o&&oP(e,a,i)}catch(e){a=!1}return a},iP=(e,t,n)=>{let i=`${e}`;return t&&(i=`${i}:${t}`),{__typename:YO,id:i,scope:e,forceNetworkFetch:n,convId:null!=t?t:null}},aP=e=>{var t;try{const n=e.readFragment({id:XO,fragment:ZO});return null!==(t=null==n?void 0:n.fetchPolicyIds)&&void 0!==t?t:[]}catch(e){throw e}},oP=(e,t,n)=>{var i;const a=n.newLogger("updateFetchPolicyIds","data-client-platform");try{let n=aP(e);if(n.includes(t))return;n=n.concat(t),e.writeFragment({id:XO,fragment:ZO,data:{__typename:XO,fetchPolicyIds:n}})}catch(e){null===(i=a.errorToTelemetry)||void 0===i||i.call(a,`updateFetchPolicyIds: failed to update fetch policy ids when adding ${t}`,"platform_apps_fetch_policy_update_ids_resolver")}};var rP=n(418544);var sP=n(300553);var lP=n(657503);const cP={__typename:"MessageExtensionsAppsState",toggleRefetch:!1},dP=(e,t)=>{try{const n=e.readQuery({query:lP.F,variables:{convId:t}});if(!n)throw new Error("Unable to read ME apps state from cache");return n}catch(e){throw e}};var uP=n(786213);var mP=n(511225);var gP=n(698609);var pP=n(49920);var vP=n(766073),hP=n(235318);var fP=n(16314);var yP=n(664058);var bP=n(204334);var SP=n(503155);var kP=n(576752);const wP={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformCachedAppListQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cachedAppList"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedSourceWindow"}},{kind:"Field",name:{kind:"Name",value:"apps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"globalAppId"}},{kind:"Field",name:{kind:"Name",value:"isCachedAndHidden"}},{kind:"Field",name:{kind:"Name",value:"lastLoaded"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}}]}}]}}]}}]},CP=(e,t,n,i,o)=>{if(!e)return!1;const{lastUpdatedSourceWindow:r}=e;try{const s=t.readQuery({query:wP}),l=n({input:e,cacheData:s,coreSettings:o,logger:i});if((0,a.isEqual)(l,null==s?void 0:s.cachedAppList.apps))null==i||i.warn("cache write skipped, data unchanged");else{null==i||i.log("cached app list updated, writing query");const e={cachedAppList:{__typename:"CachedAppList",id:"appcaching",apps:l,lastUpdatedSourceWindow:r}};t.writeQuery({query:wP,data:e})}return!0}catch(e){return!1}},_P=e=>{const t={};return e.forEach((e=>t[e.globalAppId]=e)),t},TP=e=>e.length&&e[0].appId?{"App.Id":e[0].appId}:void 0,IP=e=>{var t;const{cacheData:n,input:i,logger:a}=e;return(({apps:e},t,n)=>{var i;const a=_P(t),o=e.filter((e=>!a[e.globalAppId]));return o.length!==e.length&&(null===(i=null==n?void 0:n.warnToTelemetry)||void 0===i||i.call(n,"duplicate apps found in mutation input","platform_app_caching_duplciate_apps_in_mutation_input",TP(e),!0)),t.concat(o.map((e=>{var t,n,i;return Object.assign(Object.assign({},e),{__typename:"CachedApp",lastLoaded:null!==(t=e.lastLoaded)&&void 0!==t?t:null,appId:null!==(n=e.appId)&&void 0!==n?n:null,appName:null!==(i=e.appName)&&void 0!==i?i:null})})))})(i,null!==(t=null==n?void 0:n.cachedAppList.apps)&&void 0!==t?t:[],a)},EP=e=>{var t;const{cacheData:n,input:{apps:i},logger:a}=e,o=_P(i);let r=[];return(null==n?void 0:n.cachedAppList.apps)&&(r=null==n?void 0:n.cachedAppList.apps.filter((e=>!o[e.globalAppId])),r.length===(null==n?void 0:n.cachedAppList.apps.length)&&(null===(t=null==a?void 0:a.errorToTelemetry)||void 0===t||t.call(a,"app to remove is not in the cached app list","platform_app_caching_missing_cached_app_on_update",TP(i),!0))),r},NP=(e,t,n)=>{let i,a=-1;for(const n of e)(!i||n.lastLoaded&&n.lastLoaded<i)&&(a=t.indexOf(n),i=n.lastLoaded);const o=[...t];return-1!==a&&(o.splice(a,1),null==n||n.log("app removed from global cache due to exceeding shared cache size")),o},AP=e=>{const{cacheData:t,input:{apps:n},coreSettings:i,logger:a}=e,o=null==i?void 0:i.get(L.J.Extensibility),r=null==o?void 0:o.appCachingMaxSizeNS;let s=[];if(null==t?void 0:t.cachedAppList.apps){const e=_P(null==t?void 0:t.cachedAppList.apps);s=n.map((t=>{var n,i,o;let r;const s=e[t.globalAppId];s?r=s:(r=t,null==a||a.log("adding app to cache that was not found during update."));const l=null!==(n=t.lastLoaded)&&void 0!==n?n:null,c=t.isCachedAndHidden,d=null!==(i=r.appId)&&void 0!==i?i:null,u=null!==(o=r.appName)&&void 0!==o?o:null;return Object.assign(Object.assign({},r),{__typename:"CachedApp",lastLoaded:l,appId:d,isCachedAndHidden:c,appName:u})}));const i=_P(s);s=s.concat(t.cachedAppList.apps.filter((e=>!i[e.globalAppId])))}return r?((e,t,n)=>{const i=e.filter((e=>e.isCachedAndHidden));return!i.length||i.length<=t?e:NP(i,e,n)})(s,r,a):s};var FP=n(864158);var DP=n(500161);var RP=n(73831);const xP={Query:{platformAppsBatchFetchPolicy:(e,{options:t},{cache:n})=>t.map((({scope:e,convId:t})=>((e,{scope:t,convId:n})=>{let i;try{const a=tP(t,n),o=e.readFragment({id:a,fragment:KO});i=null==o?void 0:o.forceNetworkFetch}catch(e){i=!1}return iP(t,n,null!=i&&i)})(n,{scope:e,convId:t}))),messageExtensionsAppsState:()=>cP},Mutation:{toggleAppsRefetch:(e,{convId:t},{cache:n})=>{try{const e=dP(n,t),{messageExtensionsAppsState:i}=e,a=!i.toggleRefetch,o={messageExtensionsAppsState:Object.assign(Object.assign({},i),{toggleRefetch:a})};n.writeQuery({query:lP.F,variables:{convId:t},data:o});return dP(n,t).messageExtensionsAppsState.toggleRefetch}catch(e){throw e}},updateTaskModuleResult:(e,{text:t,taskModuleId:n,draftId:i,card:a,conversationId:o,adaptiveCardTabResult:r,reason:s,entryPoint:l},{cache:c})=>{var d;try{const e={taskModuleResult:{__typename:"TaskModuleResult",text:null!=t?t:null,card:zO(a),adaptiveCardTabResult:null!==(d=r&&r.map((e=>zO(e))))&&void 0!==d?d:null,taskModuleId:n,draftId:null!=i?i:null,conversationId:null!=o?o:null,reason:s,entryPoint:l}};return c.writeQuery({query:VO.sR,data:e}),!0}catch(e){return!1}},resetTaskModuleResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:VO.sR,data:{taskModuleResult:null}}),!0}catch(e){return!1}},updateAppDetailsResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No appInstallDetails input received");const{appId:e,appInstallId:i,isAppInstalled:a,errorCode:o}=t,r={appDetailsResult:{__typename:"AppDetailsResult",appInstallId:i,appId:e,isAppInstalled:a,errorCode:o||null}};return n.writeQuery({query:qO.i,data:r}),!0}catch(e){return!1}},updateInContextStoreLaunchInstalledAppResult:(e,{input:t},{cache:n})=>{try{let e;if(t){const{id:n,appId:i,capability:a,appDisplayName:o=null,draftId:r=null}=t;e={inContextStoreLaunchInstalledAppResult:{__typename:"InContextStoreLaunchInstalledAppResult",id:n,appId:i,capability:a,appDisplayName:o,draftId:r}}}else e={inContextStoreLaunchInstalledAppResult:null};return n.writeQuery({query:GO.I,data:e}),!0}catch(e){return!1}},setPlatformAppsFetchPolicy:(e,{input:t},{cache:n,loggerFactory:i,coreSettings:a})=>((e,t,n,i)=>{var a;let o=!0;for(const r of t){let t=!0;const s={__typename:YO,forceNetworkFetch:r.fetchSource===C.p1$.Network,scope:r.scope,convId:null!==(a=r.convId)&&void 0!==a?a:null};t=nP(e,s,n,i),o=o&&t}return o})(n,t,a,i),updateAllPlatformAppsFetchPolicies:(e,{fetchSource:t},{cache:n,loggerFactory:i,scenarioFactory:a})=>{var o;let r=!0;const s=i.newLogger("updateAllPlatformAppsFetchPolicies","data-client-platform"),l=a.newScenario(it.RG.UpdateAllPlatformAppsFetchPolicies),c=aP(n),d=c.length;l.appendEventData({appCount:d});for(const e of c)try{n.writeFragment({id:e,fragment:eP,data:{__typename:YO,forceNetworkFetch:t===C.p1$.Network}})}catch(n){r=!1,null===(o=s.errorToTelemetry)||void 0===o||o.call(s,`updateAllPlatformAppsFetchPolicies: failed to update fetch policy for ${e} to ${t}`,"platform_apps_fetch_policy_update_all_resolver")}return r?(l.stop(),!0):(l.fail(),!1)},updateTabConfigurationResult:(e,{id:t,tabId:n},{cache:i})=>{try{const e={tabConfigurationResult:{__typename:"tabConfigurationResult",id:t,tabId:n}};return i.writeQuery({query:uP.s,variables:{threadId:t},data:e}),!0}catch(e){return!1}},updateTabDeletionResult:(e,{threadId:t,channelMeetingMessageId:n,tabId:i},{client:a})=>{try{const e={tabDeletionResult:{__typename:"TabDeletionResult",threadId:t,channelMeetingMessageId:n,tabId:i}};return a.writeQuery({query:mP.r,variables:{threadId:t,channelMeetingMessageId:n},data:e}),!0}catch(e){return!1}},updateMessageToParentResult:(e,{appId:t,message:n},{cache:i})=>{try{const e={messageToParentResult:{__typename:"messageToParentResult",appId:t,message:n}};return i.writeQuery({query:gP.y,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateMessageToChildResult:(e,{appId:t,message:n},{cache:i})=>{try{const e={messageToChildResult:{__typename:"messageToChildResult",appId:t,message:n}};return i.writeQuery({query:pP.n,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateAppButtonSettings:(e,{appId:t,action:n},{cache:i})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={appButtonResult:{__typename:"AppButtonResult",appId:t,action:n}};return i.writeQuery({query:fP.E,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateChangeSettings:(e,{id:t,status:n,appId:i,tabId:a},{cache:o})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={changeSettingsResult:{__typename:"ChangeSettingsResult",id:t,status:n,appId:null!=i?i:null,tabId:null!=a?a:null}};return o.writeQuery({query:vP.L,variables:{id:t},data:e}),!0}catch(e){return!1}},triggerChangeSettings:(e,{id:t,message:n,appId:i,tabId:a},{cache:o})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={changeSettingsTriggerResult:{__typename:"ChangeSettingsTriggerResult",id:t,message:n,appId:null!=i?i:null,tabId:null!=a?a:null}};return o.writeQuery({query:hP.N,variables:{id:t},data:e}),!0}catch(e){return!1}},updateSelectMediaResult:(e,{input:t},{cache:n})=>{var i;try{const{selectMediaError:e,mediaUrls:a}=t,o={selectMediaResult:{__typename:"SelectMediaResult",selectMediaError:null!=e?e:null,mediaUrls:null!==(i=a)&&void 0!==i?i:null}};return n.writeQuery({query:rP.a,data:o}),!0}catch(e){return!1}},resetSelectMediaResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:rP.a,data:{selectMediaResult:null}}),!0}catch(e){return!1}},updateViewImagesResult:(e,{input:t},{cache:n})=>{try{const{viewImagesError:e,errorCode:i}=t,a={viewImagesResult:{__typename:"ViewImagesResult",viewImagesError:null!=e?e:null,errorCode:null!=i?i:null}};return n.writeQuery({query:sP.R,data:a}),!0}catch(e){return!1}},resetViewImagesResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:sP.R,data:{viewImagesResult:null}}),!0}catch(e){return!1}},updateMapCoordinateResult:(e,{locationApiResult:t},{cache:n})=>{try{const{latitude:e,longitude:i,locationApiError:a}=t,o={mapCoordinateResult:{__typename:"MapCoordinateResult",latitude:null!=e?e:null,longitude:null!=i?i:null,locationApiError:null!=a?a:null}};return n.writeQuery({query:JO.i,data:o}),!0}catch(e){return!1}},resetMapCoordinateResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:JO.i,data:{mapCoordinateResult:null}}),!0}catch(e){return!1}},resetSelectPeoplePickerResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:QO.k,data:{selectPeoplePickerResult:[]}}),!0}catch(e){return!1}},updateSelectPeoplePickerResult:(e,{selectPeoplePickerResult:t},{cache:n})=>{try{const e={selectPeoplePickerResult:t.map((e=>({__typename:"SelectPeoplePickerResult",objectId:e.objectId,displayName:e.displayName||"",email:e.email||""})))};return n.writeQuery({query:QO.k,data:e}),!0}catch(e){return!1}},updateCustomAppUploadResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No customAppUpload input received");const{customAppType:e}=t,i={customAppUploadResult:{__typename:"CustomAppUploadResult",customAppType:e}};return n.writeQuery({query:yP.k,data:i}),!0}catch(e){return!1}},updateShowLocationResult:(e,{response:t},{cache:n})=>{try{const e={showLocationResponse:null!=t?t:null};return n.writeQuery({query:bP.F,data:e}),!0}catch(e){return!1}},resetShowLocationResponse:(e,t,{cache:n})=>{try{return n.writeQuery({query:bP.F,data:{showLocationResponse:null}}),!0}catch(e){return!1}},updateWebhookConfirmationResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No webhookConfirmation input received");const e={webhookConfirmationResult:t};return n.writeQuery({query:SP.S,data:e}),!0}catch(e){return!1}},setAppDevicePermissionsUpdated:(e,{input:t},{cache:n})=>{if(!t||!t.id||!t.status)throw new Error("Incorrect input received; id and status are required");try{const{id:e,status:i}=t,a={appDevicePermissionsUpdated:{__typename:"AppDevicePermissionsUpdated",id:e,status:i}};return n.writeQuery({query:kP.g,data:a,variables:{input:e}}),a.appDevicePermissionsUpdated}catch(e){return null}},addSharedPlatformCachedApps:(e,{input:t},{cache:n,loggerFactory:i})=>CP(t,n,IP,null==i?void 0:i.newLogger("AppCaching resolver: addSharedPlatformCachedApps","data-client-platform")),removeSharedPlatformCachedApps:(e,{input:t},{cache:n,loggerFactory:i})=>CP(t,n,EP,null==i?void 0:i.newLogger("AppCaching resolver: removeSharedPlatformCachedApps","data-client-platform")),updateSharedPlatformCachedApps:(e,{input:t},{cache:n,loggerFactory:i,coreSettings:a})=>CP(t,n,AP,null==i?void 0:i.newLogger("AppCaching resolver: updateSharedPlatformCachedApps","data-client-platform"),a),setLocalFrameContext:(e,{localFrameContext:t},{cache:n})=>{var i,a,o,r,s;try{const e={localFrameContext:{__typename:"LocalFrameContext",id:t.id,threadId:null!==(i=t.threadId)&&void 0!==i?i:null,messageId:null!==(a=t.messageId)&&void 0!==a?a:null,tabId:null!==(o=t.tabId)&&void 0!==o?o:null,websiteUrl:null!==(r=t.websiteUrl)&&void 0!==r?r:null,contentUrl:null!==(s=t.contentUrl)&&void 0!==s?s:null}};return n.writeQuery({query:FP.O,data:e}),e.localFrameContext}catch(e){return null}},resetLocalFrameContext:(e,t,{cache:n})=>{try{return n.writeQuery({query:FP.O,data:{localFrameContext:null}}),null}catch(e){throw e}},setAppsBadgeRead:(e,{isRead:t},{cache:n})=>{try{return n.writeQuery({query:DP.Q,data:{appsBadgeRead:!!t}}),!0}catch(e){return!1}},setBackButtonHandlerState:(e,{backButtonHandlerState:t},{cache:n})=>{var i;try{const e={backButtonHandlerState:{__typename:"BackButtonHandlerState",id:t.id,registered:null!==(i=t.registered)&&void 0!==i&&i}};return n.writeQuery({query:RP.i,data:e}),e.backButtonHandlerState}catch(e){return null}},resetBackButtonHandlerState:(e,t,{cache:n})=>{try{return n.writeQuery({query:RP.i,data:{backButtonHandlerState:null}}),null}catch(e){throw e}}}};var MP=n(765550),OP=n(256030),PP=n(323228),LP=n(708551),UP=n(885769),jP=n(785773);const $P="emptyLinkedEntityId",BP=()=>({__typename:"Entity",action:jP.EntityAction.view,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0},id:he.ew,linkedEntity:null,type:jP.EntityType.blank,options:null,windowOptions:null});function WP(){return{__typename:"ActiveEntities",subNavEntity:null,startEntity:null,headerEntity:null,mainEntity:BP(),endEntity:null,entityExtension:null,monitorEntity:null}}function HP(e,t){return!(!e||!t)&&(e.id===t.id&&e.type===t.type&&e.action===t.action)}function VP(e,t){return!e&&!t||!(!e||!t)&&(e.id===t.id&&e.type===t.type&&e.action===t.action&&(null==e?void 0:e.entityState.flushableByLinkedEntity)===(null==t?void 0:t.entityState.flushableByLinkedEntity)&&(null==e?void 0:e.options)===(null==t?void 0:t.options)&&function(e,t){if(!e&&!t)return!0;if(e&&t)return e.action===t.action&&e.id===t.id&&e.type===t.type;return!1}(null==e?void 0:e.linkedEntity,null==t?void 0:t.linkedEntity))}function zP(e,t,n){const i=new Map,a=new Map;for(const o of e){if(n&&!n(o))continue;const{mainEntity:e,endEntity:r}=o.activeEntities,s=o.userContextId;i.set(t(e,s),[o,e]);const{linkedEntity:l}=e;if(l&&a.set(t(l,s),[o,l]),r){i.set(t(r,s),[o,r]);const{linkedEntity:e}=r;e&&a.set(t(e,s),[o,e])}}return[i,a]}function qP(e,t){return`${e.type}-${e.id}-${t}`}function GP(e){return!!e.activeEntities}function JP(e,t){if(!t)return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:null,endEntity:null,entityExtension:null,monitorEntity:null};const{__typename:n}=t,a=(0,i.__rest)(t,["__typename"]),o=Object.assign({},a);if(!e)return o;const{subNavEntity:r,headerEntity:s,startEntity:l,mainEntity:c,endEntity:d,entityExtension:u,monitorEntity:m}=e,{subNavEntity:g,headerEntity:p,startEntity:v,mainEntity:h,endEntity:f,entityExtension:y,monitorEntity:b}=t;return o.subNavEntity=HP(r,g)?null:g,o.headerEntity=HP(s,p)?null:p,o.startEntity=HP(l,v)?null:v,o.mainEntity=HP(c,h)?null:h,o.endEntity=HP(d,f)?null:f,o.entityExtension=HP(u,y)?null:y,o.monitorEntity=HP(m,b)?null:b,o}function QP(e,t){const n=GP(e)?e.activeEntities:null,i=GP(t)?t.activeEntities:null;if(!n||!i)return!0;const{subNavEntity:a,headerEntity:o,startEntity:r,mainEntity:s,endEntity:l,entityExtension:c,monitorEntity:d}=n,{subNavEntity:u,headerEntity:m,startEntity:g,mainEntity:p,endEntity:v,entityExtension:h,monitorEntity:f}=i;return!(e.userContextId===t.userContextId&&e.extendedEntityContainerState.containerState===t.extendedEntityContainerState.containerState&&function(e,t){var n,i,a,o;if(e&&t)return(null===(n=e.blockedCommand)||void 0===n?void 0:n.stateTransition)===(null===(i=t.blockedCommand)||void 0===i?void 0:i.stateTransition)&&(null===(a=e.blockedCommand)||void 0===a?void 0:a.visibilityState)===(null===(o=t.blockedCommand)||void 0===o?void 0:o.visibilityState)&&VP(e.blockedEntity,t.blockedEntity)&&e.blockedEntityOptions===t.blockedEntityOptions;if(!e&&!t)return!0;return!1}(e.blockingEntityExtension,t.blockingEntityExtension)&&VP(a,u)&&VP(o,m)&&VP(r,g)&&VP(s,p)&&VP(l,v)&&VP(c,h)&&VP(d,f))}function KP(e,t,n,i){var a;const o=XP(GP(e)?e.activeEntities:null,GP(t)?t.activeEntities:null);return n!==jP.EntityStateTransition.none||"search"===(null===(a=o.endEntity)||void 0===a?void 0:a.type)||"search"===i.type&&YP(o)}function YP(e){return!(e.subNavEntity||e.headerEntity||e.startEntity||e.mainEntity||e.endEntity||e.entityExtension)}function XP(e,t){if(!t)return{subNavEntity:(null==e?void 0:e.subNavEntity)||null,headerEntity:(null==e?void 0:e.headerEntity)||null,startEntity:(null==e?void 0:e.startEntity)||null,mainEntity:(null==e?void 0:e.mainEntity)||null,endEntity:(null==e?void 0:e.endEntity)||null,entityExtension:(null==e?void 0:e.entityExtension)||null,monitorEntity:(null==e?void 0:e.monitorEntity)||null};const n=Object.assign({},t);if(!e)return n;const{subNavEntity:i,headerEntity:a,startEntity:o,mainEntity:r,endEntity:s,entityExtension:l,monitorEntity:c}=e,{subNavEntity:d,headerEntity:u,startEntity:m,mainEntity:g,endEntity:p,entityExtension:v,monitorEntity:h}=t;return n.subNavEntity=HP(i,d)?null:null!=d?d:i,n.headerEntity=HP(a,u)?null:null!=u?u:a,n.startEntity=HP(o,m)?null:null!=m?m:o,n.mainEntity=HP(r,g)?null:null!=g?g:r,n.endEntity=HP(s,p)?null:null!=p?p:s,n.entityExtension=HP(l,v)?null:null!=v?v:l,n.monitorEntity=HP(c,h)?null:null!=h?h:c,n}function ZP(e){return!!(e.mainEntity||e.endEntity||e.entityExtension||e.monitorEntity)}function eL(){return{__typename:"ExtendedEntityContainerState",containerState:C.oqG.Closed,isExternal:!1}}const tL=()=>({id:(0,Ye.v4)(),startTimestamp:Date.now().toString(),source:kt.D.Unknown});function nL(e){if(!e)return null;const{action:t=null,entityState:n={flushableByLinkedEntity:!0},id:i,linkedEntity:a=null,options:o=null,type:r,windowOptions:s=null}=Object.assign({},e);return{action:null!=t?t:jP.EntityAction.view,entityState:{flushableByLinkedEntity:n.flushableByLinkedEntity,__typename:"EntityState"},id:i||null,linkedEntity:a&&aL(a)||null,options:o,type:r,windowOptions:s?Object.assign(Object.assign({},s),{__typename:"WindowOptions"}):null,__typename:"Entity"}}function iL(e,t,n){return{id:e.id||null,type:e.type,action:e.action,options:t||null,windowOptions:n?Object.assign(Object.assign({},n),{__typename:"WindowOptions"}):null,linkedEntity:e.linkedEntity&&aL(e.linkedEntity)||null,entityState:{flushableByLinkedEntity:!0,__typename:"EntityState"},__typename:"Entity"}}function aL(e){return{action:e.action||null,id:e.id?e.id:$P,type:e.type,__typename:"LinkedEntity"}}const oL=e=>e?Object.assign(Object.assign({},e),{options:null}):null,rL=e=>Object.assign(Object.assign({},e),{subNavEntity:oL(e.subNavEntity),headerEntity:oL(e.headerEntity),startEntity:oL(e.startEntity),mainEntity:oL(e.mainEntity),endEntity:oL(e.endEntity)}),sL=e=>e?(0,di.b4)(e):null,lL=(e,t,n)=>{var i;const a=t&&(null===(i=e.getApp({entityType:t.type}))||void 0===i?void 0:i.manifest.id);a&&n.add(a)};function cL({appsRegistryService:e,currentWindowId:t,newReactiveValues:n}){n&&(e.resetAllViewState(t),Object.keys(n).forEach((i=>{e.setReactiveValuesForApp(t,i,n[i])})))}const dL=(e,t={resetMonitor:!0})=>{var n;return e.layoutConfig.slots=Object.assign(Object.assign({},uL()),!t.resetMonitor&&{monitor:null===(n=e.layoutConfig.slots)||void 0===n?void 0:n.monitor}),e},uL=()=>{const e={__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null};return{__typename:"SlotsLayoutConfig",contextualNotifications:e,end:e,header:e,main:e,monitor:e,nav:e,notifications:e,start:e,subNav:e,titleBar:e,toasts:e}};var mL=n(882975);function gL(e){if(!e)return"{}";const{id:t,type:n,action:i,linkedEntity:a,entityState:o}=Object.assign({},e);return`{\n    id: ${t}, \n    type: ${n}, \n    action: ${i}, \n    linkedEntity: { \n      id: ${a&&a.id}, \n      type: ${a&&a.type}}, \n    entityState: {\n      flushableByLinkedEntity: ${null==o?void 0:o.flushableByLinkedEntity}\n    }\n  }`}function pL(e){return e?`{\n    id: ${e.id}\n    startTimestamp: ${e.startTimestamp},\n    source: ${e.source}\n  }`:"{}"}function vL(e,t){const{subNavEntity:n,headerEntity:i,startEntity:a,mainEntity:o,endEntity:r,monitorEntity:s,entityExtension:l}=e;n&&t.log(`subNavEntity: ${gL(n)}`),i&&t.log(`headerEntity: ${gL(i)}`),a&&t.log(`startEntity: ${gL(a)}`),t.log(`mainEntity: ${gL(o)}`),r&&t.log(`endEntity: ${gL(r)}`),s&&t.log(`monitorEntity: ${gL(s)}`),l&&t.log(`entityExtension: ${gL(l)}`)}function hL(e,t){const{id:n,correlation:i,isMainWindow:a,layoutConfig:{layoutMode:o}}=e;t.log(`{\n    id: ${n},\n    correlation: ${pL(i)},\n    isMainWindow: ${a},\n    layoutMode: ${o} \n  }`),GP(e)?(t.log("activeEntities for window:"),vL(e.activeEntities,t)):t.log("activeEntities: undefined")}function fL(e,t){if(void 0===e)return t.log("undefined - app not ported to multi slot");if(null===e)return t.log("null - no app supports this entity");const{subNavEntity:n,headerEntity:i,startEntity:a,mainEntity:o,endEntity:r}=e;n&&t.log(`subNavEntity: ${gL(n)}`),i&&t.log(`headerEntity: ${gL(i)}`),a&&t.log(`startEntity: ${gL(a)}`),o&&t.log(`mainEntity: ${gL(o)}`),r&&t.log(`endEntity: ${gL(r)}`)}const yL=e=>{var t,n,i;return null!==(i=null!==(n=null!==(t=e.subNavEntity)&&void 0!==t?t:e.headerEntity)&&void 0!==n?n:e.startEntity)&&void 0!==i?i:e.mainEntity},bL=({entity:e,currentEntities:t,shouldUseNewEntity:n})=>{var i;return n?{appEntity:null!==(i=e.linkedEntity)&&void 0!==i?i:e,contextEntity:e.linkedEntity?e:null}:t?{appEntity:yL(t),contextEntity:e}:{appEntity:e,contextEntity:null}},SL=e=>({infoPane:e.getPreferences("infoPane"),teamLayout:e.getPreferences("teamLayout")}),kL=({appsRegistryService:e,clientPreferences:t,contextEntity:n,coreSettings:i,entity:a,layoutMode:o})=>{if(!a)throw new Error("entity used to match app is null");const r=e.getApp({entityType:a.type});if(r&&r.getAppViewEntities)return r.getAppViewEntities({contextEntity:n,coreSettings:i,entity:a,layoutMode:o,userPreferences:SL(t)})},wL={[C.tF7.subNavEntity]:{children:[C.tF7.headerEntity,C.tF7.startEntity,C.tF7.mainEntity,C.tF7.endEntity]},[C.tF7.headerEntity]:{children:[C.tF7.startEntity,C.tF7.mainEntity,C.tF7.endEntity]},[C.tF7.startEntity]:{children:[C.tF7.mainEntity,C.tF7.endEntity]},[C.tF7.mainEntity]:{children:[C.tF7.endEntity]},[C.tF7.endEntity]:{children:null}};function CL(e){return e&&e.viewEntityName&&((t=null==e?void 0:e.viewEntityName)&&t!==C.tF7.monitorEntity)?e.viewEntityName:C.tF7.subNavEntity;var t}function _L({executionContext:e,viewEntityName:t}){return CL(e)===t}function TL({executionContext:e,viewEntityName:t}){const n=CL(e),{children:i}=wL[n];return!(!i||!i.includes(t))}var IL=n(56627);const EL=(e,t)=>({endEntity:nL(e.endEntity),headerEntity:nL(e.headerEntity),mainEntity:nL(e.mainEntity)||t,startEntity:nL(e.startEntity),subNavEntity:nL(e.subNavEntity),monitorEntity:null,entityExtension:null,__typename:"ActiveEntities"}),NL=(e,t,n,i,a)=>{var o;const{appsRegistryService:r,coreSettings:s,clientPreferences:l}=e,c=yL(t),d=r.getApp({entityType:null==c?void 0:c.type}),u=yL(a),m=r.getApp({entityType:null==u?void 0:u.type}),g=null===(o=null==d?void 0:d.onBeforeNavigationFromHistory)||void 0===o?void 0:o.call(d,t,{coreSettings:s,layoutMode:n,userPreferences:SL(l)},(null==m?void 0:m.manifest.id)===(null==d?void 0:d.manifest.id)?a:void 0);return g?(i.log(`${null==d?void 0:d.manifest.name} app declared history invalid. New set of entities:`),fL(g,i),EL(g,WP().mainEntity)):t},AL=({action:e,type:t,id:n,entityState:i,linkedEntity:a,options:o,windowOptions:r})=>e&&t?{action:e,entityState:{flushableByLinkedEntity:i&&i.flushableByLinkedEntity||!1,__typename:"EntityState"},id:n||null,linkedEntity:a&&a.type?{id:a.id||$P,action:a.action||C.ukP.view,type:a.type,__typename:"LinkedEntity"}:null,options:o||null,type:t,windowOptions:r?{left:r.left||0,top:r.top||0,width:r.width||0,height:r.height||0,__typename:"WindowOptions"}:null,__typename:"Entity"}:null,FL=(e,t)=>e.mainEntity?{__typename:"ActiveEntities",subNavEntity:e.subNavEntity&&AL(e.subNavEntity)||null,headerEntity:e.headerEntity&&AL(e.headerEntity)||null,startEntity:e.startEntity&&AL(e.startEntity)||null,mainEntity:e.mainEntity&&AL(e.mainEntity)||BP(),endEntity:e.endEntity&&AL(e.endEntity)||null,entityExtension:null,monitorEntity:null}:(t.log("No main entity in entities stored in local storage"),null),DL=(e,t)=>e.reduce(((e,n)=>{const i=((e,t)=>{if(!e.activeEntities)return t.log("No activeEntities in window history item in local storage"),null;const n=FL(e.activeEntities,t);return n?{activeEntities:n,reactiveVars:{},__typename:"WindowHistoryItem"}:null})(n,t);return i&&e.push(i),e}),[]);function RL(e,t,n=e.windowHistory.length-1,i){const{maxWindowHistoryLength:a}=i.get(L.J.Core);if(!GP(e))return;const o=e.windowHistoryNavigationState,r=e.windowHistory;e.currentWindowHistoryIndex=n;const s=r.length>0&&r[r.length-1].activeEntities.mainEntity,l=e.activeEntities.mainEntity,c=!!s&&HP(s,l);o.canNavigateBack=!(0===r.length||1===r.length&&c)&&n>0,o.canNavigateForward=n<e.windowHistory.length-1;let d=n;n!==e.windowHistory.length-1&&(d=n-1),o.backHistory=xL(0,d,e.windowHistory);const u=o.backHistory,m=e.activeEntities.mainEntity;u.length>0&&HP(m,u[u.length-1].entity)&&(u.pop(),t.log("windowHistoryNavigationState back history entry was popped.")),o.backHistory=u.reverse().slice(0,a||10),o.forwardHistory=xL(n+1,e.windowHistory.length-1,e.windowHistory).slice(0,a||10),t.log(`Reset windowHistoryNavigationState. size: ${e.windowHistory.length}, windowHistoryIndex: ${n}`),t.log(`Reset windowHistoryNavigationState. canNavigateBack: ${o.canNavigateBack}, canNavigateForward: ${e.windowHistoryNavigationState.canNavigateForward}, backHistory size: ${e.windowHistoryNavigationState.backHistory.length}, forwardHistory size: ${o.forwardHistory.length}`)}function xL(e,t,n){if(!n)return[];const i=[];for(let a=e;a<=t;a++)i.push({__typename:"WindowHistoryNavigationItem",windowHistoryIndex:a,entity:n[a].activeEntities.mainEntity});return i}const ML=(e,t,n)=>{const i=i=>!i||n(t.getApp({entityType:i.type}),{mainEntity:e.mainEntity,subNavEntity:e.subNavEntity});return i(e.mainEntity)&&i(e.subNavEntity)};function OL({appIdsForReactiveVarChange:e,context:t,isUserContextSwitch:n,logger:i,newActiveEntities:a,windowContentState:o}){const{appsRegistryService:r,windowProvider:s,clientPreferences:l,coreSettings:c}=t,{currentWindowHistoryIndex:d,windowId:u}=o;let{windowHistory:m}=o;const{enableHostHistoryNavigation:g,maxWindowHistoryLength:p}=c.get(L.J.Core);n&&(i.log("User context switch, clearing out history"),m=[]),i.log(`handleWindowHistoryPush called: current length: ${m.length} current index ${d}`);const v=PL(a,r,l,c,o.layoutMode),h=((e,t)=>{const{subNavEntity:n,headerEntity:i,startEntity:a,mainEntity:o,endEntity:r}=t,s=new Set;return lL(e,n,s),lL(e,i,s),lL(e,a,s),lL(e,o,s),lL(e,r,s),s})(r,v);if(e&&!e.some((e=>h.has(e))))return i.log(`Not storing rv change to history b/c rv changes made for app not being stored in history ${e} `),[m,!1];if(!((e,t,n)=>ML(e,t,((e,t)=>{var i,a;try{return!(null===(i=null==e?void 0:e.onBeforeAddToNavigation)||void 0===i?void 0:i.shouldAddEntitiesToWindowHistory)||e.onBeforeAddToNavigation.shouldAddEntitiesToWindowHistory(t)}catch(t){return null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`App ${e.manifest.name} failed to execute entity command hook 'ShouldAddEntitiesToWindowHistory' with ""${t.name}"" error`,"entity_command_hook",{errors:`${t.name}`},!0),!0}})))(v,r,i))return i.log("Not saving to history b/c app shouldAddEntitiesToWindowHistory hook has returned false"),[m,!1];const f={};h.forEach((e=>{const{navigationalReactiveValues:t,nonNavigationalReactiveValues:n}=r.getAppViewStateForWindow(u,e)||{};(t||n)&&(f[e]=(e=>{if(!e)return;let t={};return t=Object.keys(e).reduce(((t,n)=>{const i=e[n];return Object.assign(Object.assign({},t),{[n]:i.read()})}),{}),t})(Object.assign(Object.assign({},t),n)))}));let y=m;const b=m[d];if(!b||e||ZP(JP(a,b.activeEntities))){if(d<m.length-1){i.log("Current index not at top stack");const e=m.splice(d,1);m.push(e[0]),i.log("Moving to top of stack: "),vL(e[0].activeEntities,i),i.log(`Pushed windowHistory navigation item at index ${d} to the top of the history stack.`)}const e={__typename:"WindowHistoryItem",activeEntities:Object.assign(Object.assign({},v),{monitorEntity:null}),reactiveVars:f};return y=[...m,e],g?(s.history.pushState({windowHistoryIndex:y.length-1},""),i.log(`Added browser history entry with windowHistoryIndex: ${y.length}.`)):p?y=y.slice(-p):0===p&&(y=[]),i.log(`windowHistory length after push ${y.length}`),[y,!0]}return i.log("Did not push to window history"),[y,!1]}const PL=(e,t,n,i,a)=>{const o=t.getApp({entityType:yL(e).type});return o&&o.manifest.shouldDeferNavigationToMainSlotApp?LL(e,t,n,i,a):e},LL=(e,t,n,i,a)=>{const{appEntity:o,contextEntity:r}=bL({currentEntities:e,entity:e.mainEntity,shouldUseNewEntity:!0}),s=kL({appsRegistryService:t,clientPreferences:n,contextEntity:r,coreSettings:i,entity:o,layoutMode:a});return s&&s.mainEntity?EL(s,e.mainEntity):e};function UL(e,t,n=!0){var i;try{const{activeWindows:t=[]}=e.readQuery({query:mL.i8})||{};return n?(0,a.cloneDeep)(t):t}catch(e){return null===(i=t.errorToTelemetry)||void 0===i||i.call(t,`activeWindowsQuery cache read failed - ${e.message}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),t.log("activeWindowsQuery entry not found in cache"),[]}}function jL(e,t,n,i,a){var o;const{cache:r,commandChangeReportingService:s}=e,l=a||(null==n?void 0:n.correlation.id)||(0,Ye.v4)(),c=n?function(e,t,n,i){var a;let o;const r=t.slice(0);if(GP(e)){const t=r.findIndex((t=>t.id===e.id));o=e,-1===t?r.push(o):r[t]=o}else{const t=e.windowHistory.length;if(t>0&&!e.windowHistory[t-1].activeEntities)throw null===(a=n.errorToTelemetry)||void 0===a||a.call(n,"Unable to resolve active entities, trying to pop back to empty window","webclient_framework_foundation_core_services_entity_commanding"),(0,An.Tr)(he.w5.Commanding,he.jK.Undefined,"executeEntityCommand",e.correlation,"Unable to resolve to active entities");o=r.splice(r.findIndex((t=>t.id===e.id)),1)[0],n.log(`Window has no active entities so destroying for correlation ${i}`)}return r}(n,t,i,l):t;try{r.writeQuery({query:mL.i8,data:{activeWindows:c}})}catch(e){return null===(o=i.errorToTelemetry)||void 0===o||o.call(i,`activeWindowsQuery cache write failed - ${e.message}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),s.report({correlationId:l,type:wC.B.Failure,context:{target:"executeEntityCommand",errorInfo:CC.y.WindowCacheFailedToUpdate,errorMessage:e.message}}),!1}return n&&!n.isNotificationsWindow&&(BL(c,n,i,e),$L(e,c,n,l)),i.log(`After updating window cache, there are ${c.length} active windows`),!0}const $L=({appsRegistryService:e,experienceChangeReportingService:t},n,i,a)=>{if(GP(i)&&HL(n,i.id)){const n=yL(i.activeEntities),o=e.getPlatformAppIdForEntity(n);t.report({correlationId:a,type:l_.yU.AppSelectionChanged,context:{target:"entity-command-resolver",appId:o}})}},BL=(e,t,n,{appsRegistryService:i,clientPreferences:a,coreSettings:o,localStorage:r})=>{var s,l,c,d;const{enableWriteActiveEntitiesToLocalStorage:u,enableWriteAppHistoryToLocalStorage:m,enableWindowHistoryRestorationOnStandardMain:g}=o.get(L.J.Core);if(GP(t)&&HL(e,t.id)){const e=Object.assign(Object.assign({},t.activeEntities),{monitorEntity:null});if(((e,t,n)=>ML(e,t,((e,t)=>{var i,a;try{return!(null===(i=null==e?void 0:e.onBeforeAddToNavigation)||void 0===i?void 0:i.shouldRestoreClientToEntities)||e.onBeforeAddToNavigation.shouldRestoreClientToEntities(t)}catch(t){return null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`App ${e.manifest.name} failed to execute entity command hook 'ShouldRestoreClientToEntities' with ""${t.name}"" error`,"entity_command_hook",{errors:`${t.name}`},!0),!0}})))(e,i,n)&&u){const n=t.userContextId?`${t.userContextId}-`:"";r.set(`${n}${IL.WD}`,JSON.stringify({activeEntities:e,userContextId:t.userContextId}),Ct.f.Experience)}if(m){const{activeEntities:n}=t,u=yL(n),m=i.getApp({entityType:u.type});if(null===(l=null===(s=null==m?void 0:m.onBeforeAddToNavigation)||void 0===s?void 0:s.shouldStoreLastVisitedInAppHistory)||void 0===l?void 0:l.call(s,n.mainEntity)){const t=null==m?void 0:m.manifest.id;r.set(`${IL.av}-${t}`,JSON.stringify(rL(e)))}else if(null==m?void 0:m.manifest.shouldDeferNavigationToMainSlotApp){const s=i.getApp({entityType:n.mainEntity.type}),l=null==s?void 0:s.manifest;if(null===(d=null===(c=null==s?void 0:s.onBeforeAddToNavigation)||void 0===c?void 0:c.shouldStoreLastVisitedInAppHistory)||void 0===d?void 0:d.call(c,n.mainEntity)){const n=LL(e,i,a,o,t.layoutConfig.layoutMode);r.set(`${IL.av}-${null==l?void 0:l.id}`,JSON.stringify(rL(n)))}}}g&&((e,t,n)=>{var i,a;const o=e.windowHistory.map((e=>Object.assign(Object.assign({},e),{activeEntities:rL(e.activeEntities),reactiveVars:{}})));t.setSafe((0,IL.bM)(IL.ax,e.userContextId),JSON.stringify(o),Ct.f.Experience)?!t.setSafe((0,IL.bM)(IL.Hs,e.userContextId),JSON.stringify({windowHistoryIndex:e.currentWindowHistoryIndex,userContextId:e.userContextId}),Ct.f.Experience)&&(null===(i=n.errorToTelemetry)||void 0===i||i.call(n,`Failed to save history index ${e.currentWindowHistoryIndex}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0)):null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`Failed to save main window history to local storage with history length ${o.length}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0)})(t,r,n)}},WL=(e,t)=>e.find((e=>e.layoutConfig.layoutMode===t&&e.isMainWindow)),HL=(e,t)=>{const n=WL(e,jP.LayoutModes.standard);return t===he.ew||t===(null==n?void 0:n.id)};function VL(e,t){const n=e.get(t);return n&&n[0]}function zL(e,t){return e.find((e=>e.id===t))}function qL(e,t,n,i,a){let o=VL(t,qP(e,i));const{linkedEntity:r}=e;let s=!1;!o&&r&&(o=VL(t,qP(r,i)),s=!!o),!o&&e.id&&(o=VL(n,qP({id:e.id,type:e.type},i)),s=!!o);const{enableLinkedEntityMatching:l}=a.get(L.J.Core);return l&&!o&&r&&(o=VL(n,qP(r,i)),s=!!o),[o,s]}function GL({pubsub:e,fromWindowId:t,isFromWindowMain:n,sourceWindowId:i,diff:a,targetWindow:o,targetVisibilityState:r,stateTransition:s,correlation:l,logger:c}){!function(e,t,n,i,a,o,r){GP(o)&&o.id!==he.ew&&JL(t,a)&&(n.log(`Focusing window ${r} for correlation ${e.id}`),i.publish(`windowStateEvent-${r}`,{windowStateEvent:{isFocused:!0,correlation:e}}))}(l,a,c,e,r,o,i),function(e,t,n,i,a,o,r,s,l){!JL(t,s)||i||l.id===n||r!==jP.EntityStateTransition.flush&&r!==jP.EntityStateTransition.forceFlush||(a.log(`Closing ${n} for correlation ${e.id}`),o.publish(`windowStateEvent-${n}`,{windowStateEvent:{correlation:e,shouldClose:!0}}))}(l,a,t,n,c,e,s,r,o)}function JL(e,t){return t===jP.EntityVisibilityState.show||t===jP.EntityVisibilityState.toggle&&ZP(e)}const QL=(e,t,n,i,a)=>{const o=e.activeEntities.monitorEntity,r=e.activeEntities;e.activeEntities=NL(a,e.windowHistory[t].activeEntities,e.layoutConfig.layoutMode,n,r),(e=dL(e,{resetMonitor:null===o})).activeEntities=Object.assign(Object.assign({},e.activeEntities),{monitorEntity:o});const s=e.windowHistory[t].reactiveVars;return cL({appsRegistryService:a.appsRegistryService,currentWindowId:e.id,newReactiveValues:s}),RL(e,n,t,a.coreSettings),n.log("Window after navigating in history: "),hL(e,n),jL(a,i,e,n)},KL={Query:{},Mutation:{changeMonitorSlotContent:(e,{windowId:t,entityType:n,entityAction:i,entityOptions:a},o)=>{var r;const{cache:s,loggerFactory:l}=o,c=l.newLogger("changeSlotsVisibility-mutation","data-client-entity-command"),d=UL(s,c),u=zL(d,t);if(!u)return c.error("mutation fails as targetWindow is not found."),null;let m=!1,g=!1;return i===C.ukP.view?(u.activeEntities=Object.assign(Object.assign({},u.activeEntities),{monitorEntity:{id:null,action:i,type:n,entityState:{flushableByLinkedEntity:!1,__typename:"EntityState"},linkedEntity:null,options:a||null,windowOptions:null,__typename:"Entity"}}),g=!0):i===C.ukP.leave&&(null===(r=u.activeEntities.monitorEntity)||void 0===r?void 0:r.type)===n&&(u.activeEntities=Object.assign(Object.assign({},u.activeEntities),{monitorEntity:null}),g=!0),m=g&&jL(o,d,u,c),m&&GP(u)?u:null},changeSlotsVisibility:(e,{slotNames:t,windowId:n,isHidden:i},a)=>{const{cache:o,loggerFactory:r}=a,s=r.newLogger("changeSlotsVisibility-mutation","data-client-entity-command"),l=UL(o,s),c=zL(l,n);if(!c)return s.error("mutation fails as targetWindow is not found."),null;let d=!1,u=!1;const m=t.reduce(((e,t)=>{var n;const a=(e=>e.replace(/-./g,(e=>e[1].toUpperCase())))(t),o=null===(n=c.layoutConfig.slots)||void 0===n?void 0:n[a];return u||(null==o?void 0:o.isHidden)===i||(u=!0),e[a]=Object.assign(Object.assign({},o),{isHidden:i}),e}),{});return u&&(c.layoutConfig.slots=Object.assign(Object.assign({__typename:"SlotsLayoutConfig"},c.layoutConfig.slots),m),d=jL(a,l,c,s)),d&&GP(c)?c:null},resizeHeaderSlot:(e,{height:t,windowId:n},i)=>{var a,o,r,s,l;const{cache:c,loggerFactory:d}=i,u=d.newLogger("resizeHeaderSlot-mutation","data-client-entity-command"),m=UL(c,u),g=zL(m,n);if(!g)return null;let p=!1;return(null===(o=null===(a=g.layoutConfig.slots)||void 0===a?void 0:a.header)||void 0===o?void 0:o.height)!==t&&(g.layoutConfig.slots=Object.assign(Object.assign({},g.layoutConfig.slots),{__typename:"SlotsLayoutConfig",header:Object.assign(Object.assign({},null===(r=g.layoutConfig.slots)||void 0===r?void 0:r.header),{__typename:"SlotLayoutConfig",height:t,width:(null===(l=null===(s=g.layoutConfig.slots)||void 0===s?void 0:s.header)||void 0===l?void 0:l.width)||null})}),p=jL(i,m,g,u)),p&&GP(g)?g:null},resizeSlotDimensions:(e,{windowId:t,slotName:n,width:i},a)=>{var o,r,s,l,c,d;const{cache:u,loggerFactory:m}=a,g=m.newLogger("resizeSlotDimensions-mutation","data-client-entity-command"),p=UL(u,g),v=zL(p,t);if(!v)return null;let h=!1;return n===C.WLT.SUBNAV?v.layoutConfig.slots=Object.assign(Object.assign({},v.layoutConfig.slots),{__typename:"SlotsLayoutConfig",subNav:Object.assign(Object.assign({},null===(o=v.layoutConfig.slots)||void 0===o?void 0:o.subNav),{__typename:"SlotLayoutConfig",height:(null===(s=null===(r=v.layoutConfig.slots)||void 0===r?void 0:r.subNav)||void 0===s?void 0:s.height)||null,width:i})}):n===C.WLT.END&&(v.layoutConfig.slots=Object.assign(Object.assign({},v.layoutConfig.slots),{__typename:"SlotsLayoutConfig",end:Object.assign(Object.assign({},null===(l=v.layoutConfig.slots)||void 0===l?void 0:l.end),{__typename:"SlotLayoutConfig",height:(null===(d=null===(c=v.layoutConfig.slots)||void 0===c?void 0:c.end)||void 0===d?void 0:d.height)||null,width:i})})),h=jL(a,p,v,g),h&&GP(v)?v:null}}};function YL(e,t,n,i,a,o){const{enableOpenerHandleFlow:r}=a.get(L.J.Core);if(r&&ZP(e)){const r=!!eU(e,t,a),s=!!tU(e,aU),l=!!tU(e,rU),c=!!tU(e,lU),d=!!tU(e,cU),u=!!tU(e,dU),m=!!tU(e,uU),g=!!tU(e,mU),p=!!tU(e,bU),v=!!tU(e,SU),h=!!tU(e,gU),f=!!tU(e,_U),y=!!tU(e,RU),b=!!tU(e,IU),S=!!tU(e,EU),k=!!tU(e,NU),w=function(e,t,n){const{enableNewConsumerTasksChatTabNavigation:i}=t.get(L.J.Chat);return!i&&!!tU(e,(e=>sU(e,n)))}(e,a,o),C=function(e,t){const{enableAliasVisibilitySettingsCommand:n}=t.get(L.J.People);return!n&&!!tU(e,oU)}(e,a),_=function(e,t,n){const{enableReactTaskModuleForBIM:i,launchAngularDialog:a,enableReactWorkflowsInBIM:o,enableReactTaskModuleForHWC:r,enableModernPurchaseFlow:s}=t.get(L.J.Extensibility);return function(e,t,n){return t===he.ew&&!n&&!!tU(e,kU)}(e,n,i)||function(e,t,n){return t===he.ew&&!n&&!!tU(e,wU)}(e,n,r)||function(e,t){return!!t&&!!tU(e,TU)}(e,a)||function(e,t){return!(t||!tU(e,FU)&&!tU(e,DU))}(e,o)||function(e){return!!tU(e,CU)}(e)||function(e,t){return!t&&!!tU(e,AU)}(e,s)}(e,a,t),T=function(e,t){const{enableBrb:n}=t.get(L.J.Brb);return!n&&!!tU(e,yU)}(e,a),I=function(e,t){const{enableHybridChannelList:n,msgEnableChannelsV2:i}=t.get(L.J.Host);return!(i||n||!tU(e,pU))}(e,a),E=function(e,t){const{isCalendarSurfaceHybridArchitectureEnabled:n}=t.get(L.J.Host),i=!!tU(e,fU);if(i&&n)return!1;return i}(e,a),N=function(e,t){const{isSchedulingFormHybridArchitecureEnabled:n}=t.get(L.J.Host),{enableMultiWindowCalendarSchedulingForm:i}=t.get(L.J.Calendar),a=!!tU(e,vU);if(i&&a)return!1;return a&&!n}(e,a),A=function(e,t,n,i,a){const{isSchedulingFormHybridArchitecureEnabled:o}=a.get(L.J.Host),{enableMultiWindowCalendarSchedulingFormViewAndEdit:r}=a.get(L.J.Calendar),s=!!tU(e,hU);if(s&&i)return!1;if(o&&s)return!1;if(r&&s)return!(t!==he.ew||!n);return s}(e,t,n,i,a),F=function(e,t,n,i){const{isChatHybridArchitectureEnabled:a}=t.get(L.J.Host),o=tU(e,iU);let r=!!o;o&&(i.log(`Checking if opener should handle chat ${o.id}: isChatHybridArchitectureEnabled\n      ${a}, and isNotNewNorNoneOnMainContext ${n}`),r=!1===a&&n,i.log(`Opener should handle chat ${o.id} ${r}`));return r}(e,a,n,o);return r||s||l||c||d||u||m||g||p||v||h||f||y||b||S||k||w||C||_||T||I||E||N||A||F}return!1}function XL(e,t,n,i,a,o){let r=!1,s=null;return s=eU(t,i,o)||function(e,t){let n=null;return ZL.forEach((t=>{const i=tU(e,t);i&&(n=i)})),n||tU(e,(e=>sU(e,t)))}(t,a),s&&(n.report({correlationId:e.id,type:wC.B.NotHandled,context:{target:"openerHandleEntityChange"}}),r=!0),r}const ZL=[uU,aU,rU,lU,cU,dU,mU,TU,pU,fU,function(e){return!(!e||e.type!==C.pyR.schedulingform)},IU,EU,yU,bU,SU,kU,iU,gU,_U,RU,NU,AU,FU,DU,oU,CU];function eU(e,t,n){const i=nU.bind(null,n);return t===he.ew?tU(e,i):null}function tU(e,t){const{mainEntity:n,endEntity:i,entityExtension:a}=e;let o=null;return n&&t(n)&&(o=n),i&&t(i)&&(o=i),a&&t(a)&&(o=a),o}function nU(e,t){if(!t)return!1;switch(t.type){case C.pyR.channels:return[C.ukP.leave,C.ukP.share].indexOf(t.action)>=0;case C.pyR.channelroster:return t.action===C.ukP.manage;case C.pyR.eduteamcreate:return t.action===C.ukP.view;case C.pyR.teams:return t.action===C.ukP.delete;case C.pyR.channelnotificationsettings:{const{enableChannelNotificationSettingsInT21:n}=e.get(L.J.Activity);return!n&&t.action===C.ukP.view}case C.pyR.channelconnectors:{const{enableChannelConnectorV2:n}=e.get(L.J.TeamsAndChannels);return!n&&t.action===C.ukP.view}case C.pyR.crosspostchannelselectiondialog:return t.action===C.ukP.view}return[C.pyR.addchannel,C.pyR.addmember,C.pyR.addmembernewteam,C.pyR.broadcastliveevent,C.pyR.channeldeeplink,C.pyR.channeldelete,C.pyR.channeledit,C.pyR.channelemail,C.pyR.channelmoderators,C.pyR.restorechannel,C.pyR.teamarchive,C.pyR.teamcreate,C.pyR.teamdeeplink,C.pyR.teamedit,C.pyR.teamjoincode,C.pyR.teamleave,C.pyR.teampicture,C.pyR.teamrenewal,C.pyR.teamrestore,C.pyR.sharedchannelacceptinvitation,C.pyR.sharedchanneldeclineinvitation,C.pyR.showformemberdialog,C.pyR.stopsharingchannelwithteam].indexOf(t.type)>=0}function iU(e){return e&&e.type===C.pyR.chats}function aU(e){const t=!(!e||e.type!==C.pyR.extensions||e.id!==d.oz.organization);if(t&&!(null==e?void 0:e.linkedEntity))throw(0,An.Tr)(he.w5.Commanding,he.jK.Undefined,"CommandChangeNotification",void 0,"Org chart entity defined without a linked entity. Cannot notify host of route change.");return t}function oU(e){return e.type===C.pyR.settingsstore&&e.id===d.oz.privacyManageVisibility}function rU(e){const t=!(!e||e.type!==C.pyR.extensions||e.id!==C.pyR.linkedin);if(t&&!(null==e?void 0:e.linkedEntity))throw(0,An.Tr)(he.w5.Commanding,he.jK.Undefined,"CommandChangeNotification",void 0,"LinkedIn entity defined without a linked entity. Cannot notify host of route change.");return t}function sU(e,t){var n;if(e&&e.type===C.pyR.extensions&&e.action===C.ukP.view&&(null===(n=e.linkedEntity)||void 0===n?void 0:n.type)===C.pyR.chats){let n;try{(null==e?void 0:e.id)&&(n=JSON.parse(e.id||"").appId)}catch(e){t.warn("isConsumerTasksChatTab, failed to parse appId")}return!("1ded03cb-ece5-4e7c-9f73-61c375528078"!==n)}return!1}function lU(e){return(null==e?void 0:e.type)===C.pyR.transcripttab}function cU(e){return(null==e?void 0:e.type)===C.pyR.meetingrecaptab}function dU(e){return!(!e||e.type!==C.pyR.platformapps||e.action!==C.ukP.list)}function uU(e){const t=!(!e||e.type!==C.pyR.platformStage||e.action!==C.ukP.view),n=!(!e||e.type!==C.pyR.platformTabGallery);return t||n}function mU(e){return!(!e||e.type!==C.pyR.platformapps||e.action!==C.ukP.manage)}function gU(e){return!(!e||(e.type!==C.pyR.file||e.action!==C.ukP.view)&&e.type!==C.pyR.fileopensettings)}function pU(e){return!(!e||e.type!==C.pyR.channels||!e.id)}function vU(e){return!(!e||e.type!==C.pyR.schedulingform||e.action!==C.ukP.create)}function hU(e){return!(!e||e.type!==C.pyR.schedulingform||e.action!==C.ukP.view)}function fU(e){return!(!e||e.type!==C.pyR.calendar)}function yU(e){return!(!e||e.type!==C.pyR.brbfeedbackdialog)}function bU(e){return!(!e||e.type!==C.pyR.open3sfeedback)}function SU(e){return!(!e||e.type!==C.pyR.livepersonacard)}function kU(e){return!(!e||e.type!==C.pyR.taskmodule)}function wU(e){return!(!e||e.type!==C.pyR.hwctaskmodule)}function CU(e){return!(!e||e.type!==C.pyR.settingsdialog)}function _U(e){return!(!e||e.type!==C.pyR.accounts)}function TU(e){return!(!e||e.type!==C.pyR.platformapp||e.action!==C.ukP.info)}function IU(e){return!(!e||e.type!==C.pyR.platformappdetails||e.action!==C.ukP.config&&e.action!==C.ukP.update)}function EU(e){return!(!e||e.type!==C.pyR.incontextstore||e.action!==C.ukP.config&&e.action!==C.ukP.update)}function NU(e){return!(!e||e.type!==C.pyR.platformapp||e.action!==C.ukP.view)}function AU(e){return!(!e||e.type!==C.pyR.platformsubscriptionplans||e.action!==C.ukP.info)}function FU(e){return!(!e||e.type!==C.pyR.workflows||e.action!==C.ukP.create)}function DU(e){return!(!e||e.type!==C.pyR.workflows||e.action!==C.ukP.manage)}function RU(e){return!(!e||e.type!==C.pyR.customapp||e.action!==C.ukP.create)}function xU(e,t,{entity:n,stateTransition:i,logger:a,window:o,correlation:r,commandChangeReportingService:s,entityOptions:l}){var c,d;if(!o.blockingEntityExtension)throw(0,An.Tr)(he.w5.Commanding,he.jK.Undefined,"executeEntityCommand",o.correlation,"Unable to resolve blockingEntityExtension");const u={activeEntities:t,windowHistory:[...o.windowHistory],currentWindowHistoryIndex:o.windowHistory.length-1,layoutMode:o.layoutConfig.layoutMode,userContextId:o.userContextId,windowId:o.id};a.log("Blocking command transition due to blockingEntityExtension");const m=eL();u.activeEntities=Object.assign(Object.assign({},t),{entityExtension:o.blockingEntityExtension.entity});const g=Object.assign(Object.assign({},o.blockingEntityExtension),{blockedEntity:n,blockedEntityOptions:l||null,blockedCommand:{stateTransition:i,visibilityState:e,correlation:r,__typename:"EntityCommand"}});s.report({correlationId:r.id,type:wC.B.CommandMetaDataAdded,context:{target:"blockTransitionAndShowExtension",transitionBlockedByExtension:!0}});const p=o.windowHistoryNavigationState,v=Object.assign(Object.assign({},p),{backHistory:[...null!==(c=p.backHistory)&&void 0!==c?c:[]],forwardHistory:[...null!==(d=p.forwardHistory)&&void 0!==d?d:[]]});return Object.assign(Object.assign(Object.assign({},o),u),{correlation:r,extendedEntityContainerState:m,blockingEntityExtension:g,windowHistoryNavigationState:v})}const MU=(e,t,n)=>{const i=e.activeEntities.entityExtension;if(!i)return t.error(`Unable to create hide command for extension in the given window. The window does not have an active extension. Window ID: ${e.id}`),null;const a=tL();a.source=kt.D.CoreResolvers;const o={correlation:a,stateTransition:jP.EntityStateTransition.extend,visibilityState:jP.EntityVisibilityState.hide};return n.report({type:wC.B.CommandStart,correlationId:a.id,context:{target:"createAndRegisterHideExtensionCommand",entityCommand:{entity:i,command:Object.assign(Object.assign({},o),{correlation:Object.assign(Object.assign({},a),{startTimestamp:parseInt(a.startTimestamp,10)})})}}}),{entity:i,command:o}},OU=(e,t,n)=>{var i;if(GP(e)){const a=MU(e,t,n),o=null===(i=null==a?void 0:a.command.correlation)||void 0===i?void 0:i.id;o&&(t.log(`Closing external dialog, sending hide command with new correlation ${o}`),n.report({type:wC.B.NotHandled,correlationId:o,context:{target:"sendHideExternalExtensionCommand"}}))}},PU=(e,t,n,i,a)=>{const{commandChangeReportingService:o}=a;e.extendedEntityContainerState.isExternal?(n.log(`Routing externally - closing external dialog for correlation ${i.id}`),OU(e,n,o)):(n.log(`Routing externally - closing BIM dialog from command with correlation ${i.id}`),((e,t,n,i,a)=>{GP(t)&&jL(a,n,LU(t,i),e)})(n,e,t,i,a))};function LU(e,t){const{activeEntities:n}=e;return Object.assign(Object.assign({},e),{correlation:t,extendedEntityContainerState:Object.assign(Object.assign({},e.extendedEntityContainerState),{containerState:C.oqG.Closed}),activeEntities:Object.assign(Object.assign({},n),{entityExtension:null})})}const UU={Query:{},Mutation:{createNotificationsWindow:(e,t,n)=>jU(e,t,n)}},jU=(e,t,n)=>{var i;const{cache:a,loggerFactory:o}=n,r=o.newLogger("NotificationsResolver","data-client-entity-command");try{const e=UL(a,r);if(e.find((e=>!0===e.isNotificationsWindow)))return r.log("CN:Notifications window has already been created"),!0;const t=WL(e,C.lOW.standard),i=Object.assign(Object.assign({},tL()),{__typename:"Correlation",clientLaunchId:t?t.correlation.clientLaunchId:(0,Ye.v4)()});return jL(n,e,$U(i,null),r,i.id)}catch(e){return null===(i=r.errorToTelemetry)||void 0===i||i.call(r,`CN:Error occured trying to create notifications window: ${e}`,"webclient_framework_foundation_resolvers_notifications",void 0,!0),!1}};function $U(e,t){const n={__typename:"Entity",id:null,type:u.p.toasts,action:C.ukP.view,options:null,windowOptions:null,linkedEntity:null,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0}};return{__typename:"Window",id:(0,Ye.v4)(),windowOptions:null,windowHistory:[],currentWindowHistoryIndex:0,windowHistoryNavigationState:{__typename:"WindowHistoryNavigationState",canNavigateBack:!1,canNavigateForward:!1,backHistory:[],forwardHistory:[]},correlation:Object.assign(Object.assign({},e),{__typename:"Correlation"}),extendedEntityContainerState:eL(),blockingEntityExtension:null,isMainWindow:!1,isNotificationsWindow:!0,isInitialWindowStateHidden:!1,userContextId:t,layoutConfig:{__typename:"LayoutConfig",layoutMode:C.lOW.minimal,isFullscreen:!1,slots:{__typename:"SlotsLayoutConfig",contextualNotifications:null,end:null,header:null,main:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},nav:null,notifications:null,start:null,subNav:null,titleBar:null,toasts:null,monitor:null}},activeEntities:{__typename:"ActiveEntities",mainEntity:n,subNavEntity:null,headerEntity:null,startEntity:null,endEntity:null,entityExtension:null,monitorEntity:null}}}const BU="webclient_framework_foundation_core_services_entity_commanding";function WU(e,t,n,i,a){let o;const{windowHistory:r,activeEntities:s}=e;let l=r;const{appsRegistryService:c}=n,d=r.slice().reverse().find((e=>{return t=s,n=e.activeEntities,i=yL(t),a=yL(n),!(i.type===a.type&&i.action===a.action);var t,n,i,a}));if(d){o=d.activeEntities,a.log(`Found app switch in window history ${t.id}. Switching to: `),vL(o,a),cL({appsRegistryService:c,currentWindowId:e.id,newReactiveValues:d.reactiveVars});const i={activeEntities:s,windowHistory:r,currentWindowHistoryIndex:e.currentWindowHistoryIndex,layoutMode:e.layoutConfig.layoutMode,userContextId:e.userContextId,windowId:e.id};[l]=OL({context:n,isUserContextSwitch:!1,logger:a,newActiveEntities:o,windowContentState:i})}else if(a.log(`No app switch found in history ${t.id}`),e.id===he.ew){const r=c.getDefaultCommand(n.coreSettings);if(r){a.log(`Using default command for main window ${t.id}`);const o=tL();return o.source=kt.D.CoreResolvers,a.log(`Sending new command with correlation ${o.id}`),cj({entity:r,command:{stateTransition:C.suD.forceFlush,visibilityState:C.feW.show,correlation:o},windowId:e.id,clientLaunchId:e.correlation.clientLaunchId},n,i)||Object.assign(Object.assign({},e),{correlation:t,activeEntities:void 0})}o=WP()}else a.log(`No app switch found in child window ${e.id}, so should close ${t.id}`);return Object.assign(Object.assign({},e),{correlation:t,activeEntities:o,windowHistory:l})}function HU({commandChangeReportingService:e,correlation:t,entitiesMap:n,entity:i,logger:a,userContextId:o,window:r},s){const{id:l}=t;return a.log(`Hiding main entity and popping history - ${gL(i)} and correlation ${l}`),e.report({correlationId:t.id,type:wC.B.CommandMetaDataAdded,context:{target:"hideMainEntity",popWindowHistory:!0}}),function({window:e,entitiesMap:t,correlation:n,logger:i,userContextId:a,context:o}){let r;const{windowHistory:s,activeEntities:l}=e,{appsRegistryService:c,coreSettings:d}=o;let u=s[s.length-1];if(YP(XP(l,(null==u?void 0:u.activeEntities)||null))&&(s.pop(),u=s[s.length-1]),u&&i.log("Using most recent item in history: "),u&&vL(u.activeEntities,i),u){if(VL(t,qP(u.activeEntities.mainEntity,a))||u.activeEntities.endEntity&&VL(t,qP(u.activeEntities.endEntity,a)))return i.log(`Active entities from history already exists in another window so emptying out current window ${e.id}`),r=void 0,c.resetAllViewState(e.id),Object.assign(Object.assign({},e),{correlation:n,activeEntities:r});r=NL(o,u.activeEntities,e.layoutConfig.layoutMode,i,l),cL({appsRegistryService:c,currentWindowId:e.id,newReactiveValues:u.reactiveVars}),RL(e,i,void 0,d)}else e.id===he.ew&&(i.log("No window history in main to pop so setting window to blank"),r=WP(),c.resetAllViewState(e.id));return i.log(`Popping window history, window history length: ${s.length}`),Object.assign(Object.assign({},e),{correlation:n,activeEntities:r})}({window:r,entitiesMap:n,correlation:t,logger:a,userContextId:o,context:s})}function VU({activeEntities:e,correlation:t,entity:n,logger:i,window:a}){const o=a;return HP(e.startEntity,n)?(i.log(`Hiding start entity - ${gL(n)} and correlation ${t.id}`),Object.assign(Object.assign({},o),{activeEntities:Object.assign(Object.assign({},e),{startEntity:null}),correlation:t})):HP(e.endEntity,n)?(i.log(`Hiding end entity - ${gL(n)} and correlation ${t.id}`),Object.assign(Object.assign({},o),{activeEntities:Object.assign(Object.assign({},e),{endEntity:null}),correlation:t})):void 0}function zU(e,t,n){var{commandChangeReportingService:a,correlation:o,enableMultiSlotHide:r,entitiesMap:s,entity:l,logger:c,stateTransition:d,window:u}=e,m=(0,i.__rest)(e,["commandChangeReportingService","correlation","enableMultiSlotHide","entitiesMap","entity","logger","stateTransition","window"]);if(GP(u)){const{activeEntities:e}=u;if(u.blockingEntityExtension&&d!==C.suD.extend)return xU(C.feW.hide,e,Object.assign({commandChangeReportingService:a,correlation:o,enableMultiSlotHide:r,entitiesMap:s,entity:l,logger:c,stateTransition:d,window:u},m));if(d===C.suD.forceFlush&&function(e,t){return HP(e,t.subNavEntity)||HP(e,t.headerEntity)||HP(e,t.mainEntity)}(l,e))return function({commandChangeReportingService:e,correlation:t,logger:n,window:i},a,o){const{id:r}=t;if(!GP(i))return i;n.log(`Closing app with correlation correlation ${r}`);const s=WU(i,t,a,o,n),l=GP(s)?yL(s.activeEntities):void 0;return e.report({correlationId:t.id,type:wC.B.CommandMetaDataAdded,context:{target:"closeApp",popWindowHistory:!1,entityDisplayedAfterHide:GP(s)?{mainEntity:s.activeEntities.mainEntity,contextEntity:l}:void 0}}),s}(Object.assign({commandChangeReportingService:a,correlation:o,enableMultiSlotHide:r,entitiesMap:s,entity:l,logger:c,stateTransition:d,window:u},m),t,n);if((!r||d===C.suD.flush)&&HP(e.mainEntity,l))return a.report({correlationId:o.id,type:wC.B.Hidden,context:{target:"handleHideCommandAction"}}),HU(Object.assign({commandChangeReportingService:a,correlation:o,enableMultiSlotHide:r,entitiesMap:s,entity:l,logger:c,stateTransition:d,window:u},m),t);if(!r||d===C.suD.none){const t=VU({entity:l,logger:c,window:u,correlation:o,activeEntities:e});if(t)return a.report({correlationId:o.id,type:wC.B.Hidden,context:{target:"handleHideCommandAction"}}),t}if(HP(e.entityExtension,l))return c.log(`Closing extended entity container with correlation ${o.id}`),LU(u,o);a.report({correlationId:o.id,type:wC.B.Incomplete,context:{target:"handleHideCommandAction"}}),c.warn(`Hide command issued for an entity but that entity is not present - ${gL(l)}`)}else c.warn(`Hide command issued for an entity but are no active entities - ${gL(l)}`);return u}function qU({appViewEntities:e,commandChangeReportingService:t,coreSettings:n,correlation:i,enableMultiSlotNone:a,entity:o,executionContext:r,logger:s,userContextId:l,window:c}){var d;let u;const m={activeEntities:YU(c),windowHistory:[...c.windowHistory],currentWindowHistoryIndex:c.currentWindowHistoryIndex,layoutMode:c.layoutConfig.layoutMode,userContextId:c.userContextId,windowId:c.id},{enableMTMACommanding:g}=n.get(L.J.Core);if(g&&l!==c.userContextId)throw null===(d=s.errorToTelemetry)||void 0===d||d.call(s,"Different user context sent for toggle command",BU),new Error("Different user context sent for toggle command");if(GP(c)){const{activeEntities:n}=c,l=VU({activeEntities:n,correlation:i,entity:o,logger:s,window:c});if(l)return function({commandChangeReportingService:e,correlation:t,logger:n,newEntity:i}){e.report({correlationId:t.id,type:wC.B.Toggled,context:{target:"logHideToggle"}}),n.log(`Toggling entity (hide) - ${gL(i)} and correlation ${t.id}`)}({commandChangeReportingService:t,logger:s,newEntity:o,correlation:i}),l;HP(n.mainEntity,o)||(t.report({correlationId:i.id,type:wC.B.Incomplete,context:{target:"handleToggleCommandAction"}}),s.log(`Toggling end entity (show) - ${gL(o)} and correlation ${i.id}`),u=XU({activeEntities:n,appViewEntities:e,correlation:i,enableMultiSlotNone:a,executionContext:r,logger:s,newEntity:o,windowContentState:m}).activeEntities)}else t.report({correlationId:i.id,type:wC.B.Incomplete,context:{target:"handleToggleCommandAction"}}),s.warn(`Toggle command only supported when active entities set - ${o}`);return Object.assign(Object.assign({},c),{correlation:i,activeEntities:u})}function GU({activeEntities:e,stateTransition:t,executionContext:n}){const i=e.mainEntity.entityState.flushableByLinkedEntity,a=!e.endEntity||e.endEntity.entityState.flushableByLinkedEntity,o=TL({executionContext:n,viewEntityName:C.tF7.mainEntity});return t===C.suD.forceFlow||o&&i&&t===C.suD.flow||!o&&a&&t===C.suD.flow}function JU({mainEntity:e,entity:t,stateTransition:n,matchedLinkedEntity:i}){const a=e.entityState.flushableByLinkedEntity;return n===C.suD.forceFlush||a&&(n===C.suD.flush||n===C.suD.new)||i&&t.type!==C.pyR.chats&&t.type!==C.pyR.devicesettings&&t.type!==C.pyR.contentcamerasetup&&t.type!==C.pyR.transcript&&t.type!==C.pyR.meetingdetails&&t.type!==C.pyR.roster&&t.type!==C.pyR.yammerqna&&t.type!==C.pyR.accessibilitypanel&&t.type!==C.pyR.extensions}function QU(e,t){const n={__typename:"Entity",action:C.ukP.view,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0},id:null,linkedEntity:null,type:C.pyR.hybridplaceholder,options:null,windowOptions:null};return t===C.c$2.Activity||t===C.c$2.NonHybridLeftRail?n:nL(e)}function KU({currentEntity:e,entityFromAppViewEntities:t,isExecutionContextUpstreamOfEntity:n}){const i=!e||e.entityState.flushableByLinkedEntity;return n&&i&&!!t}function YU(e){return GP(e)?e.activeEntities:void 0}function XU({activeEntities:e,appViewEntities:t,correlation:n,enableMultiSlotNone:i,executionContext:a,logger:o,newEntity:r,windowContentState:s}){return i&&t?(o.log("Using multi slot none behavior"),function({activeEntities:e,appViewEntities:t,executionContext:n,windowContentState:i}){return Object.assign(Object.assign({},i),{activeEntities:Object.assign(Object.assign({},e),{startEntity:KU({currentEntity:e.startEntity,entityFromAppViewEntities:t.startEntity,isExecutionContextUpstreamOfEntity:TL({executionContext:n,viewEntityName:C.tF7.startEntity})||_L({executionContext:n,viewEntityName:C.tF7.startEntity})})?nL(t.startEntity):e.startEntity,endEntity:KU({currentEntity:e.endEntity,entityFromAppViewEntities:t.endEntity,isExecutionContextUpstreamOfEntity:TL({executionContext:n,viewEntityName:C.tF7.endEntity})||_L({executionContext:n,viewEntityName:C.tF7.endEntity})})?nL(t.endEntity):e.endEntity})})}({activeEntities:e,appViewEntities:t,executionContext:a,windowContentState:s})):(o.log("Falling back to default none behavior"),function(e,t,n,i,a){return i.log(`Adding as end entity - ${gL(n)} and correlation ${a}`),Object.assign(Object.assign({},e),{activeEntities:Object.assign(Object.assign({},t),{endEntity:n})})}(s,e,r,o,n.id))}function ZU(e,t){var n,a,o,{appViewEntities:r,correlation:s,enableMultiSlotNone:l,entity:c,executionContext:d,isCurrentEntitiesInvalid:u,isInputDefaultEntity:m,logger:g,matchedLinkedEntity:p,sourceHint:v,stateTransition:h,window:f,userContextId:y}=e,b=(0,i.__rest)(e,["appViewEntities","correlation","enableMultiSlotNone","entity","executionContext","isCurrentEntitiesInvalid","isInputDefaultEntity","logger","matchedLinkedEntity","sourceHint","stateTransition","window","userContextId"]);const{coreSettings:S}=t,k=YU(f);let w=f.extendedEntityContainerState,_={activeEntities:k,windowHistory:[...f.windowHistory],currentWindowHistoryIndex:f.currentWindowHistoryIndex,layoutMode:f.layoutConfig.layoutMode,userContextId:f.userContextId,windowId:f.id};if(f.blockingEntityExtension&&k&&h!==C.suD.extend)return xU(C.feW.show,k,Object.assign({appViewEntities:r,correlation:s,enableMultiSlotNone:l,entity:c,executionContext:d,isCurrentEntitiesInvalid:u,isInputDefaultEntity:m,logger:g,matchedLinkedEntity:p,sourceHint:v,stateTransition:h,window:f,userContextId:y},b));if(!k||JU({mainEntity:k.mainEntity,entity:c,stateTransition:h,matchedLinkedEntity:p}))_=function({appViewEntities:e,context:t,correlation:n,isInputDefaultEntity:i,isCurrentEntitiesInvalid:a,logger:o,newEntity:r,sourceHint:s,userContextId:l,window:c,windowContentState:d}){var u;const{subNavEntity:m=null,headerEntity:g=null,startEntity:p=null,mainEntity:v=null,endEntity:h=null,monitorEntity:f=null}=Object.assign({},e),{coreSettings:y}=t,{activeEntities:b}=d,{action:S,type:k}=r,{enableMTMACommanding:w}=y.get(L.J.Core),_=!!w&&l!==c.userContextId;if(!_&&!a&&(S===C.ukP.default&&b&&k===yL(b).type||d.activeEntities&&i))return d;const T={__typename:"ActiveEntities",subNavEntity:QU(m,s),headerEntity:nL(g),startEntity:nL(p),mainEntity:null!==(u=nL(v))&&void 0!==u?u:r,endEntity:nL(h),entityExtension:null,monitorEntity:f},[I,E]=OL({context:t,logger:o,windowContentState:d,newActiveEntities:T,isUserContextSwitch:_});return o.log(`Flushing window - ${gL(r)} and correlation ${n.id}`),{activeEntities:T,windowHistory:I,currentWindowHistoryIndex:E?I.length-1:d.currentWindowHistoryIndex,layoutMode:c.layoutConfig.layoutMode,userContextId:l,windowId:c.id}}({appViewEntities:r,context:t,correlation:s,isCurrentEntitiesInvalid:u,isInputDefaultEntity:m,logger:g,newEntity:c,sourceHint:v,userContextId:y,window:f,windowContentState:_});else if(GU({activeEntities:k,stateTransition:h,executionContext:d}))_=function({activeEntities:e,appViewEntities:t,context:n,executionContext:i,logger:a,window:o,windowContentState:r}){var s;const l=TL({executionContext:i,viewEntityName:C.tF7.headerEntity}),c=l||TL({executionContext:i,viewEntityName:C.tF7.startEntity}),d=c||TL({executionContext:i,viewEntityName:C.tF7.mainEntity}),u=d||TL({executionContext:i,viewEntityName:C.tF7.endEntity});a.log(`Issuing flow command on window - headerEntity ${l}, startEntity ${c}, \n        mainEntity ${d}, endEntity ${u}`);const m=Object.assign(Object.assign({},e),{headerEntity:l?nL(null==t?void 0:t.headerEntity):e.headerEntity,startEntity:c?nL(null==t?void 0:t.startEntity):e.startEntity,mainEntity:d&&null!==(s=nL(null==t?void 0:t.mainEntity))&&void 0!==s?s:e.mainEntity,endEntity:u?nL(null==t?void 0:t.endEntity):e.endEntity}),[g]=OL({context:n,isUserContextSwitch:!1,logger:a,newActiveEntities:m,windowContentState:r});return{activeEntities:m,windowHistory:g,currentWindowHistoryIndex:g.length-1,layoutMode:o.layoutConfig.layoutMode,userContextId:o.userContextId,windowId:o.id}}({activeEntities:k,appViewEntities:r,context:t,executionContext:d,logger:g,window:f,windowContentState:_});else if(function(e,t,n){return!!e&&(HP(e.mainEntity,t)||HP(e.endEntity,t))&&n!==C.suD.extend}(k,c,h))!function(e,t,n,i){e!==jP.EntityStateTransition.new&&t.log(`Entity already exists in the active entities no state transition made - ${gL(n)} and correlation ${i}`)}(h,g,c,s.id),_=function(e,t,n,a,o){const{activeEntities:r}=n;if(!r)return n;const{mainEntity:s,endEntity:l}=r,c=Object.assign({},r),{entityState:d}=a,u=(0,i.__rest)(a,["entityState"]);HP(s,a)?c.mainEntity=Object.assign(Object.assign({},s),u):l&&HP(l,a)&&(c.endEntity=Object.assign(Object.assign({},l),u));const[m]=OL({context:e,isUserContextSwitch:!1,logger:t,newActiveEntities:r,windowContentState:n});return{activeEntities:c,windowHistory:m,currentWindowHistoryIndex:m.length-1,layoutMode:o.layoutConfig.layoutMode,userContextId:o.userContextId,windowId:o.id}}(t,g,_,c,f);else if(h===C.suD.extend){const e=function({activeEntities:e,extendedEntityContainerState:t,logger:n,newEntity:i,windowContentState:a}){const o=t.containerState===C.oqG.Confirmed,r=t.containerState===C.oqG.Error,s=e.entityExtension&&t.isExternal;if(i.type===C.pyR.platformapp&&i.action===C.ukP.create||!e.entityExtension||o||r||s)return t=eL(),a.activeEntities=Object.assign(Object.assign({},e),{entityExtension:i}),[t,a];n.log(`Not showing extension: exists ${!!e.entityExtension}, isConfirmed ${o}, \n  hasError ${r}, hasExternalDialog ${s}`)}({activeEntities:k,extendedEntityContainerState:w,logger:g,newEntity:c,windowContentState:_});if(!e)throw new Error(`Extension already rendered, only one extension command request can be processed at a time. \n        Extension shown: ${null===(n=k.entityExtension)||void 0===n?void 0:n.type}; Extension requested: ${c.type}.`);w=e[0],_=e[1]}else _=XU({activeEntities:k,appViewEntities:r,correlation:s,enableMultiSlotNone:l,newEntity:c,executionContext:d,logger:g,windowContentState:_});if(function(e,t,n,i){const{enableMTMACommanding:a}=e.get(L.J.Core);return!(!a||t||!n||!i.userContextId||n===i.userContextId)}(S,h===C.suD.flush||h===C.suD.forceFlush||h===C.suD.extend,y,f))throw new Error("Different user context sent for non-flush and non-extend command");const T=f.windowHistoryNavigationState,I=Object.assign(Object.assign({},T),{backHistory:[...null!==(a=T.backHistory)&&void 0!==a?a:[]],forwardHistory:[...null!==(o=T.forwardHistory)&&void 0!==o?o:[]]});return Object.assign(Object.assign(Object.assign({},f),_),{correlation:s,extendedEntityContainerState:w,windowHistoryNavigationState:I})}function ej(e,t,n,i){switch(e){case C.feW.hide:return zU(t,n,i);case C.feW.toggle:return qU(t);case C.feW.show:case C.feW.showWithoutFocusing:return ZU(t,n)}}function tj(e,t){if(void 0!==t){const n=t?aL(t):null;e.linkedEntity=n}}function nj(e,t,n,i,a){const{visibilityState:o,stateTransition:r,layoutMode:s}=e;if(o!==C.feW.hide){if(i&&r===C.suD.new)return(0,Ye.v4)();if(a&&n===he.ew){if(!WL(t,null!=s?s:d.lO.standard))return(0,Ye.v4)()}else if(function(e,t){return t===he.ew&&!zL(e,he.ew)}(t,n))return he.ew}}function ij({activeWindows:e,command:t,coreSettings:n,correlation:i,entitiesMap:a,entity:o,isNewContextSupportEnabled:r,layoutMode:s,linkedEntitiesMap:l,logger:c,userContextId:u,windowId:m,webNrcEnabled:g}){const p=t.stateTransition===C.suD.forceFlush,v=t.stateTransition===C.suD.flow,[h,f]=!r||p||v?[void 0,!1]:qL(o,a,l,u,n);h&&(c.log(`Entity matched matched via linked entity ${f} for correlation ${i.id} to window`),hL(h,c));const y=h||function({command:e,activeWindows:t,windowId:n,correlation:i,logger:a,isNewContextSupportEnabled:o,layoutMode:r,userContextId:s,webNrcEnabled:l}){const c=nj(e,t,n,o,l);return void 0!==c?(a.log(`Creating new window with id ${c} for correlation ${i.id}`),function(e,t,n,i,a,o,r,s){return{__typename:"Window",id:t,windowOptions:null,windowHistory:[],currentWindowHistoryIndex:0,windowHistoryNavigationState:{__typename:"WindowHistoryNavigationState",canNavigateBack:!1,canNavigateForward:!1,backHistory:[],forwardHistory:[]},correlation:Object.assign(Object.assign({},e),{__typename:"Correlation"}),extendedEntityContainerState:eL(),blockingEntityExtension:null,isMainWindow:a!==d.su.new&&i===he.ew,isNotificationsWindow:!1,isInitialWindowStateHidden:o===d.fe.showWithoutFocusing,userContextId:s,layoutConfig:{__typename:"LayoutConfig",layoutMode:null!=n?n:t===he.ew||r&&a!==d.su.new?d.lO.standard:d.lO.focus,isFullscreen:!1,slots:uL()}}}(i,c,r,n,e.stateTransition,e.visibilityState,l,s)):(e=>e===he.ew)(n)?(a.log(`Retrieving mainWindow with layoutMode ${r} for correlation ${i.id}`),WL(t,null!=r?r:d.lO.standard)):(a.log(`Retrieving window with id ${n} for correlation ${i.id}`),zL(t,n))}({activeWindows:e,command:t,correlation:i,isNewContextSupportEnabled:r,layoutMode:s,logger:c,userContextId:u,windowId:m,webNrcEnabled:g});if(!y)throw function(e,t){var n;return null===(n=t.errorToTelemetry)||void 0===n||n.call(t,"Unable to get source window",BU),(0,An.Tr)(he.w5.Commanding,he.jK.UndefinedWindowError,"CommandResolvers",e,"Unable to find applicable target window")}(i,c);return[y,f]}function aj(e,t,n,i,a){const o=iL(e),{webNrcEnabled:r}=a.get(L.J.Host),s=r?e=>e.id!==he.ew:void 0,[l,c]=zP(t,qP,s),[d]=qL(o,l,c,i,a);return d&&(n.log(`Found window for entity ${gL(o)}`),hL(d,n)),d||null}function oj(e,t,n,i){const a=e.activeEntities;return!!(null==a?void 0:a.entityExtension)&&(a.entityExtension=null,e.extendedEntityContainerState.containerState=C.oqG.Error,jL(t,n,e,i))}const rj=(e,t,n,a,o,r)=>{const{appsRegistryService:s,cache:l,commandChangeReportingService:c,localStorage:d,coreSettings:u,windowId:m}=n,g=(0,i.__rest)(n,["appsRegistryService","cache","commandChangeReportingService","localStorage","coreSettings","windowId"]),p=Object.assign(Object.assign({},e),{extendedEntityContainerState:Object.assign(Object.assign({},e.extendedEntityContainerState),t)}),v=e.blockingEntityExtension;p.blockingEntityExtension=null;const h=jL(n,o,p,a),f=((e,t,n)=>{const i=null==e?void 0:e.blockedEntity,a=null==e?void 0:e.blockedCommand,o=null==e?void 0:e.blockedEntityOptions;if(!i||!a)return t.warn("Unable to re-create the command which was blocked and saved."),null;const r=tL();r.source=kt.D.CoreResolvers;const s={entity:i,command:Object.assign(Object.assign({},a),{correlation:r}),entityOptions:o};return n.report({type:wC.B.CommandStart,correlationId:s.command.correlation.id,context:{target:"createAndRegisterBlockedCommandOnConfirm",entityCommand:Object.assign(Object.assign({},s),{entityOptions:o?JSON.parse(o):void 0})}}),s})(v,a,c);if(f){const{entity:e,command:t,entityOptions:n}=f;return!!cj({entity:e,command:t,entityOptions:n,windowId:m,clientLaunchId:p.correlation.clientLaunchId},Object.assign({appsRegistryService:s,cache:l,commandChangeReportingService:c,coreSettings:u,localStorage:d,windowId:m},g),r)}return h},sj=({logger:e,appsRegistryService:t,coreSettings:n})=>{const i=t.getDefaultCommand(n);return i?(e.log("Default command found"),i):(e.error("No default command defined"),null)},lj=({isInputDefaultEntity:e,sourceWindow:t,context:n,userContextId:i,newEntity:a,matchedLinkedEntity:o,stateTransition:r,executionContext:s,correlation:l,logger:c})=>{var d;const{localStorage:u,coreSettings:m,appsRegistryService:g,commandChangeReportingService:p,clientPreferences:v}=n,{enableWriteActiveEntitiesToLocalStorage:h,enableMTMACommanding:f,enableWriteAppHistoryToLocalStorage:y}=m.get(L.J.Core);let b=null,S=!1;e&&t.isMainWindow&&h?b=((e,t,n,i)=>{var a;const o=e.get((0,IL.bM)(IL.WD,n),Ct.f.Experience);if(o)try{const e=JSON.parse(o);return i&&n!==e.userContextId?null:FL(e.activeEntities,t)}catch(e){null===(a=t.errorToTelemetry)||void 0===a||a.call(t,`Could not restore active entities from local storage. Stored string was in an invalid JSON format. String: ${o}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0)}return null})(u,c,i,f):a.action===C.ukP.default&&t.isMainWindow&&y&&(b=((e,t,n,i)=>{var a,o;const r=null===(a=i.getApp({entityType:n}))||void 0===a?void 0:a.manifest.id,s=e.get(`${IL.av}-${r}`);if(s)try{return FL(JSON.parse(s),t)}catch(e){null===(o=t.errorToTelemetry)||void 0===o||o.call(t,`Could not restore active entities from local storage. Stored string was in an invalid JSON format error ${e}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),t.log("String in local storage: ",s)}return null})(u,c,a.type,g));const k=GP(t)?t.activeEntities:void 0;if(b){c.log("Got appViewEntities from local storage history: "),fL(b,c);const e=mj(b,g),n=mj(k,g),i=null===(d=null==e?void 0:e.onBeforeNavigationFromHistory)||void 0===d?void 0:d.call(e,b,{coreSettings:m,layoutMode:t.layoutConfig.layoutMode,userPreferences:SL(v)},(null==n?void 0:n.manifest.id)===(null==e?void 0:e.manifest.id)?k:void 0);S=!!i,S&&(c.log("App declared history invalid. New set of entities:"),fL(i,c)),b=i||b}else{const e=(({currentEntities:e,newEntity:t,matchedLinkedEntity:n,stateTransition:i,executionContext:a})=>!e||JU({entity:t,mainEntity:e.mainEntity,matchedLinkedEntity:n,stateTransition:i})||GU({activeEntities:e,stateTransition:i,executionContext:a}))({currentEntities:k,newEntity:a,matchedLinkedEntity:o,stateTransition:r,executionContext:s});c.log(`Should use entity from command input for getAppViewEntities ${e} `);const{appEntity:n,contextEntity:i}=bL({currentEntities:GP(t)?t.activeEntities:void 0,entity:a,shouldUseNewEntity:e});p.report({type:wC.B.CommandBeforeGetAppViewEntities,context:{target:"executeEntityCommand"},correlationId:l.id});try{b=kL({appsRegistryService:g,clientPreferences:v,contextEntity:i,coreSettings:m,entity:n,layoutMode:t.layoutConfig.layoutMode}),(({appViewEntities:e,stateTransition:t,appEntity:n,linkedEntity:i})=>t!==jP.EntityStateTransition.none&&null===e&&n===i)({appEntity:n,appViewEntities:b,linkedEntity:a.linkedEntity,stateTransition:r})&&(c.log(`Initial getAppViewEntities for ${n} returned null`),b=kL({entity:a,clientPreferences:v,contextEntity:null,coreSettings:m,layoutMode:t.layoutConfig.layoutMode,appsRegistryService:g}))}catch(e){p.report({type:wC.B.Failure,context:{errorInfo:CC.y.CommandGetAppViewEntitiesFailure,errorMessage:e.message,target:"executeEntityCommand"},correlationId:l.id})}}return{appViewEntities:b,isCurrentEntitiesInvalid:S}},cj=({clientLaunchId:e,command:t,entity:n,entityOptions:i,executionContext:a,windowId:o,windowOptions:r},s,l)=>{var c,u,m,g,p,v;const{appsRegistryService:h,authenticationUser:f,cache:y,clientPreferences:b,commandChangeReportingService:S,coreSettings:k,experienceChangeReportingService:w,loggerFactory:_,notificationsHandler:T,windowProvider:I,scenarioFactory:E}=s,N=_.newLogger("executeEntityCommand-mutation","data-client-entity-command"),{visibilityState:A,stateTransition:F,correlation:D,layoutMode:R}=t;try{const v=o||he.ew,_=((e,t)=>t?Object.assign(Object.assign({},t),{clientLaunchId:null!=e?e:null,__typename:"Correlation"}):Object.assign(Object.assign({},tL()),{clientLaunchId:null!=e?e:null,__typename:"Correlation"}))(null!=e?e:null,D);S.report({correlationId:_.id,type:wC.B.CommandResolutionStarted,context:{target:"executeEntityCommand"}});const x=UL(y,N),[M,O]=zP(x,qP,(e=>!HL(x,e.id)&&!((e,t)=>{const n=WL(e,jP.LayoutModes.minimal);return t===(null==n?void 0:n.id)})(x,e.id)&&!((e,t)=>{const n=WL(e,jP.LayoutModes.minimode);return t===(null==n?void 0:n.id)})(x,e.id))),P=(e=>e.action===jP.EntityAction.default&&e.type===jP.EntityType.default)(n),U=null==D?void 0:D.sourceHint,j=(({entity:e,isInputDefaultEntity:t,logger:n,appsRegistryService:i,coreSettings:a})=>t?sj({logger:n,appsRegistryService:i,coreSettings:a}):e)({entity:n,isInputDefaultEntity:P,logger:N,appsRegistryService:h,coreSettings:k});if(!j)return null===(c=N.errorToTelemetry)||void 0===c||c.call(N,"Unable to use entity from command input",BU,void 0,!0),null;const $=iL(j,i,r);if(function(e){return e.type===jP.EntityType.toasts}($))return(({activeWindows:e,context:t,command:n,correlation:i,entity:a,entityOptions:o,logger:r,notificationsHandler:s,newEntity:l})=>{var c;let d,u;try{o&&(d=JSON.parse(o))}catch(e){null===(c=r.errorToTelemetry)||void 0===c||c.call(r,"CN:Ignoring error while parsing entity options for toasts.","webclient_framework_foundation_resolvers_notifications",void 0,!0)}if(!s.isCustomNotificationEnabled(d))return s.sendCommandToHost(n,i.id,a,d),null;const m=e.findIndex((e=>!0===e.isNotificationsWindow));return u=-1===m?$U(i,null):e[m],l.id=(0,Ye.v4)(),((e,t)=>{t.activeEntities.mainEntity=e})(l,u),jL(t,e,u,r,i.id)?u:null})({activeWindows:x,context:s,command:t,correlation:_,entity:n,entityOptions:i,logger:N,notificationsHandler:T,newEntity:$});N.log(`Command received for entity ${gL($)}`),N.log(`Command received :${function(e){return`{\n    visibilityState: ${e.visibilityState},\n    stateTransition: ${e.stateTransition},\n    correlation: ${pL(e.correlation)}\n  }`}(t)}`),N.log(`Command with id ${_.id} received on window context ${v}`),N.log(`Command received with execution context: ${null==a?void 0:a.viewEntityName}`);const{isNewContextSupportEnabled:B,webNrcEnabled:W}=k.get(L.J.Host),{enableMultiSlotHide:H,enableMultiSlotNone:V,enableWindowNotUpdatedEvent:z,enableMTMACommanding:q,forceFocusLayoutMode:G,enableWindowHistoryRestorationOnStandardMain:J,enableT21WebNewContextsOverride:Q,enableEmptyWindowDialogForDeeplink:K}=k.get(L.J.Core),Y=WL(x,C.lOW.standard),X=q&&((null==a?void 0:a.userContextId)||sL(f)||F===C.suD.extend&&Y&&Y.userContextId)||null;N.log(`isNewContextSupportEnabled ${B}, enableMultiSlotHide ${H}, enableMultiSlotNone ${V}`);let Z=B;B||Q&&$.type===C.pyR.brbfeedbackdialog&&(Z=!0);const ee=((e,t)=>t?d.lO.focus:e&&(e.layoutMode||d.lO.focus))(I.Cypress,!!G),te=ij({activeWindows:x,command:t,coreSettings:k,correlation:_,entitiesMap:M,entity:$,isNewContextSupportEnabled:null==Z||Z,layoutMode:null!=ee?ee:R,linkedEntitiesMap:O,logger:N,userContextId:X,windowId:v,webNrcEnabled:null!=W&&W});let[ne]=te;const[,ie]=te;let ae=!1;if(J&&ne&&!GP(ne)&&ne.isMainWindow&&ne.layoutConfig.layoutMode===C.lOW.standard&&(ne=((e,t,n,i,a)=>{var o,r;const s=t.get((0,IL.bM)(IL.Hs,i),Ct.f.Experience);if(s)try{const l=JSON.parse(s);if(a&&i!==l.userContextId)return null===(o=n.warnToTelemetry)||void 0===o||o.call(n,"User context of window doesn't match user context of stored history","webclient_framework_foundation_core_services_entity_commanding",void 0,!0),e;const c=parseInt(l.windowHistoryIndex,10);if(isNaN(c))return null===(r=n.warnToTelemetry)||void 0===r||r.call(n,`Store window history has invalid history index. CurrentWindowHistoryIndex ${l.windowHistoryIndex}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),e;const d=t.get((0,IL.bM)(IL.ax,i),Ct.f.Experience);if(d){const t=DL(JSON.parse(d),n);return Object.assign(Object.assign({},e),{windowHistory:t,currentWindowHistoryIndex:c})}n.warn("Could not restore history from storage")}catch(e){n.errorToTelemetry&&n.errorToTelemetry(`Could not restore main window nav history from local storage ${e.message}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0)}else n.warn("Could not restore main window nav history index from local storage. IndexAndUserFromStorage is null");return e})(ne,s.localStorage,N,X,q),ne.windowHistory.length>0&&(N.log("Restored main window navigation history from local storage"),ae=!0)),F===C.suD.extend){if(K&&!GP(ne)&&ne.isMainWindow&&v===he.ew){N.log("Extension command - creating main window");const e=sj({logger:N,appsRegistryService:h,coreSettings:k});if(!e)throw new Error("No default entity. Unable to show extension");const t=iL(e,i,r),{appViewEntities:n,isCurrentEntitiesInvalid:o}=lj({isInputDefaultEntity:!0,sourceWindow:ne,context:s,userContextId:X,newEntity:t,matchedLinkedEntity:!1,stateTransition:C.suD.flush,executionContext:a,correlation:_,logger:N});N.log(`Extension command - flushing with entity ${gL(t)}`),fL(n,N),ne=ej(C.feW.show,{appsRegistryService:h,appViewEntities:n||void 0,clientPreferences:b,commandChangeReportingService:S,correlation:_,coreSettings:k,enableMultiSlotHide:H,enableMultiSlotNone:V,entitiesMap:M,entity:t,entityOptions:i,executionContext:a,host:I,isCurrentEntitiesInvalid:o,isInputDefaultEntity:!0,logger:N,matchedLinkedEntity:ie,sourceHint:U,stateTransition:C.suD.flush,userContextId:X,window:ne},s,l),N.log("Extension command - created source window"),hL(ne,N)}const e=!GP(ne);if(e||ne.userContextId!==X){const t=e?CC.y.EmptyWindowError:CC.y.UserContextMismatch;return N.log(`Extension command error ${t}`),S.report({correlationId:_.id,type:wC.B.Incomplete,context:{errorInfo:t,target:"executeEntityCommand"}}),null}}const{appViewEntities:oe,isCurrentEntitiesInvalid:re}=lj({isInputDefaultEntity:P,sourceWindow:ne,context:s,userContextId:X,newEntity:$,matchedLinkedEntity:ie,stateTransition:F,executionContext:a,correlation:_,logger:N});if(S.report({type:wC.B.CommandAfterGetAppViewEntitiesSucceeded,context:{target:"executeEntityCommand"},correlationId:_.id}),N.log("Final appViewEntities: "),fL(oe,N),N.log(`Before updating cache, There are ${x.length} active windows`),N.log("Source window: "),hL(ne,N),null===oe)throw null===(u=N.errorToTelemetry)||void 0===u||u.call(N,"No app supports entity command",BU),new Error("no app view entities for entity input");let se=ej(A,{appsRegistryService:h,appViewEntities:oe,clientPreferences:b,commandChangeReportingService:S,correlation:_,coreSettings:k,enableMultiSlotHide:H,enableMultiSlotNone:V,entitiesMap:M,entity:$,entityOptions:i,executionContext:a,host:I,isCurrentEntitiesInvalid:re,isInputDefaultEntity:P,logger:N,matchedLinkedEntity:ie,sourceHint:U,stateTransition:F,userContextId:X,window:ne},s,l);N.log("Target window: "),hL(se,N),GP(ne)&&GP(se)&&(null===(m=ne.activeEntities)||void 0===m?void 0:m.monitorEntity)&&(se.activeEntities.monitorEntity=null===(g=ne.activeEntities)||void 0===g?void 0:g.monitorEntity);const le=function(e,t){return JP(GP(e)?e.activeEntities:null,GP(t)?t.activeEntities:null)}(ne,se);!function(e,t,n,i,a,o,r){const s=(0,wE.YR)(e,n);r.log(`ViewportContext: ${s}`);const l={"Panel.WindowID":t,"Window.ViewportContext":s};a.report({correlationId:i,type:wC.B.ScenarioEventDataAppended,context:{target:"setViewportContextOnLaunchScenarios",eventData:l}});const c=o.findScenario(it.RG.WindowLaunchTime);null==c||c.appendEventData(l)}(se.isMainWindow,se.id,se.layoutConfig.layoutMode,_.id,S,E,N),S.report({correlationId:_.id,type:wC.B.CommandMetaDataAdded,context:{target:"executeEntityCommand",isCommandTargetedToMainWindow:se.id===he.ew,shouldNavigate:KP(ne,se,F,$)}});const ce=ne.id===he.ew&&F!==C.suD.new&&F!==C.suD.none;if(YL(le,v,ce,F===C.suD.flow||F===C.suD.none,k,N)){N.log(`Opener will handle the requested entity change with correlationId ${_.id} and entityId ${n.id}`);let e=!0;le.entityExtension&&(se.extendedEntityContainerState.isExternal=!0,e=jL(s,x,se,N));const t=zL(x,he.ew);if(t&&(e=>!(!e.activeEntities.entityExtension||e.extendedEntityContainerState.containerState===C.oqG.Closed))(t)&&PU(t,x,N,_,s),e)try{return(({correlation:e,diff:t,commandChangeReportingService:n,windowId:i,logger:a,targetWindow:o,context:r,activeWindows:s})=>{var l;if(XL(e,t,n,i,a,r.coreSettings))return null;throw oj(o,r,s,a),null===(l=a.errorToTelemetry)||void 0===l||l.call(a,"Unable to update cache, opener did not handle change",BU),(0,An.Tr)(he.w5.Commanding,he.jK.UnhandledRuntimeException,"executeEntityCommand",void 0,"Unable to update cache, opener did not handle the entity change")})({correlation:_,diff:le,commandChangeReportingService:S,windowId:v,logger:N,targetWindow:se,context:s,activeWindows:x})}catch(e){throw oj(se,s,x,N),null===(p=N.errorToTelemetry)||void 0===p||p.call(N,"Unable to update cache, errored while having opener handle change",BU,{errors:`${e.message}`}),(0,An.Tr)(he.w5.Commanding,he.jK.UnhandledRuntimeException,"executeEntityCommand",e,"Unable to update cache, opener threw an exception and did not handle the entity change")}}if(((e,t,n)=>{const i=GP(e)?e.activeEntities.entityExtension:null,a=GP(t)?t.activeEntities.entityExtension:null;return!(t.extendedEntityContainerState.containerState===C.oqG.Closed||!(i&&ZP(n)||!a))})(ne,se,le)&&(se=((e,t,n,i,a)=>{let o=e;return e.extendedEntityContainerState.isExternal?n.log(`Internal routing - closing external dialog for correlation ${a.id}`):(n.log(`Internal routing - closing internal dialog for correlation ${a.id}`),GP(e)&&(o=LU(e,a))),e.id===he.ew&&(n.log(`Internal routing - send close extension to angular for correlation ${a.id}`),OU(t,n,i)),o})(se,ne,N,S,_)),N.log(`Handling the requested entity command internally for correlation ${_.id}`),GL({pubsub:l,fromWindowId:v,isFromWindowMain:HL(x,v),sourceWindowId:ne.id,diff:le,targetWindow:se,targetVisibilityState:A,stateTransition:F,correlation:_,logger:N}),RL(se,N,ae?se.currentWindowHistoryIndex:void 0,k),z&&!QP(ne,se))return S.report({correlationId:_.id,type:wC.B.WindowNotUpdated,context:{target:"executeEntityCommand"}}),null;if(ne.correlation.id!==_.id){const e=GP(ne)?ne.activeEntities:void 0;e&&S.report({correlationId:_.id,type:wC.B.ScenarioEventDataAppended,context:{target:"executeEntityCommand",eventData:{fromMainEntityType:e.mainEntity.type,fromMainEntityAction:e.mainEntity.action}}}),S.report({correlationId:ne.correlation.id,type:wC.B.Abandoned,context:{target:"executeEntityCommand"}}),w.report({correlationId:_.id,type:l_.yU.ActiveEntitiesDestroyed,context:{target:"entity-command-resolver"},windowId:ne.id})}!HP(GP(se)?se.activeEntities.mainEntity:null,GP(ne)?ne.activeEntities.mainEntity:null)&&GP(ne)&&(se=dL(se,{resetMonitor:null===ne.activeEntities.monitorEntity}));const de=jL(s,x,se,N,_.id);if(de){const e=function(e){const t=[];return Object.keys(e).map((n=>{const i=e[n];i&&t.push(i)})),t}(le);e.length>0&&w.report({correlationId:_.id,type:l_.yU.ActiveEntitiesResolved,context:{target:"entity-command-resolver",entities:e},windowId:se.id}),S.report({correlationId:_.id,type:wC.B.WindowUpdated,context:{target:"executeEntityCommand"}})}return de&&GP(se)?se:null}catch(e){throw null===(v=N.errorToTelemetry)||void 0===v||v.call(N,`Unable to execute entity command ${A} ${F} -  ${e.message}`,BU,{mainEntityType:n.type,mainEntityAction:n.action,correlationId:D.id},!0),e}},dj=(e,t,n,a)=>{var{cache:o,windowId:r,commandChangeReportingService:s}=n,l=(0,i.__rest)(n,["cache","windowId","commandChangeReportingService"]);if(!e.activeEntities.entityExtension)return!1;const c=MU(e,t,s);if(c){const{entity:t,command:n}=c;return cj({entity:t,command:n,windowId:r,clientLaunchId:e.correlation.clientLaunchId},Object.assign({cache:o,windowId:r,commandChangeReportingService:s},l),a)}return!1},uj=e=>({Query:{activeWindow(e,{windowId:t},{cache:n,coreSettings:i,loggerFactory:a}){const o=a.newLogger("activeWindow","data-client-entity-command"),{webNrcEnabled:r}=i.get(L.J.Host),s=t||he.ew;let l;const c=UL(n,o,!1);if(l=s===he.ew&&r?WL(c,C.lOW.standard):c.find((e=>e.id===s)),!l)throw new Error(`Requesting activeWindow for unknown windowId ${s}`);return l},activeWindowForEntity(e,{entity:t},{cache:n,loggerFactory:i,authenticationUser:a,coreSettings:o}){const r=i.newLogger("activeWindowForEntity-query","data-client-entity-command"),s=UL(n,r),{enableMTMACommanding:l}=o.get(L.J.Core);return aj(t,s,r,l?sL(a):null,o)}},Mutation:{navigateToWindowHistoryIndex:(e,t,n)=>(({windowId:e,windowHistoryIndex:t},n)=>{var i;const{cache:a,loggerFactory:o}=n,r=o.newLogger("navigateToWindowHistoryIndex-mutation","data-client-entity-command");r.log(`Navigating to windowHistoryIndex ${t} on window ${e}.`);const s=UL(a,r),l=zL(s,e);if(!l)throw new Error("Could not find window.");return!(0===(null===(i=l.windowHistory)||void 0===i?void 0:i.length)||t<0||t>l.windowHistory.length-1)&&QL(l,t,r,s,n)})(t,n),performWindowHistoryNavigation:(e,t,n)=>(({windowId:e,navigationDirection:t},n)=>{var i;const{cache:a,loggerFactory:o}=n,r=o.newLogger("performWindowHistoryNavigation-mutation","data-client-entity-command");r.log(`Navigating ${e} with direction ${t}.`);const s=UL(a,r),l=zL(s,e);if(!l)throw new Error("Could not find window.");if(0===(null===(i=l.windowHistory)||void 0===i?void 0:i.length))return!1;let c=l.currentWindowHistoryIndex;const d=e=>r.warn(`Could not navigate ${t}. Index ${e} is out of the bounds of the window history.`);if(t===C.fEB.back){if(c--,c<0)return d(c),!1}else if(++c,c>l.windowHistory.length-1)return d(c),!1;return QL(l,c,r,s,n)})(t,n),updateEntity(e,{entity:t,entityOptions:n,viewEntityName:i,windowId:a},o){const{cache:r,loggerFactory:s}=o,l=a||he.ew,c=s.newLogger("updateEntity-mutation","data-client-entity-command"),d=UL(r,c),u=zL(d,l);if(!u)return c.warn("Trying to update entity in window that does not exist"),!1;if(u.userContextId&&o.authenticationUser&&u.userContextId!==sL(o.authenticationUser))return c.warn("Trying to update entity in for a different user context than currently present on the window"),!1;const m=iL(t,n);return c.log(`Updating entity with input: ${gL(m)}`),function({entity:e,window:t,viewEntityName:n}){t.activeEntities[n]=Object.assign(Object.assign({},t.activeEntities[n]),e)}({window:u,entity:m,viewEntityName:i}),jL(o,d,u,c)},updateEntityState(e,{entity:t,entityState:n},i){const{authenticationUser:a,cache:o,coreSettings:r,loggerFactory:s}=i,{enableMTMACommanding:l}=r.get(L.J.Core),c=s.newLogger("updateEntityState-mutation","data-client-entity-command"),d=UL(o,c),u=aj(t,d,c,l?sL(a):null,r);if(!u)return c.warn("Trying to update flushable entity that does not exist"),!1;return function(e,t,n,i){const{mainEntity:a,endEntity:o}=e.activeEntities,{flushableByLinkedEntity:r,linkedEntityUpdate:s}=n;HP(a,t)?(null!=r&&(a.entityState.flushableByLinkedEntity=r),tj(a,s)):o&&HP(o,t)?(i.log("Updating entity state for end entity"),tj(o,s)):i.warn(`Updating entity state for entity the does not exist ${t}`)}(u,iL(t),n,c),jL(i,d,u,c),!0},updateExtendedEntityContainerState(t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{cache:t,loggerFactory:i,windowId:o,windowProvider:r}=a,s=i.newLogger("updateExtendedEntityContainerState-mutation","data-client-entity-command"),l=UL(t,s),c=zL(l,o);if(c)if(((e,t)=>{var n;return e===C.oqG.Confirmed&&(null===(n=t.blockingEntityExtension)||void 0===n?void 0:n.entity)&&HP(t.activeEntities.entityExtension,t.blockingEntityExtension.entity)})(n.containerState,c))c.id===he.ew&&r.opener.postMessage(Hw.W.MainWindowBlockedState,{isBlocked:"Confirmed",entity:null}),rj(c,n,a,s,l,e);else{if(n.containerState!==C.oqG.Closed)return c.extendedEntityContainerState=Object.assign(Object.assign({},c.extendedEntityContainerState),n),jL(a,l,c,s);dj(c,s,a,e)}return!1}))},executeEntityCommand:(t,n,i)=>cj(n,i,e),addBlockingExtension:(t,{entity:n,entityOptions:a,windowId:o,removeBlock:r},s)=>{var{cache:l,loggerFactory:c,windowProvider:d}=s,u=(0,i.__rest)(s,["cache","loggerFactory","windowProvider"]);const m=c.newLogger("addBlockingExtension-mutation","data-client-entity-command");m.log(`${r?"Removing":"Adding"} an entity extension blocker of type ${n.type}`);const g=UL(l,m),p=zL(g,o);if(p){const t=Object.assign(Object.assign({},n),{id:n.id||null,linkedEntity:null,options:a||null,windowOptions:null,__typename:"Entity",entityState:{flushableByLinkedEntity:!1,__typename:"EntityState"}});if(r&&p.blockingEntityExtension)return((e,t,n,i,a,o)=>{const{windowProvider:r}=o;if(!t.blockingEntityExtension||!HP(t.blockingEntityExtension.entity,e))return!1;const s=Object.assign(Object.assign({},t),{blockingEntityExtension:null}),l=jL(o,n,s,i);return s.id===he.ew&&r.opener.postMessage(Hw.W.MainWindowBlockedState,{isBlocked:"Unblocked",entity:null}),dj(t,i,o,a),l})(t,p,g,m,e,Object.assign({cache:l,loggerFactory:c,windowProvider:d},u));if(!r)return((e,t,n,i,a)=>{var o;const{windowProvider:r}=a,s={entity:e,__typename:"BlockingEntityExtension",blockedEntity:null,blockedCommand:null,blockedEntityOptions:null},l=Object.assign(Object.assign({},t),{blockingEntityExtension:s});if(l.id===he.ew)try{r.opener.postMessage(Hw.W.MainWindowBlockedState,{isBlocked:"Blocked",entity:s.entity,entityOptions:e.options&&JSON.parse(e.options)})}catch(e){null===(o=i.errorToTelemetry)||void 0===o||o.call(i,"Unable to parse and post addBlockingExtension to main window",BU)}return jL(a,n,l,i)})(t,p,g,m,Object.assign({cache:l,windowProvider:d,loggerFactory:c},u))}return!1},setWindowFullscreen:(e,{isFullscreen:t,windowId:n},i)=>{const{cache:a,loggerFactory:o}=i,r=o.newLogger("setWindowFullscreen-mutation","data-client-entity-command"),s=UL(a,r),l=zL(s,n);if(!l)return null;let c=!1;return l.layoutConfig.isFullscreen!==t&&(l.layoutConfig.isFullscreen=t,c=jL(i,s,l,r)),c&&GP(l)?l:null},removeUserActiveWindows:(e,{userContextId:t},n)=>{const{cache:i,loggerFactory:a}=n,o=a.newLogger("removeUserActiveWindowsMutation-mutation","data-client-entity-command");return jL(n,((e,t)=>e.filter((e=>e.isMainWindow||e.userContextId!==t)))(UL(i,o),t),void 0,o)},saveReactiveVarsToHistory(e,{windowId:t,appIds:n},i){const{cache:a,loggerFactory:o}=i,r=o.newLogger("saveReactiveVarsToHistory-mutation","data-client-entity-command"),s=t||he.ew,l=UL(a,r),c=zL(l,s);if(!c)return r.warn("Trying to save reactive var history for window that does not exist"),!1;if(0===c.windowHistory.length)return!1;const d={activeEntities:c.activeEntities,windowHistory:c.windowHistory,currentWindowHistoryIndex:c.currentWindowHistoryIndex,layoutMode:c.layoutConfig.layoutMode,userContextId:c.userContextId||null,windowId:c.id},[u,m]=OL({appIdsForReactiveVarChange:n,context:i,isUserContextSwitch:!1,logger:r,newActiveEntities:c.activeEntities,windowContentState:d});if(!m)return r.log("Did not update history"),!1;const g=Object.assign(Object.assign({},c),{windowHistory:u});return RL(g,r,void 0,i.coreSettings),jL(i,l,g,r),!0}}}),mj=(e,t)=>{if(e){const n=yL(e);return t.getApp({entityType:n.type})}};var gj=n(822927);const pj=e=>({__typename:"MeetingRoomFrontOfRoomCallPanelsState",id:e,rightPanel:null});var vj=n(842533);const hj={Query:{meetingRoomFrontOfRoomCallPanelsState:(e,{teamsCallId:t},{cache:n})=>{let i=pj(t);try{const e=n.readQuery({query:vj.Z,variables:{teamsCallId:t}}),a=null==e?void 0:e.meetingRoomFrontOfRoomCallPanelsState;i=null!=a?a:i}catch(e){}return i}},Mutation:{setMeetingRoomFrontOfRoomCallPanelsState:(e,{teamsCallId:t,state:n},{cache:i,loggerFactory:a})=>{var o;const r=null==a?void 0:a.newLogger("setMeetingRoomFrontOfRoomCallPanelsState","data-resolvers-browser-meeting-artifacts");let s=pj(t);try{const e=i.readQuery({query:vj.Z,variables:{teamsCallId:t}});(null==e?void 0:e.meetingRoomFrontOfRoomCallPanelsState)&&(s=e.meetingRoomFrontOfRoomCallPanelsState)}catch(e){null==r||r.error("No data found in cache for meetingRoomFrontOfRoomCallPanelsState, using default value")}const l={__typename:"MeetingRoomFrontOfRoomCallPanelsState",id:s.id,rightPanel:null!==(o=n.rightPanel)&&void 0!==o?o:null};try{i.writeQuery({query:vj.Z,variables:{teamsCallId:t},data:{meetingRoomFrontOfRoomCallPanelsState:l}})}catch(e){null==r||r.error("setMeetingRoomFrontOfRoomCallPanelsState to cache failed.")}return l}}};var fj=n(634298),yj=n(2002),bj=n(2352),Sj=n(792897);const kj={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientVirtualEventsVirtualEventActionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"virtualEventAction"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},wj={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientVirtualEventsVirtualEventSchedulingFormDataQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"virtualEventSchedulingFormData"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasUnsavedChanges"}}]}}]}}]},Cj={Query:{virtualEventAction(e,t,{cache:n,loggerFactory:i}){var a,o,r;try{return null!==(o=null===(a=n.readQuery({query:kj}))||void 0===a?void 0:a.virtualEventAction)&&void 0!==o?o:null}catch(e){const t=i.newLogger("virtual-event-action","data-client-virtual-events");return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,"virtualEventAction: Failed to fetch virtual event action from cache.","virtual_event_form_action"),null}},virtualEventSchedulingFormData(e,t,{cache:n,loggerFactory:i}){var a,o,r;try{return null!==(o=null===(a=n.readQuery({query:wj}))||void 0===a?void 0:a.virtualEventSchedulingFormData)&&void 0!==o?o:null}catch(e){const t=i.newLogger("virtual-event-scheduling-form-data","data-client-virtual-events");return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,"virtualEventSchedulingFormData: Failed to fetch virtual event scheduling form data from cache.","virtual_event_scheduling_form_data"),null}}},Mutation:{setVirtualEventAction(e,{input:{type:t}},{cache:n,loggerFactory:i}){var a;const o=i.newLogger("set-virtual-event-action","data-client-virtual-events");try{n.writeQuery({query:kj,data:{virtualEventAction:t}})}catch(e){return null===(a=o.errorToTelemetry)||void 0===a||a.call(o,"setVirtualEventStateAction: Failed to update virtual event action task in cache.","virtual_event_form_action"),null}return t},updateVirtualEventSchedulingFormData(e,{virtualEventSchedulingFormDataInput:t},{cache:n,loggerFactory:i}){var a,o;const r=i.newLogger("update-virtual-event-scheduling-form-data","data-client-virtual-events"),s={virtualEventSchedulingFormData:{__typename:"VirtualEventSchedulingFormData",hasUnsavedChanges:null!==(a=t.hasUnsavedChanges)&&void 0!==a&&a}};try{n.writeQuery({query:wj,data:s})}catch(e){return null===(o=r.errorToTelemetry)||void 0===o||o.call(r,"updateVirtualEventSchedulingFormData: Failed to update virtual event scheduling form data in cache.","virtual_event_scheduling_form_data"),null}return s.virtualEventSchedulingFormData}}};var _j=n(657321);class Tj{constructor(){}static create(e){if(Tj._clientResolvers)throw new Error("ClientResolvers are already created");return Tj._clientResolvers=function(e){return(0,a.merge)((0,gj.w)(),OP.w,$O,PO,(0,MP.wf)(),function(){let e;const t=t=>a=>(o,r,s)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e){const{broadcastClientResolvers:t}=yield Promise.all([n.e(594881),n.e(984633),n.e(495706),n.e(135932),n.e(271197),n.e(791789)]).then(n.bind(n,470042));e=t()}return e[t][a](o,r,s)}));return{Query:{broadcastLayout:t("Query")("broadcastLayout"),attendeeCaptionsVisibility:t("Query")("attendeeCaptionsVisibility")},Mutation:{setBroadcastActiveSectionSource:t("Mutation")("setBroadcastActiveSectionSource"),updateBroadcastLayout:t("Mutation")("updateBroadcastLayout"),selectBroadcastSection:t("Mutation")("selectBroadcastSection"),clearBroadcastSource:t("Mutation")("clearBroadcastSource"),createDebugBroadcast:t("Mutation")("createDebugBroadcast"),updateAttendeeCaptionsVisibility:t("Mutation")("updateAttendeeCaptionsVisibility")}}}(),function(e){let t;const a=a=>o=>(r,s,l)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!t){const{clientResolvers:i}=yield Promise.all([n.e(594881),n.e(984633),n.e(495706),n.e(135932),n.e(271197),n.e(791789)]).then(n.bind(n,470042));t=i(e)}return t[a][o](r,s,l)}));return{CallingIntent:{isFake:a("CallingIntent")("isFake")},CallLogParticipant:{hasDisplayName:a("CallLogParticipant")("hasDisplayName"),displayName:a("CallLogParticipant")("displayName")},Query:{whiteboardSharingSession:a("Query")("whiteboardSharingSession"),pptSharingSession:a("Query")("pptSharingSession"),bulkMoveStatus:a("Query")("bulkMoveStatus"),anonymousDisplayName:a("Query")("anonymousDisplayName"),prejoinState:a("Query")("prejoinState"),callingScreenStatus:a("Query")("callingScreenStatus"),callingScreenLayout:a("Query")("callingScreenLayout"),pinnedParticipantIds:a("Query")("pinnedParticipantIds"),videoScanType:a("Query")("videoScanType"),captionFontSize:a("Query")("captionFontSize"),debugVideoEffectState:a("Query")("debugVideoEffectState"),selectedBackgroundsInfo:a("Query")("selectedBackgroundsInfo"),getHardwareOutDevices:a("Query")("getHardwareOutDevices"),avatarInfo:a("Query")("avatarInfo"),selectedAvatarInfo:a("Query")("selectedAvatarInfo"),activeVideoEffects:a("Query")("activeVideoEffects"),videoEffectsCurrentInfo:a("Query")("videoEffectsCurrentInfo"),currentCallingState:a("Query")("currentCallingState"),compositorRegions:a("Query")("compositorRegions"),avatarAppAvailabilityInfo:a("Query")("avatarAppAvailabilityInfo"),immersiveViewModeAppAvailabilityInfo:a("Query")("immersiveViewModeAppAvailabilityInfo"),debugClosedCaptionsEvent:a("Query")("debugClosedCaptionsEvent"),isCallingScreenReady:a("Query")("isCallingScreenReady")},Mutation:{moveRoomRetainedParticipants:a("Mutation")("moveRoomRetainedParticipants"),acceptStreamPermissionsDebug:a("Mutation")("acceptStreamPermissionsDebug"),sendToDebugHardwareOutDevice:a("Mutation")("sendToDebugHardwareOutDevice"),stopDebugHardwareOutDevice:a("Mutation")("stopDebugHardwareOutDevice"),setDebugSpeakerVolume:a("Mutation")("setDebugSpeakerVolume"),setDebugToolVisible:a("Mutation")("setDebugToolVisible"),updateMeetingRoomLayoutToggleState:a("Mutation")("updateMeetingRoomLayoutToggleState"),updateShouldLaunchWhiteboardOnLoad:a("Mutation")("updateShouldLaunchWhiteboardOnLoad"),setDebugToolHiddenParticipantsCount:a("Mutation")("setDebugToolHiddenParticipantsCount"),setBulkMoveStatus:a("Mutation")("setBulkMoveStatus"),createDebugBreakoutRooms:a("Mutation")("createDebugBreakoutRooms"),createDebugCall:a("Mutation")("createDebugCall"),addDebugSuggestedUser:a("Mutation")("addDebugSuggestedUser"),joinDebugCallFromIntent:a("Mutation")("joinDebugCallFromIntent"),createDebugCallingIntent:a("Mutation")("createDebugCallingIntent"),createDebugConversation:a("Mutation")("createDebugConversation"),updateDebugCall:a("Mutation")("updateDebugCall"),stopDebugCall:a("Mutation")("stopDebugCall"),stopSpotlightSelfDebugCall:a("Mutation")("stopSpotlightSelfDebugCall"),updateDebugMeetingRoomRemoteSelectedLayoutChanged:a("Mutation")("updateDebugMeetingRoomRemoteSelectedLayoutChanged"),updateDebugSwapScreensButtonState:a("Mutation")("updateDebugSwapScreensButtonState"),toggleHoldDebugCall:a("Mutation")("toggleHoldDebugCall"),addDebugParticipant:a("Mutation")("addDebugParticipant"),createDebugParticipants:a("Mutation")("createDebugParticipants"),toggleDebugLocalMute:a("Mutation")("toggleDebugLocalMute"),startDebugRecording:a("Mutation")("startDebugRecording"),stopDebugRecording:a("Mutation")("stopDebugRecording"),setCallTranscriptStateDebug:a("Mutation")("setCallTranscriptStateDebug"),sendCallTranscriptEntryEventDebug:a("Mutation")("sendCallTranscriptEntryEventDebug"),sendClosedCaptionsEntryEventDebug:a("Mutation")("sendClosedCaptionsEntryEventDebug"),sendClosedCaptionsStatusEventDebug:a("Mutation")("sendClosedCaptionsStatusEventDebug"),setDebugClosedCaptionsEvent:a("Mutation")("setDebugClosedCaptionsEvent"),removeDebugParticipant:a("Mutation")("removeDebugParticipant"),toggleDebugVideo:a("Mutation")("toggleDebugVideo"),toggleDebugScreenShare:a("Mutation")("toggleDebugScreenShare"),updateDebugParticipant:a("Mutation")("updateDebugParticipant"),updateDebugPinParticipantFromOutside:a("Mutation")("updateDebugPinParticipantFromOutside"),updateDebugCortanaToggleButton:a("Mutation")("updateDebugCortanaToggleButton"),updateDebugContentCameraSharing:a("Mutation")("updateDebugContentCameraSharing"),toggleDebugMuteSpeaker:a("Mutation")("toggleDebugMuteSpeaker"),updateDebugContentCameraState:a("Mutation")("updateDebugContentCameraState"),triggerDebugCallingScreenGalleryTypeChange:a("Mutation")("triggerDebugCallingScreenGalleryTypeChange"),toggleVoiceLevel:a("Mutation")("toggleVoiceLevel"),setDebugDevicesList:a("Mutation")("setDebugDevicesList"),setDebugCallingQualityFeedback:a("Mutation")("setDebugCallingQualityFeedback"),setAnonymousDisplayName:a("Mutation")("setAnonymousDisplayName"),setPrejoinState:a("Mutation")("setPrejoinState"),triggerSubscribedCallChangedDebugEvent:a("Mutation")("triggerSubscribedCallChangedDebugEvent"),updateMeetingBrandingInfoCache:a("Mutation")("updateMeetingBrandingInfoCache"),setAcceptStreamPermissionsDebugResponse:a("Mutation")("setAcceptStreamPermissionsDebugResponse"),setStreamPermissionsDebugAcknowledged:a("Mutation")("setStreamPermissionsDebugAcknowledged"),setStreamPermissionsDebugAcknowledgedRequired:a("Mutation")("setStreamPermissionsDebugAcknowledgedRequired"),setCallingScreenStatus:a("Mutation")("setCallingScreenStatus"),setCallingScreenLayout:a("Mutation")("setCallingScreenLayout"),setIsCallingScreenReady:a("Mutation")("setIsCallingScreenReady"),setPinnedParticipantIds:a("Mutation")("setPinnedParticipantIds"),setVideoScanType:a("Mutation")("setVideoScanType"),updateCaptionFontSize:a("Mutation")("updateCaptionFontSize"),setDebugDeviceBlurringCapability:a("Mutation")("setDebugDeviceBlurringCapability"),setDebugVideoBackgroundImages:a("Mutation")("setDebugVideoBackgroundImages"),triggerBluetoothStateChangedDebugEvent:a("Mutation")("triggerBluetoothStateChangedDebugEvent"),triggerRaiseHandStateChangedEvent:a("Mutation")("triggerRaiseHandStateChangedEvent"),toggleDebugVideoEffect:a("Mutation")("toggleDebugVideoEffect"),updateMeetingLockDebug:a("Mutation")("updateMeetingLockDebug"),updateSelectedBackgroundsInfo:a("Mutation")("updateSelectedBackgroundsInfo"),setShouldReloadVideoApp:a("Mutation")("setShouldReloadVideoApp"),setShouldShowVideoApp:a("Mutation")("setShouldShowVideoApp"),setShouldShowVideoEffectsPreview:a("Mutation")("setShouldShowVideoEffectsPreview"),setShouldKeepPreviewWindowInSidePanelOpen:a("Mutation")("setShouldKeepPreviewWindowInSidePanelOpen"),setVideoAppPostMessageEvent:a("Mutation")("setVideoAppPostMessageEvent"),setAvatarAppPostMessageEvent:a("Mutation")("setAvatarAppPostMessageEvent"),setVideoNotification:a("Mutation")("setVideoNotification"),setAvatarErrorNotification:a("Mutation")("setAvatarErrorNotification"),setAvatarQuickPickerErrorNotification:a("Mutation")("setAvatarQuickPickerErrorNotification"),setShouldSetAvatarRendererTimeout:a("Mutation")("setShouldSetAvatarRendererTimeout"),setShouldRefreshAvatarApp:a("Mutation")("setShouldRefreshAvatarApp"),setShouldRefreshVideoFilters:a("Mutation")("setShouldRefreshVideoFilters"),toggleParticipantPin:a("Mutation")("toggleParticipantPin"),setScaling:a("Mutation")("setScaling"),scalingModeUpdated:a("Mutation")("scalingModeUpdated"),updateAvatarInfo:a("Mutation")("updateAvatarInfo"),updateSelectedAvatarInfo:a("Mutation")("updateSelectedAvatarInfo"),setLastSelectedCameraId:a("Mutation")("setLastSelectedCameraId"),setIsAvatarAppLoaded:a("Mutation")("setIsAvatarAppLoaded"),updateActiveVideoEffects:a("Mutation")("updateActiveVideoEffects"),updateVideoEffectsCurrentInfo:a("Mutation")("updateVideoEffectsCurrentInfo"),meetingDebugGoLive:a("Mutation")("meetingDebugGoLive"),setDebugStageRoomOutcome:a("Mutation")("setDebugStageRoomOutcome"),setShouldShowPopupPreview:a("Mutation")("setShouldShowPopupPreview"),setShouldAvatarMenuItemSelected:a("Mutation")("setShouldAvatarMenuItemSelected"),updateCallingState:a("Mutation")("updateCallingState"),setCompositorRegion:a("Mutation")("setCompositorRegion"),removeCompositorRegion:a("Mutation")("removeCompositorRegion"),setAvatarAppAvailabilityInfo:a("Mutation")("setAvatarAppAvailabilityInfo"),setIsAvatarMRULoaded:a("Mutation")("setIsAvatarMRULoaded"),setMeetingCollab:a("Mutation")("setMeetingCollab"),toggleMeetingCollab:a("Mutation")("toggleMeetingCollab"),stopSharingTriggeredOnStage:a("Mutation")("stopSharingTriggeredOnStage"),setImmersiveViewModeAppAvailabilityInfo:a("Mutation")("setImmersiveViewModeAppAvailabilityInfo")}}}(e),hj,KL,uj(e),UU,IM,PP.D,LP.w,xP,HO,UP.s,fj.s,Sj.s,Cj,yj.w,bj.w,_j.s)}(e),Tj._clientResolvers}static get clientResolvers(){return Tj._clientResolvers}}Tj._clientResolvers=null;class Ij extends mM{constructor(e,t,n,i,a){var o;super(e,t,n({windowId:i.windowId,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:`mtma-user-${(null===(o=null==i?void 0:i.authenticationUser)||void 0===o?void 0:o.id)||"nouser"}-${i.windowId}`,storeType:a}),i,i.windowId,a)}get parentQueries(){return xx}get parentSubscriptions(){return Lx}get parentMutations(){return Ox}get className(){return"MTMAWindowDataClient"}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}clone(e){throw new Error("Trying to clone child instance")}}class Ej extends dM{constructor(e,t,n,i){super(e,n,t({windowId:n.windowId||he.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"mtma-core",storeType:Kx.t.mtmaCore}),n.windowId||he.ew,Kx.t.mtmaCore),this.createApolloClient=t,this.viewSchemaClient=null,i&&(this.viewSchemaClient=i({windowId:n.windowId||he.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"core-viewSchema",storeType:Kx.t.viewSchema}),this.registerClient(this.viewSchemaClient))}clone(e){return e.windowId===he.ew?new pM(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType):new Ij(this.getServices(),this,this.createApolloClient,Object.assign(Object.assign({},this.ctx),e),Kx.t.mtmaWindow)}cloneForViewSchema(e){return hM(this.viewSchemaClient,"View schema must be avaliable"),new vM(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),Kx.t.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class Nj extends mM{constructor(e,t,n,i,a){var o;super(e,t,n({windowId:i.windowId||he.ew,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:`mtma-user-${(null===(o=null==i?void 0:i.authenticationUser)||void 0===o?void 0:o.id)||"nouser"}-${i.windowId}`,storeType:Kx.t.mtmaUser}),i,i.windowId||he.ew,Kx.t.mtmaUser),this.createApolloClient=n,this.viewSchemaClient=null,a&&(this.viewSchemaClient=a({windowId:i.windowId||he.ew,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:"core-viewSchema",storeType:Kx.t.viewSchema}),this.registerClient(this.viewSchemaClient))}get parentQueries(){return Rx}get parentSubscriptions(){return Px}get parentMutations(){return Mx}get className(){return"MTMAUserDataClient"}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}clone(e){return new Ij(this.getServices(),this,this.createApolloClient,Object.assign(Object.assign({},this.ctx),e),Kx.t.mtmaWindow)}cloneForViewSchema(e){return hM(this.viewSchemaClient,"View schema must be available"),new vM(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),Kx.t.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class Aj{constructor(){this._cache=new Map,this.getOrCreateServiceInstance=(e,t)=>{let n;return this._cache.has(e)?n=this._cache.get(e):(n=t(),this._cache.set(e,n)),n},this.clear=()=>{this._cache.clear()}}}const Fj=new Aj,Dj=Fj.getOrCreateServiceInstance;var Rj,xj;!function(e){e.AddressService="AddressService",e.AiInsightsFeedbackService="AiInsightsFeedbackService",e.AiInsightsSdsService="AiInsightsSdsService",e.AppBasedLinkService="AppBasedLinkService",e.AppsPlatformService="AppsPlatformService",e.AppSuggestionsService="AppSuggestionsService",e.AsyncMediaService="AsyncMediaService",e.AtpSafelinksService="AtpSafelinksService",e.AugloopService="AugloopService",e.AzureMapsService="AzureMapsService",e.BadgeCountService="BadgeCountService",e.BiometricEnrollmentService="BiometricEnrollmentService",e.BiometricFaceEnrollmentService="BiometricFaceEnrollmentService",e.BotsPlatformService="BotsPlatformService",e.BrbService="BrbService",e.BreakoutRoomMiddleTierService="BreakoutRoomMiddleTierService",e.BroadcastAttendeeService="BroadcastAttendeeService",e.BroadcastCaptionsService="BroadcastCaptionsService",e.BroadcastSignalRService="BroadcastSignalRService",e.BroadcastStreamingAttendeeService="BroadcastStreamingAttendeeService",e.CalendarService="CalendarService",e.CallBlockingService="CallBlockingService",e.CallingAnonymousDisplayNameService="CallingAnonymousDisplayNameService",e.CallingAppEventsService="CallingAppEventsService",e.CallingBannerServiceAdapter="CallingBannerServiceAdapter",e.CallingDialogServiceAdapter="CallingDialogServiceAdapter",e.CallingNotificationServiceAdapter="CallingNotificationServiceAdapter",e.CallingService="CallingService",e.CallRecordingService="CallRecordingService",e.ChatService="ChatService",e.ChatServiceEndpointProvider="ChatServiceEndpointProvider",e.CloudStorageFoldersService="CloudStorageFoldersService",e.CmdMeetingIntelligenceService="CmdMeetingIntelligenceService",e.CollabCloudService="CollabCloudService",e.CollabObjectService="CollabObjectService",e.CommonSubstrateService="CommonSubstrateService",e.CommunitySettingsService="CommunitySettingsService",e.ConnectedAccountsService="ConnectedAccountsService",e.ConnectedCalendarSettingsService="ConnectedCalendarSettingsService",e.ConsumerGroupsService="ConsumerGroupsService",e.CSAService="CSAService",e.DeveloperSwitchersService="DeveloperSwitchersService",e.DiscoverSurfaceFeedbackService="DiscoverSurfaceFeedbackService",e.DiscoverSurfaceService="DiscoverSurfaceService",e.DistributionListService="DistributionListService",e.DriveItemShareService="DriveItemShareService",e.DynamicsMarketingService="DynamicsMarketingService",e.DynamicsVirtualEventsService="DynamicsVirtualEventsService",e.EmoticonService="EmoticonService",e.EspService="EspService",e.ExampleService="ExampleService",e.ExternalAccountsResponseService="ExternalAccountsResponseService",e.ExternalAccountsService="ExternalAccountsService",e.ExternalCalendarEmailAddressService="ExternalCalendarEmailAddressService",e.FileDownloadManagerService="FileDownloadManagerService",e.FilesBackfillThreadPropertiesService="FilesBackfillThreadPropertiesService",e.FilesRedeemService="FilesRedeemService",e.FilesReferenceService="FilesReferenceService",e.FilesSharepointUrlService="FilesSharepointUrlService",e.FilesValidDomainsService="FilesValidDomainsService",e.FileUploadPreviewService="FileUploadPreviewService",e.FileUploadService="FileUploadService",e.FloodgateService="FloodgateService",e.FluidService="FluidService",e.GalleryService="GalleryService",e.GiphyService="GiphyService",e.GoogleCalendarAuthenticationService="GoogleCalendarAuthenticationService",e.GoogleContactsAuthenticationService="GoogleContactsAuthenticationService",e.GuardiansService="GuardiansService",e.ImageProxyService="ImageProxyService",e.ImmersiveReaderService="ImmersiveReaderService",e.ImplicitContactsService="ImplicitContactsService",e.ImportMsaContactsService="ImportMsaContactsService",e.InstantAnswersService="InstantAnswersService",e.InviteLinksService="InviteLinksService",e.ItemDeleteService="ItemDeleteService",e.ItemDetailsService="ItemDetailsService",e.ItemUploadService="ItemUploadService",e.LiveStateBroadcastService="LiveStateBroadcastService",e.LiveStreamRenderingService="LiveStreamRenderingService",e.LmsIntegrationService="LmsIntegrationService",e.LockedTeamsService="LockedTeamsService",e.LogsFilesService="LogsFilesService",e.LokiMetaPreviewService="LokiMetaPreviewService",e.LokiService="LokiService",e.ManageTenantService="ManageTenantService",e.MeetForWorkService="MeetForWorkService",e.MeetingArtifactsService="MeetingArtifactsService",e.MeetingBotService="MeetingBotService",e.MeetingCatchupService="MeetingCatchupService",e.MeetingIntelligenceService="MeetingIntelligenceService",e.MeetingOptionsClientDataService="MeetingOptionsClientDataService",e.MeetingOptionsService="MeetingOptionsService",e.MeetingQuestionsAndAnswersService="MeetingQuestionsAndAnswersService",e.MeetingRecapService="MeetingRecapService",e.MeetingRecapSwaService="MeetingRecapSwaService",e.MeetingTemplateService="MeetingTemplateService",e.MonetizationService="MonetizationService",e.MRUItemService="MRUItemService",e.MsaAuthenticationService="MsaAuthenticationService",e.OdcFilePreviewService="OdcFilePreviewService",e.OdsService="OdcService",e.OSearchService="OSearchService",e.PaymentsService="PaymentsService",e.PeoplePickerService="PeoplePickerService",e.PeopleSearchService="PeopleSearchService",e.PeopleService="PeopleService",e.PeopleTargetingService="PeopleTargetingService",e.PersonalFileDetailsService="PersonalFileDetailsService",e.PetrolService="PetrolService",e.PoliciesService="PoliciesService",e.PresenceService="PresenceService",e.PstnService="PstnService",e.RefreshSiteUrlService="RefreshSiteUrlService",e.ReportConcernService="ReportConcernService",e.SCISService="SCISService",e.SearchPrefetchService="SearchPrefetchService",e.SensitivityLabelPolicySettingsService="SensitivityLabelPolicySettingsService",e.SharepointRestClient="SharepointRestClient",e.SharepointShareService="SharepointShareService",e.ShareService="ShareService",e.SignalsService="SignalsService",e.SmbUserIntentService="SmbUserIntentService",e.StatefulLongPoll="StatefulLongPoll",e.StoreDevicesService="StoreDevicesService",e.StoreService="StoreService",e.StyleMyRoomService="StyleMyRoomService",e.SubstrateFilesSearchService="SubstrateFilesSearchService",e.SubstrateMeetingRecommendationsService="SubstrateMeetingRecommendationsService",e.SubstrateMeetingSearchService="SubstrateMeetingSearchService",e.SubstrateMeetingSummarySearchService="SubstrateMeetingSummarySearchService",e.SubstrateRecommendationsService="SubstrateRecommendationsService",e.SubstrateSearchService="SubstrateSearchService",e.SubstrateSuggestionsService="SubstrateSuggestionsService",e.TargetingHierarchyService="TargetingHierarchyService",e.TeamCalendarService="TeamCalendarService",e.TeamsAndChannelsService="TeamsAndChannelsService",e.TenantAnalyticsService="TenantAnalyticsService",e.TenantMembershipService="TenantMembershipService",e.TenantPrivacyProfileService="TenantPrivacyProfileService",e.TenantService="TenantService",e.TFLUserService="TFLUserService",e.ThirdPartyCalendarService="ThirdPartyCalendarService",e.ToastImageService="ToastImageService",e.TpnNoticeService="TpnNoticeService",e.TranscriptFeedbackService="TranscriptFeedbackService",e.TranscriptService="TranscriptService",e.TranscriptSettingsStoreService="TranscriptSettingsStoreService",e.TranslateService="TranslateService",e.UnifiedConsentService="UnifiedConsentService",e.UrlPreviewService="UrlPreviewService",e.UserLicenseService="UserLicenseService",e.UserProfileService="UserProfileService",e.VideoFileService="VideoFileService",e.VirtualEventsService="VirtualEventsService",e.VoicemailService="VoicemailService",e.WebinarService="WebinarService"}(Rj||(Rj={})),function(e){e.ExampleGlobalService="ExampleGlobalService",e.GlobalCallingService="GlobalCallingService",e.MTMAUserDataService="MTMAUserDataService",e.WebAppSwitcherService="WebAppSwitcherService"}(xj||(xj={}));const Mj=(e,t)=>n=>(0,c.mT)(e,t,n),Oj=()=>Promise.all([n.e(623025),n.e(579814),n.e(110350),n.e(967566),n.e(29311),n.e(700878),n.e(861064),n.e(194806),n.e(812946),n.e(816702)]).then(n.bind(n,949952)),Pj=Mj((()=>Promise.all([n.e(698627),n.e(585108)]).then(n.bind(n,164729))),"services-app-based-link"),Lj=Mj((()=>Promise.all([n.e(7263),n.e(805203)]).then(n.bind(n,669213))),"services-apps-platform"),Uj=Mj((()=>n.e(733885).then(n.bind(n,681614))),"services-app-suggestions"),jj=Mj((()=>n.e(591494).then(n.bind(n,773693))),"services-atp-safelinks"),$j=Mj((()=>Promise.all([n.e(788434),n.e(771401)]).then(n.bind(n,857247))),"services-async-media"),Bj=Mj((()=>Promise.all([n.e(100390),n.e(946573),n.e(165441)]).then(n.bind(n,667777))),"services-augloop"),Wj=Mj((()=>Promise.all([n.e(405954),n.e(553949),n.e(987927)]).then(n.bind(n,281388))),"services-azure-maps"),Hj=Mj((()=>Promise.all([n.e(313700),n.e(156255)]).then(n.bind(n,556223))),"services-biometric-enrollment"),Vj=Mj((()=>Promise.all([n.e(244627),n.e(820672)]).then(n.bind(n,811579))),"services-bots-platform"),zj=Mj((()=>n.e(340060).then(n.bind(n,274742))),"services-brb"),qj=Mj((()=>Promise.all([n.e(861064),n.e(911846)]).then(n.bind(n,842068))),"services-breakout-rooms"),Gj=Mj((()=>n.e(851710).then(n.bind(n,545267))),"services-transcript"),Jj=Mj((()=>n.e(819211).then(n.bind(n,614042))),"services-transcript-setting-store"),Qj=Mj((()=>n.e(851710).then(n.bind(n,545267))),"services-transcript-feedback"),Kj=Mj((()=>n.e(116205).then(n.bind(n,362593))),"services-ai-insights-feedback"),Yj=Mj((()=>n.e(116205).then(n.bind(n,362593))),"services-ai-insights-sds"),Xj=Mj((()=>n.e(512159).then(n.bind(n,667071))),"services-style-my-room"),Zj=Mj((()=>n.e(363685).then(n.bind(n,625849))),"services-broadcast-attendee"),e$=Mj((()=>n.e(620188).then(n.bind(n,731578))),"services-broadcast-streaming-attendee"),t$=Mj((()=>n.e(128560).then(n.bind(n,309290))),"services-broadcast-captions"),n$=Mj((()=>Promise.all([n.e(700878),n.e(12549)]).then(n.bind(n,556469))),"services-broadcast-signalr"),i$=Mj((()=>Promise.all([n.e(623025),n.e(579814),n.e(23e4),n.e(132244),n.e(993376)]).then(n.bind(n,196738))),"services-io-calendar"),a$=Mj((()=>n.e(634692).then(n.bind(n,723115))),"services-chat-endpoint-provider"),o$=Mj((()=>Promise.all([n.e(671326),n.e(69605),n.e(477209)]).then(n.bind(n,871246))),"services-chat"),r$=Mj((()=>n.e(976808).then(n.bind(n,219018))),"services-report-concern"),s$=(Mj((()=>Promise.all([n.e(698627),n.e(623025),n.e(579814),n.e(110350),n.e(967566),n.e(29311),n.e(700878),n.e(356078),n.e(861064),n.e(194806),n.e(175925)]).then(n.bind(n,796866))),"services-calling"),Mj((()=>n.e(293740).then(n.bind(n,966949))),"services-cmd-meeting-intelligence")),l$=Mj((()=>n.e(656737).then(n.bind(n,148863))),"services-collab-object"),c$=Mj((()=>n.e(741480).then(n.bind(n,493163))),"services-meeting-catchup"),d$=Mj((()=>n.e(458771).then(n.bind(n,276127))),"services-community-settings"),u$=Mj((()=>n.e(32034).then(n.bind(n,947018))),"services-connected-accounts"),m$=Mj((()=>n.e(900675).then(n.bind(n,121107))),"services-io-connected-calendar"),g$=Mj((()=>Promise.all([n.e(812302),n.e(384977)]).then(n.bind(n,637708))),"services-store-devices"),p$=Mj((()=>n.e(500923).then(n.bind(n,263965))),"services-distribution-list"),v$=Mj((()=>n.e(805794).then(n.bind(n,584898))),"services-dynamics-marketing"),h$=Mj((()=>n.e(106652).then(n.bind(n,157457))),"services-dynamics-virtual-events"),f$=Mj((()=>n.e(178832).then(n.bind(n,343832))),"services-emoticon"),y$=Mj((()=>n.e(421174).then(n.bind(n,365364))),"services-esp"),b$=Mj((()=>n.e(469081).then(n.bind(n,616850))),"services-external-accounts"),S$=Mj((()=>n.e(235430).then(n.bind(n,235408))),"services-external-accounts-response"),k$=Mj((()=>n.e(579197).then(n.bind(n,784554))),"services-external-calendar-email-address"),w$=Mj((()=>n.e(203137).then(n.bind(n,796051))),"services-files"),C$=Mj((()=>n.e(622121).then(n.bind(n,972149))),"services-file-upload"),_$=Mj((()=>n.e(302653).then(n.bind(n,992287))),"services-file-download-manager"),T$=Mj((()=>n.e(251425).then(n.bind(n,673606))),"services-fluid"),I$=Mj((()=>n.e(273806).then(n.bind(n,822314))),"services-giphy"),E$=Mj((()=>n.e(194248).then(n.bind(n,487997))),"services-gallery"),N$=Mj((()=>n.e(183483).then(n.bind(n,722976))),"services-google-calendar-authentication"),A$=Mj((()=>n.e(183483).then(n.bind(n,722976))),"services-google-contacts-authentication"),F$=Mj((()=>n.e(787480).then(n.bind(n,844368))),"services-image-proxy"),D$=Mj((()=>n.e(142705).then(n.bind(n,660352))),"immersive-reader-service"),R$=Mj((()=>n.e(670972).then(n.bind(n,471993))),"services-import-msa-contacts"),x$=Mj((()=>n.e(517965).then(n.bind(n,396199))),"services-instant-answers"),M$=Mj((()=>n.e(723088).then(n.bind(n,512271))),"services-invite-links"),O$=Mj((()=>Promise.all([n.e(28469),n.e(870715),n.e(678173),n.e(96978)]).then(n.bind(n,498294))),"services-live-state-broadcast"),P$=Mj((()=>Promise.all([n.e(328911),n.e(834117),n.e(699813),n.e(814408)]).then(n.bind(n,773310))),"services-live-stream-renderer"),L$=Mj((()=>n.e(322581).then(n.bind(n,672702))),"services-lms-integration"),U$=Mj((()=>n.e(288475).then(n.bind(n,201908))),"services-tenant-analytics"),j$=Mj((()=>n.e(989829).then(n.bind(n,699219))),"services-loki"),$$=Mj((()=>n.e(926934).then(n.bind(n,155478))),"services-discover-surface"),B$=Mj((()=>n.e(254964).then(n.bind(n,809430))),"services-discover-surface-feedback"),W$=Mj((()=>n.e(103998).then(n.bind(n,526606))),"services-guardians"),H$=Mj((()=>n.e(251074).then(n.bind(n,129193))),"services-locked-teams"),V$=Mj((()=>n.e(188975).then(n.bind(n,387117))),"services-logs-files"),z$=Mj((()=>n.e(202066).then(n.bind(n,478122))),"services-manage-tenant"),q$=Mj((()=>Promise.all([n.e(623025),n.e(579814),n.e(967566),n.e(470366),n.e(733689),n.e(861440)]).then(n.bind(n,989263))),"services-meet-for-work"),G$=Mj((()=>n.e(345626).then(n.bind(n,641844))),"services-meeting-artifacts"),J$=Mj((()=>n.e(694945).then(n.bind(n,809951))),"services-meeting-intelligence"),Q$=Mj((()=>Promise.all([n.e(761865),n.e(924251)]).then(n.bind(n,693880))),"services-meeting-recap"),K$=Mj((()=>n.e(820516).then(n.bind(n,835101))),"services-meeting-options"),Y$=Mj((()=>n.e(649880).then(n.bind(n,672769))),"services-meeting-recap-swa"),X$=Mj((()=>n.e(88137).then(n.bind(n,263424))),"services-meeting-templates"),Z$=Mj((()=>n.e(950104).then(n.bind(n,4209))),"services-msa-authentication"),eB=Mj((()=>Promise.all([n.e(203831),n.e(716151)]).then(n.bind(n,884875))),"services-people"),tB=(Mj((()=>n.e(37342).then(n.bind(n,845201))),"services-viva-insights"),Mj((()=>n.e(716313).then(n.bind(n,808774))),"services-people-picker")),nB=Mj((()=>Promise.all([n.e(794033),n.e(454165)]).then(n.bind(n,474801))),"services-people-targeting"),iB=Mj((()=>n.e(350718).then(n.bind(n,172355))),"services-files-personal"),aB=Mj((()=>n.e(214988).then(n.bind(n,87396))),"services-example"),oB=Mj((()=>n.e(342461).then(n.bind(n,187030))),"services-petrol"),rB=Mj((()=>Promise.all([n.e(210199),n.e(794166)]).then(n.bind(n,584649))),"services-floodgate"),sB=Mj((()=>n.e(343607).then(n.bind(n,189872))),"services-ods"),lB=Mj((()=>n.e(304609).then(n.bind(n,688753))),"services-policies"),cB=Mj((()=>n.e(676130).then(n.bind(n,329387))),"services-presence"),dB=Mj((()=>Promise.all([n.e(623025),n.e(579814),n.e(23363)]).then(n.bind(n,19374))),"scis-service"),uB=Mj((()=>Promise.all([n.e(623025),n.e(579814),n.e(822359),n.e(491645),n.e(79506)]).then(n.bind(n,875128))),"services-search"),mB=Mj((()=>Promise.all([n.e(633492),n.e(172842)]).then(n.bind(n,855304))),"services-search-meeting-summary"),gB=Mj((()=>n.e(419161).then(n.bind(n,543389))),"search-substrate"),pB=Mj((()=>n.e(902078).then(n.bind(n,7073))),"services-substrate-meeting-recommendations"),vB=Mj((()=>n.e(501129).then(n.bind(n,196356))),"services-substrate-recommendations"),hB=Mj((()=>n.e(899164).then(n.bind(n,385114))),"services-sharepoint-client"),fB=Mj((()=>n.e(130288).then(n.bind(n,107578))),"services-sharepoint-share"),yB=Mj((()=>n.e(215793).then(n.bind(n,585132))),"services-share"),bB=Mj((()=>n.e(792876).then(n.bind(n,260136))),"services-signals"),SB=Mj((()=>n.e(463473).then(n.bind(n,79440))),"services-smb-user-intent"),kB=Mj((()=>Promise.all([n.e(523537),n.e(812302),n.e(659098)]).then(n.bind(n,901282))),"services-store"),wB=Mj((()=>Promise.all([n.e(822359),n.e(156926),n.e(538431)]).then(n.bind(n,80229))),"services-suggestions"),CB=Mj((()=>Promise.all([n.e(822359),n.e(734949)]).then(n.bind(n,321875))),"services-implicit-contacts"),_B=Mj((()=>n.e(74801).then(n.bind(n,911713))),"services-targeting-hierarchy"),TB=Mj((()=>n.e(362437).then(n.bind(n,409696))),"services-tenant-membership"),IB=Mj((()=>n.e(172557).then(n.bind(n,207420))),"services-tenant-service"),EB=Mj((()=>n.e(277412).then(n.bind(n,806101))),"services-third-party-calendar"),NB=Mj((()=>n.e(254692).then(n.bind(n,536748))),"services-toast-image"),AB=(Mj((()=>n.e(751309).then(n.bind(n,812060))),"services-teams-and-channels"),Mj((()=>n.e(16014).then(n.bind(n,61183))),"services-translate")),FB=Mj((()=>n.e(606408).then(n.bind(n,374368))),"services-tpn-notice"),DB=Mj((()=>n.e(439613).then(n.bind(n,349674))),"unified-consent-state"),RB=Mj((()=>Promise.all([n.e(698627),n.e(114826)]).then(n.bind(n,62996))),"services-url-preview"),xB=Mj((()=>n.e(613549).then(n.bind(n,435154))),"services-user-profile"),MB=Mj((()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(259196),n.e(86052),n.e(302711),n.e(636762),n.e(499057),n.e(603286),n.e(836870),n.e(213104),n.e(384420),n.e(49750),n.e(181896),n.e(95235),n.e(803466),n.e(623025),n.e(579814),n.e(418676),n.e(730588),n.e(101243),n.e(603612),n.e(998947),n.e(929389),n.e(61627),n.e(4528),n.e(191280),n.e(86048),n.e(29311),n.e(481321),n.e(384848),n.e(674818),n.e(397914),n.e(860125),n.e(628212),n.e(501749),n.e(41547),n.e(991883),n.e(602460),n.e(902140),n.e(908331),n.e(9886),n.e(491448),n.e(398949),n.e(797371),n.e(463911),n.e(209103),n.e(141221),n.e(145679),n.e(11495),n.e(645508),n.e(317689),n.e(842905),n.e(196673),n.e(648558),n.e(764175),n.e(968634),n.e(530658),n.e(926721),n.e(905697),n.e(707902),n.e(858141),n.e(568740)]).then(n.bind(n,80525))),"services-voicemail"),OB=Mj((()=>n.e(948693).then(n.bind(n,587651))),"services-item-crud"),PB=Mj((()=>n.e(551792).then(n.bind(n,413992))),"services-webinar"),LB=Mj((()=>Promise.all([n.e(623025),n.e(579814),n.e(733689),n.e(178815)]).then(n.bind(n,617855))),"services-meeting-bot"),UB=Mj((()=>n.e(729961).then(n.bind(n,464347))),"services-virtual-events"),jB=Mj((()=>n.e(223935).then(n.bind(n,919681))),"services-developer-switchers"),$B=Mj((()=>n.e(478053).then(n.bind(n,242654))),"services-search-prefetch"),BB=Mj((()=>n.e(684615).then(n.bind(n,923109))),"services-call-recording"),WB=Mj((()=>n.e(59616).then(n.bind(n,136402))),"services-user-license"),HB=Mj((()=>n.e(376049).then(n.bind(n,169817))),"services-payment"),VB=Mj((()=>n.e(417341).then(n.bind(n,573642))),"services-monetization"),zB=Mj((()=>n.e(57264).then(n.bind(n,813143))),"services-mru"),qB=Mj((()=>n.e(701035).then(n.bind(n,223052))),"services-collab-cloud"),GB=Mj((()=>n.e(655402).then(n.bind(n,544497))),"tfl-user-service"),JB=Mj((()=>n.e(172042).then(n.bind(n,15469))),"services-sensitivity-label-policy-settings"),QB=Mj((()=>n.e(883548).then(n.bind(n,26071))),"services-meeting-questions-and-answers"),KB=Mj((()=>n.e(864438).then(n.bind(n,628213))),"services-io-web-app-switcher"),YB=Mj((()=>n.e(145332).then(n.bind(n,44964))),"services-io-mtma-user-data"),XB=e=>()=>e.userServicesCache(Rj.AsyncMediaService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,gtmRegistry:n,discover:i,coreSettings:a,loggerFactory:o,scenarioFactory:r,endpointsManager:s}=e,{AsyncMediaService:l}=yield $j(r);return new l(t,n,i,a,o,s,r)})))(e))),ZB=e=>()=>e.userServicesCache(Rj.SharepointRestClient,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,scenarioFactory:i}=e,{SharepointRestClient:a}=yield hB(i);return new a(t,n)})))(e))),eW=(e,t)=>()=>e.userServicesCache(Rj.BotsPlatformService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:n,scenarioFactory:i,gtmRegistry:a,send:o,discover:r,platformService:s,i18n:l}=e,c=yield t(),{BotsPlatformService:d}=yield Vj(i);return new d(n,c,a.bind(o,vs.Pn.middleTier),r,i,s,l)})))(e,t))),tW=e=>()=>e.userServicesCache(Rj.ConnectedAccountsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,scenarioFactory:i,send:a,coreSettings:o,i18n:r}=e,{ConnectedAccountsService:s}=yield u$(i);return new s(t,n,i,o,a,r)})))(e))),nW=e=>()=>e.userServicesCache(Rj.GoogleCalendarAuthenticationService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,windowProvider:i,scenarioFactory:a,platformService:o}=e,{GoogleCalendarAuthenticationService:r}=yield N$(a);return new r(i,t,n,a,o)})))(e))),iW=e=>()=>e.userServicesCache(Rj.GoogleContactsAuthenticationService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,windowProvider:i,scenarioFactory:a,platformService:o}=e,{GoogleContactsAuthenticationService:r}=yield A$(a);return new r(i,t,n,a,o)})))(e))),aW=e=>()=>e.userServicesCache(Rj.MsaAuthenticationService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,windowProvider:i}=e,{MsaAuthenticationService:a}=yield Z$(n);return new a(t,n,i)})))(e))),oW=(e,t,n,a)=>()=>e.userServicesCache(Rj.ExternalAccountsService,(()=>((e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,localStorage:o,platformService:r,scenarioFactory:s}=e,l=yield t(),c=yield n(),d=yield a(),{ExternalAccountsService:u}=yield b$(s);return new u(i,l,c,d,s,r,o)})))(e,t,n,a))),rW=(e,t,n)=>()=>e.userServicesCache(Rj.ThirdPartyCalendarService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,scenarioFactory:a,authenticationService:o,localStorage:r}=e,s=yield t(),l=yield n(),{ThirdPartyCalendarService:c}=yield EB(a);return new c(i,o,s,l,a,r)})))(e,t,n)));var sW=n(895557);const lW=e=>()=>e.userServicesCache(Rj.CallingAppEventsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,windowProvider:i}=e,{ObservableFactory:a}=yield Oj(),o=new a;return new sW.n(t,o,n,i)})))(e)));var cW=n(292230);const dW=(e,t)=>()=>e.userServicesCache(Rj.CallingBannerServiceAdapter,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,i18n:i}=e,a=yield t();return new cW.Y(n,a,i)})))(e,t)));var uW=n(375833);const mW=(e,t)=>()=>e.userServicesCache(Rj.CallingDialogServiceAdapter,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i}=e,a=yield t();return new uW.l(n,i,a)})))(e,t)));var gW=n(156430),pW=n(203470);const vW=(e,t)=>()=>e.userServicesCache(Rj.CallingNotificationServiceAdapter,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,coreSettings:i,hostCommunicationService:a,platformService:o,scenarioFactory:r}=e,s=yield t(),l=new gW.V(n,r,o);return new pW.L(n,i,s,a,l)})))(e,t))),hW=e=>()=>e.userServicesCache(Rj.DiscoverSurfaceService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,endpointsManager:i}=e,{DiscoverSurfaceService:a}=yield $$(n);return new a(t,i,n)})))(e))),fW=e=>()=>e.userServicesCache(Rj.UserLicenseService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,endpointsManager:n,loggerFactory:i,scenarioFactory:a}=e,{UserLicenseService:o}=yield WB(a);return new o(t,n,i,a)})))(e))),yW=(e,t)=>()=>e.userServicesCache(Rj.SmbUserIntentService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:n,loggerFactory:i,scenarioFactory:a,localStorage:o,windowProvider:r}=e,s=yield t(),{SmbUserIntentService:l}=yield SB(a);return new l(i,n,o,s,r,a)})))(e,t))),bW=e=>()=>e.userServicesCache(Rj.TenantPrivacyProfileService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,authenticationService:n,coreSettings:i,scenarioFactory:a,endpointsManager:o,localStorage:r,discover:s}=e,{CallingIdentityAdapterService:l,ClientDatabaseService:c,AggregatedSettingsStoreService:d,ACSCallingAuthenticationServiceAdapter:u,CallingAuthenticationServiceAdapter:m,TenantPrivacyProfileService:g}=yield Oj(),p=new c(t,r),v=new d(t,i),h=yield n.getUser();return new g(t,n,new l(i.get(L.J.Calling).enableACSEmbed?new u(s,h,t):new m(n,s,h,t,i),v,t),i,p,a,o)})))(e))),SW=e=>()=>{var t;const{coreSettings:n}=e;if(!(null===(t=null==n?void 0:n.get(L.J.CMDMeetingArtifactsService))||void 0===t?void 0:t.enableCMDMeetingArtifactsService))throw new Error("FF enableCMDMeetingArtifactsService is disabled");return e.userServicesCache(Rj.CollabObjectService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,coreSettings:n,loggerFactory:i,endpointsManager:a,scenarioFactory:o,discover:r}=e,{CollabObjectService:s}=yield l$(o);return new s(t,n,i,a,r)})))(e)))},kW=e=>()=>e.userServicesCache(Rj.StoreDevicesService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,endpointsManager:i}=e,{StoreDevicesService:a}=yield g$(n);return new a(i,t)})))(e))),wW=e=>()=>e.userServicesCache(Rj.AiInsightsFeedbackService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,loggerFactory:i}=e,{AiInsightsFeedbackService:a}=yield Kj(t);return new a(n,i,t)})))(e))),CW=e=>()=>e.userServicesCache(Rj.AiInsightsSdsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,loggerFactory:i}=e,{AiInsightsSdsService:a}=yield Yj(t);return new a(n,i,t)})))(e))),_W=(e,t)=>()=>e.userServicesCache(Rj.AppBasedLinkService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,scenarioFactory:i,loggerFactory:a}=e,{AppBasedLinkService:o}=yield Pj(i);return new o(n,yield t(),i,a)})))(e,t))),TW=e=>()=>e.userServicesCache(Rj.AppsPlatformService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,coreSettings:n,endpointsManager:i,localStorage:a,authenticationService:o}=e,{enableMetaOsSdkIntegration:r}=n.get(L.J.Extensibility),{AppsPlatformService:s,AppsPlatformServiceMetaOS:l}=yield Lj(t);return r?new l(n,i,t,o):new s(n,i,a)})))(e))),IW=e=>()=>e.userServicesCache(Rj.AppSuggestionsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,coreSettings:i,loggerFactory:a,windowProvider:o}=e,{AppSuggestionsService:r}=yield Uj(t);return new r(i,n,a,o)})))(e))),EW=e=>()=>e.userServicesCache(Rj.AugloopService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,i18n:n,loggerFactory:i,scenarioFactory:a,windowProvider:o,coreSettings:r}=e,{enableAugLoopService:s,serviceUrl:l,resource:c}=r.get(L.J.Augloop),{enableComposeCopilot:d}=r.get(L.J.Compose),{AugloopService:u}=yield Bj(a),m=new u(t,o,i,n),g=d?{appName:"Word",appPlatform:"Web"}:void 0;return s&&l&&c&&(yield m.initialize(l,c,g)),m})))(e))),NW=e=>()=>e.userServicesCache(Rj.AzureMapsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,i18NextWrapper:n,scenarioFactory:i,coreSettings:a}=e,{AzureMapsService:o}=yield Wj(i);return new o(t,a,n)})))(e))),AW=e=>()=>e.userServicesCache(Rj.BadgeCountService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,config:n,discover:i,platformService:a,scenarioFactory:o}=e,{BadgeCountService:r}=yield o$(o);return new r(a,t,i,n)})))(e))),FW=e=>()=>e.userServicesCache(Rj.BrbService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,coreSettings:i,logsCollectorService:a,authenticationService:o,platformService:r,discover:s,windowProvider:l,hostCommunicationService:c,endpointsManager:d,authenticationUser:u,i18n:m}=e,{BrbService:g}=yield zj(t);return new g(n,i,a,o,r,s,l,c,d,t,m,u)})))(e))),DW=e=>()=>e.userServicesCache(Rj.BreakoutRoomMiddleTierService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{BreakoutRoomMiddleTierService:i}=yield qj(t);return new i(n)})))(e))),RW=e=>()=>e.userServicesCache(Rj.AtpSafelinksService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,localStorage:r,send:s}=e,{AtpSafelinksService:l}=yield jj(o);return new l(i.bind(s,vs.Pn.middleTier),t,n,o,a,r)})))(e))),xW=e=>()=>e.userServicesCache(Rj.BroadcastAttendeeService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,windowProvider:o}=e,{BroadcastAttendeeService:r}=yield Zj(a);return new r(t,i,a,o,n)})))(e))),MW=e=>()=>e.userServicesCache(Rj.BroadcastStreamingAttendeeService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{BroadcastStreamingAttendeeService:i}=yield e$(n);return new i(t)})))(e))),OW=e=>()=>e.userServicesCache(Rj.BroadcastCaptionsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,send:n,endpointsManager:i,scenarioFactory:a,windowProvider:o,loggerFactory:r}=e,{BroadcastCaptionsService:s}=yield t$(a);return new s(o,r,a,t,n,i)})))(e))),PW=e=>()=>e.userServicesCache(Rj.BroadcastSignalRService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,endpointsManager:i,windowProvider:a}=e,{BroadcastSignalRService:o}=yield n$(t);return new o(n,i,t,a)})))(e)));var LW=n(216594);const UW=(e,t)=>n=>{t({payload:n,pubsub:e})},jW=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,gtmRegistry:a,loggerFactory:o,pubsub:r,send:s,windowProvider:l}=e,{CallBlockingService:c}=yield n.e(667417).then(n.bind(n,34889));return new c(t,i,a.bind(s,vs.Pn.middleTier),o.newLogger("CallBlockingService","data-services-common"),l,UW(r,$W))})),$W=({payload:e,pubsub:t})=>{t.publish(LW.oo,e.newBlockedMris)};class BW{constructor(){this._displayName=null,this.getDisplayName=()=>this._displayName,this.setDisplayName=e=>{this._displayName=e}}}const WW=e=>()=>e.userServicesCache(Rj.CallingAnonymousDisplayNameService,(()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return new BW})))),HW=e=>()=>e.userServicesCache(Rj.CmdMeetingIntelligenceService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{CmdMeetingIntelligenceService:i}=yield s$(t);return new i(n)})))(e))),VW=e=>()=>{var t;const{coreSettings:n}=e;if(!(null===(t=null==n?void 0:n.get(L.J.MeetingCatchupService))||void 0===t?void 0:t.enableMeetingCatchupService))throw new Error("FF enableMeetingCatchupService is disabled");return e.userServicesCache(Rj.MeetingCatchupService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{MeetingCatchupService:i}=yield c$(n);return new i(t)})))(e)))},zW=e=>()=>e.userServicesCache(Rj.CommunitySettingsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{CommunitySettingsService:i}=yield d$(t);return new i(n)})))(e))),qW=e=>()=>e.userServicesCache(Rj.ConnectedCalendarSettingsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,scenarioFactory:n,endpointsManager:i}=e,{ConnectedCalendarSettingsService:a}=yield m$(n);return new a(n,t,i)})))(e))),GW=e=>()=>{const{coreSettings:t}=e,{enableCMDServiceForTokenRetriveAndVoiceSignatureStore:n}=t.get(L.J.BiometricEnrollment),{isCMDSvcEnabledForBiometricStorage:a}=t.get(L.J.Host);return n||a?e.userServicesCache(Rj.BiometricEnrollmentService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:n,coreSettings:i,loggerFactory:a,platformService:o,scenarioFactory:r,i18n:s}=e,{VoiceBiometricEnrollmentService:l}=yield Hj(r);return new l(t,n,i,a,o,s)})))(e))):e.userServicesCache(Rj.BiometricEnrollmentService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,loggerFactory:i,platformService:a,scenarioFactory:o,send:r,coreSettings:s,i18n:l}=e,{BiometricEnrollmentService:c}=yield Hj(o);return new c(t,n,i,a,r,s,l)})))(e)))},JW=e=>()=>e.userServicesCache(Rj.BiometricFaceEnrollmentService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:n,coreSettings:i,loggerFactory:a,platformService:o,scenarioFactory:r}=e,{BiometricFaceEnrollmentService:s}=yield Hj(r);return new s(t,n,i,a,o)})))(e))),QW=e=>()=>e.userServicesCache(Rj.DeveloperSwitchersService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,rebootService:n,windowProvider:i,loggerFactory:a,config:o}=e,{DeveloperSwitchersService:r}=yield jB(t);return new r(n,i,a.newLogger("DeveloperSwitchersService","data-services-common"),o)})))(e))),KW=e=>()=>e.userServicesCache(Rj.DistributionListService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,loggerFactory:i,coreSettings:a,scenarioFactory:o}=e,{DistributionListService:r}=yield p$(o);return new r(i,t.bind(n,vs.Pn.middleTier),a)})))(e))),YW=e=>()=>e.userServicesCache(Rj.DynamicsMarketingService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,send:i,scenarioFactory:a}=e,{DynamicsMarketingService:o}=yield v$(a);return new o(t,n,i)})))(e))),XW=e=>()=>e.userServicesCache(Rj.DynamicsVirtualEventsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,send:i,i18NextWrapper:a,scenarioFactory:o,loggerFactory:r,discover:s}=e,{DynamicsVirtualEventsService:l}=yield h$(o);return new l(t,n,i,a,r,s)})))(e))),ZW=(e,t)=>()=>e.userServicesCache(Rj.EmoticonService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,localStorage:i,scenarioFactory:a,coreSettings:o,i18n:r}=e,{EmoticonService:s}=yield f$(a),l=new s(yield t(),r.locale,i,o,n.newLogger("EmoticonService","data-services-common"),a,r);return yield l.isInitialized,l})))(e,t))),eH=e=>()=>e.userServicesCache(Rj.EspService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{EspService:i}=yield y$(n);return new i(t)})))(e))),tH=e=>()=>e.userServicesCache(Rj.ExampleService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{ExampleService:n}=yield aB(t);return new n})))(e))),nH=(e,t)=>()=>e.userServicesCache(Rj.ExternalAccountsResponseService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,scenarioFactory:i}=e,a=yield t(),{ExternalAccountsResponseService:o}=yield S$(i);return new o(n,a,i)})))(e,t))),iH=e=>()=>e.userServicesCache(Rj.FluidService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i}=e,{FluidService:a}=yield T$(i);return new a(t,n)})))(e))),aH=e=>()=>e.userServicesCache(Rj.GalleryService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,send:i,scenarioFactory:a}=e,{GalleryService:o}=yield E$(a);return new o(i,t,n,a)})))(e))),oH=e=>()=>e.userServicesCache(Rj.GiphyService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,gtmRegistry:n,endpointsManager:i,send:a,scenarioFactory:o,i18n:r}=e,{GiphyService:s}=yield I$(o);return new s(n.bind(a,vs.Pn.middleTier),t,r.locale,i)})))(e))),rH=e=>()=>e.userServicesCache(Rj.GuardiansService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a,loggerFactory:o,i18n:r}=e,{GuardiansService:s}=yield W$(a);return new s(t,o,n,i,r)})))(e))),sH=e=>()=>e.userServicesCache(Rj.ImageProxyService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,gtmRegistry:n,send:i,scenarioFactory:a}=e,{ImageProxyService:o}=yield F$(a);return new o(n,i,t)})))(e))),lH=e=>()=>e.userServicesCache(Rj.ImmersiveReaderService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{ImmersiveReaderService:i}=yield D$(n);return new i(t)})))(e))),cH=(e,t)=>()=>t.userServicesCache(Rj.ImportMsaContactsService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,endpointsManager:i,scenarioFactory:a}=t,{ImportMsaContactsService:o}=yield R$(a);return new o(yield e(),n,i,a)})))(e,t))),dH=e=>()=>e.userServicesCache(Rj.ImplicitContactsService,(()=>(({discover:e,gtmRegistry:t,send:n,scenarioFactory:a})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{ImplicitContactsService:i}=yield CB(a);return new i(n,e,t,a)})))(e))),uH=e=>()=>e.userServicesCache(Rj.InstantAnswersService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,send:n,scenarioFactory:i,loggerFactory:a,i18n:o}=e,{InstantAnswersService:r}=yield x$(i);return new r(a,i,t,n,o)})))(e))),mH=e=>()=>e.userServicesCache(Rj.InviteLinksService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{InviteLinksService:i}=yield M$(t);return new i(n)})))(e))),gH=e=>()=>e.userServicesCache(Rj.LiveStateBroadcastService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{pubsub:t,scenarioFactory:n,loggerFactory:i,coreSettings:a,authenticationService:o,platformService:r,discover:s}=e,{LiveStateBroadcastService:l}=yield O$(n);return new l(t,i,a,o,r,n,s)})))(e))),pH=e=>()=>e.userServicesCache(Rj.LiveStreamRenderingService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,discover:n,send:i,scenarioFactory:a,loggerFactory:o,pubsub:r,platformService:s,clientState:l,coreSettings:c,endpointsManager:d,networkState:u}=e,{LiveStreamRenderingService:m}=yield P$(a),{ACSCallingAuthenticationServiceAdapter:g,CallingAuthenticationServiceAdapter:p}=yield Oj(),v=yield t.getUser();return new m(o,c.get(L.J.Calling).enableACSEmbed?new g(n,v,o):new p(t,n,v,o,c),s,l,r,i,c,a,d,u)})))(e))),vH=e=>()=>e.userServicesCache(Rj.LmsIntegrationService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a}=e,{LmsIntegrationService:o}=yield L$(a);return new o(t,n,i)})))(e))),hH=e=>()=>e.userServicesCache(Rj.LockedTeamsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a}=e,{LockedTeamsService:o}=yield H$(a);return new o(t,n,i)})))(e))),fH=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,logsCollectorService:i,coreSettings:a}=e;let o,r;"entityCommanding"in e&&(o=e.entityCommanding),"i18n"in e&&(r=e.i18n);const{LogsFilesService:s}=yield V$(t);return new s(n,i,a,void 0,o,r)})),yH=e=>()=>e.userServicesCache(Rj.LogsFilesService,(()=>fH(e))),bH=e=>()=>e.userServicesCache(Rj.LokiService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,scenarioFactory:i,coreSettings:a,endpointsManager:o}=e,{LokiService:r}=yield j$(i);return new r(n,t,a,o)})))(e))),SH=e=>()=>e.userServicesCache(Rj.ManageTenantService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,endpointsManager:n,loggerFactory:i,scenarioFactory:a}=e,{ManageTenantService:o}=yield z$(a);return new o(t,i,a,n)})))(e))),kH=(e,t,n)=>()=>{const a=e.coreSettings.get(L.J.Meet);if(!a.enableMeetForWork||!a.enableNewUXToOldData)throw new Error("enableMeetForWork or enableNewUXToOldData flag is disabled");return e.userServicesCache(Rj.MeetForWorkService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,authenticationService:a,authenticationUser:o,loggerFactory:r,cmdApolloClient:s,coreSettings:l,pubsub:c,endpointsManager:d,i18n:u}=e,{MeetForWorkService:m}=yield q$(i),g=yield t(),{enableCMDMeetingArtifactsService:p}=l.get(L.J.CMDMeetingArtifactsService);return new m(a,g,p?yield n():void 0,s,o,i,l,c,r,d,u)})))(e,t,n)))},wH=e=>()=>e.userServicesCache(Rj.MeetingArtifactsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,coreSettings:i,scenarioFactory:a,i18n:o,loggerFactory:r}=e,{MeetingArtifactsService:s}=yield G$(a);return new s(n,t,i,o,r,a)})))(e))),CH=(e,t,n)=>()=>{var a;const{coreSettings:o}=e;if(!(null===(a=null==o?void 0:o.get(L.J.MeetingBot))||void 0===a?void 0:a.enableMeetingBot))throw new Error("enableMeetingBot flag is disabled");return e.userServicesCache(Rj.MeetingBotService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,cmdApolloClient:a,authenticationService:o,coreSettings:r,loggerFactory:s,localStorage:l,platformService:c,windowProvider:d,entityCommanding:u,i18n:m,authenticationUser:g}=e,{MeetingBotService:p}=yield LB(i);return new p(o,yield t(),r,yield n(),s,i,d,l,c,a,u,m,g)})))(e,t,n)))},_H=e=>()=>e.userServicesCache(Rj.MeetingIntelligenceService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{MeetingIntelligenceService:i}=yield J$(t);return new i(n)})))(e))),TH=e=>()=>e.userServicesCache(Rj.PeopleService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i,endpointsManager:a,coreSettings:o}=e,{PeopleService:r}=yield eB(i);return new r(t.bind(n,vs.Pn.middleTier),o,a)})))(e))),IH=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{windowProvider:t,coreSettings:i,scenarioFactory:a,loggerFactory:o}=e,{MeetingOptionsClientDataService:r}=yield n.e(820516).then(n.bind(n,276171)),s=TH(e);return new r(t,yield s(),i,a,o)})),EH=e=>()=>e.userServicesCache(Rj.MeetingOptionsClientDataService,(()=>IH(e))),NH=e=>()=>e.userServicesCache(Rj.MeetingOptionsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i,coreSettings:a,gtmRegistry:o,discover:r,loggerFactory:s}=e,{MeetingOptionsService:l}=yield K$(i);return new l(t,n,i,a,o,r,s)})))(e))),AH=e=>()=>e.userServicesCache(Rj.MeetingQuestionsAndAnswersService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,endpointsManager:i}=e,{MeetingQuestionsAndAnswersService:a}=yield QB(n);return new a(i,t,n)})))(e))),FH=e=>()=>e.userServicesCache(Rj.MeetingRecapService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{MeetingRecapService:i}=yield Q$(t);return new i(n)})))(e))),DH=e=>()=>e.userServicesCache(Rj.MeetingRecapSwaService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,scenarioFactory:n,authenticationService:i,loggerFactory:a}=e,o=a.newLogger("meeting-recap-swa-service","data-services-common"),{MeetingRecapSwaService:r}=yield Y$(n);return new r(i,t,o,a)})))(e))),RH=e=>()=>e.userServicesCache(Rj.MeetingTemplateService,(()=>(({scenarioFactory:e,send:t,authenticationService:n,coreSettings:a,discover:o,loggerFactory:r})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{MeetingTemplateService:i}=yield X$(e);return new i(t,n,a,e,o,r)})))(e))),xH=e=>()=>e.userServicesCache(Rj.PaymentsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,i18n:o,loggerFactory:r}=e,{PaymentService:s}=yield HB(t);return new s(n,i,a,r,t,o)})))(e)));var MH=n(283769);const OH=e=>()=>e.userServicesCache(Rj.PeoplePickerService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i,endpointsManager:a,coreSettings:o}=e,{PeoplePickerService:r}=yield tB(i);return new r((0,MH.Y)(t.bind(n,vs.Pn.middleTier),o,a))})))(e))),PH=e=>()=>e.userServicesCache(Rj.PeopleTargetingService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,loggerFactory:n,send:i,coreSettings:a,scenarioFactory:o,discover:r}=e,{PeopleTargetingService:s}=yield nB(o);return new s(t,n,i,a,r)})))(e))),LH=e=>()=>e.userServicesCache(Rj.PoliciesService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,endpointsManager:n,loggerFactory:i,networkState:a,scenarioFactory:o}=e,{PoliciesService:r}=yield lB(o);return new r(n,t,i,a,o)})))(e))),UH=e=>()=>e.userServicesCache(Rj.PresenceService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,pubsub:n,send:i,scenarioFactory:a,platformService:o,config:r}=e,{PresenceService:s}=yield cB(a);return new s(t.bind(i,vs.Pn.unifiedPresence),n,o,r)})))(e))),jH=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i,loggerFactory:a}=e,{AddressService:o}=yield n.e(821836).then(n.bind(n,839710));return new o(t.bind(i,vs.Pn.middleTier),a)})),$H=e=>()=>e.userServicesCache(Rj.AddressService,(()=>jH(e))),BH=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i}=e,{PstnService:a}=yield n.e(893393).then(n.bind(n,790877));return new a(t.bind(i,vs.Pn.middleTier))})),WH=e=>()=>e.userServicesCache(Rj.PstnService,(()=>BH(e))),HH=e=>()=>e.userServicesCache(Rj.SCISService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:n,platformService:i,scenarioFactory:a,loggerFactory:o}=e,{SCISService:r}=yield dB(a);return new r(t,n,i,a,o)})))(e))),VH=e=>()=>e.userServicesCache(Rj.SearchPrefetchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,authenticationService:i}=e,{SearchPrefetchService:a}=yield $B(t);return new a(i,n)})))(e))),zH=e=>()=>e.userServicesCache(Rj.ShareService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,gtmRegistry:i,scenarioFactory:a,send:o,i18n:r}=e,{ShareService:s}=yield yB(a);return new s(t,n,i,o,r)})))(e))),qH=(e,t)=>()=>e.userServicesCache(Rj.StoreService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,loggerFactory:i,gtmRegistry:a,localStorage:o,coreSettings:r,authenticationService:s,platformService:l,endpointsManager:c,windowProvider:d,i18n:u}=e,{StoreService:m}=yield kB(n);return new m(n,i,a,o,r,s,l,c,d,u,yield t())})))(e,t))),GH=e=>()=>e.userServicesCache(Rj.StyleMyRoomService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,i18n:n,scenarioFactory:i,endpointsManager:a}=e,{StyleMyRoomService:o}=yield Xj(i);return new o(t,a,n)})))(e))),JH=e=>()=>e.userServicesCache(Rj.TenantMembershipService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{TenantMembershipService:i}=yield TB(t);return new i(t,n)})))(e))),QH=e=>()=>e.userServicesCache(Rj.TenantService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{TenantService:i}=yield IB(t);return new i(t,n)})))(e))),KH=e=>()=>e.userServicesCache(Rj.TenantAnalyticsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n,loggerFactory:i}=e,{TenantAnalyticsService:a}=yield U$(n);return new a(i,t)})))(e))),YH=e=>()=>e.userServicesCache(Rj.TranscriptService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,coreSettings:i,loggerFactory:a}=e,{TranscriptService:o}=yield Gj(t);return new o(n,a,t,i)})))(e))),XH=e=>()=>e.userServicesCache(Rj.TranscriptFeedbackService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{TranscriptFeedbackService:n}=yield Qj(t);return new n})))(e))),ZH=e=>()=>e.userServicesCache(Rj.TranscriptSettingsStoreService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,endpointsManager:i,authenticationUser:a}=e,{SettingsStoreService:o}=yield Jj(n);return new o(t,n,i,a)})))(e))),eV=e=>()=>e.userServicesCache(Rj.TranslateService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,endpointsManager:n,coreSettings:i,scenarioFactory:a,send:o}=e,{TranslateService:r}=yield AB(a);return new r(t.bind(o,vs.Pn.middleTier),a,i,n)})))(e))),tV=e=>()=>e.userServicesCache(Rj.TargetingHierarchyService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,discover:i,loggerFactory:a,scenarioFactory:o,send:r}=e,{TargetingHierarchyService:s}=yield _B(o);return new s(t,a,r,n,i)})))(e))),nV=e=>()=>e.userServicesCache(Rj.ToastImageService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{ToastImageService:i}=yield NB(t);return new i(n)})))(e)));var iV=n(49109);const aV=e=>()=>e.userServicesCache(Rj.TeamsAndChannelsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t}=e;return new iV.K(t)})))(e))),oV=e=>()=>e.userServicesCache(Rj.TpnNoticeService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,platformService:n,scenarioFactory:i}=e,{TpnNoticeService:a}=yield FB(i);return new a(t,n)})))(e))),rV=(e,t)=>()=>e.userServicesCache(Rj.UrlPreviewService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:n,endpointsManager:i,send:a,coreSettings:o,scenarioFactory:r}=e,{UrlPreviewService:s}=yield RB(r);return new s(n,a,o,yield t(),i,r)})))(e,t))),sV=e=>()=>e.userServicesCache(Rj.UserProfileService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i,coreSettings:a}=e,{UserProfileService:o}=yield xB(i);return new o(n,t,a)})))(e))),lV=e=>()=>e.userServicesCache(Rj.VirtualEventsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r,endpointsManager:s}=e,{VirtualEventsService:l,MockVirtualEventsService:c}=yield UB(t),{enableIntegrationsTab:d,forceUseMockAPIs:u}=a.get(L.J.VirtualEvents);return u?new c:new l(n,i,a,o,r,d?s:void 0)})))(e)));var cV=n(967383);const dV=({payload:e,pubsub:t})=>{t.publish(cV.Gq,e)},uV=e=>()=>e.userServicesCache(Rj.VoicemailService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,pubsub:o,send:r,windowProvider:s}=e,{VoicemailService:l}=yield MB(a);return new l(t,n,r,i,s,UW(o,dV))})))(e))),mV=e=>()=>e.userServicesCache(Rj.WebinarService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,i18n:r,loggerFactory:s}=e,{WebinarService:l}=yield PB(t);return new l(n,i,a,s,t,r,o)})))(e))),gV=e=>()=>e.userServicesCache(Rj.CallRecordingService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,endpointsManager:i}=e,{CallRecordingService:a}=yield BB(t);return new a(n,i)})))(e))),pV=e=>()=>e.userServicesCache(Rj.MonetizationService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i,loggerFactory:a,discover:o,coreSettings:r,localStorage:s}=e,{MonetizationService:l}=yield VB(i);return new l(t,n,a,o,r,s)})))(e))),vV=e=>()=>e.userServicesCache(Rj.MRUItemService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i,coreSettings:a}=e,{MRUService:o}=yield zB(i);return new o(t,n,a)})))(e))),hV=(e,t)=>()=>e.userServicesCache(Rj.DiscoverSurfaceFeedbackService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,windowProvider:i}=e,{DiscoverSurfaceFeedbackService:a}=yield B$(n);return new a(yield t(),i)})))(e,t))),fV=e=>()=>{var t;const{coreSettings:n}=e;if(!(null===(t=null==n?void 0:n.get(L.J.Extensibility))||void 0===t?void 0:t.enableCollabCloudApis))throw new Error("enableCollabCloudApis flag is disabled");return e.userServicesCache(Rj.CollabCloudService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{CollabCloudService:i}=yield qB(t);return new i(n)})))(e)))},yV=e=>()=>e.userServicesCache(Rj.TFLUserService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,localStorage:i,loggerFactory:a}=e,{TFLUserService:o}=yield GB(t);return new o(a,i,n)})))(e))),bV=e=>()=>e.userServicesCache(Rj.SensitivityLabelPolicySettingsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,gtmRegistry:i,authenticationUser:a,scenarioFactory:o,send:r}=e,{SensitivityLabelPolicySettingsService:s}=yield JB(o);return new s(o,t,i,r,n,a)})))(e))),SV=(e,t,n)=>()=>e.userServicesCache(Rj.PetrolService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{platformService:i,authenticationService:a,coreSettings:o,send:r,scenarioFactory:s,loggerFactory:l,hostCommunicationService:c,i18n:d}=e,{PetrolService:u}=yield oB(s);return new u(a,s,l,i,o,r,yield t(),yield n(),c,d)})))(e,t,n))),kV=(e,t)=>()=>e.userServicesCache(Rj.FloodgateService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i,coreSettings:a,clientState:o,i18NextWrapper:r,windowProvider:s,platformService:l,authenticationUser:c}=e,d=yield t(),{FloodGateService:u}=yield rB(i);return new u(n,i,o,a,d,r,l,s,c)})))(e,t))),wV=(e,t,n)=>()=>e.userServicesCache(Rj.OdsService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:i,scenarioFactory:a,loggerFactory:o,endpointsManager:r,logsCollectorService:s,coreSettings:l,platformService:c,hostCommunicationService:d,i18n:u}=e,{OdsService:m}=yield sB(a);return new m(i,o,r,s,l,c,yield t(),d,yield n(),u)})))(e,t,n))),CV=e=>()=>e.userServicesCache(Rj.LokiMetaPreviewService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,scenarioFactory:a}=e,{LokiMetaPreviewService:o}=yield uB(a);return new o(n,t,i)})))(e))),_V=e=>()=>e.userServicesCache(Rj.OdcFilePreviewService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,scenarioFactory:a}=e,{OdcFilePreviewService:o}=yield uB(a);return new o(n,t,i)})))(e))),TV=e=>()=>e.userServicesCache(Rj.OSearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,discover:n,loggerFactory:i,scenarioFactory:a,coreSettings:o,endpointsManager:r}=e,{OSearchService:s}=yield uB(a);return new s(t,r,n,i,o)})))(e))),IV=e=>()=>e.userServicesCache(Rj.PeopleSearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,endpointsManager:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,discover:r,coreSettings:s}=e,{PeopleSearchService:l}=yield uB(o);return new l(i.bind(t,vs.Pn.middleTier),n,a,r,s)})))(e))),EV=e=>()=>e.userServicesCache(Rj.SubstrateFilesSearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,platformService:i,loggerFactory:a,scenarioFactory:o,i18n:r}=e,{SubstrateFilesSearchService:s}=yield uB(o);return new s(n,t,i,o,a,r)})))(e))),NV=e=>()=>e.userServicesCache(Rj.SubstrateRecommendationsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{SubstrateRecommendationsService:i}=yield vB(n);return new i(t)})))(e))),AV=e=>()=>e.userServicesCache(Rj.SubstrateSearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,platformService:a,scenarioFactory:o,windowProvider:r,coreSettings:s,endpointsManager:l,i18n:c}=e,{SubstrateSearchService:d}=yield uB(o);return new d(n,t,a,o,i,r,s,l,c)})))(e))),FV=e=>()=>e.userServicesCache(Rj.SubstrateSuggestionsService,(()=>(({authenticationService:e,endpointsManager:t,coreSettings:n,discover:a,gtmRegistry:o,send:r,scenarioFactory:s,platformService:l})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{SubstrateSuggestionsService:i}=yield wB(s);return new i(r,t,e,n,a,o,l)})))(e))),DV=e=>()=>e.userServicesCache(Rj.SubstrateMeetingSearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,platformService:a,scenarioFactory:o}=e,{SubstrateMeetingSearchService:r}=yield uB(o);return new r(n,t,a,o,i)})))(e))),RV=e=>()=>e.userServicesCache(Rj.SubstrateMeetingSummarySearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,loggerFactory:n,platformService:i,scenarioFactory:a,coreSettings:o,endpointsManager:r,i18n:s}=e,{SubstrateMeetingSummarySearchService:l}=yield mB(a);return new l(t,i,a,n,o,r,s)})))(e))),xV=e=>()=>e.userServicesCache(Rj.ChatService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,coreSettings:n,scenarioFactory:i}=e,{ChatService:a}=yield o$(i);return new a(n,t)})))(e))),MV=(e,t)=>()=>e.userServicesCache(Rj.ChatServiceEndpointProvider,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n}=e,i=yield t(),{ChatServiceEndpointProvider:a}=yield a$(n);return new a(i,n)})))(e,t))),OV=e=>()=>e.userServicesCache(Rj.ConsumerGroupsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,scenarioFactory:n,endpointsManager:i,loggerFactory:a}=e,{ConsumerGroupsService:o}=yield o$(n);return new o(i,a,n,t)})))(e))),PV=e=>()=>e.userServicesCache(Rj.CSAService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,coreSettings:i,scenarioFactory:a,endpointsManager:o}=e,{createCSAService:r}=yield o$(a);return r(t,n,i,o)})))(e))),LV=e=>()=>e.userServicesCache(Rj.StatefulLongPoll,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{StatefulLongPoll:n}=yield o$(t);return new n})))(e))),UV=e=>()=>e.userServicesCache(Rj.ReportConcernService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,gtmRegistry:i,platformService:a}=e,{ReportConcernService:o}=yield r$(t);return new o(i.bind(n,vs.Pn.middleTier),a)})))(e))),jV=(e,t)=>()=>e.userServicesCache(Rj.SharepointShareService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:n,coreSettings:i,loggerFactory:a,send:o,scenarioFactory:r}=e,{SharepointShareService:s}=yield fB(r);return new s(o,n,a,i,yield t())})))(e,t))),$V=(e,t)=>()=>e.userServicesCache(Rj.FilesRedeemService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:n,coreSettings:i,loggerFactory:a,send:o,scenarioFactory:r}=e,{FilesRedeemService:s}=yield fB(r);return new s(o,n,a,i,yield t())})))(e,t))),BV=(e,t,n)=>()=>n.userServicesCache(Rj.FilesSharepointUrlService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,coreSettings:a}=n,{FilesSharepointUrlService:o}=yield fB(i);return new o(yield e(),yield t(),a)})))(e,t,n))),WV=(e,t)=>()=>t.userServicesCache(Rj.FilesReferenceService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,coreSettings:i}=t,{FilesReferenceService:a}=yield w$(n);return new a(yield e(),i)})))(e,t))),HV=(e,t)=>()=>e.userServicesCache(Rj.FileUploadPreviewService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i}=e,{FileUploadPreviewService:a}=yield C$(i);return new a(yield t(),n)})))(e,t))),VV=(e,t)=>()=>e.userServicesCache(Rj.FileUploadService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i,coreSettings:a}=e,{FileUploadService:o}=yield C$(i);return new o(yield t(),a,n)})))(e,t))),zV=e=>()=>e.userServicesCache(Rj.FileDownloadManagerService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n}=e,{FileDownloadManagerService:i}=yield _$(t);return new i(n.newLogger("fileDownloadManagerService","data-services-common"))})))(e)));var qV=n(78781);const GV=(e,t)=>()=>e.userServicesCache(Rj.PersonalFileDetailsService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,send:r}=e,s=yield t(),{PersonalFileDetailsService:l}=yield iB(o),c=new qV.q(n);return new l(s,o,a,i.bind(c.authorize(r,"x-skypetoken"),vs.Pn.middleTier))})))(e,t))),JV=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i,discover:a}=e,{RefreshSiteUrlService:o}=yield n.e(606545).then(n.bind(n,326313));return new o(t,a,i)})),QV=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:i,loggerFactory:a,send:o}=e,{CloudStorageFoldersService:r}=yield n.e(134125).then(n.bind(n,799480));return new r(t,i,a,o)})),KV=e=>()=>e.userServicesCache(Rj.CloudStorageFoldersService,(()=>QV(e))),YV=e=>()=>e.userServicesCache(Rj.FilesBackfillThreadPropertiesService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,scenarioFactory:i,loggerFactory:a,send:o}=e,{FilesBackfillThreadPropertiesService:r}=yield w$(i),s=new qV.q(t);return new r(a,n.bind(s.authorize(o,"x-skypetoken"),vs.Pn.middleTier))})))(e)));var XV=n(335526);const ZV=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,authenticationService:i,loggerFactory:a,coreSettings:o}=t,r=ez(o),s=tz(o,r)||"",l=nz(o,r)||"",c=(0,XV.x)(i),{ItemUploadService:d,ItemDeleteService:u,ItemDetailsService:m}=yield OB(n),g=a.newLogger(e,"data-services-common");switch(e){case Rj.ItemUploadService:return new d(c,r,s,l,g);case Rj.ItemDeleteService:return new u(c,r,g);case Rj.ItemDetailsService:return new m(c,r,g,o);default:return}})),ez=e=>!!e.get(L.J.Files).preferGraphOverVroom,tz=(e,t)=>t?e.get(L.J.Files).graphEndpointBaseUrl:e.get(L.J.Files).vroomEndpointBaseUrl,nz=(e,t)=>t?e.get(L.J.Files).graphAuthScope:e.get(L.J.Files).vroomAuthScope,iz=e=>()=>e.userServicesCache(Rj.ItemUploadService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield ZV(Rj.ItemUploadService,e)})))(e))),az=e=>()=>e.userServicesCache(Rj.ItemDeleteService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield ZV(Rj.ItemDeleteService,e)})))(e))),oz=e=>()=>e.userServicesCache(Rj.ItemDetailsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield ZV(Rj.ItemDetailsService,e)})))(e))),rz=e=>()=>e.userServicesCache(Rj.DriveItemShareService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{DriveItemShareService:n}=yield fB(t),{authenticationService:i,coreSettings:a}=e,o=ez(a);return new n((0,XV.x)(i),o)})))(e))),sz=(e,t)=>()=>e.userServicesCache(Rj.VideoFileService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,loggerFactory:i,send:a,scenarioFactory:o}=e,{VideoFileService:r}=yield fB(o);return new r(a,i,n,yield t())})))(e,t))),lz=e=>()=>e.userServicesCache(Rj.FilesValidDomainsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n,loggerFactory:i,localStorage:a,coreSettings:o}=e,{FilesValidDomainsService:r}=yield w$(n);return new r(t,i,a,o)})))(e))),cz=e=>()=>e.userServicesCache(Rj.CalendarService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r,platformService:s,i18n:l}=e,{CalendarService:c}=yield i$(t);return new c(n,i,o,a,r,s,l)})))(e))),dz=e=>()=>e.userServicesCache(Rj.ExternalCalendarEmailAddressService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{ExternalCalendarEmailAddressService:i}=yield k$(t);return new i(n)})))(e))),uz=e=>()=>e.userServicesCache(Rj.TeamCalendarService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r,platformService:s,i18n:l}=e,{TeamCalendarService:c}=yield i$(t);return new c(n,i,o,a,r,s,l)})))(e))),mz=e=>()=>e.userServicesCache(Rj.SubstrateMeetingRecommendationsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,loggerFactory:a}=e,{SubstrateMeetingRecommendationsService:o}=yield pB(t);return new o(n,i,a)})))(e))),gz=e=>()=>e.userServicesCache(Rj.CommonSubstrateService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,platformService:i,authenticationService:a,endpointsManager:o,windowProvider:r,coreSettings:s}=e,{CommonSubstrateService:l}=yield gB(t);return new l(r,n,a,i,s,o)})))(e))),pz=e=>()=>e.userServicesCache(Rj.SignalsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,config:n,coreSettings:i,scenarioFactory:a,send:o}=e;if(!n)throw new Error("config not set on IUserServicesFactoryContext");const{SignalsService:r}=yield bB(a);return new r(t,i,o,n)})))(e))),vz=e=>()=>e.globalServicesCache(xj.ExampleGlobalService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{ExampleService:n}=yield aB(t);return new n})))(e))),hz=e=>()=>e.globalServicesCache(xj.GlobalCallingService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{GlobalCallingService:t}=yield Promise.all([n.e(698627),n.e(623025),n.e(579814),n.e(110350),n.e(967566),n.e(29311),n.e(700878),n.e(356078),n.e(861064),n.e(194806),n.e(175925)]).then(n.bind(n,796866));return new t(e)})))(e))),fz=e=>()=>e.globalServicesCache(xj.MTMAUserDataService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{hostCommunicationService:t,loggerFactory:n,scenarioFactory:i,workerCacheManager:a}=e,{MTMAUserDataService:o}=yield YB(i),r=new o({hostCommunicationService:t,loggerFactory:n,workerCacheManager:a});return yield r.startup(),r})))(e))),yz=e=>()=>e.globalServicesCache(xj.WebAppSwitcherService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{crossTabsService:t,localStorage:n,loggerFactory:i,scenarioFactory:a}=e,{WebAppSwitcherService:o}=yield KB(a);return new o(n,i,t)})))(e))),bz=e=>()=>e.userServicesCache(Rj.UnifiedConsentService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n,authenticationService:i,cacheStorage:a,loggerFactory:o}=e,{UnifiedConsentService:r}=yield DB(n);return new r(t,i,a,o)})))(e))),Sz=(e,t)=>{const{calendarServices:n,chatServices:a,fileServices:o,getAsyncMediaService:r,getBotsPlatformService:s,getCallingAppEventsService:l,getCallingBannerService:c,getCallingDialogService:d,getCallingNotificationService:u,getCollabObjectService:m,getConnectedAccountsService:g,getDiscoverSurfaceService:p,getExternalAccountsService:v,getGoogleCalendarAuthenticationService:h,getMsaAuthenticationService:f,getSharepointRestClient:y,getSmbUserIntentService:b,getTenantPrivacyProfileService:S,getThirdPartyCalendarService:k,getUserLicenseService:w,getStoreDevicesService:C}=(e=>{const t=XB(e),n=Cz(e),i=ZB(e),a=eW(e,n.getChatService),o=_z(e,t,n.getChatService,i),r=tW(e),s=nW(e),l=iW(e),c=aW(e),d=oW(e,s,l,r),u=rW(e,s,r),m=Tz(e),g=lW(e),p=dW(e,g),v=mW(e,g),h=vW(e,g),f=hW(e),y=fW(e),b=yW(e,y),S=bW(e);return{calendarServices:m,chatServices:n,fileServices:o,getAsyncMediaService:t,getBotsPlatformService:a,getCallingAppEventsService:g,getCallingBannerService:p,getCallingDialogService:v,getCallingNotificationService:h,getCollabObjectService:SW(e),getConnectedAccountsService:r,getDiscoverSurfaceService:f,getExternalAccountsService:d,getGoogleCalendarAuthenticationService:s,getMsaAuthenticationService:c,getSharepointRestClient:i,getSmbUserIntentService:b,getTenantPrivacyProfileService:S,getThirdPartyCalendarService:u,getUserLicenseService:y,getStoreDevicesService:kW(e)}})(e),_={getCallingAppEventsService:l,getCallingBannerService:c,getCallingDialogService:d,getCallingNotificationService:u,getTenantPrivacyProfileService:S},T=((e,t,n)=>(a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=null==o?void 0:o.scenario;null==i||i.mark(it.ck.GetGlobalCallingService);const r=yield n.getGlobalCallingService();null==i||i.mark(it.ck.GlobalCallingServiceInitAccount);const s=yield r.initAccount({entryPoint:a,accountCtx:e,deps:t,telemetryContext:o});return Object.assign(Object.assign({},s),{dispose:(t,n)=>r.disposeAccount(t,n,e.authenticationUser)})})))(e,_,t),I=((e,t,n)=>()=>n.getGlobalCallingService().then((n=>n.deprecated_onAccountInitialized(e,t).then((t=>Object.assign(Object.assign({},t),{dispose:(t,i)=>n.disposeAccount(t,i,e.authenticationUser)}))))))(e,_,t);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a),{getAiInsightsFeedbackService:wW(e),getAiInsightsSdsService:CW(e),getAppBasedLinkService:_W(e,s),getAppsPlatformService:TW(e),getAppSuggestionsService:IW(e),getAsyncMediaService:r,getAugloopService:EW(e),getAzureMapsService:NW(e),getBadgeCountService:AW(e),getBotsPlatformService:s,getBrbService:FW(e),getBreakoutRoomMiddleTierService:DW(e),getAtpSafelinksService:RW(e),getBroadcastAttendeeService:xW(e),getBroadcastStreamingAttendeeService:MW(e),getBroadcastCaptionsService:OW(e),getBroadcastSignalRService:PW(e)}),n),{getCallBlockingService:(E=e,()=>E.userServicesCache(Rj.CallBlockingService,(()=>jW(E)))),getCallingAnonymousDisplayNameService:WW(e),getCallingAppEventsService:l,getCallingBannerService:c,getCallingDialogService:d,getCallingNotificationService:u,getCallingService:T,deprecated_getCallingServiceOnInitialized:I,getCmdMeetingIntelligenceService:HW(e),getCollabObjectService:m,getMeetingCatchupService:VW(e),getCommunitySettingsService:zW(e),getConnectedAccountsService:g,getConnectedCalendarSettingsService:qW(e),getBiometricEnrollmentService:GW(e),getBiometricFaceEnrollmentService:JW(e),getDeveloperSwitchersService:QW(e),getDistributionListService:KW(e),getDynamicsMarketingService:YW(e),getDynamicsVirtualEventsService:XW(e),getEmoticonService:ZW(e,a.getChatService),getEspService:eH(e),getExampleService:tH(e),getExternalAccountsService:v,getExternalAccountsResponseService:nH(e,g)}),o),{getFluidService:iH(e),getGalleryService:aH(e),getGiphyService:oH(e),getGoogleCalendarAuthenticationService:h,getGoogleContactsAuthenticationService:iW(e),getGuardiansService:rH(e),getImageProxyService:sH(e),getImmersiveReaderService:lH(e),getImportMsaContactsService:cH(f,e),getImplicitContactsService:dH(e),getInstantAnswersService:uH(e),getInviteLinksService:mH(e),getLiveStateBroadcastService:gH(e),getLiveStreamRenderingService:pH(e),getLmsIntegrationService:vH(e),getLockedTeamsService:hH(e),getLogsFilesService:yH(e),getLokiService:bH(e),getManageTenantService:SH(e),getMeetForWorkService:kH(e,n.getCalendarService,m),getMeetingArtifactsService:wH(e),getMeetingBotService:CH(e,n.getCalendarService,a.getChatService),getMeetingIntelligenceService:_H(e),getMeetingOptionsClientDataService:EH(e),getMeetingOptionsService:NH(e),getMeetingQuestionsAndAnswersService:AH(e),getMeetingRecapService:FH(e),getMeetingRecapSwaService:DH(e),getMeetingTemplateService:RH(e),getMsaAuthenticationService:f,getPaymentService:xH(e),getPeoplePickerService:OH(e),getPeopleService:TH(e),getPeopleTargetingService:PH(e)}),kz(e,b,w)),{getPoliciesService:LH(e),getPresenceService:UH(e)}),wz(e)),{getAddressService:$H(e),getPstnService:WH(e),getSCISService:HH(e),getSearchPrefetchService:VH(e)}),Iz(e)),{getSharepointRestClient:y,getShareService:zH(e),getSmbUserIntentService:b,getStoreService:qH(e,C),getStoreDevicesService:C,getStyleMyRoomService:GH(e),getTenantMembershipService:JH(e),getTenantService:QH(e),getTenantAnalyticsService:KH(e),getTenantPrivacyProfileService:S,getTranscriptService:YH(e),getTranscriptFeedbackService:XH(e),getTranscriptSettingsStoreService:ZH(e),getTranslateService:eV(e),getTargetingHierarchyService:tV(e),getThirdPartyCalendarService:k,getToastImageService:nV(e),getTeamsAndChannelsService:aV(e),getTpnNoticeService:oV(e),getUrlPreviewService:rV(e,o.getFilesReferenceService),getUserProfileService:sV(e),getVirtualEventsService:lV(e),getVoicemailService:uV(e),getWebinarService:mV(e),getCallRecordingService:gV(e),getUserLicenseService:w,getDiscoverSurfaceService:p,getMonetizationService:pV(e),getMRUItemService:vV(e),getDiscoverSurfaceFeedbackService:hV(e,p),getCollabCloudService:fV(e),getTFLUserService:yV(e),getSensitivityLabelPolicySettingsService:bV(e)});var E},kz=(e,t,n)=>{const i=SV(e,t,n);return{getPetrolService:i,getFloodgateService:kV(e,i),getOdsService:wV(e,t,n)}},wz=e=>({getLokiMetaPreviewService:CV(e),getOdcFilePreviewService:_V(e),getOSearchService:TV(e),getPeopleSearchService:IV(e),getSubstrateFilesSearchService:EV(e),getSubstrateRecommendationsService:NV(e),getSubstrateSearchService:AV(e),getSubstrateSuggestionsService:FV(e),getSubstrateMeetingSearchService:DV(e),getSubstrateMeetingSummarySearchService:RV(e)}),Cz=e=>{const t=xV(e),n=MV(e,t),i=OV(e),a=PV(e),o=LV(e);return{getChatService:t,getChatServiceEndpointProvider:n,getConsumerGroupsService:i,getCSAService:a,getReportConcernService:UV(e),getStatefulLongPoll:o,getUnifiedConsentService:bz(e)}},_z=(e,t,n,i)=>{const a=jV(e,i),o=$V(e,i),r=BV(a,o,e);return{getFilesRedeemService:o,getFilesReferenceService:WV(r,e),getFilesSharepointUrlService:r,getFileUploadPreviewService:HV(e,t),getFileUploadService:VV(e,i),getFileDownloadManagerService:zV(e),getPersonalFileDetailsService:GV(e,n),getRefreshSiteUrlService:(s=e,()=>s.userServicesCache(Rj.RefreshSiteUrlService,(()=>JV(s)))),getCloudStorageFoldersService:KV(e),getFilesBackfillThreadPropertiesService:YV(e),getSharepointShareService:a,getItemUploadService:iz(e),getItemDeleteService:az(e),getItemDetailsService:oz(e),getDriveItemShareService:rz(e),getVideoFileService:sz(e,i),getFilesValidDomainsService:lz(e)};var s},Tz=e=>({getCalendarService:cz(e),getExternalCalendarEmailAddressService:dz(e),getTeamCalendarService:uz(e),getMeetingRecommendationsService:mz(e)}),Iz=e=>({getCommonSubstrateService:gz(e),getSignalsService:pz(e)});function Ez(e){const t=(n=Object.assign({globalServicesCache:Dj},e),{getExampleGlobalService:vz(n),getGlobalCallingService:hz(n),getLogsFilesService:(i=n,()=>i.globalServicesCache(Rj.LogsFilesService,(()=>fH(i)))),getGlobalMTMAUserDataService:fz(n),getGlobalWebAppSwitcherService:yz(n)});var n,i;return Object.assign(Object.assign({entityType:"unknown",windowId:""},e),t)}class Nz{static createGlobalDataRequestContext(e){if(Nz._globalRequestContext)throw new Error("GlobalDataRequestContext is already created!");return Nz._globalRequestContext=Ez(e),Nz._globalRequestContext}static createUserDataRequestContext(e,t){if(!Nz._globalRequestContext)throw new Error("GlobalDataRequestContext has not been created!");return function(e,t,n){const i=Object.assign(Object.assign({},e),{userServicesCache:(new Aj).getOrCreateServiceInstance}),{appsRegistryService:a,appStateService:o,authenticationService:r,authenticationUser:s,authStateProvider:l,cacheStorage:c,clientPreferences:d,clientState:u,commandChangeReportingService:m,coreSettings:g,discover:p,experienceChangeReportingService:v,hostCommunicationService:h,localStorage:f,loggerFactory:y,offlineCacheManager:b,platformService:S,pubsub:k,rebootService:w,scenarioFactory:C,userBiService:_,windowProvider:T,i18n:I,brbServiceManager:E,entityCommanding:N,userTrackingService:A,mediaAuthService:F}=e;return Object.assign(Object.assign(Object.assign({},t),{appsRegistryService:a,appStateService:o,authenticationUser:s,authenticationService:r,authStateProvider:l,cacheStorage:c,clientPreferences:d,clientState:u,commandChangeReportingService:m,coreSettings:g,discover:p,entityType:"unknown",experienceChangeReportingService:v,hostCommunicationService:h,localStorage:f,loggerFactory:y,mediaAuthService:F,offlineCacheManager:b,platformService:S,pubsub:k,rebootService:w,scenarioFactory:C,userBiService:_,windowId:"",windowProvider:T,i18n:I,brbServiceManager:E,entityCommanding:N,userTrackingService:A}),Sz(Object.assign(Object.assign({},i),{cmdApolloClient:n}),t))}(e,Nz._globalRequestContext,t)}static get globalRequestContext(){return Nz._globalRequestContext}}function Az(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e.config.enableEmbedDataClient)return function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{dataEvictionService:i,platformService:o,coreSettings:r,config:s}=e,{enableApolloDevtools:l}=r.get(L.J.Diagnostics),c=new Qx.pS,{defaultContext:d,link:u}=yield Pz(e,n,c),m=null===(a=d.leakDetectorService)||void 0===a?void 0:a.create(),g=Fz(e,c,m,u,d.loggerFactory,d.scenarioFactory)({windowId:he.ew,entityType:n,viewportContext:e.windowProvider.viewportContext,name:"embed",storeType:Kx.t.embed});return sM(g,"embed",Boolean(l),o,s.experienceName),new yM({pubsub:c,leakDetector:m,scenarioFactory:d.scenarioFactory,coreSettings:d.coreSettings,dataOpsTracker:t,dataEvictionService:Lz(i)?i:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},g,d)}))}(e,t,n);const{enableMTMA:a}=e.coreSettings.get(L.J.Core);return a?function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:i,dataEvictionService:o}=e,r=new Qx.pS,{defaultContext:s,link:l}=yield Pz(e,n,r,{noCDLTerminatingLink:!0}),c=null===(a=s.leakDetectorService)||void 0===a?void 0:a.create(),d=Fz(e,r,c,l,s.loggerFactory,s.scenarioFactory),{enableApolloDataEviction:u,enableViewSchema:m}=i.get(L.J.Core);let g;return m&&(g=Rz(e,r,c,aO.createViewSchemaLink(e),s.loggerFactory,s.scenarioFactory)),new Ej({pubsub:r,leakDetector:c,scenarioFactory:s.scenarioFactory,coreSettings:s.coreSettings,dataOpsTracker:u?t:void 0,dataEvictionService:u&&Lz(o)?o:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},d,s,g)}))}(e,t,n):function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:i,dataEvictionService:o}=e,r=new Qx.pS,{defaultContext:s,link:l}=yield Pz(e,n,r),c=null===(a=s.leakDetectorService)||void 0===a?void 0:a.create(),d=Fz(e,r,c,l,s.loggerFactory,s.scenarioFactory),{enableApolloDataEviction:u,enableViewSchema:m}=i.get(L.J.Core);let g;return m&&(g=Rz(e,r,c,aO.createViewSchemaLink(e),s.loggerFactory,s.scenarioFactory)),new fM({pubsub:r,leakDetector:c,scenarioFactory:s.scenarioFactory,coreSettings:s.coreSettings,dataOpsTracker:u?t:void 0,dataEvictionService:u&&Lz(o)?o:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},d,s,g)}))}(e,t,n)}))}function Fz(e,t,n,i,a,o,r,s){const{appsRegistryService:l,coreSettings:c,platformService:d,config:u,graphqlStoreStatsReporterService:m}=e;let g;g=r||Tj.create(t);const{maxApolloResultCacheSize:p,enableApolloDoubleWriteFix:v}=c.get(L.J.Core),{enableApolloDevtools:h}=c.get(L.J.Diagnostics),f=null!=p?p:void 0;return({windowId:e,entityType:t,viewportContext:r,name:c,overrideLink:p,storeType:y})=>{const b=l.getRegisteredAppsTypePolicies(e),S=Dz({leakDetector:n,windowId:e,entityType:t,viewportContext:r,userContextId:s},p||i,g,f,a,o,b,h,y,m,v);return sM(S,c,Boolean(h),d,u.experienceName),S}}const Dz=(e,t,n,i,a,o,r,s,l,c,d)=>{const u=(0,eM.aw)({typePolicies:uO(null==r?void 0:r.typePolicies),possibleTypes:Xx.g_h,dataIdFromObject:Yx.X,resultCacheMaxSize:i,apolloLeakOptions:e,loggerFactory:a,scenarioFactory:o,storeType:l,graphqlStoreStatsReporterService:c,enableApolloDoubleWriteFix:d}),m=(0,eM.nl)({cache:u,link:t,resolvers:n,defaultOptions:{watchQuery:{nextFetchPolicy:mO}},apolloLeakOptions:e,loggerFactory:a,enableApolloDevtools:s,storeType:l,graphqlStoreStatsReporterService:c,enableApolloDoubleWriteFix:d});return NM(u,a,null==r?void 0:r.defaultTypeName),m};function Rz(e,t,n,i,a,o){const{coreSettings:r,platformService:s,config:l,graphqlStoreStatsReporterService:c}=e,{maxApolloResultCacheSize:d,enableApolloDoubleWriteFix:u}=r.get(L.J.Core),{enableApolloDevtools:m}=r.get(L.J.Diagnostics),g=null!=d?d:void 0;return({windowId:e,entityType:t,viewportContext:r,name:d,overrideLink:p,storeType:v})=>{const h=xz({leakDetector:n,windowId:e,entityType:t,viewportContext:r},p||i,{},g,a,o,v,c,u);return sM(h,d,Boolean(m),s,l.experienceName),h}}const xz=(e,t,n,i,a,o,r,s,l)=>{const c=(0,eM.aw)({typePolicies:{PresenceAvailability:{merge:!0},PresenceOutOfOfficeStatus:{merge:!0},PresenceStatusNote:{merge:!0},ViewData:{merge:!0}},possibleTypes:Zx.g,dataIdFromObject:Yx.X,resultCacheMaxSize:i,apolloLeakOptions:e,loggerFactory:a,scenarioFactory:o,storeType:r,graphqlStoreStatsReporterService:s});return(0,eM.nl)({cache:c,link:t,resolvers:n,defaultOptions:{watchQuery:{nextFetchPolicy:mO}},apolloLeakOptions:e,loggerFactory:a,storeType:r,graphqlStoreStatsReporterService:s,enableApolloDoubleWriteFix:l})},Mz=(e,t,n)=>{const{appsRegistryService:i,appStateService:a,cdlAppStateService:o,authenticationService:r,authenticationUser:s,cacheStorage:l,clientPreferences:c,clientState:d,commandChangeReportingService:u,coreSettings:m,discover:g,dataEvictionService:p,experienceChangeReportingService:v,hostCommunicationService:h,leakDetectorService:f,localStorage:y,loggerFactory:b,notificationsHandler:S,offlineCacheManager:k,platformService:w,rebootService:C,scenarioFactory:_,userBiService:T,windowProvider:I,i18n:E,brbServiceManager:N,entityCommanding:A,userTrackingService:F}=e;return{appsRegistryService:i,appStateService:a,cdlAppStateService:o,authenticationService:r,authenticationUser:s,cacheStorage:l,clientPreferences:c,clientState:d,commandChangeReportingService:u,coreSettings:m,discover:g,dataEvictionService:p,entityType:n,experienceChangeReportingService:v,hostCommunicationService:h,leakDetectorService:f,localStorage:y,loggerFactory:b,notificationsHandler:S,offlineCacheManager:k,platformService:w,pubsub:t,rebootService:C,scenarioFactory:_,userBiService:T,windowId:he.ew,windowProvider:I,i18n:E,brbServiceManager:N,entityCommanding:A,userTrackingService:F}},Oz=(e,t)=>{const n=(0,tM.v)(((t,n)=>Object.assign(Object.assign({},e),n)));return nM.i.from([n,t])};function Pz(e,t,n,{noCDLTerminatingLink:a}={}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{networkState:i}=e,o=(0,JA.UZ)(ye.l,i.observeIsOnline()),r=Object.assign(Object.assign({},e),{pubsub:n,send:o}),s=Nz.createGlobalDataRequestContext(r),l=yield aO.createSingletonLink(Object.assign({contextValue:s,noCDLTerminatingLink:a},r));return{defaultContext:Mz(e,n,t),link:l}}))}function Lz(e){if(!e)return!1;const t=e;return"function"==typeof t.register&&"function"==typeof t.unregister}class Uz extends fe{constructor(){super(he.Yg.CreateDataClient,["scenarioFactory","loggerFactory","windowProvider","coreSettings","platformService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,windowProvider:i,coreSettings:a,platformService:o}=e,{enableApolloDataEviction:r,maxApolloCacheOperationCount:s}=e.coreSettings.get(L.J.Core),l=new Gx({activeOperationLimit:s});e.dataCleanupService=l,r&&(e.dataEvictionService=new Jx(l,t,n,i));const c=yield Az(Object.assign(Object.assign({},e),{pulsar:this.createDataClientPulsarInstance(a,n,o)}),l,C.pyR.default);e.client=c}))}createDataClientPulsarInstance(e,t,n){const{enablePulsarTelemetry:i,logToOTLCollector:a}=e.get(L.J.Pulsar),o=new cE(aE.TEAMS_RESOLVER,{sessionId:n.host.sessionId,spanExporter:new dE,loggerFactory:t,logToOTLCollector:!!a});return i&&o.initialize(),o}}var jz=n(366831),$z=n(878898);const Bz={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},Wz={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}}]}}]};var Hz,Vz;!function(e){e[e.Other=1]="Other",e[e.Main=2]="Main",e[e.Flyout=3]="Flyout",e[e.Minimode=4]="Minimode"}(Hz||(Hz={})),function(e){e.MatchingPendingIntentFound="MatchingPendingIntentFound",e.IntentOverriddenByOnBeforeAuth="IntentOverriddenByOnBeforeAuth",e.IntentOverriddenByOnAfterAuth="IntentOverriddenByOnAfterAuth"}(Vz||(Vz={}));function zz(e){const t=e.get(L.J.Metadata).environment;if(!t)throw new kC.G(kC.$.GET_CURRENT_CLOUD_FAILED);return t}function qz(e,t){return((e,t)=>{var n;const i=null==t?void 0:t.get(L.J.Auth).cloudDomainMap;if(!i)return;const a=null===(n=i.find((t=>t.domain===e)))||void 0===n?void 0:n.cloud;return a?nd.G7[a]:void 0})(e.host,t)}function Gz({coreSettings:e,logger:t,userContextId:n,waitForRenderingContextReady:a}){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=!!(null===(o=null==e?void 0:e.get(L.J.Auth))||void 0===o?void 0:o.enableIntegratedAuthApp);return t.log(`getUserContext(${n})`),a(i,n)}))}function Jz(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,correlation:n,logger:a,waitForRenderingContextReady:o}=e,r=yield Gz({coreSettings:t,logger:a,waitForRenderingContextReady:o}),s=yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield e.getUser({correlation:{id:t.id,scenarioName:t.scenarioName,source:t.source},accountId:n})}catch(e){return}}))}(r.authenticationService,n),l=null==s?void 0:s.id;return a.log(`getMainWindowUserId returns ${l}`),l}))}function Qz(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,correlation:n,userContextId:i,userContextAccountType:a}=e,o=e=>t.report({type:e,correlationId:n.id,context:{target:"get-deeplink-user-context",eventData:{commandSource:n.source,deeplinkGetUserContextAccountType:Ef[a],deeplinkGetUserContextId:i,scenarioPhase:"Core"}}});try{o(wC.B.WaitForUserContextStarted);const t=yield Gz(e);return o(wC.B.WaitForUserContextCompleted),{context:{client:t.client},userContextId:i,userContextAccountType:a}}catch(e){return void t.report({type:wC.B.WaitForUserContextFailed,correlationId:n.id,context:{target:"get-deeplink-user-context",errorInfo:CC.y.CreateUserContextError,eventData:{commandSource:n.source,deeplinkGetUserContextAccountType:Ef[a],deeplinkGetUserContextId:i,scenarioPhase:"Core",errors:e instanceof pe.G&&pe.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():`${e}`}}})}}))}function Kz(e,t,n,a,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{id:i,source:s}=o;t.report({type:wC.B.IntentExecuted,correlationId:i,context:{target:"launch-cloud",eventData:{commandSource:s,scenarioPhase:"Core"}}});try{const o=yield a.loadModule("core");if(!(null==o?void 0:o.launchCloud))throw Error("launchCloud not implemented in auth module");yield o.launchCloud({cloudType:e,deepLink:n,userContextId:r,correlation:{id:i,source:s}}),t.report({type:wC.B.IntentTransferredCrossCloud,correlationId:i,context:{target:"launch-cloud",eventData:{commandSource:s,scenarioPhase:"Core"}}})}catch(e){const n=new kC.G(kC.$.LAUNCH_CLOUD_DEEPLINK_ERROR,e);throw t.report({type:wC.B.Failure,correlationId:i,context:{target:"launch-cloud",errorInfo:CC.y.DeeplinkLaunchCrossCloudError,eventData:{commandSource:s,scenarioPhase:"Core",errorCode:n.toTelemetryEntry()}}}),n}}))}const Yz={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeAuthenticatedUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeAuthenticatedUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"Variable",name:{kind:"Name",value:"reason"}}}]}]}}]},Xz="intent-service";function Zz(e,t,n,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){n.log(`Executing Intent in windowId: ${o}`);const i=function(e,t){if(t){const n=(0,a.cloneDeep)(e.entityCommand);return n.command.stateTransition=d.su.flush,n.command.__UNSAFE_windowId=t,n}return e.entityCommand}(t,o),r=yield e(i,t.scenarioCorrelation.clientLaunchId);return n.log(`Command execution happened in windowId: ${r}`),r}))}function eq(e){const t=e.entityCommand.entity.type,n=e.entityCommand.command.layoutMode;return n===d.lO.minimode?Hz.Minimode:t===u.p.flyout||n===d.lO.minimal?Hz.Flyout:n===d.lO.focus?Hz.Other:Hz.Main}var tq;function nq(e,t){const n=u.p.identity;let i=e.entityCommand.command;return t===d.fe.show?i={visibilityState:d.fe.show,stateTransition:d.su.new,layoutMode:d.lO.focus,correlation:e.scenarioCorrelation.correlation}:t===d.fe.hide&&(i={visibilityState:d.fe.hide,stateTransition:d.su.flush,layoutMode:d.lO.focus,correlation:e.scenarioCorrelation.correlation}),{shouldRenderContent:!0,scenarioCorrelation:e.scenarioCorrelation,entityCommand:{command:i,entity:{type:n,action:u.u.loading},entityOptions:{tenantId:e.metadata.tenantId}},metadata:e.metadata}}!function(e){e[e.pending=0]="pending",e[e.fulfilled=1]="fulfilled",e[e.rejected=2]="rejected"}(tq||(tq={}));const iq=(e,t)=>{var n,i,a,o;const r=null!==(i=null===(n=null==t?void 0:t.get(L.J.Auth))||void 0===n?void 0:n.enableLoadingScreenInMeetings)&&void 0!==i&&i,s=null!==(o=null===(a=null==t?void 0:t.get(L.J.Auth))||void 0===a?void 0:a.enableMTO)&&void 0!==o&&o;return!e.shouldRenderContent||!(r&&s)||e.scenarioCorrelation.correlation.source===kt.D.ExternalCommand||!(e.entityCommand.entity.type===u.p.meetings||e.entityCommand.entity.type===u.p.callingdeeplink||e.entityCommand.entity.type===u.p.channels)},aq=e=>e.activeWindows.some((e=>!e.isMainWindow));function oq(e){const t=(0,a.cloneDeep)((0,a.omit)(e,["options"]));return e.shouldRenderContent?Object.assign(Object.assign({},t),{metadata:(0,a.omit)(t.metadata,["accountToUse","allowUserWindowingPreference"])}):t}function rq(e,t,n,a,o){var r,s,l,c,d;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,u,m;switch(a){case"onBeforeIntentAuthenticated":i=yield null===(r=n.onBeforeIntentAuthenticated)||void 0===r?void 0:r.execute(o);break;case"onAfterIntentAuthenticated":i=yield null===(s=n.onAfterIntentAuthenticated)||void 0===s?void 0:s.execute(o);break;default:{const e=`evaluateHook(${a}): Unknown hook and options.`;throw null===(l=t.errorToTelemetry)||void 0===l||l.call(t,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}}if(!i){const e=`evaluateHook(${a}): Undefined app hook response.`;throw null===(c=t.errorToTelemetry)||void 0===c||c.call(t,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}switch(i.overrideType){case If.NoOverride:m=!1,u=o.intent;break;case If.OverrideCloud:m=!0,u=Object.assign(Object.assign({},o.intent),{metadata:Object.assign(Object.assign({},o.intent.metadata),{cloud:i.cloud})});break;case If.OverrideIntent:m=!0,u=i.intent;break;case If.OverrideUserContext:m=!1,u=Object.assign(Object.assign({},o.intent),{metadata:Object.assign(Object.assign({},o.intent.metadata),{userContextId:i.userContextId})});break;case If.TerminateNavigation:m=!0,u=void 0;break;default:const e=`evaluateHook(${a}): Invalid app hook override type.`;throw null===(d=t.errorToTelemetry)||void 0===d||d.call(t,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}if(e.report({correlationId:o.intent.scenarioCorrelation.correlation.id,type:wC.B.IntentHookResolved,context:{target:Xz}}),u&&o.intent.shouldRenderContent!==u.shouldRenderContent)throw new kC.G(kC.$.INVALID_INTENT_OVERRIDE);return{intentOverridenByHook:m,intent:u}}))}const sq="intent-service",lq="none";class cq{constructor(e,t,n,i,a,o,r,s,l,c,d){this.appsRegistryService=t,this.coreSettings=n,this.commandHandler=i,this.client=a,this.waitForRenderingContextReady=o,this.commandChangeReportingService=r,this.experienceChangeReportingService=s,this.scenarioFactory=l,this.hostComms=c,this.host=d,this.pendingIntentMap=new Map,this.logger=e.newLogger("IntentService","core-services-deeplink"),this.observeActiveWindows(),this.hasCreatedNonMainWindow=!1}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let t,n,i;if(this.logInternal("execute: Original intent:",e),e.shouldRenderContent){i=eq(e),yield this.cleanupActiveWindowsIfNeeded(i);const o=this.pendingIntentMap.get(i);o&&(t=o.windowId,n=Vz.MatchingPendingIntentFound,this.logInternal(`execute: Replacing intent for window id: ${t} with layout type ${i}:`,e)),this.pendingIntentMap.set(i,{intent:(0,a.cloneDeep)(e),windowId:t})}this.logInternal("execute: Intent for evaluation:",e),this.commandChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:wC.B.IntentReceived,context:{target:sq,eventData:{mainEntityType:e.shouldRenderContent?e.entityCommand.entity.type:lq,mainEntityAction:e.shouldRenderContent?e.entityCommand.entity.action:lq,errorCode:n}}});const{intentExecuted:o,targetWindowId:r}=yield this.executeInternal(e,t);if(e.shouldRenderContent&&i)o?(this.logger.log("execute: Intent was not overriden and executed. Removing from state."),this.pendingIntentMap.delete(i)):(this.pendingIntentMap.set(i,{intent:(0,a.cloneDeep)(e),windowId:r}),this.logInternal(`execute: updated window ID: ${r}: For pending intent:`,e));else if(!e.shouldRenderContent){const t=this.scenarioFactory.findScenario(it.RG.ApplicationLaunchTime);null==t||t.stop({mainEntityType:lq,reason:"nrc_background_launch"}),this.commandChangeReportingService.report({type:wC.B.Blanked,correlationId:e.scenarioCorrelation.correlation.id,context:{target:"intent-service",eventData:{systemInitiated:!0,mainEntityType:lq}}})}this.experienceChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:l_.yU.NavigationIntentExecuted,context:{target:"intent-service",shouldRenderContent:e.shouldRenderContent}})}))}checkForPendingIntent(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){for(const[n,{intent:i,windowId:o}]of Array.from(this.pendingIntentMap)){const r=(0,a.cloneDeep)(i);if(r){this.commandChangeReportingService.report({correlationId:e.id,type:wC.B.IntentReceived,context:{target:sq,eventData:{mainEntityType:r.entityCommand.entity.type,mainEntityAction:r.entityCommand.entity.action}}}),r.entityCommand.command.visibilityState=d.fe.showWithoutFocusing,r.metadata.userContextId=t,r.entityCommand.command.correlation=e,r.scenarioCorrelation.correlation=e,this.logInternal("checkForPendingIntent: Executing pending intent:",r);const{intentExecuted:i}=yield this.executeInternal(r,o,!0);i&&(this.logger.log("checkForPendingIntent: Intent was not overriden and executed. Removing from state."),this.pendingIntentMap.delete(n))}}}))}switchAccount(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.logger.log("switchAccount"),this.execute({shouldRenderContent:!0,scenarioCorrelation:t,entityCommand:xC({entity:n,command:{visibilityState:d.fe.show,stateTransition:d.su.forceFlush,layoutMode:d.lO.standard,correlation:t.correlation}}),metadata:{allowAnonymous:!1,deepLink:e,userContextId:a},options:{shouldSkipOverridingWindowing:!0}})}))}launchMainApp(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("launchMainApp"),yield this.execute({shouldRenderContent:!0,scenarioCorrelation:t,entityCommand:xC({entity:n,command:{visibilityState:d.fe.show,stateTransition:d.su.forceFlush,layoutMode:d.lO.standard,correlation:t.correlation}}),metadata:{allowAnonymous:!1,deepLink:e},options:{shouldSkipOverridingWindowing:!0}})}))}prewarmFlyout(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("prewarmFlyout");const{enableMinimodeWindow:t}=this.coreSettings.get(L.J.Core);yield this.execute({shouldRenderContent:!0,scenarioCorrelation:e,entityCommand:xC({entity:{type:u.p.flyout,action:u.u.default},command:{visibilityState:d.fe.showWithoutFocusing,stateTransition:d.su.flush,layoutMode:t?d.lO.minimode:d.lO.minimal,correlation:e.correlation}}),metadata:{allowAnonymous:!1,deepLink:bN.flyout},options:{shouldSkipOverridingWindowing:!0}})}))}cleanupActiveWindowsIfNeeded(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{switch(e){case Hz.Other:const e=this.pendingIntentMap.get(Hz.Main);e&&(this.logger.log(`Closing main window with id=${e.windowId}.`),yield this.client.mutate({mutation:Bz,variables:{windowId:e.windowId}}));case Hz.Main:const t=this.pendingIntentMap.get(Hz.Other);t&&(this.logger.log(`Closing other window with id=${t.windowId}.`),yield this.client.mutate({mutation:Bz,variables:{windowId:t.windowId}}))}}catch(t){this.logger.warn(`cleanupActiveWindowsIfNeeded: Failed to remove window of type ${e}: ${t.message}`)}}))}observeActiveWindows(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.client.watchQuery({query:Wz}).subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,a,o,r;if(!e.loading&&!e.errors){const{data:s}=e;if(null===(n=null===(t=this.coreSettings)||void 0===t?void 0:t.get(L.J.Core))||void 0===n?void 0:n.enableAnonymousCallerSignout)if(this.hasCreatedNonMainWindow){const e=yield Gz({coreSettings:this.coreSettings,logger:this.logger,waitForRenderingContextReady:this.waitForRenderingContextReady});yield(a=s,o=this.client,r=(e=>{var t;return(null===(t=null==e?void 0:e.authenticationUser)||void 0===t?void 0:t.type)===nd.Ch.Anonymous})(e),(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!aq(a)&&r){const e={id:(0,Mf.pW)(),source:"intent-service",scenarioName:it.RG.AuthWebLogout};yield o.mutate({mutation:Yz,variables:{reason:"AnonymousSessionEnd"},context:{correlation:e}})}})))}else this.hasCreatedNonMainWindow=aq(s);this.checkAndCleanupIfWindowRemoved(s.activeWindows.map((e=>e.id)))}}))))}))}checkAndCleanupIfWindowRemoved(e){for(const[t,{intent:n,windowId:i}]of Array.from(this.pendingIntentMap))i&&!e.find((e=>e===i))&&(this.logInternal(`checkAndCleanupIfWindowRemoved: window id: ${i} no longer exists, removing intent:`,n),this.pendingIntentMap.delete(t))}executeInternal(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let o=this.commandHandler;this.logInternal(`executeInternal: windowId: ${t}: Original intent:`,e);const{intentOverridenByHook:r,newTargetWindowId:s,errorCode:l,targetCloud:c,targetUserContextId:m}=yield this.evaluateOnBeforeIntentAuthHook(e,o,t);let g,p,v=l;if(r)return this.logger.log("executeInternal: Intent overriden by onBeforeIntentAuthenticated."),c?(this.logger.log("executeInternal: overridden to target cloud. LaunchCloud and return early."),yield Kz(c,this.commandChangeReportingService,e.metadata.deepLink,this.hostComms,e.scenarioCorrelation.correlation,e.metadata.userContextId),{intentExecuted:!0,targetWindowId:s}):{intentExecuted:!1,targetWindowId:s};if(e.metadata.userContextId!==m&&(this.logger.log("executeInternal: userContextId overriden by onBeforeIntentAuthenticated."),e.metadata.userContextId=m),!e.shouldRenderContent&&!e.metadata.userContextId)return this.logger.log("executeInternal: userContextId is still undefined. Returning early."),{intentExecuted:!1,targetWindowId:s};this.commandChangeReportingService.report({type:wC.B.WaitForUserContextStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:sq}});try{g=yield Gz({coreSettings:this.coreSettings,logger:this.logger,userContextId:e.metadata.userContextId,waitForRenderingContextReady:this.waitForRenderingContextReady})}catch(n){return{intentExecuted:!0,targetWindowId:yield this.logAndGoToErrorPage({error:new kC.G(kC.$.CREATE_USER_CONTEXT_FAILED_GENERIC,n,e.metadata.userContextId),errorInfo:CC.y.CreateUserContextError,errorMessage:`getUserContext(${e.metadata.userContextId}) failed, executing original intent ${n}.`,fallbackError:new kC.G(kC.$.CREATE_USER_CONTEXT_FAILED_GENERIC,void 0,e.metadata.userContextId),intent:e,newCommandType:wC.B.WaitForUserContextFailed,windowId:t})}}if(this.commandChangeReportingService.report({type:wC.B.WaitForUserContextCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:sq}}),null==g?void 0:g.authenticationUser){const n=g;o=(e,t)=>nT(Object.assign(Object.assign({},n),{entityCommandInput:e,clientLaunchId:t}));const{intentOverridenByHook:i,targetWindowId:a,errorCode:r}=yield this.evaluateOnAfterIntentAuthenticatedHook(e,o,g,t);if(r&&(v=r),i)return this.logger.log("executeInternal: Intent overriden by onAfterIntentAuthenticated."),{intentExecuted:!1,targetWindowId:a}}else this.logger.log(`executeInternal: user context / authentication user is not defined for userContextId: ${e.metadata.userContextId}  - skip execution of onAfterIntentAuthenticated`);if(this.logInternal(`executeInternal: windowId: ${t}: Executing original intent:`,e),e.shouldRenderContent){const r=yield Jz({coreSettings:this.coreSettings,logger:this.logger,waitForRenderingContextReady:this.waitForRenderingContextReady,correlation:e.scenarioCorrelation.correlation});if(this.logInternal(`executeInternal: The intent is targeting userContextId ${e.metadata.userContextId}, and the mainWindowUserId is ${r}:`,e),this.shouldGoToAccountListWindow(this.coreSettings,e,r))return yield function(e,t,n,o){var r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){o.metadata.accountToUse=void 0;const i=(0,a.cloneDeep)(o);return i.entityCommand.entity={id:`${o.entityCommand.command.layoutMode}`,type:u.p.identity,action:u.u.list,linkedEntity:{type:o.entityCommand.entity.type,action:o.entityCommand.entity.action,id:null!==(r=o.entityCommand.entity.id)&&void 0!==r?r:o.entityCommand.command.correlation.id}},i.entityCommand.command=Object.assign(Object.assign({},o.entityCommand.command),{layoutMode:d.lO.focus,stateTransition:d.su.new,visibilityState:d.fe.show}),t.log(`goToAccountListWindow: Executing account list intent: {${i.entityCommand.entity.type}, ${i.entityCommand.entity.action}, ${i.entityCommand.command.layoutMode}, ${i.entityCommand.command.visibilityState}}`),e.report({correlationId:i.scenarioCorrelation.correlation.id,type:wC.B.IntentExecuted,context:{target:Xz,eventData:{mainEntityType:i.entityCommand.entity.type,mainEntityAction:i.entityCommand.entity.action}}}),Zz(n,i,t)}))}(this.commandChangeReportingService,this.logger,o,e),{intentExecuted:!1,targetWindowId:void 0};!function(e,t,n,i){var a,o;if(null===(a=n.options)||void 0===a?void 0:a.shouldSkipOverridingWindowing)return;if(!(null===(o=e.get(L.J.Core))||void 0===o?void 0:o.enableDeeplinkOptionAllowUserWindowingPreference))return;if(!i)return;const r=eq(n);if(r===Hz.Flyout||r===Hz.Minimode)return;const s=n.entityCommand.command;s.stateTransition!==d.su.none&&s.stateTransition!==d.su.extend&&n.entityCommand.entity.type!==u.p.default&&n.entityCommand.entity.type!==u.p.identity&&(n.metadata.userContextId&&n.metadata.userContextId!==i?(s.layoutMode=d.lO.focus,s.stateTransition=d.su.new):n.metadata.allowUserWindowingPreference&&(t.getPreferences("windowing").shouldOpenContentInNewWindow?(s.layoutMode=d.lO.focus,s.stateTransition=d.su.new):(s.layoutMode=d.lO.standard,s.stateTransition=d.su.flush)))}(this.coreSettings,g.clientPreferences,e,r),function(e,t,n,a,o,r){var s,l;(0,i.__awaiter)(this,void 0,void 0,(function*(){o&&n.entityCommand.entity.type===u.p.default&&(a.log("checkForPendingIntent: Translating default entity to a real entity"),n.entityCommand.entity=null!==(l=e.getDefaultCommand(null!==(s=null==r?void 0:r.coreSettings)&&void 0!==s?s:t))&&void 0!==l?l:n.entityCommand.entity)}))}(this.appsRegistryService,this.coreSettings,e,this.logger,n,g),p=yield Zz(o,e,this.logger,t)}return this.logInternal(`executeInternal: windowId: ${t}: Executed intent:`,e),this.commandChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:wC.B.IntentExecuted,context:{target:sq,eventData:{mainEntityType:e.shouldRenderContent?e.entityCommand.entity.type:lq,mainEntityAction:e.shouldRenderContent?e.entityCommand.entity.action:lq,errorCode:v}}}),{intentExecuted:!0,targetWindowId:p}}))}evaluateOnBeforeIntentAuthHook(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.commandChangeReportingService.report({type:wC.B.OnBeforeIntentAuthenticatedStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:sq}});const{intentOverridenByHook:a,targetWindowId:o,errorCode:r,targetCloud:s,targetUserContextId:l}=yield function(e,t,n,a,o,r,s,l,c){var u,m;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i=tq.pending,g={};if(iq(t,r))return g=yield e(),g;a.log("Proceed with loading screen display if threshold exceeds.");const p=null!==(m=null===(u=null==r?void 0:r.get(L.J.Auth))||void 0===u?void 0:u.thresholdToShowLoadingScreenInMs)&&void 0!==m?m:2e3;let v;const h=o.setTimeout((()=>{i!==tq.pending||v||(s.report({type:wC.B.OnLoadingScreenDisplayStarted,correlationId:t.scenarioCorrelation.correlation.id,context:{target:l}}),Zz(n,nq(t,d.fe.show),a,c).then((e=>{v=e})).catch((e=>a.warn(`Error while launching loading screen: ${e}`))))}),p);try{g=yield e(),i=tq.fulfilled}catch(e){throw i=tq.rejected,e}finally{o.clearTimeout(h),v&&(Zz(n,nq(t,d.fe.hide),a,v).catch((e=>a.warn(`Error while closing loading screen: ${e}`))),s.report({type:wC.B.OnLoadingScreenDisplayCompleted,correlationId:t.scenarioCorrelation.correlation.id,context:{target:l}}))}return g}))}((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.evaluateHook("onBeforeIntentAuthenticated",{intent:oq(e),context:{client:this.client,coreSettings:this.coreSettings,scenarioFactory:this.scenarioFactory}},t,n)}))),e,t,this.logger,this.host,this.coreSettings,this.commandChangeReportingService,sq,n);return this.commandChangeReportingService.report({type:wC.B.OnBeforeIntentAuthenticatedCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:sq,eventData:{errorCode:r}}}),{intentOverridenByHook:a,newTargetWindowId:o,errorCode:r,targetCloud:s,targetUserContextId:l}}))}evaluateHook(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o;this.logger.log(`evaluateHook(${e}): windowId: ${a}: Begin evaluation`);let r=!1;for(const s of function(e,t,n){const i=[];for(const a of e.registeredApps){const e=a[t];if(e)for(const t of Array.from(e.filter))"*"!==t&&t!==n||i.push(a)}return i}(this.appsRegistryService,e,t.intent.shouldRenderContent?t.intent.entityCommand.entity.type:void 0)){this.logger.log(`evaluateHook(${e}) - Matching app found: ${s.manifest.id}`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:wC.B.IntentHookStarted,context:{target:sq,eventData:{matchingApp:s.manifest.id}}});try{const n=yield rq(this.commandChangeReportingService,this.logger,s,e,t);r=n.intentOverridenByHook,i=n.intent,o=r?"onBeforeIntentAuthenticated"===e?Vz.IntentOverriddenByOnBeforeAuth:Vz.IntentOverriddenByOnAfterAuth:void 0}catch(n){this.logger.warn(`evaluateHook(${e}) windowId: ${a}: - Evaluating hook threw an error: ${n}. Executing error intent.`),o="onBeforeIntentAuthenticated"===e?CC.y.OnBeforeIntentAuthenticatedRejected:CC.y.OnAfterIntentAuthenticatedRejected;return{intentOverridenByHook:!0,targetWindowId:yield this.logAndGoToErrorPage({error:n,errorInfo:o,errorMessage:`evaluateHook(${e}) windowId: ${a}: - Evaluating hook threw an error: ${n}. Falling back to original intent.`,fallbackError:new kC.G(kC.$.UNKNOWN),intent:t.intent,newCommandType:wC.B.IntentHookRejected,windowId:a}),errorCode:o}}if(r){if(!i)return this.logger.warn(`evaluateHook(${e}) windowId: ${a}: - Hook overriden to undefined. Stopping further processing`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:wC.B.Failure,context:{target:sq,errorInfo:"onBeforeIntentAuthenticated"===e?CC.y.OnBeforeIntentAuthenticatedReturnedUndefined:CC.y.OnAfterIntentAuthenticatedReturnedUndefined}}),{intentOverridenByHook:!0,targetWindowId:a};if(i.metadata.cloud)return{intentOverridenByHook:r,targetWindowId:void 0,targetCloud:i.metadata.cloud,errorCode:o};if(t.intent.shouldRenderContent&&i.shouldRenderContent){this.logInternal(`evaluateHook(${e}), windowId: ${a}: - Executing overriden intent:`,i),this.commandChangeReportingService.report({correlationId:i.scenarioCorrelation.correlation.id,type:wC.B.IntentExecuted,context:{target:sq,eventData:{mainEntityType:i.shouldRenderContent?i.entityCommand.entity.type:lq,mainEntityAction:i.shouldRenderContent?i.entityCommand.entity.action:lq,errorCode:o}}});return{intentOverridenByHook:r,targetWindowId:yield Zz(n,i,this.logger,a),errorCode:o}}}}return this.logger.log(`evaluateHook(${e}): windowId: ${a}: Completing evaluation. Intent was not overriden.`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:wC.B.IntentHookCompleted,context:{target:sq}}),{intentOverridenByHook:!1,targetWindowId:a,errorCode:o,targetUserContextId:null==i?void 0:i.metadata.userContextId}}))}logInternal(e,t){this.logger.log(`${e} {${t.shouldRenderContent?`${t.entityCommand.entity.type}, ${t.entityCommand.entity.action}, ${t.entityCommand.command.layoutMode}, ${t.entityCommand.command.visibilityState}}`:"nrc"}`)}logAndGoToErrorPage({error:e,errorInfo:t,errorMessage:n,fallbackError:a,intent:o,newCommandType:r,windowId:s}){var l,c;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(null===(c=(l=this.logger).errorToTelemetry)||void 0===c||c.call(l,n,"webclient_framework_foundation_core_services_intent"),this.commandChangeReportingService.report({type:r,correlationId:o.scenarioCorrelation.correlation.id,context:{target:sq,errorInfo:t,eventData:{errors:e instanceof pe.G&&pe.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():`${e}`}}}),o.shouldRenderContent)return function(e,t,n,a,o,r){var s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;try{if(!(n instanceof pe.G))throw n;i=n.serialize()}catch(e){null===(s=t.errorToTelemetry)||void 0===s||s.call(t,`Failed to serialize error: ${e}`,"webclient_framework_foundation_core_services_intent"),i=null==r?void 0:r.serialize()}const l=Object.assign(Object.assign({},a),{entityCommand:{entity:{type:u.p.error,action:u.u.view},entityOptions:{serializedError:i},command:Object.assign(Object.assign({},a.entityCommand.command),{layoutMode:d.lO.focus})}});return Zz(e,l,t,o)}))}(this.commandHandler,this.logger,e,o,s,a)}))}evaluateOnAfterIntentAuthenticatedHook(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.commandChangeReportingService.report({type:wC.B.OnAfterIntentAuthenticatedStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:sq}});const{intentOverridenByHook:i,targetWindowId:o,errorCode:r}=yield this.evaluateHook("onAfterIntentAuthenticated",{intent:oq(e),context:{authenticatedUser:n.authenticationUser,client:n.client,localStorage:n.localStorage,coreSettings:this.coreSettings,experienceChangeReportingService:n.experienceChangeReportingService}},t,a);return this.commandChangeReportingService.report({type:wC.B.OnAfterIntentAuthenticatedCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:sq,eventData:{errorCode:r}}}),{intentOverridenByHook:i,targetWindowId:o,errorCode:r}}))}shouldGoToAccountListWindow(e,t,n){var i;return!!(null===(i=e.get(L.J.Core))||void 0===i?void 0:i.enableDeeplinkOptionAccountToUse)&&t.metadata.accountToUse===yN.UserChoiceFallback&&!!n&&t.metadata.userContextId===n}}function dq(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{location:t,scenarioCorrelation:n,loggerFactory:o,userContextId:r}=e,s=o.newLogger("DeeplinkUtilities","core-services-deeplink"),l=function(e,t){var n,i;const{hash:a,href:o,pathname:r}=e;if(a||o||r){if(a){const{deepLink:e,crash:t,relaunch:n,source:i,userContextId:o}=FN(a);if(e)return{deepLink:e,crash:t,relaunch:n,relaunchSource:i,isDesktopDeeplink:!0,userContextId:o}}if(o){let e;try{e=decodeURIComponent(o)}catch(e){const a=`${k_.DecodeURIComponentFailed}::${null==e?void 0:e.name}`;return void(null===(i=(n=t.newLogger(S_,"core-services-deeplink")).errorToTelemetry)||void 0===i||i.call(n,a,"webclient_framework_foundation_core_services_deeplink",void 0,!0))}return{deepLink:e,crash:!1,relaunch:!1,relaunchSource:void 0}}}}(t,o);let c;if(l&&l.isDesktopDeeplink)return function(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,coreSettings:n,deepLink:i,logger:a,scenarioCorrelation:o,userContextId:r}=e,s=bN[i],{enableMinimodeWindow:l}=n.get(L.J.Core);if(s){let e;switch(a.log(`Static deeplink: ${s}`),i){case bN.flyout:e=uq(o,r,i,{type:u.p.flyout,action:u.u.view},l?d.lO.minimode:d.lO.minimal);break;case bN.default:e=uq(o,r,i,vq(),d.lO.standard);break;case bN.core:e=uq(o,r,i,void 0)}return fq(t,o.correlation.id,s,(null==e?void 0:e.shouldRenderContent)?null==e?void 0:e.entityCommand.entity.type:void 0,(null==e?void 0:e.shouldRenderContent)?null==e?void 0:e.entityCommand.entity.action:void 0),{terminateDeeplink:!1,intent:e}}const c=yq(i);return hq(Object.assign(Object.assign({},e),{decodedLink:c}))}))}(Object.assign(Object.assign({},e),{userContextId:r||l.userContextId,deepLink:l.deepLink,logger:s}));if(l){const{terminateDeeplink:t,intent:n}=yield hq(Object.assign(Object.assign({},e),{decodedLink:l.deepLink,userContextId:r||l.userContextId,logger:s}));if(t)return{terminateDeeplink:t,intent:n};c=n}return c||(c=function(e,t,n){const{hash:i,pathname:o}=e;let r,s;if(i&&!(0,a.isEmpty)(i)){const e=i.indexOf("?");r=e>=0?i.substr(0,e):i}else r=o;const l=DN(r);l&&(s=uq(t,n,yq(r||bN.default),l));return s}(t,n,r)),{terminateDeeplink:!1,intent:c}}))}function uq(e,t,n,i,a,o=d.su.flush,r){return i?{shouldRenderContent:!0,scenarioCorrelation:e,entityCommand:xC({entity:i,command:{visibilityState:d.fe.show,stateTransition:o,layoutMode:a,correlation:e.correlation},entityOptions:r,metadata:{deepLink:n}}),metadata:{allowAnonymous:!1,deepLink:n,userContextId:t}}:{shouldRenderContent:!1,scenarioCorrelation:e,metadata:{allowAnonymous:!1,deepLink:bN.core,userContextId:t}}}function mq(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let n,a,o,r,s=!1;const{appsRegistryService:l,commandChangeReportingService:c,coreSettings:d,normalizedDeeplink:u,rawDeeplink:m,scenarioCorrelation:g,loggerFactory:p,logger:v,client:h,scenarioFactory:f,preferredCommandInput:y,userContextId:b,sourceViewEntity:S,forceInCloudExecution:k,getExperienceAccountMode:w,waitForRenderingContextReady:C}=e,_=d.get(L.J.Core).enableOriginValidationForIncomingIntents;if(!k&&_&&!(0,jz.H)(u.toString(),d,!0))return{terminateDeeplink:!1,matchType:"originValidationForIncomingIntents",intent:void 0,reason:"Not a valid deeplink",errorCode:k_.InvalidOrigin};try{let t;const{pathname:r}=u,k="/"===r[0]?r.substr(1):r,_=function(e){if(e.hash){const t=new URL(e.hash.substring(1),e.origin),n={pathname:t.pathname};return t.search&&(n.search=(0,kN.parse)(t.search)),n}}(u);for(const e of l.registeredApps){const{match:i,matchType:a,matchingCondition:o}=gq(e,k,u,_);if(i){t=o,n=a;break}}if(t){const n=e=>{c.report({correlationId:g.correlation.id,type:e,context:{target:"delegate-deeplink-to-app"}})};n(wC.B.DeeplinkParseByAppStarted);const r=yield t.execute({context:{__doNotUse_globalDataClient:h,coreSettings:d,getExperienceAccountMode:w,getUserContexts:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return function(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{getExperienceAccountMode:t,userContextId:n}=e,i=[],a=yield Jz(e);if(n&&n!==a&&t()!==si.SingleAccount){const t=yield Qz(Object.assign(Object.assign({},e),{userContextId:n,userContextAccountType:Ef.SourceWindow}));t&&i.push(t)}if(a){const t=yield Qz(Object.assign(Object.assign({},e),{userContextId:a,userContextAccountType:Ef.MainWindow}));t&&i.push(t)}return i}))}({commandChangeReportingService:c,coreSettings:d,correlation:g.correlation,getExperienceAccountMode:w,logger:v,userContextId:b,waitForRenderingContextReady:C})})),loggerFactory:p,scenarioFactory:f},deeplinkUrl:m,preferredCommandInput:y,sourceViewEntity:S,parsedDeeplinkHash:_});if(n(wC.B.DeeplinkParseByAppSucceeded),r){const t=yield function(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:n,userContextId:i}=e;if(!(null===(t=n.get(L.J.Core))||void 0===t?void 0:t.enableDeeplinkOptionAccountToUse))return{userContextId:i};const{accountToUse:a,getExperienceAccountMode:o}=e;if(o()===si.SingleAccount)return{accountToUse:yN.MainWindowAccount,userContextId:yield Jz(e)};switch(a){case yN.UserChoiceFallback:return{userContextId:void 0};case yN.MainWindowAccount:return{userContextId:yield Jz(e)};case yN.SourceWindowAccount:default:return{userContextId:i}}}))}(Object.assign(Object.assign({},e),{correlation:g.correlation,userContextId:b,waitForRenderingContextReady:C,accountToUse:r.metadata.accountToUse}));a=Object.assign(Object.assign({},r),{shouldRenderContent:!0,entityCommand:Object.assign(Object.assign(Object.assign({},r.entityCommand),{command:Object.assign(Object.assign({},r.entityCommand.command),{correlation:g.correlation})}),m&&{metadata:{deepLink:m.toString()}}),scenarioCorrelation:g,metadata:Object.assign(Object.assign(Object.assign({},r.metadata),{deepLink:m.toString()}),t)})}else s=!0,o=k_.DeeplinkTerminatedByApp}else o=k_.DeeplinkNotHandledByRegisteredApps}catch(e){o=k_.OnBeforeDeeplinkParsedFailed,r=e.message;const n=e.reason,i=`DeepLink:: /${o}/${(0,la.A)(r)}/${n}`;null===(t=v.errorToTelemetry)||void 0===t||t.call(v,i,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}return{matchType:n,terminateDeeplink:s,intent:a,errorCode:o,reason:r}}))}function gq(e,t,n,i){if(!e.onBeforeDeeplinkParsed)return{match:!1};for(const a of e.onBeforeDeeplinkParsed){const{filter:o}=a;if(pq(o)){if(o(n,i))return{match:!0,matchType:`${e.manifest.name}#filterFn`,matchingCondition:a}}else{const e="/"===o[0]?o.substr(1):o;if(t.startsWith(e))return{match:!0,matchType:e,matchingCondition:a}}}return{match:!1}}function pq(e){return(0,a.isFunction)(e)}function vq(){return{action:u.u.default,type:u.p.default}}function hq(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,coreSettings:n,decodedLink:a,hostCommunicationService:o,isInternalDeeplink:r,logger:s,scenarioCorrelation:l,userBiService:c,userContextId:m}=e,g=new URL(a,n.get(L.J.Host).deepLinkDomain||void 0),p=(0,jz.P)(g,n);!function(e,t,n,i){const{pathname:a,search:o}=i,r="/"===a[0]?a.substr(1):a,s=fN.find((e=>{const t="/"===e[0]?e.substr(1):e;return r.startsWith(t)}));if(!s)return;const l={};l["DataBag.joinLinkType"]=s.toString();const c=new URLSearchParams(o);l["DataBag.deeplinkId"]=c.get("deeplinkId"),l["DataBag.joinLinkVariant"]=c.get("v"),e.recordPanelAction({actionGesture:Ja.uS.open,actionOutcome:Ja.$K.open,actionScenario:Ja.Tk.deeplink,actionScenarioType:Ja.Yu.deeplink,moduleType:Ja.PO.deeplink,moduleName:Ja.rA.deeplinkService,panelType:n?Ja.wh.Internal:Ja.wh.External,dataBag:{id:"",data:Object.assign({},l),dispose:()=>{}}},t)}(c,s,r,p);const{matchType:v,terminateDeeplink:h,intent:f,errorCode:y,reason:b}=yield mq(Object.assign(Object.assign({},e),{normalizedDeeplink:p,rawDeeplink:g,logger:s}));(null==f?void 0:f.shouldRenderContent)?s.log(`Deeplink parsed to intent: { type: ${f.entityCommand.entity.type}, action: ${f.entityCommand.entity.action} }`):s.log("Returning default entity to be executed as fallback");let S=f;return h||S||(S=yield function(e,t,n,a,o,r){var s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableUnsupportedDeeplinkDialog:i}=t.get(L.J.Core);if(a.log(`enableUnsupportedDeeplinkDialog: ${i}`),i){const t=yield n.loadModule("appswitcher"),i=yield null===(s=null==t?void 0:t.getPearInstallState)||void 0===s?void 0:s.call(t,mT.OP.Teams1);if(a.log(`t1InstallState: ${i}`),i===mT.Jv.InstalledNotActive||i===mT.Jv.InstalledActive)return a.log("Returning unsupported deeplink command"),uq(o,r,e.toString(),{type:u.p.unsupporteddeeplinkdialog,action:u.u.view},d.lO.standard,d.su.extend,{originalDeeplink:e})}}))}(g,n,o,s,l,m)),fq(t,l.correlation.id,v,null==S?void 0:S.entityCommand.entity.type,null==S?void 0:S.entityCommand.entity.action,y,b),{terminateDeeplink:h,intent:S}}))}function fq(e,t,n,i,a,o,r){const s="deeplink-parsing";e.report({correlationId:t,type:wC.B.DeeplinkParsed,context:{target:s,eventData:{deeplinkType:n,mainEntityType:i,mainEntityAction:a,errorCode:o,reason:r}}}),e.report({type:wC.B.ScenarioEventDataAppended,correlationId:t,context:{target:s,eventData:{deeplinkType:n,mainEntityType:i,mainEntityAction:a,errorCode:o,reason:r}}})}function yq(e){return decodeURIComponent(e).replace(/[^A-Za-z0-9/.?&=#\+\-,_:@{}"]/g,"")}class bq{constructor(e,t,n,i,a,o,r,s,l,c,d,u,m,g,p,v){this._client=i,this._waitForRenderingContextReady=a,this._host=o,this._appsRegistryService=r,this._config=s,this._correlation=l,this._scenarioFactory=c,this._userBiService=d,this._commandChangeReportingService=u,this._hostComms=m,this._localStorage=g,this._experienceChangeReportingService=p,this._acountModeTrackingService=v,this._logger=e.newLogger("DeepLinkService","core-services-deeplink"),this._intentService=new cq(e,this._appsRegistryService,t,n,this._client,this._waitForRenderingContextReady,this._commandChangeReportingService,this._experienceChangeReportingService,this._scenarioFactory,this._hostComms,this._host),this._loggerFactory=e,this._coreSettings=t}init(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this._host.addEventListener("hashchange",(()=>{const e=function(e,t,n){return{clientLaunchId:IN({location:e,clientLaunchId:n}),correlation:EN(e,t),deeplinkId:NN(e,"deeplinkId")}}(this._host.location,kt.D.ExternalCommand);return this._handleUrl(!1,e)})),this._handleUrl(!0,{clientLaunchId:IN({location:this._host.location}),correlation:Object.assign({scenarioName:it.RG.ClientStart},this._correlation),deeplinkId:NN(this._host.location,"deeplinkId")})}))}executeFromUrlAsync(e,t,n,a,o,r,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;try{const l=new URL(e);i={correlation:(null==t?void 0:t.correlation)?FC(t.correlation):EN(l,kt.D.InternalDeeplink),clientLaunchId:a},a&&this.sendDeeplinkReceivedSignal(i,n);const c=zz(this._coreSettings),d=qz(l,this._coreSettings),u=this._coreSettings.get(L.J.Core).enableCrossCloudLaunch;if(!s&&!this._isValidDeepLinkUrlForInCloudOrCrossCloudExecution(e))return this.stopNavigationScenarios(i,wC.B.Incomplete,CC.y.DeeplinkIntentParseFailure,`Current cloud: ${c}, deeplinkCloud: ${d}, enableCrossCloudLaunch: ${u}`),!1;if(!s&&u&&d&&d!==c)return yield Kz(d,this._commandChangeReportingService,e,this._hostComms,i.correlation,o),!0;const{terminateDeeplink:m,intent:g}=yield this._getNavigationIntentAsync(l,!0,i,t,o,r,s);return m?(this.stopNavigationScenarios(i,wC.B.Incomplete,CC.y.DeeplinkExecutionTerminated),!0):g?(yield this._intentService.execute(g),!0):(this.stopNavigationScenarios(i,wC.B.Incomplete,CC.y.DeeplinkIntentParseFailure),!1)}catch(e){const t=`DeepLink:: ${k_.ToNavigationIntentFailed} ${(0,wi.u4)(e)}`;throw i&&this.stopNavigationScenarios(i,wC.B.Failure,CC.y.DeeplinkIntentParseFailure,t),new Error(t)}}))}checkForPendingIntent(e,t,n){const i=FC({source:e,scenarioName:it.RG.NavigationCommand});return t&&this.sendDeeplinkReceivedSignal({clientLaunchId:t,correlation:i},{type:"pendingIntent"}),this._intentService.checkForPendingIntent(i,n)}launchMainApp(e,t,n){const i={correlation:FC(Object.assign({scenarioName:it.RG.NavigationCommand},e)),clientLaunchId:IN({clientLaunchId:t})};i.clientLaunchId&&this.sendDeeplinkReceivedSignal(i,{type:"default"});const a=null!=n?n:{type:u.p.default,action:u.u.default};return this._intentService.launchMainApp(AN(a),i,a)}switchAccount(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i={correlation:FC(Object.assign({scenarioName:it.RG.NavigationCommand},e)),clientLaunchId:IN({clientLaunchId:n})};i.clientLaunchId&&this.sendDeeplinkReceivedSignal(i,{type:"switchAccount"});const r=null!=a?a:{type:u.p.default,action:u.u.default};return o&&o!==zz(this._coreSettings)?Kz(o,this._commandChangeReportingService,AN(r),this._hostComms,i.correlation,t):this._intentService.switchAccount(AN(r),i,r,t)}))}prewarmFlyout(e){const t={correlation:FC({source:e,scenarioName:it.RG.NavigationCommand}),clientLaunchId:IN({location:this._host.location})};return this.sendDeeplinkReceivedSignal(t,{type:"flyout"}),this._intentService.prewarmFlyout(t)}executeIntent(e){const t={correlation:FC(Object.assign(Object.assign({},e.entityCommand.command.correlation),{scenarioName:it.RG.NavigationCommand})),clientLaunchId:IN({})};return this.sendDeeplinkReceivedSignal(t,{type:`${e.entityCommand.entity.type}/${e.entityCommand.entity.action}`}),this._intentService.execute(Object.assign(Object.assign({},e),{entityCommand:Object.assign(Object.assign({},e.entityCommand),{command:Object.assign(Object.assign({},e.entityCommand.command),{correlation:t.correlation})}),metadata:Object.assign(Object.assign({},e.metadata),{deepLink:AN(e.entityCommand.entity)}),scenarioCorrelation:t,shouldRenderContent:!0}))}_handleUrl(e,t){var n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(this._lastDesktopClientId&&this._lastDesktopClientId===t.clientLaunchId)return void(null===(a=(n=this._logger).errorToTelemetry)||void 0===a||a.call(n,"Navigation received with duplicate clientId. Terminating flow.","webclient_framework_foundation_core_services_deeplink",void 0,!0));this._lastDesktopClientId=t.clientLaunchId;const i=this._host.location;t.correlation.scenarioName&&t.clientLaunchId&&this.sendDeeplinkReceivedSignal(t);const{terminateDeeplink:o,intent:r}=yield this._getNavigationIntentAsync(i,!1,t);let s=r;return o?(yield this._notifyIntentHandled(),void this.stopNavigationScenarios(t,wC.B.Incomplete,CC.y.DeeplinkExecutionTerminated)):(!s&&this._config.shouldExecuteDefaultCommand&&(s=uq(t,void 0,bN.default,vq(),d.lO.standard)),s?(yield this._notifyIntentHandled(),e&&this._experienceChangeReportingService.report({correlationId:t.correlation.id,type:l_.yU.InitialDeeplinkResolved,context:{target:"deeplink-service-handle-url",shouldRenderContent:s.shouldRenderContent}}),this._intentService.execute(s)):void this.stopNavigationScenarios(t,wC.B.Failure,CC.y.DeeplinkIntentParseFailure))}))}_isValidDeepLinkUrlForInCloudOrCrossCloudExecution(e){var t,n;try{return(0,jz.H)(e,this._coreSettings)}catch(e){const i=`DeepLink:: ${k_.InvalidDeepLinkUrl}::${null==e?void 0:e.name}`;return null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,i,"webclient_framework_foundation_core_services_deeplink",void 0,!0),!1}}_notifyIntentHandled(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this._hostComms.loadModule("core");yield null===(e=null==t?void 0:t.intentHandled)||void 0===e?void 0:e.call(t)}catch(e){this._logger.warn("Failed to notify host that intent was handled")}}))}_getNavigationIntentAsync(e,t,n,a,o,r,s){var l,c;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield dq({appsRegistryService:this._appsRegistryService,coreSettings:this._coreSettings,hostCommunicationService:this._hostComms,location:e,scenarioCorrelation:n,loggerFactory:this._loggerFactory,userBiService:this._userBiService,isInternalDeeplink:t,commandChangeReportingService:this._commandChangeReportingService,intentPersistenceService:new $z.I(this._localStorage),userContextId:o,client:this._client,preferredCommandInput:a,sourceViewEntity:r,scenarioFactory:this._scenarioFactory,forceInCloudExecution:s,getExperienceAccountMode:()=>this._acountModeTrackingService?this._acountModeTrackingService.getAccountMode():si.SingleAccount,waitForRenderingContextReady:this._waitForRenderingContextReady})}catch(e){null===(c=(l=this._logger).errorToTelemetry)||void 0===c||c.call(l,`DeepLink:: ${k_.ToNavigationIntentFailed}`,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}return{terminateDeeplink:!1}}))}sendDeeplinkReceivedSignal({clientLaunchId:e,correlation:t,deeplinkId:n},i){this._commandChangeReportingService.report({type:wC.B.NavigationCommandStart,correlationId:t.id,context:{target:"deeplink-service",clientLaunchId:e,correlation:t,eventData:Object.assign({deeplinkId:n,scenarioPhase:"Core"},i)}})}stopNavigationScenarios(e,t,n,i){this._logger.warn("Navigation intent not found");const a=this._scenarioFactory.findScenario(it.RG.ApplicationLaunchTime);null==a||a.fail({errorCode:n}),this._commandChangeReportingService.report({type:t,correlationId:e.correlation.id,context:{target:"deeplink-service-handle-url",errorInfo:n,errorMessage:i}})}}class Sq extends fe{constructor(){super(he.Yg.CreateDeeplinkService,["appsRegistryService","client","commandChangeReportingService","commandHandler","config","coreSettings","correlation","experienceChangeReportingService","hostCommunicationService","localStorage","loggerFactory","scenarioFactory","userBiService","waitForRenderingContextReady","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandChangeReportingService:i,commandHandler:a,config:o,coreSettings:r,correlation:s,experienceChangeReportingService:l,hostCommunicationService:c,localStorage:d,loggerFactory:u,scenarioFactory:m,userBiService:g,waitForRenderingContextReady:p,windowProvider:v}=e;e.deeplinkService=new bq(u,r,a,n,p,v,t,o,s,m,g,i,c,d,l,e.userTrackingService)}))}}const kq="default";class wq extends fe{constructor(){super(he.Yg.CreateDefaultCacheStorageAndCacheManagers,["config","loggerFactory","windowProvider","coreSettings","scenarioFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,config:n,loggerFactory:i,coreSettings:a,scenarioFactory:o}=e,r=new mF.E(t.caches,kq,kq,n.experienceName);e.cacheStorage=r,e.offlineCacheManager=new gF.G(r,i);(0,ID.Q6)(a)&&(e.workerCacheManager=(0,kD.L)(n.experienceName,i.newLogger("CreateDefaultCacheStorageAndCacheManagersTask","core-services-tasks"),o))}))}}const Cq="tmp";class _q{constructor(e,t,n,i,a){this.tid=e,this.oid=t,this.experienceName=n,this.windowProvider=i,this.logger=a.newLogger("LocalStorageService","services-io-browser-local-storage")}set(e,t,n=Ct.f.UserAndExperience){const i=this.getFormatKey(e,n);return this.windowProvider.localStorage.setItem(i,t)}setSafe(e,t,n=Ct.f.UserAndExperience){var i,a;try{return this.set(e,t,n),!0}catch(t){return null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,`Failed to set key '${e}'`,"webclient_framework_localstorage_setsafe",{errorCode:null==t?void 0:t.name},!0),!1}}get(e,t=Ct.f.UserAndExperience){const n=this.getFormatKey(e,t);return this.windowProvider.localStorage.getItem(n)}remove(e,t=Ct.f.UserAndExperience){const n=this.getFormatKey(e,t);return this.windowProvider.localStorage.removeItem(n)}clear(e){if(e){const t=e.map((e=>this.getFormatKey("",e)));Object.keys(this.windowProvider.localStorage).filter((e=>e.startsWith(Cq)&&t.some((t=>e.startsWith(t))))).forEach((e=>this.windowProvider.localStorage.removeItem(e)))}else this.windowProvider.localStorage.clear()}getFormatKey(e,t){switch(t){case Ct.f.Experience:return`tmp.${this.experienceName}.${e}`;case Ct.f.User:return`tmp.${this.tid}.${this.oid}.${e}`;case Ct.f.Global:return`tmp.${e}`;case Ct.f.UserAndExperience:default:return`tmp.${this.tid}.${this.oid}.${this.experienceName}.${e}`}}}const Tq="default";class Iq extends fe{constructor(){super(he.Yg.CreateDefaultLocalStorage,["config","loggerFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,config:i}=e,a=new _q(Tq,Tq,i.experienceName,t,n);e.localStorage=a}))}}class Eq extends fe{constructor(){super(he.Yg.DisableExperience,["platformService","coreSettings","loggerFactory"])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{platformService:n,coreSettings:i,loggerFactory:a}=e,o=null===(t=n.config)||void 0===t?void 0:t.browser,{supportedBrowsers:r}=i.get(L.J.Core);if(o&&r){if(!!!(null==r?void 0:r.find((e=>e===o))))throw(0,An.Tr)(he.w5.Core,he.jK.Disabled,"DisableUnsupportedBrowsersTask",void 0,`Browser "${o}" is not supported.`)}else o||a.newLogger("DisableUnsupportedBrowsersTask","core-services-tasks").warn("Unable to detect Browser.")}))}}var Nq=n(290457);class Aq extends fe{constructor(){super(he.Yg.CreateDiscovery,["authenticationService","loggerFactory","coreSettings","scenarioFactory","appStateService","networkState","hostCommunicationService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{onDiscoverSuccess:t,onDiscoverFail:n}=this.getDiscoverCallback(e),{authenticationService:i,loggerFactory:a,coreSettings:o,scenarioFactory:r,appStateService:s,networkState:l,authStateProvider:c,i18n:d,hostCommunicationService:u}=e,m=(0,JA.Gg)(s);e.discover=GA(i,a,ye.l,o,r,m,l,u,d,c,void 0,t,n,void 0,void 0)}))}getDiscoverCallback(e){var t;let n,i;return(null===(t=e.platformService)||void 0===t?void 0:t.config.hostingParent)===Pe.GJ.Outlook&&(n=()=>{e.windowProvider.sessionStorage.removeItem(Nq.v4),e.windowProvider.sessionStorage.removeItem(Nq.F_)},i=t=>{t||"true"!==e.windowProvider.sessionStorage.getItem(Nq.F_)||(e.windowProvider.sessionStorage.setItem(Nq.v4,"true"),e.windowProvider.location.reload())}),{onDiscoverSuccess:n,onDiscoverFail:i}}}var Fq=n(148560),Dq=n(396905);class Rq{constructor(){this._endpointsHealthCache={},this._groupsHealthCache={},this.getEndpointHealth=(e,t)=>{if(e&&t){const n=this._endpointsHealthCache[this._getCacheKey(e,t)];return n?Object.assign({},n.value):void 0}},this.observeEndpointHealth=(e,t)=>e&&t?this._getHealthRecord(e,t).observable:void 0,this.observeAggregatedHealth=e=>e?this._getHealthRecord(e,void 0).observable:void 0,this.dumpState=()=>JSON.stringify(Object.assign(Object.assign({},this._endpointsHealthCache),this._groupsHealthCache),((e,t)=>t instanceof Dq.x?t.value:t)),this.updateRemoteEndpointHealth=e=>{if(!e.serviceName)return;const t=this._getHealthRecord(e.serviceName,e.endpointName);t.value.isHealthy!==e.isHealthy&&(t.value.isHealthy=e.isHealthy,t.onNext(t.value))},this._getCacheKey=(e,t)=>`${e}_${t||""}`,this._getHealthRecord=(e,t)=>(t?this._endpointsHealthCache[this._getCacheKey(e,t)]:this._groupsHealthCache[this._getCacheKey(e,t)])||this._startTrackingHealth(e,t),this._startTrackingHealth=(e,t)=>{if(t){const n={serviceName:e,endpointName:t,isHealthy:void 0},i=new Dq.x(n);return this._endpointsHealthCache[this._getCacheKey(e,t)]=i,i}{const n={groupName:e,isHealthy:void 0},i=new Dq.x(n);return this._groupsHealthCache[this._getCacheKey(e,t)]=i,i}}}getAggregatedHealth(e){if(e){const t=this._groupsHealthCache[this._getCacheKey(e,void 0)];return t?Object.assign({},t.value):void 0}}dispose(){this._endpointsHealthCache={},this._groupsHealthCache={}}}class xq{constructor(e,t){this._endpointsManager=e,this._logger=t,this._subscriptions=[],this._aggregatedHealthMap=new Map,this._remoteEndpointsHealthCache=new Rq,this.observeEndpointHealth=(e,t)=>this._getLocalEndpointHealth(e,t)?this._getLocalEndpointObservable(e,t):this._getRemoteEndpointHealth(e,t)?this._getRemoteEndpointObservable(e,t):this._getLocalEndpointObservable(e,t),this.getEndpointHealth=(e,t)=>this._getLocalEndpointHealth(e,t)||this._getRemoteEndpointHealth(e,t),this.observeAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.observable},this.getAggregatedHealth=e=>this._getLocalAggregatedHealth(e)||this._getRemoteAggregatedHealth(e),this.dumpState=()=>(0,wi.LQ)(`{ "aggregated endpoints health": [\n      ${this._printAggregatedHealth(this._aggregatedHealthMap)}\n    ],\n    "endpoints health": [\n      ${this._endpointsManager.health.dumpState()}\n    ]},\n    "remote endpoints health": ${this._remoteEndpointsHealthCache.dumpState()}`),this.getWorkerDumpState=()=>this._requestWorkerStateDumpCallback?(this._deferredWorkerStateDump=(0,ci.P)(),this._requestWorkerStateDumpCallback(),this._deferredWorkerStateDump.promise):Promise.reject("Worker endpoints health snapshot can't be requested"),this.getEndpointsHealthUpdateHandler=()=>({handleEndpointHealthUpdate:this._remoteEndpointsHealthCache.updateRemoteEndpointHealth,handleStateDump:this._handleWorkerStateDumpResponse,onStateDumpRequest:this._setWorkerStateDumpRequestCallback}),this._getLocalEndpointHealth=(e,t)=>this._endpointsManager.health.getEndpointHealth(e,t),this._getLocalEndpointObservable=(e,t)=>this._endpointsManager.health.observeEndpointHealth(e,t),this._getRemoteEndpointHealth=(e,t)=>this._remoteEndpointsHealthCache.getEndpointHealth(e,t),this._getRemoteEndpointObservable=(e,t)=>this._remoteEndpointsHealthCache.observeEndpointHealth(e,t),this._updateAggregatedHealth=(e,t,n)=>{const i=e.healthSubject.value,a=[];if(i.endpoints)for(const e of i.endpoints)if(e.endpointName===t.endpointName&&e.serviceName===t.serviceName)a.push(t);else{const t=this._endpointsManager.health.getEndpointHealth(e.serviceName,e.endpointName);t&&a.push(t)}try{const t=n(a);t!==i.isHealthy&&(i.isHealthy=t,e.healthSubject.onNext(i))}catch(e){this._logger.error(`Error happened in aggregated group health policy. Group: ${i.groupName}. Error: ${JSON.stringify(e.reason||e)}`)}},this._printAggregatedHealth=e=>{let t="";return e.forEach((e=>{t=`${t},${JSON.stringify(e.healthSubject.value)}`})),t?(0,wi.LQ)(t):""},this._handleWorkerStateDumpResponse=e=>{this._logger.log("Received worker endpoints health state dump."),this._deferredWorkerStateDump&&(this._deferredWorkerStateDump.resolve(e),this._deferredWorkerStateDump=void 0)},this._setWorkerStateDumpRequestCallback=e=>{this._requestWorkerStateDumpCallback=e}}createAggregatedHealthGroup(e,t,n){if(!e||0===e.length||!t||0===t.length)return this._logger.error(`createAggregatedHealthGroup: Group name is empty or no endpoints are provided. groupName: ${e}; endpoints: ${t&&JSON.stringify(t)}`),Fq.a.InvalidArguments;if(this.getAggregatedHealth(e))return this._logger.error(`createAggregatedHealthGroup: Group name already exists. groupName: ${e}`),Fq.a.GroupNameExists;const i={groupName:e,endpoints:t,isHealthy:void 0},a={healthSubject:new Dq.x(i)};return this._aggregatedHealthMap.set(e,a),t.forEach((t=>{var i;const a=null===(i=this.observeEndpointHealth(t.serviceName,t.endpointName))||void 0===i?void 0:i.subscribe((t=>{const i=this._aggregatedHealthMap.get(e);i||this._logger.error(`Can't update group health. Group '${e}' is not registered`),i&&this._updateAggregatedHealth(i,t,n)}));a&&this._subscriptions.push(a)})),Fq.a.Success}dispose(){var e;this._subscriptions.map((e=>e.unsubscribe())),this._subscriptions=[],this._aggregatedHealthMap.clear(),this._remoteEndpointsHealthCache.dispose(),this._requestWorkerStateDumpCallback=void 0,null===(e=this._deferredWorkerStateDump)||void 0===e||e.reject("CombinedEndpointsHealthService is disposed"),this._deferredWorkerStateDump=void 0}_getLocalAggregatedHealth(e){var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.value}_getRemoteAggregatedHealth(e){return this._remoteEndpointsHealthCache.getAggregatedHealth(e)}}var Mq=n(380141),Oq=n(783623),Pq=n(561065),Lq=n(424063);class Uq extends fe{constructor(){super(he.Yg.CreateEndpointsManager,["coreSettings"])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:n,windowProvider:i,coreSettings:a}=e,{disableEndpointsHealthService:o,enableCombinedEndpointsHealthService:r}=a.get(L.J.Core);e.endpointsManager=(0,Pq.F)(e,{globalContext:i,telemetryProvider:(0,Oq.YK)(i,a,n.newLogger("EPM","core-services-tasks"),null===(t=e.authenticationUser)||void 0===t?void 0:t.id),configuration:(0,Lq.XF)(a.get(L.J.Core))}),o?n.newLogger("EndpointsHealthService","core-services-tasks").log("Disabled by disableEndpointsHealthService feature flag"):(e.endpointsHealthService=r?new xq(e.endpointsManager,n.newLogger("CombinedEndpointsHealthService","core-services-tasks")):new Mq.V(e.endpointsManager,n.newLogger("EndpointsHealthService","core-services-tasks")),(0,pT.G)().setEndpointHealth(e.endpointsHealthService.getEndpointHealth))}))}}const jq={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CoreServicesTasksRemoveUserActiveWindowsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeUserActiveWindows"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class $q extends fe{constructor(){super(he.Yg.CreateEntityCommanding,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:t,commandHandler:n,commandDelegator:a,eventHandler:o,windowProvider:r,hostCommunicationService:s,scenarioFactory:l,loggerFactory:c,deeplinkService:d,coreSettings:u}=ax("CreateEntityCommandingTask",e,"client","commandHandler","commandDelegator","eventHandler","windowProvider","hostCommunicationService","scenarioFactory","loggerFactory","deeplinkService","coreSettings"),m=e.authenticationUser?(0,di.b4)(e.authenticationUser):void 0,{entityCommanding:g,eventing:p}=bI(n,a,o,t,u,r,l,c,d,s,m);return e.entityCommanding=g,e.eventing=p,e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"signout":yield t.mutate({mutation:jq,variables:{userContextId:m}})}}))}))}}class Bq extends fe{constructor(){super(he.Yg.CreateEventHandler,["appsRegistryService","client","clientPreferences","commandChangeReportingService","coreSettings","loggerFactory","notificationsHandler","scenarioFactory","userBiService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,clientPreferences:i,commandChangeReportingService:a,coreSettings:o,loggerFactory:r,notificationsHandler:s,scenarioFactory:l,userBiService:c}=e;e.eventHandler=(e,d,u)=>y_({appsRegistryService:t,client:n,clientPreferences:i,commandChangeReportingService:a,commandDelegator:u,commandHandler:d,coreSettings:o,eventInput:e,loggerFactory:r,notificationsHandler:s,scenarioFactory:l,userBiService:c})}))}}const Wq={RejectIncomingCall:Ja.Yu.toastCallingRejectIncomingCall,IgnoreIncomingCall:Ja.Yu.toastCallingIgnoreIncomingCall,AcceptIncomingCallContentOnly:Ja.Yu.toastCallingAcceptIncomingCallContentOnly,AcceptIncomingCallThroughPrejoin:Ja.Yu.toastCallingAcceptIncomingCallThroughPrejoin,AcceptIncomingCallWithAudio:Ja.Yu.toastCallingAcceptIncomingCallWithAudio,AcceptIncomingCallWithVideo:Ja.Yu.toastCallingAcceptIncomingCallWithVideo,AcceptIncomingScreenshareOnlyCall:Ja.Yu.toastCallingAcceptIncomingScreenshareOnlyCall,Error:Ja.Yu.toastCallingError,NavigateToCallTab:Ja.Yu.toastCallingNavigateToCallTab,ReplyIncomingCall:Ja.Yu.toastCallingReplyIncomingCall,ResumeCallTransfer:Ja.Yu.toastCallingResumeCallTransfer,TimeOut:Ja.Yu.toastCallingTimeOut,Unknown:Ja.Yu.toastCallingUnknown,onAcceptTelemetryCleanup:Ja.Yu.toastAcceptTelemetryCleanup,onDismissTelemetryCleanup:Ja.Yu.toastDismissTelemetryCleanup},Hq={RejectIncomingCall:Ja.rA.toastRejectIncomingCall,AcceptIncomingCallContentOnly:Ja.rA.toastAcceptIncomingCall,AcceptIncomingCallThroughPrejoin:Ja.rA.toastAcceptIncomingCall,AcceptIncomingCallWithAudio:Ja.rA.toastAcceptIncomingCall,AcceptIncomingCallWithVideo:Ja.rA.toastAcceptIncomingCall,AcceptIncomingScreenshareOnlyCall:Ja.rA.toastAcceptIncomingCall,ReplyIncomingCall:Ja.rA.toastReplyIncomingCall,ResumeCallTransfer:Ja.rA.toastResumeCallTransfer},Vq=(e,t)=>{const{dataOptions:n,entity:i,entityOptions:a}=t;let o;if((null==n?void 0:n.actionType)===er.quickReply&&e.recordPanelAction({actionGesture:Ja.uS.click,actionScenario:Ja.Tk.toastActivation,actionScenarioType:Ja.Yu.quickReplyFromToast,moduleName:Ja.rA.chatToastQuickreply}),i.action===u.u.view&&e.createDatabag&&(null==n?void 0:n.toastType)){const{toastType:t}=n;o=e.createDatabag(),o.chatToastType=t}if(i.action===u.u.view&&(!(null==n?void 0:n.actionType)||o)&&(e.recordPanelAction({actionGesture:Ja.uS.click,panelRegion:Ja.Ai.toast,panelType:Ja.wh.chatToast,actionScenario:Ja.Tk.toastActivation,actionScenarioType:Ja.Yu.openChatConversationFromToast,dataBag:o}),a)){const{campaignType:t}=a;if(t){e.createDatabag&&(o=e.createDatabag(),o.identifier=t);const n={panelType:Ja.wh.SyntheticNotification,panelRegion:Ja.Ai.toast,dataBag:o};e.recordPanelView(n)}}},zq=(e,t)=>{const{entity:n}=t;n.action===u.u.view&&e.recordPanelAction({actionGesture:Ja.uS.click,panelRegion:Ja.Ai.toast,panelType:Ja.wh.channelsToast,actionScenario:Ja.Tk.toastActivation,actionScenarioType:Ja.Yu.openChannelsConversationFromToast})},qq=(e,t)=>{const{dataOptions:n,entity:i}=t;let a;if(n&&e.createDatabag){const{toastType:t}=n;a=e.createDatabag(),a.communitiesToastType=t}i.action===u.u.view&&e.recordPanelAction({actionGesture:Ja.uS.click,panelRegion:Ja.Ai.toast,panelType:Ja.wh.communitiesToast,actionScenario:Ja.Tk.toastActivation,actionScenarioType:Ja.Yu.openCommunitiesConversationFromToast,teamId:null==n?void 0:n.teamId,dataBag:a})},Gq=(e,t)=>{var n;const{dataOptions:i}=t;if(!i)return;const{actionType:a,toastType:o}=i,r=Wq[a],s=Hq[a];let l;e.createDatabag&&(l=e.createDatabag(),l.correlationId=null===(n=t.command)||void 0===n?void 0:n.correlation.id,l.callingToastType=o),r&&e.recordPanelAction({actionGesture:Ja.uS.click,panelRegion:Ja.Ai.toast,panelType:Ja.wh.callingToast,actionScenario:Ja.Tk.toastActivation,actionScenarioType:r,moduleName:s,dataBag:l}),null==l||l.dispose()};function Jq(e,t,n,a,o){const r=e.newLogger("External Command Listener","core-services-entity-commanding"),s=Qq(r,o,a);if(t.opener.addEventListener("executeEntityCommand",s),a.get(L.J.Core).enableHostCommandListener){const e=e=>{const{entity:t}=e,{type:n}=t;switch(n){case $n.calls:case $n.chats:case $n.toasts:case $n.extensions:case $n.channels:case $n.reminders:case $n.activity:case $n.campaignnotifications:case $n.communities:return s(RR(e,r),!0);case $n.signout:return function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{yield e(Object.assign(Object.assign({},AR),{payload:{entity:{type:u.p.default,action:u.u.default},command:{visibilityState:d.fe.show,stateTransition:d.su.flush}}})),t.log("HostComms:: Executed default command"),yield e(Object.assign(Object.assign({},AR),{payload:{entity:{type:u.p.signoutdialog,action:u.u.view},command:{visibilityState:d.fe.show,stateTransition:d.su.extend}}})),t.log("HostComms:: Executed signout modal command")}catch(e){throw t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: SignoutCommandFailed - ${(0,wi.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),e}}))}(s,r);default:return s(AR)}};n.loadModule("core").then((t=>{var n;t&&(null===(n=t.registerForOnExecuteCommand)||void 0===n||n.call(t,e))})).catch((e=>{var t;null===(t=r.errorToTelemetry)||void 0===t||t.call(r,`Loading core host comms module failed with: ${(0,wi.u4)(e)}`,"webclient_framework_host_comms",void 0,!0)}))}return Promise.resolve()}const Qq=(e,t,n)=>({payload:a},o=!1)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const r=t=>{var n;return null===(n=e.errorToTelemetry)||void 0===n?void 0:n.call(e,t,"webclient_framework_foundation_external_command_listener",void 0,!0)};try{if(a&&a.entity&&a.command&&a.entity.type in u.p&&a.entity.action in u.u&&a.command.visibilityState in d.fe&&a.command.stateTransition in d.su){const{entity:s,entityOptions:l,dataOptions:c,command:m,windowOptions:g}=a,{linkedEntity:p}=s;if(p){if(!p.id||!(p.type in u.p))return r(`Missing id ${!p.id} or linked entity type ${p.type}`),Promise.reject()}else s.linkedEntity=null;m.correlation=m.correlation||{},m.correlation.source=m.correlation.source||kt.D.ExternalCommand;const v=null==c?void 0:c.userContextId;e.log(`Got userContextId: ${v} from dataOptions`);const h=t(!1,v),f=1e4;(0,Fn.E)(h,f).catch((()=>{r(`waitForRenderingContextReady timed out after ${f}ms`)}));const y=yield h;e.log(`got renderingContext for userContextId: ${v}`);const b={dataOptions:c,entity:s,entityOptions:l,command:MC(m),windowOptions:g};e.log(`External command isHostComm ${o}, type ${s.type}, action ${s.action}`);const S=yield(0,RN.jW)(y.client),{enableWindowModeLayout:k}=n.get(L.J.Core);if(k&&o&&(null==S?void 0:S.userContextId)===v&&Kq(b.entity.type)&&b.command){const t=null===(i=y.clientPreferences.getPreferences("windowing"))||void 0===i?void 0:i.shouldOpenContentInNewWindow;b.command.stateTransition=t?d.su.new:d.su.flush,e.log(`Respecting user preference for toast shouldOpenContentInNewWindow ${t}`)}return((e,t,n)=>{if(!e)return void t.error("coreServicesEntityCommanding: UserBiService is not available.");const i={[u.p.chats]:Vq,[u.p.channels]:zq,[u.p.calls]:Gq,[u.p.communities]:qq}[n.entity.type];i&&i(e,n)})(y.userBiService,e,b),y.commandHandler(b)}const s=function(e){let t=`payload(${!!e})`;if(e){const{entity:n,command:i}=e;if(t+=` entity(${!!n}) command(${!!i})`,n&&i){const{type:e,action:a}=n,{visibilityState:o,stateTransition:r}=i;t+=` type(${e}) action(${a})`,t+=` visibilityState(${o}) stateTransition(${r})`}}return t}(a);return r(`Invalid payload for executeEntityCommand handler: ${s}`),Promise.reject()}catch(e){r(`Error thrown from external command listener: ${(0,wi.u4)(e)}`)}})),Kq=e=>[u.p.chats,u.p.channels].includes(e);class Yq extends fe{constructor(){super(he.Yg.CreateExternalCommandListener,["windowProvider","loggerFactory","hostCommunicationService","coreSettings","waitForRenderingContextReady"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,hostCommunicationService:i,coreSettings:a,waitForRenderingContextReady:o}=e;return Jq(n,t,i,a,o)}))}}class Xq{constructor(){this.countBasedLogs=this.initializeLogs(),this.countBasedTotalLogs=[],this.currentBuffer=0}addOperation(e,t,n){if(t&&e)if(this.countBasedLogs[t][e]){const i=this.countBasedLogs[t][e];"Request"===n?i.requestCount++:i.responseCount++}else this.countBasedLogs[t][e]={requestCount:"Request"===n?1:0,responseCount:"Response"===n?1:0,errorCount:"Error"===n?1:0}}getLatestDataAndClear(){const e=(0,a.clone)(this.countBasedLogs);return this.currentBuffer>=40&&(this.currentBuffer=0),this.countBasedTotalLogs[this.currentBuffer++]=e,this.countBasedLogs=this.initializeLogs(),e}getCompleteDataLogs(){return this.countBasedTotalLogs.length<40?this.countBasedTotalLogs:this.countBasedTotalLogs.slice(this.currentBuffer).concat(this.countBasedTotalLogs.slice(0,this.currentBuffer))}initializeLogs(){return{subscription:{},mutation:{},query:{}}}}class Zq extends fe{constructor(){super(he.Yg.CreateGraphQlOpsService,["coreSettings"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableGraphQlOpsCount:t,enableGraphQlOpsCountInConsole:n}=e.coreSettings.get(L.J.Core);let i;if(t&&(i=new Xq,e.graphqlOpsCountService=i),n){const e=window;e.hooks||(e.hooks={}),e.hooks.graphQlOpsCountServiceHook=i}}))}}var eG=n(989553);class tG{constructor(){this.stats={},this.counter=0,this.tracked={}}getTelemetry(){const e=this.stats;return this.stats={},e}trackCall(e,t){this.getOrCreateStore(e).methodCalls[t]++}trackSubscribeEvent(e){this.getOrCreateStore(e).subscribeEvents++}markReadStart(e,t){return this.mark(nG("read",e,t))}markReadEnd(e){this.markEnd(e)}markReadError(e){this.markError(e)}markDiffStart(e,t){return this.mark(nG("diff",e,t))}markDiffEnd(e){this.markEnd(e)}markDiffError(e){this.markError(e)}markWriteStart(e,t){return this.mark(nG("write",e,t))}markWriteEnd(e){return this.markEnd(e)}markWriteError(e){this.markError(e)}markDuplicateWrite(e,t,n){const i=nG("writeDuplicate",e,t);this.update("success",i,n)}mark(e){const t=""+this.counter++;return this.tracked[t]=e,t}markEnd(e){const t=this.tracked[e];if(delete this.tracked[e],t){const e=performance.now()-t.start;return this.update("success",t,e),e}return 0}markError(e){const t=this.tracked[e];if(delete this.tracked[e],t){const e=performance.now()-t.start;this.update("error",t,e)}}update(e,t,n){const i=this.getOrCreateStore(t.storeType)[t.kind];i.count++,"error"===e&&i.errors++,i.min=Math.min(null!==i.min?i.min:Number.MAX_VALUE,n),(null==i.max||i.max<n)&&(i.max=n,i.slowestOperation=t.operationName),i.mean=null!==i.mean?(i.mean+n)/2:n}getOrCreateStore(e){let t=this.stats[e];return t||(t={type:e,read:iG(),write:iG(),diff:iG(),writeDuplicate:iG(),subscribeEvents:0,methodCalls:{[Kx.z.query]:0,[Kx.z.watchQuery]:0,[Kx.z.mutate]:0,[Kx.z.subscribe]:0,[Kx.z.readQuery]:0,[Kx.z.writeQuery]:0,[Kx.z.readFragment]:0,[Kx.z.writeFragment]:0}},this.stats[e]=t),t}}function nG(e,t,n){return{storeType:t,kind:e,operationName:"string"==typeof n?n:(0,eG.Ok)(n)||"unknown",start:performance.now()}}function iG(){return{min:null,max:null,mean:null,count:0,errors:0,slowestOperation:null}}class aG extends fe{constructor(){super(he.Yg.CreateGraphQLStoreStatsReporterService,["coreSettings","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e.loggerFactory.newLogger("CreateGraphQLStoreStatsReporterServiceTask","core-services-tasks"),{enableGraphQLStoreStatsReporterService:n}=e.coreSettings.get(L.J.Core);n&&(e.graphqlStoreStatsReporterService=new tG,t.log("GraphQLStoreStatsReporterService initialized"))}))}}var oG=n(358880);class rG extends fe{constructor(){super(he.Yg.CreateGtmRegistry,["authenticationService","discover","coreSettings","loggerFactory","platformService","config"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.gtmRegistry=new oG.a(e.authenticationService,e.discover,e.coreSettings,e.loggerFactory,e.platformService,e.config)}))}}class sG{constructor(e,t,n,i,a){this.commandChangeReportingService=e,this.coreSettings=t,this.hostCommunicationService=n,this.scenarioFactory=i,this.logger=a.newLogger("HostCommandingListener","core-services-entity-commanding")}init(){this.initCommandChangeReportingSubscription()}destroy(){var e;null===(e=this.commandChangeReportingSubscription)||void 0===e||e.unsubscribe(),this.commandChangeReportingSubscription=void 0}initCommandChangeReportingSubscription(){this.commandChangeReportingSubscription&&this.destroy(),this.commandChangeReportingSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>{e.type===wC.B.NotHandled&&e.context.entityCommand&&this.sendHostEvent(e.context.entityCommand)}))}sendHostEvent(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){!!this.coreSettings.get(L.J.Core).enableCommandToHostCommService&&(yield QR(e,this.hostCommunicationService,this.logger,this.scenarioFactory))}))}}class lG{constructor(){this.id=he.Yg.CreateHostCommandingListener}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,hostCommunicationService:o}=ax("CreateHostCommandingListenerTask",e,"commandChangeReportingService","coreSettings","loggerFactory","scenarioFactory","hostCommunicationService");new sG(t,n,o,a,i).init()}))}}var cG=n(275391);const dG={web:{loadModule:(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return"auth"===e?(e=>({signInOnElectron:function(t){const n={options:t};return Promise.resolve(e.opener.postMessage("login",n))}}))(t):"calling"===e?(e=>({signalCallConnectionComplete:function(){return Promise.resolve(e.opener.postMessage("signalCallConnectionComplete",{}))}}))(t):"callingperf"===e?(e=>({callingPerfStatsAvailable:function(t){const n={callingPerfStats:t};return Promise.resolve(e.opener.postMessage("callingPerfStats",n))}}))(t):"core"===e?(e=>({registerForOnSubNavHoverChanged:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("showOrHideSubNav",n),()=>{e.opener.removeEventListener("showOrHideSubNav",n)}},setCoreInitialized:function(){return Promise.resolve(e.opener.postMessage("coreInitialized",{}))}}))(t):"embedcalendar"===e?(e=>({sendHeightOnResize:function(t){const n={embedCalendarHeight:t};return Promise.resolve(e.opener.postMessage("sendHeightOnResize",n))},sendCalendarScenarioStatus:function(t,n){const i={ScenarioStatus:t,AgendaViewEndState:n};return Promise.resolve(e.opener.postMessage("sendCalendarScenarioStatus",i))}}))(t):"embedclient"===e?(e=>({HideCoreIFrame:function(){return Promise.resolve(e.opener.postMessage("HideCoreIFrame",{}))},ShowCoreIFrame:function(){return Promise.resolve(e.opener.postMessage("ShowCoreIFrame",{}))}}))(t):"search"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):"surveyform"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):void 0})),definedModules:["auth","calling","callingperf","core","embedcalendar","embedclient","search","surveyform"]},edge:{loadModule:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return"appdevicepermission"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Appdevicepermission})):"appswitcher"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Appswitcher})):"auth"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Auth})):"bluetoothproximity"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Bluetoothproximity})):"brb"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Brb})):"calling"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Calling})):"callingcrosscloud"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Callingcrosscloud})):"core"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Core})):"customvideobackground"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Customvideobackground})):"ecs"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Ecs})):"embedcalendar"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Embedcalendar})):"etw"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Etw})):"fileopenpreference"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Fileopenpreference})):"files"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Files})):"globalshortcuts"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Globalshortcuts})):"heartbeat"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Heartbeat})):"hid"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Hid})):"hostcapabilities"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Hostcapabilities})):"logscollection"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Logscollection})):"m365link"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.M365link})):"moduleloader"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Moduleloader})):"officeintegration"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Officeintegration})):"osutils"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Osutils})):"profiler"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Profiler})):"publicpreview"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Publicpreview})):"scenario"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Scenario})):"sharetarget"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Sharetarget})):"taskbar"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Taskbar})):"telemetry"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Telemetry})):"tmapolicy"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Tmapolicy})):"toasts"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Toasts})):"updates"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Updates})):"userdataxcloud"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Userdataxcloud})):"userpreferences"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Userpreferences})):"vdi"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Vdi})):"webclientstates"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Webclientstates})):"windowcontrols"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Windowcontrols})):void 0})),definedModules:["appdevicepermission","appswitcher","auth","bluetoothproximity","brb","calling","callingcrosscloud","core","customvideobackground","ecs","embedcalendar","etw","fileopenpreference","files","globalshortcuts","heartbeat","hid","hostcapabilities","logscollection","m365link","moduleloader","officeintegration","osutils","profiler","publicpreview","scenario","sharetarget","taskbar","telemetry","tmapolicy","toasts","updates","userdataxcloud","userpreferences","vdi","webclientstates","windowcontrols"]},electron:{loadModule:(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return"appdevicepermission"===e?(e=>({registerForHasDevicePermissions:function(t){const n=(e={})=>{t(e.eventId,e.webContentsId,e.permissionType,e.guid)};return e.opener.addEventListener("hasDevicePermissions",n),()=>{e.opener.removeEventListener("hasDevicePermissions",n)}},resolveDevicePermission:function(t,n,i){const a={message:t,permission:n,guid:i};return Promise.resolve(e.opener.postMessage("hasDevicePermissionsCallback",a))}}))(t):"auth"===e?(e=>({signInOnElectron:function(t){const n={options:t};return Promise.resolve(e.opener.postMessage("login",n))}}))(t):"callingperf"===e?(e=>({callingPerfStatsAvailable:function(t){const n={callingPerfStats:t};return Promise.resolve(e.opener.postMessage("callingPerfStats",n))}}))(t):"core"===e?(e=>({registerForOnSubNavHoverChanged:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("showOrHideSubNav",n),()=>{e.opener.removeEventListener("showOrHideSubNav",n)}},setCoreInitialized:function(){return Promise.resolve(e.opener.postMessage("coreInitialized",{}))},notifyCoreStateChanged:function(t){const n={childSettings:t};return Promise.resolve(e.opener.postMessage("updateWindowState",n))}}))(t):"embedcalendar"===e?(e=>({sendHeightOnResize:function(t){const n={embedCalendarHeight:t};return Promise.resolve(e.opener.postMessage("sendHeightOnResize",n))},sendCalendarScenarioStatus:function(t,n){const i={ScenarioStatus:t,AgendaViewEndState:n};return Promise.resolve(e.opener.postMessage("sendCalendarScenarioStatus",i))}}))(t):"hostedwebcontentlog"===e?(e=>({registerForReportAProblemLogUploadEvent:function(t){const n=(e={})=>{t(e.eventId)};return e.opener.addEventListener("reportAProblemLogUpload",n),()=>{e.opener.removeEventListener("reportAProblemLogUpload",n)}}}))(t):"m365link"===e?(e=>({getM365Link:function(t,n){const i={url:t,context:n};return e.opener.requestMessage("getM365Link",i)}}))(t):"search"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):"surveyform"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}},uploadDesktopLogsToOds:function(t,n){const i={logFilePath:t,sasToken:n};return Promise.resolve(e.opener.postMessage("uploadDesktopLogsToOds",i))},collectDesktopLogs:function(){return e.opener.requestMessage("collectDesktopLogs",{})}}))(t):"windowcontrols"===e?(e=>({swapMeetingRoomFrontOfRoomWindows:function(){return Promise.resolve(e.opener.postMessage("swapMeetingRoomFrontOfRoomWindows",{}))},getScreenshots:function(t,n){const i={width:t,height:n};return e.opener.requestMessage("getScreenshots",i)}}))(t):void 0})),definedModules:["appdevicepermission","auth","callingperf","core","embedcalendar","hostedwebcontentlog","m365link","search","surveyform","windowcontrols"]}};var uG;!function(e){e.Sync="Sync",e.Async="Async",e.Event="Event"}(uG||(uG={}));var mG=n(903527);class gG{constructor(){this._syncRoundTripTimeThresholdMs=16,this._asyncRoundTripTimeThresholdMs=500,(0,mG.pG)(),this._stats={syncMethodsTotal:0,asyncMethodsTotal:0,eventsTotal:0,syncOutliersByRoundTripTime:[],asyncOutliersByRoundTripTime:[]},this._pendingMatches=new Map,this._outlierCallbacks=[],this._loggerEnabled=!1,this.registerCallback()}getStats(){return this._stats}addOutlierCallback(e){this._outlierCallbacks.push(e)}setLogger(e){this._logger=e}getLogger(){return this._logger}enableLogger(){this._loggerEnabled=!0}disableLogger(){this._loggerEnabled=!1}registerCallback(){cG.HostBridge.registerForHostMessageNotification((e=>this.onMessage(e)))}onMessage(e){var t;const n=Date.now(),i=this.buildPIEMessage(e,n);i&&(this.updateTotals(i),this.calculateRoundTripTime(i),this._loggerEnabled&&(null===(t=this._logger)||void 0===t||t.log(i)))}buildPIEMessage(e,t){if(!e.messageName)return null;const[n,i]=e.messageName.split(".");let a;if(e.isEvent)a=uG.Event;else if(e.isAsync)a=uG.Async;else{if(!e.syncId)return null;a=uG.Sync}return{messageName:i,messageId:e.messageId,namespace:n,timestamp:t,type:a}}updateTotals(e){e.type===uG.Sync?this._stats.syncMethodsTotal++:e.type===uG.Async?this._stats.asyncMethodsTotal++:this._stats.eventsTotal++}calculateRoundTripTime(e){if(e.type===uG.Event||!e.messageId)return;const t=this._pendingMatches.get(e.messageId);t?(this.onMatch(e.timestamp,t),this._pendingMatches.delete(e.messageId)):this._pendingMatches.set(e.messageId,e)}onMatch(e,t){const n=e-t.timestamp;let i,a;if(t.type===uG.Async?(i=this._asyncRoundTripTimeThresholdMs,a=this._stats.asyncOutliersByRoundTripTime):(i=this._syncRoundTripTimeThresholdMs,a=this._stats.syncOutliersByRoundTripTime),n>=i){t.roundTripTime=n,a.push(t);for(const e of this._outlierCallbacks)e(t)}}}class pG{constructor(e){this._pieStatsProvider=e,this._enabled=!1}enable(){this._enabled=!0}disable(){this._enabled=!1}isEnabled(){return this._enabled}setScenarioFactory(e){this._scenarioFactory=e}}class vG{constructor(){this._count=0}log(e){const t=`json-logger-entry-${this._count.toString()}`;sessionStorage.setItem(t,JSON.stringify(e)),this._count++}getCount(){return this._count}reset(){this._count=0}setLogLocation(e){this._logLocation=e}getLogLocation(){return this._logLocation}}class hG extends pG{constructor(e){super(e),this._jsonLogger=new vG,this._pieStatsProvider.setLogger(this._jsonLogger)}enable(){super.enable(),this._pieStatsProvider.enableLogger()}disable(){super.disable(),this._pieStatsProvider.disableLogger(),this._jsonLogger.getCount()>0&&this.writeSessionStorageToJsonFile(),this._jsonLogger.reset()}writeSessionStorageToJsonFile(){const e=[];let t=[];for(const[n,i]of Object.entries(sessionStorage))n.includes("json-logger-entry-")&&(t.push(JSON.parse(i)),e.push(n));t=t.sort(((e,t)=>e.timestamp-t.timestamp));const n=document.createElement("a"),i=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(t))}`;n.setAttribute("href",i);const a=`${(new Date).toISOString()}-DataCaptureMonitorRawData.json`;n.setAttribute("download",a),this._jsonLogger.setLogLocation(a),document.body.appendChild(n),n.click(),n.remove();for(const t of e)sessionStorage.removeItem(t)}}class fG extends pG{constructor(e){super(e),this._pieStatsProvider.addOutlierCallback((e=>this.onOutlier(e)))}onOutlier(e){if(!this._enabled||!this._scenarioFactory)return;const t=this._scenarioFactory.newScenario(it.RG.TrafficCopPIEMonitor),n={messageName:e.messageName,roundTripTimeMs:e.roundTripTime,messageId:e.messageId,namespace:e.namespace,messageType:e.type.toString()};t.stop(n)}}const yG=(e,t,n=!1)=>new bG(dG.edge,e,void 0,t,n,!0);class bG{constructor(e,t,n,i,a=!1,o=!1){this._internalLoadDefinition=e,this._logger=t,this._host=n,this._coreSettings=i,this._enableScenarioCache=a,this._enablePIEMonitors=o,this._hostCommsScenarioFactory=SG(this._enableScenarioCache),this._enablePIEMonitors&&(this._pieStatsProvider=new gG,this._trafficCopPIEMonitor=new fG(this._pieStatsProvider),this._dataCapturePIEMonitor=new hG(this._pieStatsProvider),this.subscribeForMonitorObservable())}loadModule(e){var t,n,a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this._hostCommsScenarioFactory.newScenario("host_comms_load_module");let r;try{this._logger.log(`Loading module: ${e}`),r=yield this._internalLoadDefinition.loadModule(e,null!==(t=this._host)&&void 0!==t?t:void 0)}catch(t){throw null===(a=(n=this._logger).errorToTelemetry)||void 0===a||a.call(n,"Error while loading module","webclient_framework_host_comms",void 0,!0),null==i||i.fail({reason:"Error while loading module",message:e}),t}return!r&&(null===(o=this._internalLoadDefinition.definedModules)||void 0===o?void 0:o.includes(e))?(this._logger.error(`Failed to load module. Module, undefined ${e}`),null==i||i.fail({reason:"Failed to load module",message:e})):(this._logger.log(`Module "${e}" loaded`),null==i||i.stop({message:e,reason:e})),r}))}setScenarioFactory(e){var t;this._hostCommsScenarioFactory.setScenarioFactory(e),null===(t=this._trafficCopPIEMonitor)||void 0===t||t.setScenarioFactory(e)}getPIEMonitorStates(){var e,t;return{dataCaptureEnabled:this._enablePIEMonitors&&!!(null===(e=this._dataCapturePIEMonitor)||void 0===e?void 0:e.isEnabled()),trafficCopEnabled:this._enablePIEMonitors&&!!(null===(t=this._trafficCopPIEMonitor)||void 0===t?void 0:t.isEnabled())}}subscribeForMonitorObservable(){var e,t;const n=null===(t=null===(e=this._coreSettings)||void 0===e?void 0:e.getObservable)||void 0===t?void 0:t.call(e,L.J.Core,["pieMonitorSettings"]);null==n||n.subscribe((e=>{var t,n,i,a;if(!e.pieMonitorSettings)return;const{enabled:o,mode:r}=e.pieMonitorSettings;if(!o)return null===(t=this._trafficCopPIEMonitor)||void 0===t||t.disable(),void(null===(n=this._dataCapturePIEMonitor)||void 0===n||n.disable());r===vs.$e.DataCapture?null===(i=this._dataCapturePIEMonitor)||void 0===i||i.enable():r===vs.$e.TrafficCop&&(null===(a=this._trafficCopPIEMonitor)||void 0===a||a.enable())}))}}const SG=e=>{let t;const n=[];return{newScenario:i=>{if(t)return t.newScenario(i);if(e){const e=wG(i);return n.push(e),e}},setScenarioFactory:e=>{t=e,kG(n,t)}}},kG=(e,t)=>{let n=e.pop();for(;n;){const i=t.newScenario(n.name,{startTime:n.time});"failed"===n.status&&i.fail(Object.assign({cached:!0},n.result)),"stopped"===n.status&&i.stop(Object.assign({cached:!0},n.result)),n=e.pop()}},wG=e=>{let t,n;return{name:e,time:Date.now(),fail:e=>{n="failed",t=e},stop:e=>{n="stopped",t=e},get result(){return t},get status(){return n}}};class CG extends fe{constructor(){super(he.Yg.CreateHostCommunication,["coreSettings","loggerFactory","platformService","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,platformService:i,windowProvider:a}=e;e.hostCommunicationService=((e,t,n,i)=>{const{clientType:a}=e.config,o=i.newLogger("HostComms","core-services-host-communication");return o.log(`Create HostComms for ${a}`),a===Pe.Bh.Maglev&&t.get(L.J.Core).enablePieCommunication?yG(o,t,!0):a===Pe.Bh.Desktop?new bG(dG.electron,o,n,t,!0):new bG(dG.web,o,n,t,!0)})(i,t,a,n)}))}}var _G=n(946458);class TG extends fe{constructor(){super(he.Yg.CreateI18n,["i18NextWrapper"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.i18n=new _G.o(e.i18NextWrapper)}))}}var IG=n(347258),EG=n(102030),NG=n(430997),AG=n(470115),FG=n(422327),DG=n(329384),RG=n(870444);function xG(e){return e.navigator.language||he.ZW}function MG(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.loadModule("osutils"),i=yield null===(t=null==n?void 0:n.getAppLocale)||void 0===t?void 0:t.call(n);return null==i?void 0:i.localeName}))}function OG(e,t,n){const i=PG(e,t,n);return(0,RG.vw)(i).locale}function PG(e,t,n,i){var a;const o=function({localeCode:e,language:t,setting:n}){if(e)return e;if(t)return t.toLowerCase();if(!n)return;let i;if(Array.isArray(n)){for(const e of n)if(e.startsWith("localeCode:")){i=e;break}}else n.startsWith("localeCode:")&&(i=n);if(i)return i.split(":")[1];return}(t.state.getSearchState()||{});if(o)return o;if(i&&(null===(a=null==e?void 0:e.navigator)||void 0===a?void 0:a.language))return e.navigator.language;const r=e.getHostedWindowContext(),s="localeCode";return r&&r.localeCode?(e.localStorage.setItem(s,r.localeCode),r.localeCode):e.localStorage.getItem(s)||n||he.ZW}const LG=()=>{};class UG{get locale(){return this._locale}get osLocaleInfo(){return this._osLocaleInfo}constructor(e,t,n,i,a,o,r,s=n.config.localeCode,l,c){this.preloadNamespaces=e,this.coreSettings=i,this.staticNamespaces=o,this.originLocale=s,this.userLanguage=l,this.osLocale=c,this.notLoadedNamespacesWithErrors=[];const d=t("i18n","services-io-browser-i18n"),u="pseudo"===s||"pseudo_rtl"===s;let m=(0,DG.Ax)(s,a,r);const g=L.J.Core&&this.coreSettings.get(L.J.Core);g&&g.useEnglishOnlyUI&&(m="en-us");const p=this.initPlugins(t,u,m,d);this.namespaceLoader=(0,AG.v)(this,t,i),this.i18next=p,this.latestTranslation={},this.originLocale=s,this.logger=d,this.scenarioFactory=a,this.osPlatform=n.config.osPlatform,this.initOsDateTimeLocalization(i,a,n,d),this.initI18next(m,a,d),this._locale=m,this.loadLocales()}setOSLocaleInfo(e){this._osLocaleInfo=e}setLocale(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=L.J.Core&&this.coreSettings.get(L.J.Core);t&&t.useEnglishOnlyUI&&(e="en-us");const n=(0,DG.um)(this.scenarioFactory,e);this.i18next.changeLanguage(n),this._locale=n,yield this.loadLocales()}))}initPlugins(e,t,n,i){const a=[new EG.Z(e,{filterRegex:/.*\_mf$/})];if(t){const e=new NG.Z;a.push(e),n="en-us"}DG.cL.locale=n;let o=IG.Z.createInstance();for(const e of a)o=o.use(e);const r=this.getInitOptions(n,a);return o.init(r).catch((e=>i.error("The i18next initialization failed",e))),o}removeDefaultI18nNamespaces(e){var t;("string"==typeof this.i18next.options.ns?[this.i18next.options.ns]:null!==(t=this.i18next.options.ns)&&void 0!==t?t:[]).forEach((t=>this.i18next.removeResourceBundle(e,t))),this.i18next.setDefaultNamespace("")}setMissingHandlers(e,t){this.i18next.options.saveMissing=!0,this.i18next.options.missingKeyHandler=(n,i,a)=>{this.missingKeyHandler(e,t,this.i18next,n,i,a)},this.i18next.options.missingInterpolationHandler=n=>this.missingInterpolationHandler(e,t,this.latestTranslation)}initI18next(e,t,n){this.removeDefaultI18nNamespaces(e),this.setMissingHandlers(t,n)}initOsDateTimeLocalization(e,t,n,i){const a=L.J.Host&&e.get(L.J.Host),o=a&&a.enableOsDateTimeFormatting;o&&n.config.getLocaleInfoAsync().then((e=>{if(null==e?void 0:e.regionalFormat){const t="_",n="-";e.regionalFormat=e.regionalFormat.split(t).join(n).toLowerCase()}o&&this.setOSLocaleInfo(e)})).catch((e=>{var n;null===(n=i.errorToTelemetry)||void 0===n||n.call(i,`getLocaleInfoAsync failed for ${JSON.stringify(e)}`,"telemetry_i18next_wrapper");t.newScenario(it.RG.I18nGetLocaleInfo).fail({errors:JSON.stringify(["getLocaleInfoAsync failed"])})}))}loadLocales(){const e=[];this.staticNamespaces&&this.namespaceLoader.loadStatic(this.staticNamespaces);for(const t of this.preloadNamespaces){const n=this.namespaceLoader.load(t);n.promise&&e.push(n.promise.catch(LG))}return Promise.all(e)}missingKeyHandler(e,t,n,i,a,o){const r="string"==typeof n.options.ns?[n.options.ns]:n.options.ns||[""],s=r.indexOf(a)<0;let l="",c="";if(s&&(e=>this.notLoadedNamespacesWithErrors.indexOf(e)>=0)(a))return;s?(l=`The namespace "${a}" has not been loaded. The only loaded namespaces: "${r.join(", ")}"`,c=o,this.notLoadedNamespacesWithErrors.push(a)):l=`The key "${o}" doesn't exist in namespace "${a}" for locale "${i[0]}"`;e.newScenario(it.RG.I18nMissingKeyHandler).stop({message:l,origin:c}),t.error(l)}missingInterpolationHandler(e,t,n){var i;const a=`Undefined interpolation for namespace "${n.namespace}" and key "${n.key}"`;e.newScenario(it.RG.I18nMissingInterpolationHandler).stop({message:a}),null===(i=t.errorToTelemetry)||void 0===i||i.call(t,a,"telemetry_i18next_wrapper")}getInitOptions(e,t){return{initImmediate:!1,interpolation:{escapeValue:!1},react:{bindI18n:"languageChanged",bindI18nStore:"",nsMode:"default",transKeepBasicHtmlNodesFor:["br","strong","i","b","u","p"]},lng:e,fallbackLng:e,load:"currentOnly",lowerCaseLng:!0,postProcess:t.filter((e=>"postProcessor"===e.type)).map((e=>e.name))}}}class jG extends fe{constructor(){super(he.Yg.CreateI18NextWrapper,["config","coreSettings","coreSettingsContext","hostCommunicationService","loggerFactory","platformService","routingServices","scenarioFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=function(e,t,n,i,a,o,r,s){const{windowProvider:l,routingServices:c,hostCommunicationService:d}=o,u=(0,FG.pf)(l),m=L.J.Core&&i.get(L.J.Core),g=m&&m.includeBrowserInLocaleDetermination,p=PG(l,c,u.localeCode,!!g),v=xG(l),h=d?MG(d):Promise.resolve(void 0);return new UG(e,t,n,i,a,r,s,p,v,h)}(e.config.preloadedI18nNamespaces||[],e.loggerFactory.newLogger,e.platformService,e.coreSettings,e.scenarioFactory,{windowProvider:e.windowProvider,routingServices:e.routingServices,hostCommunicationService:e.hostCommunicationService},e.config.staticNamespaces,e.config.locale);e.coreSettingsContext.setLocale(t.locale),e.i18NextWrapper=t}))}}class $G{constructor(e){this.cache=new Map,this.lastId=0,this.maxCacheSize=e.maxCacheSize,this.cachePruningPercent=e.cachePruningPercent}add(e){if(this.maxCacheSize<=0)return;let t=this.cache.get(e);if(t)return void(t.time=this.lastId++);const n=new Image;n.src=e,t={image:n,time:this.lastId++},this.cache.set(e,t),this.cache.size>this.maxCacheSize&&this.prune()}setCapacity(e){this.maxCacheSize=e.maxCacheSize,this.cachePruningPercent=e.cachePruningPercent,this.cache.size>this.maxCacheSize&&this.prune()}clear(){this.cache.clear(),this.lastId=0}has(e){return this.cache.has(e)}get size(){return this.cache.size}prune(){const e=[];this.cache.forEach(((t,n)=>{e.push({time:t.time,url:n})})),e.sort(((e,t)=>e.time-t.time));let t=Math.ceil(this.maxCacheSize*this.cachePruningPercent);t=Math.max(this.cache.size-this.maxCacheSize,t);for(let n=0;n<t;n++){const t=e[n];this.cache.delete(t.url)}}}class BG extends fe{constructor(){super(he.Yg.CreateImageCaches,["coreSettings"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t}=e,n=new $G({maxCacheSize:0,cachePruningPercent:.15});e.avatarImageCache=n;const i=null==t?void 0:t.getObservable(L.J.ImageCache),a=null==i?void 0:i.subscribe((e=>{let t=0;"number"==typeof(null==e?void 0:e.avatarImageCacheMaxCapacity)&&(t=e.avatarImageCacheMaxCapacity),n.setCapacity({maxCacheSize:t,cachePruningPercent:.15})}));return()=>a.unsubscribe()}))}}class WG extends fe{constructor(){super(he.Yg.CreateInactiveGC,["clientState","coreSettings","profilerService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,coreSettings:n,profilerService:a}=e;t.observe().subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e===yC.pk.Inactive||e===yC.pk.LongInactive){const{clearConsoleInInactive:e,enableGCInInactive:t}=n.get(L.J.Core);e&&(console.clear(),console.log('Console cleared on going to Inactive/LongInactive. When debugging, you can override this with disabling "clearConsoleInInactive" FF')),t&&a.requestTriggerGC()}}))))}))}}class HG extends fe{constructor(){super(he.Yg.LeakDetector,["loggerFactory","coreSettings","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,windowProvider:n,coreSettings:i}=e,a=t.newLogger("CreateLeakDetectorTask","core-services-tasks"),{enableObjectLeakDetection:o}=i.get(L.J.Core);if(a.log(`enableObjectLeakDetection ${o}`),!o)return;if(!n.WeakRef)return void a.log("windowProvider?.WeakRef is undefined");const r=new _E.E(i,n);e.leakDetectorService=r,a.log("leakDetectorService instantiated"),n.opener.addEventListener(n_.rY.GetLeaks,(()=>this.sendLeaksStats(n,r,a))),this.initTestingMode(n,r,i.get(L.J.Host))}))}sendLeaksStats(e,t,n){let i=0;const a=e.parent;a.getAndClearAriTelemetry=void 0,a.getLeakDetectorService=void 0,a.gc?(n.log("executing gc() on experience renderer"),a.gc(),i=1e4):n.warn("gc() not defined on experience renderer");let o=0;o=e.setTimeout((()=>{e.clearTimeout(o);const n={leaks:t.getReachableObjectCountsByKey(),leaksTrackingInfo:t.getReachableObjectsTrackingInfo()};e.opener.postMessage(n_.rY.GetLeaks,n)}),i)}initTestingMode(e,t,n){const{userType:i}=n;i&&i.indexOf("test")>-1&&!("getLeakDetectorService"in e.parent)&&(e.parent.getLeakDetectorService=()=>t)}}class VG{constructor(e,t){this._scheduler=e,this._logger=t.newLogger("SchedulerWithValidator","core-services-scheduling"),this._uniqueJobIds=new Set}validateAndSchedule(e,t,n){const{id:i,runOncePerId:a}=t;if(this._uniqueJobIds.has(i)){if(a)return this._logger.debug(`Job by ID ${i} has already run once.`),DI.o_}else this._uniqueJobIds.add(i);return this._scheduler.schedule(e,t,n)}}var zG,qG,GG,JG,QG,KG,YG;function XG(e){if(e.has(l_.c4.ExperienceWarm))return;const t=eJ(e,l_.yU.NavigationIntentExecuted);let n=!1;t&&(n=!t.shouldRenderContent||function(e){var t;const n=eJ(e,l_.FV.LayoutRenderComplete);return null!==(t=n&&(null==n?void 0:n.mainEntityType)!==C.pyR.pearnotdefaultapp)&&void 0!==t&&t}(e));const i=Array.from(e.values()).pop();return n&&(null==i?void 0:i.context)}function ZG(e,t){if(e.has(l_.c4.UserWarm))return;let n=!1;if(tJ(e))if(t)if(function(e){return!!eJ(e,l_.FV.LayoutRenderCancelled)}(e)||nJ(e))n=!0;else{const t=eJ(e,l_.yU.NavigationIntentExecuted);t&&!t.shouldRenderContent&&(n=!0)}else n=!0;const i=Array.from(e.values()).pop();return n&&(null==i?void 0:i.context)}function eJ(e,t){const n=e.get(t);return n&&n.context}function tJ(e){return e.has(l_.yU.UserAuthenticated)&&e.has(l_.yU.UserConsentedToConsumeResources)}function nJ(e){const t=eJ(e,l_.FV.LayoutRenderComplete);if(t){const{mainEntityType:e}=t;if(!e||-1===[C.pyR.identity,C.pyR.tflfre,C.pyR.pearnotdefaultapp].indexOf(e))return!0}return!1}function iJ(e,t){let n=[];const i=e[t.state];return i&&(n=n.concat(i({context:t.context}))),n}function aJ(e,t,n){let i;if(e){const{app:a,state:o,callback:r}=e;let s=r();if(s){const e=s.length;if(e>0){t.log(`App:${a.manifest.id} supports the state: ${o}, job count returned from the app: ${e}.`),s=s.filter((e=>function(e,t,n){if(n===zG.start)return!1;const i=t&&t[n];if(Array.isArray(i))return i.indexOf(e)>-1;if([zG.onPreWarm,zG.onExperienceWarm,zG.onUserWindowPreWarm].includes(n))return!1;return!0}(e.id,n,o)));const i=s.length;i!==e&&t.log(`Jobs filtering by permissions took place. Job count is now: ${i}`)}i={state:o,jobs:s}}}return i}function oJ({app:e,currentChanges:t,change:n,getCachedSupportSet:a,sessionContext:o}){const r=function(e,t){if(t.has(l_.c4.Initialized)||e.type===l_.yU.ExperienceIdleStateChanged)return;const n=eJ(t,l_.yU.ActiveEntitiesResolved);return tJ(t)&&n?n:void 0}(n,t);if(r)return{app:e,state:zG.onPreInit,callback:()=>function(e,t,n){let a;const o=n(),{entities:r,target:s}=t,l=(0,i.__rest)(t,["entities","target"]);for(const t of r)if(t&&o&&o.has(t.type)){a=a||[];const n=iJ(e,{context:Object.assign(Object.assign({},l),{entity:t}),state:zG.onPreInit});a=a.concat(n)}return a}(e,Object.assign(Object.assign({},o),r),a)}}function rJ({app:e,currentChanges:t,sessionContext:n}){const i=XG(t);if(i){const t=zG.onExperienceWarm;return{app:e,state:t,callback:()=>iJ(e,{context:Object.assign(Object.assign({},n),i),state:t})}}}function sJ({app:e,currentChanges:t,sessionContext:n,change:i}){if(i.context.isIdle&&tJ(t)){const t=zG.onExperienceIdle;return{app:e,state:t,callback:()=>iJ(e,{context:Object.assign({},n),state:t})}}}function lJ({app:e,currentChanges:t,sessionContext:n}){const i=function(e){if(e.has(l_.c4.WindowWarm))return;let t=!1;nJ(e)&&(t=!0);const n=Array.from(e.values()).pop();return t&&(null==n?void 0:n.context)}(t);if(i){const t=zG.onUserWindowPreWarm;return{app:e,state:t,callback:()=>iJ(e,{context:Object.assign(Object.assign({},n),i),state:t})}}}function cJ({appId:e,jobState:t,change:n,currentChanges:i,logger:a}){let o;if(t){const{jobs:r,state:s}=t,l=function(e,t){let n;switch(e){case zG.start:n=l_.c4.Started;break;case zG.onPreInit:n=l_.c4.Initialized;break;case zG.onExperienceWarm:n=l_.c4.ExperienceWarm;break;case zG.onPreWarm:n=l_.c4.UserWarm;break;case zG.onExperienceIdle:n=l_.c4.ExperienceIdle;break;case zG.onUserWindowPreWarm:n=l_.c4.WindowWarm}return function(e,{correlationId:t,windowId:n,context:{target:i}}){return{type:e,context:{target:i},correlationId:t,windowId:n}}(n,t)}(s,n);i.set(l.type,l),a.debug(`Life Cycle - Change type: ${n.type}, initiated by: ${n.context.target}. Resulted in app:${e} transition to state: ${s} and job count: ${r.length}`),o={change:l,jobs:r}}return o}function dJ({application:e,appLifeCyclePermissions:t,change:n,currentChanges:i,getNextState:a,getCachedSupportSet:o,logger:r,sessionContext:s}){const l=aJ(a({currentChanges:i,app:e,change:n,getCachedSupportSet:o,sessionContext:s}),r,t);return cJ({appId:e.manifest.id,jobState:l,change:n,currentChanges:i,logger:r})}!function(e){e.start="start",e.onPreInit="onPreInit",e.onExperienceWarm="onExperienceWarm",e.onPreWarm="onPreWarm",e.onExperienceIdle="onExperienceIdle",e.onUserWindowPreWarm="onUserWindowPreWarm"}(zG||(zG={})),function(e){e.Experience="Experience"}(qG||(qG={})),function(e){e.Window="Window"}(GG||(GG={})),function(e){e.FirstUserAtBoot="FirstUserAtBoot",e.Other="Other"}(JG||(JG={}));class uJ{constructor(e,t,n){this._scope=e,this._appLifeCyclePermissions=t,this._sessionContext=n,this._currentChanges=new Map,this._logger=n.loggerFactory.newLogger("ApplicationLifeCycleManager","core-services-life-cycle")}get managedId(){var e;return null===(e=this._application)||void 0===e?void 0:e.manifest.id}manageApplication(e){this._application=e}onChange(e){const t=[];if(!this._application)return t;this._currentChanges.set(e.type,e);const n=function(e){switch(e){case qG.Experience:return[rJ];case GG.Window:return[lJ];default:return[oJ,(t=e===JG.FirstUserAtBoot,({app:e,currentChanges:n,sessionContext:i})=>{const a=ZG(n,t);if(a){const t=zG.onPreWarm;return{app:e,state:t,callback:()=>iJ(e,{context:Object.assign(Object.assign({},i),a),state:t})}}}),sJ]}var t}(this._scope);for(const i of n){const n=dJ({application:this._application,appLifeCyclePermissions:this._appLifeCyclePermissions,change:e,currentChanges:this._currentChanges,getNextState:i,getCachedSupportSet:()=>this.supportedSets,logger:this._logger,sessionContext:this._sessionContext});n&&t.push(n)}return t}get supportedSets(){return this._supportedEntitySet=this._supportedEntitySet||this._application&&function(e){const t=e.manifest.supportedEntities,n=new Set;return t&&t.reduce(((e,t)=>e.add(t)),n),n}(this._application),this._supportedEntitySet}}function mJ({applicationManagers:e,change:t,logger:n,schedulerWithValidator:a}){const o=[];return n.debug(`Change received: ${t.type}`),e.forEach((e=>{const r=e.managedId,s=e.onChange(t);r&&s.length>0&&s.forEach((e=>o.push(function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{jobs:o,change:r}=e,s=[];o.forEach((e=>{s.push(function(e,t,n){var{job:a}=e,o=(0,i.__rest)(e,["job"]);return new Promise(((e,r)=>{t.validateAndSchedule((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield a();return e(t),t}catch(e){throw r(e),e}}))),Object.assign(Object.assign({priority:DI.vW.Macro},o),{scheduledById:"services-life-cycle-manager"}),n)===DI.o_&&e(void 0)}))}(e,a,r.correlationId))}));const l=[];let c=QG.success;for(const e of s)try{const t=yield e;t&&l.push(t)}catch(e){const i=`Not all jobs scheduled by ${n} completely successfully. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`;t.errorToTelemetry&&t.errorToTelemetry(i,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0),c=QG.failure}return Promise.resolve({id:n,type:r.type,stateJobStatus:c,jobCount:o.length,cleanupJobs:l})}))}(e,n,r,a))))})),{change:t,lcChanges:o}}function gJ({change:e,lcChanges:t}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield Promise.all(t);return{change:e,lcChanges:n}}))}function pJ({change:e,lcChanges:t},n,i){const{type:a}=e;0===t.length&&n.debug(`Experience change type: ${a} produced no application life cycle changes`);const o=i===qG.Experience?YG.ExperienceLifeCycleManager:YG.UserLifeCycleManager;return Object.assign(Object.assign({},e),{type:KG.LifeCycleReport,context:{apps:t,target:o,reportedChange:e}})}!function(e){e.incomplete="incomplete",e.success="success",e.failure="failure"}(QG||(QG={})),function(e){e.LifeCycleReport="life_cycle_report"}(KG||(KG={})),function(e){e.ExperienceLifeCycleManager="experience_life_cycle_manager",e.UserLifeCycleManager="user_life_cycle_manager"}(YG||(YG={}));class vJ{constructor(e,t,n,i,a,o,r){this._scope=t,this._sessionContext=i,this._lifeCycleChangeReportingService=a,this._loggerFactory=o,this._lifeCycleJobPermissions=r,this._cleanupJobs=[],this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger(`WindowLifeCycleManager[${e}]`,"core-services-life-cycle-manager"),this._schedulerWithValidator=new VG(n,o)}notify(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=mJ({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}),n=yield gJ(t);for(const{cleanupJobs:e}of n.lcChanges)this._cleanupJobs.push(...e);const i=pJ(n,this._logger,this._scope);this._lifeCycleChangeReportingService.report(i)}))}manageApplication(e){var t;if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const n=new uJ(this._scope,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);n.manageApplication(e),this._applicationManagers.push(n)}destroy(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o,r;for(;i=this._cleanupJobs.pop();)try{yield i(e)}catch(e){r=r?r.concat(`${i.toString()}::${(0,wi.u4)(e)}`):`${i.toString()}::${(0,wi.u4)(e)}::`}r&&(o=new kC.G(kC.$.CLEANUP,new Error(r)),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}${null===(a=o.prevError)||void 0===a?void 0:a.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}}class hJ{constructor(e,t,n,i,a,o,r){this._scope=t,this._scheduler=n,this._sessionContext=i,this._lifeCycleChangeReportingService=a,this._loggerFactory=o,this._lifeCycleJobPermissions=r,this._cleanupJobs=[],this._windowLifecycleManagers=new Map,this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger(`UserLifeCycleManager[${e}]`,"core-services-life-cycle-manager"),this._schedulerWithValidator=new VG(n,o)}manageApplication(e){var t;if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const n=new uJ(this._scope,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);n.manageApplication(e),this._applicationManagers.push(n)}notify(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.handleWindowChange(e);const i=mJ({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}),o=yield gJ(i);if((null===(t=o.lcChanges)||void 0===t?void 0:t.length)>0&&(null===(n=o.lcChanges[0])||void 0===n?void 0:n.type)===l_.c4.UserWarm){const e=null===(a=this._sessionContext.scenarioFactory)||void 0===a?void 0:a.findScenario(it.RG.PostALT);null==e||e.mark(it.ck.PreWarmJobCompleted)}for(const{cleanupJobs:e}of o.lcChanges)this._cleanupJobs.push(...e);const r=pJ(o,this._logger,this._scope);this._lifeCycleChangeReportingService.report(r)}))}manageWindow(e,t){var n,i;if(this._windowLifecycleManagers.has(e))return void(null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,`WINDOW_LIFECYCLE_MANAGER_ALREADY_EXISTS[${e}]`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0));const a=new vJ(e,GG.Window,this._scheduler,t,this._lifeCycleChangeReportingService,this._loggerFactory,this._lifeCycleJobPermissions);this._activelyManagedApplications.forEach((e=>a.manageApplication(e))),this._windowLifecycleManagers.set(e,a)}removeWindow(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this._windowLifecycleManagers.get(e);n&&(yield n.destroy(t),this._windowLifecycleManagers.delete(e))}))}destroy(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o,r;for(this._windowLifecycleManagers.forEach((t=>{t.destroy(e)}));i=this._cleanupJobs.pop();)try{yield i(e)}catch(e){r=r?r.concat(`${i.toString()}::${(0,wi.u4)(e)}`):`${i.toString()}::${(0,wi.u4)(e)}::`}r&&(o=new kC.G(kC.$.CLEANUP,new Error(r)),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}${null===(a=o.prevError)||void 0===a?void 0:a.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}handleWindowChange(e){var t;e.windowId&&(null===(t=this._windowLifecycleManagers.get(e.windowId))||void 0===t||t.notify(e))}}class fJ{constructor(e,t,n,i,a,o){this._scheduler=e,this._experienceChangeReportingService=t,this._sessionContext=n,this._lifeCycleChangeReportingService=i,this._loggerFactory=a,this._lifeCycleJobPermissions=o,this._cleanupJobs=[],this._userLifecycleManagers=new Map,this.handleUserScopeChange=e=>{if(e.userContextId){const t=this._userLifecycleManagers.get(e.userContextId);t?t.notify(e):this._logger.error(`EXPECTED_USER_LIFECYCLE_MANAGER_NOT_FOUND[${e.userContextId}]`)}else this._userLifecycleManagers.forEach((t=>t.notify(e)))},this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger("ExperienceLifeCycleManager","core-services-life-cycle-manager"),this._schedulerWithValidator=new VG(this._scheduler,a)}init(){const e=this._experienceChangeReportingService.observeChanges();this._subscription=e.pipe((0,Bw.b)(this.handleUserScopeChange),(0,Lw.U)((e=>mJ({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}))),(0,Zw.b)(gJ),(0,Bw.b)((e=>{var t,n,i;if((null===(t=e.lcChanges)||void 0===t?void 0:t.length)>0&&(null===(n=e.lcChanges[0])||void 0===n?void 0:n.type)===l_.c4.ExperienceWarm){const e=null===(i=this._sessionContext.scenarioFactory)||void 0===i?void 0:i.findScenario(it.RG.PostALT);null==e||e.mark(it.ck.ExperienceWarmJobCompleted)}for(const{cleanupJobs:t}of e.lcChanges)this._cleanupJobs.push(...t)})),(0,Lw.U)((e=>pJ(e,this._logger,qG.Experience))),(0,Lw.U)((e=>this._lifeCycleChangeReportingService.report(e)))).subscribe()}destroy(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o,r;for(;i=this._cleanupJobs.pop();)try{yield i(e)}catch(e){r=r?r.concat(`${i.toString()}::${(0,wi.u4)(e)}`):`${i.toString()}::${(0,wi.u4)(e)}::`}this._subscription&&this._subscription.unsubscribe(),this._scheduler.destroy(),r&&(o=new kC.G(kC.$.CLEANUP,new Error(r)),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}${null===(a=o.prevError)||void 0===a?void 0:a.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}manageApplication(e){var t;if(!this._subscription)throw new Error("Unable to manage provided application prior to LifeCycleManager init.");if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const n=new uJ(qG.Experience,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);n.manageApplication(e),this._applicationManagers.push(n)}manageUser(e,t){if(this._userLifecycleManagers.has(e))return void this._logger.error(`USER_LIFECYCLE_MANAGER_ALREADY_EXISTS[${e}]`);const n=new hJ(e,this._userLifecycleManagers.size>0?JG.Other:JG.FirstUserAtBoot,this._scheduler,t,this._lifeCycleChangeReportingService,this._loggerFactory,this._lifeCycleJobPermissions);this._activelyManagedApplications.forEach((e=>n.manageApplication(e))),this._userLifecycleManagers.set(e,n)}manageWindow(e,t,n){var i,a;this.removeWindow(void 0,e,"switch_user");const o=this._userLifecycleManagers.get(t);o?o.manageWindow(e,Object.assign(Object.assign({},this._sessionContext),n)):null===(a=(i=this._logger).errorToTelemetry)||void 0===a||a.call(i,`EXPECTED_USER_LIFECYCLE_MANAGER_NOT_FOUND[${t}]`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0)}removeUser(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this._userLifecycleManagers.get(t);n?(yield n.destroy(e),this._userLifecycleManagers.delete(t)):this._logger.warn(`USER_LIFECYCLE_MANAGER_NOT_FOUND_TO_DESTROY[${t}]`)}))}removeWindow(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){e?null===(a=this._userLifecycleManagers.get(e))||void 0===a||a.removeWindow(t,n):this._userLifecycleManagers.forEach((e=>e.removeWindow(t,n)))}))}}const yJ=(e,t,n,i)=>{const a=function(e,t,n){if(!n){const{context:{execution:n}}=e;t.error(`Received a scheduler change in state: ${DI.Tf[n]} with no active scenario: ${JSON.stringify(e)}`)}return n}(e,t,i);if(a){const{context:{execution:t,handle:i,error:o}}=e;a.appendEventData({errorCode:null==o?void 0:o.code,message:null==o?void 0:o.message,context:null==o?void 0:o.context}),a.mark(`${it.ck.ScheduledJobStateChange}_${DI.Tf[t].toLocaleLowerCase()}_${i}`),n(a)}};class bJ{constructor(e,t,n){this._schedulerChangeReporting=e,this._scenarioFactory=t,this._activeExpScenariosMap=new Map,this._activeAppScenariosMap=new Map,this._activeSchedulerScenariosMap=new Map,this._logger=n.newLogger("LifeCycleTelemetry","core-services-life-cycle-telemetry")}init(){const e=e=>({change:e,scenarioFactory:this._scenarioFactory,activeAppScenariosMap:this._activeAppScenariosMap,activeExpScenariosMap:this._activeExpScenariosMap,activeSchedulerScenariosMap:this._activeSchedulerScenariosMap,logger:this._logger});this._schedulingChangeSubscription=this._schedulerChangeReporting.observeChanges().pipe((0,Lw.U)((t=>function({change:e,activeSchedulerScenariosMap:t,scenarioFactory:n,logger:i}){const{context:{execution:a}}=e,o=(({windowId:e,context:{handle:t}})=>`${t}:${e}`)(e);let r=t.get(o);switch(a){case DI.Tf.Started:if(r)i.error(`Received a scheduler change in state: ${DI.Tf[a]} with an active scenario already running. Change: ${JSON.stringify(e)}`);else{r=n.newScenario(it.RG.ScheduledJobComplete),t.set(o,r);const{correlationId:i,context:{meta:{id:a,priority:s,scheduledById:l,runOncePerId:c},target:d},type:u}=e;r.appendEventData({"Job.Id":a,"Job.Priority":DI.vW[s],"Job.ScheduledBy":l,"Job.RunOncePerId":c,target:d,correlationId:i,type:u})}break;case DI.Tf.Canceled:yJ(e,i,(e=>null==e?void 0:e.cancel()),r);break;case DI.Tf.Complete:yJ(e,i,(e=>null==e?void 0:e.stop()),r),t.delete(o);break;case DI.Tf.Received:i.log(`Received a scheduler change in state: ${DI.Tf[a]}: Change:${JSON.stringify(e)}`)}}(e(t))))).subscribe()}destroy(){this._schedulingChangeSubscription&&this._schedulingChangeSubscription.unsubscribe(),this._schedulingChangeSubscription=void 0}}var SJ=n(65274);const kJ=1024,wJ=1e3,CJ=6e4,_J=36e5,TJ=864e5,IJ="memoryFeedbackService.lastDialogDate",EJ="memoryFeedbackService.countOfDialogWithinDay",NJ="memoryFeedbackService.countOfDialogWithinWeek";class AJ{constructor(e,t,n,i,a,o,r,s){this.localStorage=e,this.entityCommanding=t,this.clientState=n,this.client=i,this.coreSettings=a,this.scenarioFactory=o,this.profilerService=r,this.userTrackingService=s,this.timeWhenLastCallEnded=-1,this.countOfDialogWithinDay=0,this.countOfDialogWithinWeek=0,this.memoryFeedbackSettings=this.coreSettings.get(L.J.Diagnostics).memoryFeedbackSettings}start(){this.startClientStateSubscription(),this.intervalId||(this.intervalId=(0,Ue.J)().setInterval((()=>this.beat()),this.memoryFeedbackSettings.verySlowSampleTime))}stop(){this.intervalId&&(0,Ue.J)().clearInterval(this.intervalId),this.timeoutId&&(0,Ue.J)().clearTimeout(this.timeoutId),this.clientStateSubscription&&this.clientStateSubscription.unsubscribe()}startClientStateSubscription(){let e=this.clientState.getState();this.clientStateSubscription=this.clientState.observe().subscribe({next:t=>{e===yC.pk.VeryActive&&t!==yC.pk.VeryActive&&(this.timeWhenLastCallEnded=Date.now()),e=t}})}shouldKeepRunningForMTMA(){var e;return!!this.memoryFeedbackSettings.accountSizeInMB||(null===(e=this.userTrackingService)||void 0===e?void 0:e.getAccountMode())!==si.MultipleAccounts}beat(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.shouldKeepRunningForMTMA())return void this.stop();const t=yield null===(e=SJ.K.getInstance())||void 0===e?void 0:e.getMemoryData();if(!t)return;if(void 0!==t.Perf_Renderer_Count_Processes&&t.Perf_Renderer_Count_Processes>1)return this.stop(),void this.newScenario(it.RG.MemoryFeedbackStopBecauseOfDevtools);const n=new Date,i=yield this.shouldShowBrbDialog(n,t);i.isMemoryHeavy&&(this.openBrbDialog(i.memoryDetailMessage),this.newScenario(it.RG.MemoryFeedbackDialogOpen),this.stop(),this.dateOfBeginingHighMemory=void 0,this.localStorage.set(EJ,(this.countOfDialogWithinDay+1).toString()),this.localStorage.set(NJ,(this.countOfDialogWithinWeek+1).toString()),this.localStorage.set(IJ,n.toString()))}))}openBrbDialog(e){this.entityCommanding.brbFeedback.autoBrbConfirmationDialog({visibilityState:d.fe.show,stateTransition:d.su.new,correlation:{source:kt.D.AutoBrb}},{feedbackText:`Detected high memory usage. ${e}`})}shouldShowBrbDialog(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield(0,RN.jW)(this.client);if(!(null==n?void 0:n.isMainWindow))return{isMemoryHeavy:!1};this.dateOfBeginingHighMemory&&(yield this.triggerGCAndWait());const{isMemoryHeavy:i,memoryDetailMessage:a}=yield this.getMemoryUsageData(t);if(!i||this.wasInCallRecently(e))return this.dateOfBeginingHighMemory=void 0,{isMemoryHeavy:!1};if(this.dateOfBeginingHighMemory=this.dateOfBeginingHighMemory||e,e.getTime()-this.dateOfBeginingHighMemory.getTime()<this.memoryFeedbackSettings.durationInMinuteOfConsecutiveHighMemoryState*CJ)return{isMemoryHeavy:!1};if(this.hasReachedDialogLimit(e))return{isMemoryHeavy:!1};return this.clientState.getState()!==yC.pk.Active?{isMemoryHeavy:!1}:{isMemoryHeavy:i,memoryDetailMessage:a}}))}getMemoryUsageData(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=this.getThresholds(),n=[];let i=!1;const a=yield this.calculatePopoutAdditionalSize(),o=this.calculateAccountsAdditionalSizeInKb(),r=e.Perf_Renderer_WorkingSet||0,s=r-a.rendererWorkingSet-o.rendererWorkingSet>t.rendererWorkingSet*kJ;i=i||s,n.push(`${this.markReachedThreshold(s)}RWS: ${this.convertKBtoMB(r)} MB`);const l=e.Perf_JSHeap_UsedSize||0,c=l-a.jsUsedHeapSize-o.jsUsedHeapSize>t.jsUsedHeapSize*kJ;i=i||c,n.push(`${this.markReachedThreshold(c)}JSH: ${this.convertKBtoMB(l)} MB`);return{isMemoryHeavy:i,memoryDetailMessage:n.join(", ")}}))}calculatePopoutAdditionalSize(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(null===(e=yield(0,RN.XD)(this.client))||void 0===e?void 0:e.length)||0,n=this.memoryFeedbackSettings.popoutSizeInMB;return t<=1||!n?{jsUsedHeapSize:0,rendererWorkingSet:0}:{jsUsedHeapSize:(t-1)*n.jsUsedHeapSize*kJ,rendererWorkingSet:(t-1)*n.rendererWorkingSet*kJ}}))}calculateAccountsAdditionalSizeInKb(){var e;const t=(null===(e=this.userTrackingService)||void 0===e?void 0:e.getAuthenticatedUsers().size)||0,n=this.memoryFeedbackSettings.accountSizeInMB;return t<=1||!n?{jsUsedHeapSize:0,rendererWorkingSet:0}:{jsUsedHeapSize:(t-1)*n.jsUsedHeapSize*kJ,rendererWorkingSet:(t-1)*n.rendererWorkingSet*kJ}}hasReachedDialogLimit(e){const t=new Date(this.localStorage.get(IJ)||0);return e.getTime()-t.getTime()<this.memoryFeedbackSettings.gapInHourBetweenFeedbackDialogs*_J||(e.getTime()-t.getTime()>TJ&&this.resetDialogDayCount(),this.countOfDialogWithinDay=parseInt(this.localStorage.get(EJ)||"0",10),this.countOfDialogWithinDay>=this.memoryFeedbackSettings.limitOfFeedbackDialogsWithinDay||(e.getTime()-t.getTime()>7*TJ&&this.resetDialogWeekCount(),this.countOfDialogWithinWeek=parseInt(this.localStorage.get(NJ)||"0",10),this.countOfDialogWithinWeek>=this.memoryFeedbackSettings.limitOfFeedbackDialogsWithinWeek))}wasInCallRecently(e){const t=this.memoryFeedbackSettings.minimumSecondsPassedSinceLastCall*wJ,n=this.timeWhenLastCallEnded>0&&e.getTime()-this.timeWhenLastCallEnded;return n&&t&&n<t}triggerGCAndWait(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield null===(e=this.profilerService)||void 0===e?void 0:e.requestTriggerGC(),yield(0,EA._)(this.memoryFeedbackSettings.delayInMsAfterGC)}))}newScenario(e){this.scenarioFactory.newScenario(e).stop()}getThresholds(){return this.memoryFeedbackSettings.thresholdsInMB}resetDialogDayCount(){this.localStorage.set(EJ,"0")}resetDialogWeekCount(){this.localStorage.set(NJ,"0")}markReachedThreshold(e){return e?"#":""}convertKBtoMB(e){return(e/kJ).toFixed(2)}}var FJ,DJ=n(54714);!function(e){e.LifeCycleScopeChange="LifeCycleScopeChange"}(FJ||(FJ={}));class RJ extends fe{constructor(){super(he.Yg.CreateLifeCycleTask,["appsRegistryService","client","clientState","config","coreSecurityService","coreSettings","coreSettingsContext","coreUtilities","entityCommanding","experienceChangeReportingService","hostCommunicationService","i18n","i18NextWrapper","lifeCycleScopeChangeReportingService","localStorage","loggerFactory","networkState","platformService","rebootService","scenarioFactory","schedulerChangeReporting","userBiService","windowProvider","scheduler"]),this.createCoreApplication=(e,t,n)=>({manifest:{name:"CoreTasks",id:"com.microsoft.teams.corescheduling"},onExperienceWarm:e=>[{id:"memory-feedback-service-start",job:()=>{const{context:{localStorage:t,entityCommanding:n,clientState:i,coreSettings:a,client:o,scenarioFactory:r,userTrackingService:s,profilerService:l}}=e;if(!a.get(L.J.Diagnostics).enableMemoryFeedbackService)return;if(!t||!i||!a.get(L.J.Diagnostics).memoryFeedbackSettings)return;new AJ(t,n,i,o,a,r,l,s).start()}},{id:"init-diagnostics-idb-job",job:()=>{const{context:{loggerFactory:t}}=e;"notifyDiagnosticsALTDone"in t&&t.notifyDiagnosticsALTDone()}},{id:"clear-t2-web-boot-attempts-counter",job:()=>{const{context:{localStorage:t,coreSettings:n}}=e;if(!n.get(L.J.Core).enableClearT2WebBootAttempts)return;if(!t)return;t.remove("numT2WebBootAttempts",Ct.f.Global)}},{id:"notify-desktop-experience-warm-job",job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield n.loadModule("core");(null==e?void 0:e.reportExperienceWarm)&&e.reportExperienceWarm()}))}],onPreWarm:i=>[{id:"settings-ecs-fetch",job:()=>e.fetchEcsSettingsIfApplicable()},{id:"maglev-provider-host-settings",job:()=>{const{context:{coreSettings:t}}=i;t.get(L.J.Core).enableMaglevHostPostAltSettings&&e.initializeMaglevHostProviderPostAltSettings(n)}},{id:"user-bi-initialize-smb-user-intent",job:()=>t.initializeAndSubscribeToSmbUserIntent&&t.initializeAndSubscribeToSmbUserIntent()},{id:"active-windows-history-job",job:()=>{const{context:{activeWindowsHistoryService:e}}=i;if(e)return e.initialize(),t=>{e.cleanup(t)}}},{id:"initialize-office-integration-service",job:()=>{const{context:{coreSettings:e,client:t,hostCommunicationService:n,loggerFactory:a,entityCommanding:o,authenticationUser:r,localStorage:s,windowProvider:l}}=i;e.get(L.J.People).enableOfficeIntegration&&DJ.x.Instance(n,e,t,a,o,l,s,r).initialize()}}]})}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e.config,n=e.coreSettings,a=e.coreSettingsContext,o=e.entityCommanding,r=e.experienceChangeReportingService,s=e.hostCommunicationService,l=e.i18n,c=e.lifeCycleScopeChangeReportingService,d=e.loggerFactory,u=e.networkState,m=e.platformService,g=e.scenarioFactory,p=e.schedulerChangeReporting,v=e.userBiService,h=e.clientState,f=e.localStorage,y=e.i18NextWrapper,b=e.windowProvider,S=e.rebootService,k=e.coreSecurityService,w=e.scheduler;new bJ(p,g,d).init();const{isEntityInView:C}=e.coreUtilities,_=new fJ(w,r,{client:e.client,coreSettings:n,entityCommanding:o,i18n:l,isEntityInView:C,loggerFactory:d,networkState:u,platformService:m,scenarioFactory:g,hostCommunicationService:s,clientState:h,localStorage:f,config:t,i18NextWrapper:y,windowProvider:b,rebootService:S,coreSecurityService:k},c,d,t.lifeCycleJobPermissions);return _.init(),e.appsRegistryService.registeredApps.forEach((e=>_.manageApplication(e))),_.manageApplication(this.createCoreApplication(a,v,s)),e.scheduler=w,e.experienceLifecycleManager=_,e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"quit":case"signout":yield _.destroy(e);break;default:return}}))}))}}class xJ extends fe{constructor(){super(he.Yg.CreateLocalStorage,["authenticationUser","config","coreSettings","loggerFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,config:n,windowProvider:a,loggerFactory:o}=e,r=new _q(t.profile.tenantId,t.profile.objectId,n.experienceName,a,o),s=o.newLogger("CreateLocalStorage","core-services-tasks"),l=(0,di.b4)(t);e.localStorage=r;const c=!e.coreSettings.get(L.J.Auth).isLegacyCleanupCodeFlag;return e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if("signout"===e&&c){const e=yield function(e,t,n){const i={},a=["TflFreProfileCardDisplayed"],o=(0,IL.nC)(n);try{a.forEach((t=>{const n=e.get(t,Ct.f.UserAndExperience);n&&(i[t]=n)})),e.clear([Ct.f.UserAndExperience,Ct.f.User]),o.map((t=>e.remove(t,Ct.f.Experience)))}catch(e){t.warn(`Failed to clear local storage! ${e}`)}return i}(r,s,l);e&&function(e,t,n){const i=Object.keys(t);try{i.forEach((n=>{e.set(n,t[n],Ct.f.UserAndExperience)}))}catch(e){n.warn(`Failed to restore local storage values for ${i}: ${e}!`)}}(r,e,s)}switch(e){case"quit":case"signout":new $z.I(r).clear();break;default:return}}))}))}}class MJ{constructor(e,t,n,i,a,o){this.waitForRenderingContextReady=e,this.hostCommunicationService=t,this.coreSettings=n,this.commandChangeReportingService=i,this.scenarioFactory=a,this.logger=o.newLogger("NotificationsHandler","core-services-notifications"),this.notificationsWindowId=void 0}activateNotification(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{dataOptions:i}=e;if(!i||!i.userContextId)return void(null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"CN:Error activating notification. UserContextId is missing from notifications entity command dataOptions.\n      Therefore, the user rendering context to use to activate this notification cannot be determined.","webclient_framework_foundation_core_services_notifications",void 0,!0));const{userContextId:a}=i,o=this.waitForRenderingContextReady(!1,a);return(yield o).commandHandler(e)}))}resizeNotificationsWindow({windowFeatures:e}){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(this.notificationsWindowId){const i=yield null===(t=this.hostCommunicationService)||void 0===t?void 0:t.loadModule("toasts"),{width:a,height:o}=e;null===(n=null==i?void 0:i.resizeNotificationsPanel)||void 0===n||n.call(i,a,o)}}))}isCustomNotificationEnabled(e){var t,n,i;const{enableCustomNotificationsForCalls:a,enableCustomNotificationsForChats:o,enableCustomNotificationsOnDesktop:r}=this.coreSettings.get(L.J.Core);let s=!1,l=!1;e&&(s=e.isIncomingCall,l=null!==(i="MeetingStart"===(null===(n=null===(t=e.targetEntity)||void 0===t?void 0:t.dataOptions)||void 0===n?void 0:n.toastType))&&void 0!==i&&i);return!(!r||!(void 0===e?a||o:s||l?a:o))}initialize(e){this.notificationsWindowId=e}sendCommandToHost(e,t,n,i){var a,o,r,s,l;if(!!this.coreSettings.get(L.J.Core).enableCommandToHostCommService){let s="";s=(0,wi.u4)(null===(a=null==i?void 0:i.targetEntity)||void 0===a?void 0:a.dataOptions),this.logger.log(`CN:Sending toast command to host for display. TargetEntity type: [${null===(o=null==i?void 0:i.targetEntity)||void 0===o?void 0:o.type}] action [${null===(r=null==i?void 0:i.targetEntity)||void 0===r?void 0:r.action}] dataOptions [${s}]`),this.commandChangeReportingService.report({correlationId:t,type:wC.B.NotHandled,context:{target:"notificationsHandler",entityCommand:{entity:n,command:Object.assign(Object.assign({},e),{correlation:e.correlation,layoutMode:e.layoutMode||void 0}),entityOptions:i}}})}else null===(l=(s=this.logger).errorToTelemetry)||void 0===l||l.call(s,"CN:Failed to send notification to host because enableCommandToHostCommService feature flag is false.","webclient_framework_foundation_core_services_notifications",void 0,!0)}sendTelemetry(e){const{callId:t,callingScenarioName:n,stepName:i,toastId:a}=e,o=t||"",r=this.scenarioFactory.findScenarioByNameAndId(n,o),s=this.scenarioFactory.findScenarioByNameAndId(it.RG.WebToastShow,a);null==r||r.mark(i),null==s||s.mark(i),i===it.ck.ToastShown&&(null==s||s.stop(),r&&r.name===it.RG.MeetingStartedNotification&&r.stop())}}class OJ extends fe{constructor(){super(he.Yg.CreateNotificationsHandlerTask,["commandChangeReportingService","coreSettings","hostCommunicationService","loggerFactory","scenarioFactory","waitForRenderingContextReady"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,coreSettings:n,hostCommunicationService:i,loggerFactory:a,scenarioFactory:o,waitForRenderingContextReady:r}=e;e.notificationsHandler=new MJ(r,i,n,t,o,a)}))}}var PJ,LJ,UJ,jJ;!function(e){e.Cold="Cold",e.Warm="Warm",e.Rollback="Rollback",e.Update="Update",e.Local="Local",e.Container="Container",e.Unknown="Unknown"}(PJ||(PJ={})),function(e){e.SessionID="tmp.sessionId",e.DeviceID="tmp.deviceId",e.IsRelaunchFromOOPs="tmp.relaunchFromOOPs",e.PreAuthUserID="tmp.preAuthUserId"}(LJ||(LJ={})),function(e){e.IndexPageStart="execute-index-html-script",e.CoreModuleLoaded="exp_loader_core_module_loaded",e.NotifyDesktop="exp_loader_notified_desktop",e.ConfigLoaded="exp_loader_config_loaded",e.MainChunksLoadingStart="exp_loader_load_bundles_start",e.MainChunksLoadingStop="exp_loader_load_bundles_stop",e.IndexPageStop="exp_loader_index_stop",e.ClientStartStop="client_start_stop"}(UJ||(UJ={})),function(e){e.ExpLoaderFailure="ExpLoaderFailure",e.LoadBundlesFailure="LoadBundlesFailure",e.ParseIndexPageFailure="ParseIndexPageFailure",e.CoreStartTimeout="CoreStartTimeout"}(jJ||(jJ={}));var $J=n(516258);class BJ extends $J.s{constructor(e,t,n,i,a){super(n.navigator.userAgent),this.loggerFactory=e,this.routingServices=t,this.windowHost=n,this.hostSettings=i,this.getPlatformConfigurationOverrides=a,this.logger=this.loggerFactory.newLogger("PlatformService","core-services-platform"),this.queryStringParameters=this.routingServices.state.getSearchState()||{},this.headConfig=(0,FG.pf)(this.windowHost,this.logger),this.cachedConfig=this.computeConfig(),this.cachedEcsOverrides=this.computeEcsOverrides()}get config(){return this.cachedConfig}get ecsOverrides(){return this.cachedEcsOverrides}get host(){var e,t;const n=null===(t=null===(e=this.windowHost.loader)||void 0===e?void 0:e.getProperties)||void 0===t?void 0:t.call(e);return Object.assign({bootType:(null==n?void 0:n.bootType)||PJ.Unknown,deviceId:(null==n?void 0:n.deviceId)||JC.get("deviceId"),deviceInfo:null==n?void 0:n.deviceInfo,hostAppVersion:(0,FG.nU)(this.windowHost),sessionId:(null==n?void 0:n.sessionId)||JC.get("sessionId"),preAuthUserId:null==n?void 0:n.preAuthUserId},this.windowHost.getHostedWindowContext())}getOsOverride(){return this.windowHost.localStorage.getItem("platformOverride")}computeConfig(){var e,t,n;let i={};this.getPlatformConfigurationOverrides&&(i=this.getPlatformConfigurationOverrides(this.windowHost,this.queryStringParameters)),this.logger.log(`IPlatformConfiguration overrides: ${JSON.stringify(i)}`);const a=this.getBrowser(),o=null!==(e=i.clientType)&&void 0!==e?e:this.getClientType(this.queryStringParameters,this.windowHost),r=this.determinePlatformId(i);this.logger.log(`Determined PlatformID to be '${r}'`);const s=this.getHostingParent(),l=this.windowHost.__VERSION__,c=`${r}/${l}`,d=this.windowHost.__webpack_public_path__,u=this.getVendor(),m=this.getOSDetails(),g=this.getCpuArchitecture();let p="https://statics.teams.cdn.office.net";try{d&&(p=new URL(d).origin)}catch(e){this.logger.warn(`Failed to parse dynamic staticsPath origin from '${d}'`)}const v=this.windowHost.navigator.language||"en-us";return this.logger.log(`PlatformService: configuring with clientVersion: ${c}`),{browser:a,browserVersion:this.getBrowserVersion(),buildType:(0,FG.Cu)(c),buildVersion:l,clientContext:this.getClientContext(s),clientType:o,clientVersion:c,cpuArchitecture:g,currentUrl:null===(n=null===(t=this.windowHost)||void 0===t?void 0:t.location)||void 0===n?void 0:n.href,hostingParent:s,isInCypressFrame:this.getIsInCypressFrame(),isInIframe:this.getIsInIframe(),isInternalUser:this.headConfig.isInternalUser,localeCode:this.getLocaleCode(),osDetails:m,osPlatform:this.getOsPlatform(),osVersion:this.getOSPlatformVersion(),platformId:r,publicPath:d,staticsPath:p,userAgent:this.userAgent,userLanguage:v,vdi:i.vdi,vendor:u,getLocaleInfoAsync:this.windowHost.getLocaleInfoAsync}}determinePlatformId(e){var t,n,i,a,o,r,s,l,c,d,u;const m=e.platformId,g=null===(n=null===(t=this.hostSettings)||void 0===t?void 0:t.hostSettings)||void 0===n?void 0:n.platformId;if(null===(a=(i=this.logger).logNoPii)||void 0===a||a.call(i,`Potential PlatformID sources: experienceOverrides='${m}', hostSettings='${g}', qsp='${JSON.stringify(this.queryStringParameters)}', windowHostHost='${null===(o=this.windowHost)||void 0===o?void 0:o.localStorage.getItem("host")}'`),m)return null===(s=(r=this.logger).logNoPii)||void 0===s||s.call(r,"Using PlatformID value from experience overrides"),m;if(g){const e=parseInt(g,10);if(e)return null===(c=(l=this.logger).logNoPii)||void 0===c||c.call(l,"Using PlatformID value from host settings"),e}return null===(u=(d=this.logger).logNoPii)||void 0===u||u.call(d,"Using PlatformID value from QSP/WindowHost/Browser"),this.getPlatformId(this.queryStringParameters,this.windowHost)}getHostUrl(){const e=this.windowHost.localStorage.getItem("ecsHostUrl")||this.headConfig.ecsHostUrl;if(e)return new URL(e,this.windowHost.location.origin).href}computeEcsOverrides(){const e=this.getHostUrl(),t=this.getEnvironmentOverride()||(0,FG.zj)(this.windowHost,this.headConfig),n=(0,a.get)(s_.s,t),i=this.getRingOverride(),{originalRing:o,unauthenticated:r}=this.headConfig,s=void 0===o||o===i;return Object.assign(Object.assign({hostUrl:e},this.getRingConfig(n,i)),{originalRing:o,unauthenticated:r,isAssignedRing:s})}getEnvironmentOverride(){if(this.queryStringParameters.webinarRing)return this.queryStringParameters.webinarRing}getLocaleCode(){const e=this.getQspLocale();if(e)return e;const t=this.windowHost.getHostedWindowContext(),n="localeCode";return t&&t.localeCode?(this.windowHost.localStorage.setItem(n,t.localeCode),t.localeCode):this.windowHost.localStorage.getItem(n)||this.headConfig.localeCode||"en-us"}getQspLocale(){if(this.queryStringParameters.localeCode)return this.queryStringParameters.localeCode;if(this.queryStringParameters.language)return this.queryStringParameters.language.toLowerCase();if(!this.queryStringParameters.setting)return;const e=this.queryStringParameters.setting;let t;if(Array.isArray(e)){for(const n of e)if(n.startsWith("localeCode:")){t=n;break}}else e.startsWith("localeCode:")&&(t=e);return t?t.split(":")[1]:void 0}getRingOverride(){if(this.headConfig.isInternalUser&&this.queryStringParameters.ring)return this.queryStringParameters.ring;const e=this.windowHost.getHostedWindowContext();if(null==e?void 0:e.ring)return e.ring;const{ring:t}=this.headConfig;return t?"string"==typeof t?t:t.id:void 0}getHostingParent(){const e=(0,FG.f2)(this.windowHost);return e&&e.dataset&&"outlook"===e.dataset.host?Pe.GJ.Outlook:Pe.GJ.Unknown}getClientContext(e){return e===Pe.GJ.Outlook?Pe.RY.Embed:void 0}getIsInIframe(){return!!this.windowHost.getHostedWindowContext().isInIframe}getIsInCypressFrame(){return!!this.windowHost.getHostedWindowContext().isInCypressFrame}}class WJ extends fe{constructor(){super(he.Yg.CreatePlatform,["windowProvider","loggerFactory","routingServices"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,routingServices:i,hostSettings:a,getPlatformConfigurationOverrides:o}=e;e.platformService=new BJ(n,i,t,a,o)}))}}var HJ=n(945607),VJ=n(487722);var zJ,qJ;!function(e){e.LoadModuleProfilerFailed="LoadModuleProflierFailed",e.ExecuteCommandFailed="ExecuteCommandFailed"}(zJ||(zJ={})),function(e){e.LoadModuleProfilerSuccess="LoadModuleProfilerSuccess",e.ExecuteCommandSuccess="ExecuteCommandSuccess"}(qJ||(qJ={}));class GJ{constructor(e,t){this.hostCommunicationService=t,this.logger=e.newLogger("ProfilerService","services-io-profiler"),this.exposeToCoreWindow()}getMemoryData(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield(0,HJ.K)(this.hostCommunicationService,!1);return(0,VJ.Mv)(e.processes)}))}getHeapSnapshot(e=!0){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.getHeapSnapshot)||void 0===t?void 0:t.call(n);return(null==i?void 0:i.snapshot)?i.snapshot:void 0}))}getMemoryTracing(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getProfilerModuleAsync();if(!t)return;const n=yield null===(e=t.getMemoryTracing)||void 0===e?void 0:e.call(t,{duration:5e3});return(null==n?void 0:n.data)?n.data:void 0}))}requestTriggerGC(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getProfilerModuleAsync();if(!t)return!1;const n=yield null===(e=t.triggerGC)||void 0===e?void 0:e.call(t);return!!(null==n?void 0:n.status)}))}startMemoryTracing(e=!0){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return!1;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.startMemoryTracing)||void 0===t?void 0:t.call(n);return!!(null==i?void 0:i.status)}))}stopMemoryTracing(e=!0){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.stopMemoryTracing)||void 0===t?void 0:t.call(n);return(null==i?void 0:i.data)?i.data:void 0}))}getProfilerModuleAsync(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let e;try{e=yield this.hostCommunicationService.loadModule("profiler"),this.logger.log(`Profiler:: ${qJ.LoadModuleProfilerSuccess}`)}catch(e){this.logger.error(`Profiler:: ${zJ.LoadModuleProfilerFailed} ${(0,wi.u4)(e)}`)}return e}))}exposeToCoreWindow(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.hostCommunicationService.loadModule("profiler"),t=yield this.hostCommunicationService.loadModule("heartbeat");e&&t?globalThis.window.profiler=Object.assign(Object.assign({},e),{getMemoryData:()=>this.getMemoryData(),getHeapSnapshot:(e=!1)=>this.getHeapSnapshot(e),getTotalWorkingSetSizeBytes:()=>this.getWorkingSetSizeFromProcesses(null==t?void 0:t.getPerfMetrics),getTotalCommitSizeBytes:()=>this.getCommitSizeFromProcesses(null==t?void 0:t.getPerfMetrics)}):this.logger.log("HostComms is unable to load profiler and/or heartbeat module. We are running on Web or Teams 1.0. Bailing out.")}))}getWorkingSetSizeFromProcesses(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e){const t=yield e();return null==t?void 0:t.reduce(((e,t)=>(e.workingSetSizeBytes+=t.workingSetSizeBytes,e)),{workingSetSizeBytes:0}).workingSetSizeBytes}return this.logger.warn("Unable to get perf metrics."),-1}))}getCommitSizeFromProcesses(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e){const t=yield e();return null==t?void 0:t.reduce(((e,t)=>(e.pageFileUsageBytes+=t.pageFileUsageBytes,e)),{pageFileUsageBytes:0}).pageFileUsageBytes}return this.logger.warn("Unable to get perf metrics."),-1}))}}class JJ extends fe{constructor(){super(he.Yg.CreateProfiler,["loggerFactory","hostCommunicationService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.profilerService=new GJ(e.loggerFactory,e.hostCommunicationService)}))}}class QJ{constructor(e,t,n,i,a,o,r,s,l,c){this.loggerFactory=e,this.host=t,this.clientStateProvider=n,this.networkStateProvider=i,this.platformService=a,this.hostCommunicationService=s,this.localStorage=l,this.scenarioFactory=c,this.cleanupOnRebootArray=[],this.clientStateSubscription=null,this.expChangeSubscription=null,this.lcChangeSubscription=null,this.isRunningJobsInLongInactive=!1,this.rebootPending=void 0,this.registerCleanupCallback=e=>{this.cleanupOnRebootArray.push(e)},this.didUrlChange=e=>(0,HE.IC)(e)!==(0,HE.IC)(this.host.location.href),this.areMaxRetriesExhausted=(e,t)=>{if(null==t?void 0:t.maxRetries){const n=this.getRetryStorageKey(e),i=this.localStorage.get(n,Ct.f.Experience),a=i&&parseInt(i,10)||0;this.logger.debug(`Reboot retry count for '${e}': ${a}`);const o=a>=t.maxRetries;return this.localStorage.set(n,`${a+1}`,Ct.f.Experience),o&&this.logger.warn(`Max retries exhausted for '${e}', retryCount: ${a}, maxRetries: ${t.maxRetries}`),o}return!1},this.getRetryStorageKey=e=>`rebootRetries.${e}`,this.logger=this.loggerFactory.newLogger("rebootService","core-services-reboot"),this.expChangeSubscription=o.observeChanges().pipe((0,Lw.U)((e=>{this.isExperienceIdleStateChangedEvent(e)&&(this.isRunningJobsInLongInactive=!0)}))).subscribe(),this.lcChangeSubscription=r.observeChanges().pipe((0,Lw.U)((({context:e})=>{const{target:t,reportedChange:n}=e;if(this.isRunningJobsInLongInactive&&t===YG.UserLifeCycleManager&&this.isExperienceIdleStateChangedEvent(n)&&(this.isRunningJobsInLongInactive=!1,this.rebootPending)){this.host.clearTimeout(this.timeoutId),this.logger.log("Core finished running App jobs in LongInactive client state. Issuing pending reboot now...");const{reason:e,commandSource:t,options:n}=this.rebootPending;this.rebootApp(e,t,n)}}))).subscribe()}rebootApp(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(yield this.cleanupBeforeReboot(),this.logger.log(`Reboot app triggered for ${e} from ${t} with options: ${(0,wi.u4)(n)}`),this.areMaxRetriesExhausted(t,n))return!1;try{this.dispose();const i=this.scenarioFactory.findScenario(it.RG.ClientStart);null==i||i.incomplete({commandSource:t,reason:e});const a=this.getReloadUrl(n,t,e);this.platformService.config.clientType===Pe.Bh.Maglev?yield this.rebootThroughDesktopApi(a,t,e):this.didUrlChange(a)?this.host.location.replace(a):this.host.location.reload()}catch(e){return this.logger.error("Reboot app failed"),!1}return!0}))}rebootWhenLongInactive(e,t,n){return this.clientStateSubscription?(this.logger.log(`Reboot subscription failed from ${t} with reason ${e}`),!1):(this.logger.log(`Reboot when longInactive is subscribed from ${t} with reason ${e}`),this.clientStateSubscription=this.clientStateProvider.observe().subscribe((i=>this.handleClientStateChange(i,e,t,n))),!0)}clearRetryCount(e){this.localStorage.remove(this.getRetryStorageKey(e),Ct.f.Experience)}dispose(){var e,t,n;this.isRunningJobsInLongInactive=!1,this.rebootPending=void 0,this.timeoutId&&(this.host.clearTimeout(this.timeoutId),this.timeoutId=void 0),null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this.expChangeSubscription)||void 0===t||t.unsubscribe(),null===(n=this.lcChangeSubscription)||void 0===n||n.unsubscribe()}cleanupBeforeReboot(){var e,t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,a,o;for(;i=this.cleanupOnRebootArray.pop();)try{yield i("restart")}catch(e){a=a?a.concat(`${i.toString()}::${(0,wi.u4)(e)}`):`${i.toString()}::${(0,wi.u4)(e)}::`}a&&(o=new kC.G(kC.$.CLEANUP,new Error(a)),null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,`${o.code}${null===(n=o.prevError)||void 0===n?void 0:n.message}`,"webclient_framework_foundation_core_services",void 0,!0))}))}rebootThroughDesktopApi(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("core");i?yield null===(a=i.relaunch)||void 0===a?void 0:a.call(i,{url:e,reason:`${n}; source: ${SN.d[t]}`}):this.logger.error("HostComms is unable to load core module.")}))}handleClientStateChange(e,t,n,i){this.networkStateProvider.getState()===Pf.G.Online?(this.logger.log(`Handling clientState change to ${e}.`),e===yC.pk.LongInactive&&(this.rebootPending={reason:t,commandSource:n,options:i},this.isRunningJobsInLongInactive?this.waitForRunningJobsAndReboot():this.rebootApp(t,n,i))):this.logger.log(`Reboot skipped, network state is offline when client state change to ${e}.`)}getReloadUrl(e,t,n){var i;const a=new URL((null==e?void 0:e.customUrl)||this.host.location.href),o=a.searchParams;(null===(i=null==e?void 0:e.qsps)||void 0===i?void 0:i.hasOwnProperty("clearcontainer"))&&o.delete("container"),o.delete("tenantId"),a.hash=this.getReloadHash(t,n,a.hash);const r=(null==e?void 0:e.qsps)||{};return Object.keys(r).forEach((e=>{o.set(e,r[e])})),a.toString()}getReloadHash(e,t,n){if(this.platformService.config.clientType===Pe.Bh.Maglev){const i=FN(n);let a;if(i.deepLink===bN.core)a=bN.core;else switch(e){case SN.d.WebClientUpdateService:a=bN.core;break;case SN.d.ReloadAppTask:a=i.deepLink&&i.deepLink!==bN.flyout&&t===SN.Z.RingSwitch?encodeURIComponent(i.deepLink):bN.default;break;default:a=bN.default}return`deepLink=${a}&source=${SN.d[e]}`}return""}waitForRunningJobsAndReboot(){this.logger.log("Pending a reboot while waiting for Core to finish running App jobs in LongInactive client state. timeout=2000 ms"),this.timeoutId=this.host.setTimeout((()=>{if(this.host.clearTimeout(this.timeoutId),this.rebootPending){this.logger.log("Timeout waiting for Core to finish running App jobs in LongInactive client state. Rebooting now...");const{reason:e,commandSource:t,options:n}=this.rebootPending;this.rebootApp(e,t,n)}}),2e3)}isExperienceIdleStateChangedEvent(e){return e.type===l_.yU.ExperienceIdleStateChanged&&e.context.isIdle}}class KJ extends fe{constructor(){super(he.Yg.CreateReboot,["clientState","experienceChangeReportingService","hostCommunicationService","lifeCycleScopeChangeReportingService","localStorage","loggerFactory","networkState","platformService","scenarioFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,experienceChangeReportingService:n,hostCommunicationService:i,lifeCycleScopeChangeReportingService:a,localStorage:o,loggerFactory:r,networkState:s,platformService:l,scenarioFactory:c,windowProvider:d}=e;e.rebootService=new QJ(r,d,t,s,l,n,a,i,o,c)}))}}var YJ=n(31902),XJ=n(438332);class ZJ extends fe{constructor(){super(he.Yg.CreateRouting,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e.config.forceUseBrowserHistory||!e.windowProvider||""===e.windowProvider.location.hash?(0,YJ.lX)({basename:e.config.basePath}):(0,YJ.q_)({basename:e.config.basePath});e.history=t,e.routingServices=(0,XJ.I)(e.loggerFactory,e.history,e.windowProvider&&e.windowProvider.location)}))}}class eQ{constructor(e,t){this.statsPerIdMap=new Map,this.startTimeMap=new Map,this.telemetryReportInterval=0,this.globalStats={maxInQueueTaskCount:0,totalLatencyTime:0,executedTaskCount:0,maxLatency:0,reportSequence:0,queueSize:0},this.logger=e.newLogger("PostTaskSchedulerDiagnosticsService","core-services-scheduling"),this.host=t}subscribeToCoreSettings(e){e.getObservable(L.J.Core,["schedulerTelemetryIntervalMS"]).subscribe((e=>{if(e.schedulerTelemetryIntervalMS){const t=e.schedulerTelemetryIntervalMS;this.telemetryReportInterval!==t&&(this.telemetryReportInterval=t,this.initializeTelemetryReporter(t))}}))}markTaskEnqueued(e,t){this.startTimeMap.set(e,performance.now());let n=this.statsPerIdMap.get(t);n||(n={executedTaskCount:0,maxLatency:-1,totalLatencyTime:0,totalLatencyTimeThisReport:0}),this.statsPerIdMap.set(t,n),this.globalStats.queueSize++,this.globalStats.queueSize>this.globalStats.maxInQueueTaskCount&&(this.globalStats.maxInQueueTaskCount=this.globalStats.queueSize)}markTaskDequeued(e,t){const n=this.statsPerIdMap.get(t),i=this.startTimeMap.get(e);if(!i)return;this.startTimeMap.delete(e),this.globalStats.executedTaskCount++,this.globalStats.queueSize--;const a=Math.round(performance.now()-i);this.globalStats.totalLatencyTime+=a,a>this.globalStats.maxLatency&&(this.globalStats.maxLatency=a),n&&(n.totalLatencyTime+=a,n.totalLatencyTimeThisReport+=a,n.executedTaskCount++,a>n.maxLatency&&(n.maxLatency=a))}initializeTelemetryReporter(e){this.clearTelemetryInterval(),e>=6e4&&(this.telemetryIntervalId=this.host.setInterval((()=>this.reportTelemetry()),e))}clearTelemetryInterval(){this.telemetryIntervalId&&(this.host.clearInterval(this.telemetryIntervalId),this.telemetryIntervalId=0)}reportTelemetry(){var e,t;0!==this.globalStats.maxInQueueTaskCount&&(null===(t=(e=this.logger).infoToTelemetry)||void 0===t||t.call(e,"send-log-to-console-and-diagnostics","webclient_framework_foundation_post_task_scheduler_diagnostics",{maxSchedulerWaitLatency:this.globalStats.maxLatency,maxSchedulerQueueSize:this.globalStats.maxInQueueTaskCount,totalTaskWaitLatency:this.globalStats.totalLatencyTime,totalExecutedTaskCount:this.globalStats.executedTaskCount,sequence:this.globalStats.reportSequence}),this.statsPerIdMap.forEach(((e,t)=>{var n,i;null===(i=(n=this.logger).infoToTelemetry)||void 0===i||i.call(n,`send-log-to-console-and-diagnostics-${t}`,"webclient_framework_foundation_post_task_scheduler_diagnostics",{maxSchedulerWaitLatency:e.maxLatency,totalTaskWaitLatency:e.totalLatencyTime,totalExecutedTaskCount:e.executedTaskCount,sequence:this.globalStats.reportSequence}),e.totalLatencyTimeThisReport=0})),this.globalStats.reportSequence++)}}class tQ extends fe{constructor(){super(he.Yg.CreateSchedulerTask,["schedulerChangeReporting","loggerFactory","diagnosticsService","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{diagnosticsService:t,loggerFactory:n,schedulerChangeReporting:i,windowProvider:a}=e,o=new eQ(n,a),r=new zI(i,window,n,he.QU,o);e.postTaskSchedulerDiagnosticsService=o,e.scheduler=r,t.setScheduler(r)}))}}class nQ{constructor(e,t,n,a,o,r,s){this.experienceChangeReportingService=e,this.commandChangeReportingService=t,this.appsRegistryService=n,this.scheduler=a,this.hostComms=o,this.userKey=r,this.context=s,this.mainWindowDisplayedChange={windowId:null,eventFired:!1},this.processExperienceChangeChange=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){e.type===l_.yU.UserConsentedToConsumeResources&&(this.layoutRenderedChange&&(this.layoutRenderedChange=void 0),this.userConsentedChange=e),e.type===l_.FV.LayoutRenderComplete&&!0===e.isMainWindow&&(this.layoutRenderedChange=e),this.tryToSendSignal()})),this.onWindowVisibilityChanged=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t;const n=yield this.isMainWindowForActiveUserContext(e.windowId);if(!e.visible||this.mainWindowDisplayedChange&&(null===(t=this.mainWindowDisplayedChange)||void 0===t?void 0:t.eventFired))e.visible||(n&&(this.mainWindowDisplayedChange.windowState=yield this.getWindowState(e.windowId)),this.mainWindowDisplayedChange.eventFired=!1,this.mainWindowDisplayedChange.windowId=null);else{if(!n)return;this.mainWindowDisplayedChange.windowId=e.windowId,this.tryToSendSignal()}}))}init(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.experienceChangeReportingServiceSubscription=this.experienceChangeReportingService.observeChanges().pipe((0,jw.h)((e=>e.userContextId===this.userKey))).subscribe(this.processExperienceChangeChange),this.commandChangeReportingServiceSubscription=this.commandChangeReportingService.observeChanges().pipe((0,jw.h)((e=>e.userContextId===this.userKey&&!!e.isMainWindow&&e.type===wC.B.WindowCreated&&e.context.layoutMode===d.lO.standard))).subscribe((e=>{this.mainWindowRenderedChange=e,this.tryToSendSignal()}));const t=yield this.hostComms.loadModule("windowcontrols");this.windowVisibilityChangeSubscription=null===(e=null==t?void 0:t.registerForWindowVisibilityChanged)||void 0===e?void 0:e.call(t,this.onWindowVisibilityChanged)}))}dispose(){this.experienceChangeReportingServiceSubscription&&this.experienceChangeReportingServiceSubscription.unsubscribe(),this.commandChangeReportingServiceSubscription&&this.commandChangeReportingServiceSubscription.unsubscribe(),this.windowVisibilityChangeSubscription&&this.windowVisibilityChangeSubscription()}tryToSendSignal(){if(!this.shouldSendSignal())return;const e=this.appsRegistryService.registeredApps;this.scheduler.schedule((()=>{e.forEach((e=>{e.UNSAFE_onSignal&&e.UNSAFE_onSignal({type:"main_window_rendered",userContextId:this.userKey},this.context)}))}),{id:"on-signal-job",priority:DI.vW.Macro,scheduledById:"signal-processor"},(0,Ye.v4)()),this.reset()}isMainWindowForActiveUserContext(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield(0,RN.jW)(this.context.client);return e===(null==t?void 0:t.id)&&t.userContextId===this.userKey}))}getWindowState(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostComms.loadModule("windowcontrols");return null===(t=null==n?void 0:n.getWindowState)||void 0===t?void 0:t.call(n,e)}))}shouldSendSignal(){return this.windowHasBeenCreatedAndSignalsHaveFired()||this.windowHasToggledVisibilityAndWasNotMinimizedOrRestored()}windowHasBeenCreatedAndSignalsHaveFired(){return!!this.userConsentedChange&&!!this.mainWindowRenderedChange&&!!this.layoutRenderedChange}windowHasToggledVisibilityAndWasNotMinimizedOrRestored(){return!(!this.userConsentedChange||!this.mainWindowDisplayedChange.windowId||this.mainWindowDisplayedChange.eventFired||this.windowWasMinimized())}windowWasMinimized(){var e;return!0===(null===(e=this.mainWindowDisplayedChange.windowState)||void 0===e?void 0:e.minimized)}reset(){this.mainWindowRenderedChange=void 0,this.layoutRenderedChange=void 0,this.mainWindowDisplayedChange.eventFired=!0}}class iQ extends fe{constructor(){super(he.Yg.CreateSignalProcessor,["appsRegistryService","experienceChangeReportingService","client","coreSettings","entityCommanding","loggerFactory","platformService","scenarioFactory","scheduler","hostCommunicationService","commandChangeReportingService","authenticationUser","userBiService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,experienceChangeReportingService:n,client:i,coreSettings:a,entityCommanding:o,loggerFactory:r,platformService:s,scenarioFactory:l,scheduler:c,hostCommunicationService:d,commandChangeReportingService:u,authenticationUser:m,userBiService:g}=e,p=new nQ(n,u,t,c,d,(0,di.b4)(m),{client:i,coreSettings:a,entityCommanding:o,loggerFactory:r,platformService:s,scenarioFactory:l,userBiService:g});return p.init(),()=>{p.dispose()}}))}}var aQ=n(605064);class oQ extends fe{constructor(){super(he.Yg.TelemetryContext,["loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e.loggerFactory.newLogger("CreateTelemetryContextTask","core-services-tasks");e.telemetryContextService=new aQ.v(t)}))}}class rQ{constructor(e){this.authenticationService=e,this._userContextIds=new Set,this._accountModeObservable=new xw.X(si.SingleAccount)}init(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this._syncWithAuthServicePromise||(this._syncWithAuthServicePromise=this.syncWithAuthenticationService()),this._syncWithAuthServicePromise}))}trackUser(e){this._userContextIds.add(e),this.updateExperienceAccountMode()}removeUser(e){this._userContextIds.delete(e),this.updateExperienceAccountMode()}getAuthenticatedUsers(){return this._userContextIds}has(e){return this._userContextIds.has(e)}getAccountMode(){return this._accountModeObservable.value}getAccountModeObservable(){return this._accountModeObservable.pipe((0,qN.x)())}syncWithAuthenticationService(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){((yield null===(t=(e=this.authenticationService).getCachedUsers)||void 0===t?void 0:t.call(e,{id:Xe()(),scenarioName:it.RG.AuthWebCachedUser,source:"UserTrackingService::syncWithAuthenticationService"},{isAllCachedUsers:!0}))||[]).forEach((e=>{this._userContextIds.add((0,di.b4)((0,di.KQ)(e)))})),this.updateExperienceAccountMode()}))}updateExperienceAccountMode(){this._accountModeObservable.next(this._userContextIds.size>1?si.MultipleAccounts:si.SingleAccount)}}class sQ extends fe{constructor(){super(he.Yg.CreateTrackUserServiceTask,["authenticationService","coreSettings"])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:n,coreSettings:i}=e,a=new rQ(n);(null===(t=i.get(L.J.Core))||void 0===t?void 0:t.initializeMTMAModeOnStartup)&&(yield a.init()),e.userTrackingService=a}))}}class lQ extends fe{constructor(){super(he.Yg.CreateUserDataClient,["scenarioFactory","loggerFactory","windowProvider","coreSettings","client"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e.client)throw new Error("CreateUserDataClientTask: core data client doesn't exist, cannot initialize user client");const t=yield function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{networkState:i,coreSettings:o,leakDetectorService:r,platformService:s,config:l,graphqlStoreStatsReporterService:c}=e,d=new Qx.pS,u=(0,JA.UZ)(ye.l,i.observeIsOnline()),m=Object.assign(Object.assign({},e),{pubsub:d,send:u}),g=Tj.clientResolvers;if(!g)throw new Error("Client resolvers should be created at this point");const{maxApolloResultCacheSize:p,enableViewSchema:v,enableApolloDoubleWriteFix:h}=o.get(L.J.Core),{enableApolloDevtools:f}=o.get(L.J.Diagnostics),y=null!=p?p:void 0,b=null==r?void 0:r.create(),S=(null==e?void 0:e.authenticationUser)&&(0,di.b4)(e.authenticationUser),k=Dz({leakDetector:b,userContextId:S,windowId:he.ew,entityType:n,viewportContext:"cmd"},void 0,g,y,e.loggerFactory,e.scenarioFactory,void 0,f,Kx.t.cmd,c,h);sM(k,`mtma-cmd-${(null===(a=null==e?void 0:e.authenticationUser)||void 0===a?void 0:a.loginUserName)||"nouser"}`,Boolean(f),s,l.experienceName);const w=Nz.createUserDataRequestContext(m,k),C=yield aO.createLink(Object.assign({contextValue:w},m));k.setLink(C);const _=Fz(e,d,b,C,e.loggerFactory,e.scenarioFactory,g,S);let T;v&&(T=Rz(e,0,b,aO.createViewSchemaLink(e),e.loggerFactory,e.scenarioFactory));const{dataOpsTracker:I,dataEvictionService:E}=t.getServices();return new Nj({pubsub:d,leakDetector:b,scenarioFactory:w.scenarioFactory,coreSettings:w.coreSettings,dataOpsTracker:I,dataEvictionService:E,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},t,_,w,T)}))}(e,e.client,C.pyR.default);return e.client=t,e=>{switch(e){case"signout":case"quit":t.destroy()}}}))}}var cQ=n(26653),dQ=n(992846),uQ=n(291433),mQ=n(864355),gQ=n(180236);const pQ="prod",vQ="general";function hQ(e,t,n){let i,a,o;if(n){const e=n.expConfigMetadata.find((e=>e.client===gQ.j)),t=n.expConfigMetadata.find((e=>e.client===gQ.t));i=null==e?void 0:e.config.eTag,a=null==t?void 0:t.config.eTag,o=n.expConfigMetadata.map((e=>e.config.expIds)).filter((e=>e.length>0)).join(",")}else i=e.eTag||void 0,a=e.hostETag||void 0,e.configIds&&e.configIds.experiments&&(o=e.configIds.experiments.join(","));const r=function(e,t){var n;const i=e.ring&&e.ring.id||vQ;if(t)return i;const a=null===(n=e.region)||void 0===n?void 0:n.toLowerCase(),o="gcc"===a?a:e.environment||pQ;switch(o){case pQ:return i;case"gcc":return`${i}_gcc`;default:return`${o}-${i}`}}(e,t);return{ring:r,eTag:i,hostETag:a,expIds:o,environment:e.environment||void 0}}class fQ{constructor(e){this._top=-1,this._isFilled=!1,this._buffer=new Array(e),this.capacity=e}add(e){this._top=(this._top+1)%this.capacity,this._buffer[this._top]=e,this._top===this.capacity-1&&(this._isFilled=!0)}getItemFromLast(e){if(-1===this._top||e>=this.capacity||!this._isFilled&&this._top-e<0)return;const t=this._top-e>=0?this._top-e:this.capacity- -1*(this._top-e);return this._buffer[t]}}class yQ{constructor(e){this.eventMarks=new fQ(e&&e>0?e:100)}markEvent(e){this.markEventOverrideTimestamp(e,Date.now())}markEventOverrideTimestamp(e,t){var n;null===(n=this.eventMarks)||void 0===n||n.add({ts:t,name:e})}getEventsBetweenStartAndLast(e){if(!this.eventMarks)return[];const t=[];let n;for(let i=1;n=this.eventMarks.getItemFromLast(i),n&&!(n.ts<e);i++)t.push(n.name);return t}getEventsBetween(e,t){if(!this.eventMarks)return[];const n=[];let i;for(let a=0;i=this.eventMarks.getItemFromLast(a),i&&!(i.ts<e);a++)i.ts<t&&n.push(i.name);return n}}function bQ(e){return new yQ(e)}var SQ;!function(e){e.Action="panelaction",e.View="panelview"}(SQ||(SQ={}));class kQ{constructor(e,t=""){this.contextData=e,this.userContextId=t,this.clickStreamBatchInSeconds=75,this.clickStreamMaxBatchSize=15,this.getBatchNumber=()=>this.userBiCache.batchNumber,this.emptyCacheWithoutRestarting=()=>{this.recordClickStreamEvent({isTimeOut:!1,isBatchSize:!1,disableSetTimeout:!0})},this.addEventToUserBiCache=(e,t)=>{"panelaction"===t?(this.userBiCache.actionCount=this.userBiCache.actionCount+1,e["EventInfo.BaseType"]=SQ.Action):(this.userBiCache.viewCount=this.userBiCache.viewCount+1,e["EventInfo.BaseType"]=SQ.View),this.userBiCache.events.push(e),this.userBiCache.events.length>=this.clickStreamMaxBatchSize&&this.recordClickStreamEvent({isTimeOut:!1,isBatchSize:!0})},this.cacheClickStreamToLocalStorage=()=>{var e;this.userBiCache.events.length>0&&this.telemetrySettings.enableClickStreamUnloadCache&&(null===(e=this.contextData.localStorage)||void 0===e||e.set("clickstream_cache",JSON.stringify(this.userBiCache)))},this.setUpHostListeners=()=>{this.host.addEventListener("beforeunload",(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){this.cacheClickStreamToLocalStorage(),this.emptyCacheWithoutRestarting(),yield this.telemetryProvider.flush()}))))},this.localStorageFlush=()=>{var e,t;if(this.telemetrySettings.enableClickStreamUnloadCache){const n=null===(e=this.contextData.localStorage)||void 0===e?void 0:e.get("clickstream_cache"),i=JSON.parse(n);n&&(0,CI.P3)(uQ.x.ClickStream,"clickstream_cached",i,void 0,{columnName:"events",packedData:i.events},void 0,this.userContextId),null===(t=this.contextData.localStorage)||void 0===t||t.remove("clickstream_cache")}},this.setBatchTimeandSize=e=>{e===(Pe.Bh.Desktop||Pe.Bh.Maglev)?(this.clickStreamBatchInSeconds=this.telemetrySettings.clickStreamBatchInSeconds||75,this.clickStreamMaxBatchSize=this.telemetrySettings.clickStreamMaxBatchSize||15):(this.clickStreamBatchInSeconds=this.telemetrySettings.clickStreamBatchInSecondsWeb||30,this.clickStreamMaxBatchSize=this.telemetrySettings.clickStreamMaxBatchSizeWeb||5)},this.setupClickStreamTimeout=()=>this.contextData.windowProvider.setTimeout((()=>{this.recordClickStreamEvent({isTimeOut:!0,isBatchSize:!1})}),1e3*this.clickStreamBatchInSeconds),this.recordClickStreamEvent=e=>{if(this.userBiCache.actionCount>0||this.userBiCache.viewCount>0){this.userBiCache.batchFlushed=e.isBatchSize,this.userBiCache.timeoutFlushed=e.isTimeOut;const t=this.userBiCache;this.telemetrySettings.disable1DSBatching&&(t.latency=4),(0,CI.P3)(uQ.x.ClickStream,"clickstream",t,void 0,{columnName:"events",packedData:t.events},void 0,this.userContextId),this.userBiCache={events:[],batchStartTime:(new Date).toISOString(),viewCount:0,actionCount:0,batchNumber:t.batchNumber+1,batchFlushed:!1,timeoutFlushed:!1}}this.contextData.windowProvider.clearTimeout(this.currentTimeoutId),e.disableSetTimeout||(this.currentTimeoutId=this.setupClickStreamTimeout())},this.userBiCache={events:[],batchStartTime:(new Date).toISOString(),viewCount:0,actionCount:0,batchNumber:1,batchFlushed:!1,timeoutFlushed:!1},this.telemetrySettings=this.contextData.coreSettings.get(L.J.Telemetry);const n=this.contextData.platformService.config.clientType;this.setBatchTimeandSize(n),this.currentTimeoutId=this.setupClickStreamTimeout(),this.host=this.contextData.windowProvider,this.localStorageFlush(),this.host&&this.setUpHostListeners(),this.telemetryProvider=(0,pT.G)()}}var wQ=n(197670);class CQ{constructor(e,t){var n,a;if(this.context=e,this.windowId=t,this.biEventObserver=new K_.xQ,this.experimentationEventData={},this.telemetrySettings={},this.panelContextData={},this.dataBagContextData={},this.windowSlotContext={},this.userContextId="",this._dataBags=[],this.recordPanelView=(e,t,n)=>{const i=this.getCombinedContextData(n),a=this.getCombinedDataBagData(n);this.recordBiEvent({eventName:"panelview",data:Object.assign(Object.assign(Object.assign({},this.windowSlotContext),a),IQ(Object.assign(Object.assign({},i),e)))},t)},this.recordPanelAction=(e,t,n)=>{var i;const a=this.getCombinedContextData(n),o=this.getCombinedDataBagData(n);this.recordBiEvent({eventName:"panelaction",data:Object.assign(Object.assign(Object.assign({},this.windowSlotContext),o),_Q(Object.assign(Object.assign({},a),e)))},t),null===(i=this.eventTimeTracker)||void 0===i||i.markEvent(`${e.actionOutcome}-${e.actionScenario}-${e.panelType}-${e.threadType}`)},this.setBISlotContext=e=>{this.windowSlotContext=Object.assign(Object.assign({},this.windowSlotContext),e)},this.createDatabag=()=>{const e=new wQ.S;return this._dataBags.push(e),e.setDispose((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){yield(0,EA._)(0);const t=this._dataBags.findIndex((t=>t.id===e.id));this._dataBags.splice(t,1)})))),e},this.appendBiData=(e,t)=>{const{dataBag:n}=t,a=(0,i.__rest)(t,["dataBag"]),o=EQ(Ja.sz,e);this.dataBagContextData[o]=Object.assign(Object.assign({},this.dataBagContextData[o]),null==n?void 0:n.data),this.panelContextData[o]=Object.assign(Object.assign({},this.panelContextData[o]),a)},this.removeBiData=(e,t)=>{var n,i;const a=EQ(Ja.sz,e);if(t)for(const e of t)this.dataBagContextData&&(null===(n=this.dataBagContextData[a])||void 0===n||delete n[e]),this.panelContextData&&(null===(i=this.panelContextData[a])||void 0===i||delete i[e]);else delete this.dataBagContextData[a],delete this.panelContextData[a]},this.recordTestOnlyTelemetry=()=>{var e;const t=null===(e=this.context)||void 0===e?void 0:e.coreSettings.get(L.J.Telemetry).testOnlyUserbiTelemetry;t&&this.recordPanelAction(JSON.parse(t))},(null===(n=this.context)||void 0===n?void 0:n.authenticationUser)&&(this.userContextId=this.context.authenticationUser.id),null===(a=this.context)||void 0===a?void 0:a.coreSettings){const{disableRingNamePrefixing:e}=this.context.coreSettings.get(L.J.Telemetry),{enableSmbUserIntentUserBiTelemetry:t}=this.context.coreSettings.get(L.J.Growth),{enableCallingPerfCollectorService:n,enableCallingLongTasksTracking:i,enableCallingLongTasksTriggerFinder:a}=this.context.coreSettings.get(L.J.Calling);this.includeSmbUserIntentData=Boolean(t);const o=this.context.coreSettings.getObservable(L.J.Metadata);this.metadataSubscription=o.subscribe((t=>{var n;this.experimentationEventData=function(e,t,n){const i={},a=hQ(e,t,n);return i["UserInfo.Ring"]=a.ring,i["UserInfo.ETag"]=a.eTag,i["UserInfo.HostETag"]=a.hostETag,i["AppInfo.ExpIds"]=a.expIds,i["AppInfo.Environment"]=a.environment,i}(t,!!e,null===(n=this.context)||void 0===n?void 0:n.experimentationService)})),this.environment=this.context.coreSettings.get(L.J.Metadata).environment,this.telemetrySettingsSubscription=this.context.coreSettings.getObservable(L.J.Telemetry).subscribe((e=>this.onReceiveTelemetrySettings(e))),this.clientType=this.context.platformService.config.clientType,this.clientType===Pe.Bh.Maglev&&this.windowId!==he.ew&&this.subscribeToMaglevWindowState(),n&&i&&a&&(this.eventTimeTracker=bQ()),this.context.coreSettings.get(L.J.Telemetry).enableTestOnlyTelemetry&&this.recordTestOnlyTelemetry()}}getEventsWithinTimeframe(e,t){var n;return(null===(n=this.eventTimeTracker)||void 0===n?void 0:n.getEventsBetween(e,t))||[]}getWindowId(){return this.windowId}destroy(){var e;this.metadataSubscription&&this.metadataSubscription.unsubscribe(),this.telemetrySettingsSubscription&&this.telemetrySettingsSubscription.unsubscribe(),this.clickStreamService&&this.clickStreamService.emptyCacheWithoutRestarting(),this.windowStateSubcription$&&this.windowStateSubcription$.unsubscribe(),this.unregisterForWindowStateChanged&&this.unregisterForWindowStateChanged(),(null===(e=this.smbUserIntentSubcription)||void 0===e?void 0:e.unsubscribe)&&this.smbUserIntentSubcription.unsubscribe(),this._dataBags.length&&(this._dataBags=[])}initializeAndSubscribeToSmbUserIntent(){var e,t;if(this.environment===s_.s.life&&this.includeSmbUserIntentData&&(null===(e=this.context)||void 0===e?void 0:e.client)){const{smbUserIntentUserBiTelemetryPollInterval:e}=null===(t=this.context)||void 0===t?void 0:t.coreSettings.get(L.J.Growth),a=36e5,o=null!=e?e:a;return(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e,t;const i=yield(0,c.mT)((()=>n.e(309342).then(n.bind(n,592352))),"services-io-data-smb-user-intent").then((e=>e.smbUserIntentDocument));this.smbUserIntentSubcription=null===(t=null===(e=this.context)||void 0===e?void 0:e.client)||void 0===t?void 0:t.watchQuery({query:i,pollInterval:Number(o),fetchPolicy:"no-cache"}).subscribe((e=>{var t;(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.smbUserIntent)&&(this.smbUserIntent=e.data.smbUserIntent)}))})))(),()=>{var e;"function"==typeof(null===(e=this.smbUserIntentSubcription)||void 0===e?void 0:e.unsubscribe)&&this.smbUserIntentSubcription.unsubscribe()}}}getDataFromBaseInstance(){var e,t,n;return{"UserInfo.SmbUserIntent.Intent":null===(e=this.smbUserIntent)||void 0===e?void 0:e.smbUserIntent,"UserInfo.SmbUserIntent.IntentScore":null===(t=this.smbUserIntent)||void 0===t?void 0:t.smbUserIntentScore,"UserInfo.SmbUserIntent.ConfidenceScore":null===(n=this.smbUserIntent)||void 0===n?void 0:n.smbConfidenceScore}}bubbleUpObservable(e){var t,n,i;this.biEventObserver.next(e),null===(i=null===(n=null===(t=this.context)||void 0===t?void 0:t.parentUserBiService)||void 0===n?void 0:n.bubbleUpObservable)||void 0===i||i.call(n,e)}observe(){return this.biEventObserver.asObservable()}onReceiveTelemetrySettings(e){this.telemetrySettings=e,this.context&&this.telemetrySettings.enableClickStreamEvents&&!this.clickStreamService&&(this.clickStreamService=new kQ({coreSettings:this.context.coreSettings,windowProvider:this.context.windowProvider,platformService:this.context.platformService,localStorage:this.context.localStorage},this.userContextId))}recordBiEvent(e,t){this._applyContextData(e),this.includeSmbUserIntentData&&this.applySmbUserIntentData(e);const n=function(e){const t={};return Object.keys(e).forEach((n=>{(0,a.isNil)(e[n])||(t[n]=e[n])})),t}(e.data),i="EventInfo.Identifier"in e.data?e.data["EventInfo.Identifier"]:void 0;if(this.telemetrySettings.enableClickStreamEvents&&this.clickStreamService){const t=(e.eventName,n);this.telemetrySettings.enableDualClickStreamEvents&&(n.batchNumber=this.clickStreamService.getBatchNumber(),(0,CI.P3)(uQ.x.UserBI,e.eventName,n,void 0,void 0,this.telemetrySettings.enableUserBiEventIdentifiers?i:void 0,this.userContextId)),this.clickStreamService.addEventToUserBiCache(t,e.eventName)}else(0,CI.P3)(uQ.x.UserBI,e.eventName,n,void 0,void 0,this.telemetrySettings.enableUserBiEventIdentifiers?i:void 0,this.userContextId);t&&(t.debug(`Analytics: EventType: ${e.eventName}`),t.debug(`Analytics: Type: ${n["Panel.Type"]}`),t.debug("Analytics: Payload:",n)),this.bubbleUpObservable({eventName:e.eventName,data:n})}_applyContextData(e){var t,n,i,a,o,r,s,l,c,d,u;e.data["Panel.WindowID"]=this.windowId,e.data["EventInfo.CorrelationId"]=null===(n=null===(t=this.context)||void 0===t?void 0:t.correlation)||void 0===n?void 0:n.id;const m=null!==(i=this.windowIsVisible)&&void 0!==i?i:null===(a=this.context)||void 0===a?void 0:a.windowProvider.isFocused();e.data["Window.Focus"]=m?cQ.cb.foreground:cQ.cb.background;const g=m?cQ.Lv.maximized:cQ.Lv.minimized;if(e.data["Window.Status"]=g,e.data["Window.Height"]=null===(o=this.context)||void 0===o?void 0:o.windowProvider.innerHeight,e.data["Window.Width"]=null===(r=this.context)||void 0===r?void 0:r.windowProvider.innerWidth,e.data["Window.ViewportContext"]=null===(s=this.context)||void 0===s?void 0:s.windowProvider.viewportContext,null===(l=this.context)||void 0===l?void 0:l.authenticationUser){const t=this.environment===s_.s.life?null===(c=this.context)||void 0===c?void 0:c.authenticationUser.profile.paddedMsaId:null===(d=this.context)||void 0===d?void 0:d.authenticationUser.profile.objectId;e.data["UserInfo.Id"]=t,e.data["UserInfo.TenantId"]=null===(u=this.context)||void 0===u?void 0:u.authenticationUser.profile.tenantId}e.data=Object.assign(Object.assign({},e.data),this.experimentationEventData)}getCombinedContextData(e){let t={};if(e)for(const n of e){const e=EQ(Ja.sz,n);t=Object.assign(Object.assign({},t),this.panelContextData[e])}return t}getCombinedDataBagData(e){let t={};if(e)for(const n of e){const e=EQ(Ja.sz,n);t=Object.assign(Object.assign({},t),this.dataBagContextData[e])}return t}subscribeToMaglevWindowState(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.windowControlsModule&&this.context){this.windowControlsModule=yield this.context.hostCommunicationService.loadModule("windowcontrols"),this.windowState$=new Y_.y((e=>{var t;this.windowControlsModule&&this.windowControlsModule.registerForWindowStateChanged&&(this.unregisterForWindowStateChanged=null===(t=this.windowControlsModule)||void 0===t?void 0:t.registerForWindowStateChanged((t=>{if(!t.windowId||this.windowId&&t.windowId===this.windowId){const n=!t.placement.minimized;e.next(n)}})))}));const e=e=>{this.windowIsVisible=e};this.windowStateSubcription$=this.windowState$.subscribe(e)}}))}applySmbUserIntentData(e){var t,n,i,a;const o="function"==typeof(null===(n=null===(t=this.context)||void 0===t?void 0:t.parentUserBiService)||void 0===n?void 0:n.getDataFromBaseInstance)?null===(a=null===(i=this.context)||void 0===i?void 0:i.parentUserBiService)||void 0===a?void 0:a.getDataFromBaseInstance():void 0;o&&(e.data["UserInfo.SmbUserIntent.Intent"]=o["UserInfo.SmbUserIntent.Intent"],e.data["UserInfo.SmbUserIntent.IntentScore"]=o["UserInfo.SmbUserIntent.IntentScore"],e.data["UserInfo.SmbUserIntent.ConfidenceScore"]=o["UserInfo.SmbUserIntent.ConfidenceScore"])}}function _Q(e){const{appName:t,actionGesture:n,actionOutcome:i,actionOutcomeNew:o,actionScenario:r,actionScenarioType:s,actionWorkload:l,actionSubworkload:c,actionInputDelay:d,moduleName:u,moduleNameNew:m,moduleType:g,moduleTypeNew:p,extensibilityData:v,tabId:h,tabIdNew:f,tabOrdinal:y,tabType:b,tabTypeNew:S,eventIdentifier:k,appId:w,appIsTenantApp:C,appCapabilityId:_,appScenarioCapability:T,appScope:I}=e,E=EQ(Ja.rA,u),N=EQ(Ja.PO,g),A=EQ(Ja.uS,n),F=EQ(Ja.Tk,r),D=(0,a.isNil)(k)?[E,N,A,F].filter(Boolean).join("_"):EQ(Ja.b6,k),R=Object.assign(Object.assign({"Action.Gesture":n,"Action.Outcome":i,"Action.OutcomeNew":o,"Action.Scenario":r,"Action.ScenarioType":s,"Action.WorkLoad":l,"Action.SubWorkLoad":c,"Module.Name":u,"Module.Type":g,"Module.NameNew":m,"Module.TypeNew":p,"Tab.Id":h,"Tab.Type":b,"Tab.IdNew":f,"Tab.TypeNew":S,"Tab.Ordinal":y,"App.Name":t,"App.Id":w,"App.IsTenantApp":C,"App.CapabilityId":_,"App.ScenarioCapability":T,"App.Scope":I},IQ(e)),TQ(v));return(0,a.isNil)(D)||(R["EventInfo.Identifier"]=D),(0,a.isNil)(d)||(R["Action.InputDelay"]=d),R}function TQ(e){if(e&&!(0,a.isEmpty)(e))return{"App.Id":e.id,"App.Name":e.name,"App.Scope":EQ(mQ.Mv,e.scope),"App.ScenarioCapability":EQ(mQ.Ky,e.scenarioCapability),"App.EntryPoint":EQ(mQ.sG,e.entryPoint),"App.ExternalId":e.externalId,"App.IsTenantApp":e.isTenantApp,"App.CapabilityId":e.capabilityId,"App.SceneId":e.sceneId,"Bot.Id":e.botId,"App.MsftPartnerAppID":e.mpnId,"App.Source":EQ(Up.RE,e.appDetailsEntryPoint),"App.FromSectionName":e.fromSectionName,"App.Capabilities":e.capabilities,"App.BotScopes":e.botScopes,"App.GalleryTabScopes":e.galleryTabScopes,"App.StaticTabScopes":e.staticTabScopes,"App.StaticTabName":e.staticTabName,"App.ConnectorScopes":e.connectorScopes,"App.ConnectorId":e.connectorId,"App.Version":e.version,"App.ManifestVersion":e.manifestVersion,"App.Categories":e.categories,"App.IsHostedApp":e.isHostedApp,"App.AppSource":e.appSource,"App.EventType":e.eventType}}function IQ(e){const{panelRegion:t,panelRegionNew:n,panelType:i,panelTypeNew:o,threadId:r,teamId:s,threadMembers:l,threadType:c,panelLaunchMethod:d,panelUri:u,dataBag:m,extensibilityData:g,eventIdentifier:p,entityType:v,mainSlotApp:h,mainEntityType:f,mainEntityAction:y,officeGroupId:b,moduleName:S,moduleType:k,callId:w,participantId:C}=e,_=EQ(Ja.Ai,t),T=EQ(Ja.wh,i),I=(0,a.isNil)(p)?[_,T].filter(Boolean).join("_"):EQ(Ja.b6,p);return Object.assign(Object.assign(Object.assign({"Panel.LaunchMethod":d,"Panel.Region":t,"Panel.Type":i,"Panel.RegionNew":n,"Panel.TypeNew":o,"Panel.Uri":u,"Module.Name":S,"Module.Type":k,"Thread.Id":r,"Team.Id":s,"Team.OfficeGroupId":b,"Call.Id":w,"Participant.Id":C,"Thread.Type":c,"Thread.Members":l,"TargetThread.Id":r,"TargetThread.Type":c,"EventInfo.Identifier":I,"Entity.Type":v},m&&m.data),TQ(g)),{"UserInfo.ChannelResourceTenant.Id":e["UserInfo.ChannelResourceTenant.Id"],"SlotConfig.MainSlotApp":h,"SlotConfig.MainEntityType":f,"SlotConfig.MainEntityAction":y})}function EQ(e,t){return(0,a.isNil)(t)?void 0:e[t]}class NQ{create(e,t,n,i,a,o,r){var s;const l=new Kw.m(i),c=new dQ.J(Object.assign(Object.assign({},e),{loggerFactory:l}),n,a,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,o),d=new CQ(t),u=new aQ.v(l.newLogger("SetUserOnTelemetryContextTask","core-services-telemetry"),o),m={coreScenarioFactory:c,userBiService:d,loggerFactory:l,telemetryContext:u,telemetryService:new AQ(c,u,a,{isolateUserContext:null!==(s=r.get(L.J.Telemetry).isolateUserContext)&&void 0!==s&&s})};return NQ._cache.set(o,m),m}destroy(e){var t,n,i,a;if(e){const o=NQ._cache.get(e);o&&(null===(n=(t=o.coreScenarioFactory).destroy)||void 0===n||n.call(t),null===(a=(i=o.userBiService).destroy)||void 0===a||a.call(i),NQ._cache.delete(e))}}get(e){let t;return e&&(t=NQ._cache.get(e)),t}clear(){NQ._cache.clear()}forEach(e){NQ._cache.forEach(e)}}NQ._cache=new Map;class AQ{constructor(e,t,n,i){this.coreScenarioFactory=e,this.coreTelemetryContext=t,this.memoryAnalyzer=n,this.isolateUserContext=!1,this.scenarioCancelOnNetworkStateChangeBlockList=new Set,this.scenarioCancelOnSuspendStateChangeBlockList=new Set,this.newCoreScenario=(e,t)=>this.coreScenarioFactory.newScenario(e,t),this.stopCoreScenarioIfActive=(e,t,n)=>this.coreScenarioFactory.stopScenarioIfActive(e,t,n),this.createScenarioFactory=(e,t,n,i,a,o="")=>{const{coreSettings:r}=e,{enableCreateWindowLaunchScenarioOnMainWindow:s}=r.get(L.J.Core);return new dQ.J({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:n},parseInt(n.startTimestamp,10)||Date.now(),this.memoryAnalyzer,t,i,this.coreInitTimestamp,!!s||t!==he.ew,void 0,void 0,void 0,{"Window.ViewportContext":a},o||this.coreTelemetryContext.userId)},this.createUserBiService=(e,t,n)=>new CQ({authenticationUser:e.authenticationUser,coreSettings:e.coreSettings,windowProvider:e.windowProvider,platformService:e.platformService,experimentationService:e.experimentationService,hostCommunicationService:e.hostCommunicationService,client:e.client,localStorage:e.localStorage,parentUserBiService:e.userBiService,correlation:n},t),this.setCoreContext=(e,t,n)=>{this.coreTelemetryContext.setContext(e,t,n)},this.setContext=(e,t,n,i="")=>{this.coreTelemetryContext.setContext(e,t,n,i)},this.setDeviceAuthToken=e=>{this.coreTelemetryContext.setDeviceAuthToken(e)},this.setUserId=e=>{this.coreTelemetryContext.setUserId(e)},this.getTelemetryContextService=()=>this.coreTelemetryContext,this.setTelemetryContextService=e=>{this.coreTelemetryContext=e},this.logOutUser=e=>{(0,pT.G)().logOutUser(e)},this.onHostStateChange=e=>{if(e.suspendedState===yC.V9.Suspending&&e.suspendedState!==this.previousHostSuspendState){const e=e=>{this.scenarioCancelOnSuspendStateChangeBlockList.has(e.name)||e.cancel({reason:"suspending"})};this.getTelemetryServicesCache().forEach((t=>{t.coreScenarioFactory.processOnRunningScenarios(e)})),this.coreScenarioFactory.processOnRunningScenarios(e)}this.previousHostSuspendState=e.suspendedState},this.onNetworkStateChange=e=>{if(e===Pf.G.Offline){const e=e=>{this.scenarioCancelOnNetworkStateChangeBlockList.has(e.name)||e.cancel({reason:"network offline"})};this.getTelemetryServicesCache().forEach((t=>{t.coreScenarioFactory.processOnRunningScenarios(e)})),this.coreScenarioFactory.processOnRunningScenarios(e)}},AQ._telemetryServicesCache||(AQ._telemetryServicesCache=new NQ);const{isolateUserContext:a}=i;this.isolateUserContext=a}destroy(){var e,t;null===(e=this.telemetrySuspendStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this.telemetryNetworkStateSubscription)||void 0===t||t.unsubscribe()}getMemoryAnaylzer(){return this.memoryAnalyzer}setCoreInitTime(e){var t,n;this.coreInitTimestamp=e,null===(n=(t=this.coreScenarioFactory).setCoreInitTime)||void 0===n||n.call(t,e)}setAuthContext(e){const{id:t,oid:n,tid:i,type:a,role:o,subType:r}=e,s=(e,n)=>{this.isolateUserContext?this.setContext(e,n,void 0,t):this.setCoreContext(e,n)};void 0!==t&&s("userId",t===n?"":t),void 0!==n&&s("UserInfo.Id",n),void 0!==i&&s("UserInfo.TenantId",i),void 0!==a&&s("UserInfo.Type",a),void 0!==o&&s("UserInfo.Role",o),void 0!==r&&s("UserInfo.SubType",r)}getTelemetryServicesCache(){return AQ._telemetryServicesCache}initTelemetrySuspendStateSubscription(e,t){this.telemetrySuspendStateSubscription||(this.scenarioCancelOnSuspendStateChangeBlockList=new Set(t),this.telemetrySuspendStateSubscription=e.observe().subscribe(this.onHostStateChange))}initTelemetryNetworkStateSubscription(e,t){this.telemetryNetworkStateSubscription||(this.scenarioCancelOnNetworkStateChangeBlockList=new Set(t),this.telemetryNetworkStateSubscription=e.observe().subscribe(this.onNetworkStateChange))}}class FQ extends fe{constructor(){super(he.Yg.SetUserOnTelemetryContext,["telemetryService","authenticationUser","coreSettings","loggerFactory","diagnosticsService","config","correlation","authenticationService","telemetryContextService","windowProvider","hostCommunicationService","platformService","scenarioFactory"])}execute(e){var t,n,a,o,r,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:l,coreSettings:c,loggerFactory:d,authenticationService:u,correlation:m,telemetryContextService:g,telemetryService:p}=e,v=d.newLogger("SetUserOnTelemetryContextTask","core-services-tasks");let h;if(c.get(L.J.Telemetry).useTelemetryServicesCache&&(h=p.getTelemetryServicesCache().get(l.id)),h)e.loggerFactory=h.loggerFactory,e.scenarioFactory=h.coreScenarioFactory,e.telemetryService=h.telemetryService,e.userBiService=h.userBiService,e.telemetryContextService=h.telemetryContext;else{const i=l.type===nd.Ch.MsaLife||c.get(L.J.Metadata).environment===s_.s.life,o=new aQ.v(v,l.id);e.loggerFactory=new Kw.m(e.diagnosticsService,e.correlation.id,l.id);const r=new dQ.J({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:e.correlation},e.config.startTimeMS,null===(t=e.telemetryService)||void 0===t?void 0:t.getMemoryAnaylzer(),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,l.id);e.scenarioFactory=r,e.telemetryService=new AQ(r,o,null===(n=e.telemetryService)||void 0===n?void 0:n.getMemoryAnaylzer(),{isolateUserContext:null!==(a=c.get(L.J.Telemetry).isolateUserContext)&&void 0!==a&&a}),i&&(l.profile.paddedMsaId=this.getPaddedMsaId(l.profile.objectId,v)),this.setAuthUserOnTelemetryContext(e.telemetryService,l,i)}const f=this.subscribeAndSetUserInfoTelemetryContext(e.telemetryService,l,c),y=null!==(o=c.get(L.J.Telemetry).disableMTMAPrimaryId)&&void 0!==o&&o;JI(y,g,u,m,v),null===(s=(r=e.authenticationService).registerEndTelemetryTask)||void 0===s||s.call(r,(e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t;p.setContext("UserInfo.IsMRU",void 0,void 0,e),f.unsubscribe();try{yield JI(y,g,u,m,v)}catch(e){null===(t=v.errorToTelemetry)||void 0===t||t.call(v,"Failed to update MRU or sync mtma context","telemetry_instrumentation_update_user_context")}yield(0,pT.G)().flush(),(0,pT.G)().logOutUser(e),c.get(L.J.Telemetry).useTelemetryServicesCache&&p.getTelemetryServicesCache().destroy(e)}))))}))}subscribeAndSetUserInfoTelemetryContext(e,t,n){return n.getObservable(L.J.UserResources).subscribe((n=>{const i=n.licenseType||void 0;switch(i&&e.setContext("UserInfo.LicenseType",i),t.role){case nd.w4.Member:n.isTenantAdmin||void 0?e.setContext("UserInfo.TenantRole",cQ.z7.Admin):e.setContext("UserInfo.TenantRole",cQ.z7.Regular);break;case nd.w4.Guest:e.setContext("UserInfo.TenantRole",cQ.z7.Guest);break;case nd.w4.Anonymous:e.setContext("UserInfo.TenantRole",cQ.z7.Anonymous)}}))}setAuthUserOnTelemetryContext(e,t,n){n&&t.profile.paddedMsaId&&this.setUserContext(e,t.profile.paddedMsaId);const i=n&&t.profile.paddedMsaId?t.profile.paddedMsaId:t.profile.objectId;e.setContext("UserInfo.Id",i),e.setContext("UserInfo.TenantId",t.profile.tenantId),e.setContext("UserInfo.Type",t.type),e.setContext("UserInfo.Role",t.role)}setUserContext(e,t){const n=t.slice(19).replace("-","");e.setUserId(t),e.setContext("UserInfo.Id",t),e.setContext("userId",n)}getPaddedMsaId(e,t){try{if(/(\w{8})-(\w{4})-(\w{4})-(\w{4})-(\w{12})/.exec(e)&&e.startsWith("00000000-0000-0000-"))return e;{const t=(0,a.padStart)(e,32,"0"),n=/(\w{8})(\w{4})(\w{4})(\w{4})(\w{12})/;return t.replace(n,"$1-$2-$3-$4-$5")}}catch(e){return void t.error("failed_user_padding")}}}class DQ extends fe{constructor(){super(he.Yg.CreateUserTelemetryServicesTask,["telemetryService","authenticationUser","diagnosticsService","coreSettings","loggerFactory","windowProvider","correlation","platformService","experimentationService","hostCommunicationService","client","scenarioFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,diagnosticsService:n,telemetryService:i,coreSettings:a,loggerFactory:o,windowProvider:r,correlation:s,platformService:l,experimentationService:c,hostCommunicationService:d,client:u,scenarioFactory:m}=e;a.get(L.J.Telemetry).useTelemetryServicesCache&&!i.getTelemetryServicesCache().get(t.id)&&i.getTelemetryServicesCache().create({coreSettings:a,loggerFactory:o,windowProvider:r,correlation:s,parentScenarioFactory:m},{authenticationUser:t,coreSettings:a,windowProvider:r,platformService:l,experimentationService:c,hostCommunicationService:d,client:u},Date.now(),n,i.getMemoryAnaylzer(),t.id,a)}))}}const RQ="serviceWorkerDeferInstallDurationInMs",xQ="enableServiceWorkerIntegrityCheck",MQ="enableServiceWorkerDynamicManifest",OQ="localeSettingValue",PQ="environment",LQ="clientType",UQ="swHandleCdlHashRoute",jQ="platformId",$Q="teams-service-worker-telemetry-v2",BQ="1",WQ="LogEvents",HQ="timestamp",VQ="teams-service-worker-v2",zQ="2",qQ="SwState",GQ="key";var JQ,QQ,KQ,YQ;!function(e){e.Install="install",e.Activate="activate",e.Fetch="fetch"}(JQ||(JQ={})),function(e){e.Intermediate="intermediate",e.Old="old"}(QQ||(QQ={})),function(e){e.Info="sw_info",e.InstallSuccess="sw_install_success",e.InstallFailure="sw_install_failure",e.ActivateSuccess="sw_activate_success",e.ActivateFailure="sw_activate_failure",e.FetchCacheMiss="sw_fetch_cache_miss",e.CleanupCacheSuccess="sw_cleanup_cache_success",e.CleanupCacheFailure="sw_cleanup_cache_failure",e.CleanupCacheRetry="sw_cleanup_cache_retry",e.CleanupNotRun="sw_cleanup_cache_not_run",e.CleanupNotRequired="sw_cleanup_cache_not_required",e.CorruptCache="sw_corrupt_cache",e.CorruptCacheDeleteSuccess="sw_corrupt_cache_delete_success",e.CorruptCacheDeleteFailure="sw_corrupt_cache_delete_failure",e.DeferInstallStarted="sw_install_defer_started",e.DeferInstallCancelled="sw_install_defer_cancelled",e.DeferInstallCancelledOnMaxIncomplete="sw_install_defer_cancelled_max_incomplete",e.DeferInstallOldCacheCleanupInProgress="sw_install_defer_old_cache_cleanup_inprogress",e.DeferInstallTimerCompleted="sw_install_defer_timer_completed",e.DeferInstallRetryAttempted="sw_install_defer_retry",e.ResetInstallIncompleteCounterFailure="sw_install_reset_counter_failure",e.ResetCacheCleanupStateFailure="sw_reset_cache_cleanup_state_failure",e.InstallIntegrityCheckPerformed="sw_install_integrity_check_performed",e.ReadIndexedDbFailure="sw_read_indexeddb_failure",e.AssetSetGenerationFailure="sw_asset_set_generation_failure",e.WriteIndexedDbFailure="sw_write_indexeddb_failure",e.FetchSWAssetsUsingSendMessage="sw_fetch_assets_using_send_message"}(KQ||(KQ={})),function(e){e.Start="start",e.Success="success",e.Failure="failure",e.CacheMiss="cache_miss",e.HighLatency="high_latency",e.CDNAssetNotInManifest="cdn_asset_not_in_manifest",e.OfflineAssetStart="offline_asset_start",e.OfflineAssetSuccess="offline_asset_success",e.OfflineAssetFailure="offline_asset_failure",e.OfflineAssetCacheMiss="offline_asset_cache_miss"}(YQ||(YQ={}));const XQ=3e5,ZQ=18e4,eK=72e5,tK="serviceWorkerCheckingForUpdates",nK="serviceWorkerMaxUpdateFailureCountReached",iK="serviceWorkerRegistrationNotFound",aK=5,oK="fundamentals_performance_sw_fetch",rK="fundamentals_performance_sw_offline_fetch";var sK=n(973737);class lK{constructor(e){var t,n,i,a,o;this.context=e,this.fetchTelemetryStore=new Map,this.swEnableIntegrityCheck=!1,this.isSwInstalling=!1,this.isSwWaiting=!1,this.serviceWorkerUpdateFailureCount=0,this.basePath=this.context.config.basePath,this.loggerFactory=this.context.loggerFactory,this.logger=this.loggerFactory.newLogger("WebClientUpdateService","services-io-browser-web-client-update"),this.rebootService=this.context.rebootService,this.host=this.context.windowProvider,this.scenarioFactory=this.context.scenarioFactory,this.coreSecurityService=this.context.coreSecurityService;try{this.swRegisterUrlPolicy=this.coreSecurityService.getTrustedTypePolicy("@msteams/services-io-browser-web-client-update#register-service-worker"),this.trustedScriptUrl=null===(t=this.swRegisterUrlPolicy)||void 0===t?void 0:t.createScriptURL(`/${this.basePath}/serviceworker.js`,this.host.location.origin)}catch(e){e instanceof sx.Y&&pe.G.isFunction(e.toTelemetryEntry)?null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,e.toTelemetryEntry(),"fundamental_performance_trusted_sw_scripturl"):null===(o=(a=this.logger).errorToTelemetry)||void 0===o||o.call(a,"create register service worker url trustedtype policy failed",e)}this.enableSWSubscription=this.context.coreSettings.getObservable(L.J.Core).subscribe((e=>{this.registerOrUnregisterServiceWorker(!!e.enableServiceWorker)}))}cleanup(){var e;this.enableSWSubscription.unsubscribe(),this.clearTimer(),null===(e=this.isOnlineSubscription)||void 0===e||e.unsubscribe()}checkForUpdateAndRestartWebClient(){var e,t;this.configureServiceWorkerEvents(),this.addUpdateServiceWorkerSettings(!0);const{disableOfflineSWRegistration:n}=this.context.coreSettings.get(L.J.Core);n?(null===(e=this.context.networkState)||void 0===e?void 0:e.isOnline)?this.registerAndCheckForServiceWorkerUpdates():this.isOnlineSubscription=null===(t=this.context.networkState)||void 0===t?void 0:t.observeIsOnline().subscribe((e=>{var t;e&&(this.registerAndCheckForServiceWorkerUpdates(),null===(t=this.isOnlineSubscription)||void 0===t||t.unsubscribe())})):this.registerAndCheckForServiceWorkerUpdates()}sendMessageToServiceWorker(e,t){return new Promise(((n,i)=>{const a=new MessageChannel;a.port1.onmessage=e=>{e.data.error?i(e.data.error):n(e.data)},e.postMessage(t,[a.port2])}))}handleOnStateChange(e,t,n,i){switch(this.sendServiceWorkerLifeCycleEventTelemetry(),t){case"installed":this.logger.log("Service worker got installed"),this.handleInstalledSWState(i);break;case"activated":this.logger.log("Service worker got activated"),this.isSwWaiting=!1;const t=this.scenarioFactory.findScenario(it.RG.SwStateChange);t&&(this.scenarioFactory.markStep(it.RG.SwStateChange,it.ck.SwActivated),t.stop()),this.setServiceWorkerContextForScenarios(!0);case"redundant":this.handleRedundantSWState(e,n)}e={state:t}}SendIncompleteEvent(e,t){this.fetchTelemetryStore.set(e.url,e),this.sendServiceWorkerFetchEventTelemetryInCompleteEvent(t)}setServiceWorkerContextForScenarios(e=!1){e?this.setScenarioContext(e):this.getServiceWorkerRegistration().then((e=>{this.setScenarioContext(!!e)}))}unregisterServiceWorker(e){"serviceWorker"in this.host.navigator&&(this.getServiceWorkerRegistration().then((t=>{t&&t.unregister().then((t=>{var n,i;null===(i=(n=this.logger).infoToTelemetry)||void 0===i||i.call(n,e,"fundamentals_performance_sw_unregister")}))})).catch((e=>{var t,n;null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,e.toString(),"fundamentals_performance_sw_unregister")})),this.deleteCacheStorage(e),this.clearTimer())}handleRedundantSWState(e,t){"installing"===e.state?(this.isSwInstalling=!1,this.scenarioFactory.markStep(it.RG.SwStateChange,it.ck.SwInstallFailure),t.fail(),this.serviceWorkerUpdateFailureCount++,this.triggerForceUpdate()):"installed"===e.state&&(this.isSwWaiting=!1),this.setServiceWorkerContextForScenarios(!0)}triggerForceUpdate(){this.serviceWorkerUpdateFailureCount>=aK&&(this.logger.error("Will force an update when the app is idle as SW update failed repeatedly with",nK),this.handleUpdateReady())}handleInstalledSWState(e){this.isSwInstalling=!1,this.isSwWaiting=!0,this.setServiceWorkerContextForScenarios(!0),this.scenarioFactory.markStep(it.RG.SwStateChange,it.ck.SwInstalled),"storage"in this.host.navigator&&"estimate"in this.host.navigator.storage&&this.host.navigator.storage.estimate().then((e=>{var t,n;const i=e.usageDetails,a={storageUsage:e.usage,storageQuota:e.quota,cacheStorageSize:null==i?void 0:i.caches,indexedDBSize:null==i?void 0:i.indexedDB,swRegSize:null==i?void 0:i.serviceWorkerRegistrations};null===(n=(t=this.logger).infoToTelemetry)||void 0===n||n.call(t,"Teams disk footprint","fundamentals_performance_user_storage_info",a)})),(0,FG.K4)(this.host)&&this.scenarioFactory.stopScenarioIfActive(it.RG.SwStateChange),e||this.handleUpdateReady(),this.serviceWorkerUpdateFailureCount=0}logServiceWorkerTelemetry(){this.sendServiceWorkerFetchEventTelemetry(),this.recurringSendSWFetchEventTelemetryInterval=this.host.setInterval(this.sendServiceWorkerFetchEventTelemetry.bind(this),XQ),this.sendServiceWorkerLifeCycleEventTelemetry()}sendServiceWorkerLifeCycleEventTelemetry(){const e=parseInt(BQ,10);(0,sK.q8)($Q,e,WQ,HQ,this.scenarioFactory,!0).then((e=>{var t;if(void 0!==e){let n=0;const i=null!==(t=this.recentProcessedLifeCycleEventTimestamp)&&void 0!==t?t:-1;e.map((e=>{var t;const a=null!==(t=e.timestamp)&&void 0!==t?t:0;a>i&&(this.sendServiceWorkerLifeInfoAndInstallTelemetry(e),n=Math.max(n,a))})),this.recentProcessedLifeCycleEventTimestamp=n}})).catch((e=>{this.logger.error("Error fetching service worker state telemetry. Error:",e)})).then((()=>(0,sK.dR)($Q,e,WQ,HQ,this.scenarioFactory).catch((e=>{this.logger.error("Error deleting service worker state telemetry. Error:",e)}))))}sendServiceWorkerLifeInfoAndInstallTelemetry(e){var t,n,i,a,o,r,s,l,c,d;const u={message:e.message,version:e.version,type:e.type};switch(e.type){case KQ.InstallSuccess:null===(n=(t=this.logger).infoToTelemetry)||void 0===n||n.call(t,"success","fundamentals_performance_sw_install",u);break;case KQ.InstallFailure:null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,"failure","fundamentals_performance_sw_install",u);break;case KQ.ActivateSuccess:null===(r=(o=this.logger).infoToTelemetry)||void 0===r||r.call(o,"success","fundamentals_performance_sw_activate",u);break;case KQ.ActivateFailure:null===(l=(s=this.logger).errorToTelemetry)||void 0===l||l.call(s,"failure","fundamentals_performance_sw_activate",u);break;default:null===(d=(c=this.logger).infoToTelemetry)||void 0===d||d.call(c,"success","fundamentals_performance_sw_state_info",u)}}registerServiceWorker(){const{enableTrustedSWScriptUrl:e}=this.context.coreSettings.get(L.J.Core),t=e&&this.trustedScriptUrl?this.trustedScriptUrl:`/${this.basePath}/serviceworker.js`,n=this.scenarioFactory.newScenario(it.RG.SwRegistration);this.host.navigator.serviceWorker.register(t,{updateViaCache:"all"}).then((e=>{n.stop(),this.attachEventsToInstallingServiceWorker(e,!0)})).catch((e=>{var t;(null===(t=this.context.networkState)||void 0===t?void 0:t.isOnline)?n.fail({message:`Error: ${e}`}):n.cancel({message:`user is not online and SW reg is failing due to error: ${e}`})}))}handleUpdateReady(){const{disableSkipWaiting:e}=this.context.coreSettings.get(L.J.Core);e||this.skipWaitingServiceWorkerIfNeeded(),this.rebootService.rebootWhenLongInactive(SN.Z.AppUpdatedUsingServiceWorker,SN.d.WebClientUpdateService)}deleteCacheStorage(e){if(void 0!==this.host.caches){const t=this.scenarioFactory.newScenario(it.RG.SwCleanupSwCache);this.host.caches.delete(he.eL).then((n=>{n?t.stop({reason:e}):t.fail({reason:"cache not found"})}))}}registerAndCheckForServiceWorkerUpdates(){this.getServiceWorkerRegistration().then((e=>{e?(this.logger.log(tK),e.update()):(this.logger.log(iK),this.registerServiceWorker())})).catch((e=>{this.logger.error(`Error getting Service Worker registration object: ${e}`)}))}configureServiceWorkerEvents(){"serviceWorker"in this.host.navigator&&this.getServiceWorkerRegistration().then((e=>{e?(this.attachEventsToInstallingServiceWorker(e),e.onupdatefound=()=>{this.attachEventsToInstallingServiceWorker(e)}):this.logger.log(iK)}))}registerServiceWorkerAndLogTelemetry(){var e,t;const{enableUpdateServiceWorkerRegistrationPerSession:n,disableOfflineSWRegistration:i}=this.context.coreSettings.get(L.J.Core);this.addUpdateServiceWorkerSettings(),i?(null===(e=this.context.networkState)||void 0===e?void 0:e.isOnline)?n?this.registerAndCheckForServiceWorkerUpdates():this.registerServiceWorker():this.isOnlineSubscription=null===(t=this.context.networkState)||void 0===t?void 0:t.observeIsOnline().subscribe((e=>{var t;e&&(n?this.registerAndCheckForServiceWorkerUpdates():this.registerServiceWorker(),null===(t=this.isOnlineSubscription)||void 0===t||t.unsubscribe())})):n?this.registerAndCheckForServiceWorkerUpdates():this.registerServiceWorker(),this.logServiceWorkerTelemetry()}addUpdateServiceWorkerSettings(e=!1){var t,n;const i=[],{serviceWorkerDeferInstallDurationInMs:a,enableServiceWorkerDynamicManifest:o,handleCdlHashRouteInServiceWorkerInstall:r,enableServiceWorkerIntegrityCheck:s}=this.context.coreSettings.get(L.J.Core);a&&Number.isInteger(a)&&this.swDeferInstallDurationInMs!==a&&(this.swDeferInstallDurationInMs=a,i.push({key:RQ,value:this.swDeferInstallDurationInMs})),this.swEnableDynamicManifest!==o&&(this.swEnableDynamicManifest=null!=o&&o,i.push({key:MQ,value:this.swEnableDynamicManifest})),this.swEnableIntegrityCheck!==s&&(this.swEnableIntegrityCheck=null!=s&&s,i.push({key:xQ,value:this.swEnableIntegrityCheck})),this.swhandleCdlHashRoute!==r&&(this.swhandleCdlHashRoute=null!=r&&r,i.push({key:UQ,value:this.swhandleCdlHashRoute}));const l=null!==(n=null===(t=this.context.i18NextWrapper)||void 0===t?void 0:t.locale)&&void 0!==n?n:"en-us";if(this.localeSetting!==l&&(this.localeSetting=l,i.push({key:OQ,value:this.localeSetting})),!e){i.push({key:PQ,value:this.context.platformService.ecsOverrides.environment.toString()});const e=this.context.platformService.config.clientType===Pe.Bh.Maglev?"desktop":this.context.platformService.config.clientType.toString();i.push({key:LQ,value:e})}i.push({key:jQ,value:this.context.platformService.config.platformId.toString()}),i.length&&this.writeSettingsInServiceWorkerDb(i)}writeSettingsInServiceWorkerDb(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=parseInt(zQ,10);yield(0,sK.Zl)(VQ,t,qQ,GQ,e,this.scenarioFactory).then((()=>{this.logger.log("Successfully updated service worker settings in Indexed DB")})).catch((e=>{this.logger.error("Error updating service worker settings in Indexed DB. Error:",e)}))}))}sendServiceWorkerFetchEventTelemetry(){this.host.navigator.serviceWorker.controller&&this.sendMessageToServiceWorker(this.host.navigator.serviceWorker.controller,"getFetchTelemetryEvents").then((e=>{e.forEach((e=>{this.sendServiceWorkerFetchEventTelemetryCompletedEvent(e)}))})).catch((e=>{this.logger.error("Error getting service worker fetch telemetry. Error:",e)})),this.sendServiceWorkerFetchEventTelemetryInCompleteEvent(XQ)}sendServiceWorkerFetchEventTelemetryInCompleteEvent(e){const t=Date.now();this.fetchTelemetryStore.forEach(((n,i)=>{if(void 0===e||t-n.timestamp>e){const e={endpointUrl:n.url,fetchTelemetryEventDelta:t-n.timestamp,operationType:n.type,version:n.version,message:n.message},a=n.type===YQ.OfflineAssetStart?it.RG.SwOfflineAssetFetchEvent:it.RG.SwFetchEvent;this.scenarioFactory.newScenario(a).cancel(e),this.fetchTelemetryStore.delete(i)}}))}sendServiceWorkerFetchEventTelemetryCompletedEvent(e){const t={endpointUrl:e.url,operationType:e.type,message:e.message,version:e.version};if(this.captureFetchEvent(e,t)){const n=this.isOfflineFetchOperation(e.type)?rK:oK;this.sendFetchEvent(n,e.type,t)}}isOfflineFetchOperation(e){let t;switch(e){case YQ.OfflineAssetSuccess:case YQ.OfflineAssetFailure:case YQ.OfflineAssetCacheMiss:t=!0;break;default:t=!1}return t}sendFetchEvent(e,t,n){var i,a,o,r,s,l,c,d;const u=n.message||"";switch(t){case YQ.Success:case YQ.OfflineAssetSuccess:null===(a=(i=this.logger).infoToTelemetry)||void 0===a||a.call(i,u,e,n);break;case YQ.CacheMiss:case YQ.OfflineAssetCacheMiss:null===(r=(o=this.logger).warnToTelemetry)||void 0===r||r.call(o,u,e,n);break;case YQ.Failure:case YQ.OfflineAssetFailure:null===(l=(s=this.logger).errorToTelemetry)||void 0===l||l.call(s,u,e,n);break;default:null===(d=(c=this.logger).debugToTelemetry)||void 0===d||d.call(c,u,e,n)}}captureFetchEvent(e,t){switch(e.type){case YQ.Start:case YQ.OfflineAssetStart:return this.fetchTelemetryStore.set(e.url,e),!1;case YQ.Failure:case YQ.Success:case YQ.OfflineAssetFailure:case YQ.OfflineAssetSuccess:case YQ.CDNAssetNotInManifest:case YQ.CacheMiss:case YQ.OfflineAssetCacheMiss:const n=this.fetchTelemetryStore.get(e.url);return n?(t.fetchTelemetryEventDelta=e.timestamp-n.timestamp,this.fetchTelemetryStore.delete(e.url)):t.reason="orphan",!0;case void 0:return this.logger.error("unexpected fetch event type:",e.type),!1}return!1}clearTimer(){this.host.clearInterval(this.recurringCheckForUpdateInterval),this.host.clearTimeout(this.registerSWAndLogTelemetryTimer),this.host.clearInterval(this.recurringSendSWFetchEventTelemetryInterval)}registerOrUnregisterServiceWorker(e){if(e){if(!this.recurringCheckForUpdateInterval){this.recurringCheckForUpdateInterval=this.host.setInterval((()=>this.checkForUpdateAndRestartWebClient()),eK);const{serviceWorkerRegistrationDelayInMs:e}=this.context.coreSettings.get(L.J.Core),t=e&&Number.isInteger(e)?e:ZQ;this.registerSWAndLogTelemetryTimer=this.host.setTimeout((()=>this.registerServiceWorkerAndLogTelemetry()),t)}}else this.unregisterServiceWorker("Service Worker is not enabled");this.setServiceWorkerContextForScenarios()}setScenarioContext(e){var t,n;null===(n=(t=this.scenarioFactory).setContext)||void 0===n||n.call(t,{isServiceWorkerRegistered:e,isServiceWorkerActive:(0,FG.K4)(this.host),isServiceWorkerInstalling:this.isSwInstalling,isServiceWorkerWaiting:this.isSwWaiting})}attachEventsToInstallingServiceWorker(e,t=!1){if(!e||!e.installing)return;const n=this.scenarioFactory.newScenario(it.RG.SwStateChange);this.scenarioFactory.markStep(it.RG.SwStateChange,it.ck.SwInstalling);const i=e.installing,a={state:i.state};this.isSwInstalling=!0,this.setServiceWorkerContextForScenarios(!0),i.onstatechange=()=>this.handleOnStateChange(a,i.state,n,t)}skipWaitingServiceWorkerIfNeeded(){"serviceWorker"in this.host.navigator&&this.getServiceWorkerRegistration().then((e=>{e&&e.waiting&&e.waiting.postMessage("skipWaiting")}))}getServiceWorkerRegistration(){return this.host.navigator.serviceWorker.getRegistration(`/${this.basePath}/serviceworker.js`)}}class cK extends fe{constructor(){super(he.Yg.CreateWebClientUpdate,["coreSettings"])}execute(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){t.webClientUpdateService=new lK(e);const{isUnRegisterSWOnLogoutEnabled:n}=e.coreSettings.get(L.J.Core);if(n)return e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"signout":yield t.webClientUpdateService.unregisterServiceWorker(e);break;default:return}}))}))}}var dK=n(846275);class uK extends fe{constructor(){super(he.Yg.CreateWindow,["config","diagnosticsService","logsCollectorService"]),this.registerShellHandlers=(e,t,n)=>{e.opener.addEventListener(n_.rY.GetLogs,(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield t.getDiagnosticsEvents(),a=yield n.getSystemInfo();let o="System Info: ";a&&a.size>0?a.forEach(((e,t)=>{o+=`${t}: ${e}\n`})):o+="No system info collected",i.unshift({message:`${o}`,level:wI.i.Debug,levelName:wI.i[wI.i.Debug],timeStamp:new Date,isPiiFree:!0}),e.opener.postMessage(n_.rY.GetLogs,{logs:i})}))))}}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=dK.n.getInstance(),n=t.config.hostedWindowContext,i=t.window;t.opt={postMessageConfig:e.config.postMessageConfig},i.onAppStart();const{diagnosticsService:a,logsCollectorService:o}=e;this.registerShellHandlers(i,a,o),e.hostedWindowContext=n,e.windowProvider=i}))}}class mK extends fe{constructor(){super(he.Yg.DiscoverUser,["discover"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.user=yield e.discover.getUser()}))}}class gK extends fe{constructor(){super(he.Yg.FetchCriticalDynamicImportsTask,["criticalDynamicImports","loggerFactory","scenarioFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{criticalDynamicImports:t,loggerFactory:n,scenarioFactory:i}=e;t&&0!==t.length&&t.forEach((({importFunc:e,chunkName:t})=>{(0,c.mT)(e,t,i).catch((e=>{var i,a;return null===(a=(i=n.newLogger("FetchCriticalDynamicImportsTask","core-services-tasks")).errorToTelemetry)||void 0===a?void 0:a.call(i,`Failed to preload chunk ${t} this will regress performance of first load: ${e}`,"webclient_framework_foundation_core_services_tasks",void 0,!0)}))}))}))}}class pK extends fe{constructor(){super(he.Yg.InitApiServiceProvider,["coreSettingsContext"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield e.coreSettingsContext.initializeApiServiceProvider()}))}}class vK extends fe{constructor(){super(he.Yg.InitAsyncMediaAuthService,["mediaAuthService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{mediaAuthService:t}=e;return null==t||t.initAsyncMediaAuthService(),e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"signout":yield null==t?void 0:t.logout();break;default:return}}))}))}}var hK=n(36847);class fK extends fe{constructor(){super(he.Yg.InitATPPolicyTask,["authenticationService","coreSettings","gtmRegistry","scenarioFactory","localStorage","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,gtmRegistry:i,scenarioFactory:a,localStorage:o,loggerFactory:r}=e,{enableFastSharepointSafelinks:s}=n.get(L.J.Messaging),l=r.newLogger("InitATPPolicyTask","core-services-tasks");if(!(null==s?void 0:s.enabled))return void l.log("InitATPPolicyTask - Do nothing, FF is disabled");const c=new hK.c(i.bind(ye.l,vs.Pn.middleTier),t,n,a,r,o);l.log("Getting ATP Safelinks policy"),c.initPolicy()}))}}const yK={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeAuthenticatedUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeAuthenticatedUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"Variable",name:{kind:"Name",value:"reason"}}}]}]}}]};let bK;class SK{constructor(e,t,n,i,a,o,r,s){var l,c;this._auth=e,this._client=t,this._discover=n,this._networkStateProvider=i,this._windowProvider=o,this._keepTokenActive=!1,this._keepCheckingSignInRestrictions=!1,this._isLoginRequired=void 0,this._tokenIntervalId=void 0,this._logger=r.newLogger("AuthTokenStoreService","core-services-auth-token-store"),this._mtResourceKey=(null===(l=null==s?void 0:s.get(L.J.Auth))||void 0===l?void 0:l.mtResource)||kT.ej.MT_AAD_KEY,this._tokenWarmingIntervalInMs=(null===(c=null==s?void 0:s.get(L.J.Auth))||void 0===c?void 0:c.tokenWarmingIntervalInMs)||Nr.lP.MT_TOKEN_INTERVAL,this._subscriptions=new Map,this.observeIsLoginRequired(),this.observeAppOnlineState()}observe(e){let t=this._subscriptions.get(e);return t||(t=this.createSubscription(e),this._subscriptions.set(e,t)),t}createSubscription(e){let t;switch(e){case kT.ej.MT_KEY:this._keepTokenActive=!0,t=this._auth.observeMiddleTierToken(),this.keepTokenActive();break;case kT.ej.SIGNIN_RESTRICTIONS_KEY:this._keepCheckingSignInRestrictions=!0,this.keepTokenActive();break;default:this._logger.error("Unable to create subscription, token key %s is not supported",e)}return t}keepTokenActive(){this._tokenIntervalId||(this._keepTokenActive||this._keepCheckingSignInRestrictions)&&(this._tokenIntervalId=this._windowProvider.setInterval((()=>{if(this._keepCheckingSignInRestrictions){let e=(0,Mf.pW)();e=`sign${e.substr(kT.uI.FOUR)}`,this._auth.acquireToken(kT.ej.SIGNIN_RESTRICTIONS_KEY,{correlationId:e}).catch((e=>{this.handleSignInRestrictionsError(e)}))}this._keepTokenActive&&this._auth.acquireToken(this._mtResourceKey).then((()=>this._discover.validateSkypeToken())).catch((e=>{this._logger.error("Error occurred in keeping MT token active.",e)}))}),this._tokenWarmingIntervalInMs))}handleSignInRestrictionsError(e){if(this._logger.error(`Error occurred in keeping SignInRestrictions token active. ErrorCode: ${null==e?void 0:e.errorCode}`,e),(null==e?void 0:e.errorCode)===kT.SM.SignInRestrictions){this._logger.error("Sign in restrictions was enabled and caught by the periodic check. Forcibly signing out the user");const e={id:(0,Mf.pW)(),source:"auth-token-store",scenarioName:it.RG.AuthWebLogout},[t,n]=(0,kA.OU)({options:{correlation:e},scenarioName:e.scenarioName,source:e.source,subContext:"auth-token-store::handleSignInRestrictionsError"});t.appendScenarioEventData({operationType:kT.SM.SignInRestrictions}),this._client.mutate({mutation:yK,variables:{reason:kT.SM.SignInRestrictions},context:{correlation:e}}),n()}else this._logger.error("Sign in restrictions token acquisition threw an unexpected error",e)}observeIsLoginRequired(){this._auth.isLoginRequired.subscribe((e=>{if(this._isLoginRequired===e)return;const t=void 0===this._isLoginRequired;this._isLoginRequired=e,t||(this._isLoginRequired?this._tokenIntervalId&&(this._windowProvider.clearInterval(this._tokenIntervalId),this._tokenIntervalId=void 0):this.replayKeepTokenActiveState())}))}observeAppOnlineState(){this._networkStateProvider.observeIsOnline().subscribe((e=>{e?this.replayKeepTokenActiveState():this._tokenIntervalId&&(this._windowProvider.clearInterval(this._tokenIntervalId),this._tokenIntervalId=void 0)}))}replayKeepTokenActiveState(){if(0===this._subscriptions.size)return;const e=this._subscriptions.keys();let t=e.next();for(;!t.done;)this.keepTokenActive(),t=e.next()}}class kK extends fe{constructor(){super(he.Yg.InitAuthenticationService,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:t,discover:n,authenticationUser:i,authenticationService:a,networkState:o,loggerFactory:r,coreSettings:s,scenarioFactory:l}=e,{enableSignInRestrictions:c,prefetchTokens:d,disableTokenWarming:u,enableTokenWarming:m,tokenWarmingResources:g}=s.get(L.J.Auth);if(!i)return;const p=((e,t,n,i,a,o,r)=>(bK||(bK=new SK(n,e,t,i,a,(0,Ue.J)(),o,r)),bK))(t,n,a,o,l,r,s);c&&p.observe(kT.ej.SIGNIN_RESTRICTIONS_KEY),!u&&p.observe(kT.ej.MT_KEY);const v=[];null==d||d.forEach((e=>e&&v.push(e))),m&&g&&g.forEach((e=>{e&&v.indexOf(e)<0&&v.push(e)})),v.forEach((e=>a.acquireToken(e).catch((()=>{}))))}))}}class wK{constructor(e,t){this.coreSettings=e,this.brbServiceMap=new Map,this.logger=t.newLogger("BrbServiceManager","core-services-brb")}registerUserBrbService(e,t){var n,i;null===(i=(n=this.logger).logNoPii)||void 0===i||i.call(n,"Registering a new BRB service for account"),this.brbServiceMap.set(e,t)}unregisterUserBrbService(e){var t,n;return null===(n=(t=this.logger).logNoPii)||void 0===n||n.call(t,"Unregistering an existing BRB service for account"),this.brbServiceMap.delete(e)}getBrbFormData(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{categories:n,disclaimer:i}=this.coreSettings.get(L.J.Brb),a=[];return null==n||n.forEach((e=>{e&&a.push({id:e.id,name:e.name})})),null===(t=(e=this.logger).logNoPii)||void 0===t||t.call(e,"Returning data for BRB form",a),{disclaimer:i||he.bA,categories:a}}))}getBrbScreenshots(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getOrCreateUserBrbService(e);return null==n?void 0:n.getBrbScreenshots(t)}))}createBrbItem(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this.getOrCreateUserBrbService(e),i=yield(null==n?void 0:n.createBrbItem(t))||void 0;if(!i)return i;const{enableMTMA:a}=this.coreSettings.get(L.J.Core);if(a){Array.from(this.brbServiceMap.keys()).filter((t=>t!==e)).forEach((e=>{const n=this.getOrCreateUserBrbService(e);null==n||n.extendBrbReports(t,i)}))}return i}))}getOrCreateUserBrbService(e){var t,n,i,a;const o=this.brbServiceMap.get(e);if(o&&o instanceof Function){null===(n=(t=this.logger).logNoPii)||void 0===n||n.call(t,"Creating BRB service for account");const i=o();return this.brbServiceMap.set(e,i),i}return null===(a=(i=this.logger).logNoPii)||void 0===a||a.call(i,"Found existing BRB service for account"),o}}class CK extends fe{constructor(){super(he.Yg.InitBrbServiceManagerTask,["coreSettings","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n}=e;e.brbServiceManager=new wK(t,n)}))}}class _K{constructor(e,t,n,i){this.coreSettings=e,this.useAccessCheckV2=n,this.hostComm=i,this.logger=t.newLogger("ClientAccessAdminPolicyCheckService","services-utilities-core"),this.useAccessCheckV2=n}isUserAllowed(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("isUserAllowed::start");let e=!1;const{useNewTeamsClient:t}=this.coreSettings.get(L.J.Core,["useNewTeamsClient"]);switch(this.logger.log(`isUserAllowed: useNewTeamsClient: ${t}`),t){case vs.KN.AdminDisabled:e=!1;break;case vs.KN.MicrosoftChoice:this.useAccessCheckV2&&(e=yield this.isUserAllowedV2()),e||(e=this.isUserAllowedViaAppSwitcher());break;case vs.KN.UserChoice:default:e=!0}return this.logger.log(`isUserAllowed: returned ${e}`),e}))}isUserAllowedViaAppSwitcher(){const{installedThroughAppSwitcher:e}=this.coreSettings.get(L.J.Host,["installedThroughAppSwitcher"]);return this.logger.log(`isUserAllowedViaAppSwitcher: installedThroughAppSwitcher: ${e}`),!!e}isUserAllowedV2(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{allowUserOnMicrosoftChoice:e}=this.coreSettings.get(L.J.Core,["allowUserOnMicrosoftChoice"]);if(!e)return this.logger.log("isUserAllowedV2: returned false due to allowUserOnMicrosoftChoice=false"),!1;const{disableEduCheckOnMicrosoftChoice:t}=this.coreSettings.get(L.J.Core,["disableEduCheckOnMicrosoftChoice"]);if(!t&&this.isEdu())return this.logger.log(`isUserAllowedV2: returned false due to EDU, disableEduCheckOnMicrosoftChoice=${t}`),!1;const{disableVdiCheckOnMicrosoftChoice:n}=this.coreSettings.get(L.J.Core,["disableVdiCheckOnMicrosoftChoice"]);return!n&&(yield this.isVdi())?(this.logger.log(`isUserAllowedV2: returned false due to VDI, disableVdiCheckOnMicrosoftChoice=${n}`),!1):(this.logger.log("isUserAllowedV2: returned true due to allowUserOnMicrosoftChoice=true"),!0)}))}isVdi(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.hostComm)return this.logger.warn("isVdi: returned false - invalid hostComm"),!1;const e=yield this.hostComm.loadModule("vdi");if(!e||!e.isVDI)return this.logger.warn(`isVdi: returned false - invalid VDI function, vdiModule=${!!e}`),!1;const t=yield e.isVDI();return this.logger.log(`isVdi: returned ${t}`),t}))}isEdu(){const{licenseType:e}=this.coreSettings.get(L.J.UserResources);return this.logger.log(`isEdu: licenseType=${e}`),!(!e||e!==vs.oj.Student&&e!==vs.oj.Teacher)}}class TK extends fe{constructor(){super(he.Yg.InitClientAccessAdminPolicyCheck,["coreSettings","hostCommunicationService","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,hostCommunicationService:n,loggerFactory:i}=e,a=i.newLogger("InitClientAccessAdminPolicyCheckTask","core-services-tasks"),{enableAppSwitcherTACSettingsSync:o}=t.get(L.J.Core,["enableAppSwitcherTACSettingsSync"]),{enableAppSwitcherTACSettingsSyncV2:r}=t.get(L.J.Core,["enableAppSwitcherTACSettingsSyncV2"]);if(!o&&!r)return void a.log("Both enableAppSwitcherTACSettingsSync and enableAppSwitcherTACSettingsSyncV2 are false, skipping ClientAccessAdminPolicyCheckService initialization.");const s=new _K(t,i,!!r,n);if(e.clientAccessAdminPolicyCheckService=s,!(yield s.isUserAllowed()))throw new kC.G(kC.$.DISABLED_BY_ADMIN)}))}}class IK extends fe{constructor(){super(he.Yg.InitDesktopEcsContext,["coreSettings","discover","hostCommunicationService","i18NextWrapper","loggerFactory","platformService","primaryUser"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,discover:n,hostCommunicationService:i,i18NextWrapper:a,loggerFactory:o,platformService:r,primaryUser:s}=e,l=yield i.loadModule("ecs");if(null==l?void 0:l.setEcsContext){const e=yield this.getDesktopEcsFilters(t,n,a,o,r,s);l.setEcsContext(e)}}))}getDesktopEcsFilters(e,t,n,a,o,r){var s,l,c,d;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{ring:i,environment:u}=e.get(L.J.Metadata),{enableLocaleFilterForFeatureFlags:m,disableRegionParamForMaglev:g}=e.get(L.J.Core,["enableLocaleFilterForFeatureFlags","disableRegionParamForMaglev"]);let p;if(!g)try{p=yield t.getRegion({id:r.id,tenantId:r.profile.tenantId,oid:r.profile.objectId,accountType:r.type,userName:r.loginUserName||""})}catch(e){null===(l=(s=a.newLogger("InitDesktopEcsContextTask","core-services-tasks")).errorToTelemetry)||void 0===l||l.call(s,"Failed to fetch region info from discover service.","webclient_framework_foundation_core_services_tasks",void 0,!0)}const{isInternalUser:v}=o.config,{originalRing:h}=o.ecsOverrides,f=m?n.locale:void 0;return u||null===(d=(c=a.newLogger("InitDesktopEcsContextTask","core-services-tasks")).errorToTelemetry)||void 0===d||d.call(c,"Environment is undefined","webclient_framework_foundation_core_services_tasks",void 0,!0),{cloud:u||"",isInternalUser:v,locale:f,originalRing:h,region:p,ring:(null==i?void 0:i.id)||"general",tenantId:r.profile.tenantId,userId:r.profile.objectId}}))}}class EK{constructor(e,t){var n,i,a,o,r,s,l,c;this.coreSettings=e,this.hostCommunicationService=t;const d=this.coreSettings.get(L.J.Metadata);this.expConfigMetadata=[{client:gQ.j,config:{expIds:null!==(a=null===(i=null===(n=d.configIds)||void 0===n?void 0:n.experiments)||void 0===i?void 0:i.join(","))&&void 0!==a?a:"",rolloutIds:null!==(s=null===(r=null===(o=d.configIds)||void 0===o?void 0:o.rollouts)||void 0===r?void 0:r.join(","))&&void 0!==s?s:"",eTag:null!==(l=d.eTag)&&void 0!==l?l:""}},{client:gQ.t,config:{expIds:"",rolloutIds:"",eTag:null!==(c=d.hostETag)&&void 0!==c?c:""}}],this.subject=new xw.X(this.expConfigMetadata),this.ecmObservable=this.subject.asObservable(),this.registerSyncHostEcm()}updateHostExperimentConfigMetadata(e){const t=e.find((e=>e.client===gQ.t)),n=this.expConfigMetadata.findIndex((e=>e.client===gQ.t));t&&n>-1&&(this.expConfigMetadata[n]=t,this.subject.next(this.expConfigMetadata))}updateWebExperimentConfigMetadata(e){var t;const n=null===(t=this.expConfigMetadata.find((e=>e.client===gQ.j)))||void 0===t?void 0:t.config;n&&e.eTag&&e.configIds&&e.configIds.experiments&&(n.eTag=e.eTag,n.expIds=e.configIds.experiments.join(","))}communicateWithHost(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=null===(e=this.expConfigMetadata.find((e=>e.client===gQ.j)))||void 0===e?void 0:e.config;if(!n)return;const i=yield this.hostCommunicationService.loadModule("ecs");if(!i)return;const a=yield null===(t=i.syncEcm)||void 0===t?void 0:t.call(i,[{client:gQ.j,config:n}]);if(a&&a.client===gQ.t){const e=[{client:gQ.t,config:{eTag:a.config.eTag,expIds:a.config.expIds,rolloutIds:a.config.rolloutIds}}];this.updateHostExperimentConfigMetadata(e)}}))}registerSyncHostEcm(){this.hostCommunicationService.loadModule("ecs").then((e=>{var t;null===(t=null==e?void 0:e.registerForOnSyncEcm)||void 0===t||t.call(e,(e=>{this.updateHostExperimentConfigMetadata(e)}))}))}}class NK extends fe{constructor(){super(he.Yg.InitExperimentation,["coreSettings","hostCommunicationService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,hostCommunicationService:n}=e;e.experimentationService=new EK(t,n)}))}}class AK extends fe{constructor(){super(he.Yg.InitPreAuthSettingsEcsProvider,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=ax("InitPreAuthSettingsEcsProvider",e,"coreSettings","coreSettingsContext","loggerFactory","scenarioFactory","networkState","clientState","windowProvider","endpointsManager"),{coreSettings:n,coreSettingsContext:a,loggerFactory:o}=t,r=(0,i.__rest)(t,["coreSettings","coreSettingsContext","loggerFactory"]),{enablePreAuthEcsFetch:s}=n.get(L.J.Core);if(!s)return;const l=a;yield l.initializeEcsProvider(Object.assign({},r))}))}}class FK extends fe{constructor(){super(he.Yg.InitSettingsEcsProvider,["coreSettings","coreSettingsContext","authenticationService","loggerFactory","scenarioFactory","networkState","clientState","windowProvider","endpointsManager"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,coreSettingsContext:n,authenticationService:a,loggerFactory:o,scenarioFactory:r,networkState:s,clientState:l,windowProvider:c,endpointsManager:d}=e,u=n,m=()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){p||(yield u.fetchEcsSettingsIfApplicable())})),{enablePreAuthEcsFetch:g}=t.get(L.J.Core),p=yield this.getPrimaryUser(a,o);yield u.setPrimaryUser(p),g||(yield u.initializeEcsProvider({scenarioFactory:r,networkState:s,clientState:l,windowProvider:c,endpointsManager:d,authenticationUser:p})),yield m()}))}getPrimaryUser(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;try{const t=yield null===(n=e.getCachedUsers)||void 0===n?void 0:n.call(e,{id:(0,Mf.pW)(),scenarioName:it.RG.AuthWebCachedUser,source:"init-settings-ecs-provider-task"},{isPrimaryUser:!0});t&&t.length>0&&(i=(0,di.KQ)(t[0]))}catch(e){t.newLogger("InitSettingsEcsProviderTask","core-services-tasks").warn("No primary user returned from authentication: ",e)}return i}))}}class DK extends fe{constructor(){super(he.Yg.InitSettingsMaglevHostProvider,["coreSettingsContext","hostCommunicationService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettingsContext:t,hostCommunicationService:n}=e,{enableMaglevHostProvider:i}=t.getCoreSettings().get(L.J.Core);i&&(yield t.initializeMaglevHostProvider(n))}))}}class RK{constructor(e,t,n,i,a,o,r){this.scenarioFactory=a,this.host=o,this.clientStateProvider=r,this.namespacesToFetch=[],this.settings={},this.refreshIntervalInMs=36e5,this.fetch=()=>{if(0===this.namespacesToFetch.length)return this.logger.debug("Skipping fetch() as no namespacesToFetch registered."),Promise.resolve();const e=this.scenarioFactory.newScenario(this.getScenarioName());return this.validateEnvironment().then((()=>this.fetchPolicies(e))).catch((t=>{e.stop({errors:t},"abandoned"),this.logger.warn(`Error fetching policies: ${t}`)}))},this.validateEnvironment=()=>new Promise(((e,t)=>{this.clientStateProvider.getState()===yC.pk.VeryActive&&(this.logger.log("Cancel policy fetching, due to app being in a very active state."),t("very active")),e()})),this.cleanupClientStateSubscription=()=>{var e;null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),this.clientStateSubscription=void 0},this.logger=e.newLogger(`CoreSettings/${t}`,"services-io-data-policies"),this.namespacesToFetch=n("policies").namespaces||[],this.namespacesToFetch.forEach((e=>{this.settings[e]={}})),this.updateConfigs(i)}initialize(e=!0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.isInitialized=!0,yield this.fetchAndSetRefreshCadence()}))}subscribeForSettingsUpdates(e){this.settingsChangedCallbackFunction=e}cleanup(){var e;this.cleanupClientStateSubscription(),this.settingsChangedCallbackFunction=void 0,null===(e=this.coreSubscription)||void 0===e||e.unsubscribe(),this.coreSubscription=void 0}notifySettingsChanged(){const e=()=>{var e;this.cleanupClientStateSubscription(),null===(e=this.settingsChangedCallbackFunction)||void 0===e||e.call(this,this.settings),this.logger.debug("Notified about policy change")};return this.clientStateProvider.getState()!==yC.pk.VeryActive?(e(),!0):(this.clientStateSubscription||(this.clientStateSubscription=this.clientStateProvider.observe().subscribe((t=>{t!==yC.pk.VeryActive&&e()}))),!1)}handleError(e){this.logger.error(`Failed to fetch tenant settings with error: ${e}`)}updateConfigs(e){const t=e.getObservable(L.J.Core);this.coreSubscription=t.subscribe((e=>{e.policyRefreshIntervalInMs&&this.updateRefreshCadence(e.policyRefreshIntervalInMs)}))}updateRefreshCadence(e){this.refreshIntervalInMs=e,this.isInitialized&&this.queueNextPolicyFetch()}fetchAndSetRefreshCadence(){return this.fetch().then((()=>{this.queueNextPolicyFetch()})).catch((e=>{this.logger.error(`Error fetching policies: ${e}`)}))}queueNextPolicyFetch(){if(!this.isInitialized)throw new Error("Service not initialized to queue the fetch.");this.setIntervalHandle&&(this.host.clearInterval(this.setIntervalHandle),this.setIntervalHandle=void 0,this.logger.debug("clearInterval() called.")),this.refreshIntervalInMs>0?(this.setIntervalHandle=this.host.setInterval(this.fetch,this.refreshIntervalInMs),this.logger.debug("setInterval() called.")):this.logger.error(`Refresh interval not valid: ${this.refreshIntervalInMs}`)}}class xK extends RK{constructor(e,t,n,i,a,o){super(e,"PoliciesIpcDataProvider",t,n,i,a,o),this.handleSetAggregatedSettings=e=>{const{payload:t}=e;Object.keys(t).length>0?(this.logger.log(`handleSetAggregatedSettings() called: ${Object.keys(t).join(", ")}.`),this.parsePolicies(t),this.notifySettingsChanged()):this.logger.log("handleSetAggregatedSettings() called with empty payload.")},this.windowOpener=a.opener}initialize(e=!0){const t=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.windowOpener.addEventListener(n_.rY.SetAggregatedSettings,this.handleSetAggregatedSettings),t.initialize.call(this)}))}cleanup(){super.cleanup(),this.windowOpener.removeEventListener(n_.rY.SetAggregatedSettings,this.handleSetAggregatedSettings)}getScenarioName(){return it.RG.IPCPolicyFetch}fetchPolicies(e){return this.windowOpener.requestMessage(n_.rY.GetAggregatedSettings).then((t=>{let n=!1,i="success";const a=null==t?void 0:t.data;a&&0!==Object.keys(a).length?(this.logger.log(`fetchPolicies: Got policies for namespaces: ${Object.keys(a).join(", ")}.`),this.parsePolicies(a),n=this.notifySettingsChanged()):(this.logger.log("Failed to fetch policies via IPC, got empty payload data response."),i="incomplete"),e.stop({message:(0,wi.u4)({notified:n})},i)})).catch((t=>{var n;this.handleError(t),e.fail({errors:null!==(n=t.message)&&void 0!==n?n:"Failed to fetch policies via IPC."})}))}parsePolicies(e){this.namespacesToFetch.forEach((t=>{e[t]&&e[t].hasOwnProperty("value")&&(this.settings[t]=e[t].value)}))}}const MK={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"policies"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"correlationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"namespaces"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"correlationId"},value:{kind:"Variable",name:{kind:"Name",value:"correlationId"}}},{kind:"Argument",name:{kind:"Name",value:"namespaces"},value:{kind:"Variable",name:{kind:"Name",value:"namespaces"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jsonData"}}]}}]}}]},OK={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"policiesUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policiesUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jsonData"}}]}}]}}]};class PK extends RK{constructor(e,t,n,i,a,o,r){super(e,"PoliciesResolversDataProvider",t,n,i,a,r),this.apolloClient=o,this.handlePoliciesUpdatedEvent=e=>{this.logger.log("handlePoliciesUpdatedEvent() called.");try{void 0!==e&&this.parsePolicies(e)?this.notifySettingsChanged():this.logger.log(`handlePoliciesUpdatedEvent(): policiesString is ${void 0===e?"undefined":"empty"}.`)}catch(e){this.logger.error(`handlePoliciesUpdatedEvent(): ${e.message}`)}}}initialize(e=!0){const t=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=this;return this.policiesApolloSubscription=this.apolloClient.subscribe({query:OK}).subscribe({next(t){var n,i,a;e.handlePoliciesUpdatedEvent(null!==(a=null===(i=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.policiesUpdatedEvent)||void 0===i?void 0:i.jsonData)&&void 0!==a?a:void 0)}}),t.initialize.call(this)}))}cleanup(){var e;super.cleanup(),null===(e=this.policiesApolloSubscription)||void 0===e||e.unsubscribe(),this.policiesApolloSubscription=void 0}getScenarioName(){return it.RG.PoliciesFetchDataResolvers}fetchPolicies(e){return this.apolloClient.query({query:MK,variables:{correlationId:e.id,namespaces:this.namespacesToFetch},fetchPolicy:"no-cache"}).then((t=>{var n,i,a,o,r;(null==t?void 0:t.error)&&(null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,`fetchPolicies:then: Message: ${t.error.message}.`,"webclient_framework_policies_resolvers_fetch_failed_event",void 0,!0)),(null==t?void 0:t.errors)&&t.errors.forEach((e=>{var t,n;null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`fetchPolicies:then: Errors:Message: ${e.message}.`,"webclient_framework_policies_resolvers_fetch_failed_event",void 0,!0)}));const s=null!==(r=null===(o=null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.policies)||void 0===o?void 0:o.jsonData)&&void 0!==r?r:void 0;let l=!1,c="success";void 0!==s&&this.parsePolicies(s)?l=this.notifySettingsChanged():(this.logger.log(`fetchPolicies(): Failed to fetch policies, got ${void 0===s?"undefined":"empty"} response.`),c="incomplete"),e.stop({message:(0,wi.u4)({notified:l})},c)})).catch((t=>{var n;this.handleError(t),e.fail({errors:null!==(n=t.message)&&void 0!==n?n:"Failed to fetch policies via resolvers."})}))}parsePolicies(e){let t={};try{t=JSON.parse(e)}catch(e){throw new Error("parsePolicies(): Unable to parse policies string.")}return 0!==Object.keys(t).length&&(this.namespacesToFetch.forEach((e=>{t[e]&&(this.settings[e]=t[e])})),!0)}}class LK extends fe{constructor(){super(he.Yg.InitSettingsPolicyProvider,["authenticationUser","coreSettings","coreSettingsContext","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n,coreSettingsContext:i,loggerFactory:a}=e,{disableNonBlockingPolicyProviderInit:o,disablePolicyProvider:r}=n.get(L.J.Core);if(r)return;if(!t||t.role===nd.w4.Anonymous)return;const s=this.createPoliciesDataProvider(e),{enableMainWindowPolicyFetch:l}=n.get(L.J.Host);if(l||o)yield i.initializePolicyProvider(s);else{const e=a.newLogger("InitPolicyProviderTask","core-services-tasks");i.initializePolicyProvider(s).then((()=>{e.log("Initialized policy provider successfully.")})).catch((t=>{e.errorToTelemetry&&e.errorToTelemetry(`Initialization of policy provider failed. ${t}`,"webclient_framework_foundation_core_services",void 0,!0)}))}return e=>{switch(e){case"signout":s.cleanup()}}}))}createPoliciesDataProvider(e){const{client:t,clientState:n,configLoader:i,coreSettings:a,loggerFactory:o,scenarioFactory:r,windowProvider:s}=e;let l;const{enableMainWindowPolicyFetch:c}=a.get(L.J.Host);return l=c?new xK(o,i,a,r,s,n):new PK(o,i,a,r,s,t,n),l}}var UK=n(705516),jK=n(215303),$K=n(423078);const BK="preReleaseFeaturesAllowed";class WK extends fe{constructor(){super(he.Yg.InitSettingsWithDiscoveredUser,["authenticationService","authenticationUser","config","coreSettings","coreSettingsContext","endpointsManager","localStorage","loggerFactory","platformService","user","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:t,authenticationUser:n,config:i,coreSettings:a,coreSettingsContext:o,endpointsManager:r,localStorage:s,loggerFactory:l,platformService:c,user:d,windowProvider:u}=e;let m={};const{enablePreReleaseClientFilter:g}=a.get(L.J.Core);if(g){const e=yield this.getPreReleaseUserInfo({authenticationService:t,authenticationUser:n,config:i,coreSettings:a,endpointsManager:r,localStorage:s,loggerFactory:l,platformService:c,windowProvider:u});m=Object.assign(Object.assign({},m),{preReleaseFeaturesAllowed:e})}const p=o,{enableMTMA:v}=a.get(L.J.Core),h=!v||(yield sR(t,n));yield p.initializeProvidersWithDiscoveredUser(d,h,m)}))}getPreReleaseUserInfo({authenticationService:e,authenticationUser:t,config:{experienceName:n},coreSettings:a,endpointsManager:o,localStorage:r,loggerFactory:s,platformService:l,windowProvider:c}){var d;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=s.newLogger("InitSettingsWithDiscoveredUserTask","core-services-tasks"),{preReleaseFeaturesAllowed:u}=a.get(L.J.Metadata);if(!u)return i.log("No pre release features are allowed."),!1;if(yield sR(e,t))return i.log(`Returning preReleaseAllowed filter for primary user: ${u}`),!!u;try{const e=r.get(BK);if(null!=e)return i.log(`Cached preReleaseAllowed filter loaded: ${e}`),JSON.parse(e);const d={userId:null==t?void 0:t.profile.objectId,tenantId:null==t?void 0:t.profile.tenantId},u=(0,UK.xb)({coreSettings:a,experienceName:n,platformService:l,user:d,logger:i}),m=new jK.X(u,"ClientFilters",o,c,s),g=yield m.getConfigurationAsync(),p=this.getValueFromPayload(g,u);return void 0!==p?(i.log(`Storing preReleaseAllowed filter in cache: ${p}`),r.set(BK,p.toString())):i.log("Could not get preReleaseAllowed filter from ECS."),!!p}catch(e){null===(d=i.errorToTelemetry)||void 0===d||d.call(i,(0,Mf.u4)(e),"web_infra_determine_pre_release_filter_failed")}return!1}))}getValueFromPayload(e,t){var n;if(e.requestStatus===$K.m.Success)return null===(n=t.agents)||void 0===n?void 0:n.some((t=>{var n,i;const a=null===(n=e.ecsConfiguration)||void 0===n?void 0:n[t];return!!(null===(i=null==a?void 0:a.metadata)||void 0===i?void 0:i.preReleaseFeaturesAllowed)}))}}class HK extends fe{constructor(){super(he.Yg.InitSettingsWithPrimaryUser,["coreSettingsContext","authenticationUser"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettingsContext:t,authenticationUser:n}=e;return yield t.setPrimaryUser(n),e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"signout":yield t.setPrimaryUser(void 0)}}))}))}}var VK;!function(e){e[e.ComposeMessageTyping=0]="ComposeMessageTyping",e[e.MessageListScroll=1]="MessageListScroll",e[e.PowerbarTyping=2]="PowerbarTyping",e[e.VirtualTreeListScroll=3]="VirtualTreeListScroll",e[e.FeedsFilterTyping=4]="FeedsFilterTyping",e[e.PeoplePickerTyping=5]="PeoplePickerTyping",e[e.SearchBoxTyping=6]="SearchBoxTyping",e[e.FloodgatePopup=7]="FloodgatePopup",e[e.ChatListSearchFilterTyping=8]="ChatListSearchFilterTyping",e[e.ChannelListSearchFilterTyping=9]="ChannelListSearchFilterTyping",e[e.CallingPerfSample=10]="CallingPerfSample",e[e.AllChannelSystemMessagesScroll=11]="AllChannelSystemMessagesScroll",e[e.AllPinnedPostsScroll=12]="AllPinnedPostsScroll",e[e.DiscoverSurfaceFeedListScroll=13]="DiscoverSurfaceFeedListScroll",e[e.TeamsAndChannelsTableScroll=14]="TeamsAndChannelsTableScroll",e[e.PostComposeTyping=15]="PostComposeTyping",e[e.UnifiedFunPickerTyping=16]="UnifiedFunPickerTyping",e[e.CreateTeamGalleryScroll=17]="CreateTeamGalleryScroll"}(VK||(VK={}));var zK=n(133654);const qK="getAndClearAriTelemetry";class GK{constructor(e,t){this.host=e,this.context=t,this.startSlot=0,this.blinkInterval=100,this.trailingTimespan=he.B.second,this.rafRecords=new Map,this.activeUserActionType=void 0,this.userActions=new Map,this.validActions=new Map,this.lastEventTimeSlot=this.startSlot,this.isDebugging=!1,this.minAriDuration=200,this.strategies=[{name:"TwoRafAndLimitedStopTimeStrategy",lowestAllowedRafs:2,allowStopTimeOverwrite:!0}],this.logger=t.loggerFactory.newLogger("ARI","core-services-telemetry"),this.initializeOnAppLaunchAndReinit(),this.__initTestingMode__(this.context.coreSettings.get(L.J.Host)),this.defaultHost=e}trackEvent(e,t,n,i,a){const o=this.getUserActionType(e,t),{isDebugging:r,logger:s}=this;if(void 0===o||!(o in VK))return void(r&&s.debug(`[${this.formatActionKey(e,t)}] TrackEvent | No action found`));const l=this.getMeasurementName(o),c=i.performance.now();if(r&&s.debug(`[${l} TrackEvent | [${Math.round(n)}...${Math.round(c)}] ${Math.round(c-n)}ms`),void 0===this.activeUserActionType)r&&s.debug(`[${l}] track-start`),this.startMeasurement(o,n,i,a);else if(this.activeUserActionType!==o||this.host!==i||this.actionLocation!==a)r&&s.debug(`[${l}] track-stop`),this.stopMeasurement(i),r&&s.debug(`[${l}] track-start`),this.startMeasurement(o,n,i,a);else{if(r){const e=`[${l}] track-continue`;s.debug(e),function(e,t,n){e.mark(t,n),e.clearMarks(t)}(this.host.performance,e,{startTime:n})}this.continueMeasurement(n)}}handleUnmount(e){this.stopMeasurement(e)}getTelemetry(e=zK.xL.HeartbeatMonitor){return this.getTelemetryFilteredByType(e)}getTelemetryTypeForAction(e){return e===VK.CallingPerfSample?zK.xL.CallingPerfMonitor:zK.xL.HeartbeatMonitor}isActionOfTelemetryType(e,t){return this.getTelemetryTypeForAction(e)===t}getTelemetryFilteredByType(e){void 0!==this.activeUserActionType&&this.isActionOfTelemetryType(this.activeUserActionType,e)&&this.stopMeasurement();const t={};let n=!1;const i={totalIntervalCount:0,passIntervalCount:0};this.userActions.forEach(((a,o)=>{if(void 0!==VK[a.type]&&this.isActionOfTelemetryType(a.type,e)){const e={};a.scores.forEach(((t,n)=>{(e=>{e&&(i.passIntervalCount+=e.passIntervalCount,i.totalIntervalCount+=e.totalIntervalCount)})(t),e[n]=this.getAri(t)})),t[o]=e,n=!0,this.userActions.delete(o),this.isDebugging&&this.logger.debug(`[AppResponsivenessService]: clear action for type ${VK[a.type]}`)}})),t.Total=this.getAri(i);let a="";if(n)try{a=JSON.stringify(t)}catch(e){this.logger.error("[AppResponsivenessService]: unexpected error parsing log object. Likely because of circular reference.")}return a}clearTelemetry(){this.userActions.clear(),this.clearTelemetryTimeoutId&&this.context.windowProvider.clearTimeout(this.clearTelemetryTimeoutId),this.clearTelemetryTimeoutId=this.context.windowProvider.setTimeout((()=>{this.clearTelemetry()}),he.B.tenMinutes,!1)}initializeOnAppLaunchAndReinit(){this.initSettings(),this.registerValidActions(),this.clearTelemetry()}__initTestingMode__(e){if(e){const t=e.userType;t&&t.indexOf("test")>-1&&(this.isDebugging=!0,qK in window||(window.getAndClearAriTelemetry=()=>{const e=this.getTelemetry();return this.clearTelemetry(),e}))}}registerValidActions(){this.validActions.set(this.formatActionKey(zK.PG.Floodgate,he.f_.System),VK.FloodgatePopup),this.validActions.set(this.formatActionKey(zK.PG.ComposeMessage,he.f_.Keyup),VK.ComposeMessageTyping),this.validActions.set(this.formatActionKey(zK.PG.MessageList,he.f_.Scroll),VK.MessageListScroll),this.validActions.set(this.formatActionKey(zK.PG.Powerbar,he.f_.Keyup),VK.PowerbarTyping),this.validActions.set(this.formatActionKey(zK.PG.VirtualTreeList,he.f_.Scroll),VK.VirtualTreeListScroll),this.validActions.set(this.formatActionKey(zK.PG.FeedsFilter,he.f_.Keyup),VK.FeedsFilterTyping),this.validActions.set(this.formatActionKey(zK.PG.PeoplePicker,he.f_.Keyup),VK.PeoplePickerTyping),this.validActions.set(this.formatActionKey(zK.PG.PostCompose,he.f_.Keyup),VK.PostComposeTyping),this.validActions.set(this.formatActionKey(zK.PG.SearchBox,he.f_.Keyup),VK.SearchBoxTyping),this.validActions.set(this.formatActionKey(zK.PG.ChatListSearchFilter,he.f_.Keyup),VK.ChatListSearchFilterTyping),this.validActions.set(this.formatActionKey(zK.PG.ChannelListSearchFilter,he.f_.Keyup),VK.ChannelListSearchFilterTyping),this.validActions.set(this.formatActionKey(zK.PG.CallingPerf,he.f_.Sample),VK.CallingPerfSample),this.validActions.set(this.formatActionKey(zK.PG.DiscoverSurfaceFeedList,he.f_.Scroll),VK.DiscoverSurfaceFeedListScroll),this.validActions.set(this.formatActionKey(zK.PG.AllPinnedPosts,he.f_.Scroll),VK.AllPinnedPostsScroll),this.validActions.set(this.formatActionKey(zK.PG.AllChannelSystemMessages,he.f_.Scroll),VK.AllChannelSystemMessagesScroll),this.validActions.set(this.formatActionKey(zK.PG.TeamsAndChannelsTable,he.f_.Scroll),VK.TeamsAndChannelsTableScroll),this.validActions.set(this.formatActionKey(zK.PG.UnifiedFunPicker,he.f_.Keyup),VK.UnifiedFunPickerTyping),this.validActions.set(this.formatActionKey(zK.PG.CreateTeamGallery,he.f_.Scroll),VK.CreateTeamGalleryScroll)}getUserActionType(e,t){const n=this.formatActionKey(t,e);return this.validActions.get(n)}formatActionKey(e,t){return`${e}_${t}`}registerRafCallback(){this.rafCallbackId||(this.rafCallbackId=this.host.requestAnimationFrame((()=>this.measureRaf())))}unregisterRafCallback(){this.rafCallbackId&&(this.host.cancelAnimationFrame(this.rafCallbackId),this.clearRaf())}clearRaf(){this.rafCallbackId=void 0,this.rafRecords.clear()}getAri(e){return e&&0!==e.totalIntervalCount?Math.round(e.passIntervalCount/e.totalIntervalCount*he.B.second)/he.B.second:0}initSettings(){const{enableAriDebugging:e,appResponsivenessConstants:t}=this.context.coreSettings.get(L.J.Telemetry),n=this.context.coreSettings.get(L.J.Host).showScenarioStepsInPerfTrace||this.context.coreSettings.get(L.J.Core).showScenarioStepsInPerfTrace;this.isDebugging=e||n||!1,this.blinkInterval=t&&t.blinkInterval||100,this.trailingTimespan=t&&t.trailingTimespan||he.B.second}startMeasurement(e,t,n,i){this.assignHost(n),this.actionLocation=i,this.activeUserActionType=e,this.eventStartTime=t||this.host.performance.now(),this.lastEventTimeSlot=this.getTimeSlot(this.eventStartTime);const a=this.getMeasurementName(e);if(this.isDebugging){const e=`[${a}] START`,t=`${e} | ${this.host.performance.now()} | Event: ${this.eventStartTime}`;this.host.performance.mark(e,{startTime:this.eventStartTime}),this.logger.debug(t)}this.registerRafCallback();let o=this.userActions.get(a);void 0===o&&(o={scores:new Map,startTime:this.startSlot,type:e},this.userActions.set(a,o)),o.startTime=this.eventStartTime}stopMeasurement(e=this.host){if(void 0===this.activeUserActionType)return;const t=this.getMeasurementName(this.activeUserActionType),n=this.userActions.get(t);if(void 0!==n){if(this.isDebugging){const e=`[${t}] END`;this.host.performance.mark(e),this.logger.debug(`${e} | ${this.host.performance.now()}`)}this.finalizeMeasurement(n)}this.unregisterRafCallback(),this.activeUserActionType=void 0,this.actionLocation=void 0,e===this.host&&this.assignHost(this.defaultHost)}continueMeasurement(e){this.lastEventTimeSlot=this.getTimeSlot(e)}finalizeMeasurement(e,t){this.strategies.forEach((n=>{const i=t&&n.allowStopTimeOverwrite?t:this.getCurrentTimeSlot(),a=Math.round(this.host.performance.now()-e.startTime);if(a<this.minAriDuration)return;const o=this.getResponsivenessScore(this.startSlot,i,n),r=e.scores.get(n.name);r?(r.passIntervalCount+=o.passIntervalCount,r.totalIntervalCount+=o.totalIntervalCount):e.scores.set(n.name,{totalIntervalCount:o.totalIntervalCount,passIntervalCount:o.passIntervalCount});const s=(o.passIntervalCount/o.totalIntervalCount).toFixed(2);if(this.logger.log(`[${this.getMeasurementName(e.type)}] duration: ${a}ms measurement: ${o.passIntervalCount}/${o.totalIntervalCount} (${s})`),this.isDebugging){const t=this.getMeasurementName(e.type),n={name:t,pass:o.passIntervalCount,total:o.totalIntervalCount,result:s},i=`ari-measurement => ${JSON.stringify(n)}`,a=`[${t}] START`,r=`[${t}] END`;UD(this.host.performance,i,a,r)}}))}measureRaf(){const e=this.getCurrentTimeSlot();let t=this.rafRecords.get(e);void 0===t?t=1:t++,e-this.lastEventTimeSlot>=this.trailingTimespan?this.stopMeasurement():(this.rafRecords.size>1e3&&(this.stopMeasurement(),this.rafRecords.clear()),this.rafRecords.set(e,t),this.rafCallbackId=this.host.requestAnimationFrame((()=>this.measureRaf())))}getCurrentTimeSlot(){const e=this.host.performance.now();return this.getTimeSlot(e)}getTimeSlot(e){const t=void 0!==this.eventStartTime?e-this.eventStartTime:-1;return t<0?-1:Math.floor(t/this.blinkInterval)*this.blinkInterval}getResponsivenessScore(e,t,n){let i=0,a=0;for(;e<t;){const t=this.rafRecords.get(e);this.isDebugging&&this.logger.debug(`${e}: ${void 0===t?0:t}`),a+=void 0!==t&&t>=n.lowestAllowedRafs?1:0,i++,e+=this.blinkInterval}return{passIntervalCount:a,totalIntervalCount:i}}assignHost(e){this.host=e}getMeasurementName(e){let t=VK[e];return this.actionLocation&&(t+=`-${this.actionLocation}`),t}}class JK{constructor(e){var t,n;if(this.context=e,null===(t=this.context.host)||void 0===t?void 0:t.performance){this.deprecatedNavigationTiming=this.context.host.performance.timing,this.navigationStart=null===(n=this.deprecatedNavigationTiming)||void 0===n?void 0:n.navigationStart;const e=this.context.host.performance.getEntriesByType("navigation");e&&e[0]&&(this.navigationTiming=e[0]),this.init()}}get altScenario(){return this._altScenario}get clientStartScenario(){return this._clientStartScenario}markCoreInitSteps(){const e=this.context.host.performance.getEntriesByType("mark");e&&this.navigationStart&&(this._altScenario&&this.processCoreInitPerfMarks(this._altScenario,this.navigationStart,e),this._clientStartScenario&&(this._clientStartScenario.appendEventData({scenarioPhase:NR.Core}),this.processCoreInitPerfMarks(this._clientStartScenario,this.navigationStart,e)))}processCoreInitPerfMarks(e,t,n){const i=n;for(const n of i)switch(n.name){case`${Vw}${he.sM.Initialization}`:e.mark(it.ck.PreCoreInitializationTasks,{overrideTimestamp:Math.round(n.startTime)+t});continue;default:n.name.startsWith(zw)&&e.mark(n.name.replace("_end_","_"),{overrideTimestamp:Math.round(n.startTime)+t})}}markAltExpLoaderSteps(e,t){this.markNavigationSteps(e,t);const n=this.context.host.performance.getEntriesByName("start-execute-main-bundle","mark");n&&n[0]&&e.mark(it.ck.MainBundleDownloadParse,{overrideTimestamp:Math.round(n[0].startTime)+t})}markClientStartExpLoaderSteps(e,t){e.appendEventData({scenarioPhase:NR.ExpLoader}),this.markNavigationSteps(e,t);const n=[UJ.IndexPageStart,UJ.CoreModuleLoaded,UJ.NotifyDesktop,UJ.ConfigLoaded,UJ.MainChunksLoadingStart,UJ.MainChunksLoadingStop,UJ.IndexPageStop,it.ck.MainBundleDownloadParse,"start-execute-main-bundle"],i=this.context.host.performance.getEntriesByType("mark");i&&i.filter((e=>n.includes(e.name)||e.name.startsWith("exp_loader_err_"))).forEach((n=>{e.mark(n.name,{overrideTimestamp:Math.round(n.startTime)+t})}))}markNavigationSteps(e,t){var n,i,a,o;(null===(n=this.navigationTiming)||void 0===n?void 0:n.workerStart)&&e.mark(it.ck.IndexServiceWorkerStartup,{overrideTimestamp:t+Math.round(this.navigationTiming.workerStart)}),(null===(i=this.deprecatedNavigationTiming)||void 0===i?void 0:i.fetchStart)&&e.mark(it.ck.IndexFetchIPC,{overrideTimestamp:this.deprecatedNavigationTiming.fetchStart}),(null===(a=this.deprecatedNavigationTiming)||void 0===a?void 0:a.requestStart)&&e.mark(it.ck.IndexFetchIPCWait,{overrideTimestamp:this.deprecatedNavigationTiming.requestStart}),(null===(o=this.deprecatedNavigationTiming)||void 0===o?void 0:o.responseStart)&&e.mark(it.ck.IndexFetchProcessing,{overrideTimestamp:this.deprecatedNavigationTiming.responseStart})}init(){var e,t;this.navigationStart&&(this._altScenario=null===(e=this.context.scenarioFactory)||void 0===e?void 0:e.newScenario(it.RG.ApplicationLaunchTime,{startTime:this.navigationStart}),this._clientStartScenario=null===(t=this.context.scenarioFactory)||void 0===t?void 0:t.newScenario(it.RG.ClientStart,{startTime:this.navigationStart}),this._altScenario&&this.markAltExpLoaderSteps(this._altScenario,this.navigationStart),this._clientStartScenario&&this.markClientStartExpLoaderSteps(this._clientStartScenario,this.navigationStart),this.markCoreInitSteps())}}class QK{constructor(e,t){this.isScenarioMemorySnapshotEnabled=e,this.globalWindow=t,this.cachedMemoryData={},this.cacheToExpireTime=0}snapshotMemoryUsage(){return this.isScenarioMemorySnapshotEnabled?(this.cacheToExpireTime<Date.now()&&this.snapshot(),this.cachedMemoryData):{}}snapshotMemoryUsageAsync(){if(!this.isScenarioMemorySnapshotEnabled)return Promise.resolve({});if(this.ongoingPromise)return this.ongoingPromise;const e=this.cacheToExpireTime-Date.now();return e>0?(this.ongoingPromise=new Promise((t=>{this.globalWindow.setTimeout((()=>{this.snapshot(),t(this.cachedMemoryData),this.ongoingPromise=void 0}),e)})),this.ongoingPromise):(this.snapshot(),Promise.resolve(this.cachedMemoryData))}snapshot(){this.cachedMemoryData={jsHeapStatistics:this.globalWindow.envPerformance.getJSHeapStatistics()||this.cachedMemoryData.jsHeapStatistics,processMemoryInfo:this.globalWindow.envPerformance.getProcessMemoryInfo()||this.cachedMemoryData.processMemoryInfo},this.cacheToExpireTime=Date.now()+3e4}}var KK=n(322163),YK=n(979321);class XK{constructor(e){this.eventTimeTracker=bQ(e&&e>0?e:100)}markResponse(e){return this.eventTimeTracker.markEvent(e)}getResponsesBetweenStartAndLast(e){return this.eventTimeTracker.getEventsBetweenStartAndLast(e)}getResponsesBetween(e,t){return this.eventTimeTracker.getEventsBetween(e,t)}}const ZK=e=>{var t;const{apolloLeakInfoViewportContext:n,apolloLeakInfoEntityType:i=""}=null!==(t=e.apolloLeakInfo)&&void 0!==t?t:{};return n===i_.R.primary?`main:${i}`:i},eY=e=>e.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{});class tY{constructor(e,t,n,i){this.coreSettings=e,this.leakDetectorService=t,this.userTrackingService=n,this.shouldCollectStats=i,this.measurementTimeOverflow=!1,this.resultMeasurementTimeOverflow=!1,this.isLeakingUser=e=>e&&this.userTrackingService&&!this.userTrackingService.has(e);const{apolloCacheStatsThrottleTime:o,logCdlOperationsDuringWaitSettings:r}=e.get(L.J.Core);var s;this.getTelemetry=o?(0,a.throttle)((()=>this.getTelemetryInternal()),o,{leading:!0,trailing:!1}):this.getTelemetryInternal,r&&(r.enableTrackingCdlOperationsDuringWait||r.enableLoggingCdlOperationsDuringWait)&&(this.cdlResponseTracker=(s=r.trackingCdlOperationsDuringWaitBufferSize,new XK(s)))}getTelemetryInternal(){var e,t,n,i,a,o;const{enableApolloCacheStats:r,enableApolloCacheSizeStats:s,enableApolloResultCacheSizeStats:l,enableApolloDataEviction:c}=this.coreSettings.get(L.J.Core);if(!r)return;const d=null!==(t=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects(_E.I.DataClient).size)&&void 0!==t?t:0,u=Array.from(null!==(i=null===(n=this.leakDetectorService)||void 0===n?void 0:n.getReachableObjects(_E.I.ApolloCache))&&void 0!==i?i:[]),m=[...Array.from(null!==(o=null===(a=this.leakDetectorService)||void 0===a?void 0:a.getReachableObjects(_E.I.UnwrappedWindow))&&void 0!==o?o:[]).map((e=>{var t;return null===(t=e.windowLeakInfo)||void 0===t?void 0:t.windowLeakInfoWindowId})).filter((e=>!!e)),he.ew],g=e=>!e||!m.includes(e),p=u.filter((e=>{const{apolloLeakInfo:{apolloLeakInfoWindowId:t}={}}=e;return g(t)})),v=this.getLeakedUserCaches(u),h=u.map(ZK),f=p.map(ZK),y=s&&!this.measurementTimeOverflow&&this.shouldCollectStats(),b=l&&!this.resultMeasurementTimeOverflow&&this.shouldCollectStats(),S={clientsCount:d,cacheCount:u.length,allEntityTypes:Array.from(new Set(h)),entityTypeStats:eY(h),leakedCacheCount:f.length,leakedEntityTypes:Array.from(new Set(f)),leakedEntityTypeStats:eY(f),leakedUserCachesCount:v.length,caches:u.map((e=>{const{apolloLeakInfo:{apolloLeakInfoWindowId:t,apolloLeakInfoEntityType:n,apolloLeakInfoViewportContext:i,apolloLeakInfoStartTime:a,apolloLeakInfoEndTime:o}={}}=e,r={windowId:t,isLeaking:g(t),apolloLeakInfoStartTime:a,apolloLeakInfoEndTime:o,entityType:n,viewportContext:i};if(y){const{cacheSize:t,measuringTime:n}=(0,KK.T)(e);r.cacheSize=t,r.measuringTime=n}if(b){const{cacheSize:t,measuringTime:n}=(0,YK.TP)(e);r.resultCacheSize=t,r.resultMeasuringTime=n}return r})),enableApolloDataEviction:null!=c?c:void 0},k=S.caches.reduce(((e,t)=>({cacheSize:void 0===t.cacheSize||void 0===e.cacheSize?void 0:e.cacheSize+t.cacheSize,measuringTime:void 0===t.measuringTime||void 0===e.measuringTime?void 0:e.measuringTime+t.measuringTime,resultCacheSize:void 0===t.resultCacheSize||void 0===e.resultCacheSize?void 0:e.resultCacheSize+t.resultCacheSize,resultMeasuringTime:void 0===t.resultMeasuringTime||void 0===e.resultMeasuringTime?void 0:e.resultMeasuringTime+t.resultMeasuringTime})),{cacheSize:0,measuringTime:0,resultCacheSize:0,resultMeasuringTime:0});return k.measuringTime&&k.measuringTime>500&&(this.measurementTimeOverflow=!0),k.resultMeasuringTime&&k.resultMeasuringTime>500&&(this.resultMeasurementTimeOverflow=!0),Object.assign(Object.assign({},S),k)}unthrottle(){"function"==typeof this.getTelemetry.cancel&&this.getTelemetry.cancel()}markResponse(e){var t;null===(t=this.cdlResponseTracker)||void 0===t||t.markResponse(e)}getResponsesBetweenStartAndLast(e){var t;return(null===(t=this.cdlResponseTracker)||void 0===t?void 0:t.getResponsesBetweenStartAndLast(e))||[]}getResponsesBetween(e,t){var n;return(null===(n=this.cdlResponseTracker)||void 0===n?void 0:n.getResponsesBetween(e,t))||[]}getLeakedUserCaches(e){return e.filter((e=>{const{apolloLeakInfo:{apolloLeakInfoUserContextId:t}={}}=e;return this.isLeakingUser(t)}))}}const nY={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]},iY=(e,t,n)=>{const i=void 0!==e[t]||Object.keys(e).length<n?t:"other";return e[i]=(e[i]||0)+1,i},aY=new Set([u.p.breakoutroomspanel,u.p.calendar,u.p.callablechannels,u.p.callsmain,u.p.chats,u.p.channels,u.p.schedulingform,u.p.search,u.p.store,u.p.transcriptcontent]);var oY;!function(e){e.mainActive="mainActive",e.mainContentRecord="mainContentRecord"}(oY||(oY={}));class rY{constructor(e){this.entityTypeLimit=e,this.active={},this.record={},this.allEntityTypes=new Set,this.usedEntityTypes=new Set,this.activeWindowIds=new Set}update(e,t){Object.keys(this.active).forEach((e=>{this.active[e]=0})),this.activeWindowIds.clear(),e.forEach((e=>{const n=e.activeEntities.mainEntity.type;this.allEntityTypes.add(n),this.activeWindowIds.add(e.id),iY(this.active,n,this.entityTypeLimit),aY.has(n)&&this.usedEntityTypes.add(n),!this.isFirstUse(n)&&this.wasInPreviousUpdate(e,t)||iY(this.record,n,this.entityTypeLimit)}))}getStats(){return{mainActive:this.active,mainContentRecord:this.record,allEntityTypes:Array.from(this.allEntityTypes),usedEntityTypes:Array.from(this.usedEntityTypes),activeWindowIds:Array.from(this.activeWindowIds)}}isFirstUse(e){return!this.record[e]}wasInPreviousUpdate(e,t){const n=t.find((t=>t.id===e.id));return!!n&&n.activeEntities.mainEntity.type===e.activeEntities.mainEntity.type&&n.activeEntities.mainEntity.id===e.activeEntities.mainEntity.id&&n.correlation.id===e.correlation.id}}const sY=new Set([u.p.calls,u.p.chats,u.p.channels,u.p.extensions,u.p.schedulingform]);var lY;!function(e){e.popOutActive="popOutActive",e.popOutRecord="popOutRecord"}(lY||(lY={}));class cY{constructor(e){this.entityTypeLimit=e,this.active={},this.record={},this.allEntityTypes=new Set,this.usedEntityTypes=new Set,this.activeWindowIds=new Set}update(e,t){Object.keys(this.active).forEach((e=>{this.active[e]=0})),this.activeWindowIds.clear(),e.forEach((e=>{const n=e.activeEntities.mainEntity.type;this.allEntityTypes.add(n),this.activeWindowIds.add(e.id),iY(this.active,n,this.entityTypeLimit),sY.has(n)&&this.usedEntityTypes.add(n),!this.isFirstUse(n)&&this.wasInPreviousUpdate(e,t)||iY(this.record,n,this.entityTypeLimit)}))}getStats(){return{popOutActive:this.active,popOutRecord:this.record,allEntityTypes:Array.from(this.allEntityTypes),usedEntityTypes:Array.from(this.usedEntityTypes),activeWindowIds:Array.from(this.activeWindowIds)}}isFirstUse(e){return!this.record[e]}wasInPreviousUpdate(e,t){const n=t.find((t=>t.id===e.id));return!!n&&n.activeEntities.mainEntity.type===e.activeEntities.mainEntity.type}}const dY=e=>Object.keys(e).reduce(((t,n)=>t+e[n]),0),uY=e=>{const t=Object.keys(e).reduce(((t,n)=>{const i=e[n];return i&&i>0&&(t[n]=i),t}),{}),n=Object.keys(t);return 1===n.length?n[0]:void 0},mY=(e,t)=>{const n=Array.from(e).filter((e=>{var n;return!(null===(n=e.windowLeakInfo)||void 0===n?void 0:n.windowLeakInfoWindowId)||!t.includes(e.windowLeakInfo.windowLeakInfoWindowId)})).map((e=>{var t;const{windowLeakInfoEntityType:n=""}=null!==(t=e.windowLeakInfo)&&void 0!==t?t:{};return e.viewportContext===i_.R.primary?`main:${n}`:n}));return{allEntityTypes:Array.from(new Set(n)),memActive:n.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{})}};class gY{constructor({client:e,leakDetectorService:t,entityTypeStatsLimit:n}){this.isBackInMain=!1,this.main=new rY(null!=n?n:20),this.popOut=new cY(null!=n?n:20),this._activeWindowsSubscription=(0,aC.G)(e.watchQuery({query:nY})).pipe((0,jw.h)((({errors:e,loading:t})=>void 0===e&&!t)),(0,Lw.U)((({data:{activeWindows:e}})=>(this.isBackInMain=e.some((e=>e.id===he.ew)),e))),(0,Q_.G)()).subscribe((([e,t])=>{this.update(e,t)})),this.leakDetectorService=t}destroy(){this._activeWindowsSubscription.unsubscribe()}getStats(){var e,t,n,a;const o=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects(_E.I.UnwrappedWindow),r=null===(t=this.leakDetectorService)||void 0===t?void 0:t.getReachableObjects(_E.I.WindowWrapper),s=this.main.getStats(),{activeWindowIds:l}=s,c=(0,i.__rest)(s,["activeWindowIds"]),d=this.popOut.getStats(),{activeWindowIds:u}=d,m=(0,i.__rest)(d,["activeWindowIds"]),g=dY(m.popOutActive),p={backInMain:this.isBackInMain?{allEntityTypes:c.allEntityTypes,usedEntityTypes:c.usedEntityTypes,backInMainActive:c.mainActive,backInMainActiveCount:dY(c.mainActive),backInMainContentRecord:c.mainContentRecord}:void 0,t2main:this.isBackInMain?void 0:{allEntityTypes:c.allEntityTypes,usedEntityTypes:c.usedEntityTypes,t2MainActive:c.mainActive,t2MainActiveCount:dY(c.mainActive),t2MainContentRecord:c.mainContentRecord},popOut:Object.assign(Object.assign({},m),{popOutActiveCount:g,hasActivePopout:g>0}),mainActiveEntity:uY(c.mainActive),windowCount:null==o?void 0:o.size,windowWrapperCount:null==r?void 0:r.size,inMem:o?mY(o,[...l,...u]):void 0,windows:o?Array.from(o).map((e=>{var t;const{windowLeakInfoEntityType:n,windowLeakInfoWindowId:i,windowLeakInfoStartTime:a,windowLeakInfoEndTime:o}=null!==(t=e.windowLeakInfo)&&void 0!==t?t:{};return{windowLeakInfoWindowId:i,windowLeakInfoEntityType:n,viewportContext:e.viewportContext,windowLeakInfoStartTime:a,windowLeakInfoEndTime:o}})):void 0},v=(null!==(a=null===(n=p.t2main)||void 0===n?void 0:n.t2MainActiveCount)&&void 0!==a?a:0)+p.popOut.popOutActiveCount;return Object.assign(Object.assign({},p),{windowLeaks:void 0===p.windowCount?void 0:p.windowCount-v,windowWrapperLeaks:void 0===p.windowWrapperCount?void 0:p.windowWrapperCount-v})}update(e,t){this.main.update(t.filter((e=>e.isMainWindow)),e.filter((e=>e.isMainWindow))),this.popOut.update(t.filter((e=>!e.isMainWindow)),e.filter((e=>!e.isMainWindow)))}}class pY{constructor(e){this.context=e,this.inited=!1,this.logger=e.loggerFactory.newLogger("WindowTrackerService","core-services-telemetry")}init(){var e;if(!this.inited){const{client:t,leakDetectorService:n,coreSettings:i}=this.context,a=(null!==(e=this.logger.errorToTelemetry)&&void 0!==e?e:this.logger.error).bind(this.logger);if(t){this.inited=!0;try{this.windowEntityTypeStats=new gY({client:t,leakDetectorService:n,entityTypeStatsLimit:null==i?void 0:i.get(L.J.Core).entityTypeStatsLimit})}catch(e){a("Failed to initialize WindowEntityTypeStats","webclient_framework_window_tracker_service")}}else a("Failed to initialize WindowEntityTypeStats - missing client","webclient_framework_window_tracker_service")}}getTelemetry(){var e;return this.inited||this.init(),null===(e=this.windowEntityTypeStats)||void 0===e?void 0:e.getStats()}}function vY(e,t){const n=e.location.hostname;return t&&t!==n}var hY=n(777743);function fY(e,t,n,i,a,o){const r=o&&o.delta||0,s=function(e,t,n){let i;switch(e){case"share-to-teams":i=function(e,t){let n;if(t.performance&&t.performance.navigation&&0===t.performance.navigation.type){const{s:i}=e.getSearchState();if(i)n=parseInt(i,10);else{const e="outlook"===t.document.head.dataset.host,i=t.localStorage.getItem(hY.qB.STT_START_TIME);e&&i&&(n=parseInt(i,10),t.localStorage.removeItem(hY.qB.STT_START_TIME))}}return n}(t,n)}return i}(e,i,a),l=s?{name:it.ck.ClickTimeAction,timestamp:n-r}:void 0,c=l?[l]:[];o&&c.push({name:o.name,timestamp:n});const d=s||n-r,u=t.newScenario(it.RG.ExperienceReady,{startTime:d});c.forEach((e=>{u.mark(e.name,{overrideTimestamp:e.timestamp})}))}function yY(e,t,n,i,a,o,r={cached:!1}){const s={name:e,delta:0},l=LD(e,t,n,i.performance,o);return void 0!==l&&(s.delta=l,a.createScenarioWithoutStarting(e).stop({delta:l,cached:r.cached})),s}var bY=n(31516),SY=n(295127),kY=n(807109),wY=n(23092),CY=n(172259);const _Y="Teams",TY=/(windows|win32)/i,IY=/ arm;/i,EY=/windows\sphone\s\d+\.\d+/i,NY=/(macintosh|mac os x|mac)/i,AY=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,FY=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,DY=/android/i,RY=(e,t)=>{var n,i;if(t){const a=null!==(n=e.get(L.J.Telemetry).workerEnabled)&&void 0!==n&&n,o=null!==(i=e.get(L.J.Telemetry).enableSharedWorker)&&void 0!==i&&i,r=a?o?"shared":"dedicated":"embed",{coreSecurityService:s,windowBaseUrl:l}=t,c=s.getTrustedTypePolicy("@msteams/core-services-telemetry-worker#TelemetryWorker");return{workerType:r,workerUrlCallback:e=>c.createScriptURL(e,l)}}return{workerType:"embed",workerUrlCallback:e=>e}},xY=(e,t,n)=>{bY.H.getInstance().initialize(t);const i=new SY.O(t);return CI.ip.getInstance().initialize(e,n),{eventSuppression:bY.H.getInstance(),columnSuppression:i,telemetrySender:CI.ip.getInstance()}},MY=(e,t,n,i)=>{var a;const{clientType:o,userAgent:r}=n.config,{deviceId:s,sessionId:l,sessionStartTime:c}=n.host,d=i.get(L.J.Telemetry),{defaultToken:u,enableSharedWorker:m,isSilent:g,telemetryServer:p,enableCustomCacheSize:v,eventsLimitInMem:h,normalPrioritySendTimeInSecs:f,highPrioritySendTimeInSecs:y,autoFlushPercent:b,enableOneDsSdkNs:S,oneDsCollectorUrl:k,enableCompression:w,enablePrivacyGuard:C,enableLoggingGlobalDeviceId:_,privacyGuardIngestionToken:T,disableMTMAPrimaryId:I,debugMenuCaptureContext:E,debugMenuCaptureEvents:N}=d,{sharedWorkerUrl:A}=i.get(L.J.Host),F=null===(a=null==i?void 0:i.get(L.J.Core))||void 0===a?void 0:a.enableMTMA;if(!p||!u)throw t.error("Telemetry server url or app token not supplied. This is required by Aria"),(0,An.Tr)("telemetry-initialization",he.jK.Undefined,"init");const D=(e=>{let t=e;return t||(t=(0,Ye.v4)()),t})(s),R=e.windowType!==wY.N.Anglr?"NS":"",x={userAgent:r,firstLaunchTime:e.appStartTime,tablePostfix:R,deviceId:D},M={debugMenuCaptureContext:!!E,debugMenuCaptureEvents:!!N},O=new kY.Mk;return O.collectorUrl=p,v&&h&&(O.eventsLimitInMem=h),{config:O,appTokens:{default:u},documentInfo:x,debugMenuSettings:M,isSilent:!!g,sessionId:l||void 0,sessionStartTime:c,clientType:o,sharedWorkerUrl:A||void 0,enableSharedWorker:!!m,eventsLimitInMem:h||3e3,normalPrioritySendTimeInSecs:f||15,highPrioritySendTimeInSecs:y||15,autoFlushPercent:b||.33,enableOneDsSdkNs:!!S,oneDsCollectorUrl:k||void 0,enableCompression:!!w,enablePrivacyGuard:!!C,enableLoggingGlobalDeviceId:!!_,privacyGuardIngestionToken:T||void 0,enableMTMA:F||void 0,disableMTMAPrimaryId:!!I,createTelemetryWorkerFn:CY.w}},OY=(e,t,n,i,a,o,r,s,l)=>{var c;const{browser:d,browserVersion:u,clientContext:m,clientType:g,clientVersion:p,cpuArchitecture:v,osPlatform:h,osVersion:f,platformId:y}=n.config,{bootType:b,panelContext:S,sessionId:k,startReason:w}=n.host,C=i.get(L.J.Telemetry),{defaultToken:_,telemetryServer:T,disableRingNamePrefixing:I,disablePlatformServiceOsVersion:E}=C,N=i.get(L.J.Metadata),{hostAppWebVersion:A}=i.get(L.J.Host);if(!T||!_)throw t.error("Telemetry server url or app token not supplied. This is required by Aria"),(0,An.Tr)("telemetry-initialization",he.jK.Undefined,"init");const F=N.environment===s_.s.life?cQ.OV.Life:cQ.OV.Work,D=hQ(N,PY(!!I,e,o),l).ring,R=WY(a.userAgent),x=VY(a.userAgent),M=zY(!!C.enableRegexRemoval,h),O=qY(h);let P=v;"Mac OS X"===O&&(P="x64");const U=JY();r.setContext("AppInfo.ClientType",null!==(c=e.clientTypeTelemetry)&&void 0!==c?c:g),r.setContext("AppInfo.ClientContext",m),r.setContext("AppInfo.HostAppVersion",R),r.setContext("AppInfo.ProcessArchitecture",x),r.setContext("AppInfo.WebVersion",A),A&&r.setContext("AppInfo.HostAppWebVersion",BY(A)),r.setContext("AppInfo.Language",s.localeCode),r.setContext("AppInfo.Locale",s.localeCode),r.setContext("AppInfo.PlatformId",y);const j=HY(p,A);C.enableEnhancedTelemetry?r.setContext("AppInfo.Version",j):r.setContext("AppInfo.Version",p),r.setContext("AppInfo.VersionNew",j),r.setContext("AppInfo.ReactAppVersion",p),r.setContext("AppInfo.ExperienceName",e.experienceName),r.setContext("DeviceInfo.OsName",O),E||r.setContext("DeviceInfo.OsVersion",f),r.setContext("DeviceInfo.OsFamily",M),r.setContext("DeviceInfo.CpuArchitecture",P),r.setContext("EventInfo.isNS",!0),r.setContext("Panel.Context",S),r.setContext("Session.Id",k),r.setContext("startReason",w),r.setContext("UserInfo.Language",s.userLanguage),r.setContext("UserInfo.Ring",D),r.setContext("UserInfo.TimeZone",U),r.setContext("userAgent",a.userAgent),r.setContext("Window.Type",e.windowType),r.setContext("DeviceInfo.BrowserName",d),r.setContext("DeviceInfo.BrowserVersion",u),r.setContext("DeviceInfo.Id",a.deviceId),r.setContext("Tenant.Model",F),r.setContext("Session.TelemetryContext","web"),r.setContext("AppInfo.BootType",b),r.setContext("UserInfo.UserLocale",s.originLocaleCode),r.setContext("UserInfo.OSorBrowserLocale",Pe.Bh.Desktop===g||Pe.Bh.Maglev===g?s.osLocale:s.userLanguage),r.setContext("telemetryRegionFetchComplete",C.telemetryRegionFetchComplete),r.setContext("UserInfo.TelemetryRegion",C.telemetryRegion),LY(i,r,e,o,l),UY(i,r),jY(j,i,r)},PY=(e,t,n)=>!(!n||"react-web-client"!==t.experienceName)||e,LY=(e,t,n,i,a)=>{const o=e.getObservable(L.J.Metadata),{disableRingNamePrefixing:r}=e.get(L.J.Telemetry);if(o.subscribe((e=>{null==a||a.updateWebExperimentConfigMetadata(e),null==a||a.communicateWithHost();const o=hQ(e,PY(!!r,n,i),a);t.setContext("UserInfo.Ring",o.ring),t.setContext("UserInfo.ETag",o.eTag),t.setContext("UserInfo.HostETag",o.hostETag),t.setContext("AppInfo.ExpIds",o.expIds),t.setContext("AppInfo.Environment",o.environment)})),a){a.ecmObservable.subscribe((e=>{const n=e.find((e=>e.client===gQ.t)),i=e.map((e=>e.config.expIds)).filter((e=>e.length>0)).join(",");t.setContext("UserInfo.HostETag",null==n?void 0:n.config.eTag),t.setContext("AppInfo.ExpIds",i)}))}},UY=(e,t)=>{e.getObservable(L.J.UserResources).subscribe((e=>{const n=e.licenseType||void 0;t.setContext("UserInfo.LicenseType",n)}))},jY=(e,t,n)=>{t.getObservable(L.J.Host).subscribe((i=>{i&&$Y(e,t,n,i)}))},$Y=(e,t,n,i)=>{const{enableEnhancedTelemetry:a,enableGetUserTypeFromHost:o}=t.get(L.J.Telemetry),r=i.desktopVersion||void 0,s=r?e.concat(",",r):e;r&&n.setContext("AppInfo.DesktopVersion",r),n.setContext("AppInfo.VersionNew",s),i.systemManufacturer&&n.setContext("DeviceInfo.Make",i.systemManufacturer),i.systemProductName&&n.setContext("DeviceInfo.Model",i.systemProductName),n.setContext("rendererCount",i.rendererCount),a&&n.setContext("AppInfo.Version",s),n.setContext("AppInfo.WebVersion",i.hostAppWebVersion),i.hostAppWebVersion&&n.setContext("AppInfo.HostAppWebVersion",BY(i.hostAppWebVersion)),o&&i.userType&&n.setContext("userType",i.userType)},BY=e=>{let t="";const n=e.indexOf("/");return n>-1&&(t=e.substring(n+1,e.length)),t},WY=e=>{let t;const n=e.indexOf(_Y);if(n>-1){t=e.substring(n+_Y.length+1);const i=t.indexOf(" ");t=t.substring(0,i)}return t},HY=(e,t)=>t?e.concat(",",t):e,VY=e=>{let t=cQ.Wz.unknown;return GY(e,cQ.Wz.x64)?t=cQ.Wz.x64:GY(e,cQ.Wz.x86)?t=cQ.Wz.x86:GY(e,cQ.Wz.ia32)&&(t=cQ.Wz.ia32),t},zY=(e,t)=>{if(!e){let e=cQ.Zc.UNKNOWN;const n=(null==t?void 0:t.match(TY))||(null==t?void 0:t.match(IY))||(null==t?void 0:t.match(EY)),i=(null==t?void 0:t.match(FY))||(null==t?void 0:t.match(DY)),a=(null==t?void 0:t.match(NY))||(null==t?void 0:t.match(AY));return n?e=cQ.Zc.WINDOWS:i?e=cQ.Zc.UNIX:a&&(e=cQ.Zc.MACOSX),e}switch(t){case Pe.NR.Windows:case Pe.NR.WindowsPhone:return cQ.Zc.WINDOWS;case Pe.NR.ChromeOS:case Pe.NR.Android:case Pe.NR.Linux:return cQ.Zc.UNIX;case Pe.NR.IOS:case Pe.NR.Mac:return cQ.Zc.MACOSX;default:return cQ.Zc.UNKNOWN}},qY=e=>{switch(e){case Pe.NR.Windows:return"Windows";case Pe.NR.Mac:return"Mac OS X";case Pe.NR.Linux:return"Linux";case Pe.NR.ChromeOS:return"Chrome OS";case Pe.NR.Android:return"Android";case Pe.NR.IOS:return"iOS";case Pe.NR.WindowsPhone:return"Windows Phone";case Pe.NR.Unknown:return"Unknown";default:return e}},GY=(e,t)=>!!(e.indexOf(t)>-1),JY=()=>{const e=(new Date).getTimezoneOffset();let t=e%60,n=(e-t)/60;const i=n>0?"-":"+";t=Math.abs(t),n=Math.abs(n);const a=t<10?`0${t}`:t.toString();return`${i}${n<10?`0${n}`:n.toString()}:${a}`};class QY extends fe{constructor(){super(he.Yg.InitTelemetry,["coreSettings","coreSettingsContext","diagnosticsService","windowProvider","telemetryContextService","loggerFactory"])}execute(e){var t,n,a,o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.loggerFactory.newLogger("init-telemetry-task","core-services-tasks"),s=e.coreSettings.get(L.J.Telemetry),l=this.createMemoryAnalyzer(e.windowProvider,s);s.disableAriService||(e.appResponsivenessService=new GK(e.windowProvider,{loggerFactory:e.loggerFactory,windowProvider:e.windowProvider,coreSettings:e.coreSettings})),e.dataClientTrackingService=this.createDataClientTrackerService(e),this.createWindowTrackerService(e),yield this.createHeartbeatMonitor(e);const{crossClientRegistrationMethods:c,desktopActiveScenarios:d,desktopContext:u,deviceInfo:m,finalizeLegacyCrossClient:g,notifyDesktopScenarioFactoryReady:p,systemCpuInfo:v,systemMemoryInfo:h}=yield this.initializeCrossClientTelemetry(i,e.hostCommunicationService),f={deviceInfo:m,systemCpuInfo:v,systemMemoryInfo:h},y=this.createCoreScenarioFactory(e,l,g,d,c);null==p||p(),null===(t=e.hostCommunicationService)||void 0===t||t.setScenarioFactory(y),e.diagnosticsService.setScenarioFactory(y),e.coreSettingsContext.setScenarioFactory(y),yield this.createCoreTelemetryService(e,l,y,f,e.telemetryContextService,u),null===(o=null===(a=null===(n=e.windowProvider)||void 0===n?void 0:n.loader)||void 0===a?void 0:a.stopPieTimer)||void 0===o||o.call(a),this.createCoreUserBiService(e),this.startAppStartScenarios(e,y),e.altScenarioService=new JK({host:e.windowProvider,loggerFactory:e.loggerFactory,coreSettings:e.coreSettings,scenarioFactory:y});const b=new AQ(y,e.telemetryContextService,l,{isolateUserContext:null!==(r=e.coreSettings.get(L.J.Telemetry).isolateUserContext)&&void 0!==r&&r});return e.hostCommunicationService&&(yield this.handOffContextCommsCallback(e.hostCommunicationService,e.coreSettings,b)),KY(b)}))}initializeCrossClientTelemetry(e,t){var n,a,o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i={};if(t){try{const e=yield t.loadModule("scenario");e&&(e.getActiveScenarios&&(i.desktopActiveScenarios=yield e.getActiveScenarios({})),e.setScenarioCompletion&&(i.finalizeLegacyCrossClient=e.setScenarioCompletion),i.crossClientRegistrationMethods={},e.registerForScenarioMark&&e.registerForScenarioStart&&e.registerForScenarioStop&&(i.crossClientRegistrationMethods.marks={registerForScenarioStart:e.registerForScenarioStart,registerForScenarioMark:e.registerForScenarioMark,registerForScenarioStop:e.registerForScenarioStop}),e.registerForScenarioAppendEventData&&(i.crossClientRegistrationMethods.appendEventData=e.registerForScenarioAppendEventData),i.notifyDesktopScenarioFactoryReady=()=>{var t;null===(t=e.setWebAvailability)||void 0===t||t.call(e,!0)})}catch(t){e.errorToTelemetry&&e.errorToTelemetry(YN.LoadModuleScenarioFailed,"webclient_framework_host_comms",void 0,!0)}try{const e=yield t.loadModule("osutils");e&&(i.deviceInfo=yield null===(n=e.getDeviceInfo)||void 0===n?void 0:n.call(e),i.systemCpuInfo=yield null===(a=e.getSystemCpuInfo)||void 0===a?void 0:a.call(e),i.systemMemoryInfo=yield null===(o=e.getSystemMemoryInfo)||void 0===o?void 0:o.call(e))}catch(t){e.errorToTelemetry&&e.errorToTelemetry(YN.LoadModuleOsUtilsFailed,"webclient_framework_host_comms",void 0,!0)}try{const e=yield t.loadModule("telemetry");i.desktopContext=yield null===(r=null==e?void 0:e.getContext)||void 0===r?void 0:r.call(e,{columns:["launchIntent","desktopVersion","deviceAuthToken","windowsChannel","windowsSku","storageInfo","outOfProcState"]})}catch(t){e.errorToTelemetry&&e.errorToTelemetry(YN.LoadModuleTelemetryFailed,"webclient_framework_host_comms",void 0,!0)}}return i}))}handOffContextCommsCallback(e,t,n){var a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield e.loadModule("telemetry"),r=yield null===(a=null==i?void 0:i.getPreAuthUserSamplingId)||void 0===a?void 0:a.call(i);if(r&&(null===(o=this.setPreAuthUserId)||void 0===o||o.call(this,t,n,r)),i&&i.setContext){const e=i.setContext;(0,pT.G)().setMultiContextCallback(((t,n,i)=>e([{column:t,value:n,userContextId:i}])))}}))}createMemoryAnalyzer(e,t){const{enableDesktopMemoryAnalyzer:n,isScenarioMemorySnapshotEnabled:i}=t;return n?new QK(!!i,e):void 0}createCoreScenarioFactory(e,t,n,i,a){const o=new dQ.J({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:e.correlation},e.config.startTimeMS,t,void 0,void 0,void 0,void 0,i,a,n);return e.scenarioFactory=o,o}createHeartbeatMonitor(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=new SJ.K(e);yield t.start(),e.heartbeatMonitor=t}))}createDataClientTrackerService(e){const t=e.platformService.config.clientType===Pe.Bh.Maglev?()=>!!e.clientState&&[yC.pk.Inactive,yC.pk.LongInactive].includes(e.clientState.getState()):()=>!!e.appStateService&&[he.eT.Inactive,he.eT.LongInactive].includes(e.appStateService.getState());return new tY(e.coreSettings,e.leakDetectorService,e.userTrackingService,t)}createWindowTrackerService(e){e.windowTrackerService=new pY(e)}createCoreTelemetryService(e,t,n,a,o,r){var s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{config:i,coreSettings:l,coreSecurityService:c,experimentationService:d,hostCommunicationService:u,loggerFactory:m,platformService:g,routingServices:p,windowProvider:v}=e,h=yield MG(u),f=(0,FG.pf)(v),y={osLocale:h,userLanguage:xG(v),localeCode:OG(v,p,f.localeCode),originLocaleCode:PG(v,p,f.localeCode)},{telemetryContext:b}=((e,t,n,i,a,o,r,s)=>{const l=t.newLogger("Telemetry","core-services-telemetry"),c=MY(e,l,n,i),d=r||new aQ.v(l),{columnSuppression:u}=xY(t.newLogger("TelemetrySender","core-services-telemetry"),i,c.documentInfo.tablePostfix),m=RY(i,o);return(0,pT.G)().initialize(c,l,i,m,u),OY(e,l,n,i,c.documentInfo,!1,d,a,s),{telemetryContext:d}})({appStartTime:i.startTimeMS,experienceName:i.experienceName,windowType:i.windowType,clientTypeTelemetry:i.clientTypeTelemetry},m,g,l,y,{coreSecurityService:c,windowBaseUrl:v.document.location.origin},o,d),S=new AQ(n,b,t,{isolateUserContext:null!==(s=l.get(L.J.Telemetry).isolateUserContext)&&void 0!==s&&s});if(v.localStorage){const e=v.localStorage.getItem("ts.latestOid");null==S||S.setContext("UserInfo.Id",e)}i.externalCorrelationId&&S.setCoreContext("EventInfo.ExternalCorrelationId",i.externalCorrelationId),i.embedContext&&(S.setCoreContext("Window.EmbedContext",i.embedContext),S.setCoreContext("AppInfo.EmbedReferrer",function(e,t){try{const{referrer:n}=t.getSearchState(),i=e.document.referrer,a=e.parent.opener;let o=n;return vY(e,o)||(o=i&&(0,HE.Lp)(i),vY(e,o)||(o=a&&a.location&&a.location.hostname||void 0,!vY(e,o)&&e.location.ancestorOrigins&&e.location.ancestorOrigins.length>0&&(o=e.location.ancestorOrigins[0]))),o||""}catch(e){return""}}(v,p.state))),this.setTelemetryContext(S,a,r),S.setCoreContext("AppInfo.ArchVersion","V2"),e.telemetryService=S}))}setPreAuthUserId(e,t,n){const i=e.get(L.J.Telemetry);n&&i.enablePreAuthIdSampling&&(t.setCoreContext("AppInfo.PreAuthUserSamplingId",n),bY.H.getInstance().setSamplingByPreAuthId(n))}createCoreUserBiService(e){var t;const{config:n}=e,i=null===(t=e.telemetryService)||void 0===t?void 0:t.createUserBiService(e,he.ew,{id:(0,Ye.v4)(),source:kt.D.StandAlone,startTimestamp:n.startTimeMS});e.userBiService=i}setTelemetryContext(e,t,n){const{deviceInfo:i,systemCpuInfo:a,systemMemoryInfo:o}=t;if(i&&(e.setCoreContext("DeviceInfo.Make",i.make),e.setCoreContext("DeviceInfo.Model",i.model),e.setCoreContext("DeviceInfo.CpuArchitecture",i.cpuArchitecture),e.setCoreContext("DeviceInfo.OsVersion",i.osVersion)),a&&(e.setCoreContext("CpuInfo.Cores",a.cpuCores.length.toString()),e.setCoreContext("CpuInfo.Model",a.cpuCores[0].model),e.setCoreContext("CpuInfo.Speed",a.cpuCores[0].speed)),o&&e.setCoreContext("DeviceInfo.TotalMemory",o.totalPhysicalMemoryBytes),n&&0!==n.length){const t=n.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.column]:t.value})),{}),i=t.launchIntent,a=t.desktopVersion,o=t.deviceAuthToken,r=t.windowsChannel,s=t.windowsSku,l=t.storageInfo,c=t.outOfProcState;i&&e.setCoreContext("AppInfo.LaunchIntent",i),a&&e.setCoreContext("AppInfo.DesktopVersion",a),c&&e.setCoreContext("AppInfo.OutOfProcState",c),o&&e.setDeviceAuthToken(o),r&&e.setCoreContext("DeviceInfo.WindowsChannel",r),s&&e.setCoreContext("DeviceInfo.WindowsSku",s),l&&e.setCoreContext("DeviceInfo.StorageInfo",l)}}startAppStartScenarios(e,t){const{config:n,loggerFactory:i,routingServices:a,telemetryService:o,windowProvider:r}=e,s=this.getDownloadAndParseStepData(i,t,r);null==o||o.newCoreScenario(it.RG.AppStart,{startTime:n.startTimeMS}),fY(n.experienceName,t,n.startTimeMS,a.state,r,s)}getDownloadAndParseStepData(e,t,n){let i;if(n.performance){const a=e.newLogger("InitTelemetryTask","core-services-tasks");n.performance.timing&&t.createScenarioWithoutStarting(it.RG.DomLoadingStart,{startTime:n.performance.timing.domLoading}).stop();const o=n.performance.getEntriesByType("resource").find((e=>"script"===e.initiatorType&&e.name.indexOf("main")>=0)),r=void 0!==o&&0===o.transferSize;i=yY(it.RG.DownloadAndParse,"execute-index-html-script","start-execute-main-bundle",n,t,a,{cached:r}),yY(it.RG.ResolveMainImports,"start-execute-main-bundle","resolve-main-imports-end",n,t,a)}return i}}const KY=e=>t=>{switch(t){case"quit":null==e||e.getTelemetryServicesCache().forEach((e=>{var t,n;return null===(n=(t=e.coreScenarioFactory).incompleteRunningScenarios)||void 0===n?void 0:n.call(t)}))}};var YY=n(813628);class XY extends fe{constructor(){super(he.Yg.InitUserBrbServiceTask,["scenarioFactory","loggerFactory","coreSettings","logsCollectorService","authenticationService","authenticationUser","platformService","discover","windowProvider","hostCommunicationService","endpointsManager","brbServiceManager","client","i18n"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,coreSettings:i,logsCollectorService:a,authenticationService:o,authenticationUser:r,platformService:s,discover:l,windowProvider:c,hostCommunicationService:d,endpointsManager:u,brbServiceManager:m,client:g,i18n:p}=e;if(!r)throw new Error("authenticationUser is invalid, cannot register user brb service.");const v=(0,di.b4)(r);return m.registerUserBrbService(v,(()=>new YY.w(n,i,a,o,s,l,c,d,u,t,p,r,g))),e=>{switch(e){case"signout":m.unregisterUserBrbService(v);break;default:return}}}))}}class ZY extends fe{constructor(){super(he.Yg.InitializePulsarTask,["coreSettings","loggerFactory","platformService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,platformService:i}=e,a=new cE(aE.TEAMS_CORE,{sessionId:i.host.sessionId,spanExporter:new dE,loggerFactory:n,logToOTLCollector:!!t.get(L.J.Pulsar).logToOTLCollector});t.get(L.J.Pulsar).enablePulsarTelemetry&&(yield a.initialize()),e.pulsar=a}))}}class eX extends fe{constructor(){super(he.Yg.RegisterCustomFrameThemes,["coreSettings","hostCommunicationService"])}execute(e){var t,n,a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:i,hostCommunicationService:r}=e,{primaryWindowTitleBarHeightPx:s,secondaryWindowTitleBarHeightPx:l}=i.get(L.J.Core),c=yield r.loadModule("windowcontrols");s&&l&&(null===(t=null==c?void 0:c.defineCustomFrameTheme)||void 0===t||t.call(c,"main",{buttonHeight:s,buttonWidth:44}),null===(n=null==c?void 0:c.defineCustomFrameTheme)||void 0===n||n.call(c,"default",{buttonHeight:l,buttonWidth:44}),null===(a=null==c?void 0:c.defineCustomFrameTheme)||void 0===a||a.call(c,"mainClassic",{buttonHeight:s,buttonWidth:44,light:{closeColors:{background:{normal:"#444791ff",inactive:"#44479199",mouseOver:"#c4314bff",mouseDown:"#a72037ff"},foreground:{normal:"#ffffffff",inactive:"#ffffff99",mouseOver:"#ffffffff",mouseDown:"#ffffffff"}},minMaxColors:{background:{normal:"#444791ff",inactive:"#44479199",mouseOver:"#4f52b2ff",mouseDown:"#3d3e78ff"},foreground:{normal:"#ffffffff",inactive:"#ffffff99",mouseOver:"#ffffffff",mouseDown:"#ffffffff"}}}}),null===(o=null==c?void 0:c.defineCustomFrameTheme)||void 0===o||o.call(c,"defaultClassic",{buttonHeight:l,buttonWidth:44,light:{closeColors:{background:{normal:"#444791ff",inactive:"#44479199",mouseOver:"#c4314bff",mouseDown:"#a72037ff"},foreground:{normal:"#ffffffff",inactive:"#ffffff99",mouseOver:"#ffffffff",mouseDown:"#ffffffff"}},minMaxColors:{background:{normal:"#444791ff",inactive:"#44479199",mouseOver:"#4f52b2ff",mouseDown:"#3d3e78ff"},foreground:{normal:"#ffffffff",inactive:"#ffffff99",mouseOver:"#ffffffff",mouseDown:"#ffffffff"}}}}))}))}}var tX=n(183341);class nX extends fe{constructor(){super(he.Yg.ReloadExperience,["coreSettings","platformService","rebootService","loggerFactory","scenarioFactory","windowProvider"]),this.isReloadRequired=(e,t)=>e&&t&&e!==t}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,platformService:n,rebootService:i,loggerFactory:a,scenarioFactory:o,windowProvider:r}=e,s=a.newLogger("ReloadExperienceTask","core-services-tasks"),{buildRing:l,assignedRing:c}=this.getRings(n,t);if(this.isReloadRequired(l,c)&&c){s.log(`Reload required: Assigned: ${c}, Build: ${l}`);return(yield i.rebootApp(SN.Z.RingSwitch,SN.d.ReloadAppTask,{qsps:{ring:c},maxRetries:1}))?this.deleteEcsCaches(r):this.reportReloadNotTriggered(l,c,s,o),e=>{switch(e){case"signout":i.clearRetryCount(SN.d.ReloadAppTask);break;default:return}}}s.debug(`No reload required: Assigned: ${c}, Build: ${l}`),i.clearRetryCount(SN.d.ReloadAppTask)}))}getRings(e,t){const{ring:n}=t.get(L.J.Metadata);return{assignedRing:(null==n?void 0:n.id)||void 0,buildRing:e.ecsOverrides.ring||void 0}}reportReloadNotTriggered(e,t,n,i){n.warn(`Ring Discrepancy: Assigned: ${t}, Build: ${e} `),i.createScenarioWithoutStarting(it.RG.BuildRingDiscrepancy).fail({message:e})}deleteEcsCaches(e){Object.keys(e.localStorage).filter((e=>e.endsWith(tX.Z.EcsCache))).forEach((t=>e.localStorage.removeItem(t)))}}class iX extends fe{constructor(){super(he.Yg.SetAppStateToTelemetryTask,["telemetryService","hostState","networkState","coreSettings"])}execute(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{telemetryService:i,hostState:a,networkState:o,coreSettings:r}=e;r.get(L.J.Telemetry).enableTelemetryCancelOnSuspendAndNetworkOffline&&(a&&i.initTelemetrySuspendStateSubscription(a,null!==(t=r.get(L.J.Telemetry).scenarioCancelOnSuspendStateChangeBlockList)&&void 0!==t?t:[]),o&&i.initTelemetryNetworkStateSubscription(o,null!==(n=r.get(L.J.Telemetry).scenarioCancelOnNetworkStateChangeBlockList)&&void 0!==n?n:[]))}))}}class aX extends fe{constructor(){super(he.Yg.SetRingFinderCookieTask,["authenticationUser","coreSettings","loggerFactory","windowProvider","discover"]),this.setAuthCookie=(e,t,n,i)=>{var a;if(void 0===(null===(a=e.document)||void 0===a?void 0:a.cookie))return void t.warn(`Cannot set cookie: '${n}'.`);t.log(`Setting '${n}' cookie.`);const o=new Date,r=o.setMonth(o.getMonth()+5);e.document.cookie=`${n}=${i};expires=${new Date(r).toUTCString()};path=/;secure;samesite=none`},this.cleanUpCookie=(e,t,n)=>{var i;void 0!==(null===(i=e.document)||void 0===i?void 0:i.cookie)&&(t.log(`Expiring '${n}' cookie.`),e.document.cookie=`${n}=;max-age=0;path=/;secure;samesite=none`)}}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n,discover:i,loggerFactory:a,windowProvider:o}=e,r=a.newLogger("SetRingFinderCookieTask","core-services-tasks");try{const{windowsInsiderChannel:e,windowsInsiderRing:a}=n.get(L.J.Host),{enableRegionParamForPDS:s}=n.get(L.J.Core);let l;s&&(l=yield i.getRegion({id:t.id,tenantId:t.profile.tenantId,oid:t.profile.objectId,accountType:t.type,userName:t.loginUserName||""}));const c={oid:t.profile.objectId,tid:t.profile.tenantId,wipChannel:e,wipRing:a,region:l},d="ringFinder";return this.setAuthCookie(o,r,d,encodeURIComponent((0,wi.u4)(c))),e=>{switch(e){case"signout":this.cleanUpCookie(o,r,d);break;default:return}}}catch(e){r.error(`Failed to set ring finder cookie: ${(0,An.VK)(e)}`)}}))}}class oX extends fe{constructor(){super(he.Yg.SetPrimaryUserOnTelemetry,["primaryUser","loggerFactory","telemetryContextService","hostCommunicationService"])}execute(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{primaryUser:i,loggerFactory:o,telemetryContextService:r,hostCommunicationService:s}=e;try{const e=(0,di.b4)(i),n=i.profile.tenantId;r.setPrimaryUser(e,n);const a=yield s.loadModule("telemetry");null===(t=null==a?void 0:a.setPrimaryUser)||void 0===t||t.call(a,e,n)}catch(e){const t=new kC.G(kC.$.TELEMETRY_PRIMARY_USER_SET_FAILURE,e,(0,di.b4)(i));null===(a=(n=o.newLogger("SetUserOnTelemetryContext","core-services-tasks")).error)||void 0===a||a.call(n,t.toTelemetryEntry())}}))}}class rX{constructor(){this.id=he.Yg.SetUserOnDiagnosticsService}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n,diagnosticsService:i,logsCollectorService:a}=ax("SetUserOnDiagnosticsServiceTask",e,"authenticationUser","coreSettings","diagnosticsService","logsCollectorService");a.setPrimaryUserID(t.id);const{enableMTMA:o}=n.get(L.J.Core);if(o){const n=i.createUserDiagnosticsService(t.profile.tenantId,t.profile.objectId,t.id);n&&(e.diagnosticsService=n,a.registerUserLogsProvider(t.id,n),e.loggerFactory=new Kw.m(n,e.loggerFactory.cID))}else i.updateDiagnosticInfo(t.profile.tenantId,t.profile.objectId);return e=>{switch(e){case"quit":i.persistDiagnosticsAsPreviousSessionLogs();break;case"signout":t.id&&a.handleUserLogout(t.id),i.handleUserLogout(t.id)}}}))}}function sX(e){return!!(null==e?void 0:e.isAuthenticated)}function lX(e,t){const{enableTflFreProfileConsentDialog:n}=e.get(L.J.Fre);return!(!n||t&&"true"===t.get("TflFreProfileCardDisplayed"))}class cX extends fe{constructor(){super(he.Yg.SignalCoreLifecycleChangesTask,["authenticationUser","client","clientState","config","coreSecurityService","coreSettings","coreUtilities","correlation","entityCommanding","experienceChangeReportingService","experienceLifecycleManager","hostCommunicationService","i18n","i18NextWrapper","localStorage","loggerFactory","networkState","platformService","rebootService","scenarioFactory","userBiService","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{activeWindowsHistoryService:t,authenticationUser:n,client:a,clientState:o,clientAccessAdminPolicyCheckService:r,config:s,coreSecurityService:l,coreSettings:c,coreUtilities:{isEntityInView:d},correlation:u,entityCommanding:m,experienceChangeReportingService:g,experienceLifecycleManager:p,hostCommunicationService:v,i18n:h,i18NextWrapper:f,localStorage:y,loggerFactory:b,networkState:S,platformService:k,rebootService:w,scenarioFactory:C,userBiService:_,userTrackingService:T,windowProvider:I}=e,E=b.newLogger("SignalCoreLifecycleChangesTask","core-services-tasks");if(!n||!sX(n))return void E.warn("Not creating user lifecycle manager as authenticated user is not available.");const{disableExperience:N}=c.get(L.J.Core);if(N)return void E.warn("Not creating user lifecycle manager as experience is disabled.");if(r){let e;try{e=yield r.isUserAllowed()}catch(t){E.warn(`isUserAllowed encountered exception: ${t}`),e=!0}if(!e)return void E.warn("Not creating user lifecycle manager as experience is disabled by admin policy.")}const A=u.id,F=(0,di.b4)(n);return p.manageUser(F,{activeWindowsHistoryService:t,authenticationUser:n,client:a,clientState:o,config:s,coreSecurityService:l,coreSettings:c,entityCommanding:m,i18n:h,i18NextWrapper:f,isEntityInView:d,loggerFactory:b,networkState:S,platformService:k,rebootService:w,scenarioFactory:C,hostCommunicationService:v,userTrackingService:T,windowProvider:I,localStorage:y,userBiService:_}),g.report({correlationId:A,userContextId:F,type:l_.yU.UserAuthenticated,context:{target:"core-tasks-signal-core-lifecycle-changes-task"}}),lX(c,y)||g.report({correlationId:A,type:l_.yU.UserConsentedToConsumeResources,userContextId:F,context:{target:"core-tasks-signal-core-lifecycle-changes-task"}}),e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"quit":case"signout":yield p.removeUser(e,F);break;default:return}}))}))}}class dX extends fe{constructor(){super(he.Yg.StoreBuildInfoTask,["localStorage","platformService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{localStorage:t,platformService:n}=e,i=n.config.buildVersion;i&&!i.toLocaleLowerCase().startsWith("local")&&t.set("buildNumber",i,Ct.f.Experience)}))}}class uX extends fe{constructor(){super(he.Yg.TrackExperienceIdle,["clientState","correlation","coreSettings","experienceChangeReportingService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,correlation:n,coreSettings:a,experienceChangeReportingService:o}=e,{enableExperienceIdleStateManagement:r}=a.get(L.J.Core);if(!r)return;const s=t.observe().subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e===yC.pk.LongInactive;o.report({correlationId:n.id,type:l_.yU.ExperienceIdleStateChanged,context:{target:"core-tasks-signal-core-lifecycle-changes-task",isIdle:t}})}))));return e=>{switch(e){case"signout":case"quit":s.unsubscribe()}}}))}}class mX extends fe{constructor(){super(he.Yg.TrackUserTask,["authenticationUser","userTrackingService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,di.b4)(e.authenticationUser);return e.userTrackingService.trackUser(t),n=>{switch(n){case"signout":e.userTrackingService.removeUser(t)}}}))}}class gX extends fe{constructor(){super(he.Yg.UpdateDataClientContext,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){!function(e,t){var n,i,a;const o=Object.assign(Object.assign({},t),{pubsub:e.getServices().pubsub,send:(0,JA.UZ)(ye.l,t.networkState.observeIsOnline())}),r=aO.singletonLink,s=Tj.clientResolvers;if(!r||!s)throw new Error("Link and client resolvers should be created at this point");const{maxApolloResultCacheSize:l,enableApolloDoubleWriteFix:c}=t.coreSettings.get(L.J.Core),{enableApolloDevtools:d}=t.coreSettings.get(L.J.Diagnostics),u=null!=l?l:void 0,m=null===(n=t.leakDetectorService)||void 0===n?void 0:n.create(),g=Dz({leakDetector:m,windowId:null===(i=e.cache.apolloLeakInfo)||void 0===i?void 0:i.apolloLeakInfoWindowId,entityType:null===(a=e.cache.apolloLeakInfo)||void 0===a?void 0:a.apolloLeakInfoEntityType,viewportContext:"cmd"},void 0,s,u,t.loggerFactory,t.scenarioFactory,void 0,d,Kx.t.cmd,t.graphqlStoreStatsReporterService,c);sM(g,"cmdApolloClient",Boolean(d),t.platformService,t.config.experienceName);const p=Nz.createUserDataRequestContext(o,g),v=Oz(p,r);e.updateContext(p,v),g.setLink(v)}(e.client,e)}))}}class pX extends fe{constructor(){super(he.Yg.UpdateNetworkStateDetection,[])}execute(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.authenticationUser&&(0,di.b4)(e.authenticationUser)||"",a=null===(n=(t=e.networkState).subscribeToEndpointsNetworkStateTracking)||void 0===n?void 0:n.call(t,i,e.endpointsManager.networkState);return e=>{switch(e){case"signout":a();break;default:return}}}))}}class vX extends fe{constructor(){super(he.Yg.WaitForCDLWorkerTask,["loggerFactory","coreSettings","coreSettingsContext"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,coreSettings:n,coreSettingsContext:i}=e,{cdlWorkerService:a}=e,o=t.newLogger("WaitForCDLWorkerTask","core-services-tasks");if(!(0,ID.Q6)(n))return;const{isCDLWorkerCriticalToStartup:r}=n.get(L.J.Core);if(a){o.log("Waiting for CDL worker to finish initialization");const e=yield a.getCDLWorkerManager();if(e)e.syncEngineInitializationPromise.then((e=>{i.updatePlatformProviderSettings({bootType:e.bootType})}));else if(o.error("CDL worker manager not initialized."),r)throw new kC.G(kC.$.CDL_WORKER_FAILURE)}else if(o.warn("CDL worker service not present in core context."),r)throw new kC.G(kC.$.CDL_WORKER_FAILURE)}))}}class hX extends fe{constructor(){super(he.Yg.WrapChangeReportingServicesTask,["commandChangeReportingService","experienceChangeReportingService","authenticationUser"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,experienceChangeReportingService:n,authenticationUser:i}=e,a=(0,di.b4)(i);return e.commandChangeReportingService=Object.assign(Object.assign({},e.commandChangeReportingService),{report:e=>{t.report(Object.assign({userContextId:a},e))},observeChanges:t.observeChanges.bind(t)}),e.experienceChangeReportingService=Object.assign(Object.assign({},e.experienceChangeReportingService),{report:e=>{n.report(Object.assign({userContextId:a},e))},observeChanges:n.observeChanges.bind(n)}),Promise.resolve()}))}}class fX extends fe{constructor(){super(he.Yg.ClearHostSettingsTask,["loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t}=e,n=t.newLogger("ClearHostSettingsTask","core-services-tasks");e.hostSettings=void 0,n.log("ClearHostSettingsTask: Host settings cleared from task init context.")}))}}class yX extends fe{constructor(){super(he.Yg.CreateHostedWindowContext,["hostedWindowContext","hostSettings"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{hostedWindowContext:t,hostSettings:n}=e,i=n.hostSettings;i&&(t.sessionStartTime=i.createdTime,t.localeCode=i.localeCode,t.ring=i.hostRingId),"general_gcc"===t.ring&&(null==i?void 0:i.enableDevTools)&&(t.ring="ring0_gcc")}))}}class bX extends fe{constructor(){super(he.Yg.FetchHostSettingsTask,["config","hostedWindowContext","loggerFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{config:t,hostedWindowContext:n,loggerFactory:i,windowProvider:a}=e,{isInCypressFrame:o,isInIframe:r}=n,s=i.newLogger("FetchHostSettingsTask","core-services-tasks");if(t.shouldFetchBootstrapData&&r&&!o)try{s.log("Hosted in web. Fetching host settings from host over IPC.");const t=yield a.opener.requestMessage(n_.rY.GetStateData,{requestType:"hostSettings"});s.log("Host settings fetched, setting context.hostSettings"),e.hostSettings=Object.assign({},t.hostSettings)}catch(e){s.errorToTelemetry&&s.errorToTelemetry(`Error fetching host settings over IPC ${e}`,"webclient_framework_foundation_core_services_tasks",void 0,!0)}else{s.log("Hosted in desktop. Getting host settings from window object.");const t=window;t.hostSettings&&(s.log("Found window.hostSettings."),e.hostSettings=Object.assign({},t.hostSettings),delete t.hostSettings)}}))}}var SX;!function(e){e[e.Unknown=5e4]="Unknown",e[e.GetSingletonStoreFailed=4e4]="GetSingletonStoreFailed",e[e.CreateStoreFailed=40001]="CreateStoreFailed",e[e.ActionNotSupported=40002]="ActionNotSupported"}(SX||(SX={}));var kX=n(725833),wX=n(935315),CX=n(71586);const _X={code:SX.CreateStoreFailed,message:"Store is not available"};function TX(e){return new IX(e)}class IX extends Y_.y{constructor(e){const t=e?EX(e):(0,kX._)(_X);super((e=>t.subscribe(e))),this._dispatcher=e?Promise.resolve(e):Promise.reject(_X)}dispatch(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield this._dispatcher).dispatch(e)}))}}const EX=e=>(0,Pw.D)(Promise.resolve(e)).pipe((0,r_.w)((e=>new Y_.y((t=>e.subscribe((e=>t.next(e))))))),(0,wX._)(1),(0,CX.x)());class NX extends Y_.y{constructor(e,t){const n=t.pipe((0,Lw.U)((t=>{var n;return null===(n=null==t?void 0:t.windows[e])||void 0===n?void 0:n.lifecycle})),(0,qN.x)(a.isEqual),(0,jw.h)((e=>void 0!==e)),(0,J_.o)((e=>void 0===e.closedTime),!0));super((e=>n.subscribe(e))),this._id=e,this._dispatcher=t}pushWltMarks(e){return this._dispatcher.dispatch({type:"RECORD_WINDOW_LIFECYCLE_MARKS",windowId:this._id,markers:e})}}var AX=n(206385),FX=n(563756);class DX{constructor(e,t,n){if(this.exitFullscreen=e=>this._observableStore.dispatch((e=>({type:"SET_FULLSCREEN",windowId:e,fullscreen:!1}))(e)),this.focus=e=>this._observableStore.dispatch((e=>({type:"FOCUS_WINDOW",windowId:e}))(e)),this.maximize=e=>this._observableStore.dispatch((e=>({type:"TOGGLE_MAXIMIZE_WINDOW",windowId:e}))(e)),this.minimize=e=>this._observableStore.dispatch((e=>({type:"MINIMIZE_WINDOW",windowId:e}))(e)),this.requestFullscreen=e=>this._observableStore.dispatch((e=>({type:"SET_FULLSCREEN",windowId:e,fullscreen:!0}))(e)),this.show=e=>this._observableStore.dispatch((e=>({type:"SHOW_WINDOW",windowId:e}))(e)),this.windowTitleDblClick=e=>this._observableStore.dispatch((e=>({type:"INVOKE_DOUBLE_CLICK",windowId:e}))(e)),e.createInterprocessStore){const i=e.createInterprocessStore({logDebug:(...e)=>t.debug(...e),logError:(...e)=>t.error(...e),logInfo:(...e)=>t.log(...e),logScenario:e=>{n.newScenario(e.name).stop(void 0,e.status)}});this._observableStore=TX(i)}else this._observableStore=TX(null)}onWindowFullscreen(e){return this._observableStore.pipe((0,AX.j)("windows",e),(0,FX.n)((e=>void 0===e)),(0,J_.o)((e=>{var t;return void 0===(null===(t=e.lifecycle)||void 0===t?void 0:t.closedTime)})),(0,AX.j)("layout","fullscreen"),(0,qN.x)())}onLifecycleMarks(e){return new NX(e,this._observableStore)}}class RX extends fe{constructor(){super(he.Yg.InitInterprocessStore,["windowProvider","loggerFactory","scenarioFactory","coreSettings"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,scenarioFactory:i,coreSettings:a}=e;a.get(L.J.Core).disableInterprocessStore||(e.interprocessStoreService=new DX(t,n.newLogger("InterProcessStore","core-services-tasks"),i)),delete t.createInterprocessStore}))}}class xX extends fe{constructor(){super(he.Yg.Polyfills,[])}execute(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.applyAsyncIteratorPolyfillIfNeeded()}))}applyAsyncIteratorPolyfillIfNeeded(){void 0===Symbol.asyncIterator&&(Symbol.asyncIterator=Symbol.asyncIterator||n(212673).$$asyncIterator)}}var MX=n(286096);class OX{constructor(e){this.logsProviderTimeoutMs=2e4,this.coreProviders=[],this.userProviders={},this.primaryUserID="",this.allowZipLogFiles=!1,this.environmentName="",this.logger=e.newLogger("LogsCollectorService","core-services-logs-collector")}subscribeToCoreSettings(e){if(!e)return void this.logger.error("Failed to subscribe to core settings");e.getObservable(L.J.Diagnostics,["logsProviderTimeoutMs","shouldZipLogFiles"]).subscribe((({logsProviderTimeoutMs:e,shouldZipLogFiles:t})=>{e&&(this.logsProviderTimeoutMs=e),this.allowZipLogFiles=!!t}));e.getObservable(L.J.Metadata,["environment"]).subscribe((({environment:e})=>{e&&(this.environmentName=e)}))}registerCoreLogsProvider(e){var t,n;e.logsProviderName===MX.d.DIAGNOSTICSSERVICE?this.diagnosticsLogProvider=e:this.coreProviders.some((t=>t.logsProviderName===e.logsProviderName))?null===(n=(t=this.logger).warnNoPii)||void 0===n||n.call(t,`Registering redundant core logger with name ${e.logsProviderName}`):this.coreProviders.push(e)}registerUserLogsProvider(e,t){var n,i;this.primaryUserID&&!e&&(e=this.primaryUserID),this.userProviders[e]?this.userProviders[e].some((e=>e.logsProviderName===t.logsProviderName))?null===(i=(n=this.logger).warnNoPii)||void 0===i||i.call(n,`Registering redundant user logger with name ${t.logsProviderName}`):this.userProviders[e].push(t):this.userProviders[e]=[t]}unregisterUserLogsProvider(e,t){var n,i;this.primaryUserID&&!e&&(e=this.primaryUserID),this.userProviders[e]?(this.userProviders[e]=this.userProviders[e].filter((e=>e.logsProviderName!==t)),0===this.userProviders[e].length&&delete this.userProviders[e]):null===(i=(n=this.logger).warnNoPii)||void 0===i||i.call(n,`Unregistering user logger with name ${t} failed, user ${e} not found`)}getCoreLogsProvider(e){return this.coreProviders.find((t=>t.logsProviderName===e))}getUserLogsProvider(e,t){var n;return null===(n=this.userProviders[e])||void 0===n?void 0:n.find((e=>e.logsProviderName===t))}handleUserLogout(e){delete this.userProviders[e]}callOnLogsFiles(e,t=!1,n=!1,a=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.callOnUserLogsFiles(Object.keys(this.userProviders),e,t,n,a)}))}callOnUserLogsFiles(e,t,a=!1,o=!1,r=0){var s,l,c;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;if(a&&this.allowZipLogFiles)try{const e=null===(s=yield n.e(981578).then(n.t.bind(n,600070,23)))||void 0===s?void 0:s.default;e&&(i=new e)}catch(e){null===(c=(l=this.logger).errorToTelemetry)||void 0===c||c.call(l,`Load jszip failed - ${e}`,"logs_loading_jszip")}const d={fileName:"summary.txt",content:"",isPiiFree:!0},u=e=>(null==i?void 0:i.file)?(i.file(e.fileName,e.content),Promise.resolve(!0)):(e.fileName=`WebLogs/${e.fileName}`,t(e)),m=yield this.callOnOnlyCoreLogsFiles(u,d,o,r),g=yield this.callOnOnlyUserLogsFiles(e,u,d,o,r),p=yield this.createSummaryFile(u,d);if(i){const e=yield i.generateAsync({type:"blob",compression:"DEFLATE"}),n=this.environmentName?`${this.environmentName.toUpperCase()}-`:"";return t({fileName:`${n}WebLogs-${(new Date).toISOString()}.zip`,content:e,isPiiFree:!0})}return m&&g&&p}))}getSystemInfo(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let e=new Map;try{const t=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield(0,Fn.E)(e.getSystemInfo(),this.logsProviderTimeoutMs)}catch(t){if((0,Fn.T)(t))return this.logger.error(`Timed out fetching system info from logs provider - ${e.logsProviderName}`),new Map;throw t}})),n=this.coreProviders.map(t);this.diagnosticsLogProvider&&n.push(t(this.diagnosticsLogProvider));const a=yield Promise.all(n);a&&a.length>0&&(e=a.reduce(((e,t)=>new Map([...Array.from(e.entries()),...Array.from(t.entries())]))))}catch(e){this.logger.error("Fetching system info from logs providers failed with error:",e)}return e}))}setPrimaryUserID(e){if(e&&!this.primaryUserID){this.primaryUserID=e;const t=this.userProviders[""];t&&(this.userProviders[this.primaryUserID]=t,delete this.userProviders[""])}}setGetSummaryFunction(e){this.generateSummary=e}getUserLogFileName(e,t){return`User (${e===this.primaryUserID?"Primary; ":""}${e})/${t}`}getCoreLogFileName(e){return`Core/${e}`}callOnOnlyCoreLogsFiles(e,t,n=!1,a=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i=t=>(t.fileName=t.userId?this.getUserLogFileName(t.userId,t.fileName):this.getCoreLogFileName(t.fileName),e(t));this.logger.log(`Fetching files from providers: ${this.coreProviders.reduce(((e,t)=>e+`${null==t?void 0:t.logsProviderName}, `),"")}`);const o=yield this.callOnLogsFilesOfLogsProviders(this.coreProviders,i,t,n,a),r=!this.diagnosticsLogProvider||(yield this.callOnLogsFilesOfLogsProviders([this.diagnosticsLogProvider],i,t,n,a));return o&&r}catch(e){return this.logger.error("Error calling callback on logs files from all logs providers - error:",e),!1}}))}callOnOnlyUserLogsFiles(e,t,n,a=!1,o=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=[];return e.length>0&&e.forEach((e=>{if(this.userProviders[e]&&this.userProviders[e].length>0){const r=n=>(n.fileName=this.getUserLogFileName(e,n.fileName),t(n));i.push(this.callOnLogsFilesOfLogsProviders(this.userProviders[e],r,n,a,o))}})),(yield Promise.all(i)).every(Boolean)}))}timeoutSafeGetLogsFiles(e,t=!1,n=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield(0,Fn.E)(e.getLogsFiles(t,n),this.logsProviderTimeoutMs)}catch(t){if((0,Fn.T)(t))return this.logger.error(`Timed out fetching logs files from logs provider - ${e.logsProviderName}`),[];throw t}}))}callOnLogsFilesOfLogsProviders(e,t,n,a=!1,o=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.map((e=>this.timeoutSafeGetLogsFiles(e,a,o))),r=yield Promise.all(i),s=[];r.forEach((e=>{e&&e.length>0&&s.push(...e)}));const l=s.map((e=>{try{return"latestErrors"===e.fileName?(n.content=`${n.content}${e.content}\r\n`,Promise.resolve(!0)):t(e)}catch(t){return this.logger.error(`Error calling callback on logs file, ${null==e?void 0:e.fileName} - error:`,t),!1}}));return(yield Promise.all(l)).every((e=>e))}))}createSummaryFile(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield null===(n=this.generateSummary)||void 0===n?void 0:n.call(this);return i&&(t.content=`${i}\r\n${t.content}`),e(t)}))}}var PX=n(612778);class LX{constructor(e,t){this.coreTaskManager=e,this.userRenderingContextMap=new Map,this.logger=t.newLogger("RenderingContextManager","core-services-activator")}cleanupWithPriority(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new kC.G(kC.$.RENDERING_CONTEXT_DOES_NOT_EXIST));const t=this.userRenderingContextMap.keys(),n=Array.from(t).map((t=>()=>this.cleanupActiveWindowsHistoryService(e,t)));yield BX(n,this.defaultRenderingContext)}))}createCoreServices(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("createCoreServices: start");const e=yield this.coreTaskManager.notifyLifeCycleEvent(he.sM.Initialization),{coreTaskErrors:t}=e,n=(0,i.__rest)(e,["coreTaskErrors"]);return this.defaultRenderingContext=n,this.logger.log("createCoreServices: done"),Object.assign(Object.assign({},n),{error:$X(t,n)})}))}executePrimaryUserTasks(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new kC.G(kC.$.RENDERING_CONTEXT_DOES_NOT_EXIST));const t=(0,di.b4)(e);this.logger.log(`executePrimaryUserTasks(${t}): start`);const n=yield this.coreTaskManager.notifyLifeCycleEvent(he.sM.OnPrimaryUser,Object.assign(Object.assign({},this.defaultRenderingContext),{primaryUser:e,authenticationUser:e})),{coreTaskErrors:a}=n,o=(0,i.__rest)(n,["coreTaskErrors"]),r=$X(a,this.defaultRenderingContext);if(delete o.authenticationUser,this.primaryUserContext=o,r)throw r;return this.logger.log(`executePrimaryUserTasks(${t}): done`),this.primaryUserContext}))}removeAllRenderingContexts(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new kC.G(kC.$.RENDERING_CONTEXT_DOES_NOT_EXIST));const t=this.userRenderingContextMap.keys(),n=Array.from(t).map((t=>()=>this.removeUserRenderingContext(e,t)));yield BX(n,this.defaultRenderingContext),this.primaryUserContext&&(yield this.coreTaskManager.destroyContext(this.primaryUserContext,e)),yield this.coreTaskManager.destroyContext(this.defaultRenderingContext,e)}))}getUserRenderingContext(e){return this.userRenderingContextMap.get(e)}getDefaultRenderingContext(){return this.defaultRenderingContext}getOrCreateUserRenderingContext(e){const t=(0,di.b4)(e);return this.defaultRenderingContext?(this.userRenderingContextMap.get(t)||this.userRenderingContextMap.set(t,this.createUserContextWithTelemetry(e,this.defaultRenderingContext)),this.userRenderingContextMap.get(t)):Promise.reject(new kC.G(kC.$.RENDERING_CONTEXT_DOES_NOT_EXIST,void 0,t))}removeUserRenderingContext(e,t){var n,a,o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this.userRenderingContextMap.get(t);if(i){let s;"unknown_destroy"===e&&(null===(a=(n=this.logger).errorToTelemetry)||void 0===a||a.call(n,"Removing user context due to unknown.","webclient_framework_foundation_core_services",void 0,!0)),this.userRenderingContextMap.delete(t);try{s=yield i}catch(e){let t;return t=e instanceof pe.G&&pe.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():e&&`${e.name}::${e.message}`,null===(r=(o=this.logger).errorToTelemetry)||void 0===r||r.call(o,`${kC.$.CLEANUP}::contextPromise::${t}`,"webclient_framework_foundation_core_services",void 0,!0),!1}return this.cleanupUserRenderingContext(s,"unknown_destroy"===e?"signout":e)}return this.logger.warn("RenderingContextManager::contextPromise is not defined"),!1}))}createUserContextWithTelemetry(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenarioFactory:i}=t,a=!!(null===(n=t.coreSettings.get(L.J.Core))||void 0===n?void 0:n.enableMTMA),o=i.findScenario(it.RG.GetAuthUser),[r,s]=UC(i);null==r||r.mark(it.ck.CoreUserContextStart);const l=Date.now(),c=(0,di.b4)(e);try{const t=yield this.createUserRenderingContext(e,a);return this.reportUserContextSuccess({getUserAuthScenario:o,expReadyScenario:s,clientStartScenario:r,scenarioStartTime:l,userContextId:c,isMTMAEnabled:a,scenarioFactory:t.scenarioFactory}),t}catch(e){const n=jC(e,c);throw this.reportUserContextFailure({getUserAuthScenario:o,expReadyScenario:s,scenarioStartTime:l,error:n,userContextId:c,isMTMAEnabled:a,scenarioFactory:t.scenarioFactory}),n}}))}reportUserContextSuccess({getUserAuthScenario:e,expReadyScenario:t,clientStartScenario:n,scenarioStartTime:i,userContextId:a,isMTMAEnabled:o,scenarioFactory:r}){var s;e&&e.stop(),null==t||t.mark(it.ck.GetAuthUser),null==n||n.mark(it.ck.CoreUserContextStop),UX(r,a,i,null===(s=this.defaultRenderingContext)||void 0===s?void 0:s.windowProvider.performance,o).stop(void 0,"success")}reportUserContextFailure({getUserAuthScenario:e,expReadyScenario:t,scenarioStartTime:n,error:i,userContextId:a,isMTMAEnabled:o,scenarioFactory:r}){var s,l;e&&e.fail(),null==t||t.mark(it.ck.GetAuthUser,void 0,"failure"),UX(r,a,n,null===(s=this.defaultRenderingContext)||void 0===s?void 0:s.windowProvider.performance,o).fail(Object.assign({message:`Failed to create user context for ${a}`},BC(i,null===(l=this.defaultRenderingContext)||void 0===l?void 0:l.coreSettings)))}cleanupActiveWindowsHistoryService(e,t){var n,a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;try{i=yield this.getUserRenderingContext(t)}catch(e){return}try{null===(n=null==i?void 0:i.activeWindowsHistoryService)||void 0===n||n.cleanup(e)}catch(e){const t=new kC.G(kC.$.CLEANUP,e);null===(o=(a=this.logger).errorToTelemetry)||void 0===o||o.call(a,t.toTelemetryEntry(),"webclient_framework_foundation_core_services_active_windows_history",void 0,!0)}}))}cleanupUserRenderingContext(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return yield this.coreTaskManager.destroyContext(e,t),!0}))}createUserRenderingContext(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=(0,di.b4)(e);this.logger.log(`createUserContext(${n}): start`);const a=t?he.sM.OnUserAuthenticated_MTMA:he.sM.OnUserAuthenticated,o=yield this.coreTaskManager.notifyLifeCycleEvent(a,Object.assign(Object.assign({},this.defaultRenderingContext),{authenticationUser:e}),((e,t)=>{var i,o;return(null===(i=this.defaultRenderingContext)||void 0===i?void 0:i.windowProvider.performance)&&function(e,t,n,i,a){const o=a?BC(a):void 0;n.mark(jX(i,t),{detail:{taskId:he.Yg[e],errorCode:null==o?void 0:o.errorCode}})}(e,n,null===(o=this.defaultRenderingContext)||void 0===o?void 0:o.windowProvider.performance,he.sM[a],t)})),{coreTaskErrors:r}=o,s=(0,i.__rest)(o,["coreTaskErrors"]),l=$X(r,this.defaultRenderingContext);if(l)throw l;return this.logger.log(`createUserContext(${n}): done`),s}))}}function UX(e,t,n,i,a=!1){const o=e.createScenarioWithoutStarting(it.RG.CoreUserContextCreate,{startTime:n}),r=a?he.sM.OnUserAuthenticated_MTMA:he.sM.OnUserAuthenticated;return i&&function(e,t,n,i){const a=i.timeOrigin,o=i.getEntriesByName(t,"mark")||[];for(const t of o){const i=t.detail.taskId,o=t.detail.errorCode;e.mark(`${n}_${i}`,{overrideTimestamp:Math.round(t.startTime+a),errorCode:o})}i.clearMarks(t)}(o,jX(r,t),`core_task_${r}`,i),o}function jX(e,t){return`${e}_core_task_end_${t||""}`}function $X(e,t){let n;return e&&(null==e?void 0:e.length)>0&&(n=(null==t?void 0:t.coreSettings.get(L.J.Core).strictErrorMode)?e[0]:e.find((e=>e instanceof kC.G||e instanceof zA.l||e instanceof ve&&(e.prevError instanceof kC.G||e.prevError instanceof zA.l)))),n}function BX(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(null===(n=null==t?void 0:t.coreSettings.get(L.J.Core))||void 0===n?void 0:n.readInSequence)for(const t of e)yield t();else yield Promise.all(e.map((e=>e())))}))}const WX="authenticated_user_subscription_failed",HX="create_user_context_failed",VX="init_core_service_failure",zX="show_taskbar_caution_indicator_failed",qX="user_data_undefined",GX="user_renderingContext_generation_error",JX=(e,t,n)=>{e.errorToTelemetry&&e.errorToTelemetry(t,n,void 0,!0)};class QX{constructor(e){var t,n,a,o,r,s;this._activeWindows=new xw.X([]),this._contextSubject=new Mw.t(1),this._isCleanupRunning=!1,this.AppStateToCleanupReasonMap=new Map([[Vn.quit,"quit"],[Vn.restart,"restart"]]),this.cleanupOnAppStateChangedCallback=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appState:t}=e;if(!QC.has(t))return;if(this._isCleanupRunning){const e=new kC.G(kC.$.CLEANUP,new Error(`cleanupOnAppStateChangedCallback run more than once ${t}`));return void(this._logger.warnToTelemetry&&this._logger.warnToTelemetry(e.toTelemetryEntry(),"webclient_framework_foundation_core_services",void 0,!0))}this._isCleanupRunning=!0;const n=this.AppStateToCleanupReasonMap.get(t);if(!n){const e=new kC.G(kC.$.CLEANUP,new Error(`cleanupOnAppStateChangedCallback has undefined reason from ${t}`));throw JX(this._logger,e.toTelemetryEntry(),"webclient_framework_foundation_core_services"),e}yield KC({hostCommunicationService:this.coreServices.hostCommunicationService,logger:this._logger,reason:n,renderingContextManager:this._renderingContextManager})})),this.trackAuthUsers=e=>{const t=this.isMTMACoreEnabled(e.coreSettings);return(0,Ow.z)((0,Lw.U)((e=>t?e:e.slice(0,1))),(0,Lw.U)((e=>e.map((e=>Object.assign(Object.assign({},e),{id:(0,di.b4)(e)}))))),eC((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.onUserAuthenticated(e)}))),(e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.onUserDestroy(yield e)}))),((e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return t}))),((e,n)=>{if(!t)throw n})))};const l=(0,Ue.J)(),c=(null==l?void 0:l.defaultConsoleLogLevel)||(null===(n=null===(t=null==l?void 0:l.loader)||void 0===t?void 0:t.getInitConsoleLogLevel)||void 0===n?void 0:n.call(t)),d=null===(o=null===(a=null==l?void 0:l.loader)||void 0===a?void 0:a.getProperties)||void 0===o?void 0:o.call(a),u=new Jw.w((null==d?void 0:d.sessionId)||"",e.config.experienceName,Ww.U.DiagnosticsLogsMain,null==c?void 0:c.preECSConsoleLogLevel,null==c?void 0:c.userConsoleLogLevel),m=new Qw.k(l);u.setLogsCountReporter(m);const g=new Kw.m(u,"00000000-0000-0000-0000-000000000000");this._config=e.config;const p=new fC(g,this._config,e.apps);this._logger=g.newLogger("Core","core-services-activator");const v=new OX(g);let h;d&&d.isMaglev&&d.preCoreHostCommService&&(h=d.preCoreHostCommService),this._preCoreLogsFileService=new PX.N(g,v,void 0,h),l.addEventListener("downloadLogs",(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){yield this._preCoreLogsFileService.downloadLogsFiles(l)})))),v.registerCoreLogsProvider(u);const f=null===(s=null===(r=null==l?void 0:l.loader)||void 0===r?void 0:r.getLogsProvider)||void 0===s?void 0:s.call(r);f&&v.registerCoreLogsProvider(f),d&&d.isMaglev&&d.preCoreHostCommService&&this.registerForLogsDownloadSignalFromDesktop(l,d.preCoreHostCommService);const y=e.config.useReactWebClientCoreTasks?{Initialization:()=>[new vR,new oQ,new uK,new tQ,new ZJ,new WJ,new Iq,new fR,new fx,new pK,new ZY,new vx,new CG,new DK,new Eq,new HG,new NK,new QY,new lG,new jG,new Uq,new bA,new iX,new AK,new Ix,new KJ,new dF,new aG,new Zq,new iF,new CK,new Aq,new rG,new cF,new FK,new wq,new pR,new dR,new ED,new gK,new ox,new TG,new OJ,new Uz,new bR,new yR,new Bq,new Sx,new Sq,new $q,new rx,new Yq,new kx,new RJ,new eX,new dX,new TK,new uF,new JJ,new WG,new sQ,new BG],OnPrimaryUser:()=>[new rX,new oX,new FQ,new aX,new HK,new IK,new nX],OnUserAuthenticated:()=>[new rX,new FQ,new QA,new kK,new sF,new xJ,new pF,new hX,new gX,new ND,new LK,new cK,new fK,new PN,new iQ,new cX,new mK,new WK,new rx,new WN,new XY,new Se,new vK,new uX,new vX],OnUserAuthenticated_MTMA:()=>[new rX,new DQ,new FQ,new xJ,new mX,new yx,new QA,new rG,new cF,new Uq,new sF,new pX,new hX,new mK,new WK,new pF,new cR,new Se,new lQ,new bR,new Sx,new $q,new rx,new kK,new ND,new LK,new cK,new fK,new PN,new iQ,new cX,new WN,new XY,new vK,new uX,new vX]}:{Initialization:()=>[new xX,new vR,new oQ,new uK,new tQ,new ZJ,new bX,new yX,new WJ,new Iq,new fR,new fx,new ZY,new vx,new CG,new Eq,new HG,new QY,new jG,new Uq,new bA,new fX,new KJ,new aG,new Zq,new dF,new iF,new CK,new Aq,new rG,new cF,new FK,new wq,new pR,new dR,new ED,new ox,new TG,new OJ,new Uz,new bR,new yR,new Bq,new Sq,new $q,new kx,new RJ,new Yq,new RX,new uF,new JJ,new WG],OnUserAuthenticated:()=>[new rX,new FQ,new aX,new HK,new mK,new WK,new kK,new xJ,new pF,new gX,new ND,new LK,new fK,new cX,new XY,new vX]};this._taskManagerService=new HC(g,p,e.config,e.loadConfigs,this.getDefaultCorrelation(),y,u,v,this.waitForRenderingContextReady.bind(this),this.isEntityInView.bind(this),e.criticalDynamicImports,e.getPlatformConfigurationOverrides),this._templateGenerator=e.generateChildWindowTemplate,this._trackWindowsOperator=aN,this._renderingContextManager=new LX(this._taskManagerService,g)}get activeWindows(){return this._activeWindows}init(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield this.initializeCoreServices();!function(e){const{coreSettings:t,logsCollectorService:n}=e,{testAutomation:i}=t.get(L.J.Test);if(i){const e=window;e.WeakRef&&(e.hooks||(e.hooks={}),e.hooks.__TEST_ONLY_LOGS_COLLECTOR_SERVICE_REF=new e.WeakRef(n))}}(n),this._config.supportsAsyncUserContext||(yield this.awaitUserContextIfAvailable()),this._preCoreLogsFileService.setBannerRelatedServices(n.entityCommanding,n.i18n),this.signalCoreInitSuccess(n);const i={logger:this._logger,renderingContextManager:this._renderingContextManager};null===(t=null===(e=n.authenticationService)||void 0===e?void 0:e.registerCleanUpOnLogoutCallback)||void 0===t||t.call(e,kt.D.Core,(e=>YC(Object.assign(Object.assign({},i),{coreSettings:n.coreSettings,reason:"signout",user:e&&(0,di.KQ)(e)})))),this.registerForAppStateChanged(n.hostCommunicationService)}catch(e){throw this.reportCoreInitError(e,this._coreServices),e}}))}get coreServices(){if(!this._coreServices)throw(0,An.Tr)("Entry",he.jK.NotPresent,"CoreServices not available");return this._coreServices}getDefaultCorrelation(){const e=FC({source:kt.D.ExternalCommand,externalId:this._config.externalCorrelationId});return e.id=`Core-${e.id}`,e}initializeCoreServices(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield this._renderingContextManager.createCoreServices(),{error:t}=e,n=(0,i.__rest)(e,["error"]);this._coreServices=n,this.initializeKPIs(n.scenarioFactory),t&&this.handleError(t);return this._coreServices.coreSettings.get(L.J.Core).chainObserveUsersAfter1stNavigationCompletes?this.setupNavigationHandling(n).then((()=>{this.observeAuthenticatedUsers(n)})):(this.setupNavigationHandling(n),this.observeAuthenticatedUsers(n)),n}))}signalCoreInitSuccess(e){var t,n,i,a,o,r,s;const[l,c]=UC(e.scenarioFactory);null==c||c.mark(it.ck.InitCoreServicesComplete),null==l||l.mark(it.ck.CoreInitStop),l&&(null===(i=null===(n=null===(t=(0,Ue.J)())||void 0===t?void 0:t.loader)||void 0===n?void 0:n.stopPieTimer)||void 0===i||i.call(n)),this._logger.log("hostComms::setCoreInitialized"),e.hostCommunicationService.loadModule("core").then((e=>{var t;null===(t=null==e?void 0:e.setCoreInitialized)||void 0===t||t.call(e)})),this.markCoreInitCompleteInAltScenario(e.altScenarioService);const d=Date.now();e.telemetryService.setCoreInitTime(d),e.logsCollectorService.setGetSummaryFunction($C(null===(a=this._coreServices)||void 0===a?void 0:a.platformService,null===(o=this._coreServices)||void 0===o?void 0:o.i18n,null===(r=this._coreServices)||void 0===r?void 0:r.authenticationService,null===(s=this._coreServices)||void 0===s?void 0:s.coreSettings))}handleError(e){if(!this.canDisplayCriticalErrorPage(this._coreServices))throw this.reportCoreInitError(e,this._coreServices),e;this.reportCoreInitError(e,this._coreServices,it.ck.CoreInitFailure),this._contextSubject.error(jC(e))}setupNavigationHandling(e){if(!this.canHandleNavigationIntents(e))throw(0,An.Tr)(he.w5.Core,he.jK.CoreNavigationServicesMissing,"Unable to process navigation intents");return e.coreSettings.get(L.J.Core).enableIframeTracking&&(this._trackWindowsOperator=FE),this.observeWindows(e).subscribe(this._activeWindows),((e,t)=>{const{windowProvider:n,loggerFactory:a,clientState:o,dataClientTrackingService:r,windowTrackerService:s,graphqlOpsCountService:l,leakDetectorService:c}=e,d=a.newLogger("Main-Window-Event-Listeners","core-services-activator");(0,UE.R)(n.opener,n_.rY.ShouldShowChatNotification).pipe((0,jE.M)(t,o.observe())).subscribe((([a])=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{if(!a||!a.payload||!a.payload.convId)throw new Error(`Invalid payload for shouldShowChatNotification with ${JSON.stringify(a)}`);let i=C.pyR.chats;a.payload.entityType?i=a.payload.entityType:d.log(`null entityType received: ${a.payload.entityType}`),d.log(`Received shouldShowNotification request for conv ${a.payload.convId} with entityType ${i}`);const o=yield OC({action:u.u.view,id:a.payload.convId,linkedEntity:null,type:i},e.client,d),r=!PC(o,t,e.clientState,d);$E(n,r,o),d.log(`Sending windowid: ${o} and shouldShowChatNotification: ${r} for conv ${a.payload.convId}`)}catch(e){d.error(`Failed to query window for entity with error ${e}`),$E(n,!0,void 0)}})))),null==s||s.init(),(0,UE.R)(n.opener,n_.rY.GetWindowEntityTypeStats).subscribe((()=>{n.opener.postMessage(n_.rY.GetWindowEntityTypeStats,{windowEntityTypeStats:null==s?void 0:s.getTelemetry()})})),(0,UE.R)(n.opener,n_.rY.GetApolloCacheStats).subscribe((()=>{n.opener.postMessage(n_.rY.GetApolloCacheStats,{apolloCacheStats:null==r?void 0:r.getTelemetry()})})),l&&(0,UE.R)(n.opener,n_.rY.GetCdlStats).subscribe((()=>{n.opener.postMessage(n_.rY.GetCdlStats,{cdlStats:null==l?void 0:l.getLatestDataAndClear()})}));(0,UE.R)(n.opener,n_.rY.GetHeartbeat).subscribe((()=>{let t="";e.appResponsivenessService&&(t=e.appResponsivenessService.getTelemetry()),n.opener.postMessage(n_.rY.GetHeartbeat,{windowEntityTypeStats:null==s?void 0:s.getTelemetry(),apolloCacheStats:null==r?void 0:r.getTelemetry(),ariTelemetry:t,OLDStats:null==c?void 0:c.getTelemetry()})}))})(e,this.activeWindows),e.deeplinkService.init()}awaitUserContextIfAvailable(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield this._contextSubject.pipe((0,Uw.P)()).toPromise()}))}initializeKPIs(e){var t,n,i;if(e){const a=e.findScenario(it.RG.ClientStart),o=null===(i=null===(n=null===(t=(0,Ue.J)())||void 0===t?void 0:t.loader)||void 0===n?void 0:n.getProperties)||void 0===i?void 0:i.call(n);(null==o?void 0:o.deeplinkId)&&(null==a||a.appendEventData({deeplinkId:o.deeplinkId})),(null==o?void 0:o.RelaunchReason)&&(null==a||a.appendEventData({RelaunchReason:o.RelaunchReason})),null==a||a.mark(it.ck.CoreInitStart)}const a=null==e?void 0:e.findScenario(it.RG.ExperienceReady);null==a||a.mark(it.ck.InitCoreServices),null==a||a.startStep(it.ck.GetAuthUser)}reportCoreInitError(e,t={},n){var a,o,r,s,l,c,d,u,m,g,p,v;const h=e instanceof pe.G?(e=>e.prevError||(0,An.Tr)(he.w5.Core,he.jK.NotInitialized,e.code,void 0,e.message))(e):e,f=h.context===he.w5.Core?h:(0,An.Tr)(he.w5.Core,h.code||he.jK.NotInitialized,h.context,{innerError:h}),y=f.subContext||"UnknownCoreInitFailure",b=(0,la.A)((0,An.B9)(f));this._logger.warn(`Initializing Core failed. Message: ${b}, subContext: ${y}`);const[S,k]=UC(t.scenarioFactory),w={errorCode:e instanceof pe.G&&pe.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():null!==(a=f.code)&&void 0!==a?a:he.jK.CoreInitFailure,reason:he.jK.CoreInitFailure},C=null===(o=(0,Ue.J)())||void 0===o?void 0:o.loader;n?(null==S||S.mark(n,w),null===(s=null===(r=null==t?void 0:t.altScenarioService)||void 0===r?void 0:r.altScenario)||void 0===s||s.mark(n,w)):(null==S||S.fail(w),null===(c=null===(l=null==t?void 0:t.altScenarioService)||void 0===l?void 0:l.altScenario)||void 0===c||c.fail(w)),S&&(null===(d=null==C?void 0:C.stopPieTimer)||void 0===d||d.call(C)),null===(m=null===(u=this._coreServices)||void 0===u?void 0:u.diagnosticsService)||void 0===m||m.persistDiagnosticsAsPreviousSessionLogs(),null==C||C.persistLoaderLogsAsPreviousSession(),null==k||k.fail({contentType:(0,la.A)(`${f.context}-${f.subContext}`),errorCode:(0,An.qZ)(f),errors:b,reason:VX}),null===(g=null==t?void 0:t.windowProvider)||void 0===g||g.opener.postMessage(Hw.W.CoreInitializationFailed,{errorDescription:y}),(null===(v=null===(p=null==t?void 0:t.coreSettings)||void 0===p?void 0:p.get(L.J.Core))||void 0===v?void 0:v.enableTaskbarIconOnCoreInitFailure)&&function(e,t){var n;(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield null==e?void 0:e.loadModule("taskbar");null===(n=null==t?void 0:t.showBadge)||void 0===n||n.call(t,{icon:{glyphBadge:{glyph:Gw.attention}}})}catch(e){JX(t,`${zX}: ${e}`,"webclient_framework_foundation_core_services")}}))}(null==t?void 0:t.hostCommunicationService,this._logger)}markCoreInitCompleteInAltScenario(e){var t,n;null===(t=null===performance||void 0===performance?void 0:performance.mark)||void 0===t||t.call(performance,qw),null===(n=null==e?void 0:e.altScenario)||void 0===n||n.mark(it.ck.PostCoreInitializationTasks)}waitForRenderingContextReady(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.isGettingContextByIdEnabled(null===(n=this._coreServices)||void 0===n?void 0:n.coreSettings)?this.getOrCreateRenderingContextForId(t):this._contextSubject.pipe((0,jw.h)((t=>{var n;return!e||!!(null===(n=t.authenticationUser)||void 0===n?void 0:n.isAuthenticated)})),(0,Uw.P)()).toPromise()}))}getExistingContextForId(e){if(!e){const e=this._renderingContextManager.getDefaultRenderingContext();return e&&Promise.resolve(e)||Promise.reject(new kC.G(kC.$.RENDERING_CONTEXT_DOES_NOT_EXIST))}return this._renderingContextManager.getUserRenderingContext(e)}getContextObservable(e){var t,n;return!this.isGettingContextByIdEnabled(null===(t=this._coreServices)||void 0===t?void 0:t.coreSettings)||this._contextSubject.hasError?this._contextSubject:(0,Pw.D)(null!==(n=this.getExistingContextForId(e))&&void 0!==n?n:Promise.reject(new kC.G(kC.$.RENDERING_CONTEXT_DOES_NOT_EXIST)))}getOrCreateRenderingContextForId(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getExistingContextForId(e);if(n)return n;const a=null===(t=this.coreServices)||void 0===t?void 0:t.authenticationService;if(!a)return Promise.reject(new kC.G(kC.$.CORE_SERVICES_MISSING,void 0,e));const o=yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!t)throw new kC.G(kC.$.USERCONTEXTID_EMPTY,void 0,t);const i=yield n.getUser({correlation:e,accountId:t});if(!i)throw new kC.G(kC.$.USER_DOES_NOT_EXIST,void 0,t);if(!i.isAuthenticated)throw new kC.G(kC.$.USER_NOT_AUTHENTICATED,void 0,t);return(0,di.KQ)(i)}))}(Object.assign(Object.assign({},FC({source:kt.D.Core})),{scenarioName:it.RG.AuthWebCachedUser}),e,a);return yield this.tryExecutePrimaryUserTasks(),this._renderingContextManager.getOrCreateUserRenderingContext(o)}))}isMTMACoreEnabled(e){var t;return!!(null===(t=null==e?void 0:e.get(L.J.Core))||void 0===t?void 0:t.enableMTMA)&&!!this.isGettingContextByIdEnabled(e)}isGettingContextByIdEnabled(e){var t;return!!(null===(t=null==e?void 0:e.get(L.J.Auth))||void 0===t?void 0:t.enableIntegratedAuthApp)&&!!this._config.supportsAsyncUserContext}tryExecutePrimaryUserTasks(){var e,t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this._taskManagerService.hasTasks(he.sM.OnPrimaryUser))return;if(null===(e=this._coreServices)||void 0===e?void 0:e.primaryUser)return;if(this._primaryUserTasksPromise)return this._primaryUserTasksPromise;const i=null===(t=this._coreServices)||void 0===t?void 0:t.authenticationService,o=yield null===(n=null==i?void 0:i.getCachedUsers)||void 0===n?void 0:n.call(i,Object.assign(Object.assign({},FC({source:kt.D.Core})),{scenarioName:it.RG.AuthWebCachedUser}),{isPrimaryUser:!0,isAuthenticated:!0}),r=null===(a=null==o?void 0:o.filter((e=>!0===e.isAuthenticated)))||void 0===a?void 0:a[0];return r&&!this._primaryUserTasksPromise&&(this._primaryUserTasksPromise=this._renderingContextManager.executePrimaryUserTasks((0,di.KQ)(r)).then((e=>{this._coreServices=e}))),this._primaryUserTasksPromise}))}observeAuthenticatedUsers(e){this.observeUsers(e,this._logger).pipe(this.trackAuthUsers(e),(0,$w.K)((t=>{var n,i,a;const o=t instanceof pe.G&&pe.G.isFunction(t.toTelemetryEntry)?t:new kC.G(null==t?void 0:t.code,t||new Error("Unknown error"));null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,`Core Initialization: ${GX}`,"webclient_framework_foundation_core_services",{errorCode:o.toTelemetryEntry(),message:null==t?void 0:t.message},!0);const r=(0,An.Tr)("Core",he.jK.NotInitialized,null===(a=o.prevError)||void 0===a?void 0:a.context,{innerError:o.prevError});throw e.errorState.error=r,e.coreSettings.get(L.J.Core).enableCoreErrorsV2?o:r})),(0,Bw.b)((()=>{const[t,n]=UC(e.scenarioFactory);null==t||t.mark(it.ck.CoreRenderingContextReady)})),(0,Lw.U)((e=>e.length>0?e[0]:this._renderingContextManager.getDefaultRenderingContext()))).subscribe(this._contextSubject)}canDisplayCriticalErrorPage(e){return!!((null==e?void 0:e.rebootService)&&e.i18n&&e.scenarioFactory&&e.coreSettings&&e.hostCommunicationService&&e.coreSettings.get(L.J.Core).enableCoreErrorsV2)}canHandleNavigationIntents(e){return!!((null==e?void 0:e.client)&&e.deeplinkService&&e.entityCommanding)}registerForAppStateChanged(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let n;try{n=yield e.loadModule("core")}catch(e){const t=`HostComms:: ${YN.LoadModuleCoreFailed} registerForAppStateChanged`;return void JX(this._logger,t,"webclient_framework_host_comms")}try{null===(t=null==n?void 0:n.registerForAppStateChanged)||void 0===t||t.call(n,this.cleanupOnAppStateChangedCallback)}catch(e){const t=`HostComms:: ${YN.RegisterForAppStateChangedFailed}`;return void JX(this._logger,t,"webclient_framework_host_comms")}}))}observeWindows(e){return(0,aC.G)(e.client.watchQuery({query:zC})).pipe((0,jw.h)((({errors:e,loading:t})=>void 0===e&&!t)),(0,Lw.U)((({data:{activeWindows:e}})=>e.map((t=>Object.assign(Object.assign({},t),{screenState:{numOpenWindows:e.length}}))))),this._trackWindowsOperator(this.getContextObservable.bind(this),e,this._templateGenerator))}observeUsers(e,t){const n=this.observeUsersEvents(e.client);return(0,aC.G)(n).pipe((0,Lw.U)((e=>this.toUserContexts(e,t))),(0,$w.K)((e=>{var t,n;const i=`Core Initialization: ${WX}`;throw null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,i,"webclient_framework_foundation_core_services",{errorCode:e.code,context:e.context,message:e.message,errors:`${null==e?void 0:e.reason}-${(0,wi.u4)(null==e?void 0:e.serverResponse)}`},!0),jC(e)})))}observeUsersEvents(e){const t={filter:{isAuthenticated:!0}},n=e.watchQuery({query:GC,variables:t});return n.subscribeToMore({document:qC,variables:t,updateQuery:(e,t)=>t.subscriptionData.data.authenticationUsersEvent}),n}onUserAuthenticated(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return yield this.tryExecutePrimaryUserTasks(),this._renderingContextManager.getOrCreateUserRenderingContext(e)}))}onUserDestroy(e){const t={logger:this._logger,renderingContextManager:this._renderingContextManager},n=e.authenticationUser;n&&YC(Object.assign(Object.assign({},t),{coreSettings:e.coreSettings,reason:"unknown_destroy",user:n}))}toUserContexts({data:e,loading:t,errors:n},i){var a;if(n)throw JX(i,HX,"webclient_framework_foundation_core_services"),(0,Yw.E6)({graphQLErrors:n.concat(),extraInfo:void 0,networkError:null,name:"AuthenticationUsers subscription error",message:"Error in authentication users subscription"});if(!t){if(!e)return JX(i,qX,"webclient_framework_foundation_core_services"),[];return(null!==(a=e.authenticationUsers)&&void 0!==a?a:[]).filter((e=>!0===e.isAuthenticated)).map(this.toUserContext)}return[]}toUserContext(e){const{id:t,isAuthenticated:n,cloud:i,profile:{tenantId:a,objectId:o,puid:r},role:s,type:l,subType:c,loginUserName:d,homeAccountId:u}=e;return{id:t,isAuthenticated:n,profile:{tenantId:a,objectId:o,puid:r},cloud:i,role:s,type:l,subType:c,loginUserName:d,homeAccountId:u||void 0}}isEntityInView(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this._coreServices)return Promise.resolve(!1);const{clientState:n}=this._coreServices;return function(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return PC(yield OC(e,t,o),a,n,o)}))}(e,t,n,this._activeWindows,this._logger)}))}registerForLogsDownloadSignalFromDesktop(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield t.loadModule("logscollection");i&&(null===(n=null==i?void 0:i.registerForRequestWebLogsDownload)||void 0===n||n.call(i,(t=>{const n=!t.webLogsId;this._preCoreLogsFileService.downloadLogsFiles(e,n,t.webLogsId)})))}))}}var KX=n(83392);const YX={auth:{enableRedirectToSignIn:[{viewportContext:["iFrame"],value:!1}],enableAuthenticateOrGetUser:[{viewportContext:["iFrame"],value:!1}],enableLoginFlow:[{viewportContext:["primary"],value:!0}],skipAmsAuthRequest:[{viewportContext:["primary"],value:!1}]},calendar:{disableCalendarOptimisticClosingForm:[{viewportContext:["secondary"],value:!0}],enableCalendarBIMSpecificOperations:[{viewportContext:["iFrame","primary"],value:!0}],enableCalendarBlockingDiscardConfirmationDialog:[{viewportContext:["flyout","primary","secondary"],value:!1}],enableExtensionTabsInSchedulingForm:[{viewportContext:["secondary"],value:!1}]},calling:{isCallingScreenInteractive:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomfrontofroom","meetingroomfrontofroomcontent","meetingroomfrontofroomgallery"],value:!1}],isCallingAlertDismissEnabled:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!1}],enableExternalCallMonitor:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall","meetingroomallinonecall","meetingroomallinone"],value:!1}],allowMultipleCallingAlertBanners:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!1}],allowPinningParticipantFromOutside:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],allowGalleryToggleFromOutside:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],isCallingAlertActionEnabled:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!1}],isContentSharingShownOnCallingScreen:[{entityType:["callsgallery"],value:!1}],isContentOnlyCallingScreen:[{entityType:["callscontent","stagecontent"],value:!0}],isLayoutSwitcherSupported:[{entityType:["callsgalleryandcontent"],value:!0}],showAllCallingAlertsAsBanner:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!0}],isContentCameraSharingSupported:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomallinonecall","meetingroomallinone"],value:!0}],isIncomingCallScreenSupported:[{entityType:["callsgallery","callsgalleryandcontent","meetingroomallinonecall","meetingroomallinone"],value:!0}],enableCallCloseHook:[{entityType:["stagecontent"],value:!1}],enableMeetingReactions:[{entityType:["stagecontent"],value:!1}],enableHideMyselfV2:[{entityType:["callsmonitor"],value:!1}],closeCallingWindowOnError:[{entityType:["callsgalleryandcontent","callsgallery","callscontent"],value:!0}],isParticipantRosterDialogSupported:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomCallingDialog:[{entityType:["callsgalleryandcontent","callsgallery","meetingroomallinonecall","meetingroomallinone"],value:!0}],isMeetingRoomFrontOfRoomCallPanels:[{entityType:["callsgalleryandcontent","callsgallery","meetingroomallinonecall","meetingroomallinone"],value:!0}],isMeetingRoomCallHeader:[{entityType:["callsgalleryandcontent","callsgallery","meetingroomallinonecall","meetingroomallinone"],value:!0}],isMeetingRoomSplitGallery:[{entityType:["callscontent","callsgallery"],value:!0}],isMeetingRoomMainContextItemsManager:[{entityType:["callsgallery"],value:!0}],isMeetingRoomSingleFoRMeetingContextItemsManager:[{entityType:["callsgalleryandcontent","meetingroomallinonecall","meetingroomallinone"],value:!0}],isMeetingRoomHeroContextItemsManager:[{entityType:["callscontent"],value:!0}],shouldRenderMyselfVideoAtBottom:[{entityType:["callsgalleryandcontent","callsgallery","meetingroomallinonecall","meetingroomallinone"],value:!0}],shouldMeetingRoomOverrideCQFSampling:[{entityType:["meetingroomconsolecall","meetingroomallinone"],value:!0}],shouldResetCQFTimeoutOnTokenChange:[{entityType:["meetingroomconsolecall","meetingroomallinone"],value:!0}],shouldCQFScreenFillScreen:[{entityType:["meetingroomconsolecall","meetingroomallinone"],value:!0}],isMeetingRoomCallingRoster:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomFoRUfd:[{entityType:["callsgalleryandcontent","callsgallery","meetingroomallinonecall","meetingroomallinone"],value:!0}],isMeetingRoomConsoleUfd:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomLanguageSelectionDialog:[{entityType:["meetingroomconsolecall","meetingroomallinonecall","meetingroomallinone"],value:!0}],isMeetingRoomConsoleUbar:[{entityType:["meetingroomconsolecall","meetingroomallinonecall","meetingroomallinone"],value:!0}],isMeetingRoomConsoleCalling:[{entityType:["meetingroomconsolecall","meetingroomallinonecall","meetingroomallinone"],value:!0}],shouldUseMultiWindowCallSidePanelControl:[{entityType:["meetingroomconsolecall","callscontent","callsgallery","callsgalleryandcontent"],value:!0}],isMeetingRoomConsoleHome:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomConsoleCalendar:[{entityType:["meetingroomconsolecall","meetingroomallinone"],value:!0}],isMeetingRoomFoRCalendar:[{entityType:["meetingroomfrontofroom","meetingroomfrontofroomcontent","meetingroomfrontofroomgallery"],value:!0}],isMeetingRoomCallingAlerts:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomJoinByCode:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomNewCallScreen:[{entityType:["meetingroomconsolecall"],value:!0}],isNonInteractiveMeetingChat:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!0}],isMeetingRoomFrontRowRoster:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomallinonecall","meetingroomallinone"],value:!0}],isTouchOnlySmallDisplay:[{entityType:["meetingroomconsolecall","meetingroomallinone","meetingroomallinonecall"],value:!0}],allowMultiWindowPinningParticipant:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!0}],isPtzCameraControlStateSupported:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],shouldShowCallingEndScreen:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomallinonecall","meetingroomallinone"],value:!1}],shouldUbarSubscribeToParticipantChanges:[{entityType:["meetingroomconsolecall"],value:!0}],enableUbarNonCriticalPhaseDelayedLoad:[{entityType:["meetingroomallinone","meetingroomallinonecall","meetingroomconsolecall","presentertoolbar"],value:!1}],disableCoachmarksInUbar:[{entityType:["meetingroomconsolecall","callsmonitor"],value:!0}],enableEspCoachmarksInUbar:[{entityType:["meetingroomconsolecall","callsmonitor"],value:!1}]},core:{isHeaderDisabled:[{viewportContext:["iFrame"],value:!0}],isPrimaryWindow:[{viewportContext:["iFrame","primary"],value:!0}],isBorderDisabled:[{viewportContext:["iFrame"],value:!0}],enableUnmeasuredSlotDetectionOnThisWindow:[{viewportContext:["iFrame"],value:!0}],disablePopupDragAbility:[{viewportContext:["secondary"],platform:["desktopWindows"],value:!0}],disallowAppRegionOverrides:[{viewportContext:["iFrame"],platform:["desktopWindows","desktopMac","desktopLinux"],value:!0}],isNotificationBannerDisabled:[{viewportContext:["iFrame"],value:!0}],enableWaitForRouteOnSlotTransition:[{viewportContext:["iFrame"],value:!0}],enableLonglivedSubscriptionForChannelsAppViewportSetting:[{viewportContext:["primary","iFrame"],value:!0}],shouldSetBodyTransparent:[{viewportContext:["iFrame"],value:!0}],enableBIMSlots:[{viewportContext:["iFrame"],value:!0}],enableModalForIframe:[{viewportContext:["iFrame"],value:!0}],disableTitleBarForIframe:[{viewportContext:["iFrame"],value:!0}]},people:{isInIframe:[{viewportContext:["iFrame"],value:!0}]},search:{enableChannelsInUnifiedSearch:[{entityType:["email"],value:!0}],enablePeopleSearchV2:[{entityType:["email"],value:!0}],enableChatSearchByPartialMembers:[{entityType:["email"],value:!0}],enableRemoveChatDisabledUsers:[{entityType:["email"],value:!0}],enableLoadingSpinnerAtTop:[{entityType:["email"],value:!0}],resultLimitPerSuggestionType:[{entityType:["email"],value:12}],enableEagerSeedSuggestions:[{entityType:["email"],value:!0}],showTopEagerSeedSuggestions:[{entityType:["email"],value:!0}]},channels:{enableOnlyInMainWindowNotPopouts:[{viewportContext:["iFrame","primary"],value:!0}],showCloseButtonInChannelsRepliesPane:[{viewportContext:["iFrame","primary"],value:!0}],allowPostPopout:[{viewportContext:["iFrame","primary"],value:!0}],enableTabsInChannels:[{viewportContext:["secondary"],value:!1}]},extensibility:{enableAtGetBots:[{entityType:["email"],value:!1}],launchAngularDialog:[{viewportContext:["iFrame"],value:!0}]},files:{showPreferenceDialog:[{viewportContext:["iFrame"],value:!0}],setMessageListenersOnHostForSuperPicker:[{viewportContext:["iFrame"],value:!0}],enablePopups:[{viewportContext:["iFrame"],value:!0}],loadItemsViewStringsFromHost:[{viewportContext:["iFrame"],value:!0}],setMessageListenersOnHostForOneUp:[{viewportContext:["iFrame"],value:!0}]},meetingRecap:{isRecapInPopout:[{viewportContext:["secondary"],value:!0}]},messaging:{fluidIsRenderingInPopout:[{viewportContext:["secondary"],value:!0}],isHeaderDisabled:[{viewportContext:["iFrame"],value:!0}],enableChatHeaderPopoutButton:[{viewportContext:["iFrame"],value:!0}],enableChatHeaderMeetingDetailsButton:[{viewportContext:["iFrame"],value:!0}],enableInlineVideoMessageDownload:[{viewportContext:["flyout"],value:!1}],disableInlineVideoMessageFullscreen:[{viewportContext:["flyout"],value:!0}],inlineVideoIsRenderingInPopout:[{viewportContext:["secondary"],value:!0}],recorderIsRenderingInPopout:[{viewportContext:["secondary"],value:!0}],notifyMessageListRender:[{viewportContext:["iFrame"],value:!0}],showSingeMessageView:[{viewportContext:["iFrame"],value:!0}],showContextualSearchPrompt:[{viewportContext:["iFrame"],value:!0}],setFocusOnImmersiveReaderClose:[{viewportContext:["iFrame"],value:!1}],enableComposeCriticalPhaseLoadSecondaryViewport:[{viewportContext:["secondary"],value:!0}],enableComposeDebouncedDraftSyncSecondaryViewport:[{viewportContext:["secondary"],value:!0}],enableDraftImageWithServiceWorker:[{viewportContext:["secondary"],value:!1}],entityCommandingTransitionForceFlush:[{viewportContext:["iFrame"],value:!0}],enableLogUnsupportedContent:[{viewportContext:["iFrame"],value:!0}],sendDiscardConversationHideCommand:[{viewportContext:["iFrame"],value:!1}],enableSaveNewChatDraftOnMainWindow:[{viewportContext:["iFrame"],value:!0}],enableDisableAutoScrollForHighActivityMeetings:[{viewportContext:["iFrame","primary"],value:!1}],lightboxTitleInChatMultiWindow:[{viewportContext:["secondary"],value:!1}]},chat:{enableWaitChatNetworkFetch:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!0}],disableChatPaneLoader:[{viewportContext:["iFrame"],value:!0}]},csaService:{enableV3ChatsAPI:[{entityType:["email","messages"],value:!0}]},shortcuts:{shortcutsForIframe:[{viewportContext:["iFrame"],value:!0}],shortcutsForPopout:[{viewportContext:["secondary"],value:!0}]},broadcast:{isRenderingInEmbedMode:[{viewportContext:["iFrame"],value:!0},{viewportContext:["primary"],value:!1}]},cortana:{isCortanaEnabled:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}]},ufd:{maxUnstackedPermanentDialogs:[{entityType:["meetingroomconsolecall"],value:4}],overrideUfdSyncSeverities:[{entityType:["meetingroomconsolecall"],value:["Critical"]}]}},XX={},ZX={},eZ={mappings:{calendar:{isOnCloud:{name:"userPropertiesSettings.isOnCloud"},autodiscoverSettings:{name:"userPropertiesSettings.autodiscoverSettings"},allowPrivateMeetingSchedulingPolicy:{name:"meetingPolicy.allowPrivateMeetingScheduling"},allowChannelMeetingSchedulingPolicy:{name:"meetingPolicy.allowChannelMeetingScheduling"},allowEngagementReportPolicy:{name:"meetingPolicy.allowEngagementReport"},enableCoachByPolicy:{name:"meetingPolicy.allowMeetingCoach"},allowFluidCollaboratePolicy:{name:"messagingPolicy.allowFluidCollaborate"},allowMeetingRegistrationPolicy:{name:"meetingPolicy.allowMeetingRegistration"},allowBroadcastSchedulingPolicy:{name:"broadcastMeetingPolicy.allowBroadcastScheduling"},whoCanRegisterPolicy:{name:"meetingPolicy.whoCanRegister"},allowWebinarsV2Policy:{name:"teamsEventsPolicy.allowWebinars"},enableSmbAlternateAttendeesPlaceholder:{name:"externalAccessPolicy.enableFederationAccess"}},calling:{allowPrivateCallingPolicy:{name:"callingPolicy.allowPrivateCalling"},myPhoneNumber:{name:"voiceAdminSettings.phoneNumber"},voiceAdminSettings:{name:"voiceAdminSettings"},delegationSettingsPolicy:{name:"voiceAdminSettings.delegationSettings"},dialPlanPolicy:{name:"policySettings.dialPlanPolicy"},safeTransferPolicy:{name:"callingPolicy.safeTransferEnabled"},allowCloudRecordingPolicy:{name:"meetingPolicy.allowCloudRecording"},allowRecordingStorageOutsideRegion:{name:"meetingPolicy.allowRecordingStorageOutsideRegion"},recordingStorageMode:{name:"meetingPolicy.recordingStorageMode"},allowCloudRecordingForCallsPolicy:{name:"callingPolicy.allowCloudRecordingForCalls"},closedCaptionsPolicy:{name:"meetingPolicy.liveCaptionsEnabledType"},closedCaptionsForCallingPolicy:{name:"callingPolicy.liveCaptionsEnabledTypeForCalling"},isFluidWhiteboardAllowedByPolicy:{name:"meetingPolicy.allowFluidWhiteboard"},isPptSharingAllowedByPolicy:{name:"meetingPolicy.allowPowerPointSharing"},areMeetingNotesEnabledByPolicy:{name:"meetingPolicy.allowSharedNotes"},isMeetingReactionsAllowedByPolicy:{name:"meetingPolicy.allowMeetingReactions"},customVideoBackgroundsFilterByPolicy:{name:"meetingPolicy.videoFiltersMode"},screenSharingModePolicy:{name:"meetingPolicy.screenSharingMode"},meetingChatEnableTypePolicy:{name:"meetingPolicy.meetingChatEnableType"},allowPrivateMeetingSchedulingPolicy:{name:"meetingPolicy.allowPrivateMeetingScheduling"},allowMeetNowPolicy:{name:"meetingPolicy.allowMeetNow"},isVideoAllowedByPolicy:{name:"meetingPolicy.allowIPVideo"},enableCallTranscriptByPolicy:{name:"meetingPolicy.allowTranscription"},enableCallTranscriptInCallsByPolicy:{name:"callingPolicy.allowTranscriptionForCalling"},teamsVoiceApplicationsPolicy:{name:"teamsVoiceApplicationsPolicy"},enableCoachByPolicy:{name:"meetingPolicy.allowMeetingCoach"},allowSIPDialing:{name:"teamsRoomVideoTeleConferencingPolicy.enabled"},configuredSIPBotId:{name:"teamsRoomVideoTeleConferencingPolicy.areaCode"},enableMeetingRoomGiveFeedback:{name:"feedbackPolicy.userInitiatedMode"},allowFluidMeetingCalendarPolicy:{name:"callingPolicy.allowFluidMeetingCalendar"},allowDocumentCollaborationPolicy:{name:"meetingPolicy.allowDocumentCollaboration"},allowPrivateMeetNowPolicy:{name:"meetingPolicy.allowPrivateMeetNow"}},tenant:{isOrganizationTabEnabled:{name:"clientSettings.allowOrganizationTab",defaultValue:!0},tenantSiteUrl:{name:"tenantSiteUrl"}},coach:{enableCoachByPolicy:{name:"meetingPolicy.allowMeetingCoach"}},esp:{enableSmbExternalMeetingCoachmarkExp1:{name:"externalAccessPolicy.enableFederationAccess"},enableSmbExternalMeetingCoachmarkExp2:{name:"externalAccessPolicy.enableFederationAccess"}},extensibility:{isSideLoadingInteractionEnabled:{name:"tenantSettingsV2.apps.isSideLoadingInteractionEnabled"},storeAppTenantBackground:{name:"tenantSettingsV2.apps.lobBackground"},storeAppTenantLogo:{name:"tenantSettingsV2.apps.lobLogo"},storeAppTenantTextColor:{name:"tenantSettingsV2.apps.lobTextColor"},storeAppTenantIcon:{name:"tenantSettingsV2.apps.lobLogomark"}},files:{nativeFileEntryPoints:{name:"filesPolicy.nativeFileEntryPoints",defaultValue:"Enabled"},enableFederationAccess:{name:"externalAccessPolicy.enableFederationAccess",defaultValue:!0}},guardians:{parentGuardianPreferredContactMethod:{name:"educationSettings.parentGuardianPreferredContactMethod"}},meetingArtifacts:{allowEngagementReportPolicy:{name:"meetingPolicy.allowEngagementReport"},allowTrackingInReportPolicy:{name:"meetingPolicy.allowTrackingInReport"}},messaging:{receiptsEnabledType:{name:"messagingPolicy.readReceiptsEnabledType",defaultValue:"UserPreference"},allowPasteInternetImage:{name:"messagingPolicy.allowPasteInternetImage",defaultValue:!0},EnableUpToEditInMW:{name:"messagingPolicy.allowUserEditMessage",defaultValue:!0},allowUserEditMessage:{name:"messagingPolicy.allowUserEditMessage",defaultValue:!0},allowGiphy:{name:"messagingPolicy.allowGiphy",defaultValue:!0},allowGiphyDisplay:{name:"messagingPolicy.allowGiphyDisplay",defaultValue:!0},allowStickers:{name:"messagingPolicy.allowStickers",defaultValue:!0},giphyRatingType:{name:"messagingPolicy.giphyRatingType",defaultValue:"Moderate"},allowPriorityMessages:{name:"messagingPolicy.allowPriorityMessages",defaultValue:!0},allowImmersiveReader:{name:"messagingPolicy.allowImmersiveReader",defaultValue:!0},allowUserChat:{name:"messagingPolicy.allowUserChat",defaultValue:!0},allowRemoveUser:{name:"messagingPolicy.allowRemoveUser",defaultValue:!0},areUrlPreviewsAllowed:{name:"messagingPolicy.allowUrlPreviews",defaultValue:!0},allowUserDeleteMessage:{name:"messagingPolicy.allowUserDeleteMessage",defaultValue:!0},enableSms:{name:"voiceAdminSettings.isSmsEnabled"},messagingPolicy:{name:"messagingPolicy"},allowFluidCollaborate:{name:"messagingPolicy.allowFluidCollaborate",defaultValue:!1},enableVideoMessaging:{name:"messagingPolicy.allowVideoMessages",defaultValue:!1},enableInlineVideoMessageClosedCaptions:{name:"teamsMessagingConfiguration.enableVideoMessageCaptions",defaultValue:!0},allowPrivateMeetingSchedulingPolicy:{name:"meetingPolicy.allowPrivateMeetingScheduling"},isMailboxDiscoverable:{name:"userPropertiesSettings.isMailboxDiscoverable"},isOnCloud:{name:"userPropertiesSettings.isOnCloud"},autodiscoverSettings:{name:"userPropertiesSettings.autodiscoverSettings"},allowCommunicationComplianceEndUserReporting:{name:"messagingPolicy.allowCommunicationComplianceEndUserReporting",defaultValue:!1},allowSmartReply:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},useQuickRepliesSchema:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},enableSmartRepliesForGroupChat:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},enableAnimatedEmojisInSmartReplies:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},enableSmartFilesSuggestions:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},enableSmartSchedulingSuggestions:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},allowMemes:{name:"messagingPolicy.allowMemes",defaultValue:!0},allowUserTranslation:{name:"messagingPolicy.allowUserTranslation",defaultValue:!1},chatPermissionRole:{name:"messagingPolicy.chatPermissionRole",defaultValue:"Restricted"},allowFullChatPermissionUserToDeleteAnyMessage:{name:"messagingPolicy.allowFullChatPermissionUserToDeleteAnyMessage",defaultValue:!1},allowOwnerDeleteMessage:{name:"messagingPolicy.allowOwnerDeleteMessage",defaultValue:!0},userInitiatedMode:{name:"feedbackPolicy.userInitiatedMode"},enableM365ChatFeedback:{name:"feedbackPolicy.OCPSAllowSendFeedback"},enableM365ChatFeedbackLogCollection:{name:"feedbackPolicy.OCPSAllowLogCollection"},restrictTeamsConsumerAccessToExternalUserProfiles:{name:"externalAccessPolicy.restrictTeamsConsumerAccessToExternalUserProfiles",defaultValue:!1},enableTeamsConsumerAccess:{name:"externalAccessPolicy.enableTeamsConsumerAccess",defaultValue:!0},allowSecurityEndUserReporting:{name:"messagingPolicy.allowSecurityEndUserReporting",defaultValue:!1}},peopleTargeting:{tagPermissions:{name:"targetingPolicy.manageTagsPermissionMode"},ownersCanOverwriteTagSettings:{name:"targetingPolicy.teamOwnersEditWhoCanManageTagsMode"},suggestedTags:{name:"targetingPolicy.suggestedPresetTags"},customTagMode:{name:"targetingPolicy.customTagsMode"},disallowedSources:{name:"targetingPolicy.disallowedSources"}},teamsAndChannels:{allowPrivateChannelCreation:{name:"teamsAndChannelsPolicy.allowPrivateChannelCreation"},allowPrivateTeamDiscovery:{name:"teamsAndChannelsPolicy.allowPrivateTeamDiscovery"},allowOrgWideTeamCreation:{name:"teamsAndChannelsPolicy.allowOrgWideTeamCreation"},allowSharedChannelCreation:{name:"teamsAndChannelsPolicy.allowSharedChannelCreation"},restrictedSenderList:{name:"clientSettings.restrictedSenderList"}},chat:{allowRoleBasedChatPermissions:{name:"clientSettings.allowRoleBasedChatPermissions",defaultValue:!1}},broadcast:{sdnConfiguration:{name:"broadcastMeetingPolicy.broadcastMeetingSDNConfigurationJsonBlob"}},userResources:{isSfbCloud:{name:"userResourcesSettings.isSfbCloud"},isSipEnabled:{name:"userResourcesSettings.isSipEnabled"},isSfbCloudInBVD:{name:"voiceAdminSettings.isSfbCloud"},isSipEnabledInBVD:{name:"voiceAdminSettings.isSipEnabled"},licenseSettings:{name:"userResourcesSettings.licenseSettings"},licenseType:{name:"userResourcesSettings.licenseType"},userClassifications:{name:"userResourcesSettings.userClassifications"}},distributionLists:{allowChatWithGroup:{name:"messagingPolicy.allowChatWithGroup",defaultValue:!0}},virtualEvents:{eventAccessTypePolicy:{name:"teamsEventsPolicy.eventAccessType"},allowTownhallsPolicy:{name:"teamsEventsPolicy.allowTownhalls"},allowWebinarIntegrationsPolicy:{name:"teamsEventsPolicy.allowWebinarIntegrations"},allowedWebinarTypesForRecordingPublish:{name:"teamsEventsPolicy.allowedWebinarTypesForRecordingPublish"},allowedTownhallTypesForRecordingPublish:{name:"teamsEventsPolicy.allowedTownhallTypesForRecordingPublish"},allowEmailEditingPolicy:{name:"teamsEventsPolicy.allowEmailEditing"},allowedQuestionTypesInRegistrationFormPolicy:{name:"teamsEventsPolicy.allowedQuestionTypesInRegistrationForm"}},ageConsent:{ageGroup:{name:"ageConsentPolicy.ageGroup"}},feedback:{receiveSurveysMode:{name:"feedbackPolicy.receiveSurveysMode"},allowEmailCollection:{name:"feedbackPolicy.allowEmailCollection"},allowScreenshotCollection:{name:"feedbackPolicy.allowScreenshotCollection",defaultValue:!1},allowLogCollection:{name:"feedbackPolicy.allowLogCollection",defaultValue:!1},enableFeatureSuggestions:{name:"feedbackPolicy.enableFeatureSuggestions"}},sdk:{licenseCategories:{name:"tenantSettingsV2.licenseCategorySettingsMap"}}},namespaces:["userPropertiesSettings","meetingPolicy","messagingPolicy","broadcastMeetingPolicy","teamsEventsPolicy","externalAccessPolicy","callingPolicy","voiceAdminSettings","policySettings","teamsVoiceApplicationsPolicy","teamsRoomVideoTeleConferencingPolicy","feedbackPolicy","clientSettings","tenantSiteUrl","tenantSettingsV2","filesPolicy","educationSettings","teamsMessagingConfiguration","targetingPolicy","teamsAndChannelsPolicy","userResourcesSettings","ageConsentPolicy"]};function tZ(e){switch(e){case"ag08":return n.e(427573).then(n.bind(n,980766)).then((e=>e.default));case"ag09":return n.e(529709).then(n.bind(n,277457)).then((e=>e.default));case"dod":return n.e(248735).then(n.bind(n,846050)).then((e=>e.default));case"gallatin":return n.e(693334).then(n.bind(n,147138)).then((e=>e.default));case"gcc":return n.e(324925).then(n.bind(n,505355)).then((e=>e.default));case"gcchigh":return n.e(854668).then(n.bind(n,712443)).then((e=>e.default));case"life":return n.e(872564).then(n.bind(n,731272)).then((e=>e.default));case"prod":return n.e(362376).then(n.bind(n,923289)).then((e=>e.default));case"viewportOverrides":return YX;case"clientFiltersMerge":return XX;case"clientFiltersOverride":return ZX;case"policies":return eZ;default:throw new Error(`Requested config does not exist: ${e}`)}}var nZ=n(706827),iZ=n(468578);const aZ=ft.WL.END,oZ=ft.WL.HEADER,rZ=ft.WL.MAIN,sZ=ft.WL.MODAL,lZ=ft.WL.NOTIFICATIONS,cZ=ft.WL.TITLE_BAR,dZ="minmax(0, 1fr)",uZ="minmax(1rem, 1fr)",mZ="3.9rem",gZ=[{slots:[rZ,sZ,lZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${lZ}"    auto\n        "${rZ}"             ${dZ} /\n        ${uZ}\n      `}]},{slots:[rZ,sZ,lZ,cZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${cZ}"         3.9rem\n        "${lZ}"    auto\n        "${rZ}"             ${dZ} /\n        ${uZ}\n      `}]},{slots:[oZ,rZ,sZ,lZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${lZ}"    auto\n        "${oZ}"           auto\n        "${rZ}"             ${dZ} /\n        ${uZ}\n      `}]},{slots:[oZ,rZ,sZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${oZ}"           auto\n        "${rZ}"             ${dZ} /\n        ${uZ}\n      `}]},{slots:[oZ,rZ,sZ,lZ,cZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${cZ}"        3.9rem\n        "${lZ}"   auto\n        "${oZ}"          auto\n        "${rZ}"            ${dZ} /\n        ${uZ}\n      `}]},{slots:[aZ,rZ,sZ,lZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${lZ}    ${lZ}"    auto\n        "${rZ}             ${aZ}"              ${dZ} /\n        ${uZ}         32rem\n      `}]},{slots:[aZ,rZ,sZ,lZ,cZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${cZ}         ${cZ}"         3.9rem\n        "${lZ}    ${lZ}"    auto\n        "${rZ}             ${aZ}"              ${uZ} /\n        ${uZ}         32rem\n      `}]},{slots:[aZ,oZ,rZ,sZ,lZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${lZ}    ${lZ}"    auto\n        "${oZ}           ${oZ}"           auto\n        "${rZ}             ${aZ}"              ${dZ} /\n        ${uZ}         32rem\n      `}]},{slots:[aZ,oZ,rZ,sZ,lZ,cZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${cZ}         ${cZ}"         3.9rem\n        "${lZ}    ${lZ}"    auto\n        "${oZ}           ${oZ}"           auto\n        "${rZ}             ${aZ}"              ${dZ} /\n        ${uZ}         32rem\n      `}]},{layoutKey:iZ.FU.HYER,slots:[rZ,sZ,lZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${lZ}"   auto\n        "${rZ}"            ${dZ} /\n        ${uZ}\n      `}]},{layoutKey:iZ.FU.HYER,slots:[rZ,sZ,lZ,cZ],responsiveTemplates:e=>{var t;const n=(null===(t=e[cZ])||void 0===t?void 0:t.height)||mZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${cZ}"        ${n}\n        "${lZ}"   auto\n        "${rZ}"            ${dZ} /\n        ${uZ}\n      `}]}},{layoutKey:iZ.FU.HYER,slots:[oZ,rZ,sZ,lZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${lZ}"   auto\n        "${oZ}"          auto\n        "${rZ}"            ${dZ} /\n        ${uZ}\n      `}]},{layoutKey:iZ.FU.HYER,slots:[oZ,rZ,sZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${oZ}"          auto\n        "${rZ}"            ${dZ} /\n        ${uZ}\n      `}]},{layoutKey:iZ.FU.HYER,slots:[oZ,rZ,sZ,lZ,cZ],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[oZ])||void 0===t?void 0:t.height)||"auto",a=(null===(n=e[cZ])||void 0===n?void 0:n.height)||mZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${cZ}"        ${a}\n        "${lZ}"   auto\n        "${oZ}"          ${i}\n        "${rZ}"            ${dZ} /\n        ${uZ}\n      `}]}},{layoutKey:iZ.FU.HYER,slots:[aZ,rZ,sZ,lZ],responsiveTemplates:e=>{var t,n,i,a;const o="32rem",r=(null===(n=null===(t=e[aZ])||void 0===t?void 0:t.width)||void 0===n?void 0:n.get(hs.Rd.IS_GREATER_THAN_0))||o,s=(null===(a=null===(i=e[aZ])||void 0===i?void 0:i.width)||void 0===a?void 0:a.get(hs.Rd.IS_AT_LEAST_1350))||o;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${lZ}    ${lZ}"    auto\n        "${rZ}             ${aZ}"              ${dZ} /\n        ${uZ}         ${r}\n      `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_1350,template:`\n        "${lZ}    ${lZ}"    auto\n        "${rZ}             ${aZ}"              ${dZ} /\n        ${uZ}         ${s}\n      `}]}},{layoutKey:iZ.FU.HYER,slots:[aZ,rZ,sZ,lZ,cZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${cZ}         ${cZ}"         3.9rem\n        "${lZ}    ${lZ}"    auto\n        "${rZ}             ${aZ}"              ${uZ} /\n        ${uZ}         32rem\n      `}]},{layoutKey:iZ.FU.HYER,slots:[aZ,oZ,rZ,sZ,lZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${lZ}    ${lZ}"    auto\n        "${oZ}           ${oZ}"           auto\n        "${rZ}             ${aZ}"              ${dZ} /\n        ${uZ}        32rem\n      `}]},{layoutKey:iZ.FU.HYER,slots:[aZ,oZ,rZ,sZ,lZ,cZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${cZ}         ${cZ}"         3.9rem\n        "${lZ}    ${lZ}"    auto\n        "${oZ}           ${oZ}"           auto\n        "${rZ}             ${aZ}"              ${dZ} /\n        ${uZ}        32rem\n      `}]},{layoutKey:iZ.FU.HEADER_AT_BOTTOM,slots:[oZ,rZ,sZ,lZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${lZ}"    auto\n        "${rZ}"             ${dZ}\n        "${oZ}"           auto /\n        ${uZ}\n      `}]},{layoutKey:iZ.FU.HEADER_AT_BOTTOM,slots:[oZ,rZ,sZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${rZ}"             ${dZ}\n        "${oZ}"           auto /\n        ${uZ}\n      `}]},{layoutKey:iZ.FU.HEADER_AT_BOTTOM,slots:[oZ,rZ,sZ,lZ,cZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${cZ}"        3.9rem\n        "${lZ}"   auto\n        "${rZ}"            ${dZ}\n        "${oZ}"          auto /\n        ${uZ}\n      `}]},{layoutKey:iZ.FU.HEADER_AT_BOTTOM,slots:[aZ,oZ,rZ,sZ,lZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${lZ}    ${lZ}"    auto\n        "${rZ}             ${aZ}"              ${dZ}\n        "${oZ}           ${oZ}"           auto /\n        ${uZ}         32rem\n      `}]},{layoutKey:iZ.FU.HEADER_AT_BOTTOM,slots:[aZ,oZ,rZ,sZ,lZ,cZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n        "${cZ}         ${cZ}"         3.9rem\n        "${lZ}    ${lZ}"    auto\n        "${rZ}             ${aZ}"              ${dZ}\n        "${oZ}           ${oZ}"           auto /\n        ${uZ}         32rem\n      `}]}],pZ="6.1rem",vZ="4.8rem",hZ="6.8rem",fZ=ft.WL.END,yZ=ft.WL.HEADER,bZ=ft.WL.MAIN,SZ=ft.WL.MODAL,kZ=ft.WL.NAV,wZ=ft.WL.NOTIFICATIONS,CZ=ft.WL.SUBNAV,_Z=ft.WL.TITLE_BAR,TZ=[{slots:[bZ,SZ,wZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${wZ}"    auto\n          "${bZ}"             minmax(0, 1fr) /\n           minmax(1rem, 1fr)\n        `}]},{slots:[bZ,SZ,wZ,_Z],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${_Z}"         4.8rem\n          "${wZ}"    auto\n          "${bZ}"             minmax(0, 1fr) /\n           minmax(1rem, 1fr)\n        `}]},{slots:[yZ,bZ,SZ,wZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${wZ}"    auto\n          "${yZ}"           auto\n          "${bZ}"             minmax(0, 1fr) /\n           minmax(1rem, 1fr)\n        `}]},{slots:[yZ,bZ,SZ,wZ,_Z],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${_Z}"         4.8rem\n          "${wZ}"    auto\n          "${yZ}"           auto\n          "${bZ}"             minmax(0, 1fr) /\n           minmax(1rem, 1fr)\n        `}]},{slots:[fZ,yZ,bZ,SZ,wZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${wZ}    ${wZ}"    auto\n          "${yZ}           ${yZ}"           auto\n          "${bZ}             ${fZ}"              minmax(0, 1fr) /\n           minmax(1rem, 1fr)        32rem\n        `}]},{slots:[fZ,yZ,bZ,SZ,wZ,_Z],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${_Z}         ${_Z}"         4.8rem\n          "${wZ}    ${wZ}"    auto\n          "${yZ}           ${yZ}"           auto\n          "${bZ}             ${fZ}"              minmax(0, 1fr) /\n           minmax(1rem, 1fr)        32rem\n        `}]},{layoutKey:iZ.FU.HYER,slots:[yZ,bZ,SZ,wZ],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[yZ])||void 0===t?void 0:t.height)||pZ,a=(null===(n=e[wZ])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${wZ}"    ${a}\n            "${yZ}"           ${i}\n            "${bZ}"             minmax(0, 1fr) /\n             minmax(1rem, 1fr)\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[yZ,bZ,SZ,wZ,_Z],responsiveTemplates:e=>{var t,n,i;const a=(null===(t=e[yZ])||void 0===t?void 0:t.height)||pZ,o=(null===(n=e[wZ])||void 0===n?void 0:n.height)||"auto",r=(null===(i=e[_Z])||void 0===i?void 0:i.height)||vZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${_Z}"         ${r}\n            "${wZ}"    ${o}\n            "${yZ}"           ${a}\n            "${bZ}"             minmax(0, 1fr) /\n             minmax(1rem, 1fr)\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[fZ,yZ,bZ,SZ,wZ],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[yZ])||void 0===t?void 0:t.height)||pZ,a=(null===(n=e[wZ])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${wZ}    ${wZ}"    ${a}\n            "${yZ}           ${yZ}"           ${i}\n            "${bZ}             ${fZ}"              minmax(0, 1fr) /\n             minmax(1rem, 1fr)        32rem\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[fZ,yZ,bZ,SZ,wZ,_Z],responsiveTemplates:e=>{var t,n,i;const a=(null===(t=e[yZ])||void 0===t?void 0:t.height)||pZ,o=(null===(n=e[wZ])||void 0===n?void 0:n.height)||"auto",r=(null===(i=e[_Z])||void 0===i?void 0:i.height)||vZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${_Z}         ${_Z}"         ${r}\n            "${wZ}    ${wZ}"    ${o}\n            "${yZ}           ${yZ}"           ${a}\n            "${bZ}             ${fZ}"              minmax(0, 1fr) /\n             minmax(1rem, 1fr)        32rem\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[bZ,SZ,kZ,wZ,_Z],responsiveTemplates:e=>{var t,n,i,a;const o=(null===(t=e[wZ])||void 0===t?void 0:t.height)||"auto",r=(null===(n=e[_Z])||void 0===n?void 0:n.height)||vZ,s=(null===(a=null===(i=e[kZ])||void 0===i?void 0:i.width)||void 0===a?void 0:a.get(hs.Rd.IS_GREATER_THAN_0))||hZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${_Z}    ${_Z}"         ${r}\n            "${kZ}         ${wZ}"    ${o}\n            "${kZ}         ${bZ}"             minmax(0, 1fr) /\n             ${s}    minmax(1rem, 1fr)\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[yZ,bZ,SZ,kZ,wZ,_Z],responsiveTemplates:e=>{var t,n,i,a,o;const r=(null===(t=e[yZ])||void 0===t?void 0:t.height)||pZ,s=(null===(n=e[wZ])||void 0===n?void 0:n.height)||"auto",l=(null===(i=e[_Z])||void 0===i?void 0:i.height)||vZ,c=(null===(o=null===(a=e[kZ])||void 0===a?void 0:a.width)||void 0===o?void 0:o.get(hs.Rd.IS_GREATER_THAN_0))||hZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${_Z}    ${_Z}"         ${l}\n            "${kZ}         ${wZ}"    ${s}\n            "${kZ}         ${yZ}"           ${r}\n            "${kZ}         ${bZ}"             minmax(0, 1fr) /\n             ${c}    minmax(1rem, 1fr)\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[fZ,bZ,SZ,kZ,wZ,_Z],responsiveTemplates:e=>{var t,n,i,a;const o=(null===(t=e[wZ])||void 0===t?void 0:t.height)||"auto",r=(null===(n=e[_Z])||void 0===n?void 0:n.height)||vZ,s=(null===(a=null===(i=e[kZ])||void 0===i?void 0:i.width)||void 0===a?void 0:a.get(hs.Rd.IS_GREATER_THAN_0))||hZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${_Z}    ${_Z}          ${_Z}"         ${r}\n          "${kZ}         ${wZ}     ${wZ}"    ${o}\n          "${kZ}         ${bZ}              ${fZ}"              minmax(0, 1fr) /\n           ${s}    minmax(1rem, 1fr)         32rem\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[fZ,yZ,bZ,SZ,kZ,wZ,_Z],responsiveTemplates:e=>{var t,n,i,a,o;const r=(null===(t=e[yZ])||void 0===t?void 0:t.height)||pZ,s=(null===(n=e[wZ])||void 0===n?void 0:n.height)||"auto",l=(null===(i=e[_Z])||void 0===i?void 0:i.height)||vZ,c=(null===(o=null===(a=e[kZ])||void 0===a?void 0:a.width)||void 0===o?void 0:o.get(hs.Rd.IS_GREATER_THAN_0))||hZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${_Z}    ${_Z}         ${_Z}"         ${l}\n            "${kZ}         ${wZ}    ${wZ}"    ${s}\n            "${kZ}         ${yZ}           ${yZ}"           ${r}\n            "${kZ}         ${bZ}             ${fZ}"              minmax(0, 1fr) /\n             ${c}    minmax(1rem, 1fr)        32rem\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[bZ,SZ,kZ,wZ,CZ,_Z],responsiveTemplates:e=>{var t,n,i,a;const o=(null===(t=e[wZ])||void 0===t?void 0:t.height)||"auto",r=(null===(n=e[_Z])||void 0===n?void 0:n.height)||vZ,s=(null===(a=null===(i=e[kZ])||void 0===i?void 0:i.width)||void 0===a?void 0:a.get(hs.Rd.IS_GREATER_THAN_0))||hZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${_Z}    ${_Z}    ${_Z}"         ${r}\n            "${kZ}         ${CZ}      ${wZ}"    ${o}\n            "${kZ}         ${CZ}      ${bZ}"             minmax(0, 1fr) /\n             ${s}    0              minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_947,template:`\n            "${_Z}    ${_Z}    ${_Z}"         ${r}\n            "${kZ}         ${CZ}      ${wZ}"    ${o}\n            "${kZ}         ${CZ}      ${bZ}"             minmax(0, 1fr) /\n             ${s}    28rem          minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_1350,template:`\n            "${_Z}    ${_Z}    ${_Z}"         ${r}\n            "${kZ}         ${CZ}      ${wZ}"    ${o}\n            "${kZ}         ${CZ}      ${bZ}"             minmax(0, 1fr) /\n             ${s}    32rem          minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_1500,template:`\n            "${_Z}    ${_Z}    ${_Z}"         ${r}\n            "${kZ}         ${CZ}      ${wZ}"    ${o}\n            "${kZ}         ${CZ}      ${bZ}"             minmax(0, 1fr) /\n             ${s}    36rem          minmax(1rem, 1fr)\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[yZ,bZ,SZ,kZ,wZ,CZ,_Z],responsiveTemplates:e=>{var t,n,i,a,o,r;const s=(null===(t=e[yZ])||void 0===t?void 0:t.height)||pZ,l=(null===(n=e[wZ])||void 0===n?void 0:n.height)||"auto",c=(null===(i=e[_Z])||void 0===i?void 0:i.height)||vZ,d=(null===(o=null===(a=e[kZ])||void 0===a?void 0:a.width)||void 0===o?void 0:o.get(hs.Rd.IS_GREATER_THAN_0))||hZ,u=null===(r=e[CZ])||void 0===r?void 0:r.width,m=(null==u?void 0:u.get(hs.Rd.IS_GREATER_THAN_0))||"0",g=(null==u?void 0:u.get(hs.Rd.IS_AT_LEAST_947))||"28rem",p=(null==u?void 0:u.get(hs.Rd.IS_AT_LEAST_1350))||"32rem",v=(null==u?void 0:u.get(hs.Rd.IS_AT_LEAST_1500))||"36rem";return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${_Z}    ${_Z}    ${_Z}"        ${c}\n            "${kZ}         ${CZ}      ${wZ}"   ${l}\n            "${kZ}         ${CZ}      ${yZ}"          ${s}\n            "${kZ}         ${CZ}      ${bZ}"            minmax(0, 1fr) /\n             ${d}    ${m}              minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_947,template:`\n            "${_Z}    ${_Z}    ${_Z}"        ${c}\n            "${kZ}         ${CZ}      ${wZ}"   ${l}\n            "${kZ}         ${CZ}      ${yZ}"          ${s}\n            "${kZ}         ${CZ}      ${bZ}"            minmax(0, 1fr) /\n             ${d}    ${g}          minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_1350,template:`\n            "${_Z}    ${_Z}    ${_Z}"        ${c}\n            "${kZ}         ${CZ}      ${wZ}"   ${l}\n            "${kZ}         ${CZ}      ${yZ}"          ${s}\n            "${kZ}         ${CZ}      ${bZ}"            minmax(0, 1fr) /\n             ${d}    ${p}          minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_1500,template:`\n            "${_Z}    ${_Z}    ${_Z}"        ${c}\n            "${kZ}         ${CZ}      ${wZ}"   ${l}\n            "${kZ}         ${CZ}      ${yZ}"          ${s}\n            "${kZ}         ${CZ}      ${bZ}"            minmax(0, 1fr) /\n             ${d}    ${v}          minmax(1rem, 1fr)\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[fZ,bZ,SZ,kZ,wZ,CZ,_Z],responsiveTemplates:e=>{var t,n,i,a,o;const r=(null===(t=e[fZ])||void 0===t?void 0:t.width)||"0",s=(null===(n=e[wZ])||void 0===n?void 0:n.height)||"auto",l=(null===(i=e[_Z])||void 0===i?void 0:i.height)||vZ,c=(null===(o=null===(a=e[kZ])||void 0===a?void 0:a.width)||void 0===o?void 0:o.get(hs.Rd.IS_GREATER_THAN_0))||hZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${_Z}    ${_Z}    ${_Z}         ${_Z}"         ${l}\n            "${kZ}         ${CZ}      ${wZ}    ${wZ}"    ${s}\n            "${kZ}         ${CZ}      ${bZ}             ${fZ}"              minmax(0, 1fr) /\n             ${c}    0              minmax(1rem, 1fr)        ${r}\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_947,template:`\n            "${_Z}    ${_Z}    ${_Z}         ${_Z}"         ${l}\n            "${kZ}         ${CZ}      ${wZ}    ${wZ}"    ${s}\n            "${kZ}         ${CZ}      ${bZ}             ${fZ}"              minmax(0, 1fr) /\n             ${c}    28rem          minmax(1rem, 1fr)        ${r}\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_1350,template:`\n            "${_Z}    ${_Z}    ${_Z}         ${_Z}"         ${l}\n            "${kZ}         ${CZ}      ${wZ}    ${wZ}"    ${s}\n            "${kZ}         ${CZ}      ${bZ}             ${fZ}"              minmax(0, 1fr) /\n             ${c}    32rem          minmax(1rem, 1fr)        32rem\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_1500,template:`\n            "${_Z}    ${_Z}    ${_Z}         ${_Z}"         ${l}\n            "${kZ}         ${CZ}      ${wZ}    ${wZ}"    ${s}\n            "${kZ}         ${CZ}      ${bZ}             ${fZ}"              minmax(0, 1fr) /\n             ${c}    36rem          minmax(1rem, 1fr)        32rem\n          `}]}},{layoutKey:iZ.FU.HYER,slots:[fZ,yZ,bZ,SZ,kZ,wZ,CZ,_Z],responsiveTemplates:e=>{var t,n,i,a,o,r;const s=(null===(t=e[fZ])||void 0===t?void 0:t.width)||"0",l=(null===(n=e[yZ])||void 0===n?void 0:n.height)||pZ,c=(null===(i=e[wZ])||void 0===i?void 0:i.height)||"auto",d=(null===(a=e[_Z])||void 0===a?void 0:a.height)||vZ,u=(null===(r=null===(o=e[kZ])||void 0===o?void 0:o.width)||void 0===r?void 0:r.get(hs.Rd.IS_GREATER_THAN_0))||hZ;return[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n            "${_Z}    ${_Z}    ${_Z}         ${_Z}"         ${d}\n            "${kZ}         ${CZ}      ${wZ}    ${wZ}"    ${c}\n            "${kZ}         ${CZ}      ${yZ}           ${yZ}"           ${l}\n            "${kZ}         ${CZ}      ${bZ}             ${fZ}"              minmax(0, 1fr) /\n             ${u}    0              minmax(1rem, 1fr)        ${s}\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_947,template:`\n            "${_Z}    ${_Z}    ${_Z}         ${_Z}"         ${d}\n            "${kZ}         ${CZ}      ${wZ}    ${wZ}"    ${c}\n            "${kZ}         ${CZ}      ${yZ}           ${yZ}"           ${l}\n            "${kZ}         ${CZ}      ${bZ}             ${fZ}"              minmax(0, 1fr) /\n             ${u}    28rem          minmax(1rem, 1fr)        ${s}\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_1350,template:`\n            "${_Z}    ${_Z}    ${_Z}         ${_Z}"         ${d}\n            "${kZ}         ${CZ}      ${wZ}    ${wZ}"    ${c}\n            "${kZ}         ${CZ}      ${yZ}           ${yZ}"           ${l}\n            "${kZ}         ${CZ}      ${bZ}             ${fZ}"              minmax(0, 1fr) /\n             ${u}    32rem          minmax(1rem, 1fr)        32rem\n          `},{minWidthBreakpoint:hs.Rd.IS_AT_LEAST_1500,template:`\n            "${_Z}    ${_Z}    ${_Z}         ${_Z}"         ${d}\n            "${kZ}         ${CZ}      ${wZ}    ${wZ}"    ${c}\n            "${kZ}         ${CZ}      ${yZ}           ${yZ}"           ${l}\n            "${kZ}         ${CZ}      ${bZ}             ${fZ}"              minmax(0, 1fr) /\n             ${u}    36rem          minmax(1rem, 1fr)        32rem\n          `}]}},{layoutKey:iZ.FU.HEADER_AT_BOTTOM,slots:[yZ,bZ,SZ,wZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${wZ}"    auto\n          "${bZ}"             minmax(0, 1fr)\n          "${yZ}"           auto /\n           minmax(1rem, 1fr)\n        `}]},{layoutKey:iZ.FU.HEADER_AT_BOTTOM,slots:[yZ,bZ,SZ,wZ,_Z],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${_Z}"        3.9rem\n          "${wZ}"   auto\n          "${bZ}"            minmax(0, 1fr)\n          "${yZ}"          auto /\n           minmax(1rem, 1fr)\n        `}]},{layoutKey:iZ.FU.HEADER_AT_BOTTOM,slots:[fZ,yZ,bZ,SZ,wZ],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${wZ}    ${wZ}"    auto\n          "${bZ}             ${fZ}"              minmax(0, 1fr)\n          "${yZ}           ${yZ}"           auto /\n           minmax(1rem, 1fr)        32rem\n        `}]},{layoutKey:iZ.FU.HEADER_AT_BOTTOM,slots:[fZ,yZ,bZ,SZ,wZ,_Z],responsiveTemplates:[{minWidthBreakpoint:hs.Rd.IS_GREATER_THAN_0,template:`\n          "${_Z}         ${_Z}"         3.9rem\n          "${wZ}    ${wZ}"    auto\n          "${bZ}             ${fZ}"              minmax(0, 1fr)\n          "${yZ}           ${yZ}"           auto /\n           minmax(1rem, 1fr)        32rem\n        `}]}];function IZ({layoutKey:e,layoutMode:t}){const n={[d.lO.focus]:gZ,[d.lO.minimal]:[],[d.lO.standard]:TZ};return new iZ.ZG({layoutKey:e,layoutMode:t,layoutTemplatesPerLayoutMode:n})}performance&&performance.mark&&performance.mark("start-execute-main-bundle"),n(701758);const EZ={Application:{onPreWarm:["settings-ecs-fetch","search-data-load","bootstrap-floodgate","start-meeting-bot","esp-signal-handler-job"]}},NZ=({osPlatform:e,theme:t,cspNonce:n,publicPathScript:i,containerVer:a,shouldStubConsoleError:o=!0})=>{const{favicons:r,preloadTitleBar:s}=Fw.L;return nZ({htmlWebpackPlugin:{options:{containerVer:a,publicPathScript:i,cspNonce:n,theme:t,shouldStubConsoleError:o,partials:{favicons:r(),preloadTitleBar:s({osPlatform:e})}},files:{}}})},AZ=(e,t)=>{let i=!1;(0,c.mT)((()=>Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(698627),n.e(273621),n.e(134315),n.e(899405),n.e(907784),n.e(838608),n.e(553211),n.e(714133),n.e(92700),n.e(598731),n.e(10143),n.e(529544),n.e(356833),n.e(709528),n.e(418676),n.e(301920),n.e(921132),n.e(886258),n.e(991883),n.e(433409),n.e(699772),n.e(185097),n.e(802054)]).then(n.bind(n,747806))),"core-essentials",t).catch((t=>{e.newLogger("Multi-Window","multi-window").error(`Failed to prefetch Core Layout: ${t}`),i=i||(e=>((0,Ue.J)().opener.postMessage(Hw.W.ExperienceStarted,{message:e.message,errorCode:-1,errorDescription:`${e.code}: ${e.subContext}`}),!0))(t)}))},FZ=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{renderErrorScreen:i}=yield Promise.all([n.e(893479),n.e(672617),n.e(76118),n.e(239894),n.e(273621),n.e(899405),n.e(907784),n.e(838608),n.e(553211),n.e(714133),n.e(92700),n.e(598731),n.e(10143),n.e(529544),n.e(709528),n.e(301920),n.e(991883),n.e(433409),n.e(699772),n.e(914682)]).then(n.bind(n,758928)),a=document.getElementById("app");a&&i(e,a,(0,Ue.J)(),void 0,t)})),DZ=e=>{const t={},n=e.vdiSettings;if(n){let e;switch(n.provider){case"1":e=KX.P.CitrixXenDesktop;break;case"2":e=KX.P.CitrixXenApp;break;case"3":e=KX.P.VMWare;break;case"5":e=KX.P.WVD;break;default:e=KX.P.None}t.vdi={provider:e,mode:n.mode,isAvRemoted:n.isAvRemoted,configFilter:(0,a.isEmpty)(n.configFilter)?null:n.configFilter}}const i=(e.navigator.userAgent||"").toLowerCase();return-1===i.indexOf("teamssamsungtv")&&-1===i.indexOf("teamscherrydevice")||(t.platformId=Pe.us.TV),-1!==i.indexOf("teamstesla")&&(t.platformId=Pe.us.Automotive),t};(()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;const t=Date.now(),i=(0,Ue.J)();i.opener.postMessage(Hw.W.ExperienceStarted,{message:"beforeCoreStart"}),i.handleGlobalWindowError&&(i.removeEventListener("error",i.handleGlobalWindowError),i.handleGlobalWindowError=void 0),i.consoleErrorFn&&(console.error=i.consoleErrorFn,i.consoleErrorFn=void 0);const a=n(759455),o=[w(),P(),ee(),ge(),Me(),nt(),rn(),Nn(),qa(),jo(),Zo(),ol(),fl(),Fl(),Lc(),ed(),Fd(),xd(),cu(),_u(),Eu(),Uu(),Zu(),mm(),Cm(),Mm(),Xm(),ug(),Cg(),zg(),ip(),vp(),fw(),fv(),zv(),lh(),Fh(),hy(),Ay(),Vy(),gb(),jS(),Aw(),YS(),dk(),Ck(),Ok(),Gk()];((e,t)=>{try{const t=e.localStorage.getItem("logLevel");if(t){const n=parseInt(t,10);if(n>=wI.i.None&&n<=wI.i.Max)return void(e.defaultConsoleLogLevel={userConsoleLogLevel:n})}}catch(e){}let n={preECSConsoleLogLevel:wI.i.Warn};if(e.location.host.indexOf("local")>=0)n={preECSConsoleLogLevel:wI.i.Warn};else{let e="unknown";if(t&&"object"==typeof t&&"ring"in t){const n=t.ring;n&&("string"==typeof n?e=n:"object"==typeof n&&"id"in n&&(e=n.id||"unknown"))}n=e.indexOf("general")>=0||e.indexOf("ring3")>=0?{preECSConsoleLogLevel:wI.i.None}:{preECSConsoleLogLevel:wI.i.Warn}}e.defaultConsoleLogLevel=n})(i,a);const r=new QX({config:Object.assign(Object.assign({},a),{startTimeMS:t,lifeCycleJobPermissions:EZ}),apps:o,loadConfigs:tZ,generateChildWindowTemplate:NZ,getPlatformConfigurationOverrides:DZ});let s;try{yield r.init(),s=r.coreServices}catch(e){return void FZ(e)}if(!s)return;const{loggerFactory:l,scenarioFactory:c}=s,d={config:a,getLayoutResponsiveTemplates:IZ,uiVariables:{isMultiWindow:!0}};yield(0,Dw.o)(r.activeWindows,s,(0,Rw.c)(d)),AZ(l,c),null===(e=s.scenarioFactory.findScenario(it.RG.ExperienceReady))||void 0===e||e.stop()})))().catch((e=>{FZ(e)}))},989553:(e,t,n)=>{"use strict";n.d(t,{rY:()=>o,Ok:()=>r});var i=n(109458);function a(e){if(e.definitions.length>1)return null;const t=e.definitions[0];return"FragmentDefinition"!==t.kind?null:t}function o(e){const t=(0,i.S)(e);if(!(null==t?void 0:t.name))throw new Error("Operation name must be set");return t.name.value}function r(e){var t;let n=(0,i.S)(e);return n||(n=a(e)),(null===(t=null==n?void 0:n.name)||void 0===t?void 0:t.value)||null}},42307:(e,t,n)=>{"use strict";n.d(t,{$Z:()=>p,aw:()=>m,nl:()=>u});var i=n(361366),a=n(433648),o=n(962400),r=n(950828),s=n(583607),l=n(343324);class c extends s.h{constructor(e,t){super(e),this.definitionOverflowLogged=new Set,this.isDuplicateWrite=e=>this.lastWrite&&this.lastDiff&&this.lastWrite===this.lastDiff.precedingWrite&&e.result===this.lastDiff.result;const{loggerFactory:n,scenarioFactory:i,graphqlStoreStatsReporterService:a,storeType:o,enableApolloDoubleWriteFix:r}=t;this.storeType=o,this.enableApolloDoubleWriteFix=r,n&&(this.logger=n.newLogger("InMemoryCacheWrapper","frameworks-apollo")),i&&(this.scenarioFactory=i),a&&(this.graphqlStoreStatsReporterService=a)}write(e){var t,n,i,a,o,r,s;let l,c=0;try{if(this.lastWrite&&this.isDuplicateWrite(e)&&(null===(t=this.graphqlStoreStatsReporterService)||void 0===t||t.markDuplicateWrite(this.storeType,e.query,null!==(n=this.lastWrite.elapsed)&&void 0!==n?n:0),this.enableApolloDoubleWriteFix))return this.lastWrite.result;l=null===(i=this.graphqlStoreStatsReporterService)||void 0===i?void 0:i.markWriteStart(this.storeType,e.query);const r=super.write(e);return l&&(c=null!==(o=null===(a=this.graphqlStoreStatsReporterService)||void 0===a?void 0:a.markWriteEnd(l))&&void 0!==o?o:0),this.lastWrite={result:r,elapsed:c},r}catch(e){throw null===(r=this.logger)||void 0===r||r.error(e.message),l&&(null===(s=this.graphqlStoreStatsReporterService)||void 0===s||s.markWriteError(l)),e}}read(e){var t,n;let i;try{i=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markReadStart(this.storeType,e.query);const a=super.read(e);return i&&(null===(n=this.graphqlStoreStatsReporterService)||void 0===n||n.markReadEnd(i)),a}finally{this.logResultCacheOverflowOnce("read",e.query)}}modify(e){var t,n,i,a;let o;try{o=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markWriteStart(this.storeType,`modify ${e.id||"ROOT_QUERY"}`);const i=super.modify(e);return o&&(null===(n=this.graphqlStoreStatsReporterService)||void 0===n||n.markWriteEnd(o)),i}catch(e){throw null===(i=this.logger)||void 0===i||i.error(e.message),o&&(null===(a=this.graphqlStoreStatsReporterService)||void 0===a||a.markWriteError(o)),e}}diff(e){var t,n;let i;try{i=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markDiffStart(this.storeType,e.query);const a=super.diff(e);return i&&(null===(n=this.graphqlStoreStatsReporterService)||void 0===n||n.markDiffEnd(i)),this.lastDiff={result:a.result,precedingWrite:this.lastWrite},a}finally{this.logResultCacheOverflowOnce("diff",e.query)}}logResultCacheOverflowOnce(e,t){var n,i,a,o,r;const s=t.definitions[0],c=this.getLastResultCacheOverflow();if(!this.scenarioFactory||c<=0||"OperationDefinition"!==s.kind)return;let d;if(s.name||1!==s.selectionSet.selections.length||"FragmentSpread"!==s.selectionSet.selections[0].kind){d={definitionKind:"query",definitionName:null!==(r=null===(o=s.name)||void 0===o?void 0:o.value)&&void 0!==r?r:"(unnamed)",overflowSize:c,method:e}}else{d={definitionKind:"fragment",definitionName:null!==(a=null===(i=null===(n=s.selectionSet.selections[0])||void 0===n?void 0:n.name)||void 0===i?void 0:i.value)&&void 0!==a?a:"",overflowSize:c,method:e}}const u=`${d.definitionKind}-${d.definitionName}`;if(!this.definitionOverflowLogged.has(u)){this.scenarioFactory.createScenarioWithoutStarting(l.RG.ApolloResultCacheOverflow).stop(d),this.definitionOverflowLogged.add(u)}}getLastResultCacheOverflow(){var e,t,n;return(null!==(n=(null!==(t=(null!==(e=this.storeReader)&&void 0!==e?e:{}).executeSelectionSet)&&void 0!==t?t:{}).__DEBUG_ONLY_optimismCache)&&void 0!==n?n:{}).__DEBUG_ONLY_lastOverflow||0}}const d=c,u=(e={})=>{const{apolloLeakOptions:t,cache:n,loggerFactory:r,scenarioFactory:s,enableApolloDevtools:l,enableApolloDoubleWriteFix:c,storeType:d=o.t.other,graphqlStoreStatsReporterService:u}=e,p=(0,i.__rest)(e,["apolloLeakOptions","cache","loggerFactory","scenarioFactory","enableApolloDevtools","enableApolloDoubleWriteFix","storeType","graphqlStoreStatsReporterService"]),v=new a.f(Object.assign(Object.assign({},p),{cache:n||m({apolloLeakOptions:t,loggerFactory:r,scenarioFactory:s,storeType:d,graphqlStoreStatsReporterService:u,enableApolloDoubleWriteFix:c}),assumeImmutableResults:!0,connectToDevTools:Boolean(l)}));return g(v,t),v},m=(e={})=>{var t,{apolloLeakOptions:n,loggerFactory:a,scenarioFactory:s,graphqlStoreStatsReporterService:l,storeType:c,enableApolloDoubleWriteFix:u}=e,m=(0,i.__rest)(e,["apolloLeakOptions","loggerFactory","scenarioFactory","graphqlStoreStatsReporterService","storeType","enableApolloDoubleWriteFix"]);const p={loggerFactory:a,scenarioFactory:s,graphqlStoreStatsReporterService:l,storeType:c||o.t.other,enableApolloDoubleWriteFix:u},v=new d(m,p);return null===(t=null==n?void 0:n.leakDetector)||void 0===t||t.track(r.I.ApolloCache,v),g(v,n),v},g=(e,{userContextId:t,windowId:n,entityType:i,viewportContext:a}={})=>{e.apolloLeakInfo={apolloLeakInfoStartTime:(new Date).toISOString(),apolloLeakInfoEntityType:i,apolloLeakInfoUserContextId:t,apolloLeakInfoViewportContext:a,apolloLeakInfoWindowId:n}},p=e=>{e.apolloLeakInfo||(e.apolloLeakInfo={}),e.apolloLeakInfo.apolloLeakInfoEndTime=(new Date).toISOString()}},322163:(e,t,n)=>{"use strict";n.d(t,{T:()=>a});var i=n(171060);const a=e=>{const t=performance.now();return{cacheSize:i({data:e.data.data,optimisticData:e.optimisticData.data}),measuringTime:performance.now()-t}}},979321:(e,t,n)=>{"use strict";n.d(t,{TP:()=>o,ad:()=>r,U:()=>l});var i=n(171060);function a(e){var t,n;const i=e.storeReader;return{selectionSetCache:null===(t=null==i?void 0:i.executeSelectionSet)||void 0===t?void 0:t.__DEBUG_ONLY_optimismCache,selectionSetArrayCache:null===(n=null==i?void 0:i.executeSubSelectedArray)||void 0===n?void 0:n.__DEBUG_ONLY_optimismCache}}function o(e){const{selectionSetCache:t,selectionSetArrayCache:n}=a(e),o=performance.now(),r=[Array.from(t.map),Array.from(n.map)];return{cacheSize:i(r),measuringTime:performance.now()-o}}function r(e){const{selectionSetCache:t,selectionSetArrayCache:n}=a(e);return{objectCount:t.map.size,arrayCount:n.map.size}}function s(e){var t,n,i,a;if(0===e.length)return"[Dirty]";let o="";return e[0]&&e[0].result&&(o=null!==(n=null===(t=e[0].result)||void 0===t?void 0:t.__typename)&&void 0!==n?n:"[Query]"),e[1]&&(o+=` (Error: ${null!==(a=null===(i=e[1])||void 0===i?void 0:i.message)&&void 0!==a?a:""})`),o}function l(e){var t;const{selectionSetCache:n}=a(e),i=new Map;for(const e of n.map.values()){const n=s(e.value.value),a=null!==(t=i.get(n))&&void 0!==t?t:0;i.set(n,a+1)}return Array.from(i).sort(((e,t)=>t[1]-e[1]))}},536947:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});var i=n(22083),a=n(116230);const o=["NoNetwork","RemoteOperationFailed"];class r extends i.G{constructor(e,t){super({type:"AuthError",code:s(e,t),prevError:"boolean"==typeof e?void 0:e})}getBoundaryProps(){switch(this.code){case"SIGN_IN_RESTRICTIONS":return{title:"default_signinrestrictions_title",description:"default_signinrestrictions_description",actions:["RESTART"]};case"ERROR_GETUSER_WHEN_ANON_NOT_SUPPORTED":return{title:"default_error_getuser_when_anon_not_supported_title",description:"default_error_getuser_when_anon_not_supported_description"};case"OFFLINE":return{title:"default_auth_no_network_title",description:"default_auth_no_network_description",actions:["RESTART"]};default:return{title:"default_authentication_title",description:"default_authentication_description",actions:["RESTART","SIGN_OUT"]}}}static fromSerialized(e){if("AuthError"!==(null==e?void 0:e.type))return null;const t=new r(void 0,e.code);return t.deserialize(e),t}}function s(e,t){if(t)return t;if("boolean"==typeof e)return e?"SIGN_IN_RESTRICTIONS":"UNKNOWN";if((0,a.a)(e)){const t=e.code;switch(t){case"SignInRestrictions":return"SIGN_IN_RESTRICTIONS";case"ErrorGetUserWhenAnonNotSupported":return"ERROR_GETUSER_WHEN_ANON_NOT_SUPPORTED";default:return o.includes(t)?"OFFLINE":"UNKNOWN"}}return"UNKNOWN"}},796868:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});var i=n(361366);const a=()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return n.e(296829).then(n.bind(n,296829))}))},293400:(e,t,n)=>{"use strict";n.d(t,{b:()=>T});var i=n(361366),a=n(351598),o=n(329214),r=n(652419),s=n(948519),l=n(916852),c=n(916561),d=n(635424),u=n(47135),m=n(296154),g=n(878563),p=n(685744),v=n(862696),h=n(763785),f=n(663045),y=n(786884);const b=3e5;var S=n(404026);const k="beta/imageauth/cookie",w="beta/users/{objectId}/cookiev2",C=1e3,_=new Map([[v.ej.SKYPE_KEY,[s.Pn.ams,s.Pn.amsV2]],[v.ej.MT_KEY,[s.Pn.mtImageService]]]);class T{constructor(e,t,n,i,m,v,S,_,T,I,E,N){var A;this._gtmRegistry=t,this._discover=n,this.coreSettings=m,this.windowProvider=v,this.platformService=S,this.localStorage=T,this._authenticationService=I,this.config=E,this.user=N,this._imageAuthCookieExpiryTsKey="ImageAuthCookieExpiryTime",this._activeAmsRequest={},this._baseImageUrlSubject=new g.X(null),this._isInitialized=!1,this._isImageAuthCookieValidSubject=new g.X(!1),this._imageCookieRetryInterval=2e4,this._imageCookieRetryMaxCount=5,this._isSetupImageCookieInProgress=!1,this.checkImageAuthCookie=()=>{let e=-1;const t=(new Date).getTime()/C,n=this.localStorage&&this.localStorage.get(this._imageAuthCookieExpiryTsKey,l.f.Global)||"-1";e=parseInt(n,10);const i=e>t,a=i?`Image auth cookie has NOT expired. Expiry time stamp: ${e}`:`Image auth cookie has expired. Expiry time stamp: ${e}`;this._logger.log(a),this._isImageAuthCookieValidSubject.next(i),this.startImageAuthCookiePollingTimer(i,e)},this.getRequest=(e,{requestUrl:t,requestBody:n,headers:i,serviceName:a},o)=>this._gtmRegistry.bind(this._send,e)({url:t,headers:i,credentials:"include",method:"POST",body:n,serviceName:a,apiName:o}),this.setupImageAuthCookie=()=>Promise.resolve({constructRequest:()=>{var e,t;return{url:this._isMTMAProfilePicturesEnabled&&(null===(e=this.user)||void 0===e?void 0:e.id)?w.replace("{objectId}",null===(t=this.user)||void 0===t?void 0:t.id):k,method:"POST",headers:{"x-ms-client-caller":"imageAuthCookieSetupEM","x-ms-client-type":(0,p.I)(this.platformService,this.config)},credentials:"include",apiName:"imageAuthCookie"}},allowedResponses:[c.qj.HTTP_2XX],retryPolicy:this.imageCookieRetryPolicy()}),this.setupImageAuthCookieEndpoints=({discover:e,authenticationResources:t})=>({baseUrlPromise:()=>e.regionGtm(s.Pn.middleTier),serviceName:d.EJ.MiddleTier,authResource:t.mtAuthResource,models:{setupImageAuthCookie:this.setupImageAuthCookie()}}),this._logger=i.newLogger("Content Media Auth","services-io-browser-aync-media"),this._send=(0,a.r)((0,o.B)((0,r.S)(e),c.qb.NO_CONTENT,c.qb.OK),(A=this._logger,{shouldRetry:e=>(0,y.o7)(e)||[c.qb.THROTTLED,-1].indexOf(e)>-1,errorHandler:(e,t)=>{const{serverResponse:{status:n}}=e;if(!t.retriesTable[n])throw new Error(`AsyncMediaAuthServiceRetryPolicy: retry count for ${n} is empty`);return A.error(`asyncMediaAuthServiceRetryPolicy: retrying '[${t.retryCount}]' times due to response status - '[${n}]'`),(0,h._)(t.delay.next())},retryMaxTimeMs:b,maxRetryCount:6,createDelay:()=>new f.df(1e3,2,b)})),this._setupImageAuthCookieApi=_.createApi(this.setupImageAuthCookieEndpoints),this._imageCookieRetryInterval=m.get(u.J.People).imageCookieRetryInterval||2e4,this._imageCookieRetryMaxCount=m.get(u.J.People).imageCookieRetryMaxCount||5,this._isMTMAProfilePicturesEnabled=!!m.get(u.J.People).enableProfilePicturesWithObjectId,this._isDeleteImageAuthCookieEnabled=!!m.get(u.J.People).enableDeleteImageAuthCookie,this._isMTMAProfilePicturesEnabled&&(this._imageAuthCookieExpiryTsKey=`${this._imageAuthCookieExpiryTsKey}_${null==N?void 0:N.id}`)}initAsyncMediaAuthService(){if(this._isInitialized)return;this.initBaseImageUrl().catch((()=>{this._logger.error("Error in initCookieImageAuth")}));const{enableAmsCookieValidation:e}=this.coreSettings.get(u.J.Core),{isImageAuthCookiePollingCheckEnabled:t}=this.coreSettings.get(u.J.People),{skipAmsAuthRequest:n,disableTokenCacheReadEvent:i}=this.coreSettings.get(u.J.Auth);e&&t?this.checkImageAuthCookie():n?this._isImageAuthCookieValidSubject.next(!0):(this._discover.validateSkypeToken().catch((()=>{})),this.subscribeToToken(v.ej.SKYPE_KEY),i?this.subscribeToMiddleTierToken():this.subscribeToToken(v.ej.MT_KEY)),this._isInitialized=!0}logout(){var e,t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o=d.EJ.Skype;const r=v.ej.MT_KEY,{mtResource:s}=yield this.coreSettings.get(u.J.Auth);if(s&&this._isDeleteImageAuthCookieEnabled&&(null===(e=this.user)||void 0===e?void 0:e.id)&&(null===(t=this._authenticationService)||void 0===t?void 0:t.acquireTokenV2)){const{token:e}=yield null===(n=this._authenticationService)||void 0===n?void 0:n.acquireTokenV2(s),t=null!==(a=_.get(r))&&void 0!==a?a:[],l=this.getHeaders(e,r);i=this._isMTMAProfilePicturesEnabled?"beta/users/{objectId}/deletecookiev2".replace("{objectId}",this.user.id):"beta/imageauth/deletecookie",o=d.EJ.MiddleTier;const{requireSkypetokenForMT:c}=this.coreSettings.get(u.J.Auth);return c&&(l["x-skypetoken"]=yield this._discover.validateSkypeToken()),this._logger.log("queueing request for deleting image auth cookie"),this.queueRequests(t,r,{requestUrl:i,headers:l,requestBody:undefined,serviceName:o},"deleteCookieOnLogout"),this._activeAmsRequest[r][0]}}))}startImageAuthCookiePollingTimer(e,t){this._imageAuthCookiePollingTimerId&&(this._logger.log(`Clearing image auth cookie polling. Timer ID: ${this._imageAuthCookiePollingTimerId}`),this.windowProvider.clearInterval(this._imageAuthCookiePollingTimerId));const n=Math.abs(t*C-(new Date).getTime()),i=e?n:5e3;this._imageAuthCookiePollingTimerId=this.windowProvider.setInterval((()=>this.checkImageAuthCookie()),i);const a=e?`Image auth cookie valid. expiry check timer started. Timer ID: ${this._imageAuthCookiePollingTimerId}`:`Image auth cookie NOT valid. polling validity timer started. Timer ID: ${this._imageAuthCookiePollingTimerId}`;e||this._logger.warn(a)}initBaseImageUrl(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=null!==(e=_.get(v.ej.MT_KEY))&&void 0!==e?e:[],n=yield this.getBaseUrl(t[0]);n&&this._baseImageUrlSubject.next(n)}))}getBaseUrl(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this._discover.regionGtm(e);return t||this._logger.error("baseImageUrl is undefined"),t}catch(t){const n=`Fetching baseImageUrl failed from regionGTM, passed gtm: ${e.length}, errorCode: ${null==t?void 0:t.code}, errorContext: ${null==t?void 0:t.context}, errorMessage: ${null==t?void 0:t.message}`,i=(0,S.A)(n);return this._logger.errorToTelemetry?this._logger.errorToTelemetry(i,"async_media_auth_service",void 0,!0):this._logger.error(n),Promise.reject(t)}}))}subscribeToToken(e){var t;e===v.ej.SKYPE_KEY&&this._discover.observeSkypeToken().subscribe((e=>this.persistTokenToAMS(e,v.ej.SKYPE_KEY))),e===v.ej.MT_KEY&&(null===(t=this._authenticationService)||void 0===t||t.observeMiddleTierToken().subscribe((e=>this.persistTokenToAMS(e,v.ej.MT_KEY))))}getHeaders(e,t){const n={},i=(0,m.v4)();return n.Authorization=`${t===v.ej.SKYPE_KEY?"skype_token":"Bearer"} ${e}`,n["Content-Type"]="application/x-www-form-urlencoded",n.RequestId=i,n.CorrelationId=i,n.TransactionId=i,n["x-ms-client-type"]=(0,p.I)(this.platformService,this.config),n}persistTokenToAMS(e,t){var n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o,r,s=d.EJ.Skype;const l=null!==(n=_.get(t))&&void 0!==n?n:[],c=this.getHeaders(e,t);if(!e)return Promise.resolve(null);if(this._activeAmsRequest[t])return this._activeAmsRequest[t];switch(this._logger.log(`persistTokenToAMS: received new token for ${t}`),t){case v.ej.SKYPE_KEY:i=`skypetoken=${e}`,o="v1/skypetokenauth",s=d.EJ.Skype;break;case v.ej.MT_KEY:o=this._isMTMAProfilePicturesEnabled&&(null===(a=this.user)||void 0===a?void 0:a.id)?w.replace("{objectId}",this.user.id):k,s=d.EJ.MiddleTier,r=yield this.getBaseUrl(l[0]);const{requireSkypetokenForMT:t}=this.coreSettings.get(u.J.Auth),{disableSkypeTokenInCookieRequest:n}=this.coreSettings.get(u.J.People);t&&!n&&(c["x-skypetoken"]=yield this._discover.validateSkypeToken())}return this._logger.log(`persistTokenToAMS: queueing request for ${t}`),this.queueRequests(l,t,{requestUrl:o,headers:c,requestBody:i,serviceName:s},"persistTokenToAMS"),Promise.all(this._activeAmsRequest[t]).then((()=>{this._activeAmsRequest[t]=void 0,this._logger.log(`persistTokenToAMS: persist token for ${t}`),t===v.ej.MT_KEY&&(this._isImageAuthCookieValidSubject.next(!0),r?this._baseImageUrlSubject.next(r):this._logger.error("baseImageUrl is undefined"))})).catch((e=>{this._logger.error(`Unable to persist token: tokenType ${t} error ${e}`),this._activeAmsRequest[t]=void 0})),this._activeAmsRequest[t]}))}queueRequests(e,t,n,i){this._activeAmsRequest[t]=[],e.map((e=>{this._activeAmsRequest[t].push(this.getRequest(e,n,i))}))}subscribeToMiddleTierToken(){var e;null===(e=this._authenticationService)||void 0===e||e.observeMiddleTierToken().subscribe((e=>{if(e||this.isImageCookieExpired()){const t=e?"token changed":"cookie expired";this._logger.log(`Set up image auth cookie due to: ${t}`),this.setupImageAuthCookieAndExpiry()}else this._isImageAuthCookieValidSubject.next(!0)}))}setupImageAuthCookieAndExpiry(){var e,t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this._isSetupImageCookieInProgress){this._isSetupImageCookieInProgress=!0,this._logger.log("Setting up image auth cookie");try{yield this._setupImageAuthCookieApi.setupImageAuthCookie(),this._isImageAuthCookieValidSubject.next(!0);const{mtResource:i}=yield this.coreSettings.get(u.J.Auth);if(i&&(null===(e=this._authenticationService)||void 0===e?void 0:e.acquireTokenV2)){const e=yield null===(t=this._authenticationService)||void 0===t?void 0:t.acquireTokenV2(i);null===(n=this.localStorage)||void 0===n||n.set(this._imageAuthCookieExpiryTsKey,`${null==e?void 0:e.expires}`,l.f.Global),this._logger.log(`Successfully set up image auth cookie expiry ${null==e?void 0:e.expires}`)}}catch(e){this._logger.error(`setupImageAuthCookieAndExpiry error ${e}`)}finally{this._isSetupImageCookieInProgress=!1}}}))}isImageCookieExpired(){var e;const t=Math.round(Date.now()/C),n=(null===(e=this.localStorage)||void 0===e?void 0:e.get(this._imageAuthCookieExpiryTsKey,l.f.Global))||"-1";return parseInt(n,10)<t}imageCookieRetryPolicy(){return{shouldRetry:(e,t,n)=>{if(t>=c.qb.OK&&t<=c.qb.NOT_MODIFIED)return!1;const i=e<this._imageCookieRetryMaxCount&&t!==c.qb.BAD_REQUEST&&t!==c.qb.NOT_AUTHORIZED;return this._logger.warn(`imageCookieRetryPolicy retry count ${e} responseCode ${t} canRetry ${i}`),i},nextDelay:e=>this._imageCookieRetryInterval*Math.pow(2,e)}}get baseImageUrlObservable(){return this._baseImageUrlSubject.asObservable()}get isImageAuthCookieValidObservable(){return this._isImageAuthCookieValidSubject.asObservable()}get baseImageUrl(){return this._baseImageUrlSubject.value}get isImageAuthCookieValid(){return this._isImageAuthCookieValidSubject.value}}},494961:(e,t,n)=>{"use strict";n.d(t,{i:()=>p,O:()=>v});var i=n(361366),a=n(197981),o=n(47135),r=n(915569),s=n(181896),l=n(438985),c=n(737990),d=n(678058),u=n(139682),m=n(343324),g=n(740755);const p="~~~~###@@TACOCAT@@###~~~~";let v=class{transform(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t.messageProperties)return;this._logger=t.loggerFactory.newLogger("CodeSnippetsSerializer","services-io-browser-compose-serializer-extensions"),this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;const n=(0,a.unescape)(l.N.DomUtils.getAttributeValue(e,r.Qq)),i=l.N.DomUtils.getAttributeValue(e,r.fK),[o]=l.N.DomUtils.getElementsByTagName("code",e);if(!n)return this._logger.error("The props was missing"),null;if(!o)return this._logger.error("The code snippet was missing"),null;if(!i)return this._logger.error("The id of the card was missing"),null;try{yield this._uploadAndUpdateCard(i,JSON.parse(n),o,t);const e=(0,c.ln)("span",{content:i,itemprop:"cardId"}),a=(0,c.ln)("span",{class:"inline-compose-card",itemid:i,itemscope:"",itemtype:d.T.inputExtension});return l.N.DomUtils.appendChild(a,e),this._logger.debug("Uploaded code snippet",i),a}catch(e){return this._logger.error("Failed to upload the code snippet!"),null}}))}_uploadCodeSnippet(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{source:i}=e,r=l.N.DomUtils.getInnerHTML(t),s=`${i}${p}${r}`,c=null===(a=this._scenarioFactory)||void 0===a?void 0:a.newScenario(m.RG.CodeSnippetUpload);try{const{objectId:e}=yield this._uploadToAMS(s,n,this._logger);return null==c||c.stop(),{objectId:e,uploadType:"AMS"}}catch(e){this._logger.error("_uploadCodeSnippet: code snippet upload to ams failed!"),null==c||c.fail();const{enableCacheStorageInSendMessageMW:t}=this._settings.get(o.J.Messaging);if(t){this._logger.debug("Trying to upload code snippet to cache storage");const{objectId:e}=yield this._uploadToCache(s,n,this._logger);return{objectId:e,uploadType:"OfflineCache"}}throw this._logger.debug("_uploadCodeSnippet: enableCacheStorageInSendMessageMW is not enabled!"),e}finally{null==c||c.stop()}}))}_uploadToAMS(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){n.log("Uploading to code snippet to ams");const{objectId:i}=yield t.asyncMediaService.uploadItem(e,t.conversationId,"DOCUMENT",g.r1.Attached);return{objectId:i}}))}_uploadToCache(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{n.log("uploading inline image to offline cache storage");const[i,a]=yield t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":"text/html","Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.length}`,Date:(new Date).toUTCString()})}));return n.log(`Uploaded image to offline cache, image: ${a} objectId: ${i}`),{objectId:i}}catch(e){throw n.error("_uploadToCache: uploading inline image to offline cache store failed!"),e}}))}_uploadAndUpdateCard(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{amsReferenceId:i}=t,{name:o,language:r,wrap:s}=t,l=a.messageProperties.cards||[];let c={objectId:i,uploadType:"AMS"};if(i||(c=yield this._uploadCodeSnippet(t,n,a)),"AMS"===c.uploadType){const e=a.messageProperties.amsReferences||[];a.messageProperties.amsReferences=[...e,c.objectId]}else if("OfflineCache"===c.uploadType){const e=a.messageProperties.offlineAssets||[];a.messageProperties.offlineAssets=[...e,c.objectId]}a.messageProperties.cards=[...l.filter((t=>t.cardClientId!==e)),{appId:e,cardClientId:e,contentType:u.p.CodeSnippet,content:JSON.stringify({type:u.p.CodeSnippet,editable:!0,id:e,name:o,language:r,wrap:s,lines:n.children?n.children.length:0,cardClientId:e,amsReferenceId:c.objectId})}],a.telemetryDatabag["DataBag.codeSnippets"]=(a.telemetryDatabag["DataBag.codeSnippets"]||0)+1}))}};v=(0,i.__decorate)([(0,s.HR)({name:"CodeSnippets",filter:{[r.$S]:"CodeSnippetCard"}})],v)},397212:(e,t,n)=>{"use strict";n.d(t,{D:()=>g});var i=n(361366),a=n(181896),o=n(678058),r=n(263436),s=n(438985),l=n(197981);const c=new RegExp(/animated-emoticon.*?/),d=/img|table/,u=e=>!!e&&(s.N.DomUtils.getAttributeValue(e,"itemtype")===o.T.emoji||c.test(s.N.DomUtils.getAttributeValue(e,"class")||"")||(0,r.x)(e)),m=3;let g=class{preTransform(e,t){const n=(0,l.isUndefined)(t.superSizeEmoticons)?0:t.superSizeEmoticons;var i;"br"===e.name?t.containsPotentiallyIncludedWhitespace=!0:(0,l.isNumber)(n)&&(t.superSizeEmoticons=u(e)?(i=n,!t.containsPotentiallyIncludedWhitespace&&i<m&&i+1):!(e=>e&&!u(e.parent)&&!(e.parent&&u(e.parent.parent))&&(d.test(e.name||"")||!(!e.data||!e.data.replace(" ","").replace(/[\u200B-\u200D\uFEFF]/g,"").trim())))(e)&&n)}};g=(0,i.__decorate)([(0,a.wx)({name:"BigEmoticonPreprocessor",filter:"*"})],g)},53092:(e,t,n)=>{"use strict";n.d(t,{D:()=>Xe,fh:()=>Qe,Vf:()=>Ye,bl:()=>Ke});var i=n(361366),a=n(181896),o=n(438985),r=n(829832),s=n(678058),l=n(197981),c=n(980402),d=n(428482),u=n(764302);const m=e=>{e&&o.N.DomUtils.hasAttrib(e,r.zj.type)&&delete e.attribs[r.zj.type]};var g=n(218169),p=n(47135),v=n(653685),h=n(65903);const f={fileDetailsPromiseResolved:"file_deatails_promise_resolved"};var y=n(343324);let b=class{constructor(){this._allowAsyncChicletCreation=!1,this._asyncLinkConversionDetailsByItemId=new Map,this._loggerCb=l.noop,this._timeout=0}preTransform(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t||!o.N.DomUtils.hasAttrib(e,"href"))return;this._setupConstants(t);const i=e.attribs[r.zj.itemid];if(i){if(this._allowAsyncChicletCreation&&o.N.DomUtils.hasAttrib(e,r.zj.type)&&e.attribs[r.zj.type]===u.le.asyncLinkToChicletConversionIdentifier){const a=(0,l.unescape)(e.attribs.href),{fileReferenceService:o}=t,r=o.parseFileLabelFromUrl(a);if(!r)return void m(e);const s=null===(n=this._scenarioFactory)||void 0===n?void 0:n.newScenario(y.RG.AsyncLinkToChiclet),d=this._asyncLinkConversionDetailsByItemId.get(i);if(d)return void D(d,a,s,(e=>this._asyncLinkConversionDetailsByItemId.set(i,e)));try{const e=(0,c.E)(o.getFileDetails(r,"chat",["fluid"]),this._timeout,"file details call timed out");this._asyncLinkConversionDetailsByItemId.set(i,{fileDetailsPromise:e,scenario:s,linkInfo:{href:a,count:1}})}catch(t){const n=(null==t?void 0:t.message)||"";return F(e,s,n)}}return e}}))}transform(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!(e&&o.N.DomUtils.hasAttrib(e,"href")&&t&&t.files&&t.messageProperties&&t.existingLinks))return;const n=e.attribs[r.zj.itemid];if(!n)return;const i=this._asyncLinkConversionDetailsByItemId.get(n);if(i){const{scenario:n}=i;try{const a=yield k(t,e,i);return n&&n.stop(),a}catch(t){return m(e),void(0,g.V)(t,this._loggerCb,n)}}if(!o.N.DomUtils.hasAttrib(e,r.zj.itemProps))return A(e,t);const{files:a}=t;try{const i=N(a,e);if(!i)return;const{shareUrl:o,title:r}=i;o&&(e.attribs.href=o),C(e,r,o),w(i,n,t)}catch(e){return}return e}))}_setupConstants({coreSettings:e,loggerFactory:t,scenarioFactory:n}){this._loggerCb=S(t.newLogger("SharepointLinkSerializer","services-io-files-compose-serializer-extensions")),this._scenarioFactory=n;const{enableFilesAsyncChicletCreationInMultiWindow:i,asyncChicletCreationTimeout:a}=e.get(p.J.Files);this._allowAsyncChicletCreation=!!i,this._timeout=a||3e3}};b=(0,i.__decorate)([(0,a.HR)({name:"SharepointLinkSerializer",filter:"a"})],b);const S=e=>t=>{e.error(t)},k=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{fileDetailsPromise:i,scenario:a}=n,o=yield i;return a&&a.mark(f.fileDetailsPromiseResolved),w(o,o.fileId,e),((e,t)=>{const{files:n}=t;return-1!==n.findIndex((t=>t.id===e.fileId))})(o,e)||E(e,(({objectUrl:e,shareUrl:t,type:n,fileId:i,title:a,baseUrl:o,shareId:r,fileSourceDetail:s})=>{const l=(0,v.gD)(e),{permissionScope:c}=s||{permissionScope:""};return{id:i,baseUrl:o,objectUrl:e,shareUrl:t,shareId:r,type:n,title:a,permissionScope:c,state:h.cj1.reference,isReferencedFile:!0,serviceName:h.a4b.p2p,previewUrl:"",chicletBreadcrumbs:{sourceChannelName:(null==l?void 0:l.sourceChannelName)||null,sourceTeamName:(null==l?void 0:l.sourceTeamName)||null},previewHeight:null,previewWidth:null,progressComplete:null,hasUploadFailed:!1}})(o)),m(t),t})),w=(e,t,n)=>{const{objectUrl:i,shareUrl:a,title:o,type:r}=e,s=T({objectUrl:i,shareUrl:a,itemid:t,type:r,title:o});I(n,s)},C=(e,t,n)=>{e.children&&_(t,e,n)},_=(e,t,n)=>{const i=[t];for(;0!==i.length;){const a=i.pop();if(a&&a.children)for(const o of a.children){if("text"===o.type&&(0,l.startsWith)(o.data,"https"))return o.data=e,t.attribs&&(t.attribs.title=n),!0;i.push(o)}}return!1},T=({objectUrl:e,shareUrl:t,itemid:n,type:i,title:a})=>({title:a,objectUrl:e,description:"",fileShareUrlMeta:{id:n,objectUrl:e,type:i,shareUrl:t}}),I=(e,t)=>{e.messageProperties.embeddedLinks=[...e.messageProperties.embeddedLinks||[],t],e.telemetryDatabag["DataBag.links"]=(e.telemetryDatabag["DataBag.links"]||0)+1},E=(e,t)=>{e.files.push(t)},N=(e,t)=>{const n=t.attribs[r.zj.itemid],i=e.find((e=>e.id===n));if(i){const{shareUrl:e,title:t,objectUrl:n,type:a}=i;return{shareUrl:e||"",title:t||"",type:a||"",objectUrl:n||""}}if(t.attribs[r.zj.itemtype]===s.T.filesHyperlink){const e=t.attribs[r.zj.itemProps];if(e){const t=(0,l.unescape)((0,l.unescape)(e)),n=JSON.parse(t),{type:i,objectUrl:a,shareUrl:o,title:r}=n;return{shareUrl:o,title:r,objectUrl:a,type:i}}}},A=(e,t)=>{if(o.N.DomUtils.hasAttrib(e,"href")){const n=e.attribs.href||"",i=t.existingLinks.filter((e=>{var t;return(null===(t=e.fileShareUrlMeta)||void 0===t?void 0:t.shareUrl)===n}));if(i&&i.length&&i[0].fileShareUrlMeta)return I(t,(0,d.i)(i[0],"__typename")),e}},F=(e,t,n)=>{m(e),null==t||t.fail({errorCode:u.le.telemetry.errorCodes.asyncLinkConversionPretransformFailure,errors:JSON.stringify(n)})},D=(e,t,n,i)=>{const{linkInfo:a}=e;let o="";if(a&&t===a.href){const{count:n}=a;o=`Duplicate links: ${n}`,i(Object.assign(Object.assign({},e),{linkInfo:{href:t,count:n+1}}))}else o="Different href for same itemid";null==n||n.incomplete({errorCode:u.le.telemetry.errorCodes.asyncLinkMultiplePretransform,errors:o})};var R=n(402715),x=n(737990),M=n(469929),O=n(97600);let P=class{constructor(){this._shouldGroupMentions=()=>this._enableComposeFrameworkV2&&this._enableGroupedMentions,this._unescapeMentionText=e=>this._enableComposeFrameworkV2?(0,l.unescape)(e).replace(/&nbsp;/g," "):e,this._removeExtraSpacesInMention=e=>{var t;null===(t=e.parent)||void 0===t||t.children.forEach((e=>{"text"!==e.type||" "!==e.data&&!this._isWhitespaceFromComposeV2(e.data)||o.N.DomUtils.removeElement(e)}))},this._getMentionKey=e=>{var t,n,i;const a=null===(n=null===(t=e.children)||void 0===t?void 0:t[0])||void 0===n?void 0:n.data;return`${null===(i=e.attribs)||void 0===i?void 0:i[r.zj.mri]}_${a}`},this._mergeMentions=(e,t)=>{if(!e.attribs)return;const n=e.attribs[r.zj.mri]||"";let i=this._getNextContigousMention(e,n);for(;e.children&&e.children.length>0&&i;){const a=i.children;if(a&&a.length>0&&a[0].data){const n=this._getMentionKey(i),o=t.get(n);o?t.set(n,o+1):t.set(n,1),e.children[0].data+=` ${a[0].data}`}i=this._getNextContigousMention(i,n)}},this._isWhitespaceFromComposeV2=e=>!("&nbsp;"!==e||!this._shouldGroupMentions()),this._getNextContigousMention=(e,t)=>{var n;if(!e||!e.next)return null;const i=e.next,a=t===(null===(n=null==i?void 0:i.attribs)||void 0===n?void 0:n[r.zj.mri]);return" "===i.data||this._isWhitespaceFromComposeV2(i.data)||a?i:null},this._enableComposeFrameworkV2=!1,this._enableGroupedMentions=!1}transform(e,t){var n,i,a;const{enableComposeFrameworkV2:c}=t.coreSettings.get(p.J.Messaging),{enableGroupedMentions:d}=t.coreSettings.get(p.J.Compose);if(this._enableComposeFrameworkV2=!!c,this._enableGroupedMentions=!!d,!(e&&t&&t.messageProperties&&o.N.DomUtils.hasAttrib(e,r.zj.mri)))return;t.seenMentions||(t.seenMentions=new Map);const u=this._getMentionKey(e),m=t.seenMentions.get(u);if(m)return 1===m?t.seenMentions.delete(u):t.seenMentions.set(u,m-1),null;this._mergeMentions(e,t.seenMentions);const{messageProperties:g,telemetryDatabag:v}=t;g.mentions||(g.mentions=[]),g.onBehalfOf||(g.onBehalfOf=[]);const h=`${g.mentions.length+g.onBehalfOf.length}`,f=this._unescapeMentionText((0,x.Q)(e)),y=(null===(n=null==e?void 0:e.attribs)||void 0===n?void 0:n[r.zj.type])||(L(e)?"bot":"person");if("tag"===y){const t=(null===(a=null===(i=null==e?void 0:e.attribs)||void 0===i?void 0:i[r.zj.mri])||void 0===a?void 0:a.startsWith("s"))?"PeopleTargeting.numScheduledTagMentions":"PeopleTargeting.numTeamTagMentions";v[t]=(v[t]||0)+1}else v["DataBag.atmentions"]=(v["DataBag.atmentions"]||0)+1;const b=(0,x.ln)(R.s.span),S=(0,x.rw)((0,l.escape)(f)),k=o.N.DomUtils.hasAttrib(e,r.zj.stale),w=o.N.DomUtils.getAttributeValue(e,r.zj.mri)||"";return o.N.DomUtils.appendChild(b,S),k||("webhook"===y?(g.onBehalfOf.push({itemId:h,displayName:f,userId:w,mentionType:y}),g.mentions.push({itemId:`${Number(h)+1}`,displayName:f,userId:M.BB.InterceptorBotMris[0],mentionType:y})):g.mentions.push({itemId:h,displayName:f,userId:w,mentionType:y}),b.attribs[r.zj.itemtype]=s.T.mention,b.attribs[r.zj.itemscope]="",b.attribs[r.zj.itemid]=h),this._removeExtraSpacesInMention(e),b}};P=(0,i.__decorate)([(0,a.wx)({name:"AtMentionSerializer",filter:"mention"}),(0,i.__metadata)("design:paramtypes",[])],P);const L=e=>{var t;return(0,O.bl)((null===(t=null==e?void 0:e.attribs)||void 0===t?void 0:t[r.zj.mri])||"")};let U=class{transform(e,t){if(!e.attribs)return void t.logger.error("image attribs is missing");const n=o.N.DomUtils.getAttributeValue(e,r.zj.cacheKey);if(n&&n.length)return e.attribs["data-cke-saved-src"]=void 0,e.attribs.src=t.offlineCacheManager.getCachedUrlByKey(n),e;t.logger.error("image missing cache key")}};U=(0,i.__decorate)([(0,a.wx)({name:"CachedImageSerializer",filter:[{itemtype:s.T.cachedImage}]})],U);let j=class{preTransform(e){return null}};j=(0,i.__decorate)([(0,a.wx)({name:"RemoveHiddenSelectionSerializer",filter:["data-cke-hidden-sel"]})],j);var $=n(915569);let B=class{transform(e){if(e.data&&$.Eh.test(e.data))return e.data=e.data.replace(new RegExp($.Eh,"g"),""),e}};B=(0,i.__decorate)([(0,a.wx)({name:"RemoveZwsSerializer",filter:"text",transient:!0})],B);const W="data-only-whitespace",H=/^(\s|[\u200B-\u200D\uFEFF])*$/;let V=class{preTransform(e,t){return z(e)?void(t.whiteSpaceId&&t.whiteSpaceId++):(t.whiteSpaceId||(t.whiteSpaceId=1),e.attribs||(e.attribs={}),e.attribs[W]=`${t.whiteSpaceId+1}`,e)}};V=(0,i.__decorate)([(0,a.wx)({name:"WhiteSpacePreprocessor",filter:["div","p","br","span","text"],transient:!0})],V);const z=e=>!H.test((0,x.Q)(e))||!!o.N.DomUtils.findOne((e=>{if(e.attribs&&Object.keys(e.attribs).length||!e.name)return!0;switch(e.name.toLowerCase()){case"br":case"div":case"p":case"span":break;default:return!0}return!1}),[e]);let q=class{transform(e,t){const n=o.N.DomUtils.getAttributeValue(e,W);return!t.whiteSpaceId||!n||+n>t.whiteSpaceId?null:(e.attribs&&delete e.attribs[W],e)}};q=(0,i.__decorate)([(0,a.wx)({name:"TrailingWhiteSpaceSerializer",filter:[W],transient:!0})],q);var G=n(494961),J=n(397212),Q=n(859741);let K=class{transform(e,t){const n=`${!!t.superSizeEmoticons?$.G4:$.Mw}px`;return e.attribs||(e.attribs={}),e.attribs.height=n,e.attribs.width=n,(0,x.A_)(e,{"max-height":n,"max-width":n,height:n,width:n}),e}};K=(0,i.__decorate)([(0,a.wx)({name:"EmojiOneSerializer",filter:{class:new RegExp(Q.Uu)}})],K);var Y=n(637362);let X=class{transform(e,t){const n=t.superSizeEmoticons?"large":"small",i=(0,Y.cn)(n),a=t=>o.N.DomUtils.getAttributeValue(e,t)||"",r=a("itemid");t.telemetryDatabag&&(t.telemetryDatabag["DataBag.emojiList"]=[...t.telemetryDatabag["DataBag.emojiList"]||[],`Skype.${r}`],t.telemetryDatabag["DataBag.emoji"]=t.telemetryDatabag["DataBag.emojiList"].length);const l=(0,x.ln)("span",{contenteditable:"false",title:a("title"),type:`(${r})`,class:`animated-emoticon-${i}-${r}`}),c=a("alt")||a("itemscope"),d=(0,x.ln)("img",{itemscope:"",itemtype:s.T.emoji,itemid:r,src:(0,Y.rO)(r,n,t.coreSettings.get(p.J.Messaging),!1),title:a("title"),alt:c,style:`width:${i}px;height:${i}px;`});return o.N.DomUtils.appendChild(l,d),l}};X=(0,i.__decorate)([(0,a.wx)({name:"EmoticonSerializer",filter:{itemtype:s.T.emoji}})],X);let Z=class{transform(e){return o.N.DomUtils.getAttributeValue(e,r.zj.itemProps)&&delete e.attribs[r.zj.itemProps],e}};Z=(0,i.__decorate)([(0,a.wx)({name:"FluidEmbedSerializer",filter:{itemtype:s.T.fluidEmbedLink}})],Z);var ee=n(866789),te=n(139682);let ne=class{transform(e,t){const n=o.N.DomUtils.getAttributeValue(e,"href");if(!n||!e.attribs)return;const i=n.replace(/&amp;/g,"&");o.N.DomUtils.getAttributeValue(e,r.zj.itemProps)&&delete e.attribs[r.zj.itemProps];const a={appId:"fluid-card",cardClientId:(0,ee.Z)(),contentType:te.p.Fluid,content:JSON.stringify({componentUrl:i})};return t.messageProperties.cards=[a],t.files=void 0,e}};ne=(0,i.__decorate)([(0,a.wx)({name:"FluidSerializer",filter:{itemtype:s.T.fluidLink}})],ne);var ie=n(916561),ae=n(740755),oe=n(586768),re=n(899361),se=n(245349);let le=class{constructor(){this.getImageBlobUrlFromCache=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.offlineCacheManager.get(t),i=yield n.blob();return URL.createObjectURL(i)})),this.processCachedImage=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var n;const i=o.N.DomUtils.getAttributeValue(e,r.zj.cacheKey);if(!i)return void this._logger.error("Cached image missing key attribute.");this._logger.log(`processing cached image: ${i}`);const a=null===(n=this._scenarioFactory)||void 0===n?void 0:n.newScenario(y.RG.SerializeCachedImage);try{const n=o.N.DomUtils.getAttributeValue(e,"src"),s=!!(null==n?void 0:n.startsWith("blob"));let l;try{const e=yield t.offlineCacheManager.get(i);l=yield null==e?void 0:e.blob()}catch(e){l=null,this._logger.warn(`processCachedImage: Could not find cached image with key=${i} in offlineCacheManager`)}if(!l&&s&&n&&(l=yield(0,se.Hk)(n)),null===l)throw Error("Could not get image Blob neither from cache nor from blob data");null==a||a.mark(y.ck.SerializeCachedImageGotData);const c=yield this.uploadImage(l,t);if(ce(e,c,t),null==a||a.mark(y.ck.SerializeCachedImageUploadedData),"OfflineCache"!==c.uploadType){const n=yield t.offlineCacheManager.delete(i);null==a||a.mark(y.ck.SerializeCachedImageDeletedEntry,void 0,n?"success":"failure"),n||this._logger.warn(`Failed to delete cached image with key: ${i}`),e.attribs&&delete e.attribs[r.zj.cacheKey]}}catch(e){throw this._logger.error(`processCachedImage: Failed to process cached image with key=${i}`),null==a||a.fail(),e}finally{null==a||a.stop()}return e}))}transform(e,t){if(this._logger=t.loggerFactory.newLogger("InlineImageSerializer","services-io-browser-compose-serializer-extensions"),!this.isConfigValid(t))return this._logger.error("invalid config"),Promise.resolve(void 0);this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;let n=o.N.DomUtils.getAttributeValue(e,"src");const{enableImprovedImageHandling:i,enableComposeFrameworkV2:a,enableImageBlobConversionForMessageEdit:l}=this._settings.get(p.J.Messaging);if(!n)return this._logger.error("image src is missing"),Promise.resolve(void 0);if((i||l)&&a){const t=o.N.DomUtils.getAttributeValue(e,"data-orig-src");n=t&&(0,oe.KD)(t)?t:n}const c=(0,oe.KD)(n);if(c)return this.handleAmsSourceTag(c,e,t);return o.N.DomUtils.getAttributeValue(e,r.zj.itemtype)===s.T.cachedImage?this.processCachedImage(e,t):n.startsWith("http://")||n.startsWith("https://")?(0,re.kf)(n)?this.processKnownImage(n,t.telemetryDatabag):this.handleKnownProtcolSourceTag(n,"HttpUrl",e,t):n.startsWith("blob:")?this.handleKnownProtcolSourceTag(n,"BlobUrl",e,t):(this._logger.error("Unsupported image! deleting it."),Promise.resolve(null))}handleAmsSourceTag(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i="AMS",a=yield n.asyncMediaService.forwardContent(e,n.conversationId);return this._logger.log(`forwarded ams image ${e} to ${a.objectId}`),n.messageProperties.amsReferences=[...n.messageProperties.amsReferences||[],a.objectId],ce(t,Object.assign(Object.assign({},a),{uploadType:i}),n),t}catch(e){throw this._logger.error("handleAmsSourceTag: forward content failed!"),e}}))}handleKnownProtcolSourceTag(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield de(e,t,a),o=yield this.uploadImage(i,a);return ce(n,o,a),n}catch(e){throw this._logger.error("handleKnownProtcolSourceTag: pasted from web image upload failed"),this.addDiagnosticCodeToError(e),e}}))}uploadImage(e,t,n=!1){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.uploadImageToAms(e,t,this._logger)}catch(i){this._logger.error("uploadImage: image upload to AMS failed!");const{enableCacheStorageInSendMessageMW:a,msgEnableRestrictImagePasting:o}=this._settings.get(p.J.Messaging);if(!a||o||n)throw i;this._logger.debug("Trying to upload inline image to cache storage");return yield this.uploadToCache(e,t,this._logger)}}))}uploadImageToAms(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=t.asyncMediaService.createAmsScenario(y.RG.AmsImageUpload);try{const a="AMS",o=yield t.asyncMediaService.uploadItem(e,t.conversationId,"IMAGE","MicrosoftTeams-image.png",ae.r1.Inline);return n.log(`Uploaded image to ams, image: ${o.inlineSizeUrl} objectId: ${o.objectId}`),i.stop(),t.messageProperties.amsReferences=[...t.messageProperties.amsReferences||[],o.objectId],Object.assign(Object.assign({},o),{uploadType:a})}catch(e){throw i.fail({errors:e.message}),n.error("Ams image upload failed!"),e}}))}uploadToCache(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{n.log("uploading inline image to offline cache storage");const[i,a]=yield t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":e.type,"Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.size}`,Date:(new Date).toUTCString()})}));n.log(`Uploaded image to offline cache, image: ${a} objectId: ${i}`);const o="OfflineCache";t.messageProperties.offlineAssets=[...t.messageProperties.offlineAssets||[],i];return{objectId:i,inlineSizeUrl:yield this.getImageBlobUrlFromCache(t,i),uploadType:o}}catch(e){throw n.error("uploadToCache: uploading inline image to offline cache store failed!"),e}}))}isConfigValid(e){return!!(e&&e.asyncMediaService&&e.messageProperties&&e.imageProxyService&&e.conversationId&&e.telemetryDatabag&&e.offlineCacheManager)}processKnownImage(e,t){return e.endsWith(".gif")&&(t["DataBag.giphy"]=(t["DataBag.giphy"]||0)+1),Promise.resolve(void 0)}addDiagnosticCodeToError(e){if(e.serverResponse&&e.serverResponse.status){switch(e.serverResponse.status){case ie.qb.UNSUPPORTED_MEDIA_TYPE:e.reason=Object.assign(Object.assign({},e.reason),{errorCode:oe.hA.IMAGE_SIZE_TOO_LARGE})}}}};le=(0,i.__decorate)([(0,a.HR)({name:"InlineImageSerializer",filter:["img","image"]})],le);const ce=(e,t,n)=>{e.attribs||(e.attribs={}),e.attribs.id=t.objectId,e.attribs.itemid=t.objectId,e.attribs.href=t.inlineSizeUrl,e.attribs["target-src"]=t.inlineSizeUrl,e.attribs.src=t.inlineSizeUrl,e.attribs[r.zj.itemtype]="AMS"===t.uploadType?s.T.amsImage:s.T.cachedImage,n.telemetryDatabag["DataBag.inlineImages"]=(n.telemetryDatabag["DataBag.inlineImages"]||0)+1},de=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let i=null;return"BlobUrl"===t?i=yield(0,se.Hk)(e):"HttpUrl"===t&&(i=yield n.imageProxyService.getImageAsBlob(e)),i}));var ue=n(297055),me=n(193189),ge=n(214793),pe=n(684925),ve=n(10339),he=n(870444);const fe=/[a-z]+-[a-z]+/gi,ye=e=>{var t;return null!==(t=(0,he.LJ)(e).locale)&&void 0!==t?t:e};let be=class{transform(e,t){var n,a,o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this._logger=t.loggerFactory.newLogger("InlineVideoSerializer","services-io-browser-compose-serializer-extensions");const{enableInlineVideoMessageClosedCaptionsMultiLanguageSupport:i}=t.coreSettings.get(p.J.Messaging),s=t.scenarioFactory.newScenario(y.RG.InlineVideoAsyncTransform),{conversationId:l,videoMessageLieUpdater:c}=t;if(!(e&&e.attribs&&0!==Object.keys(e.attribs).length&&t.asyncMediaService&&t.offlineCacheManager&&c))return s.fail({errorCode:"unexpected_precondition"}),void(null===(a=(n=this._logger).errorToTelemetry)||void 0===a||a.call(n,`unexpected precondition : element - ${e}`,"messaging_inline_video_serializer_error_tracking",void 0,!0));this._offlineCacheManager=t.offlineCacheManager,this._asyncMediaService=t.asyncMediaService;const d=Se(e);if(!d)return s.fail({errorCode:"malformed_video_message"}),void(null===(r=(o=this._logger).errorToTelemetry)||void 0===r||r.call(o,`malformed video message: element - ${e}, additionalData - ${t}`,"messaging_inline_video_serializer_error_tracking",void 0,!0));s.appendEventData({correlationId:d.cacheKey});const u=yield this.resolveAMSItem(s,l,c,d);if(i){const e=t.scenarioFactory.newScenario(y.RG.VideoMessageTranscriptMetadataUpload);e.appendEventData({correlationId:d.cacheKey}),yield this.uploadTranscriptMetadata(e,u,t.i18n,d.cacheKey,c,d.transcriptUploadStatus),e.stop()}const m=t.scenarioFactory.newScenario(y.RG.VideoMessageThumbnailUpload);m.appendEventData({correlationId:d.cacheKey}),yield this.bestEffortUploadAMSVideoThumbnail(m,u,c,d),m.stop(),yield this.uploadAMSVideo(s,u,c,d),t.messageProperties.amsReferences=[...t.messageProperties.amsReferences||[],u];const g=this.createVideoMessageTag(e.attribs,d.src);return this.bestEffortCleanOfflineCacheManager(s,d.cacheKey,!!d.thumbnailUploadProgress),s.stop(),g}))}createVideoMessageTag(e,t){const n=(0,x.ln)("video",{src:t,itemscope:"",itemtype:s.T.amsVideo,"data-duration":e[r.zj.duration],width:e[r.zj.width],height:e[r.zj.height]});return n.children=[(0,x.rw)(me.R2)],n}resolveAMSItem(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield this.createAMSObjectIfRequired(e,t,n,a.cacheKey,a.src);return a.src=i.src,i.objectId}catch(t){throw e.fail({errorCode:"create_ams_object_failed"}),new Error(`create ams object failed:${t.toString()}`)}}))}createAMSObjectIfRequired(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!o){e.mark(y.ck.ItemCreationStart);const i=yield this._asyncMediaService.createVideoObject(t,a),o=(0,me.$N)(i.amsUrl,i.objectId);return this.bestEffortMessageLieUpdate(e,n,a,r.zj.src,o),e.mark(y.ck.ItemCreationStop),Object.assign(Object.assign({},i),{src:o})}e.mark(y.ck.UploadRetry);return{objectId:(0,oe.KD)(o),amsUrl:(0,ue.DW)(o),src:o}}))}bestEffortUploadAMSVideoThumbnail(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(a.thumbnailUploadProgress&&a.thumbnailUploadProgress.progress!==a.thumbnailUploadProgress.total)try{const i=yield this.uploadAMSVideoThumbnail(e,t,n,a.cacheKey);a.thumbnailUploadProgress=i}catch(t){this._logger.warn("video thumbnail upload failed",t),e.fail({errorCode:"thumbnail_upload_failed"})}}))}uploadAMSVideoThumbnail(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.mark(y.ck.ThumbnailUploadStart);const i=yield this._offlineCacheManager.get((0,ge.cQ)(a)),o=yield i.blob();yield this._asyncMediaService.uploadVideoThumbnail(t,o,a);const s={progress:o.size,total:o.size};return this.bestEffortMessageLieUpdate(e,n,a,r.zj.thumbnailUploadProgress,(0,me.tl)(s.progress,s.total)),e.mark(y.ck.ThumbnailUploadStop),s}))}uploadTranscriptMetadata(e,t,n,a,o,s){var l,c;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(s!==me.b3.success){const i=((e,t,n)=>{const i=new Set;e&&i.add(ye(e.toLowerCase())),t&&!i.has(t)&&i.add(ye(t.toLowerCase()));const a=n.map((e=>ye(e))).filter((e=>e.match(fe)));if(a)for(const e of a){if(i.size>=4)break;i.has(e.toLowerCase())||i.add(e.toLowerCase())}return[...i].slice(0,4).join(";")})(n.locale,null===(l=n.osLocaleInfo)||void 0===l?void 0:l.regionalFormat,[...(null===(c=(0,ve.J)())||void 0===c?void 0:c.navigator.languages)||[]]);try{e.mark(y.ck.TranscriptMetadataUploadStart,{message:i}),yield this._asyncMediaService.uploadTranscriptMetadata(t,i||"en-us",a),this.bestEffortMessageLieUpdate(e,o,a,r.zj.transcriptUploadStatus,me.b3.success),e.mark(y.ck.TranscriptMetadataUploadStop)}catch(t){e.fail({errorCode:"video_transcript_metadata_upload_failed"}),this.bestEffortMessageLieUpdate(e,o,a,r.zj.transcriptUploadStatus,me.b3.failure)}}}))}uploadAMSVideo(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{e.mark(y.ck.VideoUploadStart);const i=yield this._offlineCacheManager.get((0,ge.If)(a.cacheKey)),o=yield i.blob();yield this._asyncMediaService.uploadVideo(t,a.uploadProgress.progress,o,this.updateMessageLieVideoUploadProgress(e,n,a),a.cacheKey),e.mark(y.ck.VideoUploadStop)}catch(t){throw e.fail({errorCode:"video_upload_failed"}),new Error(`video upload failed:${t.toString()}`)}}))}bestEffortCleanOfflineCacheManager(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{yield this._offlineCacheManager.delete((0,ge.If)(t))}catch(t){this._logger.warn("video cache cleanup failed",t),e.mark(y.ck.VideoCacheCleanFailed)}try{n&&(yield this._offlineCacheManager.delete((0,ge.cQ)(t)))}catch(t){this._logger.warn("thumbnail cache cleanup failed",t),e.mark(y.ck.ThumbnailCacheCleanFailed)}}))}updateMessageLieVideoUploadProgress(e,t,n){return i=>{const a=i+1;n.uploadProgress.progress=a,this.bestEffortMessageLieUpdate(e,t,n.cacheKey,r.zj.uploadProgress,(0,me.tl)(n.uploadProgress.progress,n.uploadProgress.total))}}bestEffortMessageLieUpdate(e,t,n,i,a){try{t(n,i,a)}catch(t){e.mark(y.ck.MessageLieUpdateFailed),this._logger.warn(t.toString())}}};be=(0,i.__decorate)([(0,a.HR)({name:"InlineVideo",filter:[{itemtype:s.T.amsVideo}]})],be);const Se=e=>{const t=o.N.DomUtils.getAttributeValue,n=t(e,r.zj.itemtype),i=t(e,r.zj.cacheKey),a=t(e,r.zj.src),s=t(e,r.zj.transcriptUploadStatus),l=t(e,r.zj.uploadProgress),c=t(e,r.zj.thumbnailUploadProgress),d=t(e,r.zj.duration),u=t(e,r.zj.width),m=t(e,r.zj.height);if(!n||!i||!l||!u||!m||!d||Number.isNaN(u)||Number.isNaN(m)||!(0,me.cJ)(l))return;const g={itemType:n,cacheKey:i,uploadProgress:(0,me.VI)(l),width:+u,height:+m,duration:+(0,pe.J)(d),transcriptUploadStatus:s||me.b3.pending};return a&&(g.src=a),c&&(g.thumbnailUploadProgress=(0,me.VI)(c)),g};var ke=n(941039);const we=(e,t,n)=>{e.forEach((e=>Ce(e,t,n)))},Ce=(e,t,n)=>{(0,ke.gU)(e,{type:"TextBlock"},(e=>{_e(e.text,t,n)})),(0,ke.gU)(e,{type:"FactSet"},(e=>{e.facts.forEach((e=>{_e(e.title,t,n),_e(e.value,t,n)}))}))},_e=(e,t,n)=>{const i=e.toLowerCase(),a='itemid="',o=i.indexOf(a),r=o+a.length;if(o>-1){const a=i.substring(r,r+1);if(t&&a){const i=Te(a,t,n);i&&(e=e.replace(new RegExp(a,"g"),i))}}},Te=(e,t,n)=>{let i="";return t.forEach((t=>{if(t.itemId===e){const{messageProperties:e,telemetryDatabag:a}=n;e.mentions||(e.mentions=[]),i=`${e.mentions.length}`;const o=t.displayName||"",r=t.mentionType||"",s=t.userId||"";a["DataBag.atmentions"]=(a["DataBag.atmentions"]||0)+1,e.mentions.push({itemId:i,displayName:o,userId:s,mentionType:r})}})),i};var Ie=n(399330);let Ee=class{transform(e,t){if(!e||!t||!t.messageProperties)return;const{loggerFactory:n,coreSettings:a}=t,r=a.get(p.J.Extensibility).enableJITInstallForACv2FromComposeV2||!1,c=n.newLogger("MessageExtensionCardSerializer","services-io-browser-compose-serializer-extensions"),d=(0,l.unescape)(o.N.DomUtils.getAttributeValue(e,$.Qq)),u=o.N.DomUtils.getAttributeValue(e,$.fK);if(!d)return c.error("The props was missing"),null;if(!u)return c.error("The id of the card was missing"),null;try{const n=t.messageProperties.cards||[],{card:a,renderJitInstallConsentFooter:c}=JSON.parse(d);if(!(0,l.isObject)(a))throw new Error("not valid JSON object");(0,l.isString)(a.contentType)&&a.contentType.toLowerCase()===Ie.s.Adaptive&&a.content&&((e,t)=>{const n=JSON.parse(e),i=n.body,a=(0,ke.NI)(n);a&&i&&we(i,a,t)})(a.content,t);const{__typename:m}=a,g=(0,i.__rest)(a,["__typename"]);g.cardClientId=u,t.messageProperties.cards=[...n,g];const p=o.N.DomUtils.getElements({"data-tid":"jit-install-consent-footer"},e);(r?!!c:!(0,l.isEmpty)(p))&&(t.messageProperties.appIdsToInstall=(0,l.union)(t.messageProperties.appIdsToInstall,[a.appId]));const v=(0,x.ln)("span",{content:u,itemprop:"cardId"}),h=(0,x.ln)("span",{class:"inline-compose-card",itemid:u,itemscope:"",itemtype:s.T.inputExtension});return o.N.DomUtils.appendChild(h,v),h}catch(e){return c.error("Error while adding message extension card to message",e),null}}};Ee=(0,i.__decorate)([(0,a.wx)({name:"MessageExtension",filter:{[$.$S]:"MessageExtensionCard"}})],Ee);var Ne=n(494326);let Ae=class{constructor(){}transform(e,t){const{loggerFactory:n}=t;if(!e)return;const i=(0,l.unescape)(o.N.DomUtils.getAttributeValue(e,$.Qq));if(!i)return;const a=(0,Ne.D)(i);if((0,l.isEmpty)(a))return void n.newLogger("QuotedReplySerializer","services-io-browser-compose-serializer-extensions").error("Json parsing failed: ",i);const{from:r,messageId:c,preview:d,timestamp:u,userName:m}=a;if(!(r&&c&&d&&m))return void n.newLogger("QuotedReplySerializer","services-io-browser-compose-serializer-extensions").error("Json parsing failed: ",i);const g=(0,x.ln)("blockquote",{itemscope:"",itemtype:s.T.reply,itemid:c}),p=(0,x.ln)("strong",{itemprop:"mri",itemid:r}),v=(0,x.rw)((0,l.escape)(m));if(o.N.DomUtils.appendChild(p,v),o.N.DomUtils.appendChild(g,p),u){const e=(0,x.ln)("span",{itemprop:"time",itemid:u.toString()});o.N.DomUtils.appendChild(g,e)}const h=(0,x.ln)("p",{itemprop:"preview"}),f=(0,x.rw)((0,l.escape)(d));return o.N.DomUtils.appendChild(h,f),o.N.DomUtils.appendChild(g,h),g}};Ae=(0,i.__decorate)([(0,a.wx)({name:"QuotedReply",filter:{[$.$S]:"QuotedReplyCard"}}),(0,i.__metadata)("design:paramtypes",[])],Ae);let Fe=class{transform(e){return(0,l.isEmpty)(e.children)&&o.N.DomUtils.appendChild(e,(0,x.rw)(" ")),e}};Fe=(0,i.__decorate)([(0,a.wx)({name:"TableCellSerializer",filter:"td",transient:!0})],Fe);let De=class{transform(e){return e.attribs.class="copy-paste-table",e.attribs.itemprop="copy-paste-table",e}};De=(0,i.__decorate)([(0,a.wx)({name:"TableSerializer",filter:"table",transient:!0})],De);var Re=n(471285);let xe=class{transform(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=t.coreSettings.get(p.J.Extensibility).postSendTimeoutInMs||2e3,{areUrlPreviewsAllowed:i}=t.coreSettings.get(p.J.Messaging);if(!!!i||!t.connectedExperienceEnabled||!e||!t.messageProperties||t.messageProperties.urlPreview||!t.urlPreviewService||!t.appBasedLinkService||!o.N.DomUtils.hasAttrib(e,"href"))return;const a=t.loggerFactory.newLogger("UrlPreviewSerializer","services-io-browser-compose-serializer-extensions"),r=e.attribs.href||"",s=[this.getUrlPreviewFromAppTimed(r,n,t,a),this.getUrlPreviewTimed(r,n,t,a)],[l,c]=yield Promise.all(s),d=l||c&&Pe(c);return d?(t.messageProperties.urlPreview=d,e):void 0}))}getUrlPreviewFromAppTimed(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableAppBasedLink:i}=n.coreSettings.get(p.J.Extensibility);if(!i)return Promise.resolve(void 0);if(Me(e))return;const o=n.scenarioFactory.newScenario(y.RG.ExtGetAppPreviewPostSend),r=n.getInstalledMessageExtensionApps(),s="post send app preview timed out";try{const i=yield(0,c.E)(n.appBasedLinkService.getUrlPreviewFromApp(e,r,n.getAppDefinitions,o,n.convId),t,s);return o.stop(),i}catch(t){return Oe(t)&&t.code===Re.jK.TimedOut&&t.context===Re.w5.Timed?o.incomplete({errors:s}):o.fail(),void a.warn(`fetching app preview for url: ${e} failed with error: ${t}`)}}))}getUrlPreviewTimed(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!Me(e))try{return yield(0,c.E)(n.urlPreviewService.getPreview(e),t,"url preview timed out")}catch(t){return void a.warn(`fetching url preview for url: ${e} failed with error: ${t}`)}}))}};xe=(0,i.__decorate)([(0,a.HR)({name:"URLPreviewSerializer",filter:"a",transient:!0})],xe);const Me=e=>e.includes("teams")&&e.includes("/l/message/")&&e.includes("chat"),Oe=e=>!!(e&&((0,l.get)(e,"code")&&(0,l.get)(e,"context")||(0,l.get)(e,"reason"))),Pe=e=>({url:e.url,title:e.title,description:e.description,previewEnabled:!0,thumbnail:e.thumbnail,thumbnailMeta:e.thumbnail_meta});var Le=n(531143),Ue=n(988358);let je=class{transform(e,t){if(!e||!o.N.DomUtils.hasAttrib(e,r.zj.itemid))return;const n=(0,x.ln)(R.s.span),i=(0,x.rw)((0,x.Q)(e));o.N.DomUtils.appendChild(n,i);const a=o.N.DomUtils.getAttributeValue(e,r.zj.itemid)||"",l=(0,Le.I6)({userAadObjectId:t.authenticationUser.profile.objectId,tenantAadObjectId:t.authenticationUser.profile.tenantId});return null==l||l.logEvent(Ue.z.ManualTagSend,{topicId:a,isTopicNameNumeric:!isNaN(parseFloat(this._getTopicName(e))),contextId:t.convId}),n.attribs[r.zj.itemtype]=s.T.topic,n.attribs[r.zj.itemid]=a,n}_getTopicName(e){const t=(0,x.Q)(e);return t.startsWith("#")?t.substring(1):t}};je=(0,i.__decorate)([(0,a.wx)({name:"TopicSerializer",filter:"topic"})],je);var $e=n(324175);const Be=[$e.TV,$e.Hl];let We=class{constructor(){}transform(e){var t,n,i;if(e&&(null===(t=e.children)||void 0===t?void 0:t.length)){const t=(0,x.kE)(e.children)[0],a=null===(n=null==e?void 0:e.prev)||void 0===n?void 0:n.attribs[$.$S],o=null===(i=null==e?void 0:e.next)||void 0===i?void 0:i.attribs[$.$S];let r=$e.sb;return(a&&Be.includes(a)||o&&Be.includes(o))&&(r=$e.ST),t.attribs={itemtype:r,[$.$S]:null==e?void 0:e.attribs[$.$S]},t}}};We=(0,i.__decorate)([(0,a.wx)({name:"InlineImageCardsSerializer",filter:[{[$.$S]:$e.TV},{[$.$S]:$e.Hl}]}),(0,i.__metadata)("design:paramtypes",[])],We);let He=class{transform(e,t){const{messageProperties:n,coreSettings:i,conversationMembers:a}=t,{m365ChatBotIds:c,copilotBotDataVersion:d}=i.get(p.J.Messaging);if(!(Ve(c,a,n,d)&&e&&t&&t.messageProperties&&o.N.DomUtils.hasAttrib(e,r.zj.itemtype)))return;const u=o.N.DomUtils.getAttributeValue(e,r.zj.itemtype);if(u!==s.T.editorCiqFile&&u!==s.T.editorCiqPeople&&u!==s.T.editorCiqMeeting)return;const m=o.N.DomUtils.getAttributeValue(e,r.zj.itemProps);return m&&ze((0,l.unescape)(m),n,null!=d?d:Je,u),e}};He=(0,i.__decorate)([(0,a.wx)({name:"CopilotSerializer",filter:"*"})],He);const Ve=(e,t,n,i)=>{var a,o;const r=null!==(a=null==t?void 0:t.filter((e=>null==e?void 0:e.startsWith("28:"))))&&void 0!==a?a:[];let s=!1;if(1===(null==r?void 0:r.length)&&e){const t=e.indexOf(r[0]);void 0!==t&&(s=t>-1)}let l=null===(o=n.mentions)||void 0===o?void 0:o.find((e=>e.mentionType===Ge));return s&&!l&&(l={itemId:"0",userId:"3209c41b-0e5c-45cb-b72e-68dcecbaa23d",mentionType:Ge,displayName:JSON.stringify({copilotBotDataVersion:null!=i?i:"1.0",files:[],people:[],meetings:[]})},n.mentions=[l]),s},ze=(e,t,n,i)=>{var a;let o=null===(a=t.mentions)||void 0===a?void 0:a.find((e=>e.mentionType===Ge));o||(o={itemId:"0",userId:"3209c41b-0e5c-45cb-b72e-68dcecbaa23d",mentionType:Ge,displayName:JSON.stringify({copilotBotDataVersion:"1.0",files:[],people:[],meetings:[]})});const r=JSON.parse(o.displayName),l=r.files,c=r.people,d=r.meetings;let u;try{u=JSON.parse(qe(qe(e)))}catch(e){return}i===s.T.editorCiqFile&&l.push(u),i===s.T.editorCiqPeople&&c.push(u),i===s.T.editorCiqMeeting&&d.push(u);const m={copilotBotDataVersion:n||r.CopilotBotDataVersion,files:l,people:c,meetings:d};o.displayName=JSON.stringify(m),t.mentions=[o]},qe=e=>e?e.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;/g,"&"):"",Ge="Copilot",Je="1.0",Qe=[P],Ke=[B,j,J.D,P,He,je,Fe,De,X,K,V,q,ne,Z,Ee,Ae,We],Ye=[le,G.O,xe,b,be],Xe=[U]},263436:(e,t,n)=>{"use strict";n.d(t,{x:()=>r,B:()=>s});var i=n(859741),a=n(438985);const o=new RegExp(i.Uu),r=e=>o.test(a.N.DomUtils.getAttributeValue(e,"class")||""),s=(e,t="")=>{const n=`max-height: ${i.hE}px; max-width: ${i.hE}px; height: ${i.hE}px; width: ${i.hE}px`;return`<img class="${i.Uu}" alt="${t}" src="${e}" width="${i.hE}" height="${i.hE}" style="${n}"/>`}},973737:(e,t,n)=>{"use strict";n.d(t,{q8:()=>c,dR:()=>d,Zl:()=>u});var i=n(361366),a=n(10339),o=n(786884),r=n(471285),s=n(343324);const l="Browser does not support IndexedDB APIs";function c(e,t,n,c,d,u){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;const g=(0,a.J)().indexedDB;return new Promise(((a,p)=>{const v=d.newScenario(s.RG.IndexedDBFetch);v.appendEventData({dataSource:n});try{g||p((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,l)),i=g.open(e,t),i.onerror=()=>{p((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,"Error in indexedDB open request"))},i.onupgradeneeded=e=>{m(t,n,c,i,e,a,p,v)},i.onsuccess=function(e,t,n,i,a,s,l){return()=>{try{const c=e.result,d=c.transaction([t]).objectStore(t),u=l?d.getAll():d.get(n);u.onsuccess=e=>{c.close(),i.stop();const t=e.target.result;a(l?t:t&&(t.value||u.result))},u.onerror=()=>{c.close(),i.fail(),s((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,"Error trying to get chat service sync end point from indexedDB"))}}catch(e){i.fail(),s((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,`Failed to read from '${t}' object store on the indexedDB.`))}}}(i,n,c,v,a,p,u)}catch(e){v.fail({errors:e.message}),p(e)}}))}))}function d(e,t,n,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){{let i;const c=(0,a.J)().indexedDB;return new Promise(((a,d)=>{const u=r.newScenario(s.RG.IndexedDBDelete);u.appendEventData({dataSource:n});try{c||d(new Error(l)),i=c.open(e,t),i.onerror=()=>{d(new Error(l)),u.fail({errors:l})},i.onsuccess=()=>{!function(e,t,n,i,a){try{const o=e.result,r=o.transaction([t],"readwrite"),s=r.objectStore(t).clear();s.onsuccess=e=>{o.close(),n.stop(),i(e.target.result)},s.onerror=e=>{o.close(),n.fail(),a(`Error trying to delete data from indexedDB: ${e}`)}}catch(e){n.fail(),a(`Error trying to delete data from indexedDB: ${e}`)}}(i,n,u,a,d)},i.onupgradeneeded=e=>{m(t,n,o,i,e,a,d,u)}}catch(e){u.fail({errors:e.message}),d(e)}}))}}))}function u(e,t,n,o,r,c){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;const d=(0,a.J)().indexedDB;return new Promise(((a,u)=>{const g=c.newScenario(s.RG.IndexedDBWrite);g.appendEventData({dataSource:n});try{d||u(new Error(l)),i=d.open(e,t),i.onerror=()=>{u(new Error(l)),g.fail({errors:l})},i.onsuccess=()=>{!function(e,t,n,i,a,o){try{const r=e.result,s=r.transaction([t],"readwrite").objectStore(t);let l;n.forEach((e=>{l=s.put(e),l.onsuccess=e=>{r.close(),i.stop(),a(e.target.result.value)},l.onerror=e=>{r.close(),i.fail(),o(`Error trying to write into indexedDB: ${e}`)}}))}catch(e){i.fail(),o(`Error trying to write into indexedDB: ${e}`)}}(i,n,r,g,a,u)},i.onupgradeneeded=e=>{m(t,n,o,i,e,a,u,g)}}catch(e){g.fail({errors:e.message}),u(e)}}))}))}function m(e,t,n,i,a,o,r,l){try{a.oldVersion<e&&i.result.createObjectStore(t,{keyPath:n}),l.mark(s.ck.IndexedDBUpgrade),o()}catch(e){l.fail(),r(`Failed to create object stores on the indexedDB: ${e}`)}}},612778:(e,t,n)=>{"use strict";n.d(t,{N:()=>l});var i=n(361366),a=n(47135),o=n(561776),r=n(980402),s=n(65903);class l{constructor(e,t,n,i,a,o){this.logsCollectorService=t,this.coreSettings=n,this.hostCommunicationService=i,this.entityCommanding=a,this.i18n=o,this.defaultLogsFilesDownloadDelayIntervalMs=333,this.defaultLogsFileUploadTimer=15e3,this.logger=e.newLogger("LogsFilesService","services-io-browser-logs-files")}downloadLogsFiles(e,t=!0,n){var o,r,s,l;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.showBanner();let c=!0,d=this.defaultLogsFilesDownloadDelayIntervalMs;if(this.coreSettings){const e=this.coreSettings.get(a.J.Diagnostics);c=e.enableLogsFilesDownload||!1,d=e.logsFilesDownloadDelayIntervalMs||this.defaultLogsFilesDownloadDelayIntervalMs}if(!c)return this.logger.error(`Unabled to download logs files - logs files download is not enabled: ${c}`),!1;if(!e)return this.logger.error(`Unabled to download logs files - no host present: ${e}`),!1;const u=this.hostCommunicationService&&n;let m=0;const g=yield this.logsCollectorService.callOnLogsFiles((t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){let a;const o=new Promise((o=>{a=e.setTimeout((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=u?yield this.uploadLogsFileToVirtualServer(t,e,n,!1):yield this.downloadLogsFile(t,e);o(i)}))),m*d)})).then((t=>(void 0!==a&&e.clearTimeout(a),t)));return m++,o}))),t);if(g){if(u){const e=yield null===(s=this.hostCommunicationService)||void 0===s?void 0:s.loadModule("logscollection");null===(l=null==e?void 0:e.webLogsDownloadCompleted)||void 0===l||l.call(e,{webLogsId:n})}}else{if(u)return null===(r=(o=this.logger).errorToTelemetry)||void 0===r||r.call(o,"Failed to upload all logs files to virtual server","logs_downloading"),this.downloadLogsFiles(e,!0);this.logger.error("Failed to download all logs files")}return g}))}setBannerRelatedServices(e,t){this.entityCommanding=e,this.i18n=t}downloadLogsFile(e,t){let n,i="";try{let a;a="string"==typeof e.content?new Blob([null==e?void 0:e.content],{type:"text/plain;charset=utf-8"}):e.content,i=URL.createObjectURL(a);const o=t.document.createElement("a");o.setAttribute("href",i),o.setAttribute("download",null==e?void 0:e.fileName),o.click(),o.remove(),n=!0}catch(t){this.logger.error(`Failed to download logs file ${null==e?void 0:e.fileName} - error:`,t),n=!1}return i&&URL.revokeObjectURL&&URL.revokeObjectURL(i),Promise.resolve(n)}uploadLogsFileToVirtualServer(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i=!1;try{const o=`${t.location.origin}/desktop/upload/log-collector/${n}/${e.fileName}`,s=t.fetch(o,{method:"PUT",headers:{"Content-Type":"text/plain"},body:e.content}),l=yield(0,r.E)(s,this.defaultLogsFileUploadTimer);l.ok?i=!0:this.logger.error(`Failed to upload logs file to virtual server - ${null==e?void 0:e.fileName}, isRetry - ${a}, status - ${l.statusText}`)}catch(t){this.logger.error(`Failed to upload logs file to virtual server - ${null==e?void 0:e.fileName}, - isRetry- ${a}, - in ${this.defaultLogsFileUploadTimer} ms, - error:`,t)}return i||a?Promise.resolve(i):this.uploadLogsFileToVirtualServer(e,t,n,!0)}))}showBanner(){var e,t;try{this.entityCommanding&&this.i18n&&this.entityCommanding.shell.showBanner({id:"downloading_weblogs",source:o.D.LogsDownloading,bannerScenario:"downloading_Weblogs",intentLevel:s.XuV.Neutral,duration:10,text:this.i18n.stringTranslate("framework","downloading_weblogs")})}catch(n){null===(t=(e=this.logger).errorNoPii)||void 0===t||t.call(e,"Showing downloading logs banner failed")}}}},429071:(e,t,n)=>{"use strict";n.d(t,{XD:()=>r,jW:()=>s,F$:()=>l,OB:()=>c,bF:()=>d});var i=n(361366),a=n(65903),o=n(882975);const r=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{data:t}=yield e.query({query:o.i8});return null==t?void 0:t.activeWindows})),s=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield r(e);return null==t?void 0:t.find((e=>e.isMainWindow&&e.layoutConfig.layoutMode===a.lOW.standard))})),l=e=>{try{const t=e.readQuery({query:o.i8});return null==t?void 0:t.activeWindows}catch(e){return}},c=e=>e.watchQuery({query:o.i8}),d=(e,t)=>{try{return e.writeQuery({query:o.i8,data:{activeWindows:t}}),!0}catch(e){return!1}}},133332:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ServicesIoDataActiveWindowsSaveReactiveVarsToHistoryMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveReactiveVarsToHistory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"appIds"},value:{kind:"Variable",name:{kind:"Name",value:"appIds"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},882975:(e,t,n)=>{"use strict";n.d(t,{i8:()=>c});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowOptions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"}}]}},{kind:"Field",name:{kind:"Name",value:"linkedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_linkedEntity"}}]}},{kind:"Field",name:{kind:"Name",value:"entityState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"flushableByLinkedEntity"}}]}}]}},...i.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_linkedEntity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LinkedEntity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}.definitions]},o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_window"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"clientLaunchId"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"blockingEntityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"blockedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"blockedCommand"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibilityState"}},{kind:"Field",name:{kind:"Name",value:"stateTransition"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"blockedEntityOptions"}}]}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"isNotificationsWindow"}},{kind:"Field",name:{kind:"Name",value:"isInitialWindowStateHidden"}},{kind:"Field",name:{kind:"Name",value:"userContextId"}},{kind:"Field",name:{kind:"Name",value:"layoutConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"layoutMode"}},{kind:"Field",name:{kind:"Name",value:"isFullscreen"}},{kind:"Field",name:{kind:"Name",value:"slots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contextualNotifications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"header"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"end"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"main"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"monitor"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"nav"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"notifications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"start"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"subNav"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"titleBar"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"toasts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}}]}}]}}]}},...a.definitions]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActiveEntities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"monitorEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}}]}},...a.definitions]},s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"reactiveVars"}}]}},...r.definitions]},l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"windowHistoryNavigationState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canNavigateBack"}},{kind:"Field",name:{kind:"Name",value:"canNavigateForward"}},{kind:"Field",name:{kind:"Name",value:"backHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"}}]}},{kind:"Field",name:{kind:"Name",value:"forwardHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryNavigationItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowHistoryIndex"}},{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}}]}},...a.definitions]}.definitions]},c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataActiveWindowsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeWindows"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeWindows"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_window"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"windowHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryItem"}}]}},{kind:"Field",name:{kind:"Name",value:"currentWindowHistoryIndex"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationState"}}]}},...i.definitions,...o.definitions,...r.definitions,...s.definitions,...l.definitions]}.definitions]}},54714:(e,t,n)=>{"use strict";n.d(t,{x:()=>k});var i,a=n(361366),o=n(197981);!function(e){e.Info="Info",e.Warning="Warning",e.Error="Error",e.Debug="Debug"}(i||(i={}));var r=n(794781),s=n(561776),l=n(47135),c=n(65903),d=n(533207);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationUserQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"defaultName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}},{kind:"Argument",name:{kind:"Name",value:"defaultName"},value:{kind:"Variable",name:{kind:"Name",value:"defaultName"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}}]}}]}}]},m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationGetUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriOrEmailArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"emailForQuery"}}]}}]}}]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationPresenceSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"lastSeenAt"}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationPresencesQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userPresenceRequestArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPresenceRequest"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presences"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userPresenceRequestArray"},value:{kind:"Variable",name:{kind:"Name",value:"userPresenceRequestArray"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"lastSeenAt"}}]}}]}}]},v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationFireCallingIntentMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationUserCallingSettingsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userCallingSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isCallingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isPstnCallingAllowed"}}]}}]}}]};var f,y;!function(e){e[e.UnInitialized=0]="UnInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(f||(f={})),function(e){e.FreDialogDisplayedKey="office-integration-fre-dialog-displayed",e.HasManuallyUnregisteredIMProviderKey="office-integration-has-manually-unregistered"}(y||(y={}));const b="sip:",S=new Map([["InACall","OnThePhone"],["InAConferenceCall","InAMeeting"],["InAMeeting","InAMeeting"],["Presenting","Presenting"],["OffWork","Offline"],["Available","Online"],["Inactive","Idle"],["Busy","Busy"],["DoNotDisturb","Focusing"],["BeRightBack","BeRightBack"],["Away","Away"],["Offline","Offline"],["UrgentInterruptionsOnly","Focusing"],["PresenceUnknown","Unknown"],["OutOfOffice","OutOfOffice"]]);class k{static Instance(e,t,n,i,a,o,r,s){return k.instance||(k.instance=new k(e,t,n,i,a,o,r,s)),k.instance}static defaultInstance(){return k.instance}constructor(e,t,n,i,a,o,l,d){this.hostCommunicationService=e,this.coreSettings=t,this.client=n,this.entityCommanding=a,this.windowProvider=o,this.localStorage=l,this.authenticationUser=d,this.initializedState=f.UnInitialized,this.unsubscribers=[],this.entityCommand={stateTransition:r.su.none,visibilityState:r.fe.show,correlation:{source:s.D.OfficeIntegration}},this.presenceSubscriptionMap=new Map,this.uriToMriCacheMap=new Map,this.selfMri="",this.selfActivity=c.cS$.PresenceUnknown,this.logger=i.newLogger("OfficeIntegration","services-io-data-office-integration")}initialize(){var e,t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(l.J.People).enableOfficeIntegration)return!1;if(this.initializedState!==f.UnInitialized)return!1;this.initializedState=f.Initializing;const n=yield this.hostCommunicationService.loadModule("officeintegration");if(n){const{isRegistered:a,isAdminAccessRequired:o,isUacEnabled:r}=(yield null===(e=n.isRegisteredIMProvider)||void 0===e?void 0:e.call(n))||{};if(this.logger.log(`initialize isRegistered ${a} isAdminAccessRequired ${o} isUacEnabled ${r}`),a)return this.startService(n);if(o&&r)this.startOfficeIntegrationFREDialog();else if(o||this.isLocalStoragePropertySet(y.HasManuallyUnregisteredIMProviderKey)){const e=`Failed to register due to isAdminAccessRequired ${o} isUacEnabled \n          ${r} HasManuallyUnregisteredIMProviderKey ${this.isLocalStoragePropertySet(y.HasManuallyUnregisteredIMProviderKey)}`;this.handleLogToTelemetry(e,"office_integration_register_im_provider",i.Warning)}else{const e=yield null===(t=n.registerIMProvider)||void 0===t?void 0:t.call(n,!1,!!r);if(0===e)return this.startService(n);{const t=`Failed to register during silent registration with result ${e}`;this.handleLogToTelemetry(t,"office_integration_register_im_provider",i.Warning,{errorCode:null==e?void 0:e.toString(16)})}}return!1}return!1}))}finalize(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(l.J.People).enableOfficeIntegration)return!1;if(this.initializedState!==f.Initializing)return!1;const t=yield this.hostCommunicationService.loadModule("officeintegration");if(t){const{isRegistered:n}=(yield null===(e=t.isRegisteredIMProvider)||void 0===e?void 0:e.call(t))||{};if(n)return this.startService(t);const a="finalize is called without IM provider registered";return this.handleLogToTelemetry(a,"office_integration_fre_register_finalize_failed",i.Warning),!1}return!1}))}shutdown(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.initializedState!==f.Initialized)return!1;this.initializedState=f.UnInitialized,this.unsubscribers.forEach((e=>e()));const t=yield this.hostCommunicationService.loadModule("officeintegration");if(t){return!!(null===(e=t.stopComServer)||void 0===e?void 0:e.call(t))}return!1}))}isRegisteredIMProvider(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("officeintegration");return null===(e=null==t?void 0:t.isRegisteredIMProvider)||void 0===e?void 0:e.call(t)}))}registerIMProvider(e,t,n){var o;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const a=yield this.hostCommunicationService.loadModule("officeintegration");if(a){const r=yield null===(o=a.registerIMProvider)||void 0===o?void 0:o.call(a,e,t),s=`registerIMProvider result ${r} from ${n}. isAdminAccessRequired ${e} isUacEnabled ${t}`;return this.handleLogToTelemetry(s,"office_integration_register_im_provider",i.Info,{errorCode:null==r?void 0:r.toString(16)}),0===r}return!1}))}unregisterIMProvider(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("officeintegration");if(n){const a=yield null===(t=n.unregisterIMProvider)||void 0===t?void 0:t.call(n),o=`unregisterIMProvider result ${a} from ${e}`;return this.handleLogToTelemetry(o,"office_integration_unregister_im_provider",i.Info,{errorCode:null==a?void 0:a.toString(16)}),0===a}return!1}))}toggleIMProvider(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{isRegistered:t,isAdminAccessRequired:n,isUacEnabled:i}=(yield this.isRegisteredIMProvider())||{};if(t){this.setLocalStorageProperty(y.HasManuallyUnregisteredIMProviderKey,"true");const t=yield this.unregisterIMProvider(e);return yield this.waitForRegistryUpdate(),t}if(yield this.registerIMProvider(!!n,!!i,e)){const e=yield this.hostCommunicationService.loadModule("officeintegration");return!!e&&(this.startService(e),yield this.waitForRegistryUpdate(),!0)}return!1}))}waitForRegistryUpdate(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){let e;yield new Promise((t=>{e=this.windowProvider.setTimeout(t,250)})),this.windowProvider.clearTimeout(e)}))}isLocalStoragePropertySet(e){var t;return"true"===(null===(t=this.localStorage)||void 0===t?void 0:t.get(e))}setLocalStorageProperty(e,t){var n;null===(n=this.localStorage)||void 0===n||n.set(e,t)}startService(e){var t,n,i,o,r,s,l,c,d;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.initializedState===f.Initialized)return!1;let a;this.initializedState=f.Initialized,a=null===(t=e.registerForStartChat)||void 0===t?void 0:t.call(e,(e=>this.handleStartChat(e))),a&&this.unsubscribers.push(a),a=null===(n=e.registerForStartCall)||void 0===n?void 0:n.call(e,((e,t,n)=>this.handleStartCall(e,t,n))),a&&this.unsubscribers.push(a),a=null===(i=e.registerForTrackPresence)||void 0===i?void 0:i.call(e,(e=>this.handleTrackPresence(e))),a&&this.unsubscribers.push(a),a=null===(o=e.registerForUntrackPresence)||void 0===o?void 0:o.call(e,(e=>this.handleUntrackPresence(e))),a&&this.unsubscribers.push(a),a=null===(r=e.registerForLogStatement)||void 0===r?void 0:r.call(e,((e,t)=>this.handleLogStatement(e,t))),a&&this.unsubscribers.push(a);const m=(null===(s=this.authenticationUser)||void 0===s?void 0:s.loginUserName)||"",{data:g}=yield this.client.query({query:u,variables:{userId:m,isMailAddress:!0},context:{callerInfo:"office-integration-start"}}),p=null==g?void 0:g.user;if(p){const e=null===(l=p.userPrincipalName)||void 0===l?void 0:l.toLowerCase(),t=null===(c=p.email)||void 0===c?void 0:c.toLowerCase();p.mri&&(this.selfMri=p.mri,e&&this.uriToMriCacheMap.set(e,p.mri),t&&t!==e&&this.uriToMriCacheMap.set(t,p.mri))}return!!(yield null===(d=e.startComServer)||void 0===d?void 0:d.call(e,(null==p?void 0:p.userPrincipalName)||m))}))}startOfficeIntegrationFREDialog(){if(this.isLocalStoragePropertySet(y.FreDialogDisplayedKey))this.logger.log("Skipping FRE as it has already been displayed for user");else{this.entityCommanding.shell.openFreDialog(this.entityCommand),this.setLocalStorageProperty(y.FreDialogDisplayedKey,"true");const e="Start office integration FRE through user dialog registration";this.handleLogToTelemetry(e,"office_integration_fre_register_dialog",i.Info)}}notifyPresence(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("officeintegration");return null===(t=null==n?void 0:n.notifyPresence)||void 0===t?void 0:t.call(n,e)}))}convertLastSeenAt(e){if(e){return new Date(e).getTime()}}notifyInitialPresence(e,t){const n=[];e.presences.forEach((e=>{const i=c.cS$[e.activity||c.cS$.PresenceUnknown];e.id===this.selfMri&&e.activity&&(this.selfActivity=e.activity),n.push({id:e.id,requestedUri:t.get(e.id)||"",status:S.get(i)||i,lastSeenAt:this.convertLastSeenAt(e.lastSeenAt)})})),this.notifyPresence(n)}handleTrackPresence(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.mapUrisToMris(e),n=[],i=new Map;if(e.forEach((e=>{const a=t.get(e);if(a){const t=this.presenceSubscriptionMap.get(a);if(t)(!t.requestedUris.has(e)||a===this.selfMri&&c.cS$.PresenceUnknown===this.selfActivity)&&(t.requestedUris.add(e),n.push({userId:a,source:c.W8Z.ups}),i.set(a,e));else{const t=this.client.subscribe({query:g,variables:{userId:a,source:c.W8Z.ups}}).subscribe((({data:e})=>{e&&this.notifyUpdatedPresence(e)})),o={requestedUris:new Set,presenceSubscription:t};o.requestedUris.add(e),this.presenceSubscriptionMap.set(a,o),n.push({userId:a,source:c.W8Z.ups}),i.set(a,e)}}})),!(0,o.isEmpty)(n)){const{data:e}=yield this.client.query({query:p,variables:{userPresenceRequestArray:n}});e&&this.notifyInitialPresence(e,i)}}))}mapUrisToMris(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=this.resolveUrisToMrisFromCache(e);if(t.size===e.length)return t;{const n=[];return e.forEach((e=>{if(!t.has(e)){const t=e.startsWith(b)?e.substring(b.length):e;n.push(t)}})),(0,o.isEmpty)(n)?t:(yield this.resolveUrisToMrisFromServiceIntoCache(n),this.resolveUrisToMrisFromCache(e))}}))}resolveUrisToMrisFromServiceIntoCache(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{data:n}=yield this.client.query({query:m,variables:{mriOrEmailArray:e,isMailAddress:!0},context:{callerInfo:"office-integration-uri-resolution"}});null===(t=null==n?void 0:n.getUsers)||void 0===t||t.forEach((e=>{var t,n,i;if(e.mri&&"unknown_email_address@invalid.teams.ms"!==e.email){const a=null===(t=e.userPrincipalName)||void 0===t?void 0:t.toLowerCase(),o=null===(n=e.email)||void 0===n?void 0:n.toLowerCase(),r=null===(i=e.emailForQuery)||void 0===i?void 0:i.toLowerCase();a&&this.uriToMriCacheMap.set(a,e.mri),o&&o!==a&&this.uriToMriCacheMap.set(o,e.mri),r&&r!==a&&r!==o&&this.uriToMriCacheMap.set(r,e.mri)}}))}))}resolveUrisToMrisFromCache(e){const t=new Map;return e.forEach((e=>{const n=e.toLowerCase(),i=n.startsWith(b)?n.substring(b.length):n,a=this.uriToMriCacheMap.get(i);a&&t.set(e,a)})),t}notifyUpdatedPresence(e){const t=e.presenceUpdateEvent;if(t){const e=t.id,n=this.presenceSubscriptionMap.get(e);if(n){const i=[],a=c.cS$[t.activity||c.cS$.PresenceUnknown],o=S.get(a)||a,r=this.convertLastSeenAt(t.lastSeenAt);n.requestedUris.forEach((t=>{i.push({id:e,requestedUri:t,status:o,lastSeenAt:r})})),e===this.selfMri&&t.activity&&(this.selfActivity=t.activity),this.notifyPresence(i)}}}handleUntrackPresence(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){(yield this.mapUrisToMris(e)).forEach(((e,t)=>{const n=this.presenceSubscriptionMap.get(e);n&&(n.requestedUris.delete(t),(0,o.isEmpty)(n.requestedUris)&&(n.presenceSubscription.unsubscribe(),this.presenceSubscriptionMap.delete(e)))}))}))}handleStartChat(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("Starting chat");const t=e.split(";").filter((e=>!!e.trim())),n=yield this.mapUrisToMris(t),a=`mapped ${n.size} uris`;this.handleLogToTelemetry(a,"office_integration_handle_chat",i.Info);const r=Array.from(n.values());(0,o.isEmpty)(r)?this.handleLogToTelemetry("No mapped uris to start chat","office_integration_handle_chat",i.Warning):this.navigateToChat(r)}))}navigateToChat(e,t=r.su.new){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this.entityCommanding.chat.chatWithUsers({userIds:e,entityCommand:{stateTransition:t,visibilityState:r.fe.show,correlation:{source:s.D.OfficeIntegrationChat}}})}))}handleStartCall(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{enableOfficeIntegrationCalling:a}=this.coreSettings.get(l.J.Calling);try{const{data:{userCallingSettings:o}}=yield this.client.query({query:h,variables:{}});if(!a||n&&!(null==o?void 0:o.isPstnCallingAllowed)||!n&&!(null==o?void 0:o.isCallingAllowed))return void this.handleLogToTelemetry("Office integration calling or policy is disabled","office_integration_handle_call",i.Warning,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t,isCallingAllowed:null==o?void 0:o.isCallingAllowed,isPstnCallingAllowed:null==o?void 0:o.isPstnCallingAllowed})});this.handleLogToTelemetry("Starting call","office_integration_handle_call",i.Info,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t})});const r=n?this.getPstnCallingIntent(e):yield this.getVoipCallingIntentAndNavigateChat(e,t);yield this.client.mutate({mutation:v,variables:{callingIntent:r}}),this.handleLogToTelemetry("Successfully triggered call","office_integration_handle_call",i.Info,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t})})}catch(e){this.handleLogToTelemetry("Failed to start call","office_integration_handle_call",i.Error,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t}),errors:(null==e?void 0:e.message)||e})}}))}getPstnCallingIntent(e){return{type:c.GXC.OneToOneCall,joinOptions:{},coordinates:{oneToOne:{mri:(0,d.DI)(e)}}}}getVoipCallingIntentAndNavigateChat(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const n=(yield this.mapUrisToMris([e])).get(e);if(!n)throw new Error("No mapped uri to start call");return yield this.navigateToChat([n],r.su.flush),{type:c.GXC.OneToOneCall,coordinates:{oneToOne:{mri:n}},joinOptions:{outgoingVideo:t}}}))}handleLogStatement(e,t){switch(t){case i.Info:this.logger.log(e);break;case i.Debug:this.logger.debug(e);break;case i.Error:this.logger.error(e);break;case i.Warning:this.logger.warn(e)}}handleLogToTelemetry(e,t,n,a,o=!0){switch(n){case i.Info:this.logger.infoToTelemetry?this.logger.infoToTelemetry(e,t,a,o):this.logger.log(e);break;case i.Debug:this.logger.debugToTelemetry?this.logger.debugToTelemetry(e,t,a,o):this.logger.debug(e);break;case i.Error:this.logger.errorToTelemetry?this.logger.errorToTelemetry(e,t,a,o):this.logger.error(e);break;case i.Warning:this.logger.warnToTelemetry?this.logger.warnToTelemetry(e,t,a,o):this.logger.warn(e)}}}},974630:(e,t,n)=>{"use strict";var i,a,o,r,s;n.d(t,{Nt:()=>i,mL:()=>a}),function(e){e.DEFAULT="DEFAULT",e.CHANNEL="CHANNEL"}(i||(i={})),function(e){e.chat="chatCampaign",e.meeting="meetingCampaign",e.files="filesCampaign",e.contactSyncConfirmation="contactSyncConfirmation"}(a||(a={})),function(e){e.channel="channel",e.chat="chat",e.communities="communities",e.communitiesJoinInviteView="communitiesJoinInviteView",e.syntheticNotificationCampaign="syntheticNotificationCampaign",e.joinInviteActivity="joinInviteActivity",e.teamPendingJoinRequest="teamPendingJoinRequest",e.manageTeamChannels="manageTeamChannels",e.manageChannelMembers="manageChannelMembers",e.msGraph="msGraph",e.calls="calls"}(o||(o={})),function(e){e.teamAvatar="teamAvatar",e.staticImage="staticImage",e.imageUrl="imageUrl",e.default="default"}(r||(r={})),function(e){e.DLP="DLP"}(s||(s={}))},813628:(e,t,n)=>{"use strict";n.d(t,{w:()=>x});var i,a,o,r,s=n(361366),l=n(47135),c=n(343324),d=n(635424),u=n(916561),m=n(296154),g=n(659617),p=n(786918);function v(e){const{clientId:t}=e.get(l.J.Brb);return t}function h(e){const{licenseType:t}=e.get(l.J.UserResources);return t}function f(e,t,n,a){const{adoTagsForAllItems:o,categories:r}=e.get(l.J.Brb),s=null==r?void 0:r.find((e=>(null==e?void 0:e.id)===t));return[o,(null==s?void 0:s.additionalAdoTags)||"",n.get(i.Ring)||"unknownRing",function(e,t){var n,i,a;const{platformAdoTagPrefix:o,platformAdoTagSuffix:r}=e.get(l.J.Brb);let s=`${o||"teams"}_${r||t.config.browser}`;return o&&r&&(null===(n=null==t?void 0:t.config)||void 0===n?void 0:n.platformId)===g.us.Web&&(s=(null===(i=null==t?void 0:t.config)||void 0===i?void 0:i.browser)?`${s}_${null===(a=null==t?void 0:t.config)||void 0===a?void 0:a.browser}`:s),s}(e,a),n.get(i.MTMA)?"MTMA":""].filter((e=>e)).join(";")}function y(e,t,n){const a=`${function(e){const t=e.get(i.Build)||"";return t.startsWith("local")?"[LOCAL] ":t.indexOf("oncdn")>=0?"[CONTAINER] ":""}(n)||""}${e||""}`,{brbItemTitleMaxLength:o}=t.get(l.J.Brb);return S(a,o||1500)}function b(e,t){const{brbItemDescriptionMaxLength:n}=t.get(l.J.Brb);return S(e||"",n||5e3)}function S(e,t){return(e=e||"No text provided").length>t?`${e.substring(0,t-3)}...`:e}function k(e){let t="";const n=e.get(i.MTMA);n&&"MTMA"===n&&(t="<h3>(This is MTMA scenario, please check logs from user's other accounts under Links tab)</h3><br>");let a="";return null==e||e.forEach(((e,t)=>{a=`${a}<b>${t}:</b> ${e}<br>`})),`<h3><strong>All the logs & screenshots (if attached) are available in the devlogs link which is present in the Links tab.</strong></h3><br>${t}${a}`.trim()}function w(e){return e.get(i.WebClientBuild)||"1.1.11.1111_11/1.1.1.1111111111"}function C(e,t,n,i,a){let o=i;o=o?o===r.ApiFailure?r.ApiFailure:o.includes(r.TimedOut)?r.TimedOut:r.Unknown:void 0;let s=e.get(t);return s?(s.uploadStatus=n,s.byteSize=null!=a?a:s.byteSize,s.error=null!=o?o:s.error):(s={uploadStatus:n,byteSize:a,error:o},e.set(t,s)),o}!function(e){e.UserEmail="UserEmail",e.TenantID="TenantID",e.Ring="Ring",e.UserID="UserID",e.WebClientBuild="WebClient build",e.Build="Build",e.MTMA="MTMA",e.MSAlias="MSAlias",e.DeviceID="Device ID",e.Language="Language",e.SystemManufacturer="System Manufacturer",e.DeviceModel="Device Model",e.DesktopVersion="Desktop Version",e.slimCoreVersion="Slimcore Version"}(i||(i={})),function(e){e.FocusAssistant="Focus Assistant",e.GlobalNotificationSettings="Global Notification Settings",e.CustomNotificationOnDesktop="Custom Notification on Desktop",e.CustomNotificationForChats="Custom Notification for Chats",e.CustomNotificationForCalls="Custom Notification for Calls"}(a||(a={})),function(e){e.Requested="Requested",e.Success="Success",e.Failure="Failure"}(o||(o={})),function(e){e.TimedOut="TimedOut",e.Unknown="Unknown",e.ApiFailure="ApiFailure"}(r||(r={}));var _=n(379717);const T=e=>{const t=e.loggerFactory.newLogger("BrbServiceEndpointsManager","services-io-brb");return{baseUrl:"https://brbv2",serviceName:d.EJ.BRB,models:{createBrbItem:E(e,t),uploadLogsFile:N(e,t),releaseBrbItem:A(e,t),extendBrbReports:I(e,t)}}},I=(e,t)=>(0,s.__awaiter)(void 0,void 0,void 0,(function*(){return{allowedResponses:[u.qb.OK],constructRequest:(n,a,o,r)=>{if(!a){const e=`Skype token is not present: ${a}`;throw t.error(e),new Error(e)}const{extendBrbReportsUrl:s}=e.coreSettings.get(l.J.Brb);if(!s){const e=`Failed to retrieve extend BRB report url from core settings: ${s}`;throw t.error(e),new Error(e)}let c;try{c=function(e,t,n,a,o){return(0,p.u4)({ReportTitle:y(e.text,a,o),ReportDescription:b(e.text,a),CategoryName:e.categoryId,SkypeAuthToken:t,UploadID:(0,m.v4)(),InitiatorIDs:[n],ClientID:v(a),ClientVersion:w(o),Email:o.get(i.UserEmail),TenantID:o.get(i.TenantID),UserID:o.get(i.UserID),Ring:o.get(i.Ring)})}(n,a,o,e.coreSettings,r)}catch(e){throw t.error("Failed to get extend BRB report request body:",e),e}const d=new URL(s);return{method:"POST",url:d.href,headers:{Host:d.hostname,"Content-Type":"application/json","Content-Length":`${c.length}`},body:c}},abortOnTimeout:!1}})),E=(e,t)=>(0,s.__awaiter)(void 0,void 0,void 0,(function*(){return{allowedResponses:[u.qb.OK],constructRequest:(n,a,o)=>{if(!n){const e=`Skype token is not present: ${n}`;throw t.error(e),new Error(e)}const{createBrbRequestUrl:r}=e.coreSettings.get(l.J.Brb);if(!r){const e=`Failed to retrieve create BRB request url from core settings: ${r}`;throw t.error(e),new Error(e)}let s;try{s=function(e,t,n,a,o){return(0,p.u4)({ReportTitle:y(e.text,t,a),ReportDescription:b(e.text,t),CategoryName:e.categoryId,UploadID:(0,m.v4)(),InitiatorIDs:[],ClientID:v(t),ClientVersion:w(a),CorelibVersion:"",Ring:a.get(i.Ring),SkypeAuthToken:n,TenantName:"",TenantID:a.get(i.TenantID),UserID:a.get(i.UserID),Email:a.get(i.UserEmail),MSAlias:a.get(i.MSAlias)||"",SkipEmailNotification:!1,SkipVsoTicketCreation:!1,SystemInfo:k(a),VsoTags:f(t,e.categoryId,a,o),LicenseType:h(t)})}(a,e.coreSettings,n,o,e.platformService)}catch(e){throw t.error("Failed to get create BRB item request body:",e),e}const c=new URL(r);return{method:"POST",url:c.href,headers:{Host:c.hostname,"Content-Type":"application/json","Content-Length":`${s.length}`},body:s}}}})),N=(e,t)=>Promise.resolve({allowedResponses:[u.qb.CREATED],constructRequest:(n,i)=>{if(!n){const e=`Create BRB item response body is not present: ${n}`;throw t.error(e),new Error(e)}if(!i){const e=`Logs file is not present: ${i}`;throw t.error(e),new Error(e)}const{enableGzipUpload:a,minSizeToGzip:o}=e.coreSettings.get(l.J.Brb,["enableGzipUpload","minSizeToGzip"]),r=new URL(n.ContainerUrl);let s,c,d;return a&&"string"==typeof i.content&&i.content.length>(null!=o?o:2e3)?(s=(0,_.gzip)(i.content),c=s.length,d=!0):(s=i.content,c="string"==typeof i.content?i.content.length:i.content.size,d=!1),{method:"PUT",url:`${r.href}/${i.fileName}?${n.SASToken}`,headers:Object.assign({Host:r.hostname,"Content-Type":"text/plain","Content-Length":c.toString(),"x-ms-blob-type":"BlockBlob"},d?{"Content-Encoding":"gzip"}:{}),body:s}},transformResponse:()=>Promise.resolve(!0),abortOnTimeout:!1}),A=(e,t)=>Promise.resolve({allowedResponses:[u.qb.OK],constructRequest:n=>{if(!n){const e=`Container ID is not present: ${n}`;throw t.error(e),new Error(e)}const{releaseBrbRequestUrlPrefix:i}=e.coreSettings.get(l.J.Brb);if(!i){const e=`Failed to retrieve release BRB request url prefix from core settings: ${i}`;throw t.error(e),new Error(e)}const a=new URL(`${i}${n}`);return{method:"POST",url:a.href,headers:{Host:a.hostname,"Content-Length":"0"}}},transformResponse:()=>Promise.resolve(!0),abortOnTimeout:!1});var F=n(980402),D=n(429071);class R{constructor(e,t,n,i,a,o,r,s,l,c,d,u){this.coreSettings=t,this.logsCollectorService=n,this.authenticationService=i,this.platformService=a,this.discover=o,this.host=r,this.hostCommunicationService=s,this.brbServiceApi=l,this.i18n=c,this.authenticationUser=d,this.apolloClient=u,this.defaultUploadDesktopLogsTimeoutMs=2e4,this.logger=e.newLogger("BrbServiceTasks","services-io-brb")}getSystemInfo(){var e,t,n,o,r,d,u,p,v,h,f,y,b,S;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const k=new Map;let w;k.set("TimeStamp",(new Date).toISOString()),this.logger.debug("... starting getSystemInfo() brb");try{w=yield this.authenticationService.getUser()}catch(e){this.logger.error("Failed to fetch user:",e)}!function(e,t,n,a){var o,r,s,c,d,u,m,p,v,h,f,y;e.set(i.UserEmail,(null===(o=null==t?void 0:t.profile)||void 0===o?void 0:o.email)||(null===(r=null==t?void 0:t.profile)||void 0===r?void 0:r.upn)||(null===(s=null==t?void 0:t.profile)||void 0===s?void 0:s.preferred_username)||""),e.set("UserType",(null===(c=null==t?void 0:t.type)||void 0===c?void 0:c.toString())||""),e.set(i.TenantID,(null===(d=null==t?void 0:t.profile)||void 0===d?void 0:d.tid)||""),e.set(i.Ring,(null===(m=null===(u=n.get(l.J.Metadata))||void 0===u?void 0:u.ring)||void 0===m?void 0:m.id)||""),e.set(i.UserID,(null===(v=null===(p=null==t?void 0:t.profile)||void 0===p?void 0:p.oid)||void 0===v?void 0:v.toString())||"");const b=(null===(h=n.get(l.J.Brb))||void 0===h?void 0:h.sendBrbMSAlias)?a.config.clientType===g.Bh.Maglev?null==t?void 0:t.userName:(null===(f=null==t?void 0:t.profile)||void 0===f?void 0:f.upn)||(null===(y=null==t?void 0:t.profile)||void 0===y?void 0:y.email):"";e.set(i.MSAlias,b||"")}(k,w,this.coreSettings,this.platformService),function(e,t){var n,i,a,o,r,s,l,c;e.set("Platform",(null===(i=null===(n=null==t?void 0:t.config)||void 0===n?void 0:n.platformId)||void 0===i?void 0:i.toString())||""),e.set("OS",(null===(a=null==t?void 0:t.config)||void 0===a?void 0:a.osPlatform)||""),e.set("OS Version",(null===(r=null===(o=null==t?void 0:t.config)||void 0===o?void 0:o.osVersion)||void 0===r?void 0:r.toString())||""),e.set("Browser",(null===(s=null==t?void 0:t.config)||void 0===s?void 0:s.browser)||""),e.set("Browser Version",(null===(c=null===(l=null==t?void 0:t.config)||void 0===l?void 0:l.browserVersion)||void 0===c?void 0:c.toString())||"")}(k,this.platformService);const{enableMTMA:C}=this.coreSettings.get(l.J.Core);C&&(yield function(e,t){var n;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const a=yield null===(n=null==t?void 0:t.getCachedUsers)||void 0===n?void 0:n.call(t,{id:(0,m.v4)(),scenarioName:c.RG.AuthWebCachedUser,source:"brb-utils::addMTMAInfo"}),o=(null==a?void 0:a.length)&&a.length>1;e.set(i.MTMA,o?"MTMA":"")}))}(k,this.authenticationService)),k.set("Client",(null===(e=this.coreSettings.get(l.J.Brb))||void 0===e?void 0:e.systemInfoClient)||""),k.set(i.WebClientBuild,(null===(n=null===(t=this.platformService)||void 0===t?void 0:t.config)||void 0===n?void 0:n.clientVersion)||""),k.set(i.Build,(null===(r=null===(o=this.platformService)||void 0===o?void 0:o.config)||void 0===r?void 0:r.buildVersion)||"");try{k.set(i.slimCoreVersion,(null===(u=null===(d=this.host)||void 0===d?void 0:d.SlimCore)||void 0===u?void 0:u.getVersion().toString())||"unkown slimcore version")}catch(e){this.logger.log("Error while fetching SlimCoreVersion:",e)}k.set("DesktopClientVersion",(null===(p=this.coreSettings.get(l.J.Host))||void 0===p?void 0:p.desktopVersion)||"unknown");const{sessionId:_}=this.coreSettings.get(l.J.Platform);k.set("SessionID",_||""),k.set(i.Language,(null===(v=this.i18n)||void 0===v?void 0:v.locale)||"");const T=yield this.hostCommunicationService.loadModule("osutils"),I=yield null===(h=null==T?void 0:T.getDeviceInfo)||void 0===h?void 0:h.call(T);k.set(i.DeviceID,(null==I?void 0:I.deviceId)||"unkown deviceID"),k.set(i.SystemManufacturer,(null==I?void 0:I.make)||(null===(f=this.hostSettings)||void 0===f?void 0:f.systemManufacturer)||""),k.set(i.DeviceModel,(null==I?void 0:I.model)||(null===(y=this.hostSettings)||void 0===y?void 0:y.systemProductName)||"");const E=yield this.hostCommunicationService.loadModule("toasts");if(E){try{const e=yield null===(b=null==E?void 0:E.getFocusAssistStateAsync)||void 0===b?void 0:b.call(E);k.set(a.FocusAssistant,e||"")}catch(e){this.logger.log("Error while fetching focus assistant state:",e)}try{const e=yield null===(S=null==E?void 0:E.getGlobalNotificationSettingsAsync)||void 0===S?void 0:S.call(E);k.set(a.GlobalNotificationSettings,(null==e?void 0:e.global)||"")}catch(e){this.logger.log("Error while fetching global notification settings:",e)}}else this.logger.log("Error while loading toast settings module. Toast settings will not be collected.");yield function(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){try{const{enableCustomNotificationsForCalls:n,enableCustomNotificationsForChats:i,enableCustomNotificationsOnDesktop:o}=t.get(l.J.Core);e.set(a.CustomNotificationOnDesktop,o?"Enabled":"Disabled"),e.set(a.CustomNotificationForCalls,n?"Enabled":"Disabled"),e.set(a.CustomNotificationForChats,i?"Enabled":"Disabled")}catch(e){this.logger.log("Error while fetching custom notifications settings:",e)}}))}(k,this.coreSettings);let N=new Map;try{N=(yield this.logsCollectorService.getSystemInfo())||new Map}catch(e){this.logger.error("Failed to fetch system info from logs collector service:",e)}return new Map([...Array.from(k.entries()),...Array.from(N.entries())])}))}createBrbItem(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let n;try{const i=yield this.discover.validateSkypeToken();n=yield this.brbServiceApi.createBrbItem(i,e,t)}catch(e){return this.logger.error("Failed creating BRB item:",e),null}return n}))}extendBrbReports(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let i;try{const a=yield this.discover.validateSkypeToken();i=yield this.brbServiceApi.extendBrbReports(e,a,t,n)}catch(e){return this.logger.error("Failed extending BRB report"),null}return i}))}uploadWebLogsFiles(e,t){var n;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const i=new Map,{enableMTMA:a}=this.coreSettings.get(l.J.Core),{maxBRBLogsCountInLogFile:d}=this.coreSettings.get(l.J.Diagnostics),u=n=>(0,s.__awaiter)(this,void 0,void 0,(function*(){const a=n.content instanceof Blob?n.content.size:new Blob([n.content]).size,s=`File name: ${n.fileName}, size: ${a} bytes`;C(i,n.fileName,o.Requested,void 0,a);const l=function(e){const t=e.split("/"),n=t.length>1?t[t.length-1]:e;return e.includes("WebLogs/Core")?`WebLogs/Core/${n}`:e.includes("WebLogs/User")?`WebLogs/User/${n}`:n}(n.fileName);try{const d=yield this.brbServiceApi.uploadLogsFile(e,n),u=d?o.Success:o.Failure;return C(i,n.fileName,u,u?void 0:r.ApiFailure,a),null==t||t.mark(c.ck.UploadWebLogsFiles,{reason:s,size:a,context:l},u?"success":"failure"),d}catch(e){return this.logger.error(`Failed to upload logs file - ${n.fileName} - error:`,e),C(i,n.fileName,o.Failure,e.toString(),a),null==t||t.mark(c.ck.UploadWebLogsFiles,{reason:s,size:a,context:l},"failure"),!1}}));try{a&&(null===(n=this.authenticationUser)||void 0===n?void 0:n.id)?yield this.logsCollectorService.callOnUserLogsFiles([this.authenticationUser.id],u,!1,!1,d||void 0):yield this.logsCollectorService.callOnLogsFiles(u,!1,!1,d||void 0)}catch(e){return this.logger.error("Failed when calling upload on all logs files:",e),i}return i}))}uploadDesktopLogsFiles(e,t,n){var i;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const a="Desktop-Logs-and-Screenshots",s=new Map,d=yield this.hostCommunicationService.loadModule("brb");if(!d)return this.logger.log("uploadDesktopLogsFiles(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),s;let u;const{enableMTMA:m}=this.coreSettings.get(l.J.Core);if(m&&this.apolloClient){const e=null===(i=this.authenticationUser)||void 0===i?void 0:i.id,n=yield(0,D.XD)(this.apolloClient),a=[];n.forEach((t=>{t.userContextId===e&&a.push(t.id)})),u=null==t?void 0:t.filter((e=>a.includes(e)))}else u=t;if(!d.uploadDesktopLogs)return this.logger.error("uploadDesktopLogs not available on brb module."),s;const g={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature},screenshotIds:u},{uploadDesktopLogsTimeoutMs:p}=this.coreSettings.get(l.J.Brb),v=null!=p?p:this.defaultUploadDesktopLogsTimeoutMs;try{const e=yield(0,F.E)(d.uploadDesktopLogs(g),v,`uploadDesktopLogs timed out. Ran for ${v} ms.`),t=!!(null==e?void 0:e.status);return C(s,a,t?o.Success:o.Failure,t?void 0:r.ApiFailure),null==n||n.mark(c.ck.UploadDesktopLogsFiles,t?void 0:{reason:`${r.ApiFailure}`},t?"success":"failure"),s}catch(e){this.logger.error("Failed to upload desktop logs files. Error:",e);const t=(0,F.T)(e)?r.TimedOut:r.Unknown;return C(s,a,o.Failure,t),null==n||n.mark(c.ck.UploadDesktopLogsFiles,{reason:t},"failure"),s}}))}uploadHeapSnapshotFiles(e,t){var n,i;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const a="Heap-Snapshot",s=new Map,l=yield this.hostCommunicationService.loadModule("brb");if(!l)return this.logger.log("uploadHeapSnapshotFiles(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),s;if(!l.uploadHeapSnapshot)return this.logger.error("uploadHeapSnapshot not available on brb module."),s;const d={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature}};try{const e=yield l.uploadHeapSnapshot(d),n=!!(null==e?void 0:e.status);return C(s,a,n?o.Success:o.Failure,n?void 0:r.ApiFailure),null==t||t.mark(c.ck.UploadHeapSnapshotFiles,n?void 0:{reason:`${r.ApiFailure}`},n?"success":"failure"),s}catch(e){this.logger.error("Failed to upload heapsnapshot files. Error:",e),null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,"Failed to upload heap snapshot file","brb");const r=C(s,a,o.Failure,e.toString());return null==t||t.mark(c.ck.UploadHeapSnapshotFiles,{reason:r},"failure"),s}}))}uploadMemoryTracingFile(e,t){var n,i;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const a="Memory-Tracing",s=new Map,l=yield this.hostCommunicationService.loadModule("brb");if(!l)return this.logger.log("uploadMemoryTracingFile(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),s;if(!l.uploadMemoryTracing)return this.logger.error("uploadMemoryTracing not available on brb module."),s;const d={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature}};try{const e=yield l.uploadMemoryTracing(d),n=!!(null==e?void 0:e.status);return C(s,a,n?o.Success:o.Failure,n?void 0:r.ApiFailure),null==t||t.mark(c.ck.UploadMemoryTracingFile,n?void 0:{reason:`${r.ApiFailure}`},n?"success":"failure"),s}catch(e){this.logger.error("Failed to upload memory tracing file. Error:",e),null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,"Failed to upload memory tracing file","brb");const r=C(s,a,o.Failure,e.toString());return null==t||t.mark(c.ck.UploadMemoryTracingFile,{reason:r},"failure"),s}}))}releaseBrbItem(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let t;try{t=yield this.brbServiceApi.releaseBrbItem(e)}catch(e){return this.logger.error("Failed to release the BRB item - error:",e),!1}return t}))}uploadFileUploadSummary(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const i=function(e){let t=!0;const n=[];for(const[i,a]of e.entries()){const e=a.byteSize?`(${a.byteSize} bytes)`:"",r=`Status: ${a.uploadStatus}`;t=a.uploadStatus===o.Success&&t;const s=`FileName: ${i} ${e}, ${r}${a.error?`, error: ${a.error}`:""}`;n.push(s)}return{content:n.join("\r\n"),allLogFilesUploaded:t,summaryFileUploaded:!1}}(t);try{const t=yield this.brbServiceApi.uploadLogsFile(e,{fileName:"brb-file-upload-summary.txt",content:i.content,isPiiFree:!0});return null==n||n.mark(c.ck.UploadFileUploadSummary),i.summaryFileUploaded=t,i}catch(e){const t=e.toString().includes("TimedOut")?r.TimedOut:r.Unknown;return null==n||n.mark(c.ck.UploadFileUploadSummary,{reason:t},"failure"),i.summaryFileUploaded=!1,i}}))}}class x{constructor(e,t,n,i,a,o,r,s,l,c,d,u,m){this.coreSettings=t,this.hostCommunicationService=s,this.scenarioFactory=c,this.defaultDisclaimer='NOTE: Data sent in feedback submissions will be "Support Data" under your agreement for Microsoft 365, including any information that would otherwise be considered "Customer Data" or "Personal Data". Please do not submit feedback that may include data you do not wish to provide to Microsoft as "Support Data".',this.logger=e.newLogger("BrbService","services-io-brb");const g=l.createApi(T);this.brbServiceTasks=new R(e,t,n,i,a,o,r,s,g,d,u,m)}getBrbFormData(){var e,t;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const{categories:n,disclaimer:i}=this.coreSettings.get(l.J.Brb),a=[];return null==n||n.forEach((e=>{e&&a.push({id:e.id,name:e.name})})),null===(t=(e=this.logger).logNoPii)||void 0===t||t.call(e,"Returning data for BRB form",a),{disclaimer:i||this.defaultDisclaimer,categories:a}}))}getBrbScreenshots(e){var t,n,i,a,o,r,l;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const s=yield this.hostCommunicationService.loadModule("brb");if(!s)return void(null===(n=(t=this.logger).logNoPii)||void 0===n||n.call(t,"getBrbScreenshots(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."));null===(a=(i=this.logger).logNoPii)||void 0===a||a.call(i,"Requesting screenshots from host");const c=yield null===(o=s.getScreenshotThumbnails)||void 0===o?void 0:o.call(s,{width:e.width,height:e.height||void 0});return null===(l=(r=this.logger).logNoPii)||void 0===l||l.call(r,"Returning host-provided screenshots"),null==c?void 0:c.screenshots}))}createBrbItem(e){var t,n;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const{enableBrb:i}=this.coreSettings.get(l.J.Brb);if(!i)return void(null===(n=(t=this.logger).logNoPii)||void 0===n||n.call(t,"Create BRB item not enabled - setting:",i));const a=this.scenarioFactory.newScenario(c.RG.BrbCreateItem,{timeoutMs:36e5});a.mark(c.ck.BrbSubmitted);const o=yield this.processCreateBrbRequest(e);if("error"!==o.kind)return a.stop(),{containerId:o.response.ContainerID};a.fail({reason:o.reason})}))}extendBrbReports(e,t){var n,i,a,o;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const{isInternalRingAccount:r}=this.coreSettings.get(l.J.Core),s=this.scenarioFactory.newScenario(c.RG.BrbExtendReports);if(!r){const e="Current account is not internal ring account";return null===(i=(n=this.logger).errorNoPii)||void 0===i||i.call(n,e),s.cancel({reason:e}),!1}const d=yield this.processExtendBrbReportsRequest(e,t.containerId);return d?s.stop():s.fail(),null===(o=(a=this.logger).logNoPii)||void 0===o||o.call(a,"Finished extending brb report"),d}))}processExtendBrbReportsRequest(e,t){var n,i,a,o;return(0,s.__awaiter)(this,void 0,void 0,(function*(){let r=new Map;try{r=yield this.brbServiceTasks.getSystemInfo()}catch(e){null===(i=(n=this.logger).errorNoPii)||void 0===i||i.call(n,"Failed to fetch system info")}let s=null;try{s=yield this.brbServiceTasks.extendBrbReports(e,t,r)}catch(e){return null===(o=(a=this.logger).errorNoPii)||void 0===o||o.call(a,"Failed to Extend BRB Reports"),!1}if(!s)return this.logger.error(`Request to Extend BRB Reports failed to receive response body: ${s}`),!1;let l=!1;try{l=yield this.uploadFilesToBrbItem(s,e.includeHeapSnapshot,e.screenshotIds?[...e.screenshotIds]:void 0),l||this.logger.error(`Failed to upload all logs files to first party container: ${t}`)}catch(e){this.logger.error(`Error when uploading all logs files to first party container: ${t}`)}return!0}))}processCreateBrbRequest(e){var t,n,i,a;return(0,s.__awaiter)(this,void 0,void 0,(function*(){let o=new Map;try{o=yield this.brbServiceTasks.getSystemInfo()}catch(e){this.logger.error("Failed to fetch system info:",e)}let r=null;try{r=yield this.brbServiceTasks.createBrbItem(e,o)}catch(e){return this.logger.error("Failed to create BRB item:",e),{kind:"error",reason:"Failed to create BRB item"}}if(!r)return this.logger.error(`Request to create BRB item failed to receive response body: ${r}`),{kind:"error",reason:"Request to create BRB item failed to receive response body"};let s=!1;try{s=yield this.uploadFilesToBrbItem(r,e.includeHeapSnapshot,e.screenshotIds?[...e.screenshotIds]:void 0)}catch(e){this.logger.error("Failed to upload all logs files:",e)}s||null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"Failed to upload all logs files - attempting to complete BRB item","brb");let l=!1;try{l=yield this.brbServiceTasks.releaseBrbItem(r.ContainerID)}catch(e){return this.logger.error("Failed to release BRB item:",e),{kind:"error",reason:"Failed to release BRB item"}}if(!l){const e="Failed to release the BRB item";return null===(a=(i=this.logger).errorNoPii)||void 0===a||a.call(i,e),{kind:"error",reason:e}}return{kind:"response",response:r}}))}uploadFilesToBrbItem(e,t=!1,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const i=this.scenarioFactory.newScenario(c.RG.BrbUploadLogs),a=[];let o=new Map;t&&(o=yield this.brbServiceTasks.uploadHeapSnapshotFiles(e,i),a.push(this.brbServiceTasks.uploadMemoryTracingFile(e,i))),a.push(this.brbServiceTasks.uploadWebLogsFiles(e,i)),a.push(this.brbServiceTasks.uploadDesktopLogsFiles(e,n,i));(yield Promise.all(a)).forEach((e=>{e.forEach(((e,t)=>{o.set(t,e)}))}));const r=yield this.brbServiceTasks.uploadFileUploadSummary(e,o,i),s=r.allLogFilesUploaded&&r.summaryFileUploaded;return s?i.stop():i.fail(),s}))}}},328497:(e,t,n)=>{"use strict";n.d(t,{V:()=>i,N:()=>a});const i="broadcast-updated-event",a={streamUpdateHubEvent:"streamUpdate",captionsUpdate:"captionsUpdate",subscribeToStreamUpdatesHubEvent:"subscribeToStreamUpdates",notifyStreamSwitch:"notifyStreamSwitch",transcriptionStateUpdate:"transcriptionStateUpdate"}},786018:(e,t,n)=>{"use strict";n.d(t,{Bc:()=>i,l4:()=>a,FW:()=>o,kH:()=>r});const i={INVALID_START_DATE:"Invalid start date. Start date cannot be null or undefined",INVALID_END_DATE:"Invalid end date. End date cannot be null or undefined",INVALID_GROUP_IDENTIFIER:"Invalid group identifier. Group identifier cannot be null or undefined",INVALID_START_AND_END_DATE:"Start date cannot greater than end date",INVALID_EVENT_ID:"Invalid event id",INVALID_UID:"Invalid uid",ATLEAST_ONE_ATTENDEE_REQUIRED:"atleast one attendee is required",INVALID_MRI:"invalid mri",INVALID_MEETING_RESPONSE:"Invalid Meeting Response",INVALID_START_TIME_FOR_ICALUID_OP:"Invalid start time. Start time cannot be null or undefined for operation on instance of a series event using iCalUId",INVALID_CONNECTED_ACCOUNT_ID:"Invalid connected account id",FAILED_TO_GENERATE_URL:"Failed to generate URL to call",REQUEST_TIMEOUT_MESSAGE:"Request timeout"},a={MiddleTier:{V1:{Private:{CREATE_EMPTY_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/schedulingService/create",UPDATE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/update",DELETE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/delete",CREATE_EVENT_USING_EXISTING_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/exchangeandlink?useGraphApi=false",UPDATE_CALENDAR_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}?useSchedulingService=true&useGraphApi=false",GET_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENTS:"beta/me/calendarEvents?StartDate={startDate}&EndDate={endDate}",DELETE_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}",UPDATE_MEETING_RESPONSE:"beta/me/calendarEvents/{eventId}/respond?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"beta/me/calendarEvents/{eventId}/attendeeEvent?useICalUId={useICalUId}",CANCEL_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}/cancel?useICalUId={useICalUId}",CANCEL_PRIVATE_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}/cancel?useSchedulingService=true&useICalUId={useICalUId}",GET_USER_MAILBOX_SETTINGS:"beta/users/mailboxSettings",GET_USER_TIMEZONE:"beta/me/calendarEvents/timeZoneSettingsWithOffset?timezone={timezone}",GET_BUILDINGS:"beta/me/calendarEvents/roomlist",GET_ROOMS_IN_BUILDING:"beta/me/calendarEvents/roomlist?topLevel={buildingAddress}",GET_SUGGESTED_TIME:"beta/me/calendarEvents/availability"},Channel:{GET_CHANNEL_EVENTS:"beta/teams/{smtpAddress}/calendarEvents?StartDate={startDate}&EndDate={endDate}",GET_CHANNEL_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",ADD_TO_MY_CALENDAR:"beta/teams/{smtpAddress}/addtomycalendar/{eventId}?useICalUId={useICalUId}",CANCEL_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/cancel?useICalUId={useICalUId}&useSchedulingService=true",CREATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents?useSchedulingService=true&useGraphApi=false&enablePstn={enablePstn}",UPDATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/update?useICalUId=true&useSchedulingService=true&useGraphApi=false"}},V2:{Unified:{GET_CALENDAR_EVENTS:"v2.0/unified/calendarEvents?startDate={startDate}&endDate={endDate}",GET_CALENDAR_VIEWS:"v2.0/unified/calendars/calendarViews?startDate={startDate}&endDate={endDate}",GET_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail",UPDATE_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail"},Private:{GET_CALENDAR_EVENTS:"v2.0/me/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}&shouldDecryptData={shouldDecryptData}",FORWARD_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/forward?useICalUId={useICalUId}",IMPORT_CALENDAR_EVENT:"v2.0/me/calendars/events/import",GET_SCHEDULES:"v2.0/me/calendars/schedules",GET_ATTENDEE_WORK_HOURS:"v2.0/me/calendars/attendeeWorkHours",FIND_MEETING_TIMES:"v2.0/me/calendars/findMeetingTimes",CREATE_CALENDAR_EVENT:"v2.0/me/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",UPDATE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",GET_CALENDAR_EVENT_WITH_ICALUID:"v2.0/me/calendars/events/iCalUId/{eventId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_EVENT_WITH_UID:"v2.0/me/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",GET_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?shouldDecryptData={shouldDecryptData}",DELETE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",PATCH_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",UPDATE_MEETING_RESPONSE:"v2.0/me/calendars/events/{eventId}/respond",UPDATE_MEETING_RESPONSE_WITH_ICALUID:"v2.0/me/calendars/events/{eventId}/respond?eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"v2.0/me/calendars/events/{eventId}/attendeeEvent",CANCEL_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/cancel",GET_MASTER_CATEGORIES:"v2.0/me/calendars/masterCategories",GET_CALENDAR_VIEW_V2_1:"v2.1/me/calendars/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_ROOM_LISTS:"v2.0/places/roomLists?$count={count}&$top={top}&$skip={skip}",GET_ALL_ROOMS:"v2.0/places/rooms?$count={count}&$top={top}&$skip={skip}",GET_ROOMS_IN_ROOM_LIST:"v2.0/places/{roomListAddress}/roomList/rooms?$count={count}&$top={top}&$skip={skip}",GET_MEETING_ARTIFACTS:"v2.0/me/calendars/events/collabs",GET_ATTACHMENTS:"v2.0/me/events/{eventId}/attachments/{attachmentId}"},Channel:{FORWARD_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/forward?useICalUId={useICalUId}&isBackedBySubstrateGroup={isBackedBySubstrateGroup}",GET_CHANNEL_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isBackedBySubstrateGroup={isBackedBySubstrateGroup}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_ICALUID:"v2.0/groups/{groupIdentifier}/calendars/events/iCalUId/{iCalUId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_UID:"v2.0/groups/{groupIdentifier}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW:"v2.0/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT_V2_1:"v2.1/groups/{groupIdentifier}/calendars/{calendarId}/events?isOnlineMeeting={isOnlineMeeting}",UPDATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",CANCEL_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/cancel",ADD_TO_MY_CALENDAR:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/addtomycalendar?isBackedBySubstrateGroup={isBackedBySubstrateGroup}"}},CONNECTED:{Private:{GET_CALENDAR_VIEW_V2_1:"v1.1/connected/{connectedAccountId}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_CALENDAR_EVENTS_CALENDAR_VIEW:"v1.0/connected/{connectedAccountId}/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}",GET_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",GET_CALENDAR_EVENT_WITH_ICALUID:"v1.0/connected/{connectedAccountId}/calendars/events/iCalUid/{eventId}?eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENT_BY_UID:"v1.0/connected/{connectedAccountId}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",CREATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}",FORWARD_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/forward?useICalUId={useICalUId}",UPDATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",CANCEL_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/cancel",UPDATE_MEETING_RESPONSE:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/respond",DELETE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",UPDATE_ATTENDEE_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/attendeeEvent"}}},Outlook:{V2:{Private:{GET_ATTACHMENT_BY_ID:"/v2.0/me/events/{eventId}/attachments/{attachmentId}"}}}},o="Personal",r={DEEP_LINK:"deep-link",NOTIFICATION_POPOVER:"notification-popover",NOTIFICATIONS_FLYOUT:"notifications-flyout"}},216594:(e,t,n)=>{"use strict";var i,a;n.d(t,{mN:()=>i,GB:()=>a,yR:()=>o,oo:()=>r,Q0:()=>s,ex:()=>l,PR:()=>c,gh:()=>d,LC:()=>u,Ky:()=>m,ji:()=>g}),function(e){e.InProgress="InProgress",e.Success="Success",e.Error="Error",e.PartialSuccess="PartialSuccess"}(i||(i={})),function(e){e.StatusEntity="Microsoft.SkypeSpaces.MiddleTier.Models.StatusEntity"}(a||(a={}));const o="x-serverrequestid",r="call_blocking_list_refreshed",s=36e5,l="https://teams.microsoft.com/";var c;!function(e){e.getBlockedContacts="getBlockedContacts",e.postBlockedContacts="postBlockedContacts"}(c||(c={}));const d="api/",u=[{id:c.getBlockedContacts,path:"mt/part/msft/beta/userSettings/blocklist"},{id:c.postBlockedContacts,path:"mt/part/msft/beta/userSettings/blocklist/manage"}],m="https://teams.live.com/";var g;!function(e){e.Add="Add",e.Remove="Remove"}(g||(g={}))},292230:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});var i=n(361366),a=n(65903),o=n(875467);const r=e=>{const t=[];return e.primaryActionCallback&&t.push({name:a.sRD.PrimaryAction,action:e.primaryActionCallback}),e.dismissActionCallback&&t.push({name:a.sRD.DismissAction,action:e.dismissActionCallback}),t};class s{constructor(e,t,n){this.logger=e.newLogger("CallingBannerServiceAdapter","services-io-calling-service-adapters"),this.callingAppEventsService=t,this.bannerCallbacks=new Map,this.i18n=n}showBanner(e,t){var n,s,l,c,d;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=r(e.bannerActions);this.bannerCallbacks.set(e.id,i);const u={source:{name:"ShowBannerNotification",description:e.bannerScenario}},m={event:this.getCallingContentEvent(e,i,o.cP.Show),context:u};try{yield this.callingAppEventsService.trigger(m,t),null===(s=(n=this.logger).infoToTelemetry)||void 0===s||s.call(n,`[showBanner] Successfully triggered banner event for showBanner with [bannerId: ${e.id}]`,"cmd_horizontals_banner_service_show_banner_app_event_triggered_success")}catch(t){const n=`[showBanner] Failed to trigger the banner event for showBanner with [bannerId: ${e.id}, error.name: ${t.name}, error.message: ${t.message}]`;return null===(c=(l=this.logger).errorToTelemetry)||void 0===c||c.call(l,n,"cmd_horizontals_banner_service_show_banner_app_event_triggered_error"),Promise.reject(new Error(n))}const g=(null===(d=i.find((e=>e.name===a.sRD.DismissAction)))||void 0===d?void 0:d.action)||(()=>{});return Promise.resolve({id:e.id,dismiss:g,dismissPromise:Promise.resolve({id:"",value:""})})}))}executeBannerAction(e,t){var n,i,a;null===(i=(n=this.logger).infoToTelemetry)||void 0===i||i.call(n,`Attempting to execute ${t.toString()} action for banner with ${e}`,"cmd_horizontals_banner_service_execute_banner_action");const o=null===(a=this.getBannerActions(e).find((e=>e.name===t)))||void 0===a?void 0:a.action;if(!o)throw new Error(`Action ${t.toString()} not found for banner ${e}`);o()}getBannerActions(e){var t,n;null===(n=(t=this.logger).infoToTelemetry)||void 0===n||n.call(t,`Getting actions for banner ${e}`,"cmd_horizontals_banner_service_get_banner_actions");return this.bannerCallbacks.get(e)||[]}dismissBanner(e,t,n){var a,s,l,c,d,u,m,g,p,v;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(null===(s=(a=this.logger).infoToTelemetry)||void 0===s||s.call(a,`[dismissBanner] Attempting to cleanup callbacks for banner ${e.id} when dismissed by clicking the X or user joining the call or hidden when call is no longer active.`,"cmd_horizontals_banner_service_start_dismiss_banner_service"),this.bannerCallbacks.has(e.id)){if(n){const n=r(e.bannerActions),i={source:{name:"HideBannerNotification",description:e.bannerScenario}},a={event:this.getCallingContentEvent(e,n,o.cP.Hide),context:i};try{yield this.callingAppEventsService.trigger(a,t),null===(u=(d=this.logger).infoToTelemetry)||void 0===u||u.call(d,`[hide] Successfully triggered banner event for dismissBanner with [bannerId: ${e.id}]`,"cmd_horizontals_banner_service_dismiss_banner_app_event_triggered_success")}catch(t){const n=`[hide] Failed to trigger the banner event for dismissBanner with [bannerId: ${e.id}, error.name: ${t.name}, error.message: ${t.message}]`;throw null===(g=(m=this.logger).errorToTelemetry)||void 0===g||g.call(m,n,"cmd_horizontals_banner_service_dismiss_banner_app_event_triggered_error"),new Error(n)}}this.bannerCallbacks.delete(e.id),null===(v=(p=this.logger).infoToTelemetry)||void 0===v||v.call(p,`[dismissBanner] Successfully cleaned the callbacks for banner with [bannerId: ${e.id}] when dismissed or hidden.`,"cmd_horizontals_banner_service_end_dismiss_banner_service")}else null===(c=(l=this.logger).errorToTelemetry)||void 0===c||c.call(l,`[dismissBanner] Banner already dismissed or hidden. Callbacks does not exist for banner ${e.id}`,"cmd_horizontals_banner_service_callbacks_missing_dismiss_banner_service")}))}getCallingContentEvent(e,t,n){const i={visibility:n};return{typeName:"calling-content-event",content:{contentType:"banner",id:e.id,text:e.bannerText,intentLevel:e.bannerIntentLevel,dismissable:e.dismissable,duration:e.duration,bannerScenario:e.bannerScenario,source:e.bannerSource,dismissOnAction:e.dismissOnAction,joinButtonText:this.i18n.stringTranslate("calling","calling_join"),bannerActions:t.map((e=>e.name))},action:i}}}},51561:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});class i extends Error{constructor(e,t,n){super(t),this._code=e,this.message=t,this._subCode=n}get code(){return this._code}get subCode(){return this._subCode}}},895557:(e,t,n)=>{"use strict";n.d(t,{n:()=>l});var i=n(361366),a=n(296154),o=n(309097),r=n(51561),s=n(343324);class l{constructor(e,t,n,i){this.host=i,this.logger=e.newLogger("CallingAppEventsService","services-io-calling-service-adapters"),this.asObservable=t.createObservable(),this.deferredEventsResolution=new Map,this.scenarioFactory=n}trigger(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{externalId:n,timeStamp:i,source:l}=e.context,c=Object.assign(e,{id:`calling-app-event-${(0,a.v4)()}`});this.logger.log(`[trigger] Calling app event received [id=${c.id}, externalId=${n}, timeStamp=${i}, source=${l}]`);const d=this.scenarioFactory.newScenario(s.RG.CallingAppEventTriggerInitiated,{clientId:c.id});if(d.appendEventData({dataSource:e.context.source.name,correlationId:n}),!t)return this.logger.log(`[trigger] Timeout not provided. Resolving promise immediately [id=${c.id}, externalId=${n}, timeStamp=${i}, source=${l}, timeout=${t}]`),this.asObservable.trigger(void 0,void 0,c),void d.stop({message:"no timeout provided, fire and forget."});const u=(0,o.P)();let m;this.deferredEventsResolution.set(c.id,u);const g=new Promise(((e,a)=>{m=this.host.setTimeout((()=>{const e=`[trigger] Timeout waiting for event resolution signal [id=${c.id}, externalId=${n}, timeStamp=${i}, source.name=${l.name}, source.description=${l.description}]`;this.logger.error(e);const t=new r.w("event-resolution-timeout",e);d.fail({errorCode:t.code,message:t.message}),a(t)}),t)})),p=Promise.race([u.promise,g]);this.asObservable.trigger(void 0,void 0,c);try{yield p}finally{void 0!==m&&this.host.clearTimeout(m),this.deferredEventsResolution.delete(c.id)}}))}resolve(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{eventId:t,resolution:n}=e;this.logger.log(`[resolve] Received event resolution [eventId=${t}, resolutionType=${n.resolutionType}]`);const i=this.scenarioFactory.findScenarioByNameAndId(s.RG.CallingAppEventTriggerInitiated,t)||this.scenarioFactory.newScenario(s.RG.CallingAppEventResolveInitiated,{clientId:t}),a=this.deferredEventsResolution.get(t);if(!a){const e=`[resolve] No deferred resolution found for event [eventId=${t}, resolutionType=${n.resolutionType}]`;this.logger.error(e);const a=new r.w("event-to-resolve-not-found",e);throw i.fail({errorCode:a.code,message:a.message}),a}if("success"===n.resolutionType)return this.logger.log(`[resolve] Resolving succesful event [eventId=${t}]`),a.resolve(),void i.stop();if("error"===n.resolutionType){const{name:e,message:o}=n,s=`[resolve] Resolving event error from external resolution [eventId=${t}, resolution.name=${e}, resolution.message=${o}]`;this.logger.error(s);const l=new r.w("external-resolution-error",s,e);return a.reject(l),void i.fail({errorCode:l.code,message:l.message})}const o=`[resolve] Invalid resolution type received. No changes on deferred promise for event [eventId=${t}]`;this.logger.error(o);const l=new r.w("invalid-resolution-type",o);throw i.fail({errorCode:l.code,message:l.message}),l}))}subscribe(e,t){const n=this.asObservable.subscribe(((t,n)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(n){const t=n.id;this.logger.log(`Resolver received app event [eventId=${t}]`);try{e(n)}catch(e){this.logger.error(`[callingAppEventResolver] handling app event error. [errorName=${e.name}, errorMessage=${e.message}]`);const n={eventId:t,resolution:{resolutionType:"error",name:e.name,message:e.message},context:{source:{name:"calling-app-event-resolver-error",description:`[callingAppEventResolver] Error processing event in resolvers [eventId=${t} error.errorCode=${e.name}, error.message=${e.message}]`}}};try{yield this.resolve(n)}catch(e){this.logger.error(`[callingAppEventResolver] error resolution failed in resolvers [eventId=${t}, errorCode[${e.name}], errorMessage[${e.message}]`)}}}else this.logger.error("[subscribe] Received invalid args.")}))));t&&this.handleOnResolverSubscriptionCancellation(t);return this.trigger({event:{typeName:"calling-setup-event",result:{resultType:"calling-setup-success"}},context:{source:{name:"CallingAppEventsService.subscribe",description:"subscribe"}}}),n}unsubscribe(e){this.logger.log(`[unsubscribe] calling app events subscription closed. [subscriptionId=${e}]`),this.asObservable.unsubscribe(e)}handleOnResolverSubscriptionCancellation(e){const t=e=>{let t=this.scenarioFactory.findScenario(e);return t||(t=this.scenarioFactory.newScenario(e)),t};e.subscribe({next:e=>{this.logger.log(`[callingAppEventResolver] cancellation listener next. [reason=${e}]`),t(s.RG.CallingAppEventsSubscriptionCancellationListener).appendEventData({reason:e||"cancellation-listener-reason-undefined"})},complete:()=>{this.logger.log("[callingAppEventResolver] cancellation listener complete."),t(s.RG.CallingAppEventsSubscriptionCancellationListener).mark("cancellation-listener-complete",{reason:"cancellation-listener-complete"})},error:e=>{this.logger.log(`[callingAppEventResolver] cancellation listener found an error. [errorName=${e.name}, errorMessage=${e.message}]`),t(s.RG.CallingAppEventsSubscriptionCancellationListener).fail({errorCode:e.name,message:e.message,reason:"cancellation-listener-error"})}}),t(s.RG.CallingAppEventsSubscribe).mark("cancellation-listener-subscribed")}}},875467:(e,t,n)=>{"use strict";var i,a,o,r,s,l,c,d,u;n.d(t,{cP:()=>i,cA:()=>a,lC:()=>o,JL:()=>r,XD:()=>s,WB:()=>d,k$:()=>u}),function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide"}(i||(i={})),function(e){e[e.Calling=0]="Calling",e[e.RigelGallery=1]="RigelGallery",e[e.RigelContent=2]="RigelContent",e[e.RigelGalleryAndContent=3]="RigelGalleryAndContent"}(a||(a={})),function(e){e.MultiWindow="MultiWindow",e.SingleWindow="SingleWindow"}(o||(o={})),function(e){e[e.Chat=0]="Chat"}(r||(r={})),function(e){e.EndpointTransfer="EndpointTransfer"}(s||(s={})),function(e){e.MostSevere="MostSevere",e.Live="Live",e.Severe="Severe",e.Positive="Positive",e.Neutral="Neutral"}(l||(l={})),function(e){e.BannerNotification="BannerNotification"}(c||(c={})),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.Confirm="ConfirmDialog",e.OptionsSettings="optionsSettingsDialog",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="UserMedia"}(d||(d={})),function(e){e.OneToOne="OneToOne",e.GroupCall="GroupCall",e.Meeting="Meeting",e.Chat="Chat",e.Reply="Reply",e.ReplyToReply="ReplyToReply",e.Like="Like",e.Mention="Mention",e.Download="Download",e.AppUpdated="AppUpdated",e.NeedMoreDiskSpace="NeedMoreDiskSpace",e.TeamMembershipChange="TeamMembershipChange",e.Follow="Follow",e.OneToOnePstn="OneToOnePstn",e.Thirdparty="Thirdparty",e.MessageSendFailed="MessageSendFailed",e.CallTransferFailed="CallTransferFailed",e.ShareFromChat="ShareFromChat",e.Inferred="Inferred",e.Trending="Trending",e.MeetingWentLive="MeetingWentLive",e.PresenceStatus="PresenceStatus",e.Reaction="Reaction",e.Priority="Priority",e.TeamsTasks="TeamsTasks",e.Dlp="Dlp",e.TeamsEngagementActivity="TeamsEngagementActivity",e.MsGraph="MsGraph",e.StaffHub="StaffHub",e.CallAnsweredElsewhere="CallAnsweredElsewhere",e.CallSafeTransferRingback="CallSafeTransferRingback",e.SkypeConsumerCall="SkypeConsumerCall",e.SpamCall="SpamCall",e.Default="Default"}(u||(u={}))},203470:(e,t,n)=>{"use strict";n.d(t,{L:()=>g});var i=n(361366),a=n(47135),o=n(296154),r=n(875467);const s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAADsiSURBVHgB7d17bFz3deDxc+8MXyIl6mXRci1IFhW7yUayngtTsFMJsCy5QRA7COAFbGy8Gxc24C6QKCjcAE2Ljf8IvEWcAFsD9hZFk4W9u0bRSt2gtRWpkJpoSbcWRVly4zgOFQlyJNGWKVEkxdfM3L3nkkNTFMl53N+9cx/fD8DMiJIda0jOOb/zO7/zswRA5O06ejQ71tBQ19DU1CCFkZX6uUa77k7vN+1Mu/dgFW7Li9Wmzy3H2T7zn3ccWWNZslbKd7z4xBLntwXLvjT9a8d613tSyPfqw2hh4sMGp354LJMZGRsZGWsYG5s4tnt3TgBEmiUAasdxrI6ursYl9fVLC42ZtkyucJdY1nLHcj6vQbyKwB0Z7n/7edty3tLkISNOXyHvvJWvy16zR/N9miwc27x5wP27OgKgJkgAgIDp6r1h8eLbigHetp17Co58Mc7B3ZRikmBZ1qlCwXo/n7V/MzEh57SS0LVz54gACAwJAGDITYE+72yzJL+n4Fj3pT3I++FuP7zuJQdu9cDJW+9fHx+/RmIAmEECAFRqqmzfsqTpHgJ9+LRqILZ1wCrIz4oVg2NbtlwTABUhAQBK6OjsbJoZ7B2xHhNEjlYLHDtz2JK6Y9cGBy9SKQAWRgIAzOSu7nedOtXaaBV2O7Z8QQrOo6zs42m6UpAv/P2oZE/RdAjcjAQA6eYG/L3d3bdbWS3hFx5jdZ9sXpXAsV93cs5bh7Ztu0xCgDQjAUC6zFjhE/BRTAhGHfsofQRIGxIAJF5xD98uFL5GSR8LcSzrhwXb/vHQ9ZH36SFA0pEAIHlmrPLFcva7n7lfgIo5x8XO/Gg0Z/0t1QEkEQkAkkGD/smu9oa6hmdZ5cM0bSjM2PKyYzX8zciVK+cZdYwkIAFAfLlBf8+/nbpXS/uW43xDgJDoVoFt1f8FyQDijAQA8ULQR8SQDCCuSAAQfQR9xEQxGXjj858/yxFDRB0JACJrV0/P0kYr/4z7LvoMe/qIHdt+yhkr/OOh7dsvCRBBJACIFA36TQ3OvYXxwo8J+kiGqdMEVwZ+zBYBooQEALVHiR8pwRYBooQEADUzWeIv7HbE+QGrfaSJHiu0MvbzVAVQSyQACJfO3j95sl3q5FlW+8CMqsDGjb0ChIgEAOFwA//D7/V8gb19YD70CiBcJAAIVLGT3/1O+54AKI9tPzUwOPq/uI8AQSIBQCA08DdkCn9GmR+oHtsDCBIJAMyZ6ubP5PP/XbiABzDIOW7ZjU+SCMAkEgD4x/4+EJLJRICxwzCBBADVI/ADNeImAnWZPxnpG/h/JAKoFgkAKkfgByKCRADVIwFA+Qj8QESRCKByJAAojcAPxASJAMpHAoD5EfiBmOLUAEojAcCc9nZ3b5CMc4TAD8QZiQDmRwKAm3gDfOzcy5ZYjwmAhCARwK1IAOBhch+QfDpZcOyT639EfwAUCUDaufv8D53p/rLtyAEBkA62/RSXDoEEIMUe/sXJ36PBD0iryRMDb3xu6z8LUokEIIW8G/rs/E+Eef0A6A9ILRKAFNl19Gi2YcWSP2efH8At2BZIHRKAlKDcD6AcVp29i22BdCABSDjK/QAq5xwfGJ54qGvnzhFBYpEAJBXd/QD8Ylsg0UgAEmjviROrJStdlPsB+EeTYFKRACQITX4AAkM1IHFIABLi99/t2ZzP5Q+y6gcQHKoBSUICEHOs+gGEjmpAIpAAxNjDZ860F/Jj/8SqH0D4qAbEHQlAHDmOte9M93PiyPcEAGqJakBskQDEDOf6AUSPc3y0kP3SsS1brgligwQgRh46feIRzvUDiCqmCMYLCUAMeI1+y1tetcR6TAAg0txqQP/QbrYEoo8EIOI43gcgbhyR8/lx59EjO3b0CCLLFkST41hfPPP21wv5fA/BH0CcuCvLtdl66+S+Mye/ru9lgkjiCxNBHRc6m1r7638qNPoBiD22BKKKBCBiKPkDSBq2BKKJBCAquL0PQMJZVubRNzZtOSiIBBKACKDLH0B6sCUQFSQANaaDfRqs/ClK/gDSg8FBUUACUEO6369d/gIAKcTgoNriGGAtzDjiJwCQUs5E4djDp3seEdQEFYCQsd8PALPRF1ALJAAh4nw/AMyHJCBsJAAhefjMmfZCfuyfaPYDgLnpvACZkI5D27dfEgSOBCAE+3re3iW2dVQAACXRHBgOmgADplf4EvwBoHw0B4aDBCAojmPtPd39Ayb7AUDlHCd/YN/pE3/MZULB4YUNAJ3+AGAKzYFBIQEwTIN/4/LFWvKn0x8AjCAJCAJbAAbpMT+CPwCYZt3fuLzlaEdnZ5PAGCoAhjDTHwCCpccErw+Pf7Zr584RgW8kAAboGX+nMPZrAQAEzslZnzm0bRvvuT6xBeCTXuhD8AeA8FhZ54MH3357i8AXEgAfdMAPF/oAQPiy9dbJh39x8vcEVWMLoEpM9wOA2mNqYPVIAKpA8AeA6CAJqA4JQIUI/gAQPSQBlSMBqADBHwCiiySgMiQAZSL4A0D0kQSUjwSgDAR/AIgPkoDykACUQPAHgPghCSiNBGABBH8AiC+SgIWRAMyD4A8A8UcSMD8SgDnoeF8m/AFAMuTGna1HduzgPX0WEoBZuNgHAJKHC4RuRQIwQ8eFzqbW/vobAgBInNFCZtmxLVuuCTxcBjRFg/+ST+rfEwBAIjXY+VMdnZ1NAg8JgGvX0aNZd+X/U8uStQIASCS35L22tbnup/qeL2ALQL8RGpcv1m7/+wUAkALO8dH+od3Hdu/OSYqluwLgOBbBHwDSxrq/YXnLqxoDJMVSnQDsO9P9nBD8ASB1LLEe23vm5IuSYqnNfh46feIR25EDAgBILcvKPPrGpi0HJYVSmQAw5Q8AUJTWaYGpSwAY9AMAmC2Ng4JS1QOgHf+F/Ng/CQAAM2WdI2mbEZCaBKB43I+z/gCA2dI4IyA1CQDH/QAAC0vX8cBUJADa8S8EfwBACXo8cN+7Pf9ZUiDxWQ4d/wCASqXhCuFEJwC7enqWNtr5qwIAQIWSfntgYrcAvKY/O/8TAQCgCnp7YJKbAhObAND0BwDwQ08GJLkpMJEJAE1/AAATtCnw4TOnviwJlLis5vff7dlcyOcT3bgBAAhXEpsCE1UB0L2afC6fyksdAADBydRbB5I2KTA5CYC7R8OkPwBAEIqTApPUD5CYBGDv6X/9urDvDwAIjHV/koYEJSKTYd8fABCWpPQDxL4CwL4/ACBM2g+QhPkAsU8A2PcHAIRpej5AzMU6AfDm/LPvDwAImTcf4HTPIxJjse0BYM4/AKDW4nxfQCwrAMz5BwBEQaOd+0lcjwbGMgFoWL7oSaH0DwCoOev+fWe6n5MYil3Wsre7e4OVdT4QAAAiwpmQOw5t335JYiRWFQAt/bvB/68FAIAoqZOuuB0NjFUCQOkfABBF3tHAFUv+XGIkNlsAlP4BAFEXpymBsagAUPoHAMRBnKYExiIBoPQPAIiDOG0FRH4LgNI/ACBu4nAqINIVAEr/AIBYqpOuqA8IinQCQOkfABBHuhXw8JlTX5YIi2x20nHhQlNrf98NAQAgpqJ8V0BkKwBu8P+pAAAQY95dAREVyQSAa34BAMlg3T8V0yInclsA3k1/yxdPCAAACeCInB/rH9xwbPfunERI5CoAU41/AAAkQlRnA0SqAsCZfwBAUkWtITBSFQDO/AMAkipqDYGRSQBo/AMAJFu0GgIjcWGBd3GCbT0vAHxbVVcv65sWye319dJW1yDNmYy06XP3Q7XVN8z5z/WNj8lQPi/DUx994+PSNzEmvSMj7q9zcnZ0RAD449jWj8Rx7hLLcqTGIpEAMPEPqI4G+00ti6W9cZFsbGlxg/5kwK+GJgZtC/y+JgW9IzfkrJsQvDM8KL9xn/dNjAuA8hUnBL4hclBqrOZNgBz7A8rXbGfc1X2T7FyyTDpaW+ddzYelmBAcvvqJnHGTAgDliUJDYM0rAA3L9WhEzSshQKRtbG6RPctWys7WpVWv8IPQ7m416Mee5Su8CkHnwDXpvH5N3roeycmnQGQ0ZAp/5j58U2qophUAjv0B81vf2OSu8pfKoyvbIhX0y6H9A6eHBuW1votsEwDzqHUVoKYVAI79AbfS1f4TbXd4e/txpQ2HWhXQD00EXu27xBYBMEuDnXvZffgPUiM1qwCw+gduloTAvxCtCrzqVgSOXP1EAEyy7IYNb2zc2Cs1ULMEYN87J34udP4DiQ/8s5EIAJ/SewIObdpWk2OBNUkAWP0Dbpm8rl72r1mXmsA/W9fANXnl4gV6BICCs/vNLTuOSchCTwCmjv0dFVb/SCk9yvfIbau8VT/EqwYcvPKRd4oASKNaVQFCTwC8MYi2dVSAFNJy/7fW3DU9lQ+TdFvgxQvn5DSNgkirGlQBQk0AWP0jrXTV/8Ttq+WRlW2C+R38+CN55dIFAdKmFlWAUC8DalzaooGf4I9U0b3+l+7+HMG/DLo18qPf3ei9ZkCa6IjgfadO/J6EKLQEgAt/kEYPLlvhBX9K/uXT12oyYVolQJpMXRQUWmU+tASA1T/S5uk77nT3+9fFbopfFOhr9vQda+TxttUCpEXYVYBQEgBW/0gT3e9/Yf3dlPwN0JMSf7q2nSQKqRFmFSCU/xM6/5EWunf9nXUbpL2pSWppOJ+T3tER76a+vvExr8v+I/djKJ+XoULuliN3GmBb7KxXftfn+qg3DerNg+2NTe7nantvmP73P9f7PjMDkA4hnQgIPAGg8x9pocH/hfZ7arLfrwG/8/qAnBkalNNDQ26gHBOT2hsXecmADi3So4y1uIaYJABpEdaJgMATAKb+IQ1qEfw16B++2u9N1Av7/Pym5sXeRT9hJwMkAUiNEKoAgScAzPxH0oUd/DXYv3b5UmSG5nQsWeolA/oYBpIApEEYVYBAEwBW/0i6sIJ/cbV/8EqfFwCjSF8DbdrTo49BIwlAGuTGna1HduzokYAEmgCw+keSabd/GGf8dU6+zsuPy6z8sBKB3pEb8tzZX3GHABLMOf7mvTsekIAElgCw+kfS6fG0jtbgyt5a4tf5+FFd8ZcSRiJwemjQSwKApBotZJYd27LlmgQguDkAWXlWgITSATVBBX89tvfdc71uiftXsQ3+Sv/bv+8mMJNJjNlTCUV6KuHp1WsESKqGTOHPJCCBVAB29fQsbbTzVwVIIB1Rq1PqgnDk6ify8sULiStrB10N0ERDXzsgiYKqAgRSAWiwx78qQAJp058GMtO0ye+Vix96gSyJe9rFasArASU3z7gJGRcIIakaM/lnJADGKwBTg38mBEgg76Y6w01/Wh7Xfew4l/sroa+fjko2PT9AX79nP/gFTYFIpDc3bbNNHwk0XgFoWL7oSQESSC/3MR38tZP92Q/eS03wV94RPjfh0b+7Sd42wyrz1RkgCoK4JMh4AmBJ5msCJIxOvDN9uY/uWf+hG/zTuGLVJED/7kf6ze7bP3LbKm9KIZA0QVwSZDQB0KN/wrl/JIye9//WmrvEJD3br3viaff9D895r4VJ+7mCGQmkVwU//O6768UgsxUAjv4hgXRVabL0rwFPm+EwSV8Lk0mAfq30pAaQNAVn/A/FIGPlBJr/kETaWf6jz24UU7Tsz8p/bt+6c508uNzcMcEn3zvDqGAkjskjgcYqADT/IYlMnvfXpjeC//x0O8BkY6BuBQBJ05gt7BZDzCQAjmMVJPMnAiTInmUrjE3706N+z5/vFSxs8jikmamBOiWQhkAkjVNwfmCqGdBIArD35Mn2jMhaARLkcUMDf3TIT5rO+fuhJyJMXvCjI5uBJNFmwAdPnNgsBpipAND8h4TR1b+pxr9X+y4T/Cugr5XefmgCVQAkUabB/o9igO8EQJv/LHG+IUCCmFr9H776iRy80ieojJ4KMDUjgCoAksZynG/onTvik+8EgOY/JI0O/TGx+te97NcMrWTT6OVLF4z0A1AFQBI1Ss73NoDvBIDJf0gaU5f9vNp3idK/D9oHoBckmUAVAEnjTQb0yVcC8MCJE/pTxeQ/JIae+9cVo19a+ud6Wv+6rl+T00OD4pd+Tdc3NgmQFNoM6HcbwFcCsKgu/0UBEsTU6p/SvzkvfnhOTDB1pBOICr/XBFefADiO5Zb//1KABNloaPVP6d8cfS1NjAp+1PBlTkCtOY4842cmQNUJgJ79FyBBOpYsNdL8x+rfPD0W6Hc2gF4QRDMgksTvTIDqKwCc/UfC7Fziv0TM6j8YGvwPX70ifpm8awCIAj8zAapKADj7jyQysUfM6j84JrYBNMnjqmAkic4EqHYboKoEoGHJknUCJIie/fcbGLRjndV/cPS19XsiQL/G7Y2LBEiSarcBqtsCoPyPhHlo2Urx63A/x/6C9lrfJfHrvtZWAZKk2m2AihMAyv9Iorua/K0KdWKdVgAQrNPDg76bAXcuWSZAklS7DVBxAkD5H0mjw3/am/wNiTk9PCQIh99mQD3pscrQRU9AVFSzDVD5FgDlfyTM+ib/e8JHKP+HpmtgQPziOCCSppptgIoSAMr/SKJNLS3ih5b/tTSNcJjYBljfxFhgJEs12wAVJQCU/5FE6312hVP+D1/n9avix71UAJBAlQ7oqygBsOqcrwqQMO0+twBMXFaDypwZ8pd0tdU3CJA4dZVt0VeUAOR17jCQIHpDnN/z/2dHbwjC5XfLRb/mNAIicRzn0Uq2AcpOAPTaQfdtcq0ACeI3+Ote9NmREUG4dCiQ3z4ABgIhabwrgk+dKnvQRdkJQIM9TvkfieO3/N/L6r9mekf8vfZtVACQQI3Zwu5y/2zZCYAlma8JkDB+g4DfIITq+d16YQsAiVSQ/eX+0bISgI7OTj0zc78ACdNW568Z7CNm/9eM33sXWjJZAZLHuX8qZpdUVgKwdFHd7wqQQH57ALj8p3b8vvZsASCpmuvKi9llJQAFq/r7hoEoa/a5CvTbiIbq6QAmP/xWf4CoKncqYFkJANP/kFQtmeouxCy6POEvCKF6wwWSL2BOZR4HLPnup8f/BEgovwNhqADUzpDP154tACRVuccBSyYAdYXxso8UAGlDAlA7vPbA/Mo5DlgyAbCz1mMCAABiwykUSsbuhRMAdw/BEpsEAACAGLHEXbyX6ANYMAF4oLv7dgEAALGzt0QMXzABaLTy9wmAefmdI4Dq8doDC7MarAVj+IIJAPv/SDq/Z8kJQrXTwhAnYEGl+gDmTwDY/wdKaiEBqJlVdf6O8Q3ncwIkWak+gHkTgEquFATiyvc4WabJ1YzfWf5DDBJCCiwUy+dNABolt1mAhOvzOcmPYTK14/e1Z44A0mCheQDzJgCObX9ZgITzGwS4UrZ2/CYAl8cZ44zkcxz5wny/N28CUBDnUQESzu8WQHvjIkFtrPf52nOVM1LBmT+Wz5kA6F3CGZG1AiSc7wSgiQSgVvy+9mdHRgRIOr0XQGP6XL83ZwKwpKHhdwRIgbOjN8QPPQbINkD41jc2+T6COVTgFADSobmu7nfn+vzcWwDZ3C4BUkArAH77ADY1LxaEy+/qX7/mVACQFtnGzNa5Pj9PD4D1oAApcdnnNsCmFhKAsPlNunp9Vn6AOHEK+T1zfX7OBIABQEiTM8PXxY+dS5YKwrXRZ9LVO0ICgPSYbyDQLQnArp4e3s2QKn5LwboXzTZAeDY2t/g+AnhmaEiANOno6mqc/blbEoAmK3eXAClyenhQ/LqvlcGZYXlo2Urx6yxbAEiZuRoBb0kAcvnCOgFSRBsB/V4KZCIooTx+y/9n3fI/FwEhbeZqBLwlAbCz2S8IkDJd16+JH2wDhKNjyVLf5f/eUbr/kT5zNQLekgAwARBp1DUwIH493rZaEKw9y1aIX0f6PxEgfaz7Zn/mpgSACYBIKz0W5nsegFuabqtjKFBQ9LXtaPXXo6xfYxM9H0Dc6ETAXUeP3nSF5k0JQLa+nhMASCUNDJ3Xr4pfX75tlSAYT7TdIX51+tzqAeKsYfHi22b++qYEoDnj3CNASh3p7xe/tBnQ74ha3EpX/w8u91/+7xogAUB65R3n9pm/vrkHIHPrHgGQFloa9rsNoMH/iVX+V6q4mYnVv5706KICgBSbfRLgpgTAcQqbBUixA1f6xK9H3G0AegHMMbX6Pz3M8B+k2+yTADclAIwARtqZWiHuX7NOYIaJ1b96re+iAOl2c5V/OgGY775gIE10LPDpIf9d4noioIM7AnzTY39mVv+DDP9B6s0+CTCdADQ0NTUIAHeleElMePqONTQE+qCl/8dNrf4vm/maAnE38yTAdALAHQDAJF0tmqgC6MS6p1evEVRHS/9+p/4pbf7j7D8waeZJgOkEgDsAgE+ZqgLsccvXj6xkNkCl9DUzUfpXr/ax+geKso32uuLz6QQgU5dhBgAwxVQVQHkrWU4FlE1fK1ONf7r6P3KV0b/AtIn89K2A0wkARwCBm5mqAmgfwAvt99APUAYN/iZfK1b/wCyZzO8Xn04nAAWxGQIEzGCyCqB72S+sv1uwsO+s22Bk31/pkU5W/8DNHHGmG5MmEwDHsbgECLjVix+eE1PamxbJ/jvXCea2f81a9zUydxr5lYsXBMDN9Cigxnx97iUAu06dahUAt9Cz468aHCCjTYGcDLjV03fcKXuWrRRTdPuGc//A3Dq6uhr10UsA8vk8Q4CAeRy88pHXTGaKjgomCfiUBv9HVraJKfq1MjHSGUiqJVM3/3oJQEv25huCAHxKLwh68cJ5MUmTALYDJsv+JoO/0q+V30udgCQrzgLwEgDHEbYAgAVoQ6BWAkzS7YC/+MxnU3lEsNnOuH/3zxkt+yv9GjH0B1hYcRbAZBMg1wADJWkvgMmtAKWNgXrsLU1JgP5dX7r7c0Yb/pR+bWj8A8phLdf/naoAWGZrcEACaVn5ubO/Ml5e1mNvGhDTMDFQ/476dzV11K9oOJ/zvjYASnMK+c/r49QcgPxqAVCSdpYHscrUwTd6eZD2BSSxGqAl/z9d2x7YBUmv9l2m6x8okyX2dn30rgXUIUDMKAPKc/jqJ7LeLd0HsWLXvgC9Sli3G5IyxEavRdbAb3rVX6RH/g7S9Q+UrTgMyEsAGAIEVEarALpS72hdKqZpoPzWmnWyqXmxG9wuSt9EPFe2+vrs17+Hm9AERaf9mZzTAKSBNRXzrV1Hj2Ybly+eEAAV8Wb8r7/ba+QL0uH+T2KVCGi5/4nbVxs/3jebNv09+8F7HPkDqjDaP1hndXR2NrU2198QABUrzvhvq2+QoEU9EdAVvwZ93cYI+uIjDf7a9Me+P1CdgeHxRdaunp6ljXb+qgCoSphJgOoauCY/vfqJvOWWv6NgY3OLd31vkKX+mQj+gH+jhcwy64ETJ1Y31wmbaIAPYScBSgOg3laoTYlnQh5+o0F/55Jloaz2ZyL4A2Y4Oesz1t7uzg1Wtv4DAeBLLZKAomIyoFPwzo7ckLOjI2LSKre8ryt8bUzc2bo01KBfRPAHzPESgH09b+8S2zoqAHyrZRIwkzbG9WoiMDIifRNjctkNmvo5DaL6OFy4uXFOG/c0qLe4H6vc//bb3b9HW12DrG9q8pocaxHwZ9K/y/Pnewn+gCkFZ3dWABijAUo7079157pAjgiWSwO2t2IPaV8+SHrU7/sXztHtDxhmO05hgwAwRgPVd93Vqg6ogT96uc93z/US/AHTspl2KgBAQHRAzVA+53XI17qEHjc62/+Vi7+Vw1evCIBg2JLJ/jsBEAhdwT77wS+M3yKYZMUBPwR/IEATuVW2AAiU9gU8+ct3vWQAC5tMmN6j2Q8ImJOxVrEFAIRE7w/QIT7716yt+SmBqNFV/4sXznvHGAGEw+YqYCA8GuB0hUuD4Kf0tdDXhOAPhEevBM66//M7AiA02tGuDYK6x63X5Op1uWmkAf/FC+co9wM1whYAUCMa+PSI255lK+TxttWp2RbQwP/a5Uus+IEaIwEAakxn+etH0hMBAj8QLda+d044AiAydN7+47ev9h6TgMAPRI8b+M+TAAARpfcK6BAhvXkvblUBHeRz8MrH0jlwTc6O3hAA0UMCAMSANgrqLXwdS1qlORPNnTsN+p3XB+RI/yes9oEYIAEAYka3BvYsXyF36U19jYuklvSmwa6BAW++Qa+70mdmPxAfNAECMaOr6+IKW7cJ1rtJgN76513d29gUWIVAV/iXJ8blzNCQnB25IafdR00AAMQTCQAQY3qUUD/0ytwirQro5UOaEGjvgCYJ+mv9aHE/2urm7icoBvPiv1NX8zqhT5+fHRkh2AMJQwIAJEzvVNMd+/AAFsJlQAAApBAJAAAAKUQCAABACpEAAACQQnZe5LwAAIBUsTMiFwQAAKSIdZwtAAAAUogEAACAFCIBAAAgZRwp/NZ2xDohAAAgTS5RAQAAIIVsy3L6BAAApIrt5PJXBAAApIZlZ95lCwAAgBRytwDsXwsAAEiPXL43K0CENdsZ2diyWO5tXizNmYysb2qSFvexrb5BgKjoGx+ToXxePhofl97RG9I7MiK/GbkhfRPjAkRV1ilMfGjZ9QJExcbmFtm5ZJl0tLYS6BEL+n3a5j62Ny1yv2+XTn++z00ITg8NyuGrn8iZ4UEBosIp2B9SAUAk6Er/kdtWSceSpd6bKJAEbfX1smf5Cu9Dk4FX+y7KGTchoDKAmnOcYWtXT8/SRjt/VYAaKAb+R1e2eSV+IOmG3a2CA1f65Ej/JyQCqJnRQmaZ1dHZ2dTaXH9DgJA9snKVPNF2B4EfqVSsCBxxtweAsA0Mjy+ydh09mm1cvnhCgJC01dXL/jXrZFPLYgHSThOB53rfpxqAUI32D9ZZ+mTfOyccAULw4LIV8swda1j1AzPotoBWAw5e+UiAMLx573bLawLMi5x3347XChCgx9tWeyV/ADfThPjpqcT4tb5LAgTJXfGf10dvEqAb/C8IEKD9a9YS/IES9Gdk/53rBAiW85b+r5cAcCUwgqTBf8+ylQKgND0y+ML6uwUIkFdmmrwLIJ/7NwECQPAHKqcNslQCEBQr73jNJl4CUHCEcygwTvf8Cf5AdbQS8PTqNQIYZ1ld+uAlANmMfU4Ag4pn/AFUT4dk6c8SYFIuJwP66CUAQznrsgCG6Dl/gj9ghv4s6c8UYErGmoz5XgKQGx+/JoAhL7Tfwzl/wBD9WdLBWYApY5nMiD56CUBXR8eoAAbsWbbCuwAFgDnaFMhWAEw5tnmztwUweRugZTn5d04wDAi+aJny8YBK/8P5nHReH5CzIzfkzNCQd/d638SYALWmK/Tb6xpkfVOTF6g7lrS6nzN/0apuBei1wjo1EKiWNwTIjfn6fPq7dGoYEAkAqqYNS6ZX/33jY954VN74EFX6fdmbvyG9oze871OllTA9BdNW3yCmaKKhVQAmBcKfySFAyp7+nCX/IECVdPX/yMo2MUVX/PpG9+Qv3/USAII/4kQTAf3efeWi2SGrXJsNv6y8807x+XQCkJ/Ivy9AlUze7Ker/mc/eM+7HAWIM01en/zlGe972oRiFQCoWl3ml8Wn0wkAswDgh6m9f32jfO7sr7wrUoEk8K77db+ne0duiAmPGqy0IX1yo4VzxefTCQCzAFCtjc0tRvb+Cf5IKv2efv58r5FKgFYBNjWbq7ghXXLZ7G+Kz6cTgMzg4McCVOEhQ+N+Cf5IsmIlwEQ/y32trQJUY2xkZDoLnU4Aju3enctP3REMVGKjgf1/bfgj+CPp9HvcRG/LziXLBKhG186dI8Xn9szfsKXwlgAV0O5/v+V/LYvS8Ie00MZAv1sB+jO3ioFbqJAjzuszf31TAiB554gAFVjftEj8epVzzUgZTQL8og8AlZp5BFDdXAGw7W4BKrCppUX80P3QI1e5jRrpYmKwlU4eBCoydQ1w0U0JACcBUKm2On+Tzjqvcw8V0keDf+f1q+LH7QanDCIdnLx107yfmxIATgKgUqt8vgmdHhoUII30Tgs/uCIYlbo+6+bfmxIATgKgUi0ZW/w4O2pmOAoQN34HAwVx4RCSSy8BmnkCQN3y7s1JAFTC72UnHP1DWvVN+Pve59ptVMY5MPszty7fOAmAEHHJD9KK732EybLtn83+3K0VAE4CAACQKDPvACi6JQG4dmPilwIAABJj5h0ARbckAF0dHaMCAAAS49iWLbecub61B8CyHEcKrwtQBr8jTRlnirTy28RHDwHKNXsEcNHcZ7hoBASAQDXbGfFjiAQAZbIkc3iuz8+ZANAIiHIN5Qvix+11TDNDOjVn/CUAw/mcAOVwcs4/z/X5ORMAGgFRLr9vQmwBIK1afA7yGSpQAUB5ro+N/Xauz8+ZAOi0ICYCohx9E/56AFp8roKAuKIHAGGYawJg0bxzXG2xDghQgt83ISoASCu/CcBlnw24SAtn3lg+bwJQyOV+JkAJfkf5cqMZ0mp94yLx4yPGaKMMVkH+fr7fmzcBmLDrjwpQgt8EwO+bIBBX7U3+vvfPjowIUMqoZE/N93vzJgDHNm8eEKAEv7f5aRm0mT4ApIx+z/v9vh8qcAoApS0Uy+e/y5WBQCiDidv8NjUvFiBN1jc2iV9UAFCKNwDIjeXz/f6Cl7kXcg4JAErq9flGtLGlRYA02dTiL+k9O+Kv8oZ0sGx7wRi+YAIw6mTeEqCEs6PD4kc7fQBIGb9Vr74JGgBRmjPmLBjDF0wAfr5t22UBSvBbitTVEH0ASAv9XvdbATg9NChAKYdKxPAFEwD6AFAOE3uR9AEgLUx8r7P/j1JK7f+rhRMAoQ8ApZ0eHvQ9EKijdakAabBzib/vdf1Z0585YCGl9v9VyQSAeQAoR6/PpiR9U2QbAGngN9ntHaUBEKWN5uySsbtkAqBnCLkXAKV0Xb8mfmjwpxkQSbdn2QrfiW7XgL+fNaTDsS1bSn6jlEwAdA+BewFQiommpMfbVguQZB1L/G91Uf5HKY44Pyznz5VOAPQPOYX/KcACzo6O+O4D4DQAkqytrt53+b9vfIwGQJSUH5eyYnZZCcC1GxO/FKCEw1eviF+PrFwlQBI90XaH+HV6eEiAUoYnyovZZSUAU3cJHxdgAV0D/q+PeHRlG1UAJI6u/je2+D/+d6T/EwEW5hyfitkllZUAqHwu/6IACzBxHFCDP1UAJM2Dy1d4F1/5oeV/9v9RWuZH5f7JshMAjgOiHAeu9IlfVAGQJLr637NspfjVeZ3uf5Q2WrD+ttw/W3YCwHFAlOPglY/EL6oASBITq3/19wZ+tpBsjhujyzn+V1R2AsBxQJTDm1Jm4EigVgF05QTEmX4Pm2n+GzRy9TaSzcoXXqnkz5efAKjc2EsClPBa3yXxS6sA+9esEyDOTAR/dZjmP5TBcTJ/U8mfrygBOLS1o1eAEiZXK2Pil84FMDE4BagFnfqn5X+/9GfpyFUSAJQ2dv36uUr+fGUVAO92QKusCUNINxNVAPUttwpAQyDiRkv/jxta/b9q6GcJyabT/47t3p2r5J+pLAEQpgKiPNqx7PdIoNLg/6dr2wWIEy39m2j8Y/WPsuXsirfoK04A3rh3+ykBStDg/2rfRTFBtwI4FYC40DstTJT+Fat/lKvS8r+qOAFgGwDl0iOBJnoB1NN3rJFNzf4nqQFBam9sMtb4x+of5aqm/K8qTwCEbQCU78UL5kZH6KkAjgYiqvR78zvrNogprP5RtirK/6qqBIBtAJRLTwSYmAugdE/1hfZ7aApE5DTbGe9708S+v9KfG1b/KFc15X9VVQLANgAq8T8ufiimeEnA+rsFiBKTwV+9eOGcAOWotvyvqksAhG0AlK939IaREcFF7U2LZP+d6wSIgv1r1rrfk01iih6hZeofylZl+V9VnQDoNgB3A6BceiLAVEOg2rN8BUkAak6Dv4mLfor0Z8TU6Rmkw6GtW6se0Fd1AqDbAJYjLwtQBj0WaLIhUBWTAHoCEDbd8zcd/NVzZ38lQPnspzQWS5WqTwBc406GBABl08amg4ZvNNMkQHsCSAIQlmLDn+ngT+kflXImCv8oPvhKAPTaQbYBUIlXLl6Q3pEbYpL2BLz0mc9xRBCB0++xl+7+nNE9f0XpH5Vzjh/avt3XWVFfCYDKFJwnBajA8+d7jYwJnql4RHB94yIBgrCxucV4t7/S4E/pH5XL/Eh88p0ADIxM/IsAFdAy53fPmb9YUt+YX7r7s94oVsAkHUX93wII/uqVix9S+kfFRvsHfiw++U4AunbuHGEmACql/QCvBTTpTEexanMgWwLwS/f79TIqHUUdBP0Z6Lp+TYBK+Dn7P5PvBMD7lzATAFXQPU/TTYFFXnOgu2Lj/gBUS0v+ut/f0bpUgqDf++z7oyo+zv7PZIkJjmPtOd39m4zIWgEqpF38euNfUA5+7L7RfnTReN8BkklX/U/cvtot+7dJULQC9lwv+/6onCNy/tCmbXf5Of5XZKQC4P2H5PLfFKAK3z3fa/xkwEyP3LbKOyXw4DIzV7QiuYqr/iCDv36vB9EDg3SwxH7eRPCf/HcZsqunZ2mjnb8qQBWKM/7b6hskSIf7P3H3XS9K3wRNV/iU9ovoPn9Q5f6iYsc/TX+o1mj/YJ2J/X9lLAFQe9/p/oElzjcEqEJYSYAq9h+wLZBuWu7XCtGj7oo/6GFSBH/4pc1/h+7dYazabjYB6O7eYGWdDwSoUphJgL4RayLAtavppMdFwwj8iuAPE5yc9ZlD27b9WgwxmgDQDAgTNAn4ztp2b8JfGEgE0mXPshVu8L8jkDP9c9E9fw3+VJvgj3P8zXt3PCAGmU0AXPt63t4ltnVUAB90VfatO9cFvic7UzER6Bq4JsMF3qyTJMxS/0x6xv/7F84R/GGA/dSb9279KzHIeAKgVYB9p7sLAhigjVk6hS1MmgicHhqkWTABahX4lfaY6N0XgAkmm/+KzCcArodOnfhj25LvCWCATvar1XhfPTVw2N0aODM8KIgPPc6n3zdBzpdYiI73PXilTwAzzK/+VSAJAEcCYVrHkqVuNeDOUJoD56JVgcNXr8gRNyGgKhBNq+rqvQmQtVjtFw3nc/Ldc2e9QT+AKQPD44t07L4YFkgCoDgSCNPCPCGwEN0e8KoC7iPJQG1piV+DviaItVrtF2mzn950Sac/TDJ99G+mwBIAqgAISi23BGbTZEAbvbRxkGQgHLrS39m6NBJBv4j9fgTF9NG/mQJLANS+d0783H24XwDDar0lMBdd+Wki0OkmBPQMmKOr/PVNTbJzyTLpaG2N2Nd8TF68cJ6SPwJi/ujfTIEmAA+fenuLY1knBQiAbgloNSCqM/61OqCB4fTQEAlBBYoBX1f3epujzoOo1Z7+Qjjih6AFufpXgSYADAZCGCYHu6yO1MpwLpoQnB0ZkXfcZOAjd+V4dtR4T08saUlfg3174yLZ2NIS2gCoaumqX7v8NQEAghPs6l8FmwAIg4EQjqhXA+aiK0dtHNOkoG9izH0+4j6/kdghRLqy16/TejfAa7DXVX5UV/fz0b1+HRbFqh9BC3r1rwJPAKgCIExROSngRzEx8B5Hb3iJgT7XledHEW801NW8vvb6dfA+6hq8QH+7+7k4BfrZdCvntcuX2OtHSJzjo/1Du00P/pkt+ARAqAIgfHHZFqiGJgOX3WRgMikY9x6HCrnp42fFRz2TPjRjpVpu8qBBvKjFDdrNmaz3vDg7Xx9b7KwX0PX3V+mvM5lEvtaadL3ad4l7IhCugrP7zS07jknAQkkAqAKgVpKcCCA4mjwdvPKxHLjSR7kfIQtn9a/CSQCEKgBqR1ese5atlAeXLScRwIII/Ki5kFb/KrQEgCoAao1EAPMh8CMawlv9q/ASAKEKgOhgawBK9/i1s19HOxP4UXMhrv5VqAkAVQBEjSYCDy5f4Q2cQXrQ1Y/oCXf1r8JNAIQqAKKpOEdAr5GlKpBMxTJ/58A1OTt6Q4BICXn1r0JPAKgCIOq0KtAxddkM4q+42teZCpT5EU3hr/5V+AmAUAVAPGhVQLcG2CKIHw36ejETe/uIgzCm/s2lJgkAVQDEDclA9BH0EU/Bz/yfT20SANfe7u4NVtb5QICYKSYDeoFNx5LW6Ul5CJfu6XdeH5AzQ4PeFcwEfcRRrVb/qmYJgNr7ztv/xxLrMQFiTJMBnXevfQNUB4KjAb93dMQN+EPTVy0D8Va71b+qaQKwq6dnaaOdvypAgsxMCNobm6gQVEkD/unhoelrlGniQ9LUcvWvapoAqL3vdP/AEucbAiSUXn2rF+boloF3BS5JwS2Kq/uzU1cin3ZX+XpFMpBUjjg/PHTvjm9KDdU8AaAKgDQqJgVeQtA0+fz2uvrEJwYa6C9PjE8Her25UJ8T7JE2o/2DdWEf+5ut5gmA2tPd/Wgm6/ydACnXVtfgNRnqxyrv8dNf6+9FnXcFcWHymuLJjzH5aCrI69XEBHpA2U+9ee/Wv5Iai0QCwLFAoDzNmYxbKWjwHvVDEwN9bHErB5OPk58v/tmWqeeq3ARidpDWQD7zUffhh9xA/9GMz+vHUCHHHj1QUm2G/swlGgmAMBwIAJACNRj5O5/IJABq3zsnfu4+3C8AACRObY/9zWZLhIwWMl8SAAASyMnZ/0kiJFIJwLEtW645Yv1QAABIFPupWp75n0ukEgA11n/9j/Ii5wUAgIQY7R/4sURM5BIA7YzMFJwnBQCAJCg4kej6ny1STYAz0RAIAIi/aDX+zRS5CkARDYEAgLgbGJ54SCIqsgmANgTmc9ZXBACAWLKf6tq5c0QiKrIJgDq8detBGgIBAPGjE/+i1/g3U6QTALEsZ3RCOgQAgBjRM/9RbPybKdoJgOvn27dfYjYAACA+onfmfy6RTwAUswEAAPEQ/dJ/UWSPAc728KnOLY5Vf1IAAIgoJ2d9Jg6rfxWLCoB6Y/POHrYCAADRFY/Sf1FsEgDFVgAAIJriU/ovis0WQNEDJ06sbq6TiwIAQETEqfRfFKsKgNJTAeLItwUAgEiIV+m/KHYJgHrz3m0vuA/HBQCAmopf6b8olgmANyCIuwIAADU2Wsh+KeoDf+YTzwRAuCsAAFBjes2vG4skpmKbAKjD27YdcMR5XQAACJVz/M0tO45JjMU6AVBj/UNPcDQQABCWvCPnR/uHdkvMxe4Y4FyYEggACIvlOFvf2LyjR2Iu9hUApVMC6QcAAATPfioJwV8logLgcRxr3+nun7nP7hcAAIxz9/03bf+CnkSTBEhEBcCjRwP7B3fTDwAAMG163z8hwV8lpwIwhX4AAIBpSdn3nyk5FYAp9AMAAIyyra8kLfirxFUAPI5j7T194n9bYj0mAABUzd33v3fHA5JAiasAeNw9GuYDAAD80Tn/8T/vP59kVgCm7OrpWdpo568KAAAVGi1klsV51G8pyawATNEvnOWMbxUAACoR8zn/5Uh0AqC0KdCR/B8IAADlsK2vxH3OfzkSvQUwjaZAAEBZktv0N1viKwCeqaZA99lxAQBgTslu+pstHRWAKR0XOpta+uvfy4isFQAApuikv4mrgxuO7d6dk5RIVQKg9nZ3b7CyzgcCAMAUZ0LuOLR9+yVJkXRsAcxwaNu2X2t3pwAAoNyYkLbgr1KXACjt7mRcMAAgLR3/c0llAqAOb9t2wBHrhwIASKWCI99+c+O2A5JSqesBuAnHAwEgpZzjb27a/oUkXe9bqdRWADwcDwSAFJo67pfi4K/SXQGYsuvo0Wzj8sVH3af3CwAgwSaDf5qO+82HBGAKMwIAINn0rP/QivHPdq3ZOSIgAZiJ2wMBILkGlo8vIvh/Kt09ALPozU9OzvqMAAASpd59byf434wEYBYdFMQVwgCQHJbjbP2/OgQONyEBmINeIcy0QABIAPe9/I3NO3oEt6AHYAH7et7eJbZ1VAAA8eMG/7RO+SsHCUAJJAEAEEME/5JIAMpAEgAAMULwLwsJQJlIAgAgBgj+ZSMBqABJAABEGMG/IiQAFSIJAIAIIvhXjASgCiQBABAhBP+qkABUiSQAACKA4F81EgAfSAIAoIYI/r6QAPj08KnOLY5Vf1IAAKHR8b5M+POHBMCAvd3dG6ys84EAAAKnF/sw298/EgBDOi50NrX017+XEVkrAADj8o6cn3Aym/XmVoFvXAZkiF4zObR8/LPu0+MCADDMOT60YvyzBH9zSAAM0iRgtH9QbxEkCQAAY5zjo/1Du/U9VmAMCYBhx3bvzpEEAIAZjjiva/DX91aBUfQABMVxrH3vdD/nvsLfEwBAxdzg/8NDm7bvF8tyBMaRAARsT3f3o5ms83cCACifbX3lzY3bDggCQwIQAgYGAUAFGPATChKAkDxw4sTqxjrp4pggAMxNj/k15a0HOeMfDpoAQ/Lz7dsvTfQPbhCaAwFgDpPH/Aj+4SEBCBEnBADgVsVOf475hYstgBqhORAANPjn/+DQpn//V3T6h48EoIZoDgSQZlzoU1skADW2q6dnaaOd/4n79H4BgBRgpn800ANQY/oDQF8AgLTQ/f6Jq4MbCP61RwUgQugLAJBoOtzn81sPst8fDVQAIuTwtm0HLGd8a17kvABAQmjJX/f7vcl+BP/IIAGImDc27+xhXgCA5HCOa8mfZr/oYQsgqhzH2tvzr1+3Mpm/FACII0r+kUYCEHEPn+rckrPqDzBCGEBcaMk/K86jrPqjjS2AiGNLAECcFLv8Cf7RRwUgRhgcBCDSuMI3VkgAYobBQQCixzk+Wsh+ibP98UICEEO7jh7NNrQuepIGQQC1VnDk2z+9d9sLNPrFDwlAjO3t7t5gZZ2/FqoBAEKmjX52TjoObd9+SRBLNAHG2KFt236tY4SdfP4PBABC4ojzQ230I/jHGxWAhKAaACBoHO9LFioACUE1AECQiqt+gn9yUAFIIKoBAExhrz+5SAASipMCAHxjlG+ikQAkXEdnZ1Nrc/1PhWoAgLJxrj8NSABSgimCAErRcn/GcZ58c8uOY4LEowkwJfQHerR/sI4mQQBzKTb5EfzTgwpACtEkCOBTlPvTigQgxaa2BZ4XEgEgdSj3gwQg5TgtAKQQ3f0QEgBM8RKB5S1/bon1DQGQSLrPP1bI/lfK/VAkALgJ/QFA8riB/3U38D9D4MdMJACYE4kAEH/eFL+89aCOChdgFhIALIhEAIif6Qa/zdv/mX1+zIcEACVpf0Dj0pb7OTEARBuBH5UgAUDZSASAaCLwoxokAKgYiQAQDQR++EECgKqRCAC1QeCHCSQA8M2bIbBkyTqaBYFgEfhhEgkAjOLUABAE57idyf6Xf/x3m98h8MMUEgAEQhMByRaeZbIgUD0m9yFIJAAIVMeFzqYlH2ce564BoAKOfHvUybxM4EeQSAAQihmXDn1N2B4AbsH+PsJGAoDQsT0AfErL/JKzXzq0dWsvgR9hIgFAzRSrAgU78ycZS9YKkBLeal+sb4469lHK/KgVEgDUnuNYe0+ebKcqgKTT1X4mk/0x3fyIAhIARAq9Akia4t7+wMjEv3Tt3DkiQESQACCyHjhxYvUiO/9FThAgbiZL/PIynfyIMhIARB9bBIgJSvyIExIAxEpx7DDJAKKCoI+4IgFAbJEMoFYI+kgCEgAkQjEZcDLOV91342c4VgiTdE/ftpwDkpt46dDWDs7rIxFIAJBIu3p6ljY441/lNAF8OC6O9aJ3Vn/z5gGCPpKGBACJp/cRLBtouiefz32NrQLMp7jK19L+jY+vvXts9+6cAAlGAoDU0epAo1XY7Uj+McuyHxOkluMUXrck8zqrfKQRCQDSzXGsB7q7b2/OWveRECRfMeAP55y3fr5t22UCPtKMBACYyU0Idp061doouc2OLV8uONajNBTGU7Gkbzn2z1jhA7ciAQBK0B6CJR81/I5YuV1iWw9SJYgmXd07VvZwNmN1X20deb9rDWN3gYWQAABV0D6CRXWyrpAr3OVYhS9QKQiPt7KXwls3Bfs7O0ZZ3QOVIQEADNFKQbavfmlzxrmnYFn3WVLYTLWgerMD/eBovi8zOPgx3fmAGSQAQMA0MWi40tRQrBgUxLlHk4OC2PelvWrgXZpjyYWCI/9gi/W+nbV/Q6AHwkECANTSVNNhPp9vWtyYaStM5JZ61QPLaXN/b3Wck4RicHfEOeFI5l3bcfqLAT7XNn6Nsj1QWyQAQAzoqOOxDQ11WknQZGGRNd5s2XV36u8V7Ey7PlqS//z0P+AmD+72w+/M+FeUPQ2xGLhnfk6D+OS/1uoTy/5Yn9uFfK/3ucLEh/o4ZjddGVs5Mtbw67EJVu9A9P1/chzdCoDsCuEAAAAASUVORK5CYII=";function l(e){switch(e){case 1:return r.k$.OneToOne;case 2:return r.k$.GroupCall;case 3:return r.k$.Meeting;case 4:return r.k$.Chat;case 5:return r.k$.Reply;case 6:return r.k$.ReplyToReply;case 7:return r.k$.Like;case 8:return r.k$.Mention;case 9:return r.k$.Download;case 10:return r.k$.AppUpdated;case 11:return r.k$.NeedMoreDiskSpace;case 12:return r.k$.TeamMembershipChange;case 13:return r.k$.Follow;case 14:return r.k$.OneToOnePstn;case 15:return r.k$.Thirdparty;case 16:return r.k$.MessageSendFailed;case 19:return r.k$.CallTransferFailed;case 20:return r.k$.ShareFromChat;case 21:return r.k$.Inferred;case 26:return r.k$.Trending;case 27:return r.k$.MeetingWentLive;case 28:return r.k$.PresenceStatus;case 29:return r.k$.Reaction;case 30:return r.k$.Priority;case 34:return r.k$.TeamsTasks;case 35:return r.k$.Dlp;case 36:return r.k$.TeamsEngagementActivity;case 37:return r.k$.MsGraph;case 38:return r.k$.StaffHub;case 40:return r.k$.CallAnsweredElsewhere;case 41:return r.k$.CallSafeTransferRingback;case 42:return r.k$.SkypeConsumerCall;case 43:return r.k$.SpamCall;default:return r.k$.Default}}var c=n(793579),d=n(447862),u=n(746552),m=n(589504);class g{constructor(e,t,n,i,a){this.loggerFactory=e,this.coreSettings=t,this.callingAppEventsService=n,this.hostCommunicationService=i,this.loggingService=a,this.logger=this.loggerFactory.newLogger("CallingNotificationService","services-io-calling-service-adapters"),this.logger.log("Instantiated CallingNotificationService"),this.notificationsMap=new Map,this.callToNotificationMap=new Map,this.toastSettings=new m.b(e,this.hostCommunicationService)}createNotificationWithActions(e){var t,n;const{enableCallingNotifications:i,enableOutgoingVideo:s,enableIncomingCallCrossClientTelemetry:c}=this.coreSettings.get(a.J.Calling);if(!i)return this.logger.log(`[createNotificationWithActions] Feature flag enableCallingNotifications, current value: ${i}), is required for incoming call notifications is not enabled`),this.getNoopReturnValue();const d=(0,o.v4)(),u=Date.now(),m=[],g=[],p=e.sourceId||"sourceId";if(e.actions)for(const t of e.actions){const e=t.actionType;if(!e||"Unknown"===e)return this.logger.error(`[createNotificationWithActions] unknown action type for action ${t}`),this.getNoopReturnValue();s||"AcceptIncomingCallWithVideo"!==e?(m.push({actionType:e,id:d,label:t.label||"",icon:this.getNotificationIcon(t)}),g.push({action:t.action,actionType:e})):this.logger.log(`[createNotificationWithActions] Feature flag enableOutgoingVideo, current value: ${s}), is not enabled video button cannot be added`)}(null===(t=e.timeoutAction)||void 0===t?void 0:t.action)&&g.push({action:e.timeoutAction.action,actionType:"TimeOut"}),this.addTelemetryCleanupActions(e,g),this.notificationsMap.set(d,g);const v={typeName:"calling-content-event",action:{visibility:r.cP.Show},content:{id:d,contentType:"notification",image:this.getDefaultImage(e.toastType),title:e.title,subtitle:this.getSubTitle(e),time:u,userid:e.callerMri||"",type:l(e.type),primaryAction:(null===(n=e.primaryAction)||void 0===n?void 0:n.actionType)||"AcceptIncomingCallWithAudio",actions:m,toastType:e.toastType||l(e.type)}};e.headerData&&e.headerData.headerTitle&&e.headerData.headerMessage&&e.headerData.headerMri&&(v.content.header=this.getHeaderData(e));const h=this.getRingtoneAssetUrl(e.ringtoneCallType);h&&(v.content.ringtoneAssetUrl=h),c&&(v.content.callId=e.callId,v.content.crossClientScenarioName=e.crossClientScenarioName),this.sendMutedNotificationTelemetry(e,!!c);const f={event:v,context:{source:{name:"CreateNotificationWithActions",description:e.sourceId||"undefinedContextName"}}},y=v.content;return this.logger.log(`triggering callingAppEventsService id=${y.id}, type=${y.type}, sourceId=${e.sourceId}, callId=${e.callId}`),this.callingAppEventsService.trigger(f),this.callToNotificationMap.set(p,f),this.getNotificationWithActions(p)}executeCallingToastCallback(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.canTryGetEntriesForToastId(e,t))return Promise.resolve(!1);const i=this.tryGetEntriesForToastId(e);if(!i)return Promise.resolve(!1);const a=this.tryGetEntryForActionType(i,e,t);return a?this.tryExecuteCallback(a,e,n):Promise.resolve(!1)}))}canNotifyForActionNotification(){return this.logger.error("[canNotifyForActionNotification] NYI"),!0}getAppUserSettings(){this.logger.error("[getAppUserSettings] NYI");return{soundsSettings:{alertSound:"All"}}}getAriaShortcutLabel(){return this.logger.error("[getAriaShortcutLabel] NYI"),""}getCallGroupMembershipSettings(){var e,t;const{voiceAdminSettings:n}=this.coreSettings.get(a.J.Calling);return Promise.resolve({callGroupMembershipDetails:null!==(t=null===(e=null==n?void 0:n.callGroupMembershipSettings)||void 0===e?void 0:e.callGroupMembershipDetails)&&void 0!==t?t:[],callGroupNotificationOverride:"Ring"})}cleanupNotificationsTelemetry(e,t,n){this.logger.log(`[cleanupIncomingCallTelemetry] Handling incoming_call scenario with reason=${n} for sourceId=${e}, actionType=${t}`);const i=this.callToNotificationMap.get(e);if(i&&i.event&&"content"in i.event&&i.event.content&&"notification"===i.event.content.contentType){const e=i.event.content.id;this.notificationsMap.has(e)&&this.executeCallingToastCallback(e,t,n)}else this.logger.error(`[cleanupIncomingCallTelemetry] Corresponding event not found for [sourceId: ${e}`)}getPanelActionScenario(){return this.logger.error("[getPanelActionScenario] NYI"),c.Lc.closeActiveCallBanner}isSfCNotificationEnabledDesktop(){return this.logger.error("[isSfCNotificationEnabledDesktop] NYI"),!0}isSpamNotificationEnabledDesktop(e){const{enableSpamCallNotification:t}=this.coreSettings.get(a.J.Calling);return Boolean(!e||t)}shouldMuteAudio(){return this.logger.error("[shouldMuteAudio] NYI"),!1}populateNotificationState(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this.toastSettings.getGlobalNotificationSettingsAsync();if(!t)return;this.logger.log(`globalNotificationSettings fetched: ${t.global}`),e.appendEventData({osNotificationState:t.global})}catch(e){this.logger.log("Error while fetching global notification settings:",e)}}))}getDefaultImage(e){return e&&{MeetingStart:"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTkyIDE5MiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjZWRlYmU5IiBkPSJNMCAwaDE5MnYxOTJIMHoiLz48cGF0aCBkPSJNNzguNTI4IDEwMC4xMWE1LjEzOSA1LjEzOSAwIDEgMCAwLTEwLjI3NyA1LjEzOSA1LjEzOSAwIDAgMCAwIDEwLjI3N3ptMjIuNjEyLTUuMTM5QTUuMTM5IDUuMTM5IDAgMCAxIDk2IDEwMC4xMWE1LjEzOSA1LjEzOSAwIDEgMSAwLTEwLjI3NyA1LjE0IDUuMTQgMCAwIDEgNS4xNCA1LjEzOHptMTIuMzMyIDUuMTM5YTUuMTM4IDUuMTM4IDAgMSAwIDAtMTAuMjc4IDUuMTM4IDUuMTM4IDAgMCAwIDAgMTAuMjc4em0tMjkuODA1IDExLjMwN2E1LjE0IDUuMTQgMCAxIDEtMTAuMjc4IDAgNS4xNCA1LjE0IDAgMCAxIDEwLjI3OCAwek05NiAxMTYuNTU2YTUuMTQgNS4xNCAwIDEgMCAuMDAxLTEwLjI3OUE1LjE0IDUuMTQgMCAwIDAgOTYgMTE2LjU1NnpNNTkgNzEuODQ3QzU5IDY0Ljc1NCA2NC43NTIgNTkgNzEuODQ3IDU5aDQ4LjMwNkMxMjcuMjUgNTkgMTMzIDY0Ljc1NCAxMzMgNzEuODQ3djQ4LjMwNmMwIDcuMDk1LTUuNzUgMTIuODQ3LTEyLjg0NyAxMi44NDdINzEuODQ3QzY0Ljc1MiAxMzMgNTkgMTI3LjI0OCA1OSAxMjAuMTUzVjcxLjg0N3ptMTIuODQ3LTcuNzA3YTcuNzA2IDcuNzA2IDAgMCAwLTcuNzA3IDcuNzA3djMuNTk2aDYzLjcydi0zLjU5NmE3LjcwNiA3LjcwNiAwIDAgMC03LjcwNy03LjcwN0g3MS44NDd6bS03LjcwNyA1Ni4wMTNjMCA0LjI2IDMuNDUgNy43MDcgNy43MDcgNy43MDdoNDguMzA2YTcuNzA0IDcuNzA0IDAgMCAwIDcuNzA3LTcuNzA3di0zOS41N0g2NC4xNHYzOS41N3oiIGZpbGw9IiMyMTIxMjEiLz48L3N2Zz4=",MeetingStartFromLobby:"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzUgMzUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZmlsbD0iI2VkZWJlOSIgZD0iTTAgMGgxOTJ2MTkySDB6Ii8+CiAgPHBhdGggdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNywgNykiIGQ9Ik02LjUgNy41QzcuNzQyNjQgNy41IDguNzUgNi40OTI2NCA4Ljc1IDUuMjVDOC43NSA0LjAwNzM2IDcuNzQyNjQgMyA2LjUgM0M1LjI1NzM2IDMgNC4yNSA0LjAwNzM2IDQuMjUgNS4yNUM0LjI1IDYuNDkyNjQgNS4yNTczNiA3LjUgNi41IDcuNVpNNi41IDYuNUM1LjgwOTY0IDYuNSA1LjI1IDUuOTQwMzYgNS4yNSA1LjI1QzUuMjUgNC41NTk2NCA1LjgwOTY0IDQgNi41IDRDNy4xOTAzNiA0IDcuNzUgNC41NTk2NCA3Ljc1IDUuMjVDNy43NSA1Ljk0MDM2IDcuMTkwMzYgNi41IDYuNSA2LjVaTTMgOUMzIDguNDQ3NzIgMy40NDc3MiA4IDQgOEg5QzkuNTUyMjkgOCAxMCA4LjQ0NzcyIDEwIDlWMTMuNUMxMCAxNS40MzMgOC40MzMgMTcgNi41IDE3QzQuNTY3IDE3IDMgMTUuNDMzIDMgMTMuNVY5Wk00IDlWMTMuNUM0IDE0Ljg4MDcgNS4xMTkyOSAxNiA2LjUgMTZDNy44ODA3MSAxNiA5IDE0Ljg4MDcgOSAxMy41VjlINFpNOS42MjU1MiA2LjE0MzM0QzkuNTM2NjMgNi40NTQ5MiA5LjQwMjQyIDYuNzQ3MzkgOS4yMzA0NiA3LjAxMzE1QzkuNjQyODkgNy4wNjA1MSAxMC4wMTcyIDcuMjMzMzEgMTAuMzE0MSA3LjQ5MjQ0QzEwLjM3NTQgNy40OTc0NSAxMC40MzczIDcuNSAxMC40OTk4IDcuNUMxMS43NDI1IDcuNSAxMi43NDk4IDYuNDkyNjQgMTIuNzQ5OCA1LjI1QzEyLjc0OTggNC4wMDczNiAxMS43NDI1IDMgMTAuNDk5OCAzQzEwLjAxMDEgMyA5LjU1Njg5IDMuMTU2NDcgOS4xODc1IDMuNDIyMTVDOS4zODAxNSAzLjcwNDg4IDkuNTI5MzYgNC4wMTk1OCA5LjYyNTUyIDQuMzU2NjZDOS44NTA5MyA0LjEzNjAyIDEwLjE1OTUgNCAxMC40OTk4IDRDMTEuMTkwMiA0IDExLjc0OTggNC41NTk2NCAxMS43NDk4IDUuMjVDMTEuNzQ5OCA1Ljk0MDM2IDExLjE5MDIgNi41IDEwLjQ5OTggNi41QzEwLjE1OTUgNi41IDkuODUwOTMgNi4zNjM5OCA5LjYyNTUyIDYuMTQzMzRaTTkuNDk5MDggMTYuODU0OEM5LjgxNjE2IDE2Ljk0OTMgMTAuMTUyMSAxNyAxMC40OTk4IDE3QzEyLjQzMjggMTcgMTMuOTk5OCAxNS40MzMgMTMuOTk5OCAxMy41VjlDMTMuOTk5OCA4LjQ0NzcyIDEzLjU1MjEgOCAxMi45OTk4IDhIMTAuNzMyM0MxMC45MDI0IDguMjk0MTcgMTAuOTk5OCA4LjYzNTcxIDEwLjk5OTggOUgxMi45OTk4VjEzLjVDMTIuOTk5OCAxNC44ODA3IDExLjg4MDYgMTYgMTAuNDk5OCAxNkMxMC40MTU2IDE2IDEwLjMzMjQgMTUuOTk1OCAxMC4yNTAzIDE1Ljk4NzdDMTAuMDM3NCAxNi4zMDc5IDkuNzg0NjYgMTYuNTk5MyA5LjQ5OTA4IDE2Ljg1NDhaTTEzLjYyNTUgNi4xNDMzNEMxMy41MzY2IDYuNDU0OTIgMTMuNDAyNCA2Ljc0NzM5IDEzLjIzMDUgNy4wMTMxNUMxMy42NDI5IDcuMDYwNTEgMTQuMDE3MiA3LjIzMzMxIDE0LjMxNDEgNy40OTI0NEMxNC4zNzU0IDcuNDk3NDUgMTQuNDM3MyA3LjUgMTQuNDk5OCA3LjVDMTUuNzQyNSA3LjUgMTYuNzQ5OCA2LjQ5MjY0IDE2Ljc0OTggNS4yNUMxNi43NDk4IDQuMDA3MzYgMTUuNzQyNSAzIDE0LjQ5OTggM0MxNC4wMTAxIDMgMTMuNTU2OSAzLjE1NjQ3IDEzLjE4NzUgMy40MjIxNUMxMy4zODAyIDMuNzA0ODggMTMuNTI5NCA0LjAxOTU4IDEzLjYyNTUgNC4zNTY2NkMxMy44NTA5IDQuMTM2MDIgMTQuMTU5NSA0IDE0LjQ5OTggNEMxNS4xOTAyIDQgMTUuNzQ5OCA0LjU1OTY0IDE1Ljc0OTggNS4yNUMxNS43NDk4IDUuOTQwMzYgMTUuMTkwMiA2LjUgMTQuNDk5OCA2LjVDMTQuMTU5NSA2LjUgMTMuODUwOSA2LjM2Mzk4IDEzLjYyNTUgNi4xNDMzNFpNMTMuNDk5MSAxNi44NTQ4QzEzLjgxNjIgMTYuOTQ5MyAxNC4xNTIxIDE3IDE0LjQ5OTggMTdDMTYuNDMyOCAxNyAxNy45OTk4IDE1LjQzMyAxNy45OTk4IDEzLjVWOUMxNy45OTk4IDguNDQ3NzIgMTcuNTUyMSA4IDE2Ljk5OTggOEgxNC43MzIzQzE0LjkwMjQgOC4yOTQxNyAxNC45OTk4IDguNjM1NzEgMTQuOTk5OCA5SDE2Ljk5OThWMTMuNUMxNi45OTk4IDE0Ljg4MDcgMTUuODgwNiAxNiAxNC40OTk4IDE2QzE0LjQxNTYgMTYgMTQuMzMyNCAxNS45OTU4IDE0LjI1MDMgMTUuOTg3N0MxNC4wMzc0IDE2LjMwNzkgMTMuNzg0NyAxNi41OTkzIDEzLjQ5OTEgMTYuODU0OFoiIGZpbGw9IiMyMTIxMjEiIC8+Cjwvc3ZnPiAgCg==",CallQueueAnsweredElsewhere:s}[e]||s}getRingtoneAssetUrl(e){var t,n;const{enableCallSettingsTab:i,voiceAdminSettings:o}=this.coreSettings.get(a.J.Calling);let r="";const s=null===(n=null===(t=null==o?void 0:o.ringtoneSettings)||void 0===t?void 0:t.assignments)||void 0===n?void 0:n.ringToneAssignments;if(i&&s)for(const t of s)t.type&&t.value&&d.s[t.type]===e&&(r=`msteams-asset://${t.value.toLocaleLowerCase()}.mp3`,this.logger.log(`[createNotificationWithActions] Using  Custom ringtone: [${r}] for call type [${t.type}]`));return r}getNotificationIcon(e){switch(e.icon){case"call-video":return"msteams-asset://accept-call-video.svg";case"call-audio":return"msteams-asset://accept-call.svg";case"call-reject":return"msteams-asset://decline-call.svg";default:return void(e.icon&&this.logger.error("[getNotificationIcon] Unknown notification action icon",e.icon))}}canTryGetEntriesForToastId(e,t){const{enableCallingNotifications:n}=this.coreSettings.get(a.J.Calling);return n?!(!e||!t)||(this.logger.error(`[canTryGetEntriesForToastId] notificationId and actionType are required to find calling notification action callback. notificationId: ${e}, actionType: ${t}.`),!1):(this.logger.log(`[canTryGetEntriesForToastId] Feature flag enableCallingNotifications, current value: ${n}), required for processing call notification activation is not enabled`),!1)}dismissNotificationFromCall(e,t){const n=this.callToNotificationMap.get(e);if(n&&n.event&&"content"in n.event&&n.event.content&&"notification"===n.event.content.contentType){n.context.source.name="CreateNotificationWithActions",n.event.action.visibility=r.cP.Hide;const e=n.event.content.id;return!t&&this.notificationsMap.has(e)&&this.executeCallingToastCallback(e,"TimeOut"),n.event.content.callId&&delete n.event.content.callId,n.event.content.crossClientScenarioName&&delete n.event.content.crossClientScenarioName,this.callingAppEventsService.trigger(n),Promise.resolve(!0)}return this.logger.error(`[dismissNotificationFromCall] Corresponding event not found. No op [sourceId: ${e}]`),Promise.resolve(!1)}updateNotificationFromCall(e,t){var n,i,a,o,r,s,c,d;const u=this.callToNotificationMap.get(e);if(u&&u.event&&"content"in u.event&&u.event.content&&"notification"===u.event.content.contentType){const{title:e,subtitle:m,image:g}=u.event.content;if(u.context.source.name="UpdateNotification",u.event.content.title=null!==(n=t.title)&&void 0!==n?n:e,u.event.content.subtitle=null!==(i=t.subtitle)&&void 0!==i?i:m,u.event.content.image=null!==(a=t.image)&&void 0!==a?a:g,u.event.content.type=l(t.type),u.event.content.header&&t.headerData){const{title:e,subtitle:n,defaultImageDataUrl:i,mri:a}=u.event.content.header;u.event.content.header.title=null!==(o=t.headerData.headerTitle)&&void 0!==o?o:e,u.event.content.header.subtitle=null!==(r=t.headerData.headerMessage)&&void 0!==r?r:n,u.event.content.header.defaultImageDataUrl=null!==(s=t.headerData.headerImage)&&void 0!==s?s:i,u.event.content.header.mri=null!==(c=t.headerData.headerMri)&&void 0!==c?c:a}return"CallQueueAnsweredElsewhere"===t.toastType&&(u.event.content.subtitle=(null===(d=u.event.content.header)||void 0===d?void 0:d.subtitle)||"",u.event.content.image="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgNTIgNTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjYgNTBDMzkuMjU0OCA1MCA1MCAzOS4yNTQ4IDUwIDI2QzUwIDEyLjc0NTIgMzkuMjU0OCAyIDI2IDJDMTIuNzQ1MiAyIDIgMTIuNzQ1MiAyIDI2QzIgMzkuMjU0OCAxMi43NDUyIDUwIDI2IDUwWiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTI2IDUwLjY2NDFDMzkuNjIxNiA1MC42NjQxIDUwLjY2NDEgMzkuNjIxNiA1MC42NjQxIDI2QzUwLjY2NDEgMTIuMzc4NCAzOS42MjE2IDEuMzM1ODggMjYgMS4zMzU4OEMxMi4zNzg0IDEuMzM1ODggMS4zMzU4OCAxMi4zNzg0IDEuMzM1ODggMjZDMS4zMzU4OCAzOS42MjE2IDEyLjM3ODQgNTAuNjY0MSAyNiA1MC42NjQxWiIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLW9wYWNpdHk9IjAuMDU3OCIgc3Ryb2tlLXdpZHRoPSIxLjMyODI0Ii8+CjxwYXRoIGQ9Ik0zMy42NDIgMjIuMDY2NUMzNC4xMTkzIDIxLjU5MzggMzQuMTE5MyAyMC44MjczIDMzLjY0MiAyMC4zNTQ2QzMzLjE2NDcgMTkuODgxOCAzMi4zOTA4IDE5Ljg4MTggMzEuOTEzNSAyMC4zNTQ2TDIzLjYxMTEgMjguNTc3NUwxOS41ODY1IDI0LjU5MTRDMTkuMTA5MiAyNC4xMTg3IDE4LjMzNTMgMjQuMTE4NyAxNy44NTggMjQuNTkxNEMxNy4zODA3IDI1LjA2NDEgMTcuMzgwNyAyNS44MzA2IDE3Ljg1OCAyNi4zMDMzTDIyLjc0NjkgMzEuMTQ1NEMyMy4yMjQyIDMxLjYxODIgMjMuOTk4IDMxLjYxODIgMjQuNDc1NCAzMS4xNDU0TDMzLjY0MiAyMi4wNjY1WiIgZmlsbD0iIzQwNDA0MCIvPgo8L3N2Zz4K",u.event.content.title=t.message||"",u.event.content.actions=[],u.event.content.header=void 0),this.logger.log(`[updateNotificationFromCall] trigger calling app event.\n        [callId: ${u.event.content.callId}]\n        [id: ${u.event.content.id}]\n        [userId: ${u.event.content.userid}]\n        [title: ${u.event.content.title}]\n        [subTitle: ${u.event.content.subtitle}]\n        [name: ${u.context.source.name}].`),void this.callingAppEventsService.trigger(u,t.timeout).catch((e=>this.logger.error(`[updateNotificationFromCall] trigger calling app event failed. [error: ${e}].`)))}this.logger.error(`[updateNotificationFromCall] Corresponding event not found. No op [sourceId: ${e}]`)}getNotificationWithActions(e){return{update:t=>this.updateNotificationFromCall(e,t),cancel:t=>{this.dismissNotificationFromCall(e,t)}}}tryGetEntriesForToastId(e){const t=this.notificationsMap.get(e);return t||this.logger.error(`[tryGetEntriesForToastId] entries for calling toast with notificationId ${e} not found in notifications map`),t}tryGetEntryForActionType(e,t,n){const i=e.find((e=>this.isMatchingAction(e,n)));if(!i){const e=this.removeFromMap(t);this.logger.error(`[tryGetEntryForActionType] no entry for actionType ${n} found for calling toast activation. ${e}`)}return i}tryExecuteCallback(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e.action){const e=this.removeFromMap(t);return this.logger.error(`[tryExecuteCallback] no action is defined for calling toast activation with notificationId ${t}. ${e}`),Promise.resolve(!1)}try{yield e.action(n),this.logger.log(`[tryExecuteCallback] callback action was executed for calling toast activation with notificationId ${t}.`)}catch(e){this.logger.error(`[tryExecuteCallback] callback action threw an exception with with error: ${e}`)}finally{this.logger.log(this.removeFromMap(t))}return Promise.resolve(!0)}))}isMatchingAction(e,t){return e.actionType===t}removeFromMap(e){return`Notification with id ${e} removed from map: ${this.notificationsMap.delete(e)}`}getNoopReturnValue(){return{update:()=>{},cancel:()=>{}}}addTelemetryCleanupActions(e,t){var n,i;(null===(n=e.acceptTelemetryCleanupAction)||void 0===n?void 0:n.action)&&t.push({action:e.acceptTelemetryCleanupAction.action,actionType:e.acceptTelemetryCleanupAction.actionType}),(null===(i=e.dismissTelemetryCleanupAction)||void 0===i?void 0:i.action)&&t.push({action:e.dismissTelemetryCleanupAction.action,actionType:e.dismissTelemetryCleanupAction.actionType})}getSubTitle(e){const t=e.subtitle||"";return e.type===u.qp.spamCall?`⚠️ ${t}`:t}getHeaderData(e){const t=e.headerData||{};return{defaultImageDataUrl:this.getDefaultImage(e.toastType),title:t.headerTitle||"",subtitle:t.headerMessage||"",mri:t.headerMri||""}}sendMutedNotificationTelemetry(e,t){if(!e.audio&&e.crossClientScenarioName&&e.callId){const n=this.loggingService.findScenarioByNameAndId(e.crossClientScenarioName,t?e.callId:String(e.teamsCallId));null==n||n.appendEventData({notificationSetting:"calling_notifications_muted_from_user_settings"})}}}},375833:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var i=n(361366),a=n(296154),o=n(343324),r=n(726059),s=n(875467);class l{constructor(e,t,n){this.scenarioFactory=t,this.logger=e.newLogger("CallingDialogServiceAdapter","services-io-calling-service-adapters"),this.callingAppEventsService=n,this.dialogCallback=new Map,this.dialogData=new Map}open(e,t={}){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log(`[open] Opening ${e} dialog in dialog service`);const i=(0,a.v4)(),l=this.scenarioFactory.newScenario(o.RG.CallingDialogOpen);l.clientId=i,l.appendEventData({dialogName:e,tabItemId:t.tabItemId,dialogTitle:t.dialogTitle,alertTitle:t.alertTitle,confirmMessageTitle:t.confirmMessageTitle,correlationId:i,dialogCode:t.dialogCode});const c=(e=>{if(!e)return[];const t=[];return e.postConfirmCallback&&t.push({name:r.lR.PostConfirm,action:e.postConfirmCallback}),e.preCloseCallback&&t.push({name:r.lR.PreClose,action:e.preCloseCallback}),e.postCloseCallback&&t.push({name:r.lR.PostClose,action:e.postCloseCallback}),e.preActiveElementIds&&t.push({name:r.lR.PreActiveElementIds,action:e.preActiveElementIds}),e.closeByDocument&&t.push({name:r.lR.CloseByDocument,action:e.closeByDocument}),t})(t);this.dialogCallback.set(i,c);const d=(e=>{if(!e)return[];const t=[];return e.dialogTitle&&t.push({title:r._d.DialogTitle,text:e.dialogTitle}),e.dialogText&&t.push({title:r._d.DialogText,text:e.dialogText}),e.primaryButton&&t.push({title:r._d.PrimaryButton,text:e.primaryButton.text||""}),e.confirmMessageTitle&&t.push({title:r._d.ConfirmMessageTitle,text:e.confirmMessageTitle}),e.confirmMessageHtmlBody&&t.push({title:r._d.ConfirmMessageHtmlBody,text:e.confirmMessageHtmlBody}),e.okButtonText&&t.push({title:r._d.OkButtonText,text:e.okButtonText}),t})(t);this.dialogData.set(i,{dialogContent:d});const u="calling-content-event",m={visibility:s.cP.Show},g={source:{name:"DialogOpen",description:e}},p={event:e===s.WB.OptionsSettings?{typeName:u,content:{contentType:"calling-external-settings-pane",tabItemId:t.tabItemId},action:m}:{typeName:u,content:{contentType:"dialog",id:i,name:e,dialogActions:c.map((e=>e.name)),dialogStrings:d},action:m},context:g};l.mark(o.ck.BeforeCallingDialogCallingAppEventTriggered);try{yield this.callingAppEventsService.trigger(p)}catch(e){const t=`[open] Opening dialog error [dialogId: ${i}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`;return this.logger.error(t),l.fail({errors:t,errorCode:"calling-app-event-not-triggered"}),Promise.reject(null)}l.mark(o.ck.AfterCallingDialogCallingAppEventTriggered);const v=(null===(n=c.find((e=>e.name===r.lR.PostClose)))||void 0===n?void 0:n.action)||(()=>{});return Promise.resolve({id:i,close:v,closePromise:Promise.resolve({id:"",value:""})})}))}getDialogData(e){if(this.logger.log(`Getting dialog data for dialog ${e}`),!this.dialogData.get(e))throw new Error(`Unable to find out dialog data with id: ${e}`);return this.dialogData.get(e)||{}}executeDialogAction(e,t){var n;this.logger.log(`Attempting to execute ${t.toString()} action for dialog ${e}`);const i=null===(n=this.dialogActions(e).find((e=>e.name===t)))||void 0===n?void 0:n.action;if(!i)throw new Error(`Action ${t.toString()} not found for dialog ${e}`);i()}dialogActions(e){var t;this.logger.log(`Getting actions for dialog ${e}`);return(null===(t=this.dialogCallback)||void 0===t?void 0:t.get(e))||[]}}},726059:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{WB:()=>i,lR:()=>a,_d:()=>o}),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.OptionsSettings="optionsSettingsDialog",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="GetUserMediaDialog"}(i||(i={})),function(e){e.PostConfirm="PostConfirm",e.PreClose="PreClose",e.PostClose="PostClose",e.PreActiveElementIds="PreActiveElementIds",e.CloseByDocument="CloseByDocument"}(a||(a={})),function(e){e.DialogTitle="DialogTitle",e.DialogText="DialogText",e.PrimaryButton="PrimaryButton",e.ConfirmMessageTitle="ConfirmMessageTitle",e.ConfirmMessageHtmlBody="ConfirmMessageHtmlBody",e.OkButtonText="OkButtonText"}(o||(o={}))},156430:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var i=n(296154),a=n(918635),o=n(283202);class r{constructor(e,t,n){var i,a;this.loggerFactory=e,this.scenarioFactory=t,this.platformService=n,this.context={},this._deviceId="",this.sessionId="seessionId",this.service=this,this.internalLogger=this.wrapLogger(e.newLogger("CallingLoggingService","services-io-calling-service-adapters")),this.sessionId=null===(a=null===(i=this.platformService)||void 0===i?void 0:i.host)||void 0===a?void 0:a.sessionId}deviceId(){var e,t;return(null===(t=null===(e=this.platformService)||void 0===e?void 0:e.host)||void 0===t?void 0:t.deviceId)||this.getDeviceId()}logMessage(e,t,n,i){var o,s;if(i===a.LogLevel.None)return!1;const l=r.loglevelMap.get(i)||"debug",c=` [${e}] `.concat(t);return null===(s=(o=this.internalLogger)[l])||void 0===s?void 0:s.call(o,c,...n)}newLogger(e){return this.wrapLogger(this.loggerFactory.newLogger(e,"services-io-calling-service-adapters"))}newScenario(e,t,n,i,a,o,r,s,l,c,d,u){var m,g;const p={callback:n,timeoutMs:i,startTime:r,clientId:c},v=this.scenarioFactory.newScenario(e,p);return u&&(null===(g=(m=this.scenarioFactory).hoistScenarioToCore)||void 0===g||g.call(m,v)),this.wrapScenario(v)}event(e,t){this.internalLogger.warn("LoggingService.event is not implemented!")}findAllScenariosByName(e){return this.internalLogger.warn("LoggingService.findAllScenariosByName is not implemented!"),[]}findScenario(e){return this.wrapScenarioOpt(this.scenarioFactory.findScenario(e))}findScenarioByNameAndId(e,t){return this.wrapScenarioOpt(this.scenarioFactory.findScenarioByNameAndId(e,t))}getContext(){return this.context}registerEventDecorator(e){(0,o.Rr)(e)}setContext(e,t,n){this.context[e]={value:t,piiKind:n}}log(e,...t){return this.internalLogger.log(e,...t)}warn(e,...t){return this.internalLogger.warn(e,...t)}error(e,...t){return this.internalLogger.error(e,...t)}errorToTelemetry(e,t,n,i){return this.internalLogger.errorToTelemetry?this.internalLogger.errorToTelemetry(e,t,n,i):(this.internalLogger.warn("LoggingService.errorToTelemetry is not implemented!"),this.internalLogger.error(e),!0)}infoToTelemetry(e,t,n,i){if(!this.internalLogger.infoToTelemetry)return this.internalLogger.warn("LoggingService.infoToTelemetry is not implemented!"),void this.internalLogger.log(e);this.internalLogger.infoToTelemetry(e,t,n,i)}info(e,...t){return this.internalLogger.info(e,...t)}debug(e,...t){return this.internalLogger.debug(e,...t)}getDeviceId(){return this._deviceId||(this._deviceId=(0,i.v4)())}wrapScenarioOpt(e){return e&&this.wrapScenario(e)}wrapScenario(e){return new Proxy(e,{has:(e,t)=>"cancelIfOffline"===t||"clientId"===t||Reflect.has(e,t),get:(t,n,i)=>{switch(n){case"whenStopped":return Promise.resolve("");case"cancelIfOffline":return!1;case"clientId":return e.clientId||"";case"stop":return(t,n,i)=>{return"string"==typeof n?e.stop(t,["success","failure","timeout","abandoned","incomplete","tab_switched","app_minimized"].includes(a=n)?a:void 0):e.stop(t,i);var a};case"timeoutInMs":return t=>{this.scenarioFactory.changeTimeout&&this.scenarioFactory.changeTimeout(e,t)}}return Reflect.get(t,n,i)},set:(t,n,i,a)=>{switch(n){case"cancelIfOffline":return!0;case"clientId":return e.clientId=i,!0}return Reflect.set(t,n,i,a)}})}wrapLogger(e){const t=(t,n,i)=>{var a;return null===(a=e[t])||void 0===a||a.call(e,n,...i),!0};return{service:this,log:(e,...n)=>t("log",e,n),warn:(e,...n)=>t("warn",e,n),error:(e,...n)=>t("error",e,n),info:(e,...n)=>t("log",e,n),debug:(e,...n)=>t("debug",e,n),errorToTelemetry:(t,n,i,a)=>{var o;return null===(o=e.errorToTelemetry)||void 0===o||o.call(e,t,n,i,a),!0},infoToTelemetry:(t,n,i,a)=>{var o;return null===(o=e.infoToTelemetry)||void 0===o||o.call(e,t,n,i,a),!0}}}}r.loglevelMap=new Map([[a.LogLevel.Debug,"debug"],[a.LogLevel.Verbose,"debug"],[a.LogLevel.Info,"log"],[a.LogLevel.Warn,"warn"],[a.LogLevel.Error,"error"],[a.LogLevel.Max,"error"]])},850032:(e,t,n)=>{"use strict";var i;n.d(t,{U:()=>i,$:()=>a}),function(e){e.feed="TeamsFeed",e.syncFeed="TeamsFeedSync"}(i||(i={}));const a={defaultSection:"TeamsFeed",defaultTimeSortedSection:"TeamsFeedTimeSorted",defaultItemsToFetch:3,defaultLoadMoreItemsCount:5,defaultItemsToCompare:3,defaultReadSignalMinDwellTime:5e3,defaultDataSyncIntervalTime:3e5,defaultDiscoverTriagingTime:3e5,defaultServerCacheRetentionTimeInHrsSinceFirstCall:72}},553285:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});const i="most-recent"},961086:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{Jv:()=>i,OP:()=>a,cw:()=>o}),function(e){e.NotInstalled="NotInstalled",e.InstalledNotActive="InstalledNotActive",e.InstalledActive="InstalledActive"}(i||(i={})),function(e){e.Teams1="Teams1",e.Teams2="Teams2"}(a||(a={})),function(e){e.DownloadedAndInstalled="DownloadedAndInstalled",e.FailedToDownload="FailedToDownload",e.FailedToInstall="FailedToInstall",e.DownloadPageOpened="DownloadPageOpened"}(o||(o={}))},650007:(e,t,n)=>{"use strict";var i,a;n.d(t,{$:()=>i,f:()=>a}),function(e){e.Locked="Locked",e.Unlocked="Unlocked",e.Unknown="Unknown",e.Resumed="Resumed",e.Suspending="Suspending"}(i||(i={})),function(e){e.Light="Light",e.Dark="Dark",e.Contrast="Contrast",e.OSTheme="OSTheme"}(a||(a={}))},109309:(e,t,n)=>{"use strict";var i,a,o,r,s,l;n.d(t,{px:()=>i,i$:()=>r}),function(e){e.None="None",e.Core="Core",e.MeetNow="MeetNow",e.Loading="Loading",e.Main="Main",e.ChatPopout="ChatPopout",e.Meeting="Meeting"}(i||(i={})),function(e){e.MouseEnter="MouseEnter",e.MouseLeave="MouseLeave",e.Click="Click"}(a||(a={})),function(e){e.Text="Text",e.Pointer="Pointer"}(o||(o={})),function(e){e.ButtonsOnly="ButtonsOnly",e.FullWidth="FullWidth"}(r||(r={})),function(e){e.TopLeft="TopLeft",e.TopRight="TopRight",e.BottomLeft="BottomLeft",e.BottomRight="BottomRight"}(s||(s={})),function(e){e.Hidden="Hidden",e.Visible="Visible",e.Disabled="Disabled"}(l||(l={}))},909966:(e,t,n)=>{"use strict";var i;n.d(t,{$:()=>i}),function(e){e.None="none",e.DayStart="dayStart",e.MeetingPrep="meetingPrep",e.MeetingStart="meetingStart",e.MeetingStarted="meetingStarted",e.MeetingEnd="meetingEnd",e.Feedback="feedback",e.InMeetingActionStatusUpdated="inMeetingActionStatusUpdated",e.InMeetingGreeting="inMeetingGreeting",e.InMeetingShareFile="inMeetingShareFile",e.RunningLate="inMeetingRunningLate",e.ReportUsage="reportUsage"}(i||(i={}))},707418:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});class i{constructor(){}static getInstance(){return this.platformAppConversationService||(this.platformAppConversationService=new i),this.platformAppConversationService}setSubEntityDeepLinkInfo(e){this.deepLink=e}getSubEntityDeepLinkInfo(){return this.deepLink}setClientMessageId(e){this.clientMessageId=e}getClientMessageId(){return this.clientMessageId}}},740755:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{f5:()=>i,Ko:()=>a,r1:()=>o}),function(e){e.ActiveUserOperation="AUO",e.PassiveOperation="PO",e.BackgroundOperation="BO"}(i||(i={})),function(e){e.UploadFile="ShareUploadFile",e.RemoveFile="ShareAbort"}(a||(a={})),function(e){e.Unknown="Unknown",e.Inline="Inline",e.Attached="Attached"}(o||(o={}))},589504:(e,t,n)=>{"use strict";n.d(t,{b:()=>s});var i=n(361366);const a="ModuleLoaded",o="Focus Assist not available on module.",r="HostComms is unable to load toast toasts module. Bailing out.";class s{constructor(e,t){this.hostCommunicationService=t,this.logger=e.newLogger("ToastSettingsService","services-io-toast-settings")}getFocusAssistStateAsync(){var e,t,n,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("toasts");if(i){if(i.getFocusAssistStateAsync)return this.logger.log(a),i.getFocusAssistStateAsync();null===(s=(n=this.logger).errorToTelemetry)||void 0===s||s.call(n,o,"toast_service_settings_warn_user_notice")}else null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,r,"toast_service_settings_warn_user_notice")}))}getGlobalNotificationSettingsAsync(e){var t,n,s,l;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("toasts");if(i){if(i.getGlobalNotificationSettingsAsync)return this.logger.log(a),e?i.getGlobalNotificationSettingsAsync(e):i.getGlobalNotificationSettingsAsync();null===(l=(s=this.logger).errorToTelemetry)||void 0===l||l.call(s,o,"toast_service_settings_warn_user_notice")}else null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,r,"toast_service_settings_warn_user_notice")}))}registerForToastDismissed(e){var t,n,a,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("toasts");i?i.registerForToastDismissed?i.registerForToastDismissed(e):null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,o,"toast_service_settings_warn_user_notice"):null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,r,"toast_service_settings_warn_user_notice")}))}registerForNotificationModeChanged(e){var t,n,a,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("toasts");i?i.registerForNotificationModeChanged?i.registerForNotificationModeChanged(e):null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,o,"toast_service_settings_warn_user_notice"):null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,r,"toast_service_settings_warn_user_notice")}))}registerForFocusSessionChanged(e){var t,n,a,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("toasts");i?i.registerForFocusSessionChanged?i.registerForFocusSessionChanged(e):null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,o,"toast_service_settings_warn_user_notice"):null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,r,"toast_service_settings_warn_user_notice")}))}}},438234:(e,t,n)=>{"use strict";n.d(t,{B:()=>s});var i=n(916852),a=n(10339);const o="isOptedIntoT2Web",r="web_app_switcher_opt_out_redirection_fail";class s{constructor(e,t,n){this.localStorage=e,this.crossTabsService=n,this.logger=t.newLogger("WebAppSwitcherService","services-io-web-app-switcher"),this.logger.log("WebAppSwitcherService initialized")}optOutOfT2Web(e){var t,n,i,a;this.crossTabsService?(null===(a=(i=this.logger).logNoPii)||void 0===a||a.call(i,"Opting user out of T2"),this.doRedirection(!0,!0,e)):null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"Cross tabs service is undefined",r,void 0,!0)}redirectThisTabToT1(){this.doRedirection(!1,!1)}doRedirection(e,t,n){var i,o,s,l,c;let d;try{d=this.getT1Url(n)}catch(e){return void(null===(o=(i=this.logger).errorToTelemetry)||void 0===o||o.call(i,"Failed to get T1 url",r,void 0,!0))}t&&!this.clearOptInFlag()||(e&&(null===(s=this.crossTabsService)||void 0===s||s.postMessage("T2WebOptOut")),null===(c=(l=this.logger).infoToTelemetry)||void 0===c||c.call(l,"Redirecting to T1 web","web_app_switcher_out_out_redirection_success",{endpointUrl:d},!0),(0,a.J)().location.replace(d))}clearOptInFlag(){var e,t,n,a;return this.localStorage.get(o,i.f.Global)?(this.localStorage.remove(o,i.f.Global),this.localStorage.get(o,i.f.Global)?(null===(a=(n=this.logger).errorToTelemetry)||void 0===a||a.call(n,"Failed to clear opt-in flag",r,void 0,!0),!1):(this.logger.log("isOptedIntoT2Web flag cleared from local storage"),!0)):(null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,"Opt-in flag not found",r,void 0,!0),!1)}getT1Url(e){let t;const n=(0,a.J)();if(e){const n=new URL(e),i=n.pathname+n.search+n.hash,a=new URL(n.origin);a.pathname="/_",a.hash=i,t=a}else{const e=new URL(n.location.href);t=new URL(e.origin)}return t.href}}},59773:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});class i{static get Instance(){return i._instance||(i._instance=new i),i._instance}constructor(){this.outstandingRequests=void 0,this.mostRecentRequest=void 0,this.requestsMapping=void 0,this.decimalPlaces=void 0,this.subscriber=void 0,this.decimalPlaces=3}processRequest(e,t,n){if(!this.subscriber)return;const{requests:i}=this.outstandingRequests;i.has(e)||i.set(e,{requestsByName:new Map});const{requestsByName:a}=i.get(e),o=a.get(t)||0;a.set(t,o+1),this.requestsMapping.set(n,{operationName:t,operationType:e}),this.notify()}processResponse(e,t){if(!this.subscriber||!this.requestsMapping.has(e))return;const{operationName:n,operationType:i}=this.requestsMapping.get(e);if("subscription"===i)return;this.requestsMapping.delete(e);const a=this.outstandingRequests&&this.outstandingRequests.requests;if(a.has(i)){const{requestsByName:e}=a.get(i);let t=e.get(n);1===t?e.delete(n):t>0&&e.set(n,--t)}const o={requestInfo:{operationName:n,operationType:i},responseTime:t&&parseFloat(t.toFixed(this.decimalPlaces))};this.mostRecentRequest=o,this.notify()}subscribe(e){this.subscriber=e,this.outstandingRequests={requests:new Map},this.requestsMapping=new Map}unsubscribe(){this.subscriber=void 0,this.outstandingRequests=void 0,this.requestsMapping=void 0}notify(){this.subscriber.processUpdate(this.outstandingRequests,this.mostRecentRequest)}}i._instance=void 0},750251:(e,t,n)=>{"use strict";n.d(t,{K:()=>s,g:()=>l});var i=n(361366),a=n(69081),o=n(948519),r=n(566129);const s=(e,t,n)=>s=>{const{discover:l,authenticationResources:d,platformService:u,config:m}=s,g=(0,r.h)(u,m),{headers:p}=t,v=(0,i.__rest)(t,["headers"]),h=Object.assign(Object.assign({},g),p);return{baseUrlPromise:()=>l.regionGtm(o.Pn.middleTier),serviceName:e,authResource:d.mtAuthResource,models:n((e=>{const t=Promise.resolve(Object.assign({constructRequest:(0,a.$)(e,h)},v));return c(t)}))}},l=(e,t,n)=>i=>{const o=e((0,a.$)(i,t),n);return c(o)},c=e=>{const t=Object.assign(e,{allow:n=>(e.then((e=>e.allowedResponses=n)),t),withCustomTelemetry:n=>(e.then((e=>e.customTelemetry=n)),t),withRetry:n=>(e.then((e=>e.retryPolicy=n)),t),withResponse:n=>(e.then((e=>e.responseType=n)),t),withTransform:n=>(e.then((e=>e.transformResponse=n)),t)});return t}},620178:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});const i={type:"safelinks",safelinksAtpMT:{type:"safelinksmt",getUrlReputationRestEndpoint:"beta/atpsafelinks/geturlreputationrest/",getpolicyEndpoint:"beta/atpsafelinks/getpolicy/",RESOURCE_KEY:"https://dataservice.o365filtering.com"},telemetry:{getPolicy:"atp_get_policy",getUrlReputation:"atp_get_url_reputation"},policyKey:"atp-safelinks-policy"}},36847:(e,t,n)=>{"use strict";n.d(t,{c:()=>u});var i=n(361366),a=n(47135),o=n(916561),r=n(635424),s=n(343324),l=n(620178),c=n(329214),d=n(156065);class u{constructor(e,t,n,i,a,o){this.send=e,this.authenticationService=t,this.coreSettings=n,this.scenarioFactory=i,this.localStorage=o,this.handleGetATPAuthToken=()=>this.authenticationService.acquireToken(l.V.safelinksAtpMT.RESOURCE_KEY),this.logger=a.newLogger("AtpSafelinksService","services-utilities-atp-safelinks")}initPolicy(){const e=this.scenarioFactory.newScenario(s.RG.ATPGetPolicyTask);this.getPolicy().then((()=>e.stop())).catch((t=>{const n=`Error getting ATP Safelinks policy: ${t.message||""}`;this.logger.error(n),e.fail({errors:n})}))}getPolicy(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){return null!==(e=this.getPolicyFromLocalStore())&&void 0!==e?e:this.getPolicyFromRemote()}))}getUrlReputationRestMT(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enabledATPSafelinks:n}=this.coreSettings.get(a.J.Messaging);if(!n||!this._isAtpSafelinksSubscriptionEnabled())return this.logger.log("enabledATPSafelinks false"),{status:o.qb.OK,url:t};try{const n=yield this.handleGetATPAuthToken(),i=yield this._post(l.V.safelinksAtpMT.getUrlReputationRestEndpoint,this._getRequestBody(t,n),this._getHeaders(e));this.logger.log("getUrlReputationRestMT started");const a=yield i.body.json();return{url:t,status:i.status,data:a&&a.isATPSafelinksEnabled?a:{isATPSafelinksEnabled:!1}}}catch(e){return this.logger.error(`AtpSafelinks MT API failed with Error: ${e&&e.message}`),{url:t,status:-1}}}))}getPolicyFromLocalStore(){let e=null;try{const t=this.localStorage.get(l.V.policyKey);if(t){const n=JSON.parse(t);(0,d.z)(n.cookie,n.webAffinitizedUrl)?e=n:this.logger.error("Invalid policy found from localStorage")}}catch(e){this.logger.error(`Error while getting ATP safelinks policy from localStorage: ${e}`)}return e}getPolicyFromRemote(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let e=null;const t=this.scenarioFactory.newScenario(s.RG.ATPGetPolicy);try{const n=yield this._get(l.V.safelinksAtpMT.getpolicyEndpoint),i=yield n.body.json();this.localStorage&&this.localStorage.setSafe(l.V.policyKey,JSON.stringify(i));const a=`getPolicy status: ${n.status}`;this.logger.debug(a),t.stop({reason:a}),e=i}catch(e){this.logger.error(`AtpSafelinks GetPolicy API failed with Error: ${e&&e.message}`),t.fail({errors:`${l.V.telemetry.getPolicy}_failed`})}return e}))}_getRequestBody(e,t){return{urlList:[e],atptoken:t}}_getHeaders(e){const t={"content-type":"application/json"};return e&&(this._addHeader(e.user,"X-sourceUser",t),this._addHeader(e.id,"X-sourceId",t),this._addHeader(e.detail,"X-sourceDetail",t)),t}_addHeader(e,t,n){n[t]=e}_post(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(0,c.B)(this.send,o.qb.OK)({url:e,method:"POST",body:JSON.stringify(t),headers:n,serviceName:r.EJ.MiddleTier,apiName:"safelink"})}))}_get(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(0,c.B)(this.send,o.qb.OK)({url:e,method:"GET",serviceName:r.EJ.MiddleTier,apiName:"safelink"})}))}_isAtpSafelinksSubscriptionEnabled(){const{licenseSettings:e}=this.coreSettings.get(a.J.UserResources);return!(!e||!e.isAtpSafelinksEnabled)}}},334025:(e,t,n)=>{"use strict";n.d(t,{aw:()=>i,ZU:()=>a,Fz:()=>o,l6:()=>r,$N:()=>s,yc:()=>l,DT:()=>c,SM:()=>d,wK:()=>u,IY:()=>m,rz:()=>g,ru:()=>p,op:()=>v,ej:()=>h,Hw:()=>f,QN:()=>b,gX:()=>S,ex:()=>w,s9:()=>C,uI:()=>_,rF:()=>T,zP:()=>I,GA:()=>E,f:()=>N,u1:()=>A,kI:()=>F,j:()=>D,Tv:()=>R,$l:()=>x});const i="TflFreProfileCardDisplayed",a="LogoutState",o="authSessionId",r="tmp.previous.silent.signin",s="in-progress",l={nopa:"2"},c={coa:"1"},d={AuthProviderLoadError:"AuthProviderLoadError",ErrorGetUserWhenAnonNotSupported:"ErrorGetUserWhenAnonNotSupported",UserNotLicensed:"Forbidden",CloudMismatch:"CloudMismatch",InitFailure:"Core-auth init failure",InteractionRequired:"InteractionRequired",InvalidScopeResource:"invalid_scope",MultipleUsersPresentWithSpecifiedIdentifier:"MultipleUsersPresentWithSpecifiedIdentifier",NativeAuthModuleNotPresent:"NativeAuthModuleNotPresent",NoAccountFound:"NoAccountFound",RemoteOperationFailed:"RemoteOperationFailed",SignInRestrictions:"SignInRestrictions",SsoFirstAccountFailed:"SsoFirstAccountFailed",NoNetwork:"NoNetwork",TenantUnredeemed:"TenantUnredeemed",ErrorCodeMissingForTenantLogin:"ErrorCodeMissingForTenantLogin",UserNotAuthenticated:"UserNotAuthenticated",UserNotFoundError:"User not found",LoginRequired:"login_required",ConsentRequired:"consent_required",PopUpWindowError:"popup_window_error",EmptyResponse:"EmptyResponse",InvalidResponse:"InvalidResponse",InvalidToken:"InvalidToken",UnsupportedParameter:"UnsupportedParameter",UserAuthNotAvailable:"UserAuthNotAvailable",MissingRequiredFields:"MissingRequiredFields",CannotUpdateCurrentAccount:"CannotUpdateCurrentAccount",FallbackWithSkypeToken:"FallbackWithSkypeToken",HiddenUserErrorForLogin:"HiddenUserErrorForLogin"},u={NoNetwork:"NoNetwork",ApiContractViolation:"ApiContractViolation",UiAlreadyShowing:"Cannot sign in when UI is showing"},m="InteractionRequiredAuthError",g="skype-token",p="discover-user-details",v="discover-region-gtm";var h,f;!function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.SIGNIN_RESTRICTIONS_KEY="SignInRestrictions",e.AUTHZ_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.IC3_GATEWAY_CAE_KEY="https://ic3.teams.office.com",e.IC3_GATEWAY_AAD_KEY="https://ic3-non-cae.teams.office.com"}(h||(h={})),function(e){e.openId="openId",e.profile="profile"}(f||(f={}));let y=["[auth][authserviceBack][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","aborted","A silent sign-in request was sent but none of the currently signed in user(s) match the requested login hint","Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","Cannot start retry fetch of ADAL tokens, isPassive: false","Cancelling all retries due to: orchestration authenticationService_offline","Cancelling all retries due to: Relogin succeeded. Need to refresh tokens","Due to current app state cannot start retry fetch of ADAL tokens","noAccessForResource","resourceRequiresConsent","resourceDisabled","Seamless single sign on failed for the user. This can happen if the user is unable to access on premises AD or intranet zone is not configured correctly","tokenRevoked","tpmError","Webclient Auth request reached maximum timeout - 60000.","popup_window_error"];const b=e=>(e&&(y=[...y,...e]),y),S=()=>y;let k=[];const w=e=>(e&&(k=[...k,...e]),k),C=e=>k.includes(e);var _,T;!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.TWENTYFOUR=24]="TWENTYFOUR",e[e.THIRTY=30]="THIRTY"}(_||(_={})),function(e){e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.SECONDS_FIVE_MINUTES=300]="SECONDS_FIVE_MINUTES",e[e.ONE_HOUR=36e5]="ONE_HOUR",e[e.ONE_MINUTE=6e4]="ONE_MINUTE",e[e.ONE_DAY=864e5]="ONE_DAY"}(T||(T={}));const I="9188040d-6c67-4c5b-b112-36a304b66dad",E="wids",N="74ebf54e-8a4c-453c-a5ea-3ff41b70afe6",A="b44d8d43-c828-450b-9b6f-ae3788447705",F="X-MS-Migration",D=(_.TWO,T.MILLI_PER_SECOND,T.SECONDS_PER_MINUTE,{SKYPE_REQUEST:"skype_request_start",SKYPE_REQUEST_STOP:"skype_request_stop",SKYPE_SEND_REQUEST:"skype_send_request_start",SKYPE_SEND_REQUEST_STOP:"skype_send_request_stop",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim"}),R={MTO:"MTO"},x={TENANTSV2:"/beta/users/tenantsv2"}},449856:(e,t,n)=>{"use strict";n.d(t,{u:()=>c,OU:()=>d,ld:()=>m,cv:()=>g,Tu:()=>p});var i=n(361366),a=n(625050),o=n(710141),r=n(652075),s=n(274895);class l{constructor(e,t,n){this._scenarioProvider=e,this._authCache=t,this._telemetryService=n,this.create=e=>this._createScenario(e,!0),this.createNew=e=>{var t;const n=new r.q(this._scenarioProvider,e.correlation,this._authCache,e.subContext,!0,null!==(t=e.isBatch)&&void 0!==t&&t,e.timeoutMs,this._telemetryService);return e.scenarioEventData&&n.appendScenarioEventData(e.scenarioEventData),n},this.createWithoutScenario=e=>this._createScenario(e,!1),this.getCorrelation=e=>s.n.getCorrelation(e)||[],this._createScenario=(e,t)=>{var n,i;const{correlation:a,subContext:o,scenarioEventData:l,timeoutMs:c,scenario:d,isBatch:u}=e;let m=s.n.getAuthTelemetry(a.id);if(m)m.addEventData([`fn:${o}`]);else{const l=null===(n=this._telemetryService)||void 0===n?void 0:n.getTelemetryServicesCache().get(null===(i=e.scenarioEventData)||void 0===i?void 0:i.accountId);m=new r.q((null==l?void 0:l.coreScenarioFactory)||this._scenarioProvider,a,this._authCache,o,t,null!=u&&u,c,(null==l?void 0:l.telemetryService)||this._telemetryService,d),s.n.setAuthTelemetry(a.id,m)}return l&&m.appendScenarioEventData(l),s.n.setCorrelation(a),m}}}const c=(e,t)=>{s.n.setUserBiService(e||"GLOBAL",t)},d=e=>{var t,n,a,r,s,l;e.options.correlation={id:null!==(n=null===(t=e.options.correlation)||void 0===t?void 0:t.id)&&void 0!==n?n:(0,o.pW)(),scenarioName:null!==(r=null===(a=e.options.correlation)||void 0===a?void 0:a.scenarioName)&&void 0!==r?r:e.scenarioName,source:null!==(l=null===(s=e.options.correlation)||void 0===s?void 0:s.source)&&void 0!==l?l:e.source};const{options:{correlation:c}}=e,d=(0,i.__rest)(e,["options"]);return u(Object.assign({correlation:c},d))},u=e=>{const{correlation:t,subContext:n,scenarioEventData:i,eventData:a,timeoutMs:o,scenario:r,isBatch:l}=e,c=s.n.getAuthTelemetry(t.id),d=(e.startWithoutScenario||!t.scenarioName?g.createWithoutScenario:g.create)({correlation:t,subContext:n,scenarioEventData:i,timeoutMs:o,scenario:r,isBatch:l});a&&d.addEventData(a);return[d,(e,t)=>d.closeScenario(e,t,!!c)]},m=e=>g.getCorrelation(e);let g;const p=(e,t,n)=>{g||(g=new l(e,t,n),a.q.log("authTelemetryProvider initialized"))}},652075:(e,t,n)=>{"use strict";n.d(t,{q:()=>c});var i=n(585478),a=n(625050),o=n(710141),r=n(962687),s=n(184717),l=n(274895);class c{constructor(e,t,n,c,d,u,m,g,p){var v;this._scenarioFactory=e,this._correlation=t,this._authCache=n,this._subContext=c,this._shouldCreateScenario=d,this._isBatch=u,this._timeoutMs=m,this._telemetryService=g,this._eventData=[],this._localScenarioEventData={},this._loggingPrefix="",this.appendScenarioEventData=e=>{this._scenario&&this._scenario.appendEventData(e),this._localScenarioEventData=Object.assign(Object.assign({},this._localScenarioEventData),e)},this.addEventData=e=>{Array.prototype.push.apply(this._eventData,e)},this.getEventData=()=>[...this._eventData],this.addScenarioMark=(e,t={},n)=>{t=this._mapEventData(t,n),this._scenario?this._scenario.mark(e,t,t.status):this.addEventData([`${e}:${t.status}`]),a.q.log(`${this._loggingPrefix} [${e}][${t.status}][scenarioEventData][${(0,o.u4)(t)}]`)},this.closeScenario=(e={},t,n)=>{var i;if(e=this._mapEventData(e,t),n)return e.reason&&this.addEventData([`reason:${e.reason}`]),e.errorCode&&this.addEventData([`errorCode:${e.errorCode}`]),void this.addEventData([`${this._subContext}$:${e.status}`]);if(this._isBatch&&this._correlation.scenarioName&&(this._batchScenarioStartTime&&(e.perfDelta=performance.now()-this._batchScenarioStartTime),e.correlationId=null!==(i=e.correlationId)&&void 0!==i?i:this._correlation.id,"success"===e.status?(0,r.ft)(this._scenarioFactory,this._authCache,this._correlation.scenarioName,e):"failure"===e.status?(0,r.EJ)(this._scenarioFactory,this._authCache,this._correlation.scenarioName,e):(0,r.vB)(this._scenarioFactory,this._authCache,this._correlation.scenarioName,e)),!this._scenario){const t=this._shouldCreateScenario?a.q.warn:a.q.log,n=this._shouldCreateScenario?"[N/A]":"";return this.logEventData(t,`${this._loggingPrefix} [stop]${n} [scenarioEventData]`,e),void l.n.delete(this._correlation.id)}switch(e.status){case"incomplete":this._scenario.incomplete(e);break;case"failure":this._scenario.fail(e);break;case"abandoned":this._scenario.cancel(e);break;default:this._scenario.stop(e)}const o="failure"===e.status?a.q.error:a.q.log;this.logEventData(o,`${this._loggingPrefix} [stop][${e.status}] [e]`,e),l.n.delete(this._correlation.id)},this.createScenario=(e,t,n)=>{this._scenario?a.q.warn(`createScenario called with [${this._subContext}][${(0,o.u4)(this._correlation)}]::${e}, but there is already a scenario with that correltion id`):(this._createScenario(e,n||this._timeoutMs,Object.assign(Object.assign({},this._localScenarioEventData),t)),a.q.log(`${this._loggingPrefix} [create] - scenario created`))},this.recordAuthUserBiTelemetry=(e,t)=>{const n={panelRegion:i.Ai.main,panelType:i.wh.AuthStart,actionWorkload:i.sz.auth,actionSubworkload:i.eD.sisu,actionScenarioType:i.Yu.appAuth,actionScenario:t.scenario,actionGesture:t.actionGesture||i.uS.auto},o=l.n.getUserBiService(e||"GLOBAL");o&&o.recordPanelAction(n,a.q)},this.setUserToTelemetryContext=e=>{var t;e&&(null===(t=this._telemetryService)||void 0===t||t.setAuthContext(e),this.addScenarioMark(`${this._correlation.scenarioName}_set_user_on_telemetry_context`))},this.setUserDetailsToTelemetryContext=e=>{var t;if(e){const{region:n}=e;void 0!==n&&(null===(t=this._telemetryService)||void 0===t||t.setCoreContext("UserInfo.Region",n)),this.addScenarioMark(`${this._correlation.scenarioName}_set_tenant_details_on_telemetry_context`)}},this._mapEventData=(e,t)=>{var n,i;return e.subContext=e.subContext||this._subContext,(e=Object.assign(Object.assign({},this._localScenarioEventData),e)).error&&(e.error=Object.assign(Object.assign({},e.error),{stack:this.scrubQsString("loginHint",e.error.stack),message:e.error.message,errorMetaData:void 0}),e.message=`[message]${null!==(n=e.message)&&void 0!==n?n:""} [errorMessage]${e.error.message}`,e.errorCode=null!==(i=e.error.code)&&void 0!==i?i:e.error.errorCode,this.addEventData([`errorCode:${e.error.errorCode}`])),!t&&e.error&&(t=(0,s.ZG)(e.error)?"incomplete":"failure"),e.eventData=this._eventData.join(","),e.status=t||"success",e},this._createScenario=(e,t,n)=>{var i,o,r;const s=t?{timeoutMs:t}:{};this._scenario=null!==(i=this._scenarioFactory.findScenario(e))&&void 0!==i?i:this._scenarioFactory.newScenario(e,s);try{null===(r=(o=this._scenarioFactory).hoistScenarioToCore)||void 0===r||r.call(o,this._scenario)}catch(e){a.q.log(`${this._loggingPrefix} ${e.message}`)}this._scenario.appendEventData(Object.assign({secondaryCorrelationId:this._correlation.id,commandSource:this._correlation.source},n)),this._shouldCreateScenario=!0},this.loggingPrefix=()=>`[Telemetry][${this._correlation.id}][${this._correlation.scenarioName}]`,this.logEventData=(e,t,n)=>{n.error||delete n.error;const i=this.splitStringEqually((0,o.u4)(n));for(const n of i)e(`${t}${n}`)},this.splitStringEqually=(e,t=300)=>{const n=new RegExp(`.{1,${t}}`,"g"),i=e.match(n);return i||[]},this.scrubQsString=(e,t)=>{if(!t)return"";const n=new RegExp(`${e}=[^?&:)]*`,"gi");return t.replace(n,"scrubbed")},this._loggingPrefix=this.loggingPrefix(),this._isBatch&&(this._batchScenarioStartTime=performance.now()),d&&(p?this._scenario=p:(null===(v=this._correlation)||void 0===v?void 0:v.scenarioName)&&this._createScenario(this._correlation.scenarioName,this._timeoutMs,void 0)),a.q.log(`${this._loggingPrefix} [start] - telemetry provider created for ${this._subContext}, source: ${this._correlation.source} with shouldCreateScenario: [${d}]`),a.q.log(`Auth cache defined: ${!!this._authCache}, is batch: ${this._isBatch}`),this._eventData.push(`^source:${this._correlation.source},fn:${this._subContext}`)}get correlation(){return Object.assign({},this._correlation)}}},962687:(e,t,n)=>{"use strict";n.d(t,{ft:()=>r,EJ:()=>s,vB:()=>l,mM:()=>c});var i=n(361366),a=n(625050),o=n(710141);function r(e,t,n,i){d(e,t,`batch_${n}`,i,(e=>(e.successMetaData=p(i,e.successMetaData),e.successMetaData.batchScenarioCounter)))}function s(e,t,n,i){d(e,t,`batch_${n}`,i,(e=>(e.failureMetaData=p(i,e.failureMetaData),e.failureMetaData.batchScenarioCounter)))}function l(e,t,n,i){d(e,t,`batch_${n}`,i,(e=>(e.abandonedMetaData=p(i,e.abandonedMetaData),e.abandonedMetaData.batchScenarioCounter)))}const c=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=g(t,n);if(!i)return;const a=t.getValue(i);for(const t in a)if(a[t]){const i=a[t];u(e,t,i,n)}t.del(i)}));function d(e,t,n,i,o){var r;const{accountId:s}=i,l=g(t,s);if(!l)return;const c=t.getValue(l),d=null!==(r=null==c?void 0:c[n])&&void 0!==r?r:{};o(d)>=1e3?(u(e,n,d,s),function(e,t,n){try{a.q.log(`[clearBatchScenarioFromCache] scenario: ${n}`);const i=e.getValue(t);null==i||delete i[n],e.put(t,i)}catch(e){a.q.log(`[clearBatchScenarioFromCache] ${null==e?void 0:e.message}`)}}(t,l,n)):function(e,t,n,i){try{let a=e.getValue(t);a?a[n]=i:a={[n]:i},e.put(t,a)}catch(e){return a.q.log(`[setBatchScenarioToAuthCache] ${null==e?void 0:e.message}`),!1}}(t,l,n,d)}function u(e,t,n,i){(null==n?void 0:n.successMetaData)&&m(e,t,n.successMetaData,"success",i),(null==n?void 0:n.failureMetaData)&&m(e,t,n.failureMetaData,"failure",i),(null==n?void 0:n.abandonedMetaData)&&m(e,t,n.abandonedMetaData,"abandoned",i)}function m(e,t,n,i,r){const s=e.newScenario(t),l=(0,o.pW)();a.q.log(`[sendBatchScenario] for ${t}, status: ${i}, correlationId:${l}`);const c={accountId:r,context:"auth-telemetry-helper",secondaryCorrelationId:l,batchScenarioData:n};switch(i){case"success":s.stop(c);break;case"failure":s.fail(c);break;default:s.cancel(c)}}function g(e,t){let n;if(t){const i=e.getAllOfType("User");n=null==i?void 0:i.filter((e=>e.id===t))[0]}else n=e.getValue({typeName:"User"});if(!n)return void a.q.log("[getBatchCacheKeyForUser] no user found in cache");return{user:{tenantId:n.profile.tid,oid:n.profile.oid,accountType:n.type,userName:n.userName,id:n.id},typeName:"BatchScenario"}}function p(e,t){return t?(t.batchScenarioCounter++,t.batchEventData.push(e)):t={batchScenarioCounter:1,batchEventData:[e]},t}},184717:(e,t,n)=>{"use strict";n.d(t,{Tr:()=>o,q2:()=>r,MD:()=>s,Yf:()=>l,ZG:()=>c});var i=n(334025),a=n(471285);function o(e){const t=new Error(e.message);return Object.assign(t,{context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}const r=(e,t,n)=>{switch(e.code){case a.jK.NoNetwork:return s({name:"offlineEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"OfflineError",errorMetaData:void 0});case a.jK.SignInRestrictions:return s({name:"signInRestrictionEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"SignInRestriction",errorMetaData:n})}return e};function s(e){const t=new Error(e.message);return Object.assign(t,{authSubErrorCode:e.authSubErrorCode,errorMetaData:e.errorMetaData,context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}function l(e){return(0,i.gX)().indexOf(e)>=0}function c(e){return e&&(e.isExpected||l(e.errorCode)||!!(t=e.message)&&(0,i.gX)().map((e=>t.indexOf(e)>=0)).filter(Boolean).length>0);var t}},802030:(e,t,n)=>{"use strict";n.d(t,{wr:()=>o,W5:()=>g,sM:()=>p,E:()=>v,ae:()=>h,g0:()=>f,ZC:()=>y,ZD:()=>b,cI:()=>S});var i=n(65903),a=n(177948);const o={publicCommercialCloud:"teams.microsoft.com",gccHighCloud:"gov.teams.microsoft.us",dodCloud:"dod.teams.microsoft.us",ag08Cloud:"https://teams.eaglex.ic.gov",ag09Cloud:"https://teams.microsoft.scloud",dev:"local.teams.office.com",devLive:"local.teams.live.com",liveCloud:"teams.live.com"},r=/^(\s|\/)+|(\s|\/)+$/g,s=4,l=2,c="meetup-join",d=2,u=1,m="meet",g=e=>({coordinates:{meetingData:{instantMeetingOptions:void 0,isAdhoc:!0}},joinOptions:{outgoingVideo:!0,outgoingAudio:!0,context:"WatchParty",meeting:{deeplinkId:e,isWatchParty:!0,showPrejoin:!0}},type:i.GXC.Meeting}),p=(e,t,n)=>{let o;if((0,a.N6)(e)){const{conversationId:t,messageId:n,rootMessageId:i,isChannel:a,isAdhoc:r,tenantId:s,organizerId:l,meetingCloud:c,registration:d,participantPin:u,broadcast:m}=e;o={legacyMeeting:{conversationId:t,messageId:n,rootMessageId:i,isChannel:a,isAdhoc:r,tenantId:s,organizerId:l,meetingCloud:c,registration:d,broadcast:m,participantPin:u}}}else{const{meetingCode:t,passcode:n,meetingUrl:i}=e.meetingData;o={meetingData:{participantPin:null==e?void 0:e.participantPin,meetingCode:t,passcode:n,meetingUrl:i}}}return{coordinates:o,joinOptions:{outgoingVideo:!1,outgoingAudio:!1,context:"DeepLink",meeting:{deeplinkId:t,showPrejoin:!0,isPSTN:!1,homeCloud:n}},type:i.GXC.Meeting}},v=(e,t,n,a,o)=>({coordinates:{legacyMeeting:{conversationId:n,messageId:a,rootMessageId:"",isChannel:!1,isAdhoc:!1,tenantId:e,organizerId:t,meetingCloud:"",broadcast:null,registration:o?{participantRegistrationId:o,isPublic:!0}:null,instantMeetingOptions:null}},joinOptions:{outgoingVideo:!1,outgoingAudio:!1,context:"Meeting EmbedLink",meeting:{showPrejoin:!0,isPSTN:!1}},type:i.GXC.Meeting}),h=(e,t)=>[o.dev,o.publicCommercialCloud].includes(t)?[o.devLive,o.liveCloud].includes(e):!![o.devLive,o.liveCloud].includes(t)&&[o.dev,o.publicCommercialCloud].includes(e),f=e=>e===o.publicCommercialCloud,y=(e,t,n)=>{let i,a;try{i=new URL(e).hostname,a=n&&((e,t)=>{let n;try{n=new URL(e)}catch(e){return!1}const i=n.pathname.replace(r,"").split("/"),a=n.hostname;return!!(i.length===s&&i[1]===c&&i[l]||i.length===d&&i[0]===m&&i[u])&&h(a,t)})(t,i)}catch(e){a=!1}return a},b=e=>{let t;try{t=new URL(e)}catch(e){return!1}const n=t.pathname.replace(r,"").split("/");return n.length===s&&n[1]===c&&!!n[l]},S=e=>{try{let t;return e&&(t=new URL(e)),!((null==t?void 0:t.host)!==o.liveCloud)}catch(e){return!1}}},900840:(e,t,n)=>{"use strict";n.d(t,{lq:()=>r,hY:()=>s,bE:()=>l,s0:()=>c,MC:()=>d,gK:()=>u,SL:()=>m,m7:()=>g,oh:()=>p,gu:()=>v,JY:()=>h,VU:()=>f,FT:()=>y});var i=n(65903),a=n(786884),o=n(471285);const r="announcement-card",s="application/vnd.microsoft.teams.messaging-announcementBanner",l=1317,c=366,d=878,u=244,m="Designer",g="designer-img",p=(e=[])=>{const t=e.findIndex((e=>e.contentType===s));return{announcementCard:e[t],announcementCardIndex:t}},v=e=>{const{announcementCard:t}=p(e);if(t)try{return JSON.parse(t.content)}catch(e){throw(0,a.Tr)("PostComposeHelpers",o.jK.Undefined,"getAnnouncementCardContentFromDraft::JsonParseError")}},h=e=>{var t,n,i,a,o,r,s,l,c,d,u;const m=v((null===(t=null==e?void 0:e.computed)||void 0===t?void 0:t.cards)||[]);return{title:(null==e?void 0:e.title)||"",colorTheme:(null==m?void 0:m.colorTheme)||null,originalImageUrl:(null===(i=null===(n=null==m?void 0:m.imageData)||void 0===n?void 0:n.origImage)||void 0===i?void 0:i.src)||null,croppedImageUrl:(null===(o=null===(a=null==m?void 0:m.imageData)||void 0===a?void 0:a.croppedImage)||void 0===o?void 0:o.src)||null,croppedImageHeight:(null===(s=null===(r=null==m?void 0:m.imageData)||void 0===r?void 0:r.croppedImage)||void 0===s?void 0:s.imageHeight)||null,croppedImageWidth:(null===(c=null===(l=null==m?void 0:m.imageData)||void 0===l?void 0:l.croppedImage)||void 0===c?void 0:c.imageWidth)||null,croppedImageAltText:(null===(u=null===(d=null==m?void 0:m.imageData)||void 0===d?void 0:d.croppedImage)||void 0===u?void 0:u.imageAltText)||null,isTeamsIllustration:null}},f=(e,t,n)=>n===i.hQF.Guardians&&t?b(e,t):e,y=(e,t)=>t===i.hQF.Guardians?"":e,b=(e,t)=>`<div><h1 style="font-weight: 600;">${t}</h1>${e}</div>`},297055:(e,t,n)=>{"use strict";n.d(t,{y4:()=>o,N0:()=>r,Lp:()=>s,DW:()=>l,Nm:()=>d,_K:()=>u,ZN:()=>m,nz:()=>g,pZ:()=>p,kU:()=>v,xl:()=>h,IC:()=>f,eb:()=>y,m:()=>b});var i=n(197981),a=n(151782);function o(e,t,n,i){try{return t(new URL(n,i))}catch(t){return e}}function r(e){const t=new URL(e);return t.protocol+"//"+t.host}function s(e){return c(e)}function l(e){return c(e,!0)}function c(e,t=!1){let n=e.indexOf("://");n=n<=0?0:n+"://".length;const a=e.indexOf(":",n),o=e.indexOf("/",n),r=e.indexOf("?",n),s=[o,r,a,e.length],l=Math.min.apply(Math,(0,i.without)(s,-1));if(!t)return e.slice(n,l).toLowerCase();let c=l;if(a===l){const t=[o,r,e.length];c=Math.min.apply(Math,(0,i.without)(t,-1))}return e.slice(c).toLowerCase()}function d(e,t){if(!e)return"";if(e.startsWith("/"))return e;const n=e.indexOf(":");if(n<=0)return"";const i=(e=(e=(e=(e=e.replace(/(\')/g,"%27")).replace(/(\")/g,"%22")).replace(/{/g,"%7B")).replace(/}/g,"%7D")).substring(0,n).toLowerCase();for(const n of t)if(i===n)return e;return"http"===i?`https${e.substring(n)}`:""}function u(e,t){if(!t)return t;const n=new RegExp(`[?&]${e}=([^&#]*)`).exec(t);return n&&n.length>1?decodeURI(n[1]):""}function m(e,t,n){if(!e||!t||e.match(new RegExp(`[?&]${t}=`)))return e;const i=`${e.indexOf("?")>=0?"&":"?"}${t}=${n}`;if(-1!==e.indexOf("#")){const t=e.split("#");return`${t[0]}${i}#${t[1]}`}return`${e}${i}`}const g=(e,t)=>new RegExp(`^(blob:)(${t})`,"i").test(e),p=e=>/^(data:)/i.test(e),v=e=>/^(http)(s?):\/\//i.test(e);function h(e,t){if(!e||!t)return e;const n=e.indexOf("?");if(n<0)return e;let a=e.indexOf("#");a<0&&(a=e.length);const o=e.substring(a),r=e.substring(0,n),s=e.substring(n+1,a),l=`${encodeURIComponent(t)}=`,c=s.split(/[&;]/g);return(0,i.forEachRight)(c,((e,t)=>{-1!==e.lastIndexOf(l,0)&&c.splice(t,1)})),`${r}${c.length>0?`?${c.join("&")}`:""}${o}`}function f(e){if(!e)return e;return e.indexOf("#")>=0?e.substring(0,e.indexOf("#")):e}function y(e){return(0,a.bs)(e)?e:`https://${e}`}const b=e=>(e.endsWith("/")||(e+="/"),e)},56627:(e,t,n)=>{"use strict";n.d(t,{WD:()=>i,av:()=>a,ax:()=>o,Hs:()=>r,nC:()=>s,bM:()=>l});const i="mainAppWindowActiveEntities",a="appActiveEntitiesHistory",o="mainWindowNavHistory",r="mainWindowNavHistoryIndex",s=e=>{const t=["mainAppWindowActiveEntities","mainWindowNavHistory","mainWindowNavHistoryIndex"];return e&&t.push(`${e}-mainAppWindowActiveEntities`,`${e}-mainWindowNavHistory`,`${e}-mainWindowNavHistoryIndex`),t},l=(e,t)=>`${t?`${t}-`:""}${e}`},366831:(e,t,n)=>{"use strict";n.d(t,{H:()=>o,P:()=>r});var i=n(47135);const a=["msteams:","ms-teams:"];function o(e,t,n=!1){const{deepLinkDomains:a,deepLinkPaths:o,supportHashDeeplinks:r}=t.get(i.J.Messaging),s=n?[""]:o||[];let l=a||[];return n||(l=l.concat(function(e){const{enableCrossCloudLaunch:t}=e.get(i.J.Core);if(!t)return[];const n=null==e?void 0:e.get(i.J.Auth).cloudDomainMap;if(!n)return[];return n.map((e=>`https://${e.domain}`))}(t))),d({url:e,deepLinkDomains:l,deepLinkPaths:s,supportHashDeeplinks:!!r,coreSettings:t})}function r(e,t){if(a.includes(e.protocol)){const n=t.get(i.J.Host).deepLinkDomain||void 0,a=s(e,t)||n;return new URL(`${e.pathname}${e.search}${e.hash}`,a)}return e}const s=(e,t)=>{const{enableOriginValidationForIncomingIntents:n}=t.get(i.J.Core);if(!n||"null"!==e.origin)return e.origin;if(!a.includes(e.protocol))return;const o=e.searchParams.get("fqdn");return o?new URL(`https://${o}`).origin:"null"===e.origin&&e.hostname?new URL(`https://${e.hostname}`).origin:void 0},l=(e,t,n,i)=>{const a=s(e,i);return!(a&&a!==t.origin||!e.pathname.startsWith(n))},c=(e,t,n)=>{const i=s(e,n);return!(i&&i!==t.origin||!e.hash||"/_"!==e.pathname)},d=({url:e,deepLinkDomains:t,deepLinkPaths:n,supportHashDeeplinks:i,coreSettings:a})=>{for(const o of t)for(const t of n){let n,r;try{n=new URL(e),r=new URL(t,o)}catch(e){return!1}if(l(n,r,t,a))return!0;if(i&&c(n,r,a))return!0}return!1}},156065:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});const i=(e,t)=>{if(e&&t){const t=/^(.*); expires=(.*); path=\/$/,n=2,i=e.match(t);if(i){return new Date(i[n]).getTime()>Date.now()}}return!1}},653685:(e,t,n)=>{"use strict";n.d(t,{gD:()=>u,fM:()=>m});var i=n(117064),a=n(435054);const o=new RegExp(a.yH.oneNoteTargetRegex),r=new RegExp(a.yH.oneNoteSectionRegex),s=e=>{const t=o.exec(e);let n="";return t&&(n=t[1]),n},l=e=>{const t=r.exec(e);let n="";return t&&(n=t[1]),n},c=new RegExp(a.yH.oneDriveFile),d=new RegExp(a.yH.sharePointFile),u=(e,t,n)=>{const o=(0,i.Q)(e),r=o?o.replace(a.yH.trailingSlashRegex,""):"";let s=null;if(c.test(e)){s={sourceTeamName:a.HV.personal,sourceChannelName:r.split("/").pop()}}else if(d.test(e)){const t=r.split("/").pop()||"",n=2;s={sourceTeamName:decodeURIComponent(t),sourceChannelName:decodeURIComponent(e.substring(r.length-1).split("/")[n])}}if(t===a.BY.extension&&-1!==(null==n?void 0:n.indexOf(a.BY.extensionWithDot))){const e=p(n);(null==e?void 0:e.sectionGroup)&&s&&(s.sourceChannelName=`${s.sourceChannelName} > ${e.sectionGroup}`),(null==e?void 0:e.section)&&s&&(s.sourceChannelName=`${s.sourceChannelName} > ${e.section}`)}return s},m=(e,t)=>{let n=null;const i=decodeURIComponent(e);let a=s(i),o=l(a),r="";if(o.includes("/")){const e=o.lastIndexOf("/");a=a.substring(e+1),o=o.substring(e+1)}o=g(o);const c=t;t=o;const d=a.indexOf("/");if(-1!==d){const e=a.lastIndexOf("|");let n=a.substring(d+1,e);n=g(n),t=n,r=o}return n={title:t,noteBook:c,section:r},n},g=e=>e.replace(/(?:\\(.))/g,"$1"),p=e=>{let t=null,n="",i="",a="";e&&(n=decodeURIComponent(e));let o=s(n),r=l(o);if(r.includes("/")){const e=r.lastIndexOf("/");if(a=r.substring(0,e),a){const e=a.split("/");let t="";e.forEach((e=>{t=""===t?e:`${t} > ${e}`})),a=t}o=o.substring(e+1),r=r.substring(e+1)}return-1!==o.indexOf("/")&&(i=r),t={sectionGroup:g(a),section:g(i)},t}},218169:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var i=n(86371),a=n(921297),o=n(435054),r=n(786884);const s=(e,t,n)=>{const s=c(e),d=(0,r.O$)(e,i.z.internalErrorCode),u=(0,r.O$)(e,i.z.httpCode,(null==e?void 0:e.code)||d||""),m={errorMessage:s,serverRequestId:(0,r.O$)(e,i.z.correlationId)};t(s),(0,a.X)(parseInt(u||"",10))&&!l(parseInt(u||"",10),d)?n&&n.fail({errors:JSON.stringify(m),errorCode:`${u}`}):n&&n.incomplete({errors:JSON.stringify(m),errorCode:`${u||o.BS.Unhandled}`})},l=(e,t)=>e&&e===o.Bx.badRequest&&t&&t===o.BS.InvalidRequest,c=e=>{let t=(0,r.O$)(e,i.z.logErrorMessage,(null==e?void 0:e.message)||"");const n=(0,r.O$)(e,"innerError",{message:""});t=`${t}. ${n?n.message:""}`;const a={context:null==e?void 0:e.context,subContext:null==e?void 0:e.subContext};return t=`${t}. ${JSON.stringify(a)}`,t}},861887:(e,t,n)=>{"use strict";n.d(t,{un:()=>c,jg:()=>h,xi:()=>f,iE:()=>k});var i=n(361366),a=n(197981),o=n(595068),r=n(522546),s=n(47135),l=n(533207);const c=(e,t,n,i)=>{let a={normalized:e,diallable:e,display:e};const{logger:o,userLocale:r,isDialPlansEnabled:s,allowNonE164Mri:c,phoneNumberUtil:u,phoneNumberFormat:p}=n;if(!u||!p)return o.warn(`[formatPhoneNumber] Invalid config: isPhoneNumberUtilDefined=${!!u}, isPhoneNumberFormatDefined=${!!p}`),a;if(!e)return o.warn(`[formatPhoneNumber] No phone number provided from: ${t}`),a;if(o.log(`[formatPhoneNumber] Received phoneNumber: ${e} from: ${t}`),!i){const t=(0,l.bR)(e),i=d(t,n);if(o.log("[formatPhoneNumber] cleaned_formatting"),s){if(a=b(i,n),o.log(`[formatPhoneNumber] isInternalExtension? ${a.isInternalExtension}`),a.isInternalExtension)return a}else o.log("[formatPhoneNumber] Dialplan not enabled, not applying normalization rules"),a.normalized=i;c||(a.normalized=m(a.normalized,p.E164,n,!0),o.log("[formatPhoneNumber] NonE164 mri are not allowed"))}a=Object.assign(Object.assign({},a),g(a.normalized,n));try{const e=u.getInstance().parseAndKeepRawInput(a.normalized,r);a.display=u.getInstance().formatInOriginalFormat(e,p.INTERNATIONAL),a.isValid=u.getInstance().isPossibleNumber(e)&&u.getInstance().isValidNumber(e)}catch(e){o.error(`[formatPhoneNumber] ${e}`),a.display=a.normalized,a.isValid=!1}return o.log(`[formatPhoneNumber] isValid? ${a.isValid}`),a},d=(e,t)=>{if(!t.phoneNumberUtil)return t.logger.warn(`[convertPhoneNumberToAlpha] Invalid config: isPhoneNumberUtilDefined=${!!t.phoneNumberUtil}`),e;const n=u(e,t),i=e.substring(n.length);return t.phoneNumberUtil.convertAlphaCharactersInNumber(n)+i},u=(e,t)=>{if(!t.phoneNumberUtil)return t.logger.warn(`[getPhoneNumberWithoutExtension] Invalid config: isPhoneNumberUtilDefined=${!!t.phoneNumberUtil}`),e;const n=t.phoneNumberUtil.EXTN_PATTERN_,i=e.search(n);return i>=0?e.substring(0,i):e},m=(e,t,n,i,a)=>{const{userLocale:o,logger:r,phoneNumberUtil:s,phoneNumberFormat:l}=n;if(!s||!l)return r.warn(`[parseAndFormatNumber] Invalid config: isPhoneNumberUtilDefined=${!!s}, isPhoneNumberFormatDefined=${!!l}`),e;const c=t||l.INTERNATIONAL,d=y(e,n,"parseAndFormatNumber");if(!f(d,n,a))return d;try{if(i){const e=s.getInstance().parse(d,o);return s.getInstance().format(e,c)}{const e=s.getInstance().parseAndKeepRawInput(d,o);return s.getInstance().formatInOriginalFormat(e,c)}}catch(e){return r.error("[parseAndFormatNumber] Failed to parse and format a phone number",e),d}},g=(e,t)=>{const{enableFormattingFixForExtension:n}=t;return{diallable:u(e,t),extension:n?v(e,t):p(e,t)}},p=(e,t)=>{const n=y(e,t,"getExtension");return v(n,t)},v=(e,t)=>{const{enablePstnWithExtnFix:n,enableFixForDtmfTone:i,logger:a,userLocale:o,phoneNumberUtil:r}=t;if(!r)return a.warn(`[getExtensionFromNormalizedNumber] Invalid config: isPhoneNumberUtilDefined=${!!r}`),"";if(!n&&!i&&!f(e,t))return a.warn(`[getExtension] Received an invalid phone number: ${e}`),"";try{return r.getInstance().parse(e,o).getExtension()||""}catch(e){return a.error("Failed to parse and format a phone number",e),""}},h=(e,t,n,i)=>{const{logger:a}=t;let r=`${o.V.Pstn}${e}`;return n&&(r+=`${o.V.PstnExtension}${n}`),a.log(`[generateMriForPstn] context: ${i} Generated MRI: ${r} for dialOutNumber: ${e} ${n?`and extension: ${n}`:""}`),r},f=(e,t,n)=>{const{userLocale:i,logger:a,phoneNumberUtil:o}=t;if(!o)return a.warn(`[isStandardFormatNormalized] Invalid config: isPhoneNumberUtilDefined=${!!o}`),!1;if(!e)return!1;try{const a=y(e,t,"isStandardFormatNormalized"),r=o.getInstance().parse(a,i),s=o.getInstance().isPossibleNumber(r);return n?s:s&&o.getInstance().isValidNumber(r)}catch(e){return a.error("[isStandardFormatNormalized] error:",e),!1}},y=(e,t,n)=>{const{isDialPlansEnabled:i,logger:a}=t;a.log(`[normalizePstnNumber] Received phoneNumber: ${e} from: ${n}`);const o=(0,l.bR)(e);return i?b(o,t).normalized:o},b=(e,t)=>{const{normalizationRules:n,logger:i}=t,a={normalized:e,diallable:e,display:e};if(!n.length)return a;const o=new r.E(n,void 0,i).normalize(e);return a.normalized=o.phoneNumber,a.diallable=null==o?void 0:o.phoneNumber,a.display=null==o?void 0:o.phoneNumber,a.isInternalExtension=null==o?void 0:o.isInternalExtension,a.isValid=!0,a},S=(e,t,n,i,o)=>{let r;if(!(0,a.isEmpty)(e)){const t=null==i?void 0:i.getInstance().getRegionCodeForCountryCode(Number(e));if(t)return r=t.toLowerCase(),n.log(`Setting locale based on dial plan to ${r}`),r}const s=(null==o?void 0:o())||t||"en-US";return s?(r=s.substring(s.indexOf("-")+1).toLowerCase(),n.log(`Setting locale based on teams locale to ${r}`),r):(n.warn("localizationService failed to get locale. Falling back to 'us' locale"),"us")},k=(e,t,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var o,r;const l=e.get(s.J.Calling),c=yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let t;try{t=yield n.e(29311).then(n.t.bind(n,23953,23))}catch(t){return e.warn(`[getLibPhoneNumber] Failed to load @microsoft/google-libphonenumber. ${null==t?void 0:t.message}`),{}}return t})))(a);return{allowNonE164Mri:!!l.allowNonE164Mri,isDialPlansEnabled:!!l.enableDialPlans,enablePstnWithExtnFix:!!l.enablePstnWithExtnFix,normalizationRules:(null===(o=l.dialPlanPolicy)||void 0===o?void 0:o.normalizationRules)||[],enableFormattingFixForExtension:!!l.enableFormattingFixForExtension,userLocale:S((null===(r=l.dialPlanPolicy)||void 0===r?void 0:r.ituCountryPrefix)||"",t,a,c.PhoneNumberUtil),enableFixForDtmfTone:!!l.enableFixForDtmfTone,logger:a,phoneNumberUtil:c.PhoneNumberUtil,phoneNumberFormat:c.PhoneNumberFormat}}))},802788:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var i=n(848378),a=n(520850),o=n(461525);const r=(e,t,n,r)=>(0,i.z)((0,a.R)(((n,i)=>Array.from(function*(e,t,n,i){const a=e[Symbol.iterator](),o=t[Symbol.iterator]();let r=a.next(),s=o.next();for(;!s.done||!r.done;)s.done||!r.done&&s.value.id>r.value[0].id?(i(r.value[1]),r=a.next()):r.done||s.value.id<r.value[0].id?(yield[s.value,n(s.value)],s=o.next()):(yield[s.value,r.value[1]],r=a.next(),s=o.next())}(n,Array.from(i).sort(((e,t)=>e.id.localeCompare(t.id))),(t=>{try{return{type:"value",value:e(t)}}catch(e){return r&&r(t,e),{type:"error",error:e}}}),(e=>{if("error"!==e.type)return t(e.value)})))),[]),(0,o.U)((e=>e.filter((e=>"value"===e[1].type)).map((e=>n(e[0],e[1].value))))))},575603:(e,t,n)=>{"use strict";var i;n.d(t,{Y:()=>i}),function(e){e.About="about",e.Accounts="accounts",e.Accessibility="accessibility",e.Calendar="calendar",e.Calls="calls",e.General="general",e.Notifications="notifications",e.People="people_setting",e.Privacy="privacy",e.Benefits="benefits",e.Transcription="captions_and_transcription",e.Devices="devices",e.FilesAndLinks="files_and_links",e.PhoneLink="phonelink"}(i||(i={}))},703349:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(174103);const a=(e,t)=>{try{return e.matchMedia(i.s0.ColorContrastOverride).matches?(null==t||t.log(`OS Theme Matches: ${i.s0.ColorContrastOverride}`),i.f8.Contrast):e.matchMedia(i.s0.Dark).matches?(null==t||t.log(`OS Theme Matches: ${i.s0.Dark}`),i.f8.Dark):e.matchMedia(i.s0.Light).matches?(null==t||t.log(`OS Theme Matches: ${i.s0.Light}`),i.f8.Light):(null==t||t.log("OS Theme Matches: None. Returning theme type light."),i.f8.Light)}catch(e){return void(null==t||t.log(`Couldn't resolve getOsTheme: ${e.message}`))}}},732436:(e,t,n)=>{"use strict";n.d(t,{R6:()=>r,FP:()=>l,sN:()=>c,OA:()=>d,u_:()=>u});var i=n(615465),a=n(174103),o=n(703349);const r=e=>({[a.f8.Light]:e===i.s.life?a.Q2.DefaultTfl:a.Q2.DefaultV2,[a.f8.Dark]:e===i.s.life?a.Q2.DarkTfl:a.Q2.DarkV2,[a.f8.Contrast]:a.Q2.HighContrast}),s=(e,t)=>t[e]||a.Q2.DefaultV2,l=()=>({[a.Q2.Default]:a.f8.Light,[a.Q2.DefaultV2]:a.f8.Light,[a.Q2.DefaultTfl]:a.f8.Light,[a.Q2.Dark]:a.f8.Dark,[a.Q2.DarkV2]:a.f8.Dark,[a.Q2.DarkTfl]:a.f8.Dark,[a.Q2.HighContrast]:a.f8.Contrast}),c=(e,t)=>t[e]||a.f8.Light,d=e=>c(e,l()),u=(e,t,n,i)=>{var r;const l=m(t);if(l)return l;const c=null!==(r=e.getPreferences("theme"))&&void 0!==r?r:{};if(c.followOsTheme){const e=(0,o.Z)(t,i);if(e)return s(e,n)}else if(c.userTheme)return s(c.userTheme,n);return a.Q2.DefaultV2},m=e=>{const t=new URLSearchParams(e.location.search).get("theme");if(t){const e=Object.keys(a.Q2).find((e=>e.toUpperCase()===t.toUpperCase()));return a.Q2[e]}}},214793:(e,t,n)=>{"use strict";n.d(t,{Sq:()=>i,wX:()=>a,hq:()=>o,ij:()=>r,OE:()=>s,ZU:()=>l,If:()=>c,cQ:()=>d,an:()=>u,JH:()=>m});const i="video-message",a="video-message-gc",o="Creation-Epoch",r="tmp.recorder-status",s=(e,t)=>{const n=parseInt(t||"",10);return isNaN(n)||e-n>144e5},l=(e,t)=>e-t>2592e5,c=e=>u(e,"videoBlob"),d=e=>u(e,"thumbnailBlob"),u=(e,t)=>`${i}?cacheId=${e}&type=${t}`,m=e=>{try{const t=new URL(e);if(t.pathname.slice(Math.max(0,t.pathname.length-i.length))!==i)return;const n=t.searchParams.get("cacheId"),a=t.searchParams.get("type"),o="videoBlob"===a||"thumbnailBlob"===a?a:void 0;return n&&o?{cacheId:n,type:o}:void 0}catch(e){return}}},668397:e=>{"use strict";e.exports=ITEMS_VIEW_STRINGS},214797:e=>{"use strict";if("undefined"==typeof componentsWebRecorderLoaderHVCV1Helper){var t=new Error("Cannot find module 'componentsWebRecorderLoaderHVCV1Helper'");throw t.code="MODULE_NOT_FOUND",t}e.exports=componentsWebRecorderLoaderHVCV1Helper},759455:e=>{"use strict";e.exports=JSON.parse('{"clientId":"5e3ce6c0-2b1f-4285-8d4b-75ee78787346","basePath":"multi-window","experienceName":"multi-window","fallbackLocale":"en-us","shouldFetchBootstrapData":true,"webAuth":{"cacheLocation":"localStorage","navigateToLoginRequestUrl":true,"top":{"popUp":true},"iframe":{"redirectPath":"auth"}},"ring":{"id":"ring0"},"cdnVersion":4,"enableDevTools":true,"windowType":"MW","lpcRegion":"df","isLPCEnabled":true,"preloadedI18nNamespaces":["avatar","breakoutRooms","framework","gallery","livePersonaCard","peoplePicker","recurrence","messaging","virtualEvents","teamsAndChannels","meetingCollaboration"],"postMessageConfig":["https://teams.microsoft.com","https://teams.microsoft.us","https://gov.teams.microsoft.us","https://dod.teams.microsoft.us","https://teams.eaglex.ic.gov","https://teams.microsoft.scloud","https://teams.microsoftonline.cn","https://teams.live.com"],"shouldTrackCoreInitTasks":true}')}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,dataWebpackPrefix,policy,loadStylesheet,installedCssChunks,chunkToChildrenMap;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},deferred=[],__webpack_require__.O=(e,t,n,i)=>{if(!t){var a=1/0;for(l=0;l<deferred.length;l++){for(var[t,n,i]=deferred[l],o=!0,r=0;r<t.length;r++)(!1&i||a>=i)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[r])))?t.splice(r--,1):(o=!1,i<a&&(a=i));if(o){deferred.splice(l--,1);var s=n();void 0!==s&&(e=s)}}return e}i=i||0;for(var l=deferred.length;l>0&&deferred[l-1][2]>i;l--)deferred[l]=deferred[l-1];deferred[l]=[t,n,i]},__webpack_require__.F={},__webpack_require__.E=e=>{Object.keys(__webpack_require__.F).map((t=>{__webpack_require__.F[t](e)}))},__webpack_require__.H={},__webpack_require__.G=e=>{Object.keys(__webpack_require__.H).map((t=>{__webpack_require__.H[t](e)}))},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);__webpack_require__.r(n);var i={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var a=2&t&&e;"object"==typeof a&&!~leafPrototypes.indexOf(a);a=getProto(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,__webpack_require__.d(n,i),n},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>(({9:"components-calendar-share-link-dialog",145:"components-screen-recorder2",229:"data-resolvers-browser-share",253:"freemium-upgrade-locale-is-is",470:"coach-report-locale-pt-br",595:"growth-locale-ar-sa",673:"search-locale-mk-mk",749:"health-locale-sv-se",1091:"sht-cortextopictypeswebstrings_ta",1129:"esp-locale-sq-al",1215:"artifacts-platform-locale-it-it",1264:"components-calling-paywall-image-lazy",1440:"breakoutRooms-locale-pl-pl",1474:"meeting-bot-locale-zh-cn",1496:"cast-locale-hu-hu",1586:"help-locale-eu-es",1954:"communities-locale-de-de",2147:"freemium-upgrade-locale-th-th",2308:"channels-locale-ko-kr",2784:"meeting-recap-locale-el-gr",2800:"notesOfficeWebHost",2951:"r_data-resolvers-app-device-permission",2953:"hostDefaultsStrings46",3813:"breakoutRooms-locale-fr-ca",4128:"main-locale-nb-no",4387:"incremental-link",4452:"discover-surface-locale-pl-pl",5351:"it-IT-comment-pane-strings-jsonOfficeOnlineStringResource",5353:"kk-KZ-comment-pane-strings-jsonOfficeOnlineStringResource",5748:"queues-locale-cy-gb",5820:"video-message-locale-ja-jp",5895:"sht-teams-answerroutercontainer",6373:"esp-locale-ja-jp",6431:"hostUxStrings23",6938:"fns59",6942:"broadcast-locale-gl-es",7169:"meetingFlyout-locale-nb-no",7676:"meeting-room-console-locale-ro-ro",7696:"fns44",7813:"meeting-recap-locale-pt-br",7850:"meeting-analytics-locale-nl-nl",8049:"hostUxStrings2",8074:"hi-IN-UiStrings-json",8118:"gallery-locale-nl-nl",8275:"recurrence-locale-es-mx",8806:"data-resolvers-browser-ams",9014:"search-locale-lt-lt",9143:"meeting-recap-locale-ar-sa",9265:"pluginCopilot",9469:"hostUxStrings81",9590:"otlang100",9691:"sht-cortextopictypeswebstrings_da",10186:"health-locale-uk-ua",10203:"create-folder-wizard",10236:"InformationProtectionStrings56",10567:"video-message-locale-sl-si",10649:"extensibility-locale-pt-pt",10675:"sht-search-answer-strings",10722:"communities-create-plus-dialog",11125:"files-locale-nn-no",11189:"meeting-collaboration-locale-ko-kr",11827:"extensibility-locale-ja-jp",11957:"webinar-locale-he-il",12359:"files-locale-pt-br",12440:"freemium-upgrade-locale-sk-sk",12535:"hostDefaultsStrings65",12549:"services-broadcast-signalr",12638:"pt-BR-UiStrings-json",13168:"sr-Cyrl-RS-comment-pane-strings-jsonOfficeOnlineStringResource",13529:"freemium-upgrade-locale-nn-no",13752:"share-email-locale-th-th",14743:"onecamera-locale-lv",14787:"msal-service",15257:"audience-view-dialog-locale-pt-pt",15943:"InformationProtectionStrings12",15965:"r_data-resolvers-teams-and-channels",16014:"services-translate",16284:"communities-locale-gl-es",16487:"calendar-locale-el-gr",16571:"discover-surface-locale-pt-br",16746:"gallery-locale-hr-hr",17002:"messaging-locale-ro-ro",17297:"onecamera-locale-da",17342:"extensibility-locale-cs-cz",17624:"hostUxStrings62",17984:"esp-locale-it-it",17994:"sht-cortextopictypeswebstrings_as-in",18846:"share-email-locale-sr-latn-rs",18898:"lt-strings-jsonThinRes",18950:"hostDefaultsStrings1",19420:"fr-FR-UiStrings-json",19753:"gallery-app",20274:"meeting-room-console-locale-bg-bg",20538:"search-locale-en-us",20702:"message-escalate-dialog-locale-id-id",20998:"webrec2-language-vi",21033:"broadcast-locale-es-es",21390:"data-resolvers-web-app-switcher",21514:"share-email-locale-de-de",21541:"pluginComment",21778:"growth-locale-sk-sk",21829:"platform-app-details-renderer",21868:"webrec2-language-cy-gb",21933:"cast-locale-zh-tw",22463:"platform-app-deeplink-to-sidepanel-execute",22670:"meeting-bot-locale-ro-ro",23020:"files-locale-fi-fi",23169:"semantic-object-locale-ka-ge",23186:"freemium-upgrade-locale-ar-sa",23280:"recurrence-locale-da-dk",23363:"services-scis",23762:"calling-locale-el-gr",23989:"data-resolvers-mru",24149:"guardians-locale-kk-kz",24493:"video-capture-locale-fr-ca",24516:"message-escalate-dialog-locale-sk-sk",25121:"meeting-attendance-teams-app-wrapper",25256:"tk-TM-comment-pane-strings-jsonOfficeOnlineStringResource",25350:"categories-th-th-json",26025:"channels-locale-es-es",26205:"hostUxStrings45",26444:"video-message-locale-th-th",26525:"sht-searchanswerteamsstrings_es-ca",26610:"sht-searchanswerteamsstrings_es-de",26914:"help-locale-mk-mk",26960:"sht-lpc",27018:"growth-locale-da-dk",27069:"r_data-resolvers-third-party-calendar",27133:"data-resolvers-developer-switchers",27214:"teams-and-channels-locale-nn-no",28242:"hostDefaultsStrings5",28489:"breakoutRooms-locale-tr-tr",28812:"share-tray",28921:"communities-locale-pl-pl",29290:"meeting-room-console-locale-eu-es",29311:"libphonenumber-bundle",29475:"esp-locale-el-gr",29780:"categories-tr-tr-json",29942:"hostDefaultsStrings11",29945:"ca-Es-VALENCIA-comment-pane-strings-jsonOfficeOnlineStringResource",30018:"school-locale-es-es",30206:"hostDefaultsStrings9",30236:"school-locale-az-latn-az",31597:"breakoutRooms-locale-is-is",32034:"services-connected-accounts",32085:"people-targeting-locale-nl-nl",32966:"sht-cortextopictypeswebstrings_sq",33172:"pluginChaptering",33925:"recurrence-locale-el-gr",33987:"wiki-locale-gl-es",34027:"school-locale-es-mx",34096:"mi-NZ-comment-pane-strings-jsonOfficeOnlineStringResource",34471:"r_data-resolvers-meeting-options",35575:"onecamera-locale-en-gb",35795:"gl-strings-jsonThinRes",36018:"meeting-recap-locale-bg-bg",36540:"video-capture-locale-ja-jp",36552:"components-screen-recorder10",36644:"virtualEvents-locale-ru-ru",36856:"health-locale-nn-no",37131:"semantic-object-locale-he-il",37288:"sht-cortextopictypeswebstrings_et",37342:"services-viva-insights",37364:"esp-locale-fi-fi",37435:"help-locale-cy-gb",37436:"meet-for-work-locale-cs-cz",37514:"search-locale-tr-tr",37689:"meeting-analytics-locale-mk-mk",37811:"cast-locale-fr-fr",37888:"r_data-resolvers-browser-share",38021:"webinar-locale-sk-sk",38756:"meeting-room-console-locale-hr-hr",38920:"r_data-resolvers-browser-settings",39307:"meetingFlyout-locale-en-us",39840:"video-message-locale-sq-al",40416:"gallery-locale-bg-bg",40826:"meetingFlyout-locale-en-gb",40840:"meet-for-work-locale-sk-sk",41050:"channel-notification-settings",42044:"calling-locale-hr-hr",42119:"broadcast-locale-mk-mk",42279:"video-effects-and-avatar-panel",42388:"sht-cortextopictypeswebstrings_eu",42754:"sht-cortextopictypeswebstrings_si-lk",42849:"meeting-recap-locale-en-us",42869:"meeting-bot-locale-ar-sa",43136:"data-resolvers-channel-activity-settings",43342:"meeting-recap-locale-eu-es",43597:"sht-cortextopictypeswebstrings_ca-es-valencia",43826:"communities-create-channel",43983:"sht-cortextopictypeswebstrings_ka",44292:"coach-report-locale-sr-latn-rs",44565:"esp-locale-sr-latn-rs",44586:"messaging-locale-zh-cn",45029:"data-resolvers-host-updates",45157:"virtualEvents-locale-es-mx",45196:"calendar-locale-ca-es",45419:"InformationProtectionStrings77",45930:"messaging-locale-fr-fr",46148:"r_data-resolvers-artifacts-platform",46436:"meeting-recap-locale-ro-ro",46563:"messaging-locale-th-th",46926:"video-capture-locale-sq-al",47064:"r_data-resolvers-reply-chains",47423:"webrec2-language-mk",47639:"calendar-agenda-view",47761:"audience-view-dialog-locale-pt-br",47838:"meeting-options-locale-he-il",48623:"sht-topics-sdk-loki-api",48839:"ur-PK-UiStrings-json",48904:"aRes12",49087:"data-resolvers-loki",49863:"sr-Cyrl-BA-UiStrings-json",50206:"kn-IN-comment-pane-strings-jsonOfficeOnlineStringResource",50770:"lazy-extensible-app-with-consent-container",50886:"data-resolvers-message-common",50906:"main-locale-en-us",51093:"meeting-collaboration-locale-de-de",51246:"el-GR-comment-pane-strings-jsonOfficeOnlineStringResource",51260:"categories-bg-bg-json",51295:"extensibility-locale-sv-se",51397:"webrec2-language-ms",51404:"InformationProtectionStrings52",51539:"sht-searchanswerteamsstrings_es-ug-cn",51594:"smart-device-locale-ca-es-valencia",51704:"meeting-collaboration-locale-cs-cz",51796:"ru-RU-comment-pane-strings-jsonOfficeOnlineStringResource",52144:"categories-tn-za-json",52407:"r_data-resolvers-desktop-client-shortcuts",52455:"r_data-resolvers-msa-authentication",52876:"meetingFlyout-locale-ko-kr",53108:"queues-locale-vi-vn",53222:"queues-locale-sq-al",53393:"webrec2-language-zh-cn",53586:"growth-locale-nl-nl",53615:"calling-locale-cs-cz",53971:"sht-cortextopictypeswebstrings_prs",54014:"sht-cortextopictypeswebstrings_mk",54180:"search-locale-ru-ru",54436:"meeting-collaboration-locale-sr-latn-rs",54541:"broadcast-locale-he-il",54567:"fluid-calendar-meeting-notes",54739:"otlang36",54889:"communities-locale-sv-se",55028:"calendar-mini-scheduling-assistant",55029:"communities-join-requests",55091:"hostDefaultsStrings71",55452:"communities-locale-fr-ca",55579:"mediaSettingsEditEmptyState",55678:"hostDefaultsStrings76",55851:"communities-locale-it-it",56448:"data-resolvers-m365-links",56481:"files-locale-ca-es",56712:"extensibility-locale-ru-ru",56738:"share-email-locale-bg-bg",56759:"growth-locale-id-id",56947:"aRes27",57020:"message-escalate-dialog-locale-da-dk",57048:"cast-locale-pl-pl",57069:"calling-locale-fr-ca",57164:"main-locale-fr-ca",57245:"hostDefaultsStrings75",57264:"services-io-mru",57368:"webrec2-language-fr-ca",57510:"gallery-locale-fil-ph",57610:"broadcast-locale-lv-lv",57746:"data-resolvers-immersive-reader",57896:"nb-NO-comment-pane-strings-jsonOfficeOnlineStringResource",58089:"r_data-resolvers-user",58267:"webrec2-language-fi",58377:"pa-IN-comment-pane-strings-jsonOfficeOnlineStringResource",59616:"services-user-license",59797:"coach-report-locale-hi-in",59959:"hostDefaultsStrings79",60088:"fr-strings-jsonThinRes",60123:"hostUxStrings27",60684:"biometric-enrollment-locale-eu-es",60785:"meeting-analytics-locale-fr-fr",60982:"it-strings-jsonThinRes",61033:"hostUxStrings24",61145:"cast-locale-sv-se",61518:"aRes26",62035:"growth-locale-zh-tw",62585:"help-locale-id-id",62665:"components-screen-recorder82",62713:"audience-view-dialog-locale-sr-latn-rs",63007:"meeting-bot-locale-fi-fi",63009:"pluginAnalytics",63235:"extensibility-locale-zh-tw",63335:"audience-view-dialog-locale-hi-in",63364:"he-IL-comment-pane-strings-jsonOfficeOnlineStringResource",63366:"fluid-picker-renderer",63434:"message-escalate-dialog-locale-et-ee",63810:"wiki-locale-ro-ro",64108:"people-targeting-locale-nn-no",64279:"survey-locale-it-it",64620:"categories-lb-lu-json",64729:"messageBar",65647:"channels-locale-is-is",66204:"chat-call-button",66235:"meeting-analytics-locale-tr-tr",66424:"webrec2-language-hi",66736:"biometric-enrollment-locale-th-th",67131:"broadcast-locale-de-de",67738:"el-strings-jsonThinRes",67818:"components-calling-e2ee-end-screen",68057:"meet-for-work-locale-nl-nl",68074:"recurrence-locale-et-ee",68400:"data-resolvers-mfu-contacts",68516:"data-resolvers-extensibility-app-picker",68597:"biometric-enrollment-locale-kk-kz",69006:"calendar-locale-sr-latn-rs",69177:"teams-and-channels-locale-mk-mk",69195:"categories-nb-no-json",69752:"categories-ga-ie-json",69813:"growth-locale-en-gb",70849:"meeting-recap-locale-az-latn-az",71021:"esp-locale-ru-ru",71856:"InformationProtectionStrings84",71948:"wiki-locale-mk-mk",72011:"meeting-recap-locale-sk-sk",72333:"meeting-options-locale-bg-bg",72638:"files-locale-es-es",72744:"meeting-bot-locale-fil-ph",72767:"cast-locale-zh-cn",73206:"officeFluidOneDsSink",73540:"communities-onboarding",73825:"sht-cortextopictypeswebstrings_ky",73826:"share-email-locale-sk-sk",74006:"otlang51",74120:"share-email-locale-da-dk",74747:"onecamera-locale-ko",74801:"services-targeting-hierarchy",74837:"esp-locale-ca-es-valencia",75296:"queues-locale-de-de",75402:"school-locale-ru-ru",75413:"broadcast-locale-pt-br",75667:"meeting-analytics-locale-de-de",75810:"calling-empty-notes-page",75818:"data-resolvers-browser-app-state",75895:"broadcast-locale-zh-cn",76057:"r_data-resolvers-browser-voicemail",76141:"webinar-locale-id-id",76197:"meeting-bot-locale-ja-jp",76441:"fi-FI-comment-pane-strings-jsonOfficeOnlineStringResource",76605:"esp-locale-es-es",76961:"meeting-collaboration-locale-ru-ru",77183:"sht-searchanswerteamsstrings_es-sd-arab-pk",77677:"virtualEvents-locale-it-it",77741:"hostDefaultsStrings49",77771:"fns6",77772:"components-screen-recorder44",77960:"video-capture-locale-zh-tw",78594:"data-resolvers-apps-platform",78623:"fns25",78733:"r_data-resolvers-people-targeting",79131:"artifacts-platform-locale-ja-jp",79156:"fns1",79297:"meetingFlyout-locale-cy-gb",79443:"components-post-meeting-comms",79455:"data-resolvers-browser-virtual-events",79506:"services-search",79613:"sht-cortextopictypeswebstrings_fr-ca",79803:"call-health-service",79889:"fns27",80070:"categories-zh-cn-json",80129:"hostUxStrings82",80262:"calendar-locale-hi-in",80275:"sht-searchanswerteamsstrings_es-mn-mn",80319:"otlang27",80516:"freemium-upgrade-locale-zh-cn",81481:"discover-surface-locale-ro-ro",81939:"otlang42",82023:"semantic-object-locale-eu-es",82329:"data-resolvers-platform-tabs",82749:"share-email-locale-hr-hr",82870:"sht-cortextopictypeswebstrings_kk",83458:"communities-locale-ru-ru",83644:"cs-CZ-UiStrings-json",83772:"calendar-locale-kk-kz",83795:"school-locale-ca-es",84042:"data-resolvers-brb",84226:"data-resolvers-contacts-sync-settings",84399:"share-email-locale-vi-vn",84765:"sht-cortextopictypeswebstrings_ko",85421:"gallery-locale-kk-kz",85637:"coach-report-locale-ca-es",85677:"meeting-bot-locale-gl-es",85993:"sht-searchanswerteamsstrings_es-ha-latn-ng",86091:"growth-locale-lv-lv",86142:"video-message-locale-el-gr",86262:"calendar-invite-expansion",86416:"artifacts-platform-locale-sl-si",87237:"recurrence-locale-ca-es",87360:"help-locale-hr-hr",87417:"biometric-enrollment-locale-bg-bg",87547:"fns32",87562:"semantic-object-locale-en-us",87607:"meeting-collaboration-locale-ro-ro",88137:"services-meeting-templates",88478:"calling-locale-pt-br",88553:"audience-view-dialog-locale-az-latn-az",88926:"r_data-resolvers-search",89043:"survey-locale-kk-kz",89107:"categories-ar-sa-json",89798:"meet-for-work-locale-lv-lv",89905:"gallery-locale-sl-si",89997:"meeting-recap-locale-sr-latn-rs",90045:"smart-device-locale-ar-sa",90082:"aRes11",90109:"artifacts-platform-locale-sv-se",90237:"wiki-locale-sl-si",90606:"discover-surface-locale-ja-jp",90972:"coach-report-teams-app-wrapper",90999:"download-the-latest-desktop-app",91078:"meeting-collaboration-locale-it-it",91135:"meet-for-work-locale-hi-in",91143:"messaging-locale-it-it",91706:"communities-locale-et-ee",91759:"audience-view-dialog-locale-sq-al",92481:"smart-device-locale-is-is",92525:"calling-locale-sr-latn-rs",92567:"sht-cortextopictypeswebstrings_te",92598:"r_data-resolvers-search-feedback",93048:"channels-locale-en-gb",93050:"search-locale-bg-bg",93241:"breakoutRooms-locale-it-it",93332:"freemium-upgrade-locale-vi-vn",93413:"virtualEvents-locale-pt-br",93564:"webrec2-language-da",93760:"message-escalate-dialog-locale-en-us",94119:"aRes19",94155:"virtualEvents-locale-et-ee",94341:"webrec2-language-de",94444:"semantic-object-locale-sr-latn-rs",94451:"sht-cortextopictypeswebstrings_id",94462:"spaddondataonlydeferred",94779:"school-locale-lv-lv",94954:"meeting-recap-locale-lt-lt",95213:"data-resolvers-augloop",95339:"channels-locale-pt-br",95465:"sl-SI-UiStrings-json",95468:"otlang17",95683:"coach-report-locale-en-gb",95844:"broadcast-locale-cs-cz",96148:"biometric-enrollment-locale-et-ee",96314:"growth-locale-de-de",96380:"people-targeting-locale-fi-fi",96601:"health-locale-lv-lv",96698:"esp-coachmark",96978:"services-live-state-broadcast",97202:"guardians-locale-he-il",97431:"hostDefaultsStrings19",97596:"guardians-locale-is-is",98208:"data-resolvers-browser-esp",98217:"extensibility-locale-en-gb",98289:"meeting-recap-locale-es-mx",98687:"categories-hu-hu-json",98720:"notesHeaderOrganizerPersona",98725:"coach-report-locale-fi-fi",98790:"categories-sr-latn-rs-json",98857:"recurrence-locale-cs-cz",98889:"extensibility-locale-is-is",99504:"meeting-collaboration-locale-bg-bg",99592:"calling-locale-hu-hu",99598:"biometric-enrollment-locale-he-il",99641:"sr-latn-rs-strings-jsonThinRes",99728:"sk-SK-comment-pane-strings-jsonOfficeOnlineStringResource",99951:"share-email-locale-ja-jp",99986:"meeting-collaboration-locale-gl-es",100240:"components-meeting-room-front-of-room-entry",100545:"r_data-resolvers-external-calendar-email-address",100588:"data-resolvers-toast",100598:"survey-locale-ro-ro",100741:"message-escalate-dialog-locale-de-de",100822:"messaging-locale-ca-es-valencia",100834:"virtualEvents-locale-uk-ua",101026:"fns36",101345:"video-capture-locale-el-gr",101573:"school-locale-gl-es",101659:"people-targeting-locale-id-id",101989:"sht-cortextopictypeswebstrings_de",102060:"meetingFlyout-locale-kk-kz",102138:"smart-device-locale-en-gb",102479:"meeting-bot-locale-sq-al",102559:"gallery-locale-ka-ge",102701:"main-locale-es-mx",102771:"esp-locale-pt-br",102774:"share-email-locale-fr-fr",102893:"id-ID-UiStrings-json",103232:"extensibility-locale-ka-ge",103568:"video-message-locale-lv-lv",103842:"breakout-rooms",103972:"meet-for-work-locale-hu-hu",103998:"services-guardians",104010:"communities-locale-he-il",104346:"hostUxStrings32",105053:"files-locale-lv-lv",105082:"audience-view-dialog-locale-eu-es",105183:"coach-report-locale-da-dk",105632:"data-resolvers-calendar",105880:"virtualEvents-locale-mk-mk",105887:"az-latn-az-strings-jsonThinRes",106428:"webrec2-language-sq",106652:"services-dynamics-virtual-events",107215:"gallery-locale-it-it",107458:"r_data-resolvers-esp-target",107523:"search-locale-ko-kr",107832:"sht-searchanswerteamsstrings_es-ro",108224:"meeting-collaboration-locale-mk-mk",108418:"video-capture-locale-sl-si",108525:"r_data-resolvers-browser-style-my-room",108609:"meeting-room-console-locale-hi-in",108725:"components-files-personal-picker",108897:"categories-nn-no-json",109030:"sht-searchanswerteamsstrings_es-fr",109505:"hostUxStrings56",109545:"search-locale-de-de",109582:"components-calendar-main-slot-content",109675:"meetingFlyout-locale-sr-latn-rs",109875:"communities-locale-eu-es",110642:"wiki-locale-ka-ge",110849:"r_data-resolvers-browser-1gql-view-data",111198:"meeting-room-front-row-chat",111318:"keyboardShortcutsModal",111503:"communities-locale-da-dk",111943:"calendar-locale-ko-kr",112002:"reactions-overlay-renderer",112047:"r_data-resolvers-channel-info-pane",112502:"broadcast-locale-es-mx",112657:"school-locale-ko-kr",112782:"school-locale-ja-jp",113353:"meetingFlyout-locale-fi-fi",113428:"meeting-room-console-locale-fil-ph",113484:"health-locale-el-gr",113737:"biometric-enrollment-locale-ro-ro",113739:"people-targeting-locale-fr-fr",113872:"meeting-room-console-locale-is-is",113909:"freemium-upgrade-locale-sr-latn-rs",114151:"extensibility-locale-zh-cn",114526:"cast-locale-da-dk",114826:"services-url-preview",115078:"people-targeting-locale-is-is",115166:"queues-locale-sl-si",115195:"communities-add-member-dialog",115314:"audience-view-dialog-locale-hr-hr",116205:"services-ai-insights-sds",116267:"sht-cortextopictypeswebstrings_it",116356:"fa-IR-comment-pane-strings-jsonOfficeOnlineStringResource",116676:"semantic-object-locale-ca-es",117270:"meeting-room-console-locale-ru-ru",117530:"attendee-view-app",118223:"document-creator",118228:"people-targeting-locale-gl-es",118390:"r_data-resolvers-team-gallery",118491:"hostUxStrings21",118529:"video-capture-locale-pt-br",118698:"mk-MK-UiStrings-json",119050:"audience-view-dialog-locale-nl-nl",119069:"meeting-collaboration-locale-hr-hr",119233:"message-escalate-dialog-locale-es-es",119330:"hostUxStrings36",119371:"meet-for-work-locale-fi-fi",119374:"virtualEvents-locale-cs-cz",119790:"r_data-resolvers-bots-platform-worker",119825:"webrec2-language-hr",120012:"categories-ru-ru-json",120132:"calendar-locale-cs-cz",120155:"hostDefaultsStrings42",120352:"meeting-collaboration-locale-fr-fr",120397:"webinar-locale-nl-nl",120765:"share-email-locale-cy-gb",120904:"recurrence-locale-pl-pl",120933:"communities-empty-state",121786:"gallery-locale-mk-mk",122413:"teams-and-channels-locale-he-il",122699:"r_data-resolvers-tenant-analytics",122767:"sht-cortextopictypeswebstrings_cs",122842:"esp-locale-ka-ge",123025:"search-locale-uk-ua",123293:"fns75",123400:"messaging-locale-sq-al",123493:"broadcast-locale-th-th",123552:"meeting-recap-locale-sl-si",124053:"otlang28",124197:"fluid-compose-container",124572:"health-locale-it-it",125447:"hostDefaultsStrings83",125502:"virtualEvents-locale-nn-no",125532:"share-email-locale-cs-cz",125612:"zh-CN-UiStrings-json",125841:"components-screen-recorder106",125891:"sht-cortextopictypeswebstrings_zh-hant",126263:"teams-and-channels-locale-cs-cz",126442:"pluginMeetingCatchup",126756:"data-resolvers-browser-notifications-settings",126819:"teams-and-channels-locale-en-us",126841:"freemium-upgrade-locale-en-gb",126924:"ug-CN-UiStrings-json",127029:"fr-CA-comment-pane-strings-jsonOfficeOnlineStringResource",127109:"hostDefaultsStrings51",127199:"main-locale-sk-sk",127490:"data-resolvers-browser-voicemail",127946:"aRes6",128254:"guardians-locale-ru-ru",128560:"services-broadcast-captions",128846:"quz-PE-UiStrings-json",128859:"meetingFlyout-locale-lt-lt",128887:"r_data-resolvers-platform-tabs-state",129323:"InformationProtectionStrings78",129405:"button-grid-overlay-renderer",129884:"categories-ig-ng-json",130005:"artifacts-platform-locale-zh-tw",130092:"artifacts-platform-locale-mk-mk",130192:"r_data-resolvers-ai-insights-sds",130288:"services-sharepoint-share",130313:"InformationProtectionStrings70",130748:"meetingFlyout-locale-eu-es",130778:"repIssue",131543:"meeting-bot-locale-cs-cz",132071:"messaging-locale-en-gb",132076:"main-locale-cs-cz",132238:"sht-cortextopictypeswebstrings_es-mx",132529:"data-resolvers-import-msa-contacts",132897:"esp-locale-nb-no",133097:"components-calendar-app-host",133772:"channels-locale-th-th",134125:"services-cloud-storage-folders",134255:"webinar-locale-lv-lv",134257:"webinar-locale-gl-es",134508:"artifacts-platform-locale-ar-sa",134648:"coach-report-locale-ja-jp",134697:"sv-strings-jsonThinRes",135004:"channels-locale-fi-fi",135106:"school-locale-hi-in",135185:"meetingFlyout-locale-sv-se",135821:"gallery-locale-tr-tr",135977:"queues-locale-uk-ua",136279:"meetingFlyout-locale-zh-tw",136608:"virtualEvents-locale-hi-in",136665:"InformationProtectionStrings16",136793:"DeleteConfirmationDialog",137022:"growth-locale-tr-tr",137025:"teams-and-channels-locale-zh-tw",137106:"audience-view-dialog-locale-ru-ru",137252:"audience-view-dialog-locale-en-us",137378:"webinar-locale-uk-ua",137390:"recurrence-locale-en-gb",137472:"meeting-analytics-locale-sv-se",137589:"meeting-analytics-locale-hu-hu",138008:"discover-surface-locale-mk-mk",138693:"webinar-locale-lt-lt",138885:"calendar-locale-es-mx",139155:"r_data-resolvers-update-client-state",139442:"sht-cortextopictypeswebstrings_sr",139746:"r_data-resolvers-search-substrate",139865:"virtual-events-list-container",139886:"esp-locale-en-gb",139947:"discover-surface-caught-main",141064:"share-email-locale-hi-in",141210:"r_data-resolvers-transcript-feedback",141719:"fns62",141720:"files-locale-en-us",142325:"virtualEvents-locale-hr-hr",142469:"guardians-locale-fr-fr",142495:"pluginCustomOptions",142549:"survey-locale-en-gb",142705:"immersive-reader-service",142771:"r_data-resolvers-channel-activity-settings",142919:"sht-searchanswerteamsstrings_es-fr-ca",143338:"coach-report-locale-id-id",143535:"meet-for-work-locale-ro-ro",143589:"esp-locale-sl-si",143795:"files-locale-ro-ro",143825:"r_data-resolvers-browser-url-preview",144145:"calling-locale-nb-no",144178:"discover-surface-locale-fil-ph",144741:"webrec2-language-pt-pt",144777:"r_data-resolvers-browser-lms-integration",145020:"sht-cortextopictypeswebstrings_hr",145332:"services-io-mtma-user-data",145424:"coach-report-locale-fr-ca",145742:"hostUxStrings43",145898:"semantic-object-locale-et-ee",146916:"otlang33",146981:"search-locale-sv-se",147112:"coach-report-locale-tr-tr",147468:"extensibility-locale-es-es",147872:"video-capture-locale-sk-sk",147953:"communities-invite-link-dialog",148003:"smart-device-locale-lt-lt",148084:"r_data-resolvers-external-accounts",148140:"aRes52",148339:"smart-device-locale-gl-es",148370:"meeting-room-console-locale-sk-sk",149576:"AshaUtils",149590:"calendar-locale-gl-es",149721:"extensibility-locale-hu-hu",149752:"extensibility-locale-pl-pl",149974:"meet-for-work-locale-ar-sa",150013:"artifacts-platform-locale-vi-vn",150103:"video-capture-locale-kk-kz",150399:"artifacts-platform-locale-et-ee",150480:"meeting-options-locale-ko-kr",150992:"hr-HR-comment-pane-strings-jsonOfficeOnlineStringResource",151303:"fns72",151397:"webinar-locale-cs-cz",151469:"data-resolvers-viva-insights",151566:"video-capture-locale-hu-hu",151570:"breakoutRooms-locale-es-mx",152177:"discover-surface-locale-sv-se",152281:"onecamera-locale-nb",152287:"calendar-locale-fr-ca",152648:"ka-GE-comment-pane-strings-jsonOfficeOnlineStringResource",152793:"message-escalate-dialog-locale-ja-jp",152995:"channels-locale-ka-ge",153021:"r_data-apollo-broadcast-streaming-attendee",153267:"people-targeting-locale-kk-kz",153326:"hostUxStrings67",153613:"calling-locale-ka-ge",153715:"search-locale-hu-hu",154039:"audience-view-dialog-locale-cs-cz",154068:"esp-locale-sv-se",154125:"breakoutRooms-locale-fi-fi",154212:"artifacts-platform-locale-hr-hr",154423:"share-email-locale-az-latn-az",154788:"calling-locale-bg-bg",154860:"r_data-resolvers-browser-meet-for-work",154866:"aRes29",155340:"r_data-resolvers-browser-survey",155393:"chat-reject-call-button",156149:"biometric-enrollment-locale-es-mx",156255:"services-biometric-enrollment",156275:"guardians-locale-et-ee",156312:"meeting-analytics-locale-hr-hr",156354:"health-locale-es-es",156652:"people-targeting-locale-vi-vn",156722:"calling-locale-ca-es-valencia",157239:"th-TH-comment-pane-strings-jsonOfficeOnlineStringResource",157312:"es-ES-UiStrings-json",157449:"gallery-locale-gl-es",157711:"extensibility-locale-es-mx",157824:"ro-RO-comment-pane-strings-jsonOfficeOnlineStringResource",157944:"teams-and-channels-locale-fil-ph",157998:"health-locale-lt-lt",158486:"cast-locale-sq-al",158571:"audience-view-dialog-locale-ar-sa",158758:"meeting-room-console-locale-da-dk",158800:"smart-device-locale-he-il",159206:"common-post-types",159225:"fns13",159360:"people-targeting-locale-fr-ca",159551:"r_data-resolvers-guardians",159556:"coach-report-locale-ca-es-valencia",159663:"breakoutRooms-locale-az-latn-az",159753:"hostUxStrings70",159764:"wiki-locale-vi-vn",159818:"auth",160111:"files-locale-tr-tr",160295:"fns52",160479:"fns86",160568:"esp-quickguide",160713:"gallery-locale-th-th",160848:"data-resolvers-search-meeting-summary",161183:"share-email-locale-ro-ro",161459:"otlang30",161530:"r_data-resolvers-tfl-meeting-links",161747:"video-message-locale-zh-cn",161768:"audience-view-dialog-locale-et-ee",161855:"meeting-collaboration-locale-en-gb",162036:"guardians-locale-ja-jp",162520:"uk-UA-comment-pane-strings-jsonOfficeOnlineStringResource",162531:"teams-and-channels-locale-pl-pl",162556:"channels-locale-bg-bg",162716:"biometric-enrollment-locale-ca-es-valencia",163502:"meeting-bot-locale-cy-gb",163968:"data-resolvers-browser-meeting-catchup",164423:"cast-locale-ro-ro",164749:"cast-locale-tr-tr",165025:"guardians-locale-ko-kr",165158:"meeting-collaboration-locale-ka-ge",165238:"webinar-locale-zh-tw",165240:"semantic-object-locale-sk-sk",165441:"services-augloop",165446:"meet-for-work-locale-ru-ru",165518:"coach-report-locale-gl-es",165870:"freemium-upgrade-locale-kk-kz",166129:"school-locale-eu-es",166433:"video-capture-locale-fi-fi",166450:"sq-strings-jsonThinRes",166570:"growth-locale-cs-cz",166694:"meeting-room-console-locale-id-id",166937:"r_data-resolvers-community-settings",167008:"communities-locale-kk-kz",167083:"calling-locale-fil-ph",167769:"meeting-room-console-locale-sr-latn-rs",167960:"meeting-analytics-locale-ko-kr",168508:"communities-send-post-as-email-dialog",168794:"smart-device-locale-en-us",168889:"onecamera-locale-sv",168957:"artifacts-platform-locale-ko-kr",169380:"people-targeting-locale-pt-pt",169790:"sht-searchanswerteamsstrings_es-kn",169957:"aRes33",170152:"tti-polyfill",170279:"messaging-locale-gl-es",170558:"r_data-resolvers-privacy-settings",170796:"virtualEvents-locale-gl-es",170845:"notesHeaderTooltip",170918:"discover-surface-locale-ar-sa",171627:"sht-cortextopictypeswebstrings_es",171670:"smart-device-locale-az-latn-az",171835:"meetingFlyout-locale-lv-lv",172042:"services-io-sensitivity-label-policy-settings",172069:"si-LK-comment-pane-strings-jsonOfficeOnlineStringResource",172142:"help-locale-pl-pl",172325:"virtualEvents-locale-hu-hu",172479:"survey-locale-az-latn-az",172557:"services-tenant-service",172842:"services-search-meeting-summary",173250:"meeting-collaboration-locale-pt-pt",173661:"hostDefaultsStrings22",173717:"extensibility-locale-da-dk",173804:"meeting-room-console-locale-ca-es",173890:"onecamera-locale-pl",174249:"calendar-locale-pt-pt",174361:"onecamera-locale-tr",174449:"meetingFlyout-locale-ca-es-valencia",174691:"sk-strings-jsonThinRes",174801:"biometric-enrollment-locale-nl-nl",174847:"esp-locale-zh-cn",175925:"services-calling",176153:"eu-ES-UiStrings-json",176194:"meet-for-work-locale-fil-ph",176355:"channels-locale-et-ee",176902:"artifacts-platform-locale-es-mx",177060:"components-screen-recorder52",177285:"meeting-room-console-locale-ja-jp",177330:"virtualEvents-locale-lt-lt",177362:"sht-searchanswerteamsstrings_es-ta",177455:"smart-device-locale-hi-in",177618:"help-locale-sr-latn-rs",177750:"channels-locale-sv-se",177953:"meetingFlyout-locale-et-ee",178580:"extensibility-locale-sq-al",178815:"services-meeting-bot",178832:"services-emoticon",178866:"data-resolvers-team-gallery",179993:"sht-searchanswerteamsstrings_es-mr",180165:"video-capture-locale-pt-pt",180243:"hostUxStrings47",180280:"r_data-resolvers-azure-maps",180403:"lt-LT-comment-pane-strings-jsonOfficeOnlineStringResource",180560:"fns4",181174:"view-schema",181239:"message-escalate-dialog-locale-fr-fr",181802:"otlang12",181844:"otlang45",182117:"survey-locale-hr-hr",182222:"meeting-options-locale-fr-ca",182409:"webrec2-effects-backdrops",182786:"sht-searchanswerteamsstrings_es-or",182922:"files-locale-gl-es",183393:"gallery-locale-eu-es",183483:"services-google-calendar-authentication",183663:"components-screen-recorder62",183703:"te-IN-UiStrings-json",183707:"r_data-resolvers-shell",184063:"cast-locale-es-mx",184074:"otlang92",184277:"otlang96",184375:"calendar-meeting-artifacts-renderer",184427:"data-resolvers-closed-captions",184586:"holographic-canvas",184874:"r_data-resolvers-browser-app-state",185541:"discover-surface-locale-id-id",186018:"extensibility-locale-lv-lv",186354:"onecamera-locale-th",186677:"queues-locale-th-th",187084:"smart-device-locale-sr-latn-rs",187408:"meeting-analytics-locale-fil-ph",187452:"fns0",188100:"components-search-contextual",188120:"otlang3",188146:"gallery-locale-az-latn-az",188357:"annotation-app",188437:"people-targeting-locale-pl-pl",188541:"wiki-locale-tr-tr",188927:"school-locale-th-th",188975:"services-logs-files",189086:"otlang16",189275:"channels-locale-ca-es-valencia",189560:"message-escalate-dialog-locale-vi-vn",189591:"meet-for-work-locale-ca-es-valencia",189649:"messaging-locale-ar-sa",189683:"messaging-locale-eu-es",189711:"video-message-locale-bg-bg",189755:"lv-LV-UiStrings-json",189910:"video-capture-locale-ro-ro",189979:"et-EE-comment-pane-strings-jsonOfficeOnlineStringResource",189980:"coach-report-locale-nn-no",190625:"coach-report-locale-nl-nl",190658:"meeting-room-console-locale-nn-no",191504:"meeting-analytics-locale-ka-ge",191549:"uk-UA-UiStrings-json",192151:"data-apollo-broadcast-streaming-attendee",193145:"meeting-bot-locale-pt-pt",193553:"data-resolvers-browser-settings",193841:"sht-searchanswerteamsstrings_es-ky",194219:"channels-locale-nl-nl",194248:"services-gallery",194421:"addon-sp-deferredactions",194658:"esp-locale-ko-kr",195002:"meeting-options-locale-el-gr",195320:"sht-cortextopictypeswebstrings_tr",195584:"message-escalate-dialog-locale-pt-pt",196057:"biometric-enrollment-locale-gl-es",196137:"meeting-analytics-locale-ro-ro",196710:"sht-searchanswerteamsstrings_es-ml",196951:"r_data-resolvers-gallery",197282:"meeting-analytics-locale-kk-kz",198050:"data-resolvers-phonelink-sms",198163:"components-screen-recorder78",198167:"meeting-analytics-locale-sk-sk",198629:"breakoutRooms-locale-cy-gb",198722:"data-resolvers-browser-core",198723:"queues-locale-hi-in",198872:"recurrence-locale-ka-ge",199334:"extensibility-locale-cy-gb",199948:"nextGenEngine",200245:"audience-view-dialog-locale-sl-si",200471:"recurrence-locale-fil-ph",200650:"queues-locale-bg-bg",201429:"coach-report-locale-ru-ru",201514:"sht-cortex-topics-bootstrapper-topics-sdk",201876:"school-locale-kk-kz",202066:"services-manage-tenant",202090:"data-resolvers-reply-chains",202148:"health-locale-hi-in",202301:"precompiled-web-recorder-web-worker",202708:"extensibility-locale-id-id",202883:"search-locale-sk-sk",202895:"m365chat-card-container",203035:"af-ZA-comment-pane-strings-jsonOfficeOnlineStringResource",203047:"fns8",203137:"services-files",203441:"data-resolvers-translation-settings",203846:"main-locale-id-id",204357:"health-locale-ka-ge",204484:"message-escalate-dialog-locale-sq-al",204672:"r_data-resolvers-distribution-list",204773:"smart-device-locale-tr-tr",205023:"onecamera-locale-ga",205390:"smart-device-locale-pt-br",205400:"broadcast-locale-ko-kr",205688:"InformationProtectionStrings20",205961:"r_data-resolvers-store",206066:"meeting-bot-locale-ko-kr",206194:"meeting-analytics-locale-sl-si",206279:"biometric-enrollment-locale-ca-es",206336:"guardians-locale-hi-in",206355:"webinar-locale-hu-hu",206396:"semantic-object-locale-en-gb",206431:"virtualEvents-locale-es-es",206457:"messaging-locale-fr-ca",206659:"school-locale-bg-bg",207022:"messaging-locale-ru-ru",207056:"main-locale-ca-es-valencia",207351:"webrec2-language-tr",207447:"es-ES-comment-pane-strings-jsonOfficeOnlineStringResource",207514:"zh-hans-strings-jsonThinRes",207545:"survey-locale-hu-hu",207723:"onecamera-locale-ja",207776:"breakoutRooms-locale-uk-ua",208480:"wiki-locale-zh-tw",209252:"breakoutRooms-locale-vi-vn",209411:"queues-locale-fi-fi",210035:"sht-searchanswerteamsstrings_es-zu-za",210056:"meetingFlyout-locale-de-de",210419:"nb-NO-UiStrings-json",210749:"meeting-options-locale-da-dk",210828:"esp-locale-ar-sa",211172:"freemium-upgrade-locale-de-de",211238:"data-resolvers-search-feedback",211286:"survey-form-entry",211591:"teams-dashboard",211657:"onePlayer",211752:"r_data-resolvers-unified-consent",211779:"health-locale-sr-latn-rs",211847:"InformationProtectionStrings2",212216:"components-calling-call-accepted-elsewhere-screen",212243:"broadcast-locale-az-latn-az",212353:"data-resolvers-browser-broadcast-attendee",212401:"add-thread-member-dialog-entity-view",212664:"packageAnalyticsMainElement",212776:"share-email-locale-sq-al",212882:"categories-et-ee-json",213692:"meeting-options-locale-is-is",213862:"data-resolvers-tfl-homepage",214169:"data-resolvers-browser-style-my-room",214368:"meeting-room-console-locale-mk-mk",214495:"r_data-resolvers-share-to-teams",214600:"wiki-locale-bg-bg",214609:"aRes42",214699:"r_data-resolvers-meeting-templates",214988:"services-example",215750:"school-locale-ca-es-valencia",215793:"services-share",216147:"components-screen-recorder102",216266:"InformationProtectionStrings28",216366:"data-resolvers-chat",216390:"queues-locale-is-is",216419:"metaos-core",216478:"teams-and-channels-locale-sk-sk",216489:"sht-cortextopictypeswebstrings_sr-cyrl",216622:"meetingFlyout-locale-vi-vn",218129:"diagnostics-panel-renderer",218418:"esp-locale-kk-kz",218484:"bg-strings-jsonThinRes",218519:"r_data-resolvers-activity-bell-count",218893:"video-capture-locale-nl-nl",218927:"channels-locale-lt-lt",219495:"semantic-object-locale-zh-tw",219511:"communities-members-view",219714:"smart-device-locale-uk-ua",219735:"meet-for-work-locale-sr-latn-rs",220029:"channels-locale-az-latn-az",220573:"semantic-object-locale-nb-no",221247:"webrec2-language-bs-latn-ba",221264:"hostUxStrings30",221477:"InformationProtectionStrings73",221590:"am-ET-comment-pane-strings-jsonOfficeOnlineStringResource",221833:"calling-locale-gl-es",221985:"InformationProtectionStrings62",222321:"wiki-locale-lv-lv",222348:"fns42",222479:"ot",222750:"meetingFlyout-locale-pl-pl",222938:"vi-VN-comment-pane-strings-jsonOfficeOnlineStringResource",223035:"biometric-enrollment-locale-fi-fi",223283:"meet-for-work-locale-pl-pl",223828:"webrec2-wasmcv",223935:"services-developer-switchers",224073:"messaging-locale-sr-latn-rs",224374:"growth-locale-cy-gb",224541:"components-screen-recorder100",224632:"hostUxStrings7",225160:"components-calling-anon-meeting-end-screen",225463:"help-locale-sl-si",226590:"meeting-collaboration-locale-es-mx",226816:"survey-locale-he-il",226828:"files-locale-fr-ca",226842:"core-services-settings-debug",226958:"cast-locale-uk-ua",227810:"video-capture-locale-nn-no",227954:"survey-locale-ka-ge",228048:"fns50",228395:"school-locale-sl-si",228437:"teams-and-channels-locale-fi-fi",228443:"sht-searchanswerteamsstrings_es-fil",228505:"freemium-upgrade-locale-lv-lv",229e3:"kok-IN-comment-pane-strings-jsonOfficeOnlineStringResource",229117:"sht-cortextopictypeswebstrings_pt-pt",229407:"artifacts-platform-locale-el-gr",229533:"hostUxStrings38",229539:"sht-cortextopictypeswebstrings_el",229959:"components-screen-recorder108",230040:"unified-bar-container-manager",230100:"meeting-recap-locale-uk-ua",230191:"gallery-locale-ca-es-valencia",230318:"hostDefaultsStrings27",231353:"audience-view-dialog-locale-tr-tr",231402:"people-targeting-locale-ca-es-valencia",231527:"health-locale-pl-pl",231624:"extensibility-locale-el-gr",232190:"video-message-locale-zh-tw",232334:"react-virtualized-tree-list",233025:"fns56",233745:"data-resolvers-connectors",234396:"r_data-resolvers-browser-files",235391:"wiki-locale-eu-es",235430:"services-external-accounts-response",236391:"ta-IN-comment-pane-strings-jsonOfficeOnlineStringResource",236848:"sre-basics",236854:"virtualEvents-locale-pl-pl",237123:"audience-view-dialog-locale-da-dk",237256:"communities-locale-th-th",237572:"sht-searchanswerteamsstrings_es-gl",237591:"hostDefaultsStrings69",238535:"sht-cortextopictypeswebstrings_ha-latn-ng",238820:"artifacts-platform-locale-eu-es",238957:"video-capture-locale-lv-lv",239117:"gallery-locale-fi-fi",239650:"pre-assignment-entry-image",239717:"data-resolvers-share-to-teams",239888:"survey-locale-pt-pt",240238:"recurrence-locale-sk-sk",241348:"sht-searchanswerteamsstrings_es-eu",241557:"platform-app-metaos-service",241799:"meeting-recap-locale-it-it",242411:"sht-searchanswerteamsstrings_es-ka",242636:"categories-uz-latn-uz-json",242917:"components-screen-recorder46",243158:"meeting-recap-locale-cs-cz",243209:"smart-device-locale-fi-fi",243223:"otlang60",243364:"hostUxStrings19",243890:"broadcast-locale-bg-bg",244480:"artifacts-platform-locale-tr-tr",244680:"da-DK-UiStrings-json",244690:"InformationProtectionStrings74",244699:"cast-locale-en-us",244775:"ko-KR-UiStrings-json",244858:"r_data-resolvers-calendar",245882:"cast-locale-ca-es",245915:"meeting-options-locale-ca-es-valencia",246462:"semantic-object-locale-sv-se",246477:"gallery-locale-es-es",246515:"discover-surface-locale-tr-tr",246657:"calling-locale-en-us",246739:"cast-locale-th-th",246918:"ha-Latn-NG-comment-pane-strings-jsonOfficeOnlineStringResource",246943:"smart-device-locale-hr-hr",247339:"hostUxStrings11",247632:"pluginDebug",247861:"message-escalate-dialog-locale-fi-fi",248098:"biometric-enrollment-locale-fr-ca",248447:"InformationProtectionStrings34",248735:"config-dod",248853:"data-resolvers-conversations-reminder",249051:"smart-device-locale-id-id",249241:"biometric-enrollment-locale-nn-no",249394:"categories-en-us-json",249589:"meeting-bot-locale-en-gb",249805:"freemium-upgrade-locale-he-il",250063:"categories-bs-latn-ba-json",250215:"broadcast-locale-sq-al",250241:"discover-surface-locale-nn-no",250936:"survey-locale-cy-gb",251074:"services-locked-teams",251083:"sht-cortextopictypeswebstrings_be-by",251181:"message-escalate-dialog-locale-uk-ua",251317:"share-email-locale-lv-lv",251425:"services-fluid",251452:"webrec2-language-sl",251975:"growth-locale-th-th",252107:"mr-IN-comment-pane-strings-jsonOfficeOnlineStringResource",252330:"communities-locale-nb-no",252354:"meeting-analytics-locale-sr-latn-rs",252781:"files-locale-kk-kz",252797:"hostDefaultsStrings55",253046:"hostUxStrings84",253119:"createNewModule",253506:"supermassive-incremental-link",254122:"semantic-object-locale-ru-ru",254166:"fns20",254594:"school-locale-nb-no",254692:"services-toast-image",254964:"services-discover-surface-feedback",254970:"meeting-collaboration-locale-es-es",255046:"components-screen-recorder54",255306:"meet-for-work-locale-en-gb",256166:"data-resolvers-browser-meeting-bot",256657:"components-customize-reactions",256828:"meeting-bot-locale-es-es",256992:"health-locale-tr-tr",257052:"guardians-locale-de-de",257405:"webinar-locale-ca-es",257617:"communities-locale-hr-hr",257621:"meeting-recap-locale-hu-hu",257760:"survey-locale-fr-ca",258004:"coach-report-locale-is-is",258259:"guardians-locale-en-us",258357:"discover-surface-locale-sk-sk",258466:"sht-searchanswerteamsstrings_es-hy",258557:"extensibility-locale-kk-kz",258877:"sht-searchanswerteamsstrings_es-hi",259465:"categories-fi-fi-json",259999:"discover-surface-locale-pt-pt",260390:"tr-TR-comment-pane-strings-jsonOfficeOnlineStringResource",260509:"InformationProtectionStrings43",260744:"video-capture-locale-th-th",260758:"r_data-resolvers-browser-meeting-artifacts",260891:"discover-surface-error-main",261090:"teams-and-channels-locale-ru-ru",261537:"people-targeting-locale-it-it",261539:"semantic-object-locale-pt-pt",261746:"growth-locale-hi-in",261784:"sht-cortextopictypeswebstrings_hu",262027:"guardians-post-type",262199:"nn-NO-UiStrings-json",262475:"fns17",262793:"pluginAudioFiles",262851:"audience-view-dialog-locale-lv-lv",262860:"video-message-locale-lt-lt",262889:"wiki-locale-nl-nl",263038:"components-calling-healthy-tips",263237:"people-targeting-locale-bg-bg",263311:"bs-latn-ba-strings-jsonThinRes",263563:"AtMentionLazy",263907:"sht-searchanswerteamsstrings_es-bg",264078:"broadcast-locale-ca-es",264381:"freemium-upgrade-locale-el-gr",264403:"semantic-object-locale-th-th",264479:"wiki-locale-sk-sk",264779:"sht-cortextopictypeswebstrings_he",264992:"health-locale-th-th",265469:"meeting-analytics-locale-fi-fi",265630:"pt-pt-strings-jsonThinRes",265758:"people-targeting-locale-ru-ru",266144:"gallery-locale-pl-pl",266179:"virtualEvents-locale-az-latn-az",266281:"fns26",266613:"message-escalate-dialog-locale-zh-tw",266714:"meeting-bot-locale-id-id",267099:"hostDefaultsStrings84",267228:"it-IT-UiStrings-json",267644:"ne-NP-comment-pane-strings-jsonOfficeOnlineStringResource",267949:"webinar-locale-ko-kr",267989:"audience-view-dialog-locale-th-th",267996:"r_data-resolvers-appbar",268312:"meeting-analytics-locale-lv-lv",268446:"hostDefaultsStrings80",269541:"components-screen-recorder32",269971:"search-locale-gl-es",270410:"calling-devices-panel",270602:"esp-locale-mk-mk",270706:"survey-locale-ca-es-valencia",271023:"meeting-bot-locale-sl-si",271599:"sht-cortextopictypeswebstrings_ml",271722:"sht-cortextopictypeswebstrings_sw",272346:"precompiled-shared-worker",272526:"sht-searchanswerteamsstrings_es-kok",272734:"discover-surface-empty-main",273177:"video-message-locale-ca-es-valencia",273760:"growth-locale-vi-vn",273806:"services-giphy",273824:"fns79",273836:"itemsettileslist",273851:"broadcast-locale-en-gb",274121:"meeting-collaboration-locale-nn-no",274217:"teams-and-channels-locale-pt-pt",274403:"teams-and-channels-locale-az-latn-az",274444:"wiki-locale-nb-no",274543:"categories-ne-np-json",274580:"InformationProtectionStrings13",274590:"survey-locale-da-dk",274786:"semantic-object-locale-nn-no",275041:"meeting-room-console-locale-tr-tr",275174:"sht-searchanswerteamsstrings_es-ja",275287:"otlang86",275292:"hostUxStrings4",275863:"nova-sb-variant-teams-exp",275935:"communities-locale-fi-fi",276087:"r_data-resolvers-tenant-membership",276370:"esp-locale-id-id",276518:"r_data-resolvers-immersive-view",277222:"files-locale-cs-cz",277233:"people-targeting-locale-fil-ph",277412:"services-third-party-calendar",277527:"gallery-locale-hu-hu",277639:"ar-strings-jsonThinRes",278402:"meeting-room-console-locale-lv-lv",278792:"health-locale-sq-al",278800:"webinar-locale-fr-fr",278910:"InformationProtectionStrings82",278996:"data-resolvers-meeting-templates",279552:"video-context",279673:"card-shared-header",279932:"data-resolvers-people-targeting",279957:"gallery-locale-vi-vn",280520:"health-locale-da-dk",280574:"data-resolvers-taskbar",280579:"data-resolvers-notifications",280647:"communities-edit-dialog",280664:"zh-tw-strings-jsonThinRes",280699:"semantic-object-locale-uk-ua",280735:"nl-NL-comment-pane-strings-jsonOfficeOnlineStringResource",281093:"video-capture-locale-ko-kr",281227:"health-locale-kk-kz",281234:"queues-locale-sk-sk",281237:"queues-locale-lv-lv",281381:"breakoutRooms-locale-ka-ge",281439:"hostUxStrings20",282009:"onecamera-locale-ka",282033:"sht-searchanswerteamsstrings_es-tr",282118:"virtualEvents-locale-da-dk",282596:"hostDefaultsStrings61",282789:"sht-teams-paaanswers",282850:"onecamera-locale-mk",283035:"calling-cdl-calling-package-loader",283314:"aRes44",283400:"teams-and-channels-locale-sv-se",283549:"messaging-locale-zh-tw",283593:"messaging-locale-sv-se",283992:"calendar-locale-es-es",284004:"components-calling-quality-feedback",284063:"audience-view-dialog-locale-sk-sk",284765:"survey-locale-ca-es",284860:"packageFileAnalytics",284862:"video-capture-locale-ru-ru",284870:"sht-cortextopictypeswebstrings_bn-in",284926:"video-message-locale-pl-pl",285260:"sht-searchanswerteamsstrings_es-sr-cyrl-ba",285503:"guardians-locale-th-th",285538:"sht-cortextopictypeswebstrings_kok",285783:"video-message-locale-es-es",285815:"meeting-collaboration-locale-zh-tw",285883:"entity-more-info-app",285991:"meeting-room-console-locale-gl-es",286190:"r_data-resolvers-search-prefetch",286264:"bg-BG-comment-pane-strings-jsonOfficeOnlineStringResource",286358:"meetingFlyout-locale-id-id",286608:"biometric-enrollment-locale-en-gb",286973:"kk-KZ-UiStrings-json",287024:"channels-locale-ca-es",287036:"coach-report-locale-th-th",287676:"help-locale-fr-ca",287808:"files-locale-az-latn-az",287809:"aRes22",288059:"messaging-locale-de-de",288475:"services-tenant-analytics",288542:"data-resolvers-external-accounts",288771:"InformationProtectionStrings50",288910:"esp-locale-hr-hr",289104:"otlang21",289142:"otlang64",289526:"hostDefaultsStrings81",290080:"InformationProtectionStrings37",290189:"survey-locale-nn-no",290265:"gallery-locale-el-gr",290378:"data-resolvers-external-accounts-response",291282:"channels-locale-sq-al",291443:"data-resolvers-cypress-only",291550:"r_data-resolvers-hosted-web-content-log",291600:"otlang20",291910:"files-locale-zh-cn",292044:"discover-surface-locale-cy-gb",292584:"video-message-locale-az-latn-az",292712:"calendar-locale-bg-bg",292819:"meeting-options-locale-en-us",293186:"hostUxStrings58",293196:"AboutVideoRichTextEditor",293740:"services-cmd-meeting-intelligence",293774:"smart-device-locale-pt-pt",294122:"audience-view-dialog-locale-fi-fi",294157:"web_recorder_v2",294263:"data-resolvers-communities",294267:"sht-cortextopictypeswebstrings_nn-no",295014:"workflow-flyout-container",295378:"fluidxInfProtection",295417:"ca-Es-VALENCIA-UiStrings-json",295589:"teams-and-channels-locale-ca-es-valencia",295746:"da-strings-jsonThinRes",295772:"files-locale-nl-nl",295787:"gallery-locale-sr-latn-rs",295797:"km-KH-UiStrings-json",296046:"health-locale-hr-hr",296105:"meeting-analytics-locale-el-gr",296386:"data-resolvers-bots-platform-worker",296387:"recurrence-locale-vi-vn",296728:"hostUxStrings50",297125:"meeting-recap-locale-nl-nl",297399:"sht-searchanswerteamsstrings_es-ne-np",297436:"messaging-locale-bg-bg",297816:"sht-searchanswerteamsstrings_es-da",297895:"audience-view-dialog-locale-sv-se",298068:"holographic-toolbar",298269:"freemium-upgrade-locale-ca-es-valencia",298368:"meeting-analytics-app",298643:"growth-locale-fil-ph",299290:"meeting-analytics-locale-en-gb",299306:"hostUxStrings60",299927:"extensibility-locale-hr-hr",300211:"meeting-recap-locale-fr-ca",300586:"meetingFlyout-locale-is-is",300866:"categories-hy-am-json",301281:"meeting-recap-locale-sv-se",301400:"search-locale-ca-es-valencia",301420:"data-resolvers-appbar",301741:"teams-compose-box",302168:"sht-cortextopictypeswebstrings_mi-nz",302488:"people-targeting-locale-hu-hu",302514:"artifacts-platform-locale-pt-pt",302653:"services-file-download-manager",302849:"channels-locale-id-id",303220:"webrec2-language-it",303460:"ms-strings-jsonThinRes",303762:"components-screen-recorder64",303982:"artifacts-platform-locale-sr-latn-rs",304212:"InformationProtectionStrings75",304596:"data-resolvers-meeting-summary-qna-history",304601:"cast-locale-de-de",304609:"services-policies",304788:"meeting-collaboration-locale-cy-gb",304867:"communities-locale-fr-fr",305271:"shell-app",305324:"school-locale-hu-hu",305724:"meetingFlyout-locale-bg-bg",305729:"meeting-room-all-in-one-entry-container",305777:"discover-surface-locale-es-es",305992:"meet-for-work-locale-sl-si",306284:"queues-locale-fr-fr",306929:"guardians-locale-nl-nl",307124:"message-escalate-dialog-locale-tr-tr",307290:"categories-fa-ir-json",307407:"sr-Cyrl-BA-comment-pane-strings-jsonOfficeOnlineStringResource",307553:"help-locale-ca-es",307738:"precompiled-screen-recorder-web-worker",308063:"categories-gl-es-json",308398:"ms-MY-UiStrings-json",308568:"meetingFlyout-locale-hi-in",308631:"extensibility-locale-he-il",308687:"data-resolvers-meeting-analytics",308725:"r_data-resolvers-browser-webinar",308735:"meeting-options-locale-lt-lt",309119:"af-ZA-UiStrings-json",309342:"services-io-data-smb-user-intent",309981:"gallery-locale-he-il",310683:"data-resolvers-activity",311136:"gallery-locale-es-mx",311368:"navigationPanel",311369:"video-message-locale-ko-kr",311849:"channels-locale-pl-pl",312374:"coach-report-locale-de-de",313170:"fns76",313311:"hostDefaultsStrings57",313411:"freemium-upgrade-locale-ru-ru",313507:"semantic-object-locale-is-is",313666:"esp-locale-he-il",313723:"az-Latn-AZ-comment-pane-strings-jsonOfficeOnlineStringResource",313832:"mt-MT-UiStrings-json",314095:"biometric-enrollment-locale-it-it",314166:"meeting-room-console-locale-ka-ge",314309:"survey-locale-et-ee",314727:"biometric-enrollment-locale-hu-hu",314748:"onecamera-locale-is",315343:"freemium-upgrade-locale-sq-al",315580:"esp-locale-es-mx",315682:"video-message-locale-de-de",316290:"virtualEvents-locale-kk-kz",316907:"components-screen-recorder76",316953:"categories-lv-lv-json",317121:"breakoutRooms-locale-zh-cn",317146:"help-locale-el-gr",317601:"onecamera-locale-fr-ca",317695:"breakoutRooms-locale-id-id",317726:"meeting-room-console-locale-pt-br",317734:"biometric-enrollment-locale-cy-gb",317797:"esp-locale-en-us",318026:"search-locale-ka-ge",318761:"meeting-bot-locale-pl-pl",318957:"meeting-collaboration-locale-hi-in",319002:"components-screen-recorder70",319443:"growth-locale-gl-es",319516:"queues-locale-es-es",319676:"categories-rw-rw-json",319856:"recurrence-locale-ko-kr",319870:"tr-strings-jsonThinRes",319974:"onecamera-locale-pt-pt",320267:"people-targeting-locale-ja-jp",320323:"main-locale-hu-hu",320406:"fns60",320427:"calling-app-prejoin-v1",320896:"growth-locale-ko-kr",321141:"categories-eu-es-json",321167:"extensibility-locale-nl-nl",321346:"survey-locale-fil-ph",321571:"fns68",321647:"message-escalate-dialog-locale-en-gb",321672:"sht-searchanswerteamsstrings_es-lv",321822:"breakoutRooms-locale-el-gr",322012:"files-locale-th-th",322125:"calendar-locale-fi-fi",322458:"growth-locale-es-mx",322499:"fns46",322540:"data-resolvers-browser-lms-integration",322581:"services-lms-integration",322628:"share-email-locale-pl-pl",322803:"files-locale-pl-pl",323134:"sht-cortextopictypeswebstrings_vi",323172:"chat-pane-image",323246:"guardians-locale-eu-es",323871:"artifacts-platform-locale-az-latn-az",323891:"teams-and-channels-locale-ja-jp",323893:"breakoutRooms-locale-en-us",324013:"recurrence-locale-sr-latn-rs",324278:"main-locale-eu-es",324417:"breakoutRooms-locale-cs-cz",324473:"wiki-locale-sv-se",324657:"school-locale-pt-br",324925:"config-gcc",325175:"sht-searchanswerteamsstrings_es-gu",325585:"data-resolvers-channel-info-pane",325603:"r_data-resolvers-targeting-hierarchy",327112:"breakoutRooms-locale-lt-lt",327172:"search-locale-sq-al",327217:"meeting-options-locale-zh-cn",327340:"r_data-resolvers-extensibility-app-picker",327612:"queues-locale-ca-es-valencia",327853:"hostDefaultsStrings73",328281:"webrec2-language-ka",328457:"otlang90",328749:"video-message-locale-gl-es",328830:"wiki-locale-en-gb",329367:"message-escalate-dialog-locale-hu-hu",329559:"meeting-room-console-locale-lt-lt",330078:"search-locale-eu-es",330480:"InformationProtectionStrings45",330637:"webinar-locale-pt-br",331433:"meet-for-work-locale-is-is",331963:"calling-locale-th-th",331986:"hostUxStrings74",332381:"freemium-upgrade-locale-hu-hu",332426:"biometric-enrollment-locale-sr-latn-rs",332653:"video-capture-locale-tr-tr",333176:"sht-searchanswerteamsstrings_es-prs",333371:"teams-and-channels-locale-zh-cn",333560:"artifacts-platform-locale-bg-bg",333684:"sht-searchanswerteamsstrings_es-bn-in",333981:"semantic-object-locale-gl-es",334349:"calling-locale-hi-in",334496:"main-locale-gl-es",335020:"meeting-analytics-locale-ca-es",335255:"sr-Latn-RS-UiStrings-json",335346:"audience-view-dialog-locale-nn-no",335376:"ta-IN-UiStrings-json",335413:"components-stream-camera",335479:"virtualEvents-locale-sk-sk",335626:"share-email-locale-en-us",335833:"people-targeting-locale-hi-in",335921:"main-locale-zh-tw",335940:"cast-locale-fr-ca",336037:"webrec2-language-lv",336142:"extensibility-locale-sk-sk",336153:"guardians-locale-es-es",336217:"sht-cortextopictypeswebstrings_mt-mt",336477:"azuremediaplayer",336537:"calendar-locale-en-us",337042:"r_data-resolvers-browser-calls-screen",337085:"sht-cortextopictypeswebstrings_hy",337232:"guardians-locale-ca-es",337301:"data-resolvers-files",337425:"health-locale-cy-gb",337458:"recurrence-locale-ja-jp",337784:"coach-report-locale-sq-al",337793:"fns19",338259:"categories-pt-br-json",338299:"onecamera-locale-sk",338398:"noiseSuppressionMediaSettings",338457:"channels-locale-ar-sa",338586:"categories-uk-ua-json",339396:"onePlayerAmp",339410:"sht-searchanswerteamsstrings_es-gd-gb",339435:"people-targeting-locale-ka-ge",339541:"hostDefaultsStrings6",339730:"meet-for-work-locale-cy-gb",340060:"services-brb",340285:"otlang44",340370:"files-locale-zh-tw",340600:"artifacts-platform-locale-gl-es",341009:"discover-surface-up-dialog",341253:"meeting-recap-locale-pt-pt",341687:"message-escalate-dialog-locale-nb-no",342182:"meeting-analytics-locale-th-th",342337:"calling-locale-ja-jp",342461:"services-petrol",342920:"coach-report-locale-sv-se",343469:"cast-locale-gl-es",343577:"sht-cortextopictypeswebstrings_hi",343607:"services-ods",343642:"recurrence-locale-eu-es",343722:"growth-locale-mk-mk",343970:"video-capture-locale-fr-fr",344667:"biometric-enrollment-locale-en-us",344975:"people-targeting-locale-he-il",345626:"services-meeting-artifacts",345804:"video-capture-locale-es-es",345805:"ga-ie-strings-jsonThinRes",345816:"otlang47",345933:"components-screen-recorder18",346082:"sht-searchanswerteamsstrings_es-az-latn-az",346789:"hostUxStrings73",346839:"coach-report-locale-et-ee",346949:"aRes4",347038:"meet-for-work-locale-es-es",347162:"hostDefaultsStrings10",347400:"bs-Latn-BA-UiStrings-json",347924:"video-message-locale-cs-cz",348025:"data-resolvers-global-mtma-user-data",348117:"meeting-bot-locale-az-latn-az",348166:"english strings",348627:"webrec2-language-en",348678:"InformationProtectionStrings83",348687:"data-resolvers-browser-communities",348840:"data-resolvers-browser-logs-files",348943:"teams-and-channels-locale-id-id",349073:"data-resolvers-activity-bell-count",349346:"calling-end-screen",349663:"people-targeting-locale-sq-al",350138:"people-targeting-locale-et-ee",350218:"coach-report-locale-fil-ph",350261:"meeting-collaboration-locale-pl-pl",350439:"survey-locale-tr-tr",350718:"services-files-personal",350899:"tfl-calendar-people-picker",350961:"hostDefaultsStrings18",351102:"meeting-recap-locale-id-id",351106:"esp-locale-pt-pt",351292:"cast-locale-ca-es-valencia",351403:"meeting-recap-locale-gl-es",351507:"audience-view-dialog-locale-fil-ph",351554:"main-locale-ro-ro",351685:"audience-view-dialog-locale-cy-gb",351816:"sht-converged-logger",351914:"InformationProtectionStrings29",352324:"components-screen-recorder90",352433:"broadcast-locale-el-gr",352820:"sht-searchanswerteamsstrings_es-pa-in",352849:"components-screen-recorder80",352933:"otlang58",353236:"webrec2-language-he",353857:"otlang1",354347:"meeting-room-console-locale-es-mx",354548:"fns45",354573:"cast-locale-ja-jp",354694:"help-locale-ar-sa",354936:"webrec2-language-hu",355192:"webinar-locale-kk-kz",355221:"data-resolvers-browser-files",355430:"r_data-resolvers-device",355625:"calendar-locale-sl-si",356023:"freemium-upgrade-locale-ko-kr",356092:"discover-surface-locale-ru-ru",356124:"freemium-upgrade-locale-fi-fi",356564:"fns30",356939:"meeting-collaboration-locale-ja-jp",357002:"school-locale-fil-ph",357298:"vi-strings-jsonThinRes",357625:"ca-strings-jsonThinRes",358137:"meet-for-work-locale-he-il",358410:"meeting-bot-locale-es-mx",358512:"sht-cortextopictypeswebstrings_sl",358645:"help-locale-da-dk",358712:"components-calendar-modal",358814:"meeting-room-console-locale-vi-vn",359266:"wiki-locale-sq-al",359323:"sharedCommentsLazy",359514:"onecamera-locale-lt",359518:"channels-locale-sl-si",359571:"webrec2-language-cs",359923:"components-screen-recorder14",360060:"channels-locale-hi-in",360532:"data-resolvers-presence",360695:"cypress-tests-only",360818:"virtualEvents-locale-fi-fi",360941:"platform-app-rail",361204:"meeting-bot-locale-lv-lv",361880:"meetingFlyout-locale-th-th",362376:"config-prod",362387:"sht-searchanswerteamsstrings_es-th",362437:"services-tenant-membership",363054:"cast-locale-es-es",363184:"hostUxStrings66",363627:"video-message-locale-pt-pt",363685:"services-broadcast-attendee",363857:"artifacts-platform-locale-ca-es-valencia",364091:"video-capture-locale-ar-sa",364588:"communities-locale-tr-tr",365631:"message-escalate-dialog-locale-ka-ge",365745:"discover-surface-locale-nl-nl",365748:"channels-locale-da-dk",366178:"aRes23",366263:"data-resolvers-fluid",366435:"meeting-analytics-locale-pl-pl",366833:"breakoutRooms-locale-zh-tw",366894:"meeting-analytics-locale-pt-pt",366962:"categories-ka-ge-json",367261:"video-message-locale-id-id",367374:"r_data-resolvers-external-accounts-response",367977:"meeting-options-locale-lv-lv",368688:"freemium-upgrade-locale-ro-ro",368781:"breakoutRooms-locale-he-il",369617:"copilot-ufd-control",369621:"webinar-locale-ar-sa",369658:"coach-report-locale-it-it",369990:"wiki-locale-pt-pt",370409:"sv-SE-UiStrings-json",370582:"otlang6",370881:"share-email-locale-tr-tr",370898:"message-escalate-dialog-locale-pl-pl",371040:"fns41",371401:"r_data-resolvers-ai-insights-feedback",371515:"guardians-locale-sk-sk",371761:"video-message-locale-uk-ua",371993:"meeting-options-locale-id-id",372136:"hostDefaultsStrings54",372349:"r_data-resolvers-app-suggestions",372371:"InformationProtectionStrings41",372487:"video-capture-locale-hi-in",372936:"hostDefaultsStrings47",373369:"components-broadcast-auto-rejoin-screen",373404:"ar-SA-comment-pane-strings-jsonOfficeOnlineStringResource",373795:"cast-locale-sl-si",373973:"mk-MK-comment-pane-strings-jsonOfficeOnlineStringResource",374135:"meeting-room-console-locale-sv-se",374424:"sht-searchanswerteamsstrings_es-nl",374736:"closed-captions-settings-panel",374750:"data-resolvers-ai-insights-feedback",374863:"hostUxStrings12",374917:"gallery-locale-ar-sa",374934:"hostUxStrings35",374972:"discover-surface-locale-kk-kz",375125:"aRes25",375519:"survey-locale-pl-pl",375558:"meeting-options-app",375616:"categories-or-in-json",376001:"teams-and-channels-locale-ca-es",376049:"services-payment",376211:"audience-view-dialog-locale-ja-jp",376445:"cortex-topics-bootstrapper-topics-sdk",376583:"audience-view-dialog-locale-es-es",376657:"cast-app",376803:"components-screen-recorder94",377149:"artifacts-platform-content-container",377159:"components-screen-recorder0",377294:"precompiled-web-worker",377459:"InformationProtectionStrings6",378066:"sht-searchanswerteamsstrings_es-pt",378092:"hostUxStrings85",378117:"InformationProtectionStrings49",378334:"meeting-options-locale-mk-mk",378456:"main-locale-kk-kz",378648:"meeting-collaboration-locale-pt-br",379033:"r_data-resolvers-global-mtma-user-data",379104:"cast-locale-ru-ru",379231:"smart-device-locale-vi-vn",379316:"calling-locale-fi-fi",379786:"sht-searchanswerteamsstrings_es-quz-pe",379959:"message-escalate-dialog-locale-he-il",380024:"lv-strings-jsonThinRes",380052:"chat-join-screen-share-button",380127:"share-email-locale-is-is",380282:"school-locale-sr-latn-rs",380293:"semantic-object-locale-fi-fi",380473:"meeting-options-locale-fi-fi",380947:"freemium-upgrade-locale-id-id",381205:"main-locale-lt-lt",381274:"r_data-resolvers-translation-settings",381293:"components-screen-recorder92",381637:"r_data-resolvers-browser-broadcast-attendee",381641:"calendar-scheduling-form-app",381916:"InformationProtectionStrings4",381974:"discover-surface-locale-nb-no",382415:"ro-RO-UiStrings-json",382506:"r_data-resolvers-browser-call-recording",382703:"teams-and-channels-locale-et-ee",382787:"aRes5",382874:"categories-vi-vn-json",382901:"meeting-room-console-locale-kk-kz",383028:"data-resolvers-update-client-state",383062:"main-locale-pl-pl",383219:"freemium-upgrade-locale-fil-ph",383748:"smart-device-locale-eu-es",383995:"r_data-resolvers-user-license",384037:"components-breakout-rooms-app",384100:"otlang88",384191:"help-locale-lt-lt",384517:"search-locale-id-id",384548:"components-screen-recorder8",384910:"eu-strings-jsonThinRes",384977:"services-store-devices",385299:"discover-surface-locale-zh-tw",385358:"messaging-locale-nn-no",385446:"data-resolvers-discover-surface",385470:"gallery-locale-nn-no",385565:"breakoutRooms-locale-ru-ru",385869:"semantic-object-locale-cs-cz",386032:"health-locale-az-latn-az",386347:"calling-locale-zh-tw",386657:"or-IN-UiStrings-json",386683:"virtualEvents-locale-id-id",386798:"files-locale-cy-gb",386886:"categories-cy-gb-json",388216:"people-targeting-locale-eu-es",388262:"message-escalate-dialog-locale-ru-ru",388339:"r_data-resolvers-browser-activity",388412:"otlang80",388628:"precompiled-editor-web-worker",388664:"guardians-locale-en-gb",388777:"freemium-upgrade-locale-sl-si",388787:"meeting-options-locale-gl-es",388951:"InformationProtectionStrings38",388997:"queues-locale-gl-es",389465:"sht-searchanswerteamsstrings_es-pl",389869:"audience-view-dialog-locale-pl-pl",389903:"guardians-locale-pl-pl",390387:"r_data-resolvers-address-autosuggest",390580:"breakoutRooms-locale-nl-nl",390684:"categories-cs-cz-json",390750:"discover-surface-lazy",390928:"main-locale-pt-br",391025:"calling-meeting-info-panel",391139:"meet-for-work-locale-zh-tw",391679:"gu-IN-UiStrings-json",391829:"meet-for-work-locale-az-latn-az",391838:"post-echo-bot-screen",391952:"components-meeting-artifacts",392278:"gallery-locale-pt-pt",392313:"hr-HR-UiStrings-json",392796:"meet-for-work-locale-da-dk",392907:"communities-locale-lv-lv",392968:"queues-locale-fr-ca",393007:"files-locale-ka-ge",393202:"meeting-room-console-locale-pl-pl",393258:"webrec2-language-ar",393446:"meetingFlyout-locale-tr-tr",393597:"discover-surface-locale-sq-al",393735:"discover-surface-l2-back",393786:"video-capture-locale-eu-es",394125:"onecamera-locale-es",394253:"files-locale-sq-al",394259:"share-email-locale-ka-ge",394476:"guardians-locale-cy-gb",394548:"categories-mk-mk-json",394601:"call-transcript-panel",394761:"nl-NL-UiStrings-json",395834:"sht-searchanswerteamsstrings_es-fi",395939:"health-locale-ro-ro",396079:"calling-locale-ca-es",396211:"meeting-collaboration-locale-hu-hu",396351:"help-locale-pt-br",396362:"recurrence-locale-ar-sa",396435:"health-locale-ko-kr",396624:"calling-locale-ar-sa",396848:"cast-locale-lt-lt",396917:"components-calling-end-upsell-screen",397265:"InformationProtectionStrings40",397323:"data-resolvers-gallery",397423:"fluid-paste-container",397523:"data-resolvers-community-settings",397579:"help-locale-zh-tw",397782:"meeting-options-locale-eu-es",397822:"meeting-recap-locale-et-ee",398487:"lb-LU-comment-pane-strings-jsonOfficeOnlineStringResource",398635:"coach-report-locale-pt-pt",398750:"cast-locale-vi-vn",398842:"search-locale-cy-gb",399017:"otlang19",399442:"meeting-bot-locale-mk-mk",399617:"teams-and-channels-locale-nb-no",399808:"sht-cortextopictypeswebstrings_no",399837:"th-TH-UiStrings-json",400162:"InformationProtectionStrings48",400200:"InformationProtectionStrings3",400287:"queues-locale-ca-es",400880:"sht-searchanswerteamsstrings_es-ms",400912:"otlang18",401199:"share-email-locale-el-gr",401351:"fns63",401421:"onecamera-locale-ms",401983:"main-locale-it-it",402525:"recurrence-locale-en-us",403034:"teams-and-channels-locale-sq-al",403275:"transcript-content-app",403461:"calendar-locale-zh-tw",403528:"otlang10",403626:"esp-locale-ca-es",403779:"meetingFlyout-locale-pt-pt",403817:"broadcast-locale-id-id",403979:"people-targeting-locale-uk-ua",404177:"components-screen-recorder84",404224:"help-locale-he-il",404904:"semantic-object-locale-es-es",405151:"r_data-resolvers-smb-user-intent",405589:"meetingFlyout-locale-it-it",405667:"hostDefaultsStrings29",405750:"calling-locale-vi-vn",405851:"hostDefaultsStrings25",405913:"discover-surface-locale-hu-hu",406294:"freemium-upgrade-locale-nb-no",406472:"messaging-locale-fi-fi",406746:"InformationProtectionStrings63",407560:"data-resolvers-unified-consent",407598:"data-resolvers-search-suggestions",407783:"broadcast-locale-ja-jp",407949:"health-locale-en-gb",408376:"sht-teams-topicanswerchunk",408535:"hostUxStrings78",408584:"growth-locale-it-it",408632:"artifacts-platform-locale-ru-ru",408819:"hostDefaultsStrings21",409082:"extensibility-locale-mk-mk",409162:"video-message-locale-ro-ro",409823:"wiki-locale-es-mx",410047:"artifacts-platform-locale-he-il",410166:"school-locale-en-us",410229:"hostDefaultsStrings43",410412:"broadcast-locale-ar-sa",410812:"data-resolvers-ai-insights-sds",411048:"onecamera-locale-ru",411158:"video-capture-locale-zh-cn",411382:"LPPLazy",412136:"data-resolvers-address-autosuggest",412281:"r_data-resolvers-browser-ddv",412850:"fns80",413199:"meeting-recap-locale-hi-in",413680:"meeting-options-locale-pt-br",413768:"discover-surface-locale-fr-ca",414712:"broadcast-locale-nn-no",415064:"aRes51",415331:"sht-searchanswerteamsstrings_es-is",415340:"lazy-ppt-loader",415806:"fns81",415953:"sht-cortextopictypeswebstrings_is",415999:"recurrence-locale-nl-nl",416211:"main-locale-fi-fi",416347:"calling-meeting-details-panel",416523:"sht-searchanswerteamsstrings_es-sq",416682:"virtualEvents-locale-lv-lv",416791:"freemium-upgrade-locale-pt-pt",416918:"teams-and-channels-locale-uk-ua",417220:"fns28",417253:"calendar-locale-eu-es",417274:"video-capture-locale-da-dk",417298:"hostDefaultsStrings41",417341:"services-io-apps-monet",417418:"recurrence-locale-ro-ro",417502:"da-DK-comment-pane-strings-jsonOfficeOnlineStringResource",417564:"communities-locale-nl-nl",417589:"meeting-options-locale-ca-es",417902:"data-resolvers-teams-meeting-policies",417957:"otlang2",418035:"meeting-lock-back-image",418143:"meeting-room-console-locale-zh-cn",418185:"meet-for-work-locale-es-mx",418642:"onecamera-locale-kk",418699:"r_data-resolvers-augloop",419161:"services-search-substrate",419163:"meet-for-work-locale-sq-al",419318:"data-resolvers-whats-new",419493:"school-locale-ro-ro",419562:"audience-view-dialog-locale-bg-bg",419939:"r_data-resolvers-channels",419979:"communities-locale-mk-mk",420158:"broadcast-locale-nl-nl",420443:"people-targeting-locale-en-us",420862:"uz-Latn-UZ-comment-pane-strings-jsonOfficeOnlineStringResource",420957:"broadcast-locale-et-ee",421174:"services-esp",421311:"breakoutRooms-locale-kk-kz",421555:"smart-device-locale-es-mx",421632:"messaging-locale-az-latn-az",422312:"broadcast-locale-nb-no",422410:"discover-surface-locale-th-th",422452:"InformationProtectionStrings51",422616:"data-resolvers-people-avatar",422765:"deferredoperations",422928:"meetingFlyout-locale-fil-ph",422991:"smart-device-locale-th-th",423017:"onecamera-locale-fi",423402:"esp-locale-is-is",423516:"messaging-locale-ka-ge",423540:"channels-locale-sk-sk",423859:"audience-view-dialog-locale-es-mx",423912:"AudioFilesUpload",424333:"sht-searchanswerteamsstrings_es-be-by",424444:"teams-and-channels-locale-cy-gb",424665:"recurrence-locale-tr-tr",424677:"people-targeting-locale-az-latn-az",424791:"communities-locale-fil-ph",425026:"channels-locale-lv-lv",425067:"calendar-meeting-recommendations",425270:"data-resolvers-store",425570:"breakoutRooms-locale-hr-hr",425901:"InformationProtectionStrings64",426443:"InformationProtectionStrings76",426447:"teams-and-channels-locale-ro-ro",427078:"data-resolvers-device",427269:"recurrence-locale-hu-hu",427521:"search-locale-zh-tw",427573:"config-ag08",427903:"queues-locale-az-latn-az",428256:"meeting-options-locale-ka-ge",428296:"staging-room-dialog",428394:"sht-searchanswerteamsstrings_es-uz",428433:"discover-surface-locale-en-us",428488:"webinar-locale-bg-bg",428497:"hostUxStrings79",428508:"pstn-dialog-manager",428767:"sht-cortextopictypeswebstrings_lv",429083:"growth-locale-sr-latn-rs",429453:"artifacts-platform-locale-pl-pl",429636:"r_data-resolvers-browser-floodgate",430174:"hostDefaultsStrings35",430195:"help-locale-uk-ua",430242:"teams-and-channels-locale-pt-br",430817:"pluginAboutVideo",430864:"channels-locale-ja-jp",431044:"es-mx-strings-jsonThinRes",431245:"video-message-locale-is-is",431304:"virtualEvents-locale-sv-se",432106:"gallery-locale-de-de",432412:"r_data-resolvers-m365-links",432673:"meeting-recap-locale-zh-cn",432719:"webinar-locale-ka-ge",433105:"webinar-locale-en-gb",433112:"health-locale-zh-cn",433282:"sht-searchanswerteamsstrings_es-bs-latn-ba",433418:"video-capture-locale-pl-pl",433454:"webinar-locale-es-mx",433580:"calendar-locale-en-gb",433754:"video-capture-locale-id-id",433829:"oneTranscriptSettings",434e3:"hostDefaultsStrings0",434055:"messaging-locale-fil-ph",434249:"meeting-room-entry",434258:"es-MX-comment-pane-strings-jsonOfficeOnlineStringResource",434287:"survey-locale-ar-sa",434518:"categories-pl-pl-json",434526:"school-locale-ka-ge",434626:"health-locale-ca-es-valencia",434692:"share-email-locale-he-il",434871:"hostDefaultsStrings64",435110:"survey-locale-ja-jp",435364:"InformationProtectionStrings39",435392:"biometric-enrollment-locale-tr-tr",435588:"calling-locale-sl-si",435805:"calendar-compose-box-v2",436009:"components-screen-recorder16",436058:"InformationProtectionStrings31",436794:"messaging-locale-mk-mk",436856:"esp-locale-da-dk",437209:"hostUxStrings77",437425:"InformationProtectionStrings17",437762:"messaging-locale-sk-sk",438257:"ga-IE-comment-pane-strings-jsonOfficeOnlineStringResource",438685:"survey-locale-sk-sk",438860:"webrec2-language-uk",439036:"search-locale-nl-nl",439151:"r_data-resolvers-connected-calendar",439370:"share-email-locale-en-gb",439613:"services-io-browser-consent-state",439845:"messaging-locale-ko-kr",440553:"meeting-options-locale-es-mx",440824:"people-targeting-locale-cs-cz",440857:"zh-TW-UiStrings-json",441032:"meeting-bot-locale-de-de",441188:"files-locale-ru-ru",441734:"meeting-collaboration-locale-zh-cn",442065:"breakoutRooms-locale-pt-pt",442493:"smart-device-locale-it-it",442501:"header-graphql-search-box-utils",442558:"calling-locale-uk-ua",443436:"meeting-recap-locale-fr-fr",443750:"virtualEvents-locale-fil-ph",444465:"people-targeting-locale-de-de",444585:"breakoutRooms-locale-hi-in",444999:"te-IN-comment-pane-strings-jsonOfficeOnlineStringResource",445005:"school-locale-vi-vn",445084:"video-message-locale-hu-hu",445170:"zh-cn-strings-jsonThinRes",445270:"people-targeting-locale-sv-se",445620:"categories-ps-af-json",446118:"otlang37",446402:"share-email-locale-es-mx",446631:"audience-view-dialog-locale-is-is",446848:"components-screen-recorder96",448025:"InformationProtectionStrings32",448226:"webinar-locale-nb-no",448557:"message-extension-flyout-popup-container",449744:"audience-view-dialog-locale-he-il",449808:"files-locale-ca-es-valencia",449902:"fns54",450067:"hostDefaultsStrings26",450084:"fns82",450157:"es-MX-UiStrings-json",450890:"meeting-bot-locale-ru-ru",450912:"InformationProtectionStrings55",451060:"InformationProtectionStrings59",451254:"sht-searchanswerteamsstrings_es-el",451540:"r_data-resolvers-invite-links",451796:"fns33",451822:"main-locale-az-latn-az",452425:"audience-view-dialog-locale-ka-ge",452574:"onecamera-locale-eu",452579:"categories-ky-kg-json",452713:"components-screen-recorder86",453077:"freemium-upgrade-locale-pt-br",453120:"message-escalate-dialog-locale-bg-bg",453196:"virtualEvents-locale-he-il",453356:"health-locale-cs-cz",453592:"components-calendar-agenda-view-embed",453793:"help-locale-it-it",454067:"teams-and-channels-locale-fr-fr",454069:"extensibility-locale-en-us",454165:"services-people-targeting",454270:"broadcast-locale-kk-kz",454281:"nb-strings-jsonThinRes",454730:"hostDefaultsStrings50",454835:"webrec2-language-el",455143:"components-file-sharing-dialog",455555:"sht-searchanswerteamsstrings_es-lb-lu",455627:"components-screen-recorder60",456045:"help-locale-tr-tr",456809:"onecamera-locale-et",456904:"search-app",456970:"InformationProtectionStrings53",457375:"data-resolvers-favorite-user",457699:"calling-locale-es-mx",457964:"onecamera-locale-es-mx",458276:"recurrence-locale-es-es",458392:"people-targeting-locale-sl-si",458485:"school-locale-mk-mk",458771:"services-community-settings",458820:"onecamera-locale-el",458966:"r_data-resolvers-toast",459096:"communities-modal",459166:"meeting-options-locale-cs-cz",459982:"esp-locale-cy-gb",460041:"bn-IN-UiStrings-json",460726:"help-locale-is-is",460767:"webinar-locale-nn-no",460893:"r_data-resolvers-mention",461045:"webrec2-language-fil-ph",461118:"hostDefaultsStrings58",461203:"InformationProtectionStrings35",461215:"meeting-collaboration-locale-az-latn-az",461300:"meet-for-work-locale-el-gr",461336:"artifacts-platform-locale-ca-es",461409:"categories-hi-in-json",461518:"meeting-room-console-locale-ar-sa",461627:"data-resolvers-contacts-sync-banner",461803:"video-capture-locale-az-latn-az",462030:"teams-and-channels-app",462115:"InformationProtectionStrings60",462315:"InformationProtectionStrings68",462478:"data-resolvers-meeting-intelligence",462939:"hostDefaultsStrings37",463054:"calendar-locale-nb-no",463402:"hostUxStrings57",463473:"services-smb-user-intent",463616:"files-locale-el-gr",463686:"share-form-email-entry",464189:"sht-searchanswerteamsstrings_es-hr",464880:"meet-for-work-locale-en-us",465486:"call-health-panel",465677:"hostDefaultsStrings77",465844:"share-email-locale-it-it",466204:"data-resolvers-contacts-sync",466476:"sht-cortextopictypeswebstrings_en-gb",466887:"discover-surface-locale-is-is",466953:"survey-locale-el-gr",467450:"meetingFlyout-locale-ja-jp",467608:"artifacts-platform-locale-es-es",467764:"r_data-resolvers-dynamics-marketing",467767:"data-resolvers-distribution-list",467785:"data-resolvers-team-settings",467997:"meetingFlyout-locale-az-latn-az",468304:"main-locale-et-ee",468318:"shareCallout",468341:"hostUxStrings51",468472:"webinar-locale-pl-pl",468557:"broadcast-app",468621:"growth-locale-sv-se",468677:"hostUxStrings59",468734:"calendar-locale-de-de",468771:"otlang22",468880:"hostUxStrings55",469081:"services-external-accounts",469120:"webinar-locale-sq-al",469338:"biometric-enrollment-locale-hi-in",469375:"otlang108",469482:"meeting-analytics-locale-az-latn-az",469894:"meeting-bot-locale-nb-no",470175:"guardians-locale-sv-se",470182:"meetingFlyout-locale-cs-cz",470225:"data-resolvers-shell",470676:"discover-surface-locale-hr-hr",471136:"sht-cortextopictypeswebstrings_en-us",471154:"coach-report-app",471451:"quz-PE-comment-pane-strings-jsonOfficeOnlineStringResource",471482:"meetingFlyout-locale-sl-si",471678:"semantic-object-locale-hr-hr",471726:"video-message",471782:"otlang0",471816:"wiki-locale-kk-kz",471920:"biometric-enrollment-locale-fil-ph",473432:"video-capture-locale-sv-se",473442:"otlang8",473676:"data-resolvers-user",473985:"virtualEvents-locale-zh-cn",474515:"calling-locale-ko-kr",474833:"onecamera-locale-bs",475086:"meet-for-work-locale-hr-hr",475707:"otSearchFeedbackButton",475758:"msteams/components-hosted-web-content",476023:"data-resolvers-browser-tpn",476293:"search-locale-it-it",476476:"webrec2-language-nl",476547:"discover-surface-locale-en-gb",476843:"onecamera-locale-bg",476896:"fns78",477078:"hostDefaultsStrings30",477209:"services-chat",477661:"calendar-locale-cy-gb",477697:"data-resolvers-browser-payment",477747:"people-targeting-locale-sr-latn-rs",478001:"data-resolvers-search-substrate",478053:"services-search-prefetch",478432:"meeting-recap-locale-en-gb",478526:"video-capture-locale-ca-es-valencia",478746:"search-locale-fi-fi",478755:"webinar-locale-da-dk",478778:"virtualEvents-locale-ko-kr",479010:"search-locale-ro-ro",479071:"data-resolvers-artifacts-platform",479130:"smart-device-locale-ru-ru",480041:"compose-box-v1-renderer",480253:"search-locale-fr-ca",480809:"onecamera-locale-nl",480859:"smart-device-modal",481166:"meeting-collaboration-locale-ca-es",481505:"queues-locale-it-it",481516:"webinar-locale-de-de",481550:"coach-report-locale-hr-hr",481565:"breakoutRooms-locale-sr-latn-rs",481647:"chat-app",481683:"school-locale-sv-se",481694:"data-resolvers-third-party-calendar",481897:"meeting-analytics-locale-eu-es",481933:"teams-and-channels-locale-it-it",482080:"meeting-room-console-locale-sl-si",482098:"calling-locale-nl-nl",482230:"wiki-locale-hi-in",482722:"messaging-locale-es-es",482991:"data-resolvers-channels",483107:"calendar-locale-ro-ro",483240:"main-locale-ca-es",483423:"cast-locale-nl-nl",483650:"data-resolvers-cross-tenant-policies",484671:"ja-JP-UiStrings-json",484713:"audience-view-dialog-locale-it-it",484787:"channels-locale-he-il",484964:"communities-locale-is-is",485197:"hu-HU-UiStrings-json",485491:"r_data-resolvers-teams",486007:"meetingFlyout-locale-sk-sk",486146:"cast-locale-fil-ph",486194:"meetingFlyout-locale-nn-no",486855:"guardians-locale-ca-es-valencia",487034:"wiki-locale-fr-fr",487142:"communities-locale-pt-br",487310:"calendar-locale-ka-ge",487598:"files-locale-hi-in",488029:"video-capture-locale-es-mx",488338:"custom-audience-view-backgrounds-dialog",488458:"calendar-locale-uk-ua",488729:"components-screen-recorder98",489109:"main-locale-hr-hr",489589:"categories-ta-in-json",489931:"otlang84",490842:"meeting-recap-locale-lv-lv",491029:"data-resolvers-browser-meeting-artifacts",491036:"teams-search-prefetch-configs",491773:"sht-searchanswerteamsstrings_es-es",492102:"freemium-upgrade-locale-tr-tr",492444:"teams-and-channels-locale-lt-lt",492521:"semantic-object-locale-el-gr",493121:"meeting-room-console-locale-zh-tw",493235:"meeting-collaboration-locale-sv-se",493352:"topics-sdk-km-api",493902:"data-resolvers-privacy-settings",494101:"agenda-page-app",494217:"sht-cortextopictypeswebstrings_or",494810:"fns35",494973:"discover-surface-locale-eu-es",495049:"categories-it-it-json",495447:"health-locale-mk-mk",495830:"channels-locale-el-gr",496106:"auth_v2",496334:"share-email-locale-ru-ru",496488:"sht-searchanswerteamsstrings_es-no",496656:"components-screen-recorder4",496968:"health-locale-vi-vn",497130:"store-app",497507:"calling-locale-de-de",497979:"hostDefaultsStrings38",498261:"meeting-analytics-locale-he-il",498436:"meetingFlyout-locale-ka-ge",498846:"vi-VN-UiStrings-json",498977:"growth-locale-fi-fi",499112:"audience-view-dialog-locale-zh-tw",499182:"extensibility-locale-lt-lt",499240:"hostUxStrings49",499563:"meeting-bot-locale-et-ee",499648:"search-locale-ca-es",500140:"meeting-options-locale-es-es",500385:"extensibility-locale-ar-sa",500397:"guardians-locale-vi-vn",500637:"calling-locale-fr-fr",500658:"meeting-room-console-locale-nl-nl",500772:"survey-locale-ko-kr",500906:"share-email-locale-ca-es-valencia",500923:"services-distribution-list",500987:"gallery-locale-lv-lv",501129:"services-substrate-recommendations",501131:"en-gb-strings-jsonThinRes",501375:"hostDefaultsStrings63",501498:"school-locale-pl-pl",501612:"webinar-locale-sr-latn-rs",501924:"esp-locale-nl-nl",501990:"queues-locale-nn-no",502027:"communities-locale-zh-cn",502147:"communities-locale-ca-es",502219:"ariawrapper",502376:"people-targeting-locale-ko-kr",503013:"components-calling-retry-screen",503266:"video-message-locale-da-dk",503292:"teams-and-channels-locale-de-de",503743:"fil-ph-strings-jsonThinRes",503908:"hostDefaultsStrings67",503940:"biometric-enrollment-locale-ru-ru",503966:"semantic-object-locale-da-dk",504299:"guardians-locale-nn-no",504317:"semantic-object-locale-ar-sa",504411:"biometric-enrollment-locale-ka-ge",504484:"video-capture-locale-cy-gb",504631:"sht-searchanswerteamsstrings_es-af",504703:"categories-da-dk-json",504759:"queues-locale-hu-hu",504818:"meeting-room-console-locale-cs-cz",504858:"coach-report-locale-fr-fr",504881:"smart-device-locale-da-dk",505213:"coach-report-locale-ka-ge",505338:"r_data-resolvers-compose-language",505599:"messaging-locale-ca-es",505954:"meeting-analytics-locale-gl-es",506020:"data-resolvers-calling",506063:"meeting-options-locale-nl-nl",506312:"sht-searchanswerteamsstrings_es-en-us",506552:"meeting-analytics-locale-is-is",506693:"data-client-calling",506841:"message-escalate-dialog-locale-eu-es",506886:"sht-searchanswerteamsstrings_es-hu",507004:"meeting-analytics-locale-da-dk",507413:"webrec2-language-ga-ie",507469:"r_data-resolvers-system-settings",507518:"aRes57",508025:"categories-he-il-json",508058:"coach-report-locale-el-gr",508124:"messaging-locale-id-id",508743:"ug-CN-comment-pane-strings-jsonOfficeOnlineStringResource",508751:"ml-IN-UiStrings-json",508954:"guardians-locale-zh-tw",509228:"r_data-resolvers-presence",509352:"fns40",509902:"virtualEvents-locale-pt-pt",510104:"data-resolvers-browser-live-stream-rendering",510318:"sht-searchanswerteamsstrings_es-uk",510784:"cast-locale-hi-in",511096:"communities-guidelines-dialog",511141:"sht-cortextopictypeswebstrings_tt",511290:"breakoutRooms-locale-fr-fr",511645:"smart-device-locale-et-ee",511908:"guardians-locale-lv-lv",512097:"categories-sv-se-json",512159:"services-style-my-room",512764:"otlang7",512767:"data-resolvers-compose-language",513478:"webinar-locale-ca-es-valencia",513640:"communities-locale-ca-es-valencia",513901:"r_data-resolvers-browser-tpn",513968:"guardians-locale-ro-ro",514027:"r_data-resolvers-browser-mention",514302:"virtualEvents-locale-sl-si",514354:"message-escalate-dialog-locale-it-it",514381:"cast-locale-ka-ge",514456:"freemium-upgrade-locale-cs-cz",514512:"meet-for-work-locale-pt-br",514533:"people-targeting-locale-da-dk",514621:"room-remote",514727:"share-email-locale-lt-lt",515061:"sht-searchanswerteamsstrings_es-he",515450:"hostDefaultsStrings52",516095:"hostUxStrings42",516312:"smart-device-locale-sl-si",516703:"meet-for-work-locale-eu-es",517097:"data-resolvers-azure-maps",517107:"summaryModule",517124:"school-locale-tr-tr",517428:"meeting-room-console-locale-pt-pt",517475:"files-locale-ja-jp",517495:"onecamera-locale-sr-cyrl-rs",517583:"sht-cortextopictypeswebstrings_nl",517965:"services-instant-answers",517968:"extensibility-locale-fi-fi",518168:"notesComponentUx",518254:"hostDefaultsStrings56",518404:"meeting-bot-locale-sk-sk",518639:"connected-calendar-app",518809:"meeting-bot-locale-uk-ua",519078:"survey-locale-zh-tw",519109:"smart-device-locale-de-de",519135:"teams-and-channels-locale-fr-ca",519319:"emoji-one-service",519853:"fns73",520320:"r_data-resolvers-search-contextual",520351:"share-email-locale-fil-ph",520401:"message-escalate-dialog-locale-hi-in",520499:"otlang32",520741:"gallery-locale-uk-ua",520764:"InformationProtectionStrings25",520873:"sr-cyrl-rs-strings-jsonThinRes",520930:"gum-modal",520945:"health-locale-sl-si",521112:"hostUxStrings25",521529:"components-screen-recorder88",521705:"extensibility-locale-ca-es",522540:"pt-BR-comment-pane-strings-jsonOfficeOnlineStringResource",522580:"axessible-module",522764:"onecamera-locale-cy",522857:"fns61",523041:"meet-for-work-locale-et-ee",523046:"breakoutRooms-locale-hu-hu",523190:"main-locale-nn-no",523655:"freemium-upgrade-locale-eu-es",523747:"fns2",523890:"hostUxStrings17",524090:"help-app",524177:"r_data-resolvers-search-suggestions",524179:"messaging-locale-cy-gb",524282:"sht-cortextopictypeswebstrings_lo-la",524364:"audience-view-dialog-locale-nb-no",524489:"hostDefaultsStrings14",524944:"meetingFlyout-locale-sq-al",525110:"broadcast-locale-vi-vn",525145:"fluid-debugger",525575:"fns37",525938:"aRes35",526124:"data-resolvers-browser-webinar",526811:"smart-device-locale-ko-kr",526822:"files-locale-es-mx",526917:"wiki-locale-hr-hr",527246:"message-escalate-dialog-locale-zh-cn",527639:"people-targeting-locale-ca-es",527782:"wiki-locale-cy-gb",528186:"sht-cortextopictypeswebstrings_fi",528224:"components-screen-recorder48",528749:"meeting-collaboration-locale-ar-sa",528952:"communities-locale-en-gb",529188:"ka-strings-jsonThinRes",529401:"people-targeting-locale-lt-lt",529477:"cast-locale-el-gr",529497:"extensibility-locale-ko-kr",529709:"config-ag09",529735:"uiManager",530174:"r_data-resolvers-biometric-enrollment",530321:"sht-cortextopictypeswebstrings_quz-pe",530420:"video-message-locale-sr-latn-rs",530702:"hostUxStrings0",530977:"meeting-recap-locale-tr-tr",531354:"channels-locale-tr-tr",531521:"components-teams-and-channels-entry",531908:"esp-locale-gl-es",532528:"codemirror",532647:"is-IS-comment-pane-strings-jsonOfficeOnlineStringResource",533199:"meetingFlyout-locale-es-es",533485:"channels-locale-nn-no",533884:"biometric-enrollment-locale-da-dk",534179:"esp-locale-fr-fr",534250:"biometric-enrollment-locale-uk-ua",534279:"people-targeting-locale-nb-no",534548:"extensibility-locale-sl-si",534653:"data-resolvers-callable-channel",534918:"virtualEvents-locale-ar-sa",535108:"pluginOT",535132:"onecamera-locale-nn-no",535376:"message-escalate-dialog-locale-es-mx",535587:"aRes31",535731:"breakoutRooms-locale-lv-lv",535964:"discover-surface-locale-de-de",536133:"otlang23",536217:"calling-broadcast-container",536227:"broadcast-locale-hi-in",536345:"r_data-resolvers-transcript",536397:"main-locale-de-de",536416:"video-capture-locale-uk-ua",536714:"fns74",536821:"meeting-options-locale-en-gb",537446:"biometric-enrollment-locale-pt-br",537481:"components-screen-recorder34",537559:"onecamera-locale-fil",537965:"esp-locale-th-th",538001:"discover-surface-locale-ko-kr",538430:"sv-SE-comment-pane-strings-jsonOfficeOnlineStringResource",538431:"services-suggestions",538542:"pluginChat",538552:"recurrence-locale-fr-fr",538576:"hostDefaultsStrings74",538783:"components-screen-recorder12",538883:"es-strings-jsonThinRes",538988:"components-calling-park-screen",539098:"flipcamera",539308:"survey-locale-mk-mk",539706:"data-resolvers-tfl-meeting-links",539829:"r_data-resolvers-os-file-share",539862:"growth-locale-ca-es",539872:"onecamera-locale-sq",539974:"recurrence-locale-sl-si",540150:"messaging-locale-sl-si",540355:"hostDefaultsStrings13",540826:"components-screen-recorder104",540866:"breakoutRooms-locale-th-th",541071:"hostUxStrings63",541309:"channels-locale-en-us",541707:"message-escalate-dialog-locale-pt-br",541895:"fns38",542061:"hostDefaultsStrings2",542282:"extensibility-locale-fil-ph",542371:"itemsview-deferredactions",542944:"meeting-options-locale-tr-tr",542985:"biometric-enrollment-locale-cs-cz",543347:"webrec2-language-is",543458:"search-lazy-chunk",543927:"smart-device-locale-zh-tw",544208:"sht-cortextopictypeswebstrings_sr-cyrl-ba",544462:"data-resolvers-search-prefetch",544481:"CommentPluginComponent",544570:"calling-locale-es-es",544696:"cast-locale-sk-sk",544949:"ams-video-player",545130:"fns21",545321:"teams-and-channels-locale-da-dk",545730:"meeting-analytics-locale-ru-ru",545965:"guardians-locale-id-id",546149:"extensibility-locale-ca-es-valencia",546310:"data-resolvers-browser-call-recording",546453:"sht-searchanswerteamsstrings_es-si-lk",546584:"esp-locale-vi-vn",546639:"fns29",546713:"gallery-locale-fr-ca",546823:"otlang62",546921:"add-thread-member-dialog",547140:"semantic-object-locale-sq-al",547296:"message-escalate-dialog-locale-ko-kr",547331:"meeting-analytics-locale-es-mx",547540:"InformationProtectionStrings42",547869:"meet-for-work-locale-vi-vn",548283:"wiki-locale-fil-ph",548715:"r_data-resolvers-channel-messages",548906:"virtualEvents-locale-en-us",549087:"message-escalate-dialog-locale-sv-se",549333:"files-locale-de-de",549782:"webrec2-language-sk",549784:"meeting-room-front-of-room-home",550099:"meeting-collaboration-locale-el-gr",550142:"sht-searchanswerteamsstrings_es-id",550547:"ms-MY-comment-pane-strings-jsonOfficeOnlineStringResource",550946:"meeting-room-console-locale-en-gb",551011:"sht-searchanswerteamsstrings_es-sv",551052:"coach-report-locale-az-latn-az",551072:"navigationPanelShimmer",551312:"smart-device-locale-fr-ca",551792:"services-webinar",552241:"sht-searchanswerteamsstrings_es-tt",552534:"calling-locale-pt-pt",552857:"otlang78",552876:"guardians-locale-da-dk",553069:"meeting-analytics-locale-es-es",553277:"guardians-locale-mk-mk",553460:"biometric-enrollment-locale-pt-pt",553802:"artifacts-platform-locale-fr-fr",553829:"smart-device-locale-nl-nl",553909:"meetingFlyout-locale-gl-es",553990:"help-locale-ko-kr",554018:"webrec2-language-sr-cyrl-rs",554223:"gallery-locale-ko-kr",554556:"aRes7",554572:"onecamera-locale-hu",555204:"survey-locale-de-de",555253:"r_data-schema",555549:"InformationProtectionStrings23",555919:"data-resolvers-user-preferences",555989:"data-resolvers-mesh-audio",556046:"en-GB-comment-pane-strings-jsonOfficeOnlineStringResource",556272:"sht-cortextopictypeswebstrings_fa",556923:"discover-surface-locale-vi-vn",557787:"coach-report-locale-pl-pl",558035:"gallery-locale-fr-fr",558146:"ko-KR-comment-pane-strings-jsonOfficeOnlineStringResource",558444:"search-locale-lv-lv",558582:"r_data-resolvers-browser-ams",559067:"platform-app",559401:"meeting-options-locale-sl-si",559508:"fns22",559667:"freemium-upgrade-locale-lt-lt",559706:"help-locale-et-ee",559752:"people-targeting-locale-el-gr",560382:"otlang94",560667:"health-locale-sk-sk",560811:"team-dashboard",561031:"freemium-upgrade-locale-bg-bg",561167:"topics-sdk-aria-sdk",562050:"biometric-enrollment-locale-de-de",562066:"smart-device-locale-ja-jp",562293:"qps-ploc-comment-pane-strings-jsonOfficeOnlineStringResource",562472:"breakoutRooms-locale-eu-es",562929:"meeting-recap-locale-th-th",562985:"messaging-locale-he-il",563017:"meeting-room-console-locale-de-de",563337:"aRes3",563408:"cast-locale-ar-sa",563950:"freemium-upgrade-locale-en-us",564145:"hostDefaultsStrings85",564270:"extensibility-locale-eu-es",564878:"calendar-locale-lt-lt",565110:"extensibility-locale-et-ee",565306:"team-settings",565477:"breakoutRooms-locale-ca-es-valencia",565656:"shareDialog",565748:"sht-cortextopictypeswebstrings_tk-tm",566152:"messaging-locale-uk-ua",566467:"recurrence-locale-hr-hr",566493:"data-resolvers-browser-activity",566525:"search-locale-nn-no",566693:"meetingFlyout-locale-hu-hu",566896:"fns31",567017:"health-locale-fil-ph",567103:"gallery-locale-zh-tw",567856:"am-ET-UiStrings-json",567883:"breakoutRooms-locale-fil-ph",568481:"r_data-resolvers-contacts-sync-settings",568740:"calls-main-app",568770:"r_data-resolvers-manage-tenant",568810:"mt-MT-comment-pane-strings-jsonOfficeOnlineStringResource",568847:"help-locale-fr-fr",569109:"freemium-upgrade-locale-et-ee",569545:"main-locale-vi-vn",569790:"video-message-locale-tr-tr",570152:"virtualEvents-locale-nb-no",570181:"meeting-bot-locale-ca-es",570266:"fns77",570500:"aRes56",570822:"en-GB-UiStrings-json",570872:"hostDefaultsStrings17",571383:"otlang106",571805:"otlang15",572324:"calendar-locale-az-latn-az",573051:"survey-locale-nl-nl",573067:"help-locale-ru-ru",573801:"meeting-collaboration-locale-sl-si",574091:"calling-app-post-critical",574322:"channels-locale-nb-no",574329:"queues-locale-pt-br",574516:"mo-people-selection",574783:"meetingFlyout-locale-he-il",574853:"share-email-locale-ar-sa",575238:"health-locale-nl-nl",575363:"biometric-enrollment-locale-ar-sa",576118:"guardians-locale-tr-tr",576807:"recurrence-locale-uk-ua",577122:"artifacts-platform-locale-ka-ge",577550:"bn-BD-comment-pane-strings-jsonOfficeOnlineStringResource",577808:"aRes2",578195:"components-calling-paywall-end-screen",578609:"share-email-locale-hu-hu",578634:"growth-locale-sl-si",578857:"discover-surface-locale-it-it",579088:"cast-locale-fi-fi",579197:"services-external-calendar-email-address",579880:"video-capture-locale-cs-cz",579947:"queues-locale-zh-cn",579984:"artifacts-platform-locale-lv-lv",580016:"search-locale-az-latn-az",580093:"meeting-room-console-locale-fi-fi",580317:"help-locale-th-th",580540:"meeting-room-console-locale-nb-no",580570:"meet-for-work-locale-it-it",580584:"fns48",580648:"people-targeting-locale-en-gb",580907:"InformationProtectionStrings66",581148:"deferred",581159:"r_data-resolvers-transcript-settings-store",581249:"webinar-locale-fil-ph",581682:"otlang82",581706:"calling-locale-is-is",581783:"share-email-locale-zh-tw",581933:"otlang4",582271:"react-diagnostics",582290:"broadcast-producer-screen",582366:"message-escalate-dialog-locale-is-is",582418:"school-locale-id-id",582439:"coach-report-locale-sk-sk",583005:"artifacts-platform-locale-en-us",583059:"gallery-locale-id-id",583110:"files-locale-sv-se",583194:"core-services-cdl-worker-debug",583320:"r_data-resolvers-view-schema",583438:"channels-locale-kk-kz",583527:"video-message-locale-fr-ca",583607:"de-strings-jsonThinRes",584197:"guardians-locale-ka-ge",584539:"onecamera-locale-he",584836:"calendar-locale-zh-cn",584885:"school-locale-sk-sk",585077:"services-io-browser-calling-video-rendering",585108:"services-app-based-link",585819:"webrec2-language-fr",585843:"school-locale-fi-fi",586060:"data-resolvers-search",586090:"data-resolvers-example",586395:"hostUxStrings22",586509:"sht-teams-externalanswers",586754:"discover-surface-locale-sl-si",586989:"otlang70",587150:"virtualEvents-locale-de-de",587384:"webrec2-language-et",587574:"coach-report-locale-sl-si",587793:"ca-ES-UiStrings-json",587846:"health-locale-es-mx",588026:"calling-cdl",588243:"growth-locale-ka-ge",588314:"data-resolvers-browser-chat",588531:"semantic-object-locale-ko-kr",588890:"meet-for-work-locale-fr-fr",588891:"InformationProtectionStrings27",588919:"platform-modal",589010:"de-DE-comment-pane-strings-jsonOfficeOnlineStringResource",589015:"help-locale-ro-ro",589167:"people-targeting-locale-hr-hr",589544:"messaging-locale-hr-hr",589814:"communities-locale-el-gr",590049:"meeting-collaboration-locale-fil-ph",590631:"meeting-analytics-locale-en-us",590773:"smart-device-locale-es-es",591068:"meeting-analytics-locale-it-it",591366:"meeting-collaboration-locale-fr-ca",591460:"communities-locale-sk-sk",591494:"services-atp-safelinks",591679:"r_data-resolvers-people-picker",591736:"meeting-analytics-locale-pt-br",592475:"queues-locale-ru-ru",594236:"calling-debug",594449:"communities-locale-en-us",594772:"share-email-locale-ca-es",594819:"search-locale-et-ee",595121:"survey-locale-uk-ua",595341:"hostUxStrings26",595487:"channels-locale-eu-es",595518:"categories-ur-pk-json",595862:"InformationProtectionStrings10",596007:"meeting-options-locale-et-ee",596269:"health-locale-hu-hu",596836:"webinar-locale-sv-se",596893:"breakoutRooms-locale-de-de",597085:"categories-fr-fr-json",597317:"communities-locale-sl-si",597548:"share-email-locale-nb-no",597554:"school-locale-fr-ca",597828:"main-locale-pt-pt",597900:"help-locale-es-es",598156:"webrec2-language-id",598523:"fil-PH-comment-pane-strings-jsonOfficeOnlineStringResource",598805:"calendar-locale-hu-hu",598993:"semantic-object-locale-hu-hu",599581:"queues-locale-nb-no",599650:"smart-device-locale-cs-cz",599657:"r_data-resolvers-cypress-only",599710:"guardians-locale-lt-lt",599928:"components-screen-recorder40",600057:"calling-locale-mk-mk",600132:"meeting-options-locale-ro-ro",600284:"search-locale-cs-cz",600629:"meeting-analytics-locale-ar-sa",600809:"recurrence-locale-he-il",600950:"aRes18",601046:"queues-locale-ja-jp",601638:"data-resolvers-browser-meet-for-work",601938:"r_data-resolvers-import-msa-contacts",602064:"help-locale-hu-hu",602243:"aRes10",602478:"lv-LV-comment-pane-strings-jsonOfficeOnlineStringResource",602536:"communities-locale-ko-kr",602764:"channels-locale-cy-gb",602936:"artifacts-platform-locale-uk-ua",602943:"coach-report-locale-es-es",603576:"hostUxStrings18",603657:"wiki-locale-fr-ca",603683:"webinar-locale-fi-fi",604184:"coach-report-locale-uk-ua",604340:"artifacts-platform-locale-pt-br",604918:"audience-view-dialog-locale-ca-es-valencia",605089:"cast-locale-he-il",605363:"gallery-locale-ca-es",605443:"hostUxStrings10",605543:"meet-for-work-locale-nb-no",606085:"r_data-resolvers-esp",606091:"semantic-object-locale-vi-vn",606208:"help-locale-bg-bg",606317:"adaptivecard",606408:"services-tpn-notice",606508:"meet-for-work-locale-ka-ge",606545:"services-refresh-site-url",606695:"r_data-client-calling",606768:"extensibility-locale-sr-latn-rs",607673:"discover-surface-entry-and-offline-main",607761:"meeting-room-console-locale-en-us",607897:"meeting-bot-locale-th-th",607932:"data-resolvers-notifications-engine",608094:"meet-for-work-locale-uk-ua",608108:"o365-connector-card",608656:"meeting-options-locale-ar-sa",608983:"global-auth",609050:"webrec2-language-az-latn-az",609339:"socketModule",609436:"teams-and-channels-locale-hr-hr",609468:"communities-locale-ar-sa",609652:"r_data-resolvers-connectors",609679:"video-message-locale-sv-se",609916:"r_data-schema-cdl",610190:"uk-strings-jsonThinRes",610319:"calling-locale-da-dk",610501:"survey-locale-es-mx",610542:"aRes14",610652:"meeting-analytics-locale-ca-es-valencia",610898:"r_data-resolvers-notifications-engine",611682:"components-screen-recorder74",611763:"shakaengine",611859:"communities-locale-es-es",611917:"growth-locale-ru-ru",612083:"video-message-locale-en-us",612389:"video-message-locale-hr-hr",612486:"hostUxStrings76",613103:"communities-leave-community",613291:"help-locale-ka-ge",613299:"meeting-recap-locale-cy-gb",613354:"breakoutRooms-locale-sq-al",613392:"teams-and-channels-locale-sl-si",613549:"services-user-profile",613609:"topics-sdk-loki-api",613847:"breakoutRooms-locale-ja-jp",613980:"artifacts-platform-locale-da-dk",614268:"share-email-locale-sl-si",614377:"channels-locale-de-de",614401:"meeting-recap-locale-hr-hr",614474:"eu-ES-comment-pane-strings-jsonOfficeOnlineStringResource",614493:"sht-cortextopictypeswebstrings_pa-in",614542:"message-escalate-dialog-locale-ar-sa",614634:"freemium-upgrade-locale-nl-nl",614646:"breakoutRooms-locale-ar-sa",615066:"meeting-recap-locale-sq-al",615798:"artifacts-platform-locale-fi-fi",615837:"audience-view-dialog-locale-uk-ua",616037:"sht-searchanswerteamsstrings_es-it",616045:"esp-locale-zh-tw",616940:"help-locale-vi-vn",616948:"create-team-view",617031:"otlang11",617045:"growth-locale-es-es",617263:"components-screen-recorder28",617434:"artifacts-platform-locale-hu-hu",617439:"otlang57",617557:"otlang53",617662:"recurrence-locale-nn-no",617794:"broadcast-locale-fr-fr",617828:"audience-view-dialog-locale-en-gb",618719:"categories-ca-es-json",618997:"virtualEvents-locale-sr-latn-rs",619114:"data-resolvers-mention",619228:"r_data-resolvers-browser-notifications-settings",619599:"meeting-options-locale-sr-latn-rs",619908:"InformationProtectionStrings36",620047:"hostUxStrings71",620188:"services-broadcast-streaming-attendee",620272:"categories-te-in-json",620295:"health-locale-nb-no",620356:"hostDefaultsStrings72",620545:"biometric-enrollment-locale-ja-jp",620756:"en-US-comment-pane-strings-jsonOfficeOnlineStringResource",620948:"gallery-locale-sq-al",621372:"webinar-locale-en-us",621886:"r_data-resolvers-bots-platform",621993:"meeting-analytics-locale-nb-no",622042:"breakoutRooms-locale-en-gb",622121:"services-file-upload",622504:"r_data-resolvers-fluid",622999:"recurrence-locale-hi-in",623568:"data-resolvers-mtma-user-data",623675:"errorConverter",624556:"categories-sr-Cyrl-RS-json",624764:"artifacts-platform-locale-zh-cn",625041:"r_data-resolvers-live-state-broadcast",625181:"docxDocument",625535:"communities-locale-sq-al",625622:"main-locale-ar-sa",625702:"InformationProtectionStrings80",626192:"hy-AM-comment-pane-strings-jsonOfficeOnlineStringResource",626317:"r_data-resolvers-files",626332:"survey-locale-nb-no",626510:"broadcast-qna",626759:"data-resolvers-pstn",626886:"video-message-locale-fi-fi",627386:"components-screen-recorder42",627455:"gallery-locale-zh-cn",628087:"meeting-options-locale-fr-fr",628205:"channels-locale-hr-hr",628471:"otlang56",628564:"et-EE-UiStrings-json",628746:"audience-view-dialog-locale-zh-cn",628907:"data-resolvers-immersive-view",629095:"categories-id-id-json",629741:"guardians-locale-pt-br",629837:"gallery-locale-is-is",629844:"webrec2-language-lt",630154:"queues-locale-en-us",630291:"calling-locale-zh-cn",630384:"meeting-collaboration-locale-sq-al",630669:"virtualEvents-locale-fr-fr",631286:"meetingFlyout-locale-ar-sa",631702:"nb-no-strings-jsonThinRes",631967:"sht-cortextopictypeswebstrings_bn-bd",632022:"freemium-upgrade-locale-ka-ge",632121:"help-locale-az-latn-az",632323:"onecamera-locale-sl",632724:"health-locale-he-il",632940:"queues-locale-hr-hr",633586:"apps-linkedin",633642:"hostUxStrings3",633738:"meeting-room-console-locale-ko-kr",634692:"services-chat-endpoint-provider",634879:"growth-locale-el-gr",634884:"calendar-locale-id-id",635024:"webrec2-language-eu",635329:"meeting-collaboration-locale-nb-no",635409:"channels-locale-pt-pt",636730:"cy-GB-comment-pane-strings-jsonOfficeOnlineStringResource",636759:"onecamera-locale-hi",637693:"wiki-locale-lt-lt",637754:"calling-locale-ru-ru",638002:"video-capture-locale-nb-no",638437:"main-locale-mk-mk",638707:"meeting-collaboration-locale-tr-tr",639007:"aRes0",639363:"categories-af-za-json",639874:"otlang43",640221:"search-locale-ja-jp",640583:"extensibility-locale-vi-vn",640628:"r_data-resolvers-activity",640756:"artifacts-platform-locale-sq-al",641007:"hostUxStrings41",641091:"r_data-resolvers-whats-new",641127:"webview2-service",641143:"messaging-locale-en-us",641272:"hostDefaultsStrings3",641491:"gallery-locale-sk-sk",642143:"calendar-locale-ar-sa",642575:"channels-locale-cs-cz",642699:"meeting-room-console-locale-fr-fr",642742:"main-locale-zh-cn",642768:"meet-for-work-locale-tr-tr",643054:"fns85",644126:"webinar-locale-ja-jp",644386:"webinar-locale-tr-tr",644476:"aRes45",644584:"pl-PL-comment-pane-strings-jsonOfficeOnlineStringResource",644634:"otlang118",645285:"main-locale-sr-latn-rs",645328:"school-locale-it-it",645500:"sl-SI-comment-pane-strings-jsonOfficeOnlineStringResource",645702:"semantic-object-locale-nl-nl",645885:"guardians-locale-sq-al",645924:"cast-locale-ko-kr",646119:"cortana-popup",646433:"onePlayerLoader",646581:"wiki-locale-en-us",646639:"categories-nl-nl-json",646804:"search-locale-pt-pt",646978:"calling-locale-et-ee",647461:"otlang52",647511:"extensibility-locale-it-it",647531:"queues-locale-kk-kz",647573:"recurrence-locale-fi-fi",647812:"meeting-recap-locale-mk-mk",648147:"nova-sb-variant-teams",648421:"onecamera-locale-zh-hans",648451:"calendar-locale-th-th",648683:"recurrence-locale-lv-lv",648736:"health-locale-pt-br",649880:"services-MeetingRecapSwaservice",650238:"fns67",650284:"hostUxStrings16",650391:"meeting-options-locale-hu-hu",650462:"growth-locale-ja-jp",650756:"locked-teams-activate-dialog",651070:"webrec2-language-pl",651226:"r_data-resolvers-browser-payment",652624:"copilot-container-panel",652708:"recurrence-locale-sq-al",652763:"fil-PH-UiStrings-json",653075:"video-capture-locale-ca-es",653188:"video-message-locale-fil-ph",653247:"calling-locale-lt-lt",653484:"hi-strings-jsonThinRes",653637:"breakoutRooms-locale-nn-no",653831:"meeting-collaboration-locale-id-id",654177:"files-locale-hu-hu",654198:"components-compose-extensions",654569:"share-email-locale-nl-nl",654761:"broadcast-locale-zh-tw",655033:"sht-searchanswerteamsstrings_es-sw",655151:"onecamera-locale-uk",655402:"services-io-tfl-user",655550:"gallery-locale-sv-se",655875:"freemium-upgrade-locale-fr-ca",656737:"services-collab-object",657426:"gallery-locale-da-dk",658142:"meeting-recap-locale-zh-tw",658188:"smart-device-locale-sv-se",658395:"de-DE-UiStrings-json",659098:"services-store",659286:"wiki-locale-et-ee",659412:"r_data-resolvers-apps-monet",659529:"otlang25",659831:"components-screen-recorder30",660115:"data-resolvers-policies",660148:"video-message-locale-nl-nl",660273:"guardians-locale-zh-cn",660347:"broadcast-locale-fi-fi",660417:"help-locale-es-mx",660804:"growth-locale-lt-lt",661045:"meeting-bot-locale-el-gr",661051:"create-folder-dialog",661176:"meetingFlyout-locale-da-dk",661639:"video-capture-locale-sr-latn-rs",661701:"message-escalate-dialog-locale-lv-lv",661922:"broadcast-locale-sv-se",662153:"categories-kn-in-json",662245:"calling-locale-pl-pl",662463:"sht-searchanswerteamsstrings_es-ru",662535:"communities-join-modal",662763:"teams-and-channels-locale-ko-kr",662990:"gallery-locale-cs-cz",663367:"growth-locale-pt-br",663936:"meeting-apps-flyout-renderer",664089:"InformationProtectionStrings44",664258:"sr-Latn-RS-comment-pane-strings-jsonOfficeOnlineStringResource",664501:"sht-cortextopictypeswebstrings_ug-cn",664618:"main-locale-uk-ua",664857:"communities-create-dialog",664876:"messaging-locale-is-is",665054:"survey-locale-hi-in",665151:"files-locale-mk-mk",665242:"fluid-message-container",665347:"r_data-resolvers-collab-cloud",665515:"artifacts-platform-locale-id-id",665641:"health-locale-bg-bg",665666:"r_data-resolvers-browser-communities",665785:"aRes16",666073:"meeting-options-locale-sv-se",666326:"otlang29",666482:"hostDefaultsStrings34",666584:"wiki-locale-es-es",666726:"meeting-bot-locale-da-dk",666836:"r_data-resolvers-callable-channel",667142:"pt-br-strings-jsonThinRes",667288:"hostDefaultsStrings45",667417:"call-blocking-service",667442:"semantic-object-locale-es-mx",667569:"survey-locale-en-us",667643:"user-avatar",667676:"cast-locale-mk-mk",667681:"recurrence-locale-id-id",668018:"otlang38",668286:"ga-IE-UiStrings-json",668299:"fns43",668722:"messaging-locale-kk-kz",668778:"calendar-app",669622:"school-locale-he-il",669652:"wiki-locale-ca-es-valencia",669891:"discover-surface-locale-zh-cn",669982:"live-interpreter-promotion-dialog-container",669983:"aRes17",670059:"otlang110",670094:"calendar-left-rail",670103:"video-capture-locale-lt-lt",670200:"recurrence-locale-gl-es",670542:"extensibility-locale-nb-no",670941:"long-lived-subscription-for-channels-app",670972:"services-import-msa-contacts",671161:"aRes13",671980:"cy-gb-strings-jsonThinRes",672055:"audience-view-dialog-locale-id-id",673047:"meeting-bot-locale-eu-es",673121:"teams-grid",673321:"audience-view-dialog-locale-fr-ca",673460:"bs-Latn-BA-comment-pane-strings-jsonOfficeOnlineStringResource",673680:"categories-zh-hk-json",673773:"teams-and-channels-locale-es-es",673889:"video-message-locale-ca-es",674282:"extensibility-locale-uk-ua",674574:"files-locale-ar-sa",674687:"guardians-locale-gl-es",676007:"onecamera-locale-ro",676130:"services-presence",676179:"whiteboard-renderer",676274:"breakoutRooms-locale-ko-kr",676317:"semantic-object-locale-fil-ph",676327:"cast-locale-sr-latn-rs",676425:"notesFluidxSensitivityButton",676513:"buttonCollection",676912:"hostUxStrings31",677093:"meet-for-work-locale-mk-mk",677397:"ru-strings-jsonThinRes",677496:"virtualEvents-locale-is-is",677740:"meeting-collaboration-locale-ca-es-valencia",677793:"hostUxStrings64",678026:"sht-cortextopictypeswebstrings_km-kh",678130:"semantic-object-locale-sl-si",678153:"coach-report-locale-cy-gb",678220:"calendar-locale-ca-es-valencia",678324:"freemium-upgrade-locale-hi-in",678408:"fns71",678680:"platform-chat-with-subscription",678729:"hostUxStrings13",679049:"r_data-resolvers-mesh-audio",679754:"files-locale-et-ee",680670:"freemium-upgrade-locale-pl-pl",680707:"cs-strings-jsonThinRes",681102:"recurrence-locale-mk-mk",681698:"InformationProtectionStrings14",682176:"wiki-locale-pl-pl",682522:"calling-locale-eu-es",682754:"meetingFlyout-locale-hr-hr",682831:"webinar-locale-fr-ca",682989:"search-locale-ar-sa",684021:"meetingFlyout-locale-ru-ru",684057:"gd-gb-comment-pane-strings-jsonOfficeOnlineStringResource",684091:"data-resolvers-invite-links",684317:"communities-locale-cs-cz",684615:"services-call-recording",684956:"sw-KE-comment-pane-strings-jsonOfficeOnlineStringResource",685250:"communities-locale-hu-hu",685394:"r_data-resolvers-meet-for-work",685716:"smart-device-locale-sk-sk",685995:"something-went-wrong-empty-state",686380:"InformationProtectionStrings8",686824:"data-resolvers-tenant-analytics",687254:"sht-cortextopictypeswebstrings_gl",687271:"smart-device-locale-hu-hu",687309:"reactions-overlay-webgl-renderer",687391:"data-resolvers-app-device-permission",687392:"data-resolvers-external-calendar-email-address",687844:"survey-locale-fr-fr",687921:"esp-locale-bg-bg",687990:"r_data-resolvers-discover-surface",688164:"search-locale-kk-kz",688282:"broadcast-locale-pl-pl",688314:"meeting-room-console-locale-et-ee",688360:"wiki-locale-ru-ru",688453:"aRes9",688466:"discover-surface-locale-es-mx",688540:"data-resolvers-tenant-membership",688725:"webinar-locale-sl-si",688901:"semantic-object-locale-lv-lv",689118:"guardians-locale-hr-hr",689220:"fr-FR-comment-pane-strings-jsonOfficeOnlineStringResource",689346:"communities-locale-hi-in",689430:"cast-locale-is-is",689509:"share-email-locale-id-id",689961:"fns55",690086:"communities-locale-uk-ua",690094:"wiki-locale-de-de",690134:"webrec2-language-ro",690166:"meeting-options-locale-uk-ua",690224:"categories-ko-kr-json",690250:"onecamera-locale-ca",690514:"coach-report-locale-ar-sa",690531:"video-capture-locale-fil-ph",690533:"categories-az-latn-az-json",690534:"InformationProtectionStrings81",690595:"communities-locale-pt-pt",690766:"message-escalate-dialog-locale-gl-es",691086:"fns58",691138:"calendar-locale-nn-no",691195:"meeting-recap-locale-is-is",691291:"accessibility-settings-panel",691643:"recurrence-locale-ca-es-valencia",691716:"messaging-locale-pl-pl",691913:"meeting-collaboration-locale-uk-ua",692186:"biometric-enrollment-locale-el-gr",692235:"video-capture-locale-bg-bg",692729:"hostUxStrings54",693334:"config-gallatin",693371:"otlang26",693467:"gallery-locale-lt-lt",693594:"coach-report-locale-lv-lv",693762:"health-locale-gl-es",693916:"virtualEvents-locale-eu-es",694057:"calling-locale-en-gb",694061:"channels-locale-it-it",694170:"categories-wo-sn-json",694174:"r_data-resolvers-missed-mtma-notifications",694243:"help-locale-nl-nl",694535:"virtualEvents-locale-tr-tr",694543:"people-targeting-locale-es-mx",694623:"hostDefaultsStrings62",694637:"callable-channel-calls-app",694945:"services-meeting-intelligence",695268:"messaging-locale-el-gr",695322:"pluginMeetingNotes",695366:"queues-locale-mk-mk",695875:"hostDefaultsStrings24",695885:"coach-report-locale-kk-kz",696540:"sq-AL-UiStrings-json",696980:"smart-device-locale-cy-gb",697014:"meeting-options-locale-kk-kz",697206:"coach-report-locale-en-us",697225:"video-capture-locale-is-is",697437:"aRes53",697606:"semantic-object-locale-hi-in",698080:"sht-searchanswerteamsstrings_es-sr-cyrl",698091:"webrec2-language-es",698170:"messaging-locale-cs-cz",698865:"extensibility-locale-pt-br",698929:"audience-view-dialog-locale-ro-ro",699329:"school-locale-en-gb",699458:"virtualEvents-locale-ca-es-valencia",700052:"growth-locale-hr-hr",700075:"calendar-locale-et-ee",700106:"school-locale-sq-al",700369:"message-escalate-dialog-locale-fil-ph",700488:"data-resolvers-browser-calls-screen",700632:"virtualEvents-locale-zh-tw",700798:"r_data-resolvers-viva-insights",700826:"calendar-locale-da-dk",700926:"main-locale-lv-lv",701035:"services-io-browser-collab-cloud",701387:"aRes43",701471:"growth-locale-sq-al",701556:"cast-locale-nb-no",701570:"r_data-resolvers-taskbar",701583:"hostDefaultsStrings78",701753:"meeting-recap-locale-vi-vn",701966:"as-IN-UiStrings-json",703101:"communities-locale-bg-bg",703405:"calling-locale-sq-al",703414:"r_data-resolvers-bot-dynamic-commands",703813:"hostUxStrings44",703983:"teams-and-channels-locale-ka-ge",704120:"search-locale-da-dk",704171:"notifications-entry",704286:"fns23",704288:"semantic-object-locale-de-de",704620:"fns64",704822:"school-locale-nn-no",704987:"meeting-recap-locale-nn-no",705170:"survey-locale-es-es",705297:"webrec2-language-ko",705406:"esp-locale-az-latn-az",705553:"r_data-resolvers-browser-virtual-events",705754:"components-files-super-picker",705875:"calling-locale-cy-gb",706013:"categories-de-de-json",706240:"containerMessageBanner",706366:"hostUxStrings40",706702:"sht-cortextopictypeswebstrings_ne-np",706767:"guardians-locale-az-latn-az",707015:"biometric-enrollment-locale-sl-si",707040:"teachingMoment",707191:"hostDefaultsStrings70",707290:"zh-CN-comment-pane-strings-jsonOfficeOnlineStringResource",707368:"semantic-object-locale-zh-cn",707463:"communities-locale-ro-ro",707536:"esp-locale-cs-cz",707620:"search-locale-is-is",707729:"hostUxStrings52",707950:"smart-device-locale-nb-no",707959:"fluid-component-renderer",708174:"teams-and-channels-locale-lv-lv",709267:"meeting-collaboration-locale-th-th",709372:"calendar-locale-lv-lv",709495:"meeting-options-panel",709592:"hostDefaultsStrings59",709675:"sht-cortextopictypeswebstrings_ms",709735:"aRes46",709778:"hostUxStrings48",709837:"smart-device-locale-mk-mk",709940:"teams-and-channels-locale-vi-vn",710659:"growth-locale-pl-pl",710728:"webinar-locale-th-th",710787:"webrec2-language-kk",711265:"teams-and-channels-locale-el-gr",711746:"gallery-locale-en-us",712252:"artifacts-platform-locale-nb-no",712274:"communities-report-concern",712610:"components-screen-recorder24",713077:"r_data-resolvers-app-ratings-and-reviews",713750:"webinar-locale-et-ee",713838:"recurrence-locale-is-is",714065:"r_data-resolvers-people-avatar",714076:"sht-searchanswerteamsstrings_es-lt",714421:"calling-meeting-options-form",714653:"r_data-resolvers-example",714927:"virtualEvents-locale-bg-bg",715271:"categories-kok-in-json",715369:"teams-gallery-app",715442:"coach-report-locale-nb-no",715523:"teams-and-channels-locale-ar-sa",715657:"meet-for-work-locale-ko-kr",715905:"meeting-bot-locale-hu-hu",716089:"audience-view-dialog-locale-gl-es",716151:"services-people",716313:"services-people-picker",716316:"hostUxStrings53",716540:"help-locale-ja-jp",716687:"otlang46",716734:"th-strings-jsonThinRes",716804:"webinar-locale-az-latn-az",717142:"webrec2-language-sr-latn-rs",717285:"messaging-locale-nl-nl",717293:"recurrence-locale-pt-br",717652:"files-locale-hr-hr",717704:"discover-surface-locale-ca-es",717795:"message-escalate-dialog-locale-lt-lt",718031:"meeting-collaboration-locale-vi-vn",718170:"categories-pt-pt-json",718436:"or-IN-comment-pane-strings-jsonOfficeOnlineStringResource",718500:"chat-list-apollo",718815:"data-resolvers-transcript-feedback",718884:"data-resolvers-implicit-contacts",719050:"files-locale-he-il",719109:"meeting-analytics-locale-zh-cn",719997:"components-screen-recorder21",720718:"content-bubble-container",720765:"components-screen-recorder110",720965:"components-calendar-peek-view-attachments",721103:"wiki-locale-ca-es",721209:"bridge-migration-components-calendar",721240:"r_data-resolvers-closed-captions",721689:"files-locale-da-dk",721941:"health-locale-fi-fi",722064:"esp-locale-uk-ua",722487:"fns10",722799:"guardians-locale-el-gr",723063:"meeting-recap-locale-da-dk",723088:"services-invite-links",723465:"r_data-resolvers-meeting-analytics",723794:"search-locale-hi-in",723966:"queues-locale-ar-sa",723968:"survey-locale-is-is",724092:"recurrence-locale-az-latn-az",724526:"callable-channels-app",724924:"id-ID-comment-pane-strings-jsonOfficeOnlineStringResource",724937:"main-locale-en-gb",725509:"search-locale-sl-si",725606:"message-escalate-dialog-locale-th-th",725700:"meeting-bot-locale-pt-br",726445:"fns14",726553:"InformationProtectionStrings26",726717:"fns18",727013:"InformationProtectionStrings24",727202:"discover-surface-locale-lv-lv",727513:"sht-cortextopictypeswebstrings_ro",727648:"breakoutRooms-locale-ca-es",727662:"files-locale-en-gb",727910:"guardians-locale-hu-hu",727959:"artifacts-platform-locale-en-gb",728176:"data-resolvers-bot-dynamic-commands",728410:"freemium-upgrade-locale-sv-se",728420:"msal2-service",728549:"freemium-upgrade-locale-ca-es",728584:"sht-cortextopictypeswebstrings_fr",728992:"sht-cortextopictypeswebstrings_ru",729025:"sht-cortextopictypeswebstrings_pl",729180:"data-resolvers-browser-tenant-privacy",729284:"calling-screen-default",729569:"messaging-locale-lt-lt",729731:"cast-locale-eu-es",729961:"services-virtual-events",730150:"sht-cortextopictypeswebstrings_pt",730168:"sht-searchanswerteamsstrings_es-fa",730235:"teams-and-channels-locale-bg-bg",730783:"teams-and-channels-locale-th-th",730922:"gallery-locale-hi-in",731167:"guardians-locale-sl-si",731210:"pluginShare",731374:"calling-locale-sv-se",731503:"ne-NP-UiStrings-json",731513:"school-locale-ar-sa",731538:"InformationProtectionStrings22",731835:"pt-PT-comment-pane-strings-jsonOfficeOnlineStringResource",731908:"meeting-options-locale-de-de",731953:"audience-view-dialog-locale-fr-fr",732093:"sht-cortextopictypeswebstrings_mn-mn",732226:"sht-cortextopictypeswebstrings_lt",732240:"data-resolvers-app-suggestions",732241:"video-capture-locale-mk-mk",732420:"virtualEvents-locale-ka-ge",732521:"pa-IN-UiStrings-json",732522:"lazy-team-context-menu-container",732751:"video-capture-locale-et-ee",733014:"wiki-locale-az-latn-az",733075:"biometric-enrollment-locale-hr-hr",733206:"categories-kk-kz-json",733488:"esp-locale-lt-lt",733526:"share-meeting-search",733603:"gallery-locale-ja-jp",733885:"services-app-suggestions",734602:"components-screen-recorder37",734632:"discover-surface-locale-hi-in",734882:"survey-locale-zh-cn",734949:"services-implicit-contacts",734966:"meet-for-work-locale-fr-ca",735512:"data-resolvers-platform-tabs-state",735529:"r_data-resolvers-pstn",735551:"recurrence-locale-lt-lt",735568:"recurrence-locale-kk-kz",735596:"r_data-resolvers-favorite-user",735668:"InformationProtectionStrings47",735677:"otlang76",736173:"hostDefaultsStrings32",736341:"help-locale-en-gb",736447:"wiki-locale-is-is",736856:"broadcast-locale-sl-si",736875:"growth-locale-uk-ua",737249:"biometric-enrollment-locale-fr-fr",737310:"meet-for-work-locale-pt-pt",737671:"sre-experimental",738221:"school-locale-hr-hr",738564:"FluidFramework-HashFallback",738746:"hu-HU-comment-pane-strings-jsonOfficeOnlineStringResource",739818:"meeting-bot-locale-it-it",739823:"lpc-teams-bootstrapper",740085:"communities-app",740114:"components-screen-recorder25",740191:"wiki-locale-ja-jp",740433:"meetingFlyout-locale-ca-es",740649:"growth-locale-zh-cn",740802:"tt-RU-UiStrings-json",740851:"r_data-resolvers-user-preferences",740868:"data-resolvers-browser-floodgate",740953:"prs-AF-comment-pane-strings-jsonOfficeOnlineStringResource",741127:"r_data-resolvers-search-meeting-summary",741480:"services-meeting-catchup",741627:"breakoutRooms-locale-gl-es",741897:"cast-locale-pt-pt",742122:"categories-el-gr-json",742302:"video-message-locale-sk-sk",742477:"video-message-locale-kk-kz",742842:"message-escalate-dialog-locale-ro-ro",743061:"queues-locale-lt-lt",743583:"InformationProtectionStrings30",743665:"files-locale-pt-pt",744334:"closedCaptionsTeachingMoment",744357:"hostUxStrings33",744470:"meeting-options-locale-sk-sk",744551:"webrec2-language-gl",744746:"categories-tt-ru-json",744778:"calendar-locale-fr-fr",745250:"fns66",745303:"video-capture-locale-en-us",745321:"extensibility-locale-tr-tr",745999:"calendar-locale-it-it",746169:"gd-gb-UiStrings-json",746685:"ckeditor5-inspector",746873:"broadcast-locale-is-is",746979:"components-mesh-avatar-panel",747049:"artifacts-platform-locale-lt-lt",747384:"notesHeaderTooltipHost",747579:"fns69",748113:"cast-locale-en-gb",748307:"compose-box-v2-renderer",750970:"school-locale-de-de",751309:"services-teams-and-channels",751359:"breakoutRooms-locale-nb-no",751534:"onecamera-locale-az",751661:"data-resolvers-targeting-hierarchy",751667:"otlang102",751744:"InformationProtectionStrings79",751748:"wiki-locale-th-th",751789:"video-message-locale-ar-sa",751803:"webrec2-webcv",751868:"meeting-bot-locale-ca-es-valencia",751921:"meet-for-work-locale-sv-se",751949:"data-resolvers-browser-mention",752567:"sht-searchanswerteamsstrings_es-sl",752579:"queues-locale-pt-pt",752866:"InformationProtectionStrings57",753029:"categories-gd-gb-json",753681:"gu-IN-comment-pane-strings-jsonOfficeOnlineStringResource",754309:"sht-cortextopictypeswebstrings_ca",754432:"r_data-resolvers-host-updates",754447:"components-screen-recorder56",754509:"video-message-locale-fr-fr",755206:"share-email-locale-ko-kr",755279:"components-screen-recorder114",755340:"survey-locale-ru-ru",755553:"freemium-upgrade-locale-mk-mk",755715:"growth-locale-eu-es",756204:"meeting-recap-locale-de-de",756244:"hostUxStrings9",756300:"sht-searchanswerteamsstrings_es-pt-pt",756335:"sht-searchanswerteamsstrings_es-ga-ie",756387:"InformationProtectionStrings65",756391:"video-message-locale-hi-in",756425:"fns83",756679:"broadcast-locale-ro-ro",756774:"guardians-locale-fi-fi",756864:"meeting-options-locale-it-it",757545:"cast-locale-az-latn-az",757628:"is-strings-jsonThinRes",757721:"people-targeting-locale-tr-tr",757912:"InformationProtectionStrings7",758622:"messaging-locale-pt-br",758670:"meeting-analytics-locale-lt-lt",758673:"artifacts-platform-locale-sk-sk",759082:"common-post-and-reply-types",759084:"sht-searchanswerteamsstrings_es-sr",759238:"InformationProtectionStrings71",760323:"discover-surface-locale-fr-fr",760325:"main-locale-fr-fr",760438:"meeting-collaboration-locale-et-ee",760500:"hostDefaultsStrings60",761030:"artifacts-platform-locale-fil-ph",761263:"meeting-bot-locale-vi-vn",761286:"hostUxStrings1",761618:"communities-locale-zh-tw",761949:"queues-locale-tr-tr",762058:"multi-window-dashboard-renderer",762151:"otlang72",762198:"hostUxStrings28",762781:"calendar-locale-sk-sk",762993:"meeting-collaboration-locale-lv-lv",763140:"mi-NZ-UiStrings-json",763233:"messaging-locale-hu-hu",763417:"meeting-recap-locale-ja-jp",763702:"sht-searchanswerteamsstrings_es-en-gb",763823:"teams-and-channels-locale-en-gb",763871:"school-locale-zh-tw",763903:"files-locale-sk-sk",764e3:"sht-cortextopictypeswebstrings_uz",764009:"broadcast-locale-da-dk",764010:"webinar-locale-is-is",764055:"categories-ms-my-json",764100:"data-resolvers-hosted-web-content-log",764139:"gl-ES-comment-pane-strings-jsonOfficeOnlineStringResource",764816:"fa-IR-UiStrings-json",764897:"files-locale-fr-fr",765065:"webinar-locale-pt-pt",765556:"channels-locale-fil-ph",765707:"lms-integration-image-default-export",766167:"school-locale-zh-cn",766186:"artifacts-platform-locale-nn-no",766610:"cast-locale-it-it",766761:"search-locale-pt-br",766793:"virtualEvents-locale-nl-nl",766933:"r_data-resolvers-conversations-reminder",767326:"files-locale-it-it",767634:"meeting-collaboration-locale-he-il",767650:"sht-cortextopictypeswebstrings_th",767973:"components-screen-recorder72",768748:"sd-Arab-PK-comment-pane-strings-jsonOfficeOnlineStringResource",768781:"wiki-locale-ar-sa",768935:"meeting-options-locale-vi-vn",769085:"meeting-room-console-locale-it-it",769167:"r_data-resolvers-browser-logs-files",769415:"feedback-renderer",769663:"pskin",769675:"categories-is-is-json",770041:"cast-locale-bg-bg",770293:"semantic-object-locale-az-latn-az",770326:"calling-app",770357:"data-resolvers-browser-url-preview",771216:"calendar-locale-hr-hr",771285:"virtualEvents-locale-vi-vn",771326:"video-message-locale-vi-vn",771401:"services-async-media",772001:"channels-locale-sr-latn-rs",772287:"sht-cortextopictypeswebstrings_cy",773170:"survey-locale-id-id",773343:"sht-cortextopictypeswebstrings_ja",773349:"aRes15",773696:"semantic-object-locale-ro-ro",773969:"data-resolvers-browser-survey",773998:"webrec2-language-ca",774180:"hostDefaultsStrings4",774224:"gallery-locale-et-ee",774604:"guardians-locale-sr-latn-rs",774896:"biometric-enrollment-locale-id-id",775039:"categories-mt-mt-json",775123:"recurrence-locale-fr-ca",775141:"sht-searchanswerteamsstrings_es-mi-nz",775238:"ml-IN-comment-pane-strings-jsonOfficeOnlineStringResource",775294:"school-locale-cy-gb",775447:"search-locale-sr-latn-rs",775546:"files-locale-sl-si",775931:"wiki-app",776205:"extensibility-locale-fr-fr",776281:"discover-surface-locale-ka-ge",776418:"meeting-recap-locale-es-es",776426:"files-locale-sr-latn-rs",776945:"data-resolvers-search-contextual",777067:"gallery-locale-nb-no",777093:"fi-FI-UiStrings-json",777384:"discover-surface-locale-bg-bg",777618:"r_data-resolvers-browser-meeting-bot",777649:"components-screen-recorder68",778013:"group-template-cta-container",778026:"zh-TW-comment-pane-strings-jsonOfficeOnlineStringResource",778516:"adaptivecard-react",778773:"school-locale-uk-ua",778858:"files-locale-uk-ua",779188:"smart-device-login",779458:"queues-locale-sv-se",779737:"hostUxStrings29",779804:"freemium-upgrade-locale-cy-gb",780163:"fns53",780192:"r_data-resolvers-mru",780694:"categories-sl-si-json",781074:"queues-locale-ko-kr",781288:"message-escalate-dialog-locale-ca-es-valencia",781529:"smart-device-locale-fr-fr",782136:"freemium-upgrade-locale-da-dk",782196:"discover-surface-locale-ca-es-valencia",782856:"teams-and-channels-locale-es-mx",783226:"meeting-analytics-locale-zh-tw",783619:"channels-locale-ru-ru",784224:"coach-report-locale-eu-es",784384:"meeting-collaboration-locale-fi-fi",784434:"artifacts-platform-locale-th-th",784497:"video-capture-locale-ka-ge",785333:"main-locale-he-il",786016:"growth-locale-et-ee",786113:"video-message-locale-it-it",786155:"smart-device-locale-bg-bg",786183:"smart-device-locale-sq-al",786549:"search-locale-es-es",786757:"meeting-bot-locale-sv-se",786910:"hostUxStrings34",787173:"smart-device-locale-kk-kz",787227:"data-resolvers-system-settings",787329:"webinar-locale-mk-mk",787480:"services-image-proxy",788207:"survey-locale-cs-cz",788273:"r_data-resolvers-platform-tabs",788582:"video-capture-locale-vi-vn",788811:"broadcast-locale-en-us",788861:"coach-report-locale-hu-hu",788864:"meeting-recap-locale-ca-es",789080:"wiki-locale-zh-cn",789162:"r_data-resolvers-sensitivity-label",789183:"meeting-options-locale-zh-tw",789499:"aRes1",789525:"coach-report-locale-he-il",790752:"sht-cortextopictypeswebstrings_kn",791496:"webinar-locale-vi-vn",791510:"channels-locale-vi-vn",791761:"categories-zu-za-json",791789:"calling",792168:"mn-MN-comment-pane-strings-jsonOfficeOnlineStringResource",792193:"audience-view-dialog-locale-ca-es",792574:"main-locale-tr-tr",792621:"aRes24",792722:"artifacts-platform-locale-kk-kz",792876:"services-signals",792966:"share-email-locale-fr-ca",793200:"share-email-locale-gl-es",793241:"teams-and-channels-locale-hu-hu",793300:"meetingFlyout-locale-fr-ca",793337:"meeting-options-locale-hi-in",793400:"teams-and-channels-locale-is-is",793477:"sht-searchanswerteamsstrings_es-as-in",793518:"r_data-resolvers-meeting-summary-qna-history",793653:"video-attachment-light",793800:"he-strings-jsonThinRes",793844:"data-resolvers-people-picker",793944:"video-capture-locale-hr-hr",794159:"hostUxStrings65",794166:"services-floodgate",794844:"meeting-bot-locale-kk-kz",795037:"files-viewer-oneup",795422:"smart-device-locale-ro-ro",795571:"meeting-options-locale-th-th",795691:"teams-and-channels-locale-eu-es",795898:"queues-locale-ka-ge",796078:"hostDefaultsStrings68",796317:"audience-view-dialog-locale-kk-kz",796736:"virtualEvents-locale-el-gr",796795:"cmd-trouter",797069:"queues-locale-sr-latn-rs",797119:"calling-locale-it-it",797146:"audience-view-dialog-locale-el-gr",797153:"webrec2-language-zh-tw",797433:"r_data-resolvers-apps-platform",797550:"breakoutRooms-locale-sv-se",798176:"hostUxStrings61",798498:"hostUxStrings69",798654:"webinar-locale-el-gr",798696:"meeting-analytics-locale-bg-bg",798972:"survey-locale-pt-br",799030:"biometric-enrollment-locale-sq-al",799106:"help-locale-nn-no",799666:"id-strings-jsonThinRes",799793:"components-screen-recorder20",799981:"meeting-room-console-locale-uk-ua",800274:"video-message-locale-ru-ru",800432:"r_data-resolvers-browser-meeting-catchup",800481:"sht-searchanswerteamsstrings_es-es-mx",800509:"calendar-locale-sv-se",800692:"pl-PL-UiStrings-json",800824:"calling-locale-id-id",801551:"meeting-bot-locale-ka-ge",801595:"smart-device-locale-lv-lv",801811:"aRes41",802054:"core-essentials",802090:"aRes50",802297:"cy-GB-UiStrings-json",802517:"odsp1PDiagnosticTool",802849:"meeting-bot-locale-bg-bg",802859:"sht-searchanswerteamsstrings_es-vi",802989:"uz-Latn-UZ-UiStrings-json",803073:"message-escalate-dialog-locale-cy-gb",803106:"help-locale-kk-kz",803184:"share-email-locale-et-ee",803698:"components-calendar-peek",803891:"data-resolvers-browser-ddv",803941:"video-message-locale-cy-gb",804102:"meet-for-work-locale-de-de",805131:"otlang14",805164:"wiki-locale-fi-fi",805203:"services-apps-platform",805235:"freemium-upgrade-locale-gl-es",805430:"otlang73",805588:"discover-surface-locale-lt-lt",805794:"services-dynamics-marketing",806023:"audience-view-dialog-locale-lt-lt",806389:"recurrence-locale-ru-ru",806582:"modal",806994:"teams-post-compose-box",807178:"chat-screen-share-button",807205:"survey-locale-sv-se",808111:"extensibility-locale-fr-ca",808376:"sht-searchanswerteamsstrings_es-te",808438:"health-locale-ar-sa",808521:"meeting-options-locale-pt-pt",809170:"InformationProtectionStrings9",809193:"sht-cortextopictypeswebstrings_zh-hans",809257:"webrec2-language-bg",809820:"InformationProtectionStrings5",810016:"fns15",810072:"queues-locale-zh-tw",810146:"audience-view-dialog-locale-vi-vn",810222:"ru-RU-UiStrings-json",810284:"calendar-locale-vi-vn",810589:"meeting-analytics-locale-hi-in",810970:"discover-surface-locale-gl-es",811131:"cast-locale-nn-no",811287:"help-locale-sq-al",811334:"aRes37",811930:"communities-locale-sr-latn-rs",812090:"calling-locale-sk-sk",812118:"components-meeting-room-smart-device-join-by-code",812190:"calling-roster",812464:"help-locale-hi-in",812502:"otlang59",812695:"sht-cortextopictypeswebstrings_sd-arab-pk",812946:"services-io-calling-service-adapters",813652:"gallery-locale-pt-br",813769:"designer-full-dialog",813794:"biometric-enrollment-locale-pl-pl",813802:"artifacts-platform-locale-de-de",814408:"services-live-stream-renderer",814644:"hy-AM-UiStrings-json",814834:"meeting-options-locale-nn-no",815463:"categories-lt-lt-json",815469:"meet-for-work-locale-ca-es",815633:"sht-searchanswerteamsstrings_es-bn-bd",815783:"files-locale-nb-no",815923:"platform-app-service",816436:"ko-strings-jsonThinRes",816523:"otlang104",816611:"nn-np-strings-jsonThinRes",816702:"services-calling-service-adapters",816705:"meeting-analytics-locale-ja-jp",816733:"P2PFilesListEmptyStateView",816877:"az-Latn-AZ-UiStrings-json",816981:"InformationProtectionStrings72",817233:"InformationProtectionStrings54",817400:"data-resolvers-meeting-options",817542:"calling-locale-lv-lv",817638:"semantic-object-locale-ca-es-valencia",818344:"categories-nso-za-json",818364:"broadcast-locale-cy-gb",818773:"message-escalate-dialog",818787:"meeting-collaboration-locale-lt-lt",819210:"InformationProtectionStrings1",819211:"services-transcript-settings-store",819212:"aRes48",819433:"sr-Cyrl-RS-UiStrings-json",819521:"esp-locale-et-ee",819707:"aRes40",820464:"sharedServicesRest",820516:"services-meeting-options",820672:"services-bots-platform",820691:"help-locale-ca-es-valencia",821083:"semantic-object-locale-mk-mk",821181:"kn-IN-UiStrings-json",821558:"freemium-upgrade-locale-fr-fr",821706:"data-schema-cdl",821836:"services-address",821838:"cast-locale-et-ee",822099:"store-fre-modal",822423:"calendar-locale-ja-jp",822555:"cast-locale-hr-hr",822918:"sb-commanding-exp",823065:"search-locale-vi-vn",823264:"health-locale-ca-es",823308:"freemium-upgrade-locale-uk-ua",823921:"categories-si-lk-json",823954:"gallery-locale-ru-ru",824014:"tt-RU-comment-pane-strings-jsonOfficeOnlineStringResource",824087:"communities-locale-cy-gb",825066:"fr-CA-UiStrings-json",825268:"wiki-locale-hu-hu",825471:"messaging-locale-nb-no",825659:"channel-dashboard",825970:"categories-sq-al-json",826354:"health-locale-id-id",827005:"html2canvas",827593:"health-locale-ja-jp",827947:"el-GR-UiStrings-json",827986:"sb-activated",828135:"meeting-room-console-locale-hu-hu",828178:"discover-surface-locale-et-ee",828582:"meet-for-work-locale-nn-no",828716:"extensibility-locale-th-th",828729:"share-form",828853:"video-message-locale-es-mx",828862:"esp-locale-tr-tr",829046:"esp-locale-hi-in",829122:"share-email-locale-mk-mk",829144:"categories-rm-ch-json",829311:"r_data-resolvers-browser-esp",829357:"meeting-bot-locale-hr-hr",829722:"data-resolvers-transcript",829782:"channels-locale-ro-ro",829861:"guardians-app",829881:"InformationProtectionStrings46",829955:"meet-for-work-locale-id-id",830590:"recurrence-locale-de-de",830683:"communities-locale-id-id",831e3:"sht-searchanswerteamsstrings_es-mk",831081:"otlang98",831192:"data-resolvers-dynamics-marketing",831251:"file-hasher",831367:"r_data-resolvers-web-app-switcher",831506:"search-locale-zh-cn",831730:"queues-locale-pl-pl",832023:"fns11",832057:"viewimages",833238:"health-locale-pt-pt",833477:"coach-report-locale-zh-cn",833637:"channels-locale-hu-hu",833665:"esp-locale-eu-es",833885:"sp-filter-actions",834117:"calling-pluginless",834322:"files-locale-vi-vn",834379:"people-targeting-locale-th-th",834425:"messaging-locale-vi-vn",834544:"webrec2-language-sv",834595:"data-resolvers-sensitivity-label",834652:"main-locale-nl-nl",834869:"biometric-enrollment-locale-lv-lv",835066:"onecamera-locale-gl",835208:"lt-LT-UiStrings-json",835241:"data-resolvers-browser-teams",835588:"categories-sk-sk-json",836010:"components-calling-call-handoff-screen",836720:"breakoutRooms-locale-mk-mk",836783:"meetingFlyout-locale-el-gr",836980:"coach-report-locale-ro-ro",837437:"cast-locale-id-id",838018:"r_data-resolvers-notifications",838174:"as-IN-comment-pane-strings-jsonOfficeOnlineStringResource",838195:"meetingFlyout-locale-fr-fr",838355:"biometric-enrollment-locale-zh-cn",838461:"esp-locale-sk-sk",838653:"broadcast-locale-ka-ge",838806:"people-targeting-locale-sk-sk",839412:"hostUxStrings80",840174:"r_data-resolvers-breakout-rooms",840177:"categories-bn-in-json",840596:"hostDefaultsStrings48",840684:"nl-strings-jsonThinRes",840697:"coach-report-locale-zh-tw",840879:"share-email-locale-sv-se",841140:"meeting-bot-locale-nn-no",841417:"growth-locale-az-latn-az",841746:"meeting-recap-locale-ka-ge",841795:"guardians-locale-ar-sa",841992:"hostDefaultsStrings44",842120:"channels-locale-fr-ca",842330:"pluginHelp",842564:"growth-locale-nn-no",842931:"wiki-locale-nn-no",843214:"aRes55",843532:"school-locale-lt-lt",843695:"meeting-bot-locale-lt-lt",843991:"growth-locale-is-is",844129:"InformationProtectionStrings61",844264:"meetingFlyout-locale-mk-mk",844596:"hostDefaultsStrings40",844871:"aRes32",845153:"search-locale-fil-ph",845241:"discover-surface-locale-uk-ua",845362:"categories-sw-ke-json",845483:"queues-locale-es-mx",845665:"sht-searchanswerteamsstrings_es-ur",845702:"categories-hr-hr-json",845871:"messaging-locale-da-dk",845906:"categories-yo-ng-json",846261:"otlang116",846266:"sht-topics-sdk-km-api",846532:"categories-bn-bd-json",846534:"webrec2-language-nb-no",846697:"esp-locale-lv-lv",846730:"is-IS-UiStrings-json",846736:"otlang112",847282:"survey-locale-lv-lv",847401:"r_data-resolvers-browser-teams",847663:"share-email-locale-fi-fi",847794:"discover-surface-locale-fi-fi",847834:"hostDefaultsStrings82",848129:"data-resolvers-live-state-broadcast",848170:"discover-surface-locale-el-gr",848219:"fi-strings-jsonThinRes",848506:"artifacts-platform-locale-nl-nl",848522:"webrec2-language-th",848588:"health-locale-en-us",848923:"semantic-object-locale-it-it",848937:"freemium-upgrade-locale-es-mx",848943:"categories-mi-nz-json",849120:"search-locale-he-il",849209:"lo-LA-comment-pane-strings-jsonOfficeOnlineStringResource",849378:"hostDefaultsStrings33",849448:"virtualEvents-locale-ca-es",849672:"sht-searchanswerteamsstrings_es-km-kh",849736:"esp-dialog",849761:"InformationProtectionStrings21",849810:"search-locale-es-mx",849899:"r_data-resolvers-contacts-sync",850175:"meeting-bot-locale-zh-tw",850366:"wiki-locale-id-id",850539:"communities-locale-ka-ge",850771:"InformationProtectionStrings11",850926:"pulsar-api",851710:"services-transcript",852443:"meeting-room-console-locale-es-es",852683:"people-targeting-locale-mk-mk",852943:"data-resolvers-meet-for-work",852944:"extensibility-locale-de-de",853084:"freemium-upgrade-locale-it-it",853223:"queues-locale-he-il",854022:"meeting-recap-locale-fi-fi",854314:"artifacts-platform-locale-hi-in",854515:"biometric-enrollment-locale-vi-vn",854668:"config-gcchigh",854937:"webinar-registration-app",854980:"school-locale-cs-cz",855200:"semantic-object-locale-cy-gb",855228:"meeting-options-locale-hr-hr",855308:"bg-BG-UiStrings-json",855320:"webinar-locale-cy-gb",855439:"webrec2-language-ja",855531:"meeting-collaboration-locale-da-dk",855777:"discover-surface-locale-he-il",855936:"categories-ja-jp-json",856130:"meeting-bot-locale-fr-ca",856330:"hostDefaultsStrings66",856532:"hostDefaultsStrings23",856693:"aRes8",856795:"extensibility-locale-ro-ro",857088:"InformationProtectionStrings15",857330:"message-escalate-dialog-locale-nl-nl",857441:"biometric-enrollment-locale-sk-sk",857495:"meeting-bot-locale-sr-latn-rs",857549:"InformationProtectionStrings19",857561:"cast-locale-kk-kz",858365:"r_data-resolvers-loki",858549:"InformationProtectionStrings67",858686:"guardians-locale-es-mx",858764:"r_data-resolvers-browser-audience",859019:"video-message-locale-mk-mk",859086:"r_data-resolvers-mtma-user-data",859746:"semantic-object-locale-tr-tr",860005:"survey-locale-sq-al",860319:"artifacts-platform-locale-cy-gb",860332:"onecamera-locale-de",860494:"hostDefaultsStrings8",860506:"fluidxOfficeFluidTypes",860639:"calendar-locale-pl-pl",860698:"selectmedia",860863:"audience-view-dialog-locale-ko-kr",861330:"hostUxStrings8",861386:"meeting-analytics-locale-nn-no",861440:"services-meet-for-work",861472:"meet-for-work-locale-lt-lt",861605:"fns39",861844:"sht-cortextopictypeswebstrings_zu-za",862108:"virtualEvents-locale-ro-ro",862136:"virtualEvents-locale-th-th",862151:"calling-debug-participants",862198:"message-escalate-dialog-locale-sr-latn-rs",862580:"meetingFlyout-locale-pt-br",862678:"aRes39",862982:"share-email-locale-eu-es",863185:"calendar-locale-pt-br",863199:"smart-device-locale-el-gr",863732:"biometric-enrollment-locale-zh-tw",863766:"smart-device-locale-pl-pl",864055:"bridge-migration-components-calendar-app-host",864274:"wiki-locale-el-gr",864422:"esp-locale-fil-ph",864438:"services-io-web-app-switcher",864466:"video-capture-locale-de-de",864502:"hi-IN-comment-pane-strings-jsonOfficeOnlineStringResource",864574:"ca-ES-comment-pane-strings-jsonOfficeOnlineStringResource",865129:"ur-PK-comment-pane-strings-jsonOfficeOnlineStringResource",865365:"data-resolvers-teams",865378:"aRes49",865398:"data-resolvers-msa-authentication",865414:"bn-IN-comment-pane-strings-jsonOfficeOnlineStringResource",865471:"spaddondeferred",865947:"video-capture-locale-gl-es",866188:"calling-electron",866846:"sht-cortextopictypeswebstrings_az-latn-az",867409:"meeting-room-console-locale-sq-al",867526:"main-locale-ko-kr",868095:"data-resolvers-transcript-settings-store",868123:"meet-app",868452:"InformationProtectionStrings33",868507:"data-resolvers-missed-mtma-notifications",868858:"pluginBareBones",869144:"share-email-locale-pt-br",869907:"otlang114",870125:"help-locale-gl-es",870246:"sht-searchanswerteamsstrings_es-cs",870716:"main-locale-hi-in",870723:"search-locale-hr-hr",870902:"message-escalate-dialog-locale-az-latn-az",870913:"calendar-locale-fil-ph",870950:"sht-searchanswerteamsstrings_es-lo-la",871288:"message-escalate-dialog-locale-sl-si",871409:"people-targeting-locale-es-es",871470:"communities-locale-es-mx",872484:"pt-PT-UiStrings-json",872501:"semantic-object-locale-pt-br",872564:"config-life",873166:"survey-locale-eu-es",873312:"calendar-locale-is-is",873316:"people-targeting-locale-zh-cn",873339:"breakoutRooms-locale-es-es",873507:"virtualEvents-locale-ja-jp",873523:"people-targeting-locale-lv-lv",873533:"components-screen-recorder36",874186:"InformationProtectionStrings0",874188:"files-locale-bg-bg",874906:"meeting-analytics-locale-uk-ua",875229:"MeetingNotesComponent",875230:"data-resolvers-app-ratings-and-reviews",875613:"files-locale-eu-es",875833:"hostUxStrings37",875873:"webrec2-language-ru",875985:"webrec2-language-prs-af",876003:"hostDefaultsStrings31",876138:"data-resolvers-biometric-enrollment",876240:"main-locale-th-th",876316:"meeting-collaboration-locale-eu-es",876378:"aRes21",876504:"coach-report-locale-ko-kr",876710:"sht-cortextopictypeswebstrings_bg",876813:"per-community-notification-settings-dialog",877174:"meeting-recap-locale-kk-kz",877233:"freemium-upgrade-notification",877357:"recurrence-locale-zh-cn",877414:"meet-for-work-locale-bg-bg",877725:"sht-searchanswerteamsstrings_es-ar",877837:"queues-locale-fil-ph",877869:"webinar-locale-hr-hr",878052:"people-targeting-locale-ro-ro",878713:"onecamera-locale-hr",878858:"otlang41",878864:"survey-locale-bg-bg",878981:"people-targeting-locale-zh-tw",879537:"aRes20",879629:"hostUxStrings15",879659:"video-message-locale-he-il",879833:"fns65",880184:"main-locale-es-es",880246:"wiki-locale-pt-br",880414:"biometric-enrollment-entry",880956:"survey-locale-th-th",881223:"help-locale-fil-ph",881275:"queues-locale-el-gr",881626:"r_data-resolvers-team-settings",881735:"video-message-locale-en-gb",881916:"channels-locale-zh-tw",882453:"aRes47",882880:"onecamera-locale-sr-latn-rs",882927:"otlang24",883254:"health-locale-is-is",883498:"sht-searchanswerteamsstrings_es-ko",883548:"services-meeting-questions-and-answers",883654:"broadcast-locale-hr-hr",883750:"onecamera-locale-vi",883819:"components-screen-recorder112",884265:"breakoutRooms-locale-bg-bg",884441:"broadcast-locale-ca-es-valencia",884766:"main-locale-el-gr",884843:"components-screen-recorder6",885976:"onecamera-locale-fr",886205:"data-resolvers-teams-and-channels",886793:"hostUxStrings83",886845:"platform-conversation-pane-container",887150:"otlang49",887434:"virtualEvents-locale-en-gb",887574:"data-resolvers-esp-target",887584:"aRes28",887811:"otlang68",887857:"freemium-upgrade-locale-ja-jp",888087:"r_data-resolvers-browser-core",888094:"otlang48",888394:"mr-IN-UiStrings-json",888409:"cast-locale-cy-gb",888441:"breakoutRooms-locale-sk-sk",889131:"live-interpretation-join-dialog-container",889483:"messaging-locale-tr-tr",889907:"breakoutRooms-locale-et-ee",890565:"recurrence-locale-sv-se",890694:"growth-locale-pt-pt",890868:"help-locale-fi-fi",891041:"meeting-analytics-locale-cy-gb",891234:"meeting-bot-locale-fr-fr",891546:"otlang40",891643:"share-email-locale-uk-ua",892617:"categories-ro-ro-json",892942:"sht-cortextopictypeswebstrings_mr",893098:"wiki-locale-cs-cz",893288:"webinar-locale-hi-in",893295:"messaging-locale-hi-in",893393:"services-pstn",893497:"categories-mr-in-json",893718:"hostDefaultsStrings39",893870:"semantic-object-locale-fr-fr",894087:"fns9",894598:"breakoutRooms-locale-da-dk",894766:"channels-locale-gl-es",895146:"artifacts-platform-locale-ro-ro",895195:"qps-plocm-comment-pane-strings-jsonOfficeOnlineStringResource",895267:"growth-locale-nb-no",895444:"sht-cortextopictypeswebstrings_lb-lu",895669:"meet-for-work-locale-zh-cn",895768:"people-targeting-locale-pt-br",895847:"fns5",895972:"meeting-room-console-locale-el-gr",896008:"hostUxStrings14",896317:"share-email-locale-nn-no",896555:"biometric-enrollment-locale-az-latn-az",896650:"recurrence-locale-th-th",896793:"guardians-locale-nb-no",897213:"ja-strings-jsonThinRes",897327:"virtualEvents-locale-sq-al",897526:"mw-shell-app",897620:"meeting-analytics-locale-id-id",897704:"biometric-enrollment-locale-nb-no",897778:"messaging-locale-pt-pt",897783:"ka-GE-UiStrings-json",897810:"ky-KG-comment-pane-strings-jsonOfficeOnlineStringResource",897962:"hostDefaultsStrings15",898261:"webinar-locale-es-es",898278:"hostUxStrings72",898471:"sht-cortextopictypeswebstrings_am",898701:"coach-report-locale-mk-mk",898724:"r_data-resolvers-mfu-contacts",898787:"cast-locale-lv-lv",899164:"services-sharepoint-client",899367:"data-resolvers-manage-tenant",900183:"meeting-recap-locale-he-il",900218:"r_data-resolvers-tfl-user",900551:"meeting-recap-locale-fil-ph",900675:"services-io-connected-calendar",900819:"coach-report-locale-lt-lt",900902:"sht-cortextopictypeswebstrings_gu",901383:"onecamera-locale-id",901510:"onecamera-locale-it",901530:"categories-es-es-json",901891:"r_data-resolvers-tfl-homepage",902016:"semantic-object-locale-kk-kz",902078:"services-substrate-meeting-recommendations",902600:"deferredcomponents",902970:"r_data-resolvers-communities",903024:"r_data-resolvers-calling",903301:"guardians-locale-it-it",903420:"hostUxStrings6",903584:"video-message-locale-nn-no",903632:"wiki-locale-da-dk",904115:"sht-searchanswerteamsstrings_es-am",904221:"hostDefaultsStrings20",904289:"semantic-object-locale-ja-jp",904615:"main-locale-ja-jp",904685:"recurrence-locale-bg-bg",905049:"webinar-locale-ro-ro",905058:"meetingFlyout-locale-ro-ro",905108:"virtual-events-app",905188:"survey-locale-sl-si",905224:"otlang13",905421:"meeting-options-locale-ja-jp",905440:"smart-device-locale-zh-cn",905462:"teams-and-channels-locale-kk-kz",905752:"categories-ml-in-json",905784:"wiki-locale-sr-latn-rs",906055:"files-locale-lt-lt",906854:"sre-root",906874:"sht-searchanswerteamsstrings_es-zh-hant",906897:"communities-locale-nn-no",906966:"sht-searchanswerteamsstrings_es-kk",906990:"main-locale-da-dk",907378:"say-hi-with-a-wave",907696:"webrec2-language-pt-br",907718:"kk-strings-jsonThinRes",909293:"meeting-room-console-locale-cy-gb",909664:"r_data-resolvers-message-common",910066:"fluidxOdspDriver",910122:"meeting-options-locale-cy-gb",910183:"fluidxUtilities",910562:"main-locale-ka-ge",910701:"growth-locale-fr-fr",910942:"sht-cortextopictypeswebstrings_ga-ie",911157:"messaging-locale-es-mx",911205:"gl-ES-UiStrings-json",911637:"meeting-analytics-locale-cs-cz",911846:"services-breakout-rooms",911969:"webinar-locale-it-it",912081:"r_data-resolvers-contacts-sync-banner",912671:"broadcast-locale-hu-hu",913271:"school-locale-nl-nl",913386:"splash-screen-image",913418:"semantic-object-locale-pl-pl",913749:"survey-locale-gl-es",914044:"people-targeting-locale-cy-gb",914091:"fns34",914590:"breakoutRooms-locale-sl-si",914629:"message-escalate-dialog-locale-ca-es",914682:"global-error-boundary",914712:"audience-view-dialog-locale-de-de",914743:"main-locale-ru-ru",915120:"fns84",915522:"survey-locale-lt-lt",917133:"camera-effects-panel",917692:"video-message-locale-nb-no",917706:"health-locale-fr-fr",917716:"fns24",917805:"fns70",917844:"webrec2-language-en-gb",918199:"r_data-resolvers-developer-switchers",918797:"ro-strings-jsonThinRes",919220:"audience-view-dialog-locale-hu-hu",919353:"survey-locale-fi-fi",919389:"wiki-locale-he-il",919534:"broadcast-locale-lt-lt",919778:"data-resolvers-esp",920058:"data-resolvers-activity-settings",920432:"r_data-resolvers-policies",920668:"meeting-room-console-locale-th-th",921777:"calendar-locale-he-il",921978:"calendar-locale-mk-mk",921979:"growth-locale-ca-es-valencia",922069:"help-locale-en-us",922194:"coach-report-locale-cs-cz",922761:"r_data-resolvers-brb",923200:"r_data-resolvers-browser-tenant-privacy",923449:"precompiled-wasmcv-web-worker",924251:"services-meeting-recap",924294:"growth-locale-kk-kz",924625:"fr-ca-strings-jsonThinRes",924820:"hostDefaultsStrings16",924860:"channels-locale-uk-ua",925312:"recurrence-locale-it-it",925375:"data-resolvers-view-schema",925383:"smart-device-locale-ca-es",925409:"hostDefaultsStrings12",925442:"survey-locale-vi-vn",925447:"meeting-room-console-locale-fr-ca",925580:"video-capture-locale-he-il",926094:"help-locale-sk-sk",926340:"splash-screen",926858:"messaging-locale-lv-lv",926884:"health-locale-de-de",926934:"services-discover-surface",926946:"video-message-locale-eu-es",927006:"school-locale-el-gr",927030:"meeting-options-locale-pl-pl",927075:"ar-SA-UiStrings-json",927245:"onecamera-locale-zh-hant",927946:"video-capture-locale-it-it",928299:"oneTranscriptPluginRoot",928400:"channels-locale-es-mx",928673:"sht-searchanswerteamsstrings_es-tk-tm",929087:"communities-locale-lt-lt",929118:"meeting-room-front-of-room-container",929813:"meeting-analytics-locale-vi-vn",929922:"teams-and-channels-locale-hi-in",930038:"data-resolvers-browser-calendar",930087:"data-resolvers-bots-platform",930217:"health-locale-zh-tw",930384:"ImmerES5Plugin",930972:"coach-report-locale-bg-bg",931063:"components-screen-recorder66",931811:"biometric-enrollment-locale-ko-kr",932610:"meeting-recap-locale-pl-pl",933139:"artifacts-platform-locale-is-is",933181:"msteams/data-view-schema",933346:"meeting-options-locale-nb-no",933611:"calling-locale-tr-tr",934060:"r_data-resolvers-teams-meeting-policies",934067:"prs-af-strings-jsonThinRes",934188:"meeting-collaboration-locale-nl-nl",934672:"queues-locale-da-dk",934882:"data-schema",935577:"cast-locale-cs-cz",935592:"otlang54",936333:"school-locale-da-dk",936406:"calendar-locale-nl-nl",936614:"queues-locale-id-id",936688:"school-locale-is-is",936934:"r_data-resolvers-browser-calendar",937102:"InformationProtectionStrings18",937398:"video-capture-locale-en-gb",937813:"sht-searchanswerteamsstrings_es-nn-no",937827:"communities-create-plus-dialogContent",938319:"r_data-resolvers-immersive-reader",938452:"categories-xh-za-json",938652:"semantic-object-locale-bg-bg",938699:"search-locale-nb-no",938968:"hostDefaultsStrings36",939079:"calling-locale-kk-kz",939090:"search-locale-fr-fr",939109:"smart-device-locale-fil-ph",939262:"data-resolvers-smb-user-intent",939387:"search-locale-el-gr",939724:"onecamera-locale-ar",940042:"share-email-locale-pt-pt",940125:"recurrence-locale-cy-gb",940782:"queues-locale-et-ee",941193:"video-message-locale-ka-ge",941337:"communities-locale-ja-jp",941445:"broadcast-locale-fil-ph",941684:"growth-locale-ro-ro",941787:"message-escalate-dialog-locale-fr-ca",941792:"growth-locale-hu-hu",942049:"video-message-locale-et-ee",942194:"sht-cortextopictypeswebstrings_af",942239:"broadcast-locale-uk-ua",942475:"search-answer",942595:"artifacts-platform-locale-fr-ca",942941:"coach-report-locale-vi-vn",943212:"guardians-locale-cs-cz",943505:"semantic-object-locale-lt-lt",943579:"hr-strings-jsonThinRes",943743:"sht-cortextopictypeswebstrings_ur",943950:"meeting-recap-locale-ko-kr",944013:"meeting-bot-locale-hi-in",944047:"calling-locale-he-il",944283:"aRes30",944284:"gallery-locale-en-gb",944706:"fns51",944731:"hostUxStrings75",944942:"otlang5",945024:"sht-cortextopictypeswebstrings_sk",945138:"school-locale-pt-pt",945170:"files-locale-id-id",945489:"growth-locale-fr-ca",945801:"biometric-enrollment-locale-is-is",945877:"files-locale-is-is",946067:"fns16",946089:"categories-pa-in-json",946283:"growth-locale-en-us",946342:"sht-searchanswerteamsstrings_es-sk",946712:"lb-LU-UiStrings-json",946838:"aRes34",947280:"aRes38",947806:"data-resolvers-suggestions",948066:"r_data-resolvers-chat",948195:"data-resolvers-breakout-rooms",948418:"sht-cortextopictypeswebstrings_fil",948550:"meetingFlyout-locale-nl-nl",948606:"sl-strings-jsonThinRes",948693:"services-item-crud",948715:"hostUxStrings5",949567:"compose-add-ons",949576:"r_data-resolvers-phonelink-sms",949619:"InformationProtectionStrings85",949742:"categories-ha-latn-ng-json",950104:"services-msa-authentication",950615:"zh-hant-strings-jsonThinRes",950636:"calendar-locale-ru-ru",950743:"sht-cortextopictypeswebstrings_uk",950747:"main-locale-bg-bg",950801:"otlang50",950839:"meeting-bot-locale-he-il",951582:"discover-surface-locale-sr-latn-rs",951654:"fns12",952102:"calling-custom-video-backgrounds-panel",952157:"audience-view-dialog-locale-mk-mk",952318:"wiki-locale-uk-ua",952344:"main-locale-cy-gb",953154:"webinar-locale-zh-cn",953228:"share-email-locale-kk-kz",953303:"discover-surface-locale-az-latn-az",953361:"fns7",953578:"virtualEvents-locale-fr-ca",953598:"fns3",953668:"help-locale-zh-cn",953871:"cs-CZ-comment-pane-strings-jsonOfficeOnlineStringResource",953993:"main-locale-is-is",954009:"gallery-locale-cy-gb",954578:"channels-locale-fr-fr",954603:"otlang34",954964:"health-locale-et-ee",955264:"data-resolvers-collab-cloud",956010:"biometric-enrollment-locale-sv-se",956081:"lo-LA-UiStrings-json",956097:"nn-NO-comment-pane-strings-jsonOfficeOnlineStringResource",956210:"coach-report-locale-es-mx",956343:"components-avatar-quick-picker",956357:"meet-for-work-locale-kk-kz",956633:"esp-locale-ro-ro",956641:"meeting-options-locale-ru-ru",956867:"sht-cortextopictypeswebstrings_gd-gb",957156:"sht-cortextopictypeswebstrings_sv",957302:"sk-SK-UiStrings-json",957625:"r_data-resolvers-coach-report",957796:"webrec2-language-nn-np",957900:"extensibility-locale-az-latn-az",957960:"meeting-recap-app",958076:"meeting-room-console-entry-container",958163:"apps-platform-service-enpoints",958359:"meeting-analytics-locale-et-ee",958636:"fns47",958646:"discover-surface-locale-cs-cz",959048:"esp-locale-de-de",959139:"apps-files",959151:"main-locale-sl-si",959258:"share-email-locale-es-es",959362:"onecamera-locale-cs",959684:"communities-locale-az-latn-az",959752:"freemium-upgrade-locale-hr-hr",959860:"search-locale-pl-pl",959930:"guardians-locale-uk-ua",960100:"biometric-enrollment-locale-mk-mk",960185:"r_data-resolvers-browser-chat",960430:"sht-searchanswerteamsstrings_es-mt-mt",960489:"queues-locale-eu-es",960778:"hostDefaultsStrings53",960988:"recurrence-locale-zh-tw",961038:"share-email-locale-zh-cn",961074:"guardians-locale-pt-pt",961235:"guardians-locale-fr-ca",961320:"meeting-options-locale-fil-ph",961331:"main-locale-sq-al",961543:"calendar-locale-sq-al",961702:"freemium-upgrade-locale-az-latn-az",962139:"teams-and-channels-locale-tr-tr",962294:"guardians-locale-fil-ph",962351:"broadcast-locale-pt-pt",962382:"broadcast-locale-it-it",962457:"broadcast-locale-eu-es",962476:"calling-meeting-options-label-downgrade-dialog",963433:"help-locale-lv-lv",963825:"files-locale-fil-ph",963835:"growth-locale-bg-bg",963957:"messaging-locale-et-ee",964068:"playbackRegion",964070:"categories-as-in-json",964110:"meeting-room-console-locale-az-latn-az",964278:"data-resolvers-os-file-share",964536:"queues-locale-ro-ro",964702:"r_data-resolvers-browser-live-stream-rendering",964750:"InformationProtectionStrings58",964754:"extensibility-locale-bg-bg",964944:"km-KH-comment-pane-strings-jsonOfficeOnlineStringResource",965028:"mk-strings-jsonThinRes",965041:"gallery-locale-ro-ro",965579:"he-IL-UiStrings-json",965851:"chr-Cher-US-comment-pane-strings-jsonOfficeOnlineStringResource",966725:"esp-engine",966761:"otlang66",966963:"qps-ploca-comment-pane-strings-jsonOfficeOnlineStringResource",967498:"r_data-resolvers-activity-settings",967658:"school-locale-et-ee",967742:"files-locale-ko-kr",967847:"broadcast-locale-fr-ca",967953:"artifacts-platform-locale-cs-cz",968640:"cast-locale-pt-br",969198:"InformationProtectionStrings69",969345:"meeting-collaboration-locale-is-is",969417:"packageAnalyticsAssets",969706:"wiki-locale-it-it",970167:"meeting-collaboration-locale-kk-kz",970245:"components-screen-recorder50",970265:"breakout-rooms-pre-assign-dialog",970357:"meeting-bot-locale-nl-nl",970421:"components-screen-recorder58",970498:"freemium-upgrade-locale-zh-tw",971592:"meet-for-work-locale-th-th",972258:"smart-device-locale-ka-ge",972297:"extensibility-locale-nn-no",972463:"queues-locale-en-gb",972572:"otlang39",972642:"sht-searchanswerteamsstrings_es-zh-hans",972925:"sq-AL-comment-pane-strings-jsonOfficeOnlineStringResource",972944:"be-BY-comment-pane-strings-jsonOfficeOnlineStringResource",972986:"meeting-collaboration-locale-en-us",973142:"recurrence-locale-nb-no",973649:"otlang31",973698:"otlang35",973736:"sht-searchanswerteamsstrings_es-et",973771:"meeting-recap-locale-ca-es-valencia",973938:"help-locale-pt-pt",973956:"meetingFlyout-locale-es-mx",974237:"meetingFlyout-locale-zh-cn",974471:"biometric-enrollment-locale-lt-lt",975145:"data-resolvers-desktop-client-shortcuts",975499:"data-resolvers-coach-report",975504:"survey-locale-sr-latn-rs",975651:"card-shared-header-ux-wrapper",976003:"data-resolvers-connected-calendar",976025:"hu-strings-jsonThinRes",976217:"help-locale-de-de",976260:"data-resolvers-apps-monet",976486:"sht-cortextopictypeswebstrings_ar",976738:"hostUxStrings68",976808:"services-report-concern",976940:"channels-locale-mk-mk",977090:"meet-for-work-locale-ja-jp",977153:"broadcast-locale-sr-latn-rs",977511:"sht-cortextopictypeswebstrings_bs-latn-ba",977540:"wiki-locale-ko-kr",977570:"pl-strings-jsonThinRes",978433:"recurrence-locale-pt-pt",978537:"meeting-options-locale-sq-al",978641:"calendar-locale-tr-tr",978848:"designer-mini-popup",978981:"broadcast-locale-ru-ru",978994:"breakoutRooms-locale-ro-ro",979019:"meetingFlyout-locale-uk-ua",979307:"webrec2-language-es-mx",979355:"calling-locale-nn-no",979533:"otlang9",979753:"message-escalate-dialog-locale-nn-no",979948:"r_data-resolvers-meeting-intelligence",980117:"main-locale-fil-ph",980126:"ja-JP-comment-pane-strings-jsonOfficeOnlineStringResource",980799:"smart-device-locale-nn-no",980839:"broadcast-locale-sk-sk",981578:"jszip",981879:"semantic-object-locale-fr-ca",981900:"otlang55",982110:"components-stage-view-entry",982175:"pluginInteractivity",982265:"tr-TR-UiStrings-json",983017:"calling-locale-ro-ro",983089:"help-locale-cs-cz",983695:"meeting-options-locale-az-latn-az",983906:"meeting-analytics-locale-sq-al",983999:"discover-surface-locale-da-dk",984299:"meeting-bot-locale-is-is",984324:"meeting-collaboration-locale-sk-sk",984335:"data-resolvers-user-license",984360:"freemium-upgrade-locale-es-es",984597:"ac-experiments",984964:"meeting-details-editor-area-v2",984975:"guardians-locale-bg-bg",984982:"meeting-recap-locale-nb-no",985340:"meeting-analytics-locale-fr-ca",985381:"esp-locale-fr-ca",985550:"search-locale-th-th",985653:"aRes36",986639:"data-resolvers-channel-messages",986892:"pluginWebAppAboutVideo",987110:"health-locale-fr-ca",987311:"hostUxStrings39",987927:"services-io-azure-maps",988486:"queues-locale-cs-cz",988558:"teams-and-channels-locale-gl-es",988681:"main-locale-sv-se",988876:"meeting-room-console-locale-ca-es-valencia",988909:"channels-locale-zh-cn",989139:"esp-locale-pl-pl",989419:"r_data-resolvers-suggestions",989465:"video-message-locale-pt-br",989537:"hostDefaultsStrings7",989676:"semantic-object-locale-id-id",989689:"data-resolvers-guardians",989829:"services-loki",989847:"breakoutRooms-locale-pt-br",990477:"extensibility-locale-gl-es",990500:"hostDefaultsStrings28",990708:"communities-locale-vi-vn",990963:"data-resolvers-browser-audience",991457:"data-resolvers-tfl-user",991487:"messaging-locale-ja-jp",991596:"school-locale-fr-fr",991941:"meeting-room-console-locale-he-il",992029:"sht-searchanswerteamsstrings_es-ca-es-valencia",992037:"onecamera-locale-pt-br",992326:"hostUxStrings46",992338:"smart-device-agenda-page",992480:"message-escalate-dialog-locale-cs-cz",992680:"webinar-locale-eu-es",992784:"esp-locale-nn-no",993088:"et-strings-jsonThinRes",993207:"message-escalate-dialog-locale-el-gr",993305:"health-locale-eu-es",993348:"meeting-bot-locale-en-us",993376:"services-io-calendar",993820:"search-locale-en-gb",994009:"sht-searchanswerteamsstrings_es-cy",994411:"broadcast-locale-tr-tr",994623:"growth-locale-he-il",994785:"help-locale-sv-se",995052:"teams-and-channels-locale-nl-nl",995278:"r_data-resolvers-cross-tenant-policies",995582:"help-locale-nb-no",995682:"people-targeting-locale-ar-sa",995859:"biometric-enrollment-locale-es-es",995954:"fluentMtc",996137:"data-resolvers-browser-1gql-view-data",996357:"message-escalate-dialog-locale-hr-hr",996449:"esp-locale-hu-hu",996583:"discover-surface-app",996696:"teams-and-channels-locale-sr-latn-rs",996708:"msteams/components-meet-now-panel",996736:"meeting-bot-locale-tr-tr",996802:"webinar-locale-ru-ru",996866:"queues-locale-nl-nl",997071:"meeting-recap-locale-ru-ru",997083:"categories-gu-in-json",997203:"message-escalate-dialog-locale-kk-kz",997267:"fns57",997378:"docx",997494:"message-escalate-dialog-locale-mk-mk",997686:"calling-locale-az-latn-az",997758:"extensibility-locale-hi-in",998474:"r_data-resolvers-implicit-contacts",998529:"meet-for-work-locale-gl-es",998813:"virtualEvents-locale-cy-gb",999114:"health-locale-ru-ru",999200:"fns49",999323:"kok-IN-UiStrings-json",999856:"apps-platform-data.mock",999918:"aRes54"}[e]||e)+"-"+{9:"c0c8f4fc89491ea3",145:"ac66e1a2bb18ca2b",229:"a90d266563b18fcd",253:"a365aa82ad740e0c",470:"19583ddbcdff7859",595:"2d076605816e3bdf",673:"9b674b2b82147544",749:"6d998a1b6132b479",1091:"8d95a95e37c2a16d",1129:"c10288405ab31559",1215:"a3dcadecfdb0d4ad",1264:"ecf88f5a5a5e9634",1440:"581b33f5dd6d0ab1",1474:"c7827f9247b58eca",1496:"046aa3c1a55f7df8",1586:"1ddee7d7042a0bcf",1954:"0dddea30a5e723a2",2122:"15a7f780e98f4f23",2147:"badfbb6219b7cbab",2308:"f0805c954ffccdff",2784:"a886fc91a7586979",2800:"e27a1283c7649ac3",2951:"a11f1aa41b21fcdf",2953:"05994c6a561f42bb",3071:"de566c6899e3887d",3813:"ca80b2c9538d6577",4128:"ba272a96f47a567c",4387:"60c3b427eb11c0eb",4452:"16972ccf6e891b90",5351:"1a3694134ceeb4fd",5353:"701117d06a9a0ef3",5748:"d02bc32f1b0712ca",5820:"d88ffb3688e1fbb7",5895:"5ec18e65b87c0024",6373:"95b56e745ce7737e",6431:"605844c0592377ba",6788:"451e029795734f17",6938:"55662a7cbd21ab7a",6942:"e1218fd9b1ecc021",7169:"e02cc5c001f38971",7263:"0acf1b18a5a11510",7616:"a454c9228e9bc3d5",7676:"2aa5d37e593a79bd",7696:"1b81273e50bad0fd",7813:"3fe4e6fdfa155444",7850:"ef595e627b3025b2",8049:"32b012e3f5e9978f",8074:"ccc952941f01cdf2",8118:"15dc0635c2ee6838",8275:"4bc8cd70131ffa3c",8806:"6ea9fae8dbdb6dcd",8809:"2b907693cf6d00c5",9014:"ebc6091d2a0d12b7",9143:"0f455a16dd67e2d4",9265:"b92975b749db0d66",9469:"bf6acf51ae1518bb",9590:"6082ee920fe07ed3",9691:"21b425830af17d57",9886:"a0bb22625f2a0505",10143:"3ecb846132395fa1",10186:"2bbb39cc2d5a954c",10203:"d2b776a9ac399601",10236:"0246997e0d6697c2",10567:"723d55d2e38daeec",10649:"7d4adcdf8ca463ae",10675:"de8877e81d7a5d04",10722:"39eaab054919e0d0",11125:"46db385e7ac0315f",11189:"f2e4e22645f6a74a",11495:"46a889f6d4862744",11827:"3d3d530b0e499351",11957:"0e0c7bee748d9d5a",12359:"dbe2d16cb4984403",12440:"45e461ed57a5baea",12535:"339a6f2d24164daa",12549:"5b8509c03977b953",12638:"44b116a3b3b8da17",13168:"34ec6b83d7396a0a",13529:"8825ddc20e3292a2",13752:"becb2fe9773646ee",13753:"07e095eb39e02bf9",14743:"c34c37fed05426ee",14787:"f63702033263ad9d",15028:"8f6dbbde9014d24c",15257:"2a3dd32d2ddb2c5a",15943:"139d2635f8342389",15965:"f6c2f637579d35e9",16014:"ce40f5a84286fe23",16083:"70a401478d69cecb",16284:"11bee4ccb9eac5b7",16487:"1386b03d6f53f426",16571:"db6cde7199e69b9e",16746:"a6150cd9b58b78e3",17002:"557fa00083ec9f5d",17297:"27ec6eaad416a95f",17342:"abbaa85b5e70fc29",17624:"57d33a1a017da444",17984:"2d3ffe95dc6a2ff9",17994:"ab2556abe5a25ffa",18648:"4aeaf7157f08477e",18846:"6650780eb0ce722b",18898:"a39415a327238d21",18950:"8a948d18b566ae31",19420:"b61edb5bf922c585",19753:"23029ff11c2d5569",20110:"5de1cd3d7453047a",20274:"63f6062d52573c20",20538:"6e5c025b07cd90fb",20702:"6ceae983e5404744",20998:"085c07bf7f1bc32b",21033:"3f41a73de9041a2a",21390:"76a142d7fea1b72d",21514:"c4035734698c12dc",21541:"4cdb3d9d2594ea81",21778:"b8e30b1f0297312a",21829:"93ce15921a4803fd",21868:"0bb7b17e221e59d5",21933:"40069323b3d65ed4",22463:"30725e3474bac6b0",22670:"489f6e263013d699",23020:"b92e4c8a8ab64a92",23169:"1d37369ea69a1793",23186:"aea2a8db855a5f21",23200:"c28bef1278661594",23280:"650f7b1700c77925",23363:"adabf63eb315fc69",23702:"8cac0b9b69e883b1",23762:"8e73575b884088b0",23989:"ef9d1b89f063108d",24149:"15fb36ce73be3f8a",24260:"ed2e8e1eba4bfb65",24493:"a0a0462f4aef4984",24516:"43ab6f181169cc85",25121:"785fb9bff2b88de1",25256:"cf3af27f43a29ef1",25350:"49a901da97684c2a",25754:"24c52caa8a745e5d",26025:"35d4b7721c3c3f06",26205:"dd58b37c4ad9a271",26444:"6d8d81f48ead5422",26525:"2bd72172cee4b8cc",26610:"88e7e9a561cd23e1",26914:"435ff4f869e3c2d0",26960:"27de60948c87766f",27018:"1b2d3fce955be63f",27069:"f25a8119b777e205",27133:"a7106c10fac84536",27214:"c4626feda37d460d",27890:"d80884bdaf998cde",27922:"6840d7d3fdf154b4",28242:"18f630dbe011ad19",28469:"af268bcad519c661",28489:"cd78d50576bf7cb3",28812:"f54f6320a9a97a21",28921:"6c61c1a6271be901",29290:"204feccaf1274c07",29311:"803c9963146e227c",29475:"4007b840cfc7830c",29780:"8a50fc568003e057",29942:"b1ab5adf8dbc89b2",29945:"1ce25db543a5b880",30018:"2268f50bff47ef39",30206:"768f50ffc46a2c5f",30236:"e77948dca1f2e6e6",31597:"66df710d4fa1c829",32034:"58b1df67cb20dfce",32085:"3ea09b1624994c69",32966:"1e2976f61e27acc6",33172:"72aee09eae28345c",33925:"899cc2d93104b249",33987:"e8ecec7da1e3325d",34027:"19d6996482aae187",34096:"6a624348a1e03205",34422:"efdc583781838a74",34471:"37f8717c5c47a2ee",34693:"bbdf926928003e96",35309:"cae5ab298cb88ab5",35575:"24fe18330fd13e45",35795:"5004166b1dc6a0d4",36003:"346251f06d1b3a5a",36018:"55ded2f1990e0cf1",36540:"97a51b0ffbcd35d4",36552:"20116d280e4281ea",36644:"c5373788c84aea77",36856:"ef886fd65e44507e",36947:"9dbd17eed0d8d002",37131:"4dd1d470910c2858",37288:"240c5ac1ec6b5a24",37342:"b9ff7bb8dedb10a5",37364:"da920d6be5f94c84",37435:"ca21c736370d1504",37436:"ba6f712651a623fa",37514:"db67944c29266008",37689:"a71a0fc36f0d36fb",37811:"98eb686e30414584",37888:"47e40463f0c9eaa7",38021:"7ff305f882bf944e",38534:"a335d21eeb95f5c9",38756:"0d23530d9c2b3bef",38920:"2e0005de2877b4b5",39061:"152f76aed17ccc92",39084:"730ee5baa5b13084",39307:"ac0ad68cd3edab62",39840:"2cd8ce063da226bc",40416:"b7bc5e807b869c3c",40826:"e17c2fd631c0f106",40840:"5783e5698dbba63d",41050:"1a71a1951234294a",41547:"aaf9632bab6e9f4a",42044:"0f8dce2e32d99276",42119:"9f81bb3d09a992e8",42279:"1f28cb91413fe0cd",42388:"d1452b0db537e484",42754:"b720e5a82efb60d2",42849:"af66bace1678e830",42869:"70c352861ac20a79",43136:"e51775b4bef373be",43242:"89605b3d4d4ed811",43342:"269cbdb2f2614c3d",43597:"7ad7656b2cf4c098",43826:"9e8178c1f68bcbce",43983:"ad1f72a006a5be13",44292:"9744462b71edf17a",44565:"b1042955ddebb904",44586:"cf52090e6f335e80",44699:"8b4b70471ed34189",45029:"b7d17a440117e859",45157:"4c380093d3a40fbd",45196:"5141bd950fb24499",45419:"b7a133268a376a78",45930:"58367d0dea4411eb",46148:"a18aa54095dcaf57",46436:"4c34d8e778c5fa29",46510:"5c79e162546bf18f",46563:"b20c4890d2187a1e",46926:"1af02815aaa6207a",47064:"e3536db7db8bba0d",47331:"fea729da23748b49",47423:"202bafd0067e847e",47639:"42c2fef1cc5ab980",47761:"5b6beff56f964970",47838:"c251c38b9a32eab9",48623:"563d04415713b07c",48839:"7492dce42cdbd8d7",48904:"3eb462ba1bed0b24",49087:"0436bb19a6af0bb0",49209:"0d99e0e95a66010e",49750:"f11c7861c6cb4ac3",49863:"9f64f3ee9d2baa6b",50206:"61792191e3fe0390",50770:"3ec6fb611ad68b7a",50886:"7bf67b4d75b9936c",50906:"7c6328537bccb54d",51093:"c68fda9ae0d052c3",51246:"7f4922dc01bb097a",51260:"e6f2d4cead0c12c8",51295:"72991a982c4c6874",51397:"b4be09ad4e0a9d1a",51404:"bf236e23e2a102bb",51539:"e48897466db6a9da",51566:"0cebbd976ba7b221",51594:"75d28de352d13ca5",51704:"b6ebfb6991782602",51796:"100f44d09579582f",51976:"e6e1d358bdea7efd",52144:"5d622188dfd96f14",52407:"b3eec2979b725003",52455:"6fb4b12cb4c65366",52642:"2bef41235d3b4365",52647:"57150fc5bd502960",52671:"a5adfdfc2e03883b",52876:"f706db8e212c5c4c",53108:"82fdbbfff3a9216e",53222:"43fe17b7f0b9f491",53393:"922eb6f9d7c1373a",53586:"64165cf4d71c0bf1",53615:"5b5450ba81918d62",53807:"8baae9d08dd1430e",53866:"4e27ddb56efce24b",53971:"b6dbd38901084171",54014:"2fbe83b00c1bf039",54180:"fac42bfa5299b6da",54436:"25dd6f8402a75040",54541:"e6e75ad22071f17f",54567:"6cef07d6c6176aa0",54570:"72d8a57fca24d894",54715:"4ff27961a29936b3",54739:"95800a8a0bf6f7fa",54889:"445b5959561a093d",55028:"5726ca0f7981a48c",55029:"1967909e9854110c",55091:"704e56856f9ca418",55452:"90f5e187d401c15f",55579:"22f0b3b8df24ebc9",55678:"74a446ae4f6d8b55",55851:"81019f6ae3dd477e",56448:"e97f0ca2d5ff47c5",56481:"233b87137a4e350d",56712:"e30b355bfff800f2",56738:"8171f63ad3b3e6ac",56759:"09437ea2ae9f444c",56947:"42aa63b0bb177dcd",57020:"32979b506e604c43",57048:"cb9c47857d0b54b7",57069:"a0de7e687a61051d",57164:"20335471906676fe",57245:"3b2821ff43865347",57264:"2410b791a941b275",57368:"1e5865c7d9c29c6a",57510:"6777c0f942ae7f81",57610:"d1839cd3c17223f9",57746:"7899b7008ed650a8",57896:"a7937aba27a0fad7",58032:"2363bb42f6e5e8ce",58089:"1173776117ef5cf5",58267:"44bd935d41865c98",58377:"016d88d94bb277da",59106:"9253685538ece488",59242:"929f82edced66e6a",59616:"4d0caf1bc426f5b4",59797:"401babc2ef5f84c1",59959:"53fc974f151bb9ec",60088:"2d64def7f0801b57",60123:"02346c3e82c8391a",60441:"161802683655028b",60504:"a4edb81e5feceeef",60684:"416be158a3ab64f9",60785:"9fd7caeec6637b2d",60982:"608754c639541d2f",61033:"9d30eeeb533d9e3c",61145:"09f1dcceef01bd27",61286:"79887325486dd6ec",61518:"1168aaeef442046c",62035:"b4f52a8a7cdbe734",62585:"8e2a0aae1322c1ff",62665:"dfd9b54144603116",62713:"b45935a45efc43f0",62772:"6f841344d19dcd23",63007:"a95e98d74031401e",63009:"e82d5c737a100a96",63235:"2ef77302e578e5b3",63335:"de55955a4ece93c9",63364:"a8fd66a916637eab",63366:"87f22327ec54647d",63434:"efe7b548bf2f2923",63810:"40a90b6ef981fa78",64108:"61ce062cd27842b8",64113:"76baec01ae2bce00",64279:"86b22ad557df9d63",64620:"920e8c412eb98cae",64729:"3f7c6b6df299727b",65647:"944a4b5e163ed314",66204:"ff625ae75d38c980",66235:"1b161ffb42c19a01",66424:"1d582aad17c874a2",66571:"34bec7d54d4e2293",66736:"2328c5453a83cda0",66799:"f710076d73482fa4",67131:"bf2bbc906626ad48",67738:"358de75811987ce4",67818:"21af1edf8667ae1a",68057:"b1ed6ed2fedf083e",68074:"4bdcf812d57b4d4e",68101:"77925c85089a4d98",68400:"ef12080b07f06bb4",68516:"21cc9b7f269f7b7d",68597:"1975fc2207419291",69006:"4f8d5723f8d06b3b",69177:"9a575ae42a2fed11",69195:"0b7f4527ddf7a79e",69605:"cfefb337a374b00c",69752:"f436ee56b9018c01",69813:"3a77fb68ea445d24",70849:"7426eb86de562f6e",71021:"5e504f5cd43d3df9",71053:"73a6b9e46d19321f",71856:"1f97e68ba4424760",71948:"02fd37481cc4b661",72011:"85ba5b3d5d094456",72333:"082279493a96e2c3",72638:"0c77d24543e994a0",72744:"e08aa76534bac787",72767:"043bcfa4dcb8dbf2",73206:"93042e0b66367534",73540:"fec807700cc4104d",73825:"96b321db57fb6009",73826:"df9585cc26f9a075",74006:"abe73adde4411733",74120:"cc874df1ed9e76e0",74747:"fa71229b9bb2c6bb",74801:"ec0f99f6c8e45d48",74837:"efe16a4bd1ef6bf3",75296:"c19f873c52edaa19",75402:"458816f60e30e253",75413:"5b1e07b760e9f238",75667:"3e1c4cefd6feb8d5",75810:"aeeacfff25096412",75818:"1da23b77d2f7ca38",75895:"29d24dd3346bb070",76057:"ef2c8d6030028257",76118:"7bca060a48a90404",76141:"d2de55a175c6cc7f",76197:"7d5d4adad7ca159e",76441:"72fe4072df549537",76605:"03658b1ab1832fae",76961:"554fe80ee375738d",77183:"5d94065247c1046a",77677:"9cfcd6a1e9ff3463",77741:"4dc7099c3a91ba0b",77771:"5aa1d8d9cb35b3cf",77772:"f1f6f2327e427dca",77960:"3ab4c57d49e342b2",78084:"24b2178d13ef33b9",78594:"f4b4f09310ed25c8",78623:"4758f8c9402730a2",78733:"655114c4ef98004e",79131:"a3fa1c8ab5cfbc89",79156:"24600957a55bd5dd",79297:"97cc9d5a2467bb19",79443:"45dd20dfc984d3e7",79455:"5106d99e8f042a85",79506:"07866d887b2da32f",79613:"83c4efc2eff0b680",79803:"cc6d8eb60f5e4c00",79882:"4dc15172b1b45df7",79889:"8ad8dd5e5c9fcd3a",80070:"25f3fbc448251845",80129:"674637a9046ade66",80262:"4debd9b01dcfe283",80275:"1271cdd4873273ad",80319:"30ce359d105091b2",80516:"4e0d5735cbbcc339",80793:"e29b365c91dadc93",81188:"6ebeee0846842136",81481:"bd0abf36396bd40b",81831:"e68a5de16ba7e2b6",81939:"aa82b2b91ac7874d",82023:"caef539ef59c650a",82329:"01936eb46bf64b73",82749:"d9cc8269d0de853a",82870:"06ee2b5f836574f8",83458:"f2a7a1e95085b480",83644:"a0e48c20e1f1c531",83772:"838b8b16ddb1c448",83795:"f61c2b4e84614f60",84042:"c5964a8e9909c838",84226:"c9020680d334b01e",84349:"61036149a0b46729",84399:"2fa54e65bdb09ba6",84765:"27ac22bec642ea3f",85135:"0ac403095e9f9edd",85421:"79cf0921b3797d1b",85637:"943c05a5298e672b",85677:"c017bc96f5fe3767",85993:"4cef503b86c5effe",86091:"7ec74d16d3106175",86142:"92770937a1b634e5",86262:"963abe9ed5cba5bd",86416:"dae32f338b382084",87237:"f5cab965e05edbe5",87306:"a518725b6922c0d2",87360:"dc93a1449dfb0f44",87417:"e8cbf22a55f925c6",87547:"1f89df4bcd5364a9",87562:"5171927f252a87c7",87607:"ad6cc9a34bcbe988",88137:"7ce6c2e846b18db1",88343:"2d573217f2113488",88478:"e337435db7b3bedd",88553:"acc3d42d4daf2af1",88926:"6699e7f774a4f9aa",89043:"c4cb3b1b8d144389",89107:"c57ac289f2fc9419",89798:"02b92d04a35b8d61",89905:"3999bd923606fb09",89997:"d10bae5fc32f1d8c",90045:"6223872f6f7bfbde",90082:"197d4eb844442467",90109:"7a5d8af43727a339",90237:"a9af7144e145378f",90424:"63cf8ee79e717d88",90606:"9e4f5059175efb02",90884:"88dc8043e6756d5e",90972:"f4c74063545d0e88",90999:"26cb7f6a5e950804",91078:"e92f30034dcbeeb0",91135:"43dd0c3a80062d9f",91143:"e89a4d397ac88b3b",91706:"5d835294bf33499c",91759:"ff9f5d14a4cb56cc",92285:"04a3a1468ebda56a",92481:"54bd05a3a4b0b013",92525:"5c312acafa7e67fe",92567:"74b8500213709aa5",92598:"cb27ee493e3aafe6",92700:"0ff7ac158b2809a4",93048:"ca663323592ab81e",93050:"fc7919971868203b",93241:"ec65d3aa9bf53066",93332:"409fa268497a8cd4",93413:"3d64ec4e5c051a6b",93564:"534cbee14fc9605c",93760:"cc5d6b328a1a8f6f",93939:"94a08e2996b922e9",94119:"c91233b118bdc6ca",94155:"ba2bc3257018e6d9",94341:"a4f39098ed29ef02",94444:"b876ac254ceaa6c9",94451:"83d6ad336ed9b0a6",94462:"0bef1e134a5b483f",94779:"bf9ad7d4ad14a6c5",94954:"0a2511fa68d2da63",95213:"47bfbbb5222e7a66",95235:"cf6ad195b9f4942b",95339:"1f5b57ef983ba04e",95341:"5eb9cb2434eae485",95465:"a68ce30b6a26d289",95468:"c4593f651265b138",95683:"806c8e1feffc9953",95844:"53f5a634b1dbba2a",96148:"82a27202fd1513ed",96314:"32e646372ab7f1f0",96380:"4b69ff19f54a1d5d",96601:"240368a42ae6673c",96698:"fd769927e6164670",96977:"029f8e958aaba6e5",96978:"d6babaa298c26579",97158:"ac65cfaf10222811",97202:"36245ab18178a2de",97431:"55590d45a7b5a431",97596:"c6cbf51e9e7d0878",97897:"a1ca8841c25024ca",98208:"c410a55fe3334a41",98217:"0cc9850aba103bf5",98289:"fc064f53e7364295",98687:"a01adeaeae701717",98720:"65b0fdb03716c56f",98725:"9ebc5162879bdbe3",98790:"143cce0e0be4ff73",98857:"82569b0011a60a30",98889:"3450d51f50dd8d00",99252:"6a74ded49e017a6e",99504:"833078019b74d5bd",99592:"b2fc3fd8a148f233",99598:"21b40781953e4163",99641:"bdc0fedb48129e45",99728:"d6254ed60df61e89",99951:"88cd25304bbdfe52",99986:"c9a70a3445405117",100240:"3aed89c009801c30",100390:"9c60a58bdea27261",100545:"5f6703ad7e826314",100588:"e3141cc740b144b7",100598:"a0dad837f36ec037",100741:"49c1ccbcddb53e08",100822:"d26c3752d302dc1a",100834:"0471c000c72e6faf",101026:"90d07c3f9a5b1a65",101243:"20c4aaa13a3a76ce",101345:"0a0664f5434d4f02",101573:"f46c52a021094f33",101659:"d5008af4b555a3d9",101989:"14b8372c0e3a9632",102060:"7dd1a44cc9e00047",102138:"23d40d0ca36ce504",102479:"5ad93e840cbae934",102559:"5426c8a4fe3e5187",102701:"3e3ecfb4f30a3b88",102771:"d1df9239302ca603",102774:"3a7a460985163648",102893:"4e577d95ecb71bd5",102943:"2f8a05e90fbe9e8e",103232:"f8c08c5d0673eae4",103568:"4c112285014a3663",103640:"1e0c3281d209b446",103842:"9a909ec2f40d75f8",103972:"1cd105268bae1ef9",103998:"77f0919a994c01d6",104010:"b3d0f84b357e75db",104346:"18cbe56d126b268f",105053:"d85429bd5685a636",105082:"ab7ccecd02e8b34b",105183:"4d6d37361f5cbc00",105578:"aeb49bfb81327007",105632:"80088e26bad08db0",105672:"000ce7f0fad1906e",105880:"e7fa00ffd3b57b9f",105887:"6d1e6da96c7ced9d",106312:"e4b7a7bf90183b3d",106428:"494696fde38a5ef2",106652:"f6feb0eb29f7239e",107052:"660a71220633aa8f",107215:"2b9c43b6da3cb17e",107458:"05eb8c748ee862db",107523:"5459e6c110d56a37",107684:"e53de56886159484",107832:"a4b1aff7938ee5ae",108224:"a0c25fbae6ed1bf5",108418:"aace94e0ed2e9fa4",108525:"65e0e8f322e7f1b8",108609:"cfc5253ce3428997",108725:"d720eb2405c5ccd5",108897:"07d06c38a3ff3154",109030:"762d1364974acf74",109505:"b84b1f5d6ebfb86b",109545:"3e467341d20ac7b8",109582:"7db5ec769301af15",109675:"811d79e6e29e1d68",109875:"a840c37ddb699d4b",110350:"d58b517d65fa664f",110477:"1886dd0a6b71e6a4",110642:"67377697ad16336a",110849:"441803562d39c5ea",111198:"46e418f5a1a1aa67",111318:"3044f2ff73bac973",111503:"b9718c8d410026f3",111943:"15f4562283edcf16",112002:"b292235411935438",112047:"d74b9b51e49e78fb",112502:"839042ad73c62653",112657:"2284be4f17ad2228",112782:"fa7e63cef519e8cf",113353:"0f3e3c11c93e0272",113428:"a9b2706b2bbf82a8",113484:"de4bca00a0d44c28",113737:"94de6e1b0e0144c4",113739:"97d233c5a1f7f33d",113872:"9a25770d93084bb1",113909:"6629105318404454",114151:"1999184740684991",114526:"7c6859b708b63392",114826:"3923afd122edda1a",115078:"a5d07b0f489a8a22",115166:"0f30ce0fa54ac19e",115195:"9913fdad5ad13bd5",115314:"6d758d1072bfad91",116205:"987c26892e676722",116267:"e2cd3014b42a0015",116356:"ec52b60a8507c031",116676:"70415c6ce81e1795",117270:"7bad5ee8d3218422",117530:"e7b79d0d0738f93a",118223:"692145ebd4cc174b",118228:"ae68d7b82af1c197",118390:"b019efa8fd0f49aa",118491:"9e698f7eeb9d27f6",118529:"cb416737b3d505b8",118698:"2e4347e53a877dbd",119050:"a8fe6f926bac5149",119069:"e47b7e62943d44f7",119233:"1b6e96161151a319",119330:"87aa4ade5f907f37",119371:"38cef7ba0199332b",119374:"e3905d241b1f5db0",119751:"e1955756dcfa71e2",119790:"dc3a2065563774c4",119825:"de5f350fb7f56255",120012:"fef3b5eec022d4f0",120132:"9841d5855f8ffef5",120155:"a0164abf2a3edc41",120352:"0fe90331ea5006ac",120397:"73eab2df157d8eb8",120765:"4985f3e6e9141a00",120904:"fd7f4f08ab75065d",120933:"5e66e0dbfd4b3dfe",121343:"2c5599ab83088a45",121786:"59c7ecf9fb90b474",122413:"23971d52f99514bc",122699:"81ea3715d8eb3e3a",122767:"ce722382ab7b5db1",122842:"8ea3517b39db0bb2",123025:"2e22124c98cea0d4",123045:"9d4382672dd3fd4c",123293:"38a70e4742b73ba9",123400:"da383a9fbcacee5c",123493:"71df56726be62221",123552:"29d15a9e2635f9b2",124053:"ecb52118cc9527ee",124197:"db55a8fcbe06a427",124572:"a2fa695c63595c14",124624:"1db2141adf0c2f37",125447:"2d597e25733847c4",125502:"426e923bc8679708",125532:"8845e8fd02403de1",125612:"4249cecf8fca5b46",125841:"8a52ada86a93b138",125891:"e15ea2c1694a9fc2",126263:"e42600068aeded7a",126442:"9739ab1c15686f6a",126756:"5a3ac5561e4d7e3b",126819:"db1ed01b7392f8ad",126841:"4bd549442b327e53",126924:"b332e5a3d8ee1763",127029:"88bffe8b9dc26ca1",127109:"f686f20c2fd6d65d",127199:"fed4564250f4183e",127490:"bcdc2231831db348",127946:"c81b964f11ac725f",128254:"0118f876bdb2673e",128560:"aa0c9f9d2c634d09",128846:"75682d32b977f3d7",128859:"802f04c2c32d1a51",128887:"05c0b2ab9d1bf7e8",129323:"990c370b2dc581d3",129405:"15e73c97b1ed82a0",129408:"aa0f85a638ba3778",129884:"2b8ba6d810f0e0cd",130005:"86c5130ca2fc644a",130092:"4cc8d35fac8776c3",130192:"bef8bfd5b0166053",130288:"3ad27646245783e4",130313:"30d97df366fd3216",130748:"9bbd3e8acf08b1ee",130778:"b8b36e7c58fdebd6",131543:"6e0050e9430214a4",132071:"6f2eef1e5ae250a7",132074:"035cbee1b3068e64",132076:"caf43ab979b6d226",132238:"3a31c8f74b19248b",132244:"eeb2682a87c97765",132529:"476b87b4ce9b63b9",132733:"0ae3e668f405d98b",132897:"6eb6c84968401c07",133097:"0f146de5964afd4d",133431:"15bf8e8d9d666ab6",133772:"4d40ab8fc3344d08",134125:"18a2143dbeb38558",134255:"2be6498770e7bac6",134257:"b3bcd0d6246fff15",134315:"e82df112c069c63e",134508:"f2914a4fe2cb89d0",134648:"c3e1e9cd6a31f101",134697:"ed71c32382cf6a50",135004:"740fbd0ba9f8f67b",135106:"ff5e860b2ec797ec",135185:"3908311795a3ba6f",135821:"353cfe308c9dcc42",135932:"b6997c9e1444954f",135977:"dbed86cfc94be2bc",136279:"930accd18073dd03",136608:"92c2721d509f70af",136665:"22e31d5e20698a54",136793:"4b635512706819d6",137022:"d83e90625ae61683",137025:"6682b7bbb21608e1",137106:"48ce744bb27f8c83",137252:"70ee2c88bbe1202d",137378:"ac0cd6b260b3501b",137390:"2dee3aae9d46db92",137434:"fbbbc50d67249b81",137472:"b6c8e088ade3f1b4",137589:"4c5be72a7edc5cc5",138008:"82eb2f2b2e2136c7",138693:"a152d7fda7392076",138885:"50507747f61a9f2b",139155:"f2064c5bad1f0e70",139442:"fb0ac60956a2f5bb",139746:"57cf141fb58de916",139865:"0b477498105be3a0",139886:"961b43d587f4229c",139947:"3080ce70a362b73d",141064:"cb24b16ded67847d",141210:"d29f6f93940f5846",141221:"2c131661b61d66f6",141719:"7da1157b91494f39",141720:"b6300582c200f868",142325:"b24720c0427118d4",142469:"6b7c12f410738a3e",142483:"500eff28ea8d5162",142495:"523137b65e0ad070",142549:"6e441296e623f57b",142705:"7ba6625a428d847b",142771:"92f446f818947b89",142919:"9db7628faba21bc8",142928:"770314921613cf26",143338:"de24db9110803f18",143535:"08542662dea7c396",143589:"785e1d31271e362f",143795:"0fc397a8ffa412af",143825:"7ae3828ec252d068",144145:"b249900696932cab",144178:"b886904f2c6895da",144741:"7135cb2e8146a562",144777:"28dbeac36b64625d",145020:"506d3e64f24d42e8",145332:"f3b34a2c9de47f68",145424:"3e9d97141875a88f",145679:"6f5e0e3f5a1dca2f",145742:"3c4c4e1d16495301",145898:"5fe7eefae816ab2a",146916:"209ee9b90c66c8eb",146981:"98ef55e22ecd93b4",147112:"fc545658ada65be1",147468:"a556ee1518ff9cf9",147872:"7b5dcfc246d3a4f3",147953:"b97718bd93632774",148003:"3415da9100e75083",148084:"b888f71f8d2d49bf",148110:"a748fbc417e8280d",148140:"4b84cd0cf623971c",148202:"0500b9c31fd1e631",148339:"0d7382b0533e1549",148370:"bc32f4b8d4e15832",149576:"4038a3d6f3ccd482",149590:"9d248c053ef30e3c",149721:"44b3fbad394fdc0f",149752:"2b65085403e7204f",149974:"06de9afb1689c30e",150013:"11ac6c838ec715ec",150103:"6a7636e805312080",150399:"a0866d65958265c8",150480:"a9e859536cbe3e38",150992:"cd69f1c35cc2b3fe",151303:"eaa8572b128357be",151397:"c3c0b255b9494f66",151469:"1217c31716b21d1a",151566:"39422a866413518c",151570:"101dbd2d6b5a0d32",152177:"a08611726f8748e1",152269:"fdc1ac90c9c7ead1",152281:"9ee2665833b1490a",152287:"a0c0a0cae32b1401",152648:"b91a4e00b3a4fb47",152793:"3f367d5f6cf5f1a9",152995:"505ec698a86c477f",153008:"1eca044627f79660",153021:"837fc97bc8562e6d",153267:"eb8a980b0f9c9791",153326:"906e4f83355a2d5d",153613:"8e00558b217e0737",153698:"0ef10040dd36dd73",153715:"70e27a4c7e7a7521",154039:"60236b0ca59da683",154068:"8c9eab9b4fcdab2b",154125:"3b91d40f16b032c7",154212:"2b4ca58a5fd7c758",154423:"69a7e0def28c7cb6",154612:"deaf6c847a41bc49",154788:"0669d1208ba4c7c0",154860:"a6c6d8536b2419ca",154866:"3deed61a1df431dd",155340:"e2e6edf378118884",155393:"15adb1e240e4104e",156149:"d1743e5d54bc7054",156255:"4fd5513f7b5e89a0",156275:"93b6d63cc6590ba2",156312:"963661fb5d4b38fc",156354:"0079170ee367d180",156652:"e37518da34b6e4dc",156722:"31556f5a36ec7ce5",156926:"fa6607f9951e31a1",156973:"167e8a1294cc09bc",157239:"480f0cb3ca7b4664",157312:"70c90b49ee58485f",157449:"3f212e85f130371f",157711:"242847521e02e566",157824:"ca73431866db6342",157944:"af485db78140ba86",157998:"7787130e73099f5e",158057:"b2925d4fd543dc2f",158486:"ed2cfac35cec6d98",158571:"43c3cc63cf809a96",158758:"9023f5680d1a0edb",158800:"3c5733ecaa91cfc7",159206:"bf051d2d506a0d87",159225:"931861111e870466",159360:"fc3554dadbf049b7",159551:"43b67193447ecfd3",159556:"304a83f4c116dcb6",159663:"a0a96bd14f28882b",159753:"03add8aeb468c67a",159764:"6b1a8c6efc0b6ff5",159818:"9e2a2be06f2e0335",159881:"15af5b1c219da633",160111:"eaa6605b1aa5b92f",160295:"c401ea134d833f91",160479:"c39f62c8db741ebe",160568:"09cd90ae4cf96085",160713:"fc2530c3d2a65cdd",160848:"179e13b825c8953b",161183:"bb6e061d2943e7df",161459:"c7d9a4f5593183bb",161530:"bf283fc3a0dd5768",161747:"ea7e22597720d62b",161768:"460031ab0dc925e4",161855:"7a343caa523cd00a",162036:"c11521e31e5a02bb",162520:"5a278c491b875982",162531:"c570d97f51d549a4",162556:"a4cb0c281f42bc1b",162716:"d5ba6cf2f0ceefa5",163395:"8c73d7fd91b78032",163502:"c79922d31372d502",163510:"0de6a7a9d3913938",163968:"5036afdc319969ed",164010:"12e8e8e55e0c0e5c",164423:"b711a25bba5a0f92",164749:"9bbe044031b13971",165025:"5f1d63150a7586cb",165158:"ef7579fbc0e0ffc9",165238:"459182fc2d314b64",165240:"e15665d8f737f6ff",165441:"d7002e4c5f39b844",165446:"ee5e9b758a66047f",165518:"b9a604f002c8e80f",165785:"b0f0df660b8289b4",165870:"bd42cb8e863ec2b7",166129:"5a17a13547667c00",166433:"2da5c6ec1fe8b7e1",166450:"ab90f34116b390b8",166570:"003666090aeb3dc6",166694:"5a2b27bc44ee8c76",166937:"a7fca799c85ab9f4",167008:"e320e5106c253d2e",167083:"8c80c8966efe8134",167769:"aef7b37c554b19a8",167949:"43cf6ee86faac316",167960:"d81d8dad43c7b9cb",168508:"199b5397dcbc5ab7",168794:"3de1ebfd7882b39b",168889:"f662d1b7b2f3d18f",168904:"6e13da0889c7c658",168957:"de656cffd1fc82ae",169380:"e7a12fa8a8516834",169755:"4d5dadd70607c2ba",169790:"451d7e664ddedebf",169957:"9bc64397d82eb733",170152:"bc44be1383ee58dc",170279:"0f63ab6609fa7fd2",170558:"9066de84019c7466",170796:"26fcd520982f4549",170845:"6ea438c616de7a25",170918:"5f5b70c932f1bb15",171627:"18f326036947be1e",171670:"f039addfdbbc7aa6",171835:"d2b69f19ce83b159",172042:"8f3b84ef994409cf",172069:"0ef216975c1a1efb",172142:"1323c59cc5484079",172325:"5cd4ae55b2f277b9",172479:"f189a340d8788981",172557:"9e1238da4749522a",172842:"5c40ddffc864fa55",173250:"77708015cd56d7e4",173661:"6df3093f2704fddb",173717:"096f1b8bfbc3e7e2",173804:"54220ce5cd831ea1",173890:"6ec9ab142608a003",174249:"03fd5c77b2e41b6b",174361:"6c5b488c31a683ca",174449:"37c20fcbe2cc5607",174691:"7fb2229d494519b7",174801:"0584fe61150581d6",174847:"8efa08a4b44b0346",175868:"eb00440c2f478343",175925:"b991d7cce2bebafd",176153:"b769dfe3e39f1e14",176194:"6cecfbd624adfe49",176345:"009e951bff236811",176355:"53c3af627fde960c",176902:"53c0714550a4b226",176994:"d5293c9443e31f5e",177041:"3677c6bc4bd062f7",177060:"a25325a03415c137",177285:"bcf767fbc89ad7ed",177330:"c3ff0c4e8e86712f",177362:"37dfe08b4fa9f7f9",177455:"090ad078a67e5d5c",177618:"7020c3cb3f3f63e0",177750:"7405bb76562d50b3",177953:"ac331c79c28306ca",178580:"7f2363587625d4b2",178815:"197cd7f83f37a8ed",178832:"c439436f4933e072",178866:"109267c9abd6c95c",179731:"f39634c6edf2bd1d",179775:"5894cab77ba42496",179826:"7cc07239a8d8ac9c",179947:"430e870f7dbaf5db",179993:"a425f280a8e2bd8b",180165:"d093b539e1b4525e",180243:"a63b2ee62dce2b2f",180280:"1c7715c77d2d0492",180403:"bd1bb560b6a05e43",180560:"7674e8496ee608b1",181174:"82dfd89a93169254",181239:"f2478161bd186800",181790:"f0661aec56fdb4d6",181802:"4c6e23fd4c271596",181815:"32d6930df63ec9af",181844:"2479a6d494256a2c",182117:"0a75ce1504331f31",182222:"21f7965b21af73d4",182255:"65d79489b335d503",182409:"bb22b5165868f04e",182786:"33fb8a07f0afb3ae",182922:"4d5367e420653b14",183393:"0def9b0a1730964f",183483:"0ce3d8a56916d3c5",183663:"9d593c974b4fd39e",183703:"bfb5223688c971d0",183707:"de9c9f4971ebce4e",184063:"fe0858132a571d57",184074:"183a6ed9e9ec2ec2",184277:"99079e27358be266",184375:"323bcaaf8f130e79",184427:"fe42935c1dba3139",184586:"cccd454562d46d85",184874:"7ba9e4762d6b84d9",185097:"3d41f804a75fcb91",185541:"af1a590fba17fe2c",186018:"9dbf211330029702",186354:"3145873f044cad21",186670:"1c2a9f63110b6e20",186677:"56bc3a1f24a432f7",187084:"4d6f137089543dda",187408:"d30b149f5e3b8dc9",187452:"036cc8a4907679f7",188100:"64ace7e5c000e018",188120:"f3dc562865e6b149",188146:"4cf0e31795014fb6",188357:"cb7a9e5534df3dc7",188437:"2c9f24f3897f1db2",188541:"2da27c0a4679f3c8",188927:"58c9cb5c88c8a710",188975:"afd1c5fe80e60b0b",189086:"db90cf0c3bd606fa",189275:"94b61e55faaed02f",189560:"a76cb86bd5ec1800",189591:"bfd4fec328bdce77",189649:"897de0d1ee4b76b7",189683:"e190ff410dfa9462",189711:"4c4b75860e4ebb3b",189755:"d09131a497c0981e",189910:"e4808f71f5435748",189979:"c86dafa080506190",189980:"170c6eb87c0d57eb",190625:"a91961b0844596ce",190658:"2f13e0e03a0bd011",191368:"84dced1e5e35c0c9",191504:"a4153a653203ed62",191549:"bb89c8f7c1886de0",192151:"e34ca75ed0a30c92",193145:"3c791c24f0ba4afb",193553:"9a326c7ee3a40ae3",193693:"05b43bf9810300ec",193753:"61b0e79cfc0ed4b6",193841:"4f4b987e2fdbe617",194219:"b3fd368101cdf7ab",194248:"f07c9fa1cd96ac30",194421:"086288cb6e8d152a",194658:"58ae19d26268f2bd",194806:"0936d7b12a65f20c",194925:"b445f6ddafc5a1cd",195002:"a8e0dd9dae34048c",195320:"de8c16aadbe46a1f",195359:"66dc72f97580bb34",195584:"df785636451512fa",195823:"280a5e467a5ae828",196057:"c36cf0651ccadd26",196137:"8bb758a505f5b3c5",196673:"219f4c5bfae5cde4",196710:"c413d833507c0e00",196803:"67254962578948c9",196951:"85911a4c460b4307",197282:"757b9028d38aed5b",197645:"4a6e9084ac645c3b",198050:"d2a0e788a55436d3",198163:"6780f1179c24c13d",198167:"fb9b19f0447989f8",198629:"ad63d0b5f93de410",198722:"f60a5bb0d4f1ea1f",198723:"6b1555a81557a9d3",198872:"7d053e9dab0cf1a1",199334:"a7fc28dd390f255b",199948:"468820ed20d8d475",200162:"23831d9dc033eebc",200244:"38b3c0be1d22d9e8",200245:"59e7dbdf70f9b704",200471:"7a97583e1ddc4159",200650:"2727fecc961f19b2",201429:"d97307d351f38de5",201514:"af21e9bb281b5f92",201876:"d909b759a0b95305",202066:"7202ecb7838ffd91",202090:"db082fcd4782b5f3",202148:"8b1c044a12b5e77d",202301:"ae2823108f9d4ac2",202708:"6740f6a81d726c9a",202883:"d6b861353f871d06",202895:"cedbca6e62935511",203035:"5adb2fecd9b509e9",203047:"3c9050195ef0d048",203137:"030d6a8681cbd504",203441:"f73e6bacc6650bd0",203831:"0bac41a23c4ddee2",203846:"ef8560dcd27b12c0",204357:"56aa50b3bdb27603",204484:"5c08d5a63f81838d",204611:"25d90ac71c859a80",204672:"e57c620a2148142b",204773:"e93c50ea4652597b",205023:"e7af6f5e1c5bca1d",205390:"4ef29014841605d5",205400:"d87bd96f7eaa50c8",205688:"fa6f0bcef815f87b",205870:"584ad2d370d8a9e0",205961:"b2adbf3e049b6a2a",206066:"0f9c09d23df9d9a9",206194:"08a15e7e480ed335",206279:"daa9a7e14df925d8",206336:"63e9d58f1664b1b3",206355:"6990aa28bf5199ea",206396:"d737b2031b56cc94",206431:"04e515ea4dd7f594",206457:"008c6ce28900fcfe",206658:"e9987cee3e978e0d",206659:"b5d5f44b0749616f",207022:"a3e2f0a991774edd",207056:"3b185b697821539b",207351:"fc8da529e6b79ef0",207447:"2e0453e7de402ac8",207514:"c34dd2bf4c5b8350",207545:"c3e4a1d378f4bdbe",207723:"7771d625633c04ef",207776:"ae64cdea748fb949",208480:"9a9af4dbae69bec8",209004:"881d96a1a2d062c3",209103:"a74ee9ad3578a63d",209252:"bdf35976b1269420",209411:"5eb18913ddf2a0f9",210035:"9c1c35cff4994467",210056:"daf03eda13430d39",210199:"ff6332706e0fef10",210419:"7c8b9ed8a045d47f",210749:"ec793a7aefddf103",210828:"c4ba130a33e3d8f4",210834:"84033d07cde71322",211172:"b020673e75f04ac6",211238:"b02557972e6977a9",211286:"941aaee876aec068",211591:"051ec03c6b70e56c",211657:"b5403a582d0962f3",211752:"b5285f1adcd0c3e9",211779:"de29c89b77b64293",211847:"2f4a8f0f3666d81c",212216:"e79e1cb8362b926d",212243:"cfe91bf8b747ba5d",212353:"bd04aa9d11c6acae",212401:"e1a50c914f6300fc",212664:"7a110e41d1e2802a",212776:"b77ec2a5bbda4d93",212882:"cfb9606531427810",213692:"ce29b67d78b8fe0a",213862:"7d074df4c3be8cc0",214169:"9f0b26ca04873942",214368:"4d8499521161fd02",214475:"d841c6ef0d194a05",214495:"7a256b2206820edb",214600:"24141cb24da3fabb",214609:"5a8950fd29d2c915",214699:"462d0f7c34758e26",214988:"900ed0ae29230372",215750:"612aae381975c9fe",215793:"47306447582049eb",216147:"ccc7ff405f1e7731",216266:"0099a71c51760a4f",216366:"643f772431384db5",216390:"57153dbe4720456c",216419:"708120f43535b755",216478:"615ae547439e1b92",216489:"fed3d9bb7439467f",216622:"de3ca7c668750b6c",217204:"990b90f02ac07ac2",218129:"993d818c6d1bee7e",218418:"b9b4e8684cf22353",218484:"2b5a0d72dbec0e49",218519:"21efe68db0f617d8",218893:"c3077af45451db14",218927:"cb5696bc43a8db0c",218940:"a91c1e527f6dce1b",219495:"f8417e2f500b1c77",219511:"d3a8d9ee9e9133a6",219714:"6d58aa9a4a6c3355",219735:"ec195e0372678fe5",220016:"a5b1562ce8f8cc0f",220029:"12b12ca167cf9926",220573:"0f7f68f6674e5bb1",221247:"4b342e01c8788db9",221264:"decf1a14b84c95a8",221477:"e395dc5295d28ebe",221590:"82c03e8b72f950d6",221833:"95094113d5f40005",221985:"9b6d004bb7486855",222100:"ca12e1f20dcbbe29",222321:"28c0d7ffd6b60d0b",222348:"004865e780850534",222474:"c2a3ed6e4afdcbe7",222479:"7f7547ee3ecfabeb",222750:"54e6378d80e77234",222938:"bd7ea920ea971539",223035:"5f96ab8bd71bddad",223283:"706eea43cae1985c",223345:"ca57fcf290e9e183",223828:"6878fca801b028b2",223935:"187258ef2aebffa7",224073:"9385ec93fdf95d36",224374:"38562ca82627d4c4",224541:"e3a00fdc6d583715",224632:"7f1fc20213f88933",225160:"a91701dfba52b7ff",225463:"2a542efa7536d5a9",226590:"91667dba64f19177",226816:"be5e73397fd93573",226828:"9cca3af2d5de1bf7",226842:"400e29a52aced0dc",226860:"efbaf4681f189094",226958:"1bceef819e7357d5",227810:"e08eebaf1b40be14",227954:"b77b9834ec62eaaf",228048:"57706ad0c5190ac0",228395:"3669e3a1d0863f99",228437:"7c0475eeef3e2f47",228443:"97fbd0984870c87b",228505:"7c6c878a2e54426f",229e3:"e59895a1041ed19b",229117:"5aa892f26501b216",229145:"2d41ad9016e18a52",229407:"663fe7347ae1484b",229533:"8af32fdc50e7d2ed",229539:"58d338b6f58ae819",229577:"324e9592e33353fa",229959:"6ff489826b370c49",23e4:"5fbe924893aa738a",230040:"33835832887db229",230100:"35e40e7fce9c6dbf",230191:"35b206ba43ef79df",230318:"c1ed27b741fa3f8b",231353:"ee62905ba4f46b92",231402:"3ef21ad22c637849",231512:"091cf34a6a50d14c",231527:"abc4d685c4bf8350",231624:"fc968751633ecb0f",232190:"4c1e9fd6f1b5d305",232334:"0cb633543b67c913",232577:"b2699f67acc45487",233025:"020062cc836d1e52",233745:"3b005252c73add5e",234396:"458af65b926e315d",235391:"32b4cfb345592182",235430:"f237b0cb32fc5f95",236021:"25d3ab963f606cae",236391:"f1d39054eec5a959",236848:"5b2b7dae8b805bdf",236854:"e0d422a375da6e34",237123:"41d9ec875531e83e",237256:"4fc3a88c248ed3b8",237572:"1c36ded39db8541c",237591:"cec1604bc44d2d97",238535:"16b4cfedc9e81cc4",238820:"007e551c720bc175",238957:"4374f13beea19acc",239117:"c65e87d561abe7c0",239650:"8b72f10af159a069",239717:"ae0e0447fc432f27",239888:"9933dbdf89bbc074",239894:"2cad70aa3f3d5d9d",240238:"bf5bfb7f065e77b5",241348:"a29970f3577d90c6",241557:"f868d125a3abe5bb",241799:"09a8c565ecda6af3",242411:"4a67c8d21d384bd0",242636:"1fb3638f8472cc73",242917:"ee40e7d3e495b0d1",243158:"ce0d4452fcea8d24",243209:"811b27f519522d92",243223:"9b5bf2098abc1539",243364:"2faa399e716491f3",243570:"e42f4a913af91ae0",243890:"b418a0c259ba1305",244480:"4c49a3a03eff5916",244627:"244d7c63ae647f47",244680:"94d475b9354422a4",244690:"0eeb8852b5692ff3",244699:"00e53eb621979e0e",244775:"9e9b0295962a9058",244858:"f5c884bb019fed16",245526:"3b841125ed6752e9",245882:"c1045a7b30e0173b",245915:"3eb7ac020a083a40",246107:"1d0ceaffd997c315",246306:"8431228bc9117caf",246462:"68fe8233667815a3",246477:"919e495fbfcef8f3",246515:"ce3fd5e035f2b9c8",246576:"5c08e8c427f3b01c",246657:"4cbf58b5bf1c9049",246739:"2b041f659942b731",246918:"e8f12aa71b03dacd",246943:"159cf3e641095e16",247339:"5a308b3d8d9658f4",247632:"93df37ee3fbb277c",247861:"f691b0b36ebdfb3f",248098:"a1ebd9ff5ab939f0",248361:"941389170bef1cdd",248447:"36902f55426c3405",248735:"8ea469dab06fcfd3",248853:"abfb78b4e6b58b32",249051:"c2be1c42aef921f5",249241:"32b8b3ab2dd31be8",249394:"9080fbf6ca36ea0d",249589:"90ffe73361d7e8f8",249805:"b205e7cf456cfd0b",250063:"d1a077bad9e7826b",250215:"3e43bbf610d2effa",250241:"4210a376f041dfe6",250667:"e1d3c0390a4ae121",250936:"cfe1f940264ba089",251074:"2a49772842cd6cf5",251083:"bbd1c2eb4b8ce5f9",251181:"e5c1091f54e76612",251317:"2ec277a0bd30114c",251425:"8bb9b6382dd4acf2",251452:"89f0bc3069930f5d",251975:"60365e3d8aafe45a",252107:"0cb9f1a5f7abdd80",252330:"785d413380fe4eb8",252354:"375cd13c4f8d6c1e",252781:"f1365343e7ef81f0",252797:"ac763e55bb902ffb",253046:"ea62baf51d9d1c2c",253119:"8944a3e6e6b3b366",253506:"942933427f9f41e2",254122:"da1e143234086542",254166:"e1060916044ebc84",254594:"10d736c0bab7a2c9",254692:"bd146aa467150930",254964:"c950c5bc959ca22e",254970:"1872b1cd9eceb249",255046:"9c8c29c07c4fb79e",255165:"04f2f9bbe88b7935",255306:"bf2b4658e46fdf59",255937:"86c31fb6e346347e",256166:"5d25b0e681fa778a",256643:"91af1397215546c9",256657:"57230b56956513b3",256828:"fffce5d798375800",256992:"b5cecf49458a510d",257052:"d3419534c5f1e0f9",257394:"f61bf0e994dafccd",257405:"60590928dc570ded",257617:"e7e62873a6becebf",257621:"3ba31db15b588a80",257760:"1623333de1536969",258004:"ef1cceed5e5ac6d1",258189:"7f17674bcfef691b",258259:"15de717eb672587c",258357:"ccd92fcb5713fe83",258466:"6ad2e172388d3c9a",258557:"41608fd8e0e38f42",258699:"c188aaa67f8f865c",258877:"88e3eee91503d996",259465:"a35d9085325b27db",259999:"a9a0d28b4c4185af",260390:"94705c6299eae416",260509:"7a3d7f0938455839",260744:"430c286c3a886b29",260758:"6f07b2fc4d749976",260891:"9ff6e81cb5b48a55",261090:"f07082dcefa8252f",261098:"45e7c7619a611542",261402:"e5d69dd972f43d65",261426:"c08bd6c44111a440",261537:"21acdf5f03f88470",261539:"3bed619d7448e7eb",261746:"abf5358ac34a6e82",261784:"9898971dab8f516a",262027:"cc75a336e02f1b07",262199:"4780666742028f4f",262475:"016c9c105b0c6b35",262793:"5f24d338c4fbe369",262851:"18eb8bf449baf2c8",262855:"deddfd870628fef8",262860:"f0bcbf50893e6428",262889:"3fb78532fa99b6a6",263038:"5661f3715e8f5813",263237:"eca9167e67472fb0",263311:"4a4e6ab15532ce14",263563:"1ff52bd15dbf0a41",263907:"9f894ceda2e272df",264078:"02f67a4a7b12f745",264381:"6ec1659d4e3101ab",264403:"6f00671dfac4e497",264479:"ff8f835dfe86c925",264630:"7f834d5dd577a530",264768:"5ce8f72657949b40",264779:"5bc2bbc9d8eba34b",264992:"f650f4a2c615be50",265469:"e4a1f3bd35d60ac2",265630:"6dcfc9fb6b0723ac",265758:"b5cbc70a666ee1b6",266144:"7857f8972b2f5b5f",266179:"776da6071c1bb1f0",266281:"bba6e590212b8c3c",266613:"c54f3a718ed31357",266714:"567776ed18e4b840",267099:"acf2d363375f62b3",267228:"a6ba989dd52398f0",267644:"41a3fb014d0d5913",267949:"693c11739e896b69",267989:"223f2f964438f6b0",267996:"6e207cfdb2f3b962",268312:"6a94efa10231c2f9",268446:"defbc357d580f162",269541:"2883c01db910199a",269971:"0140cf84ce5c432a",270009:"3a4d16d955d10670",270410:"df55b7188e180c30",270602:"b8a9d85dd60e443d",270706:"c70d63a7e87aa5be",271023:"082b702b3660533b",271197:"381bf65e2a32835b",271493:"77a111291e7db575",271599:"083679ecfa037b7b",271722:"ccadfce0eba6a143",272346:"99aba49df20d78ce",272526:"07879bd58124d11b",272734:"0676724f2c57e192",273177:"9838030ce22ab94e",273621:"cf6e20d220a05dc8",273760:"eed63330a10ff7d5",273806:"fcbefc6b20bc070c",273824:"e840ae97e94beac1",273836:"a2aa40783b9b1868",273851:"29c1f5ca707bad80",274121:"d66e15e284e9f210",274217:"1437957d8c84afeb",274403:"1a9b47981551421e",274444:"5e4512f6ed73ba1f",274543:"59ac2a7ce7f50e58",274580:"57f919a055f21a41",274590:"02027f66d28b3ab4",274690:"40d693ea966b0a09",274786:"3ed738aa5772186e",275041:"bdae1f8d1e809ea6",275174:"48daa5bccebb9297",275240:"6387952b3ec41185",275287:"f4f6b0cf6023e504",275292:"887d6043de52a125",275863:"1597d257b6300452",275935:"f4492434dc4334e3",276087:"a1ea306611633356",276370:"87f0ac6280128b1c",276518:"d4212e3e39bc82ec",277222:"20a435e2d04d6b67",277233:"76b8227a52396299",277412:"3036ff2b7341f18f",277527:"57bbba8b45374003",277639:"c90bfc5bd7a6d02c",278402:"90e742c13f7f3b44",278502:"d1e14438d49d2792",278792:"84aa5b6780c0746d",278800:"c4dec048c999544f",278910:"32f9fc6fc2c7cc14",278996:"30c126d7112abe75",279439:"a2f557f3964e1bed",279552:"ac235c2e76e09bf6",279673:"5b7d2271ebc01645",279932:"86a3db1287ae697f",279957:"d46eb402537ee28b",280520:"e5c930600cd9bae4",280574:"055a1b4fb0db3c14",280579:"14c67266a6fa50ec",280647:"31d6764a111022d8",280664:"fb85188ac5c4acb5",280699:"550f461a9c53b833",280720:"8469a3b873fe31a8",280735:"e442182bb42247bd",281093:"3f993cad711e0350",281227:"578850520adfeeb9",281234:"5ff5d43deacd623c",281237:"3484c155b54e6c67",281381:"1b750b0a4a4363db",281439:"0fb4bcb75ed889c8",282009:"575cce320c3ca458",282033:"c30f4d1632b13861",282118:"2f16482e5bf243c6",282596:"ada18a1c92c3df08",282671:"783bfb6471b2c90c",282789:"70570f666c7fa174",282850:"462a85de5240e1bc",283035:"1aa0670903a40091",283314:"e5db5768213a7963",283400:"233e7cc715d518fe",283549:"86cb03da1e7291ab",283593:"97fca04cb50bf4f5",283992:"225eb12bb6cc2eb3",283993:"5d72f25c23227715",284004:"8d4c988fd1068d3d",284063:"6a787a88f794ee1f",284765:"6aa9a22919fc1c11",284790:"2e1a2fd8c2e89bd9",284860:"e94f36ffe6c6d3a0",284862:"55c276a2603a2fcf",284870:"aca0e9f0ae0de67b",284926:"6cc4c0a3f5d91a91",285260:"783692a168aaf21e",285503:"9a05f06bc9eb7215",285538:"56f0ffde1aa2425c",285783:"14d487c8a3bef1b7",285815:"888f0d799d6cfcae",285883:"4ab93bf420a707f8",285991:"117f109789c49a84",286190:"9c9e56f06049e26c",286264:"90c2966257df43f4",286358:"111a9cef502d8258",286608:"1bde51642144f0a3",286936:"c3700d57388c9716",286973:"61ac41a05b9ba730",287024:"c5e3d136be419d0d",287036:"52b4177752fec7f2",287676:"acb39c8ce1df9abf",287783:"f18288d035bdb3b3",287808:"59ca5d794b24c68a",287809:"36d8457c03dcb728",288059:"a0053989f7921e94",288475:"5ed7d04b9a8bf528",288542:"956f7399fc96ad56",288771:"d4209e10cf54e54f",288910:"34cc05738f0a2d36",289104:"bfa19ee3130754c6",289142:"ab06ad80dce8c0f6",289526:"40a9917073d1ba8a",289933:"63aebb31bfca02e6",290080:"dc060f219b96e898",290189:"48e124941b069301",290265:"54033ba47d854e2d",290378:"4766652e0efd8287",290833:"852dcfabab061d8b",291282:"e811e9dc58533984",291443:"a50509c76808305b",291550:"1c1795ad30e65607",291600:"2a458e0a95d3b514",291910:"c19d64e668f7458b",292044:"99ab1c59cf645001",292584:"83cc538e93b58e34",292712:"1a13d49760a77e7a",292819:"3c66670c88df7654",293186:"6a2dbe06c04296c2",293196:"01e0deaa40c20a44",293347:"5808ea31c1237723",293740:"5b3aab8aed782bd4",293774:"d443ca636dfa4de2",294122:"d00545627536635c",294157:"557b8d44fc56ce23",294263:"154318f331cf81af",294267:"6f33d845445d6c40",295014:"77893de107177e30",295372:"25c02e045b3d8d86",295378:"5f27018dbf62c5a3",295417:"ed48a698e048ecf3",295589:"01bb1f23ed5cfd4b",295746:"ced6a7c27df647da",295772:"c1d8234e5c8aeec2",295787:"ffa83600f394eaec",295797:"b725380ff175f477",296046:"af40c3e3b44e55be",296105:"619b6a15cc28f5cd",296386:"d99148c2c5ab95fb",296387:"c44a23ee075014dc",296728:"7251a0d44911dcb5",296829:"56bdb71e1e244a18",297125:"d6d33aff4233b0a4",297399:"f9e90774c4598f4b",297436:"449e821d48fd320a",297816:"070acb231e47c33a",297895:"8fc527302602aaf6",298068:"cf2ba08ff5a52390",298269:"3fecdae191760b72",298368:"5fae634b9d513d5a",298643:"686eabf373c693c1",299290:"9a225e4fc88dfa96",299306:"06de580cb3dbabf8",299927:"d8c43123d2074163",300211:"1586f859a4ad1550",300586:"ca7cc6a976ff30b5",300866:"5e14b95f7bde4443",301281:"db5496044abe1628",301400:"2e3fc25903a9fa3f",301420:"4342bd076f9d29c8",301741:"b9f272026c3653f0",301920:"cfddeb8e3f6bbe8f",302092:"c5771fad062db89e",302168:"4cf08dd7a615a44a",302488:"6fe96bb899adfdf7",302514:"2d2ada4edb1cb9aa",302598:"99029aa6d1637505",302653:"c4707b3583d829b3",302711:"602a3df158bf3610",302755:"b71a7ec19894c4df",302849:"21de9263ad4d5c6e",303220:"bea450f991129d2f",303460:"fee61e7ee0a48293",303762:"e4d4ad2908f0e4c9",303982:"0fd990e9e784df3d",304212:"cf232f9f5d3aa1d9",304596:"062768739bdbe2b0",304601:"a15c112d1bf891bd",304609:"8771c490acbff422",304788:"6a3e8b9ec37a125a",304867:"d1d137bdcf241865",305187:"ba8fc87c05dae93b",305271:"1fd755ba7ad520cf",305324:"595fa98583289975",305724:"a70807b2b9452c5b",305729:"e9e1285a12ede0fd",305777:"f7d288356634f267",305992:"883f37b07d5b5368",306284:"585a5d7a59f803a2",306325:"dd99dede0aebd0d3",306929:"ce9764f62c95e003",307124:"9fac1ecfaf2c4ef7",307290:"a3a1ea561f9bda29",307407:"0c0c89242a5a0be0",307463:"ebd01cc08bbf8877",307553:"17c620adc5ca119b",307738:"3d2190aa956b0efe",308063:"132677a7d2ee54fb",308398:"cad77b04712a72e2",308568:"ac54738096a6f472",308631:"c4eaa17ce479e3e9",308687:"829f54c9bf6cd412",308725:"ca778dc9f36a5b72",308735:"e19998e44d466afb",309119:"6e2be43c5f9e7934",309342:"33a55ff62f196959",309981:"89ab68940c2e9891",310683:"56ef6efc05470f7f",311136:"6053fb91b2cb50e0",311368:"570bc9ce724d6759",311369:"4100858a063ba107",311788:"221af91a0d27dfa2",311849:"13cc9e25c94ba8d3",312374:"26ef859477ef79f4",313170:"9b9ba1aeda552fc4",313311:"f18a0e8dcbad571f",313411:"b7329d16b9522d2d",313507:"96e8e4209575d5bf",313666:"e8bcfb5073387686",313700:"0e4ec47383d2913a",313723:"5e49ac270dade314",313832:"8885393c16229987",314031:"3f99acc5ce7f9868",314095:"ed242de891e88cb8",314121:"e178c843d6c85a9c",314166:"9e06faab096289b9",314171:"64b27081d8681041",314176:"62506dbe59d02615",314309:"44c853d1ee232665",314727:"fab21be8792559e4",314748:"c4b8100b8e7f71bb",315343:"801411e2a4b44163",315580:"935e3117ef55f707",315682:"f359e744072bb016",316290:"c91799a35656ff58",316401:"3e27f9d4320b7af2",316600:"858e764ec87d93ff",316907:"10e9a16a5fb7f8c0",316953:"a8d98ee67b2728ab",317121:"610922b866a1b17d",317146:"8120cf3e25d91d91",317601:"281589b7468aa2de",317689:"62534ae15109c446",317695:"86a42d91f7136725",317726:"bfe55916909cf94c",317734:"e44fd8e671ee9bfa",317797:"86218959a00bb8be",318026:"9165bccac49bf1e9",318761:"42c72c3ece450a5b",318957:"ae8d06f5f2eac268",319002:"122201bb62b945ff",319187:"268084d555777cf4",319443:"8e894d4a4b015695",319516:"b721740cab98f020",319565:"f282f3ea65f9548e",319676:"f16d5eeb7566395e",319856:"fca9f4927b2b551c",319870:"91938b6e38f278ac",319974:"c2c7a6868fa6afd4",320267:"b8175b5c04c13420",320323:"b495215bb94401b3",320406:"758a2515e6767303",320427:"4b94428282e266eb",320896:"8f690d1a6894b7be",321041:"a3be27fae5bbf18f",321141:"84d046dea3968af7",321167:"1fd2227d742e116f",321346:"09185e09d2ec31ae",321571:"cb8520110c71930c",321647:"dbb1cf40c0ccbc35",321672:"94c8862c3effcf5d",321822:"75f8301da53718a5",322012:"9ef61a8a970f3e2c",322125:"39aa6c3e4891fbe8",322203:"5918360c6e530f95",322458:"c7d00994e809fa36",322499:"e680d7b06d049779",322540:"f725a6e8564c0ad3",322581:"5ce73d3927260851",322628:"6061f5f991cb06be",322803:"7f1716643e9e4da6",323134:"439c3759f6a955d1",323172:"a886f34b7ae1d776",323246:"eaf33583c4b569ad",323871:"4771546454b617a7",323891:"25aca0bbc5723622",323893:"761051e4402e3d03",324013:"3bfe84e0aae3a3c2",324278:"94e8175ead955071",324417:"8c5945c437de85bf",324473:"eed8def0df1a5649",324657:"328b91d46cd5d67d",324925:"5789eecd9d5bf5cd",325175:"c7b41cecbc246a95",325585:"c35e083ec673c73b",325603:"3a7baf63bd2a92c9",326082:"2ef3648f689c30ec",326825:"9afa74059547637c",327112:"57e2218f51b9c721",327119:"7fc4b0184d2aab94",327172:"31ac0a4b6a2c5fe5",327217:"e43a0dc853e33935",327340:"fe4027f883260043",327612:"67429ea8731083cb",327853:"c96d7f31dbaf3408",328281:"ce7b879144c8d949",328457:"d8b58d35d579fbba",328479:"f5e29e9744dee989",328749:"51a9a62c681c9249",328830:"36dbd48d7ceaaeb8",328911:"323e1cc9847f1e71",329367:"ef0faabb3e1e4592",329559:"171d7c8525112334",330078:"13c342629aaf9e03",330480:"5d1b881ffa67bc92",330637:"73d9ebac007b3fae",331112:"7c53f92491bdced4",331433:"65da547551e0e325",331584:"6e0ee10124793ff1",331963:"d1ebe9a9fede632e",331986:"f36caf0c75b6af38",332201:"b3b98726cba9c150",332381:"158b5ed4f0de8d59",332426:"443ed3572443abc6",332653:"329af78c121afc02",333176:"b324ebe7641ef61e",333259:"5f10f33ef41237db",333371:"5dc41f4546467c4d",333560:"52f466b71c8534d4",333684:"cc595f0cc9061422",333981:"47f51107337eb831",334349:"f56438eb73a43d1d",334496:"f0b2b9172762190f",335020:"e6ffa0859d503152",335041:"85a9f3b3f0099512",335085:"4f23fa0a211609cc",335255:"0799b04335112c4a",335346:"bf2d39fba2f15c17",335376:"ab0c2b5862f19046",335413:"8460fc1df8b5cce6",335479:"ce65c1d8682ff687",335626:"c5b62329948f50f2",335833:"5e6472ab654a65ce",335921:"4efc870faba09c65",335938:"e5ab5756ef6f5585",335940:"f6e12a81fd845407",336013:"9c60cfe65f1ffdcf",336037:"997250a341fc1ebd",336142:"18dc7c7de0339950",336153:"4cce17b503b5d074",336217:"08ee8891b42f4b8d",336477:"e6aa25d1a12ec94e",336537:"623386d66c2795e6",337042:"a79e9308df4512c9",337085:"8597fd9865d2853c",337232:"ca7f54b3a0ca7402",337301:"59dcec37dd42688a",337425:"b827d0042ef45ca3",337458:"b318b79206e16cbb",337784:"199527652e13d622",337793:"80437b4f80628dca",338259:"70d7f8c288e0b87e",338299:"3f9fa319c488658d",338398:"1e1f4657dd7de5a7",338457:"63f2c6fbb3d5b310",338586:"7a699b9fe69b4bb4",339396:"69b915a7c628a378",339410:"765733f3a36ac478",339435:"83d605348167b2ac",339541:"176b0d7ff3908e2b",339730:"8710cb352716f59f",340060:"29a968d24837251c",340285:"94e23ff731ec6f7e",340370:"2915ce0b3b0a4263",340600:"56948b798fc67d0d",340863:"97e25e1c6953ddf0",341009:"df48fab34b860c95",341253:"3e95e3741a4f3a70",341687:"b7cce9f10b1a6ce2",342182:"fcf10813bf5a8299",342337:"002972a56b31ff50",342461:"27014a93ed155853",342920:"3ad5b3ce93178a1f",343469:"7e51a5e8e7b3dcb2",343577:"1a7993a9938ef81c",343607:"9da63dcd96dc65dd",343642:"005ba9383b670e7f",343722:"2ba702af4f06b26b",343970:"25af5b403854b748",344667:"cbd028e0c328d7a7",344975:"6e343308f7a519c8",345626:"5876615a3618272d",345804:"a9e94bd62651f79a",345805:"c6dd93224e5aaf4d",345816:"05a1a4ea1745505a",345933:"c4fc158ff30ddab0",346082:"40957abb57b609f2",346789:"684c0f38f60d70c1",346839:"a9dd0f5409644cec",346857:"66c6e3a206117ef4",346949:"4448008f915e10aa",347038:"b518d7d46ba7a287",347162:"fa272750d587eae4",347400:"5dff2c3608aa1d81",347460:"3c41f602c6088f23",347924:"800bc6152e52c1d8",348025:"59bf673cd8eb002a",348117:"668f418a5874b8f2",348166:"0c135fa9bb7d65a4",348627:"03651996fec66876",348678:"503881ebff8c8e23",348687:"e302a3996dd8329d",348840:"37701f26bbf0c67b",348943:"ddf275dc51bcc011",349073:"43367d75973093c7",349346:"3bb44bd7f0afc89e",349663:"15f2a8880828fda6",350138:"bb99966c8070ae4b",350218:"a9e110f9304ccdc7",350261:"f2d8d2422ceef782",350439:"aef48cfa8cdd8f27",350718:"f0cbba63de955282",350899:"ea4cbeeab9ad953d",350961:"d2b6dc00e4318b60",351102:"3098e9182e901689",351106:"46c9f4960dc4c178",351292:"f776521f3171c20c",351403:"062ffd7d2a406b3c",351507:"213969e189d29ffe",351554:"7a8496447bacc5b3",351685:"9a5e8e907f7184d9",351816:"4306a065e44f5279",351914:"9e3a685281e19a32",352324:"acf03adc5a3a24f5",352410:"0d950abcd6a5554a",352433:"df025de7628739b1",352769:"0c3604810b0a1085",352820:"2b904f67c7ff7de2",352849:"c307e5602bdd4667",352933:"696828feed343ab6",353236:"a743f63d054aeca4",353857:"1384449fd12537a2",354066:"5eacf733437ca518",354347:"47c0955ad631274a",354548:"860326359bbceb2a",354573:"cc67b3ddaf9efc5c",354694:"afd9c789803b2800",354936:"c319f52fea214d94",355192:"fbfd21ab5e283921",355221:"a5d293210a7a8ccc",355430:"3fc8cb18aa84e7a4",355625:"b8c9e30b14af7c8b",355884:"aca93a10137c5f57",356023:"d759eed274a04aee",356078:"ba72a09832f69c59",356092:"47513b7812656587",356124:"04bc619e1eea5a58",356564:"dbd4e08fa6931503",356833:"94946c6eb6c5b497",356939:"556074b98907ea80",357002:"a1b40754ded957ea",357298:"f97ea48fd157de84",357625:"7736c75d668f365b",358137:"9ff95a782d74cf33",358410:"ed42a867190a17c2",358512:"b1257279a4da4e95",358645:"2a110fde668ca1b4",358712:"3a061877563c0e76",358814:"8a94a516f4da5bce",359266:"1c35e1eea426c05c",359323:"4659116ac65343e6",359514:"30cbb943b5616057",359518:"bf85c51358857e32",359571:"4dec9a88047ee14a",359923:"5e75b9d036c10c42",360060:"c2bf819469f094cd",360484:"40a67eca39d17452",360532:"0e8179f8d852e354",360695:"977b83fcf6b412c4",360818:"6f5b65c3914b22b5",360941:"3e4f23e16821b77c",361204:"05103325c55f170b",361880:"254a915b8e6168eb",362376:"660f7911e050635f",362387:"f756095060901b81",362437:"6150cf8d4c973121",363054:"f1b2f14379d7fb07",363184:"d232476cab357c12",363627:"bfdb131f4149c130",363685:"0e3e239f73f2b9d6",363857:"e0228d4eb233f7c5",364091:"6b54c7ba3f02321a",364588:"51b584c1bfa962e7",365130:"f9c9cb816be4cdcc",365631:"c720ffba6798e9a5",365745:"f91557dbeae2d188",365748:"d0c7d97dbcd38680",366178:"543833367c6cc444",366263:"d0ba560aa4f5d4a5",366435:"122542815c18b7cd",366833:"b4200d1523cb1e30",366894:"053065d74f08dc98",366962:"b9dd01d0ee5ab322",366967:"7595c93f5b1b2785",367261:"569eae6becd57d70",367374:"870804dc4ed38b1a",367977:"bcaf849ec518883d",368688:"272d58b99a71e547",368781:"1a445660d27990b0",369201:"7af923696bbc3c1e",369229:"709d692d9d81a82b",369617:"34e1f307ffe354a5",369621:"bf9de9999b664fe7",369658:"71db2eab173db57f",369687:"1b41d5154547c6fa",369990:"d58ba584ba163b74",370057:"5334c539fd2d6887",370409:"ee3600280dd6adc9",370582:"b3b191b22a658d55",370881:"8a701710316c22e1",370898:"e83405f2bef4df61",371040:"d6397d0ef2ca27d7",371401:"0aef892d7ceea7cf",371515:"a17a28bd5a9b811f",371761:"4c8611160e002695",371993:"202d47d49f2da84c",372136:"8c6976252e84e885",372269:"f2f5c2a365d59b3b",372349:"f858e0fbc66dbdff",372371:"8d682c9a3bb753c0",372487:"a66e9f5e62e058e2",372936:"30ab0aced52ee19e",373369:"a4ffa99923513135",373404:"30513873626d267f",373795:"dd6d0651155b4811",373973:"b1f8761f73d4ff91",374135:"593809bf2b5cc92d",374424:"879874bc5bede675",374560:"b89e55265355ed89",374736:"b4fdcc0c702cf2f7",374750:"e78696524418c32c",374863:"6a1a317237c77ffc",374917:"85f528bfd66c685a",374934:"4bdd3765e882a7c7",374972:"5dc839ff2479399f",375125:"996d5f03a01c6a82",375519:"7240090af1d148c9",375558:"ab078fde2b526d32",375616:"00da8d8db6b0700a",375986:"05d44c957b98a983",376001:"b18a3bf4f34de512",376049:"ec04296a5a84ed66",376211:"5e607061c40dd878",376445:"cde5edbba5836808",376488:"dc73103cdec2aabd",376583:"6a5009dc726ccdbb",376585:"cf4d5c69fe1a90dc",376657:"4130ad42e6865144",376803:"1a086abb51e5b253",377149:"84fec82405d8df23",377159:"6ddf27f57283f9fc",377194:"4b8cd50003d7f425",377294:"0e34c6b4c754bfdb",377459:"6734190b850eb4ae",378066:"a3f2de1946d1a2f8",378092:"d5d7dadd8c5978d5",378117:"20a48e0f4fcc0932",378334:"5536a4808efa3691",378456:"cf560c053ea1d5e1",378648:"1fa9e12e34a0cbb4",379033:"00e5a00a289657c7",379104:"05f8332da3448848",379231:"39b70e1c17c8394e",379316:"d60565b4ba27636e",379786:"66cbfc9940e86b61",379959:"2b6c02e2c3696a56",380024:"a0f355a69d89a8a8",380052:"c47c229cb1223393",380127:"87f9d04e5fb25568",380282:"70e2574c3e16e45e",380293:"39903f3450ee504a",380473:"2cb336cddb507233",380947:"0710292da521c189",381205:"1ab15044ce58ceee",381274:"e228e8ddb849badb",381293:"4c975da01835efee",381637:"8c8a7f2e82b1edc8",381641:"4e14c0aeddc0e142",381916:"8d25bc7b5871b1da",381974:"9747f8d6b771b926",382415:"dc9572cf746d215f",382506:"0c80f001a75b2dca",382703:"ec700fb4f4e099ca",382787:"d4a8238ad50c1724",382874:"920078de102fa49d",382901:"bc6afc013be912b1",383028:"028cce09997a670f",383062:"3de9994dee88072d",383219:"a735b39629d7cffd",383748:"c75bc2373233bea2",383995:"9289fb044ca3e938",384037:"4c0a83fc83862ce6",384100:"b845182533afcb6b",384191:"36f38c82d841e67f",384517:"e68e80c5a3d1e8e7",384548:"83b7aa674f4ec984",384910:"248ea8d8dee61ec8",384977:"dc97bd808fa9e163",385299:"37ecaa5bf08b626b",385358:"9b8824273a5e7b46",385446:"0e399c430dd584d6",385470:"a015acb4e505aded",385565:"ebf76b4b77c728f9",385869:"f435b539fbeecece",386032:"505b2aaf7487c728",386347:"ccb9bb780c5bd443",386511:"73c4c0f5491f430c",386657:"b2b82b45d820ec90",386683:"e7f8a2f8bde8f784",386798:"b21e354e11dbede6",386886:"ca81d9201104110b",388216:"b089dcf02a05bd26",388262:"de89113404466d98",388339:"8df83784aad8f7af",388412:"bf3075e7b534da11",388628:"dae6e9fe6520642c",388664:"672e55e757a751ab",388777:"a9aa027ada2b5fdc",388787:"f4578facb8ae2e79",388828:"cfc99344c9404b6f",388951:"efb279b96ef7c51c",388997:"95450acb946f9a14",389465:"272d827fdcc6940d",389869:"3c50de2ace665ce4",389903:"3cc349e1919c97b2",390387:"6a36b0a36a2388d8",390580:"12af9a347c96bad0",390585:"4f8f129d50a41c83",390684:"6d617e0137d42ba6",390750:"0d19a7a0888cfbd8",390928:"d2eed6e4699ff4d9",390935:"6049b30be8ee7c79",391025:"e750fe501f380e7d",391139:"198d3772989c5233",391656:"297799aa850a9413",391679:"34653e6053af7457",391829:"4de27c6450049a2f",391838:"e0094b110e821bee",391952:"dcf768f0bd55b879",392278:"183c2424891639da",392313:"ceac1714fbe7a5fa",392796:"118abdcdee98d6cf",392907:"a93c86dab6258a21",392968:"7bb6d88874d1f339",393007:"9dd4bcb97d6984a8",393202:"947c86d7d1e84682",393258:"1904b8ec88b64062",393446:"22d42bc5c2a75af5",393597:"2f8efccf31fb7441",393735:"69ed0645f8a7e10d",393786:"a18debda7022c932",393926:"df62c3cd701c2126",394125:"8b2216abc50d3868",394253:"8fb5b5e0449417a2",394259:"678c238cf908b760",394476:"dd55e91a93aaff96",394548:"ec598dc9bcc25ee9",394601:"df73f42a083c2688",394761:"6d0f9738ca2ad3a8",395834:"d2c8328e790c65f9",395939:"5d684b3352b8654e",396079:"030f195946f7d7e4",396211:"562dc6daf586b87d",396351:"6e368db00e99481d",396362:"bb06bb6a0bd36d81",396435:"ffa3774be6c07d68",396624:"fbaafb55d32bef44",396701:"853ee106a85720d3",396848:"1ecc231dac660a0b",396917:"59ecd1b5618a2987",397265:"4ff1ae2e39ec8b76",397323:"a5e25cee9e2921fc",397423:"1a931e239550e0de",397523:"134bdb9f463c0e7a",397579:"7f675eaca54e0e3d",397782:"09f1f17a6cf5de06",397822:"d5aa466fa88e3963",397914:"a3f60a310a3805b4",398487:"132ba921cbfc2ff9",398635:"817c14afb66d9a17",398750:"2e6d94883b6acfd3",398842:"3648ca448a489379",398949:"ab6013db58e8e8b8",399017:"00b368d9b800a3b4",399442:"1e44ffa23ebfabd1",399617:"0fbfbbe7c5c61d39",399808:"9ac414629c54b3c8",399837:"ec2288f4c97776f4",400162:"9ac6204e6b8dbcef",400200:"cc42059f172f218b",400287:"83fb1de8605bcffb",400880:"f711f83ad6777dfc",400912:"624efe806b1f63d3",401199:"a0b41057944a94fb",401351:"8c7f497f9db9ec72",401421:"54085527bfca2530",401764:"c1a6a821afe547e3",401983:"69aac484f4bca0f5",402525:"46d8a97283e55c0e",403034:"612d3122bf08dc73",403275:"228870af8e2d4467",403461:"9926232cd5276e87",403528:"9e672cb3e73c3f2a",403626:"e59fb3e4b046610c",403779:"cb53f207a64032fc",403817:"c157f66d8ae34fd7",403979:"12345621d8a86468",404177:"4bcda1ecb7ddfcf2",404224:"9ace4cf9cc51a6d3",404904:"3d0129ebdba4f280",405151:"cb91ec0871484077",405576:"3fcc792bb05a60aa",405589:"05bfa9d8fabe8dbb",405667:"33eef70b9ebceb9c",405750:"44a46d0ae8547353",405851:"48a890d8cd1fddb4",405913:"c78e66c9e6d2c666",405954:"e334a4e8427bcdae",406294:"24de54bbdeb4171f",406472:"887681f925990b6b",406746:"7b222962da38b295",406861:"3301708356b06bdf",407560:"e802e78390eee7e1",407598:"84d217fed37e40a1",407783:"e45b1e2e7af9428f",407949:"ca777ff11df6e9c4",408376:"772ec01505265875",408535:"e1591c06e9f07dbf",408584:"716527278ebf1192",408632:"9ed1bd38ce52b454",408819:"2e060c6e59f5234a",409082:"f1ede7fe500c3e2d",409162:"39ad3575502f9e13",409823:"1c0075455248b54a",410047:"51c85672cc4a2adc",410166:"fa98d6d3d0782f1f",410202:"6168d650f973c61f",410229:"057c4d667c86d90d",410412:"5851b892ad1684ad",410602:"228c2afd57e76bad",410665:"ddb3f65fa2a4fd31",410812:"2990b6f114a410f1",411048:"b8f2126ed39b3f7f",411158:"ab8483a230150336",411382:"41dcd1badf30e767",412136:"b9736365d578fc1a",412281:"312c52d860c4652a",412850:"33e095cdd56a3498",413199:"8ee8c8826e51a082",413429:"d9eaaac3e840dbae",413657:"58dbe68c3d1d0372",413680:"48bbca18c871b179",413768:"7c85eee6d7e5dbeb",414176:"448ff21ebde6cfe5",414712:"ccccc1bb5020b9a7",415064:"d705a577486b69f4",415331:"9bf8611021f72d51",415340:"8412a2d7166d77da",415806:"a4de956d1c8c7321",415953:"0c696c9ed813b75c",415999:"a738c82974e7514f",416211:"110c858bcefde2b3",416347:"0eaf41547919db7b",416523:"3aa27fa77e529395",416682:"084fc6ec60418075",416791:"5dcc371902703291",416918:"7859542ab9b7379a",417220:"1af630d2e91508cc",417253:"9168eccac35150d3",417274:"edd3293e77ce8426",417298:"6bd24c4280b82f3e",417341:"95e0bc840c079739",417407:"1d678e303d8f8dbd",417418:"8a5236174a87b2be",417502:"d3698590aaba12af",417564:"3b9e25cd1c5e6d55",417589:"24ce591424871c61",417902:"0f4b91ae07a9ec3f",417957:"a224e204b1d5fe46",418035:"70d9c97a32f9318d",418143:"cee9ea71906ec9da",418185:"745607aa83820a0b",418642:"f3c58c14ac6cdb64",418676:"787d6ee5935bb6c5",418699:"4b98331762c3a2cb",419161:"9987872416791cbc",419163:"2e9da7ae3d86229f",419318:"2b3d79012736aa68",419347:"eafcdea730c4813f",419493:"7b8c65c1dba814d6",419562:"b329fa88dca7108f",419939:"abdcc72378a1cd94",419979:"f5e40c9ca3e21db8",420158:"a0541148f2c3cdca",420443:"e2e037f9dd8b63a2",420862:"8fb7b4a8a9368917",420957:"d3694c01d733d6ab",421174:"cbbab512d5aa1862",421311:"0e681f7ff530cbd1",421555:"07a7ace633d8b4f2",421632:"c50da98bcc41f703",422312:"c32a4b668b35c8ee",422407:"52b92cd39fa25b36",422410:"e2fbe6c2d3c16e30",422452:"b2c3789708554282",422616:"ca6e8a9730965b94",422765:"16f3982af799c253",422928:"174e0f236a93f8d9",422991:"2383e2e50d26a898",423017:"980807387131698d",423402:"a1421d2e96a89854",423516:"9d42e4b2df8ebc7a",423540:"c2232a41884258e4",423734:"064574b6a08bb1a5",423859:"645f712e3c29e106",423912:"7f66710d0495fbee",424091:"c746df9714cd3f3b",424333:"4ae14129983a6aeb",424444:"afaf03023accbf5b",424571:"0ed9bd8a34cdbd34",424665:"e6a9f54634760eaa",424677:"eb756c31e0cfd9e8",424693:"eec442583bcc2227",424791:"59d83b71c2065179",425026:"38cc702168dee1d7",425067:"0346ca4ccf4cb2f5",425270:"7b2fffce1638d2aa",425570:"c95745f7b3987089",425901:"86b89554de573254",426443:"829180f386187fd2",426447:"e35d2b75b754ce4d",427078:"a431ccac013f532d",427269:"477a51ca95e4ec40",427334:"e57c64e139733e07",427521:"0b4d5eb72b9dae48",427573:"6ac014db1c63e017",427903:"a579cec6a46caa7d",428256:"15ba4ad1b6a30030",428296:"40e536a0d6d358c1",428394:"0827e9cdf24fef6a",428433:"0e69bb3f3b613db7",428488:"d96886adef880b46",428497:"74a0e6fd326badc9",428508:"7d694c4928bc4663",428767:"1e27a52e991f2035",429083:"63a6f2a6313fe55c",429453:"fabf5e0a7535a7fb",429636:"9626f156e65206ae",430174:"513031d50f1cd7cc",430195:"dae7def811387ed8",430242:"b70f5bd2c7f93213",430817:"d45b78305b42df23",430864:"29ca873b973f2bbc",431044:"acf4964fadc74a3e",431245:"f62d8084801c1d8f",431304:"75f6ea33ba616cec",431648:"db8f880f83305fec",432106:"3128b6f58a1aa781",432412:"7d508afcc225e38b",432673:"552fd978033bd00b",432719:"ff25e0ea9a955763",433105:"63e4c11fd9ac0c2f",433112:"9b2fdd737ed44825",433282:"8d2cb224897e6d6e",433409:"f63356b62aaec3fe",433418:"4008d6319a62d88c",433454:"c03b09d856343689",433580:"a8059ea831697dee",433754:"7b4e6fb8bef72a38",433829:"55f6ceb0b6baff8f",433870:"1b2bf6eefca8d7d8",434e3:"6da5907fe23ae143",434055:"4dbc32d4686e549d",434249:"b436c6a0881f6f7f",434258:"b8edf78c6238a798",434287:"f80a09576709dd3b",434518:"eb6bb6217a229072",434526:"fa76c2a91c9c8157",434626:"4552d3c7a3abe1c7",434692:"1142952acc88e591",434871:"dbf1cbf483b697d6",435110:"81e4e53d68e837f8",435364:"c6c9cff76ff642cf",435392:"e7508a691848fe28",435588:"3e6c514fed763fc9",435805:"ce27ce7fa75017e1",436009:"c082d1464e2364a1",436058:"9e9388198748b461",436794:"c5202b117795ef56",436856:"b5cdc074eda12f38",437184:"ca55e097d651c7fc",437209:"e417d43c3ad9e597",437425:"f0343a5895b88b49",437762:"bb49f63cda6df616",438257:"81c1ef9b7514e745",438309:"d93379fef8b3f403",438587:"12b1c09e1b63d9ec",438685:"e38003bf31ff6029",438860:"0c53298822dc94dc",438912:"1ae79a18cbada0f5",439036:"56c2ce9eeba45dbe",439151:"af082b93f53b68ae",439370:"0787d5ae962fd33b",439613:"01d70e33b8c6c368",439845:"54752c1b2cfb796e",440553:"04999557720f992e",440824:"223c6e0705a24307",440857:"b89e11b932c2fcfc",441032:"857b98eade079621",441188:"3d70d4a4d75bcc55",441734:"12703eda2ecf5d08",442065:"1e7adf5ee1d9c2ab",442493:"4d95db5839ceb6cf",442501:"2a9085c8dd0084db",442558:"04b21a4bfa4a2770",442710:"256daa2092d41d52",443436:"146e4fcbb388f492",443750:"495f6d2bd9a27572",443905:"2bff430525ea367b",444465:"26d35b4b9c71899f",444585:"5dcc05337db1a5ed",444999:"5ab0da80ea9de864",445005:"4098b136ead9be61",445084:"bdaf2696e6332ebb",445170:"3bd7c5c321185288",445270:"873ef16cb94a0c19",445620:"aaf3be2c7853c194",446118:"ce66eb07bd03b297",446402:"dc44bc30bb1b50bc",446631:"0686ede147be5229",446848:"ab32c9b46b7c9bfe",447240:"94f3526329dd0f04",448025:"d31083c91a2ce99f",448226:"438959aa57b6cd76",448387:"e5f499a0f133251b",448557:"70825a5e03665fdc",448832:"e8041f2c8cffdaf4",449541:"0fe06e3b325589da",449744:"ac7ee8dfc007fdfb",449808:"98cbdf194da6e966",449902:"497110e975a71ad8",450067:"20ea853aa0f8f3c4",450084:"78fa6485cf42e166",450157:"04d197d1ba37e82a",450535:"068259c566dfac9c",450890:"e910adf9e7330ed3",450912:"b9e659ba4861d560",451060:"7d89bd169573a67b",451115:"e8ca86a54a393c22",451254:"29daa2d778489d12",451540:"c2f3d3aa6e9d2107",451796:"72403a08e2e053ce",451822:"4f0c14a51f75ceed",452373:"93701575a0c169a8",452425:"fe681150e63edaeb",452574:"52879094f62d5263",452579:"ba928b8cff86a8c2",452641:"3ae93bdf6a652499",452713:"8f33456479922982",453077:"0ff224a97758bc57",453120:"c0cde22b99932353",453196:"f6fb8406cb263b6c",453356:"4281434ec170239b",453384:"5630a968a7400f68",453592:"7c8d9a345cf3a16f",453793:"3ffaf1aae9290d52",454067:"7276527f06c8978c",454069:"e5856ea33d1a9285",454165:"6f51e316a2741f75",454199:"57558665cfd4acf1",454270:"66c8d11ce59d6252",454281:"f1a71ae98a4d0344",454730:"816406ae775d40bd",454835:"507f32eaed06db62",455143:"a9f7194ace6d5c55",455555:"06a2ebccd6c8db41",455627:"6d9fc514f0344bea",456045:"ef455f702ada77ba",456809:"0dbae42373791750",456904:"a32be3b50c41ea17",456970:"192bbd1d7bc0fcea",457375:"090a0c9fff6975c9",457699:"178208eb5bd85d5c",457964:"c6451fc2a7c35f3a",458276:"22a61997e396e276",458392:"9efe5daff10a9ea5",458485:"3b82d2fd6e52ceac",458771:"9ee510f306763e41",458820:"193b3f17b58d1e8d",458966:"8b4a8bc33598eea7",459096:"6e6bb818443ba80c",459166:"768c8c7ecde03a2a",459737:"feec1aed25b69d88",459982:"e722307c41cb3dba",460041:"ed2b9091ca919a93",460726:"bfe5ab5173a5337a",460767:"b6ca54d0cb9e38df",460893:"469e2baf59ab6484",461045:"297d24ef092154f7",461118:"1fc357b39c202d5e",461203:"60b3f6b3272f5e35",461215:"5c6c8d1ff2cfe0e0",461300:"3718e52d6c44909a",461336:"a906e7b63f3fea42",461409:"03b86b2f9083cb2d",461518:"8c7e7a39ec9c9505",461627:"f9a9dccf09ef5c53",461803:"6e00a73cde0cc403",462030:"42088e69781fb4fe",462115:"798f5cda355a02ae",462315:"a7525f27695e7be5",462478:"107b5747b9cfacee",462939:"ad30074d3911473e",463054:"d73f2cf782ac9300",463402:"27190e1d816b531e",463473:"68f2dcc9a0b397b3",463616:"d374839d1e186eea",463686:"1169f276dbb5694f",463781:"f413f5c6c5ac05f2",463911:"a127570f8dc110d6",464189:"a7925e615378c772",464880:"aeec812dd7fd1e57",465486:"aa01628558a83014",465677:"bd56581ebb020f80",465844:"389de49ad6728431",466204:"5ab8f176c1b4e093",466476:"2d2e6ba699b746d4",466656:"6eff869e60e73249",466887:"2fff36046baf53fa",466953:"6465b20d10f6c1e1",467007:"6be98b519c9b80a7",467112:"5218fe422f6a29c5",467208:"eb65e265f9e687a0",467450:"ab90140dc9ca4436",467608:"d4a9569f85f3e140",467764:"e2a4053a68b1b827",467767:"c14c22414ce90020",467785:"4f7b9c49edb5b88a",467997:"eada08cf06c358c6",468304:"7156453dea8a1e84",468318:"ddf4a6a879a7c1da",468341:"82997432466422f7",468472:"deddaac010ba6082",468557:"68dbfb1fc85e9bc5",468582:"0ac3970f35ae3082",468600:"9f4814fe17df3ec8",468621:"c201cf021cdcc459",468677:"32e5f86b1e596ba6",468734:"d5b7058500f2b160",468771:"0a162998d6bf7445",468880:"aa0bdc9d64dc8faa",469081:"a5abae867a3e92f1",469120:"0cc3b556ac8d04ff",469330:"aeb28d9f14abb41b",469338:"2f3e233150467b71",469375:"cf06be0bda5d47e7",469451:"0fad9560ff53a3a6",469482:"80d7eaef5323539e",469648:"26e19e34ec9eaddf",469894:"e12c638f1fed1764",470175:"00a459a2eb8254ad",470182:"87f613db3c359698",470225:"37814d5b0586a197",470366:"73a6c8b937e507fb",470676:"53489bd40b8b24f8",471136:"486ccea6f0b4cbfe",471154:"d738c29d7819447b",471451:"ec9b46dbf3a237f3",471482:"53557eac2da92acd",471678:"2e6d8e0502dff7c6",471726:"030415c7cea1d5e4",471782:"5e06a22edb386192",471816:"2aa2e490a0f0e665",471920:"1b2b1bfd26c5c114",472809:"59847e015cb2d9d8",473432:"3b95a21177c54a6f",473442:"d88edce5d5ed02de",473676:"c7f1e22ed512768e",473985:"187b60f7141f681d",474515:"75649395302946de",474833:"dc67b516b6597abc",475086:"b87fc84a86cb196b",475707:"f1bc1fa2924d2bc6",475758:"550d4150dc1ecfa0",476023:"06580fec5c41566f",476293:"929ee4fd6bdf3b78",476476:"c93b5a6042489904",476547:"3df3a2acd75f331c",476843:"9677c802106116ba",476896:"35ce5f5b4efae00e",477078:"c6d305e7d8d7e1d7",477209:"b51038af26cd2bc8",477486:"a9b639d4691b2f96",477661:"d582f0e9a4c71ede",477697:"2e261f30056c2c8e",477747:"0a528a863cea79d5",477897:"60f100601ed899e2",478001:"eb7703b7d3a1875b",478053:"52ca87a71b98db43",478345:"9e51bf3b0f9090c9",478432:"fac32842d28c7858",478526:"0919a33c573cf6c7",478746:"a35f08d9d59427d5",478755:"f17304d2e05d60e5",478778:"c6ea7c30e4179052",479010:"321fc3fe80807c97",479071:"918efcadda68477e",479130:"6a0ad17821649c61",479574:"c99f8fcb5592498a",480002:"5f8f997a7051f2fc",480041:"c32152cbc361b4bc",480253:"336302697db35f8e",480809:"edada5551a301c92",480859:"7b28fe7f10f8e676",481166:"809b7f6063f47b8a",481505:"fe1e649808597318",481516:"bd4803f0c57922ea",481550:"b6dc3a3c24f716da",481565:"7aa1a1d2d1e1c659",481647:"b05d7f92dd0aa4b8",481683:"8f1fc7c03c19ba0e",481694:"e648fd32224fc08c",481897:"7c9f917648390c91",481933:"1016823952833ac6",482080:"5544f8820dbed11c",482098:"fb9a487173f97bc0",482230:"28a04a78d409db35",482722:"5acdd5f2089e7e15",482822:"2621a51bc404e2ee",482991:"3daa3cbb8f2fe4c9",483107:"e9a132f4aa962e57",483240:"5f99121b67deed02",483423:"860f23280628ca34",483650:"7e897528194b71cf",484671:"dd3d4fe859ce9ff3",484713:"1c0601f2d40b10f4",484787:"432aaebcb4d4f621",484873:"0d064263895d797a",484964:"e79b21d9ca7dc28b",485197:"5ca2b99a0ab90c0f",485491:"8825a96139bfc690",486007:"4f08b3b7877bbc77",486146:"74ff2b9d7c485cbf",486194:"7ac381502c0e90a0",486855:"7ebbb2857a245c37",487034:"062e10724b929bae",487086:"ef6d2ade562ea836",487142:"9aa0a68527341e4a",487310:"3394be5ca26f4b8f",487598:"e73675320946f704",488029:"20ed37ff6b88a138",488189:"4ffeeef1cc9013b3",488338:"88d7abeb369a00f3",488458:"e5b92dbf8ed564b3",488729:"e353207c3998c699",489109:"0909804a53da84f0",489589:"bbf2adbdf88f61fd",489869:"01272a9af3e31077",489931:"5d7a20486e0b4b1e",490650:"dc05a941ba189ea3",490842:"8d5f2b99fa9acaf8",491029:"a5cd85a5f043817c",491036:"cd8a6033ed03e726",491448:"fdae8bc612980755",491645:"4ca1e726ee588048",491773:"3e4b333096dbd3bb",492034:"adf22287ec906168",492102:"44c353fd4d4a30c3",492444:"fbf1882ebd96b963",492521:"c4309da6d566c6e3",493121:"0915a0d46b11e5bf",493200:"4bdd726106b2e4e2",493235:"0ad39051c6128f01",493245:"b818bc7dca358719",493352:"d4224f520c87bf6a",493902:"a8282c7a014ce022",494101:"8f08c938e89a84b3",494217:"b538ec3c7315421f",494810:"746158caf04c7c9e",494954:"b4dfd055aac5f21a",494973:"088542e08dbf061f",495049:"1ccd143d800291c7",495447:"9fb267dfb23969d7",495570:"2464c61920e2c5c2",495830:"d932463d20dfd993",496106:"682aacd7c32bc07a",496232:"b090e632b6162f52",496334:"0492951ba556c31a",496488:"63219a020dbeb6f1",496656:"06ff71afb2123612",496968:"b6e990ad3d92239e",497089:"1d3d720412bfd415",497130:"8e60111e0c2bf228",497507:"8d511a5b80462f8b",497606:"f6ef8089533bdde1",497979:"8e167918efb8507c",498261:"3ba21d520ed0e999",498436:"b77ff722966226eb",498846:"cdf7461eccb0e06d",498977:"b23bae8821a4accf",499112:"19e8d5792bc2fe3f",499182:"0319777acc1cbbe3",499240:"3bc9d45c69b7074c",499563:"094d641b8f69aa85",499648:"00b3cc583cb1ab7a",499945:"fe6e0809a891ddf0",500140:"c3c28a1c433b5ffe",500385:"00c4fc19aefd4d0e",500397:"94c40afb0b1fbbff",500637:"678778b25971aca1",500658:"54019a5eb9bce4ce",500772:"740f7e87ea4db000",500906:"9e5ac833136022a2",500923:"7155ed9a5c912f4b",500987:"a655af829128f4af",501021:"63bf07eea007f238",501129:"e68210b2ced55fe3",501131:"87f3587c70135fcc",501375:"b89deb303b5d6717",501498:"8982541aa4b2b014",501612:"9dcb19fb049ecca7",501749:"b39f71c509a900fa",501924:"7d3982356029e7bf",501990:"3f4b9df33475a6eb",502027:"afddfc36900ce5bb",502029:"c5fb1cc4afcf88ca",502147:"fc0b33cc4deac130",502219:"87fa516d44121eca",502376:"5f905146507d6a08",503013:"b72f62f745eb0d8b",503266:"431e4708abd03b9e",503292:"50c515e011278b70",503743:"82ad4b4d5592485f",503908:"c539d78513bdfbe0",503940:"d80c13fecd3e054d",503966:"68353dbc41582cb0",504299:"3833afec0d476dbb",504317:"f2a8b02c7425d60a",504411:"0b2874e4184cc566",504484:"413f84204d0cf8d3",504631:"44c8277e51fd5c1a",504703:"5f73891eeb2b6374",504759:"c1d60e02e11fad1a",504818:"d950308cafee2737",504858:"841e944307380dee",504881:"81b142912c9dc07a",505213:"41a71668781ab32e",505258:"9741420a8f6cd5e0",505338:"761d5ad5156b0af6",505599:"b5e4de722a496141",505954:"795851de1ff7ec92",506020:"c8d56514d628815f",506063:"388998ce6e36fb96",506197:"ae59b5a6870e6fde",506205:"3c82b765db6e655f",506312:"bb9a9b82536fac61",506552:"8dec90aa3ea98e10",506693:"1de892d354418973",506841:"39eab6c455ed7cd7",506886:"7625c042fcfe5d2a",507004:"27d5936abe401fbc",507328:"e776b5ff63bba21d",507413:"893f756947b2fa39",507469:"c08f326c4668208d",507518:"4bcf5133be1c896c",508025:"68815fbe0df9c4c3",508058:"baee731a2a541511",508124:"a7190f23a971e45f",508183:"74ddebf47e8af0df",508743:"d6e4c6579ba901be",508751:"770d6774b1c4a823",508954:"54217bc91f74a045",509228:"9f04cc14c048f167",509352:"4df4c845d942cbc3",509379:"15a10e9817566381",509902:"9afbf90741796cd9",509912:"d85c2b1b7037b3f5",510104:"815ab5479dbbff77",510175:"d77bddedc1ca43c9",510248:"861ef20967fbe7fa",510318:"6de568aab7dcd9af",510510:"d9d35b60565ceab3",510784:"6c05144008e2f5e2",510906:"93e002dc3a7a34c9",511096:"c1cdc34dbed7f903",511141:"f1b9d43bb72fb706",511290:"14f168b1dd9c5793",511402:"75ffed24b653e2e3",511645:"378e60f0dd7cebe9",511908:"5acf96bbedc2368d",512097:"41ce775bbc6576d9",512159:"b5013b7fd1742e8e",512165:"a94c1fa720c3579a",512764:"720494a512811a51",512767:"1531b11a4c6f54a9",513478:"0eb53b130ef9821b",513640:"c9e158eba4f4295f",513901:"02d15c691e4e9558",513968:"e1bfe7d69185e383",514027:"0902c440b65ff035",514302:"2d83642f6a9d335a",514354:"2d59202002509c54",514381:"e3a3bde89bd793c2",514456:"120208dd4df3cb12",514512:"fd7e1cc61c64a6ce",514533:"f20b303ad378f846",514621:"57ee910b08ea8675",514727:"9675c45ea05bf4be",515061:"429b0b8792fa0990",515450:"6ebdce62f62af87c",516095:"502d2677fc84fc7e",516312:"0d9fa1738952bbeb",516575:"65d56549a5667de9",516703:"5233dc926dfcf6e3",517097:"7b1954e0e38833e7",517107:"5df1710eb5d4b43b",517124:"654a2968d0091adb",517242:"4dedca1dce39a428",517428:"dd0572bb81082f45",517475:"42ebe4eb0bba2faf",517495:"70bdc46ebaae6da4",517583:"1155f676e52e6ee2",517866:"b34a9c4ee6f5cf1a",517965:"dafd85b17a3e79ad",517968:"aab4144bbd5e7aba",518168:"01e658434def10b6",518254:"2579bab5c9a28e90",518404:"114a76feb95e22dc",518639:"d8e2d9f48aaecf25",518809:"8c6c505ebef18cca",519078:"5ffd6f9616444d6d",519109:"7aebf165fc0dc8e8",519135:"4533b900048e758f",519319:"0187408a9fe4c91a",519549:"1e733c447d087d3a",519853:"6dfb0acd08418bee",520320:"6fda37a3ea4f3e66",520351:"af7131ac048a7f9e",520401:"95b846d5e380454f",520499:"7b2bb3ef92213e25",520666:"6da4ead3a48bcce9",520741:"88167013571850d3",520764:"424cda6a21e56dec",520873:"c5dad8efed2e4a2d",520930:"7afcd7ad43ea39a3",520945:"18d0858e6b2ccdaa",521112:"1e4c30b8c2774b6c",521529:"e57cdd551ca9cc59",521705:"d1e09f71a9136789",522024:"2ae88afe738cfaea",522540:"5803024530e7b676",522580:"7334736d20742f56",522764:"65297bdf240eb5f1",522857:"8b5a41650ca738b3",523041:"ddb139701e5bc09e",523046:"d8c103dc0ee2e321",523190:"f21be0a5cdebc275",523537:"68e42067098eb328",523655:"c870b43b7144ac11",523747:"2795ad2209a972c3",523890:"90a33c6892c5ecdc",524090:"30856dbaa6270458",524177:"c6bfee26ee07763c",524179:"68a91a98cb908167",524282:"46d62706b0617ab6",524364:"e80553fee17c565b",524489:"e32e4b48e6ab4e99",524661:"20cb4543d93cdb8d",524944:"3fa8188a5b4d9eb4",525110:"55a1d130cb23245a",525145:"f3de73a80f8ad925",525575:"2cf71ba79a8c99dc",525938:"2990599346d09742",526124:"761f9bfa011f576e",526811:"29b0d2d9cced2393",526822:"32bf46e4a8c72f55",526917:"1721cf359b6c9504",527246:"920a72c381021907",527639:"7796e91bd81bde75",527782:"4f75493c550cd677",528186:"a113f6682115710d",528187:"1b1e093624b4701c",528224:"9c118851a8c0488e",528706:"55c200cdd44d3a9a",528749:"cc4e632f4b552b0a",528952:"f53a77cc53ec07e8",529188:"46d40ac18efeec8e",529401:"b3d689f973f24be7",529477:"3a8379f5de8587c7",529497:"aba71316981e2022",529544:"948cf22b8c037bbd",529709:"29083ddc1ad6bab5",529735:"7a7b3116d73579b2",530174:"b65b1d7d1fded148",530321:"29e9bb98f689eb64",530420:"bf179fdb21729ee5",530702:"72ac3207370e9769",530977:"9e143a9ad45bc4e8",531354:"18802839043a369c",531521:"d14c497c5cedfddb",531850:"899e1aa8c2347920",531908:"78d7022a4cb8da4b",532528:"9c120072c758d25a",532608:"f600ce01bccd4a25",532640:"07a539ce4a4053cb",532647:"dda6956a7cf71de3",533157:"a944989a55a3aad8",533199:"65836cc8909e2125",533485:"86e981beef96a163",533884:"6d6e043c6080819f",534179:"57315adfe81b8d0a",534250:"945c4b1ab672d068",534279:"430f9295b39d4f6a",534311:"9b51d495dfcd0f35",534548:"21fb580e3fca168f",534653:"f4154d58d0debe74",534918:"7184e62f61cac769",535108:"bf028265ff349e95",535132:"c204ef8024be3dae",535376:"d3b71a8a381478be",535587:"12ede49b06b45425",535731:"e6030fd86d591c4e",535964:"4a3422d071a78953",536133:"b6dc10dea2a8c234",536217:"cdfe5839baca1295",536227:"c5d54bf04ad39789",536345:"991cadd7ddfa72f0",536397:"a9fb3447562a9346",536416:"3ecbd138d3aaf7ca",536714:"45249f1f6fb08022",536821:"c16436139fee6225",537446:"1b3fad86c453dcfd",537481:"8f2e01acbc4729dd",537559:"8333028a7e043ded",537633:"329aafea7e65fc62",537965:"8b47970776a414fc",538001:"e4e34fd250e9e694",538430:"848e56e83918dc11",538431:"9d17782388bf3bac",538542:"14d6da0114efb980",538552:"48d64d63807d3aab",538576:"6378878b6b1fe226",538783:"fb87759a98495c97",538883:"dc02759a29c62b3f",538988:"1c9277f161c5d253",539098:"a2f18d912f6c90c7",539308:"9b8a10644e1e1268",539706:"8a366d9fd62ccf81",539829:"6c2275dc2b87ae13",539862:"b5e60a149a4a8f05",539872:"d41db6da1acaa221",539974:"f0a4aad6d74bbb01",540028:"be97757e96db67ce",540150:"b578fc3b61e4d6f8",540355:"b2ecb67a21150685",540826:"af46f350c135bd9e",540866:"36c41901140b2448",540967:"81f1b3b75707c9ef",541071:"e8f3084599d274c4",541309:"99c6d6eca98abfda",541707:"724d6fb39a79d106",541895:"c6f8d29ac889920e",542061:"a8f3996da41ca5a6",542282:"84df85ecc1dd138c",542371:"7e75aae47a1b5087",542944:"a9239da5d6faf357",542985:"485f103f92e7a0e0",543347:"c77a10b8f1e311ac",543406:"d9027ffa27503377",543458:"c411faa69dfb7405",543927:"6b58c570ff93dab4",544125:"1bb5ecf9fbb698f4",544208:"d36c98b23b213c95",544260:"42bd85252724a02b",544334:"9d503db3ee015931",544462:"1f90c4caa62b89aa",544481:"72c1c7d3dfc16463",544570:"77cd5e9a0fa0df8f",544696:"81fb42614f570afb",544949:"f8db68387ce994f3",545130:"83be3c01d1b546f5",545321:"806a7c40d474c0a6",545730:"da74eddc30457c67",545965:"81e89406010f8686",546149:"51a566b9c6fa6f20",546310:"72bb9f7572c1433d",546453:"dbd163c25a0653c6",546584:"238ae0b445081f94",546639:"f6a533b31ac60305",546713:"7b80577331d8365c",546823:"476417c82358960a",546894:"94de28d01f292056",546921:"100a8f535a9078f7",546933:"fdaa799a4113e5b2",547140:"4a60e6181257c4fa",547296:"c3489074628bc0a0",547331:"e24bf72f9ce4bbff",547540:"925ba56977e7c810",547869:"1afb6d411c263dfa",548283:"079e29b5d033d32f",548715:"0f16c3a2443fb98d",548906:"e782e6c4f60f2631",549087:"6c408a8a4c094297",549333:"1211d671943e4cf0",549782:"b42a772a7461f37d",549784:"7a324b1694c40825",549830:"cdd7619e7fe60456",550099:"1ed940ca13b5542c",550142:"2bc6ce6078ac5908",550547:"15cc4f60c925137e",550946:"96806c9a725604a9",550961:"248fcea336bc6c03",551011:"923c7fbd12ba5771",551052:"2dbe5382553acce9",551072:"f7121fc21d5ed7e7",551312:"c71de48999d2938a",551792:"e13ace695a6df597",552241:"125490e72147281a",552534:"2455de183f84f65f",552857:"fe97ddd85eeafcaf",552876:"ae393f4e3b409046",553069:"d2167afbbc206959",553211:"51875fe98bcf2813",553277:"02787f5e3e161e00",553460:"c1eb78d9f125005e",553802:"836b67e39b481549",553829:"e7d580a3321ffb08",553909:"18e7a4033f164512",553949:"6f92e6de597816fa",553990:"0cf122c6b9280e3d",554018:"7f43534f0a7803b7",554223:"e57cdf1b00dca6bf",554556:"7615c9e4868895db",554572:"a3b8d87d5f2492e6",554648:"7ddd7d587bed3da1",554922:"892aa8ba6b965d15",555204:"55f6d56f52c0300b",555253:"1ef081c422e00bce",555549:"7493ad9687a1a49f",555919:"229ee70a72cdd3a7",555989:"7ddd886177a37811",556046:"723241a7c4b25a46",556272:"72fc20e38efd8557",556923:"31e9b1aa187872dc",557787:"33a17637f69793a3",558035:"e973969f0035733b",558146:"7214b251b5e21481",558444:"f0ec5dc7a04797b9",558582:"19b9d0a88ea3f008",559067:"97b7b799174a7d0a",559310:"2a7f516cb8491971",559401:"bfaa117cc41d33eb",559508:"b95e2c5b535611e4",559512:"4f42988035878002",559667:"d48c0c3af9faaa4c",559706:"080386361847884e",559752:"05d4190214dc8b16",560382:"0d38a19cea470603",560667:"cbaa34239da5b87e",560811:"6ef443694bc5cd7d",561031:"496089a66d858ba1",561167:"155d2467905f077f",561665:"ec39d6861af68dcc",561776:"b766047862144898",562050:"f95d6d6eff8eb0e4",562066:"e1c0902a69cd3d41",562293:"98829a2b78312e83",562472:"3e46d5d374524b44",562929:"17ad98863f55089a",562985:"772e01c46fc61c61",563017:"e7135a147daef693",563337:"74571be3995132c5",563408:"2326ad79df3f23f5",563950:"b4234218f2f25b2b",564145:"22588be5b94b9160",564270:"c2dfa1ce91daab52",564878:"0b4083463b6e1063",565110:"1b7dd114752b5264",565306:"37327eb595a69481",565477:"a65b006e37cf8490",565656:"4593ba11a1b4de94",565748:"90cfa55e178968aa",565810:"125d7114f20ba86e",566050:"f59fc4a932b4fd0a",566152:"4dc035edcf580336",566467:"1250de6f4886fe5a",566493:"f7088d8b20725828",566525:"90db010ba55f3f3e",566693:"568b718232d193b6",566896:"e4e2139bf677a108",567017:"90993816d593015b",567103:"5a995681d0180bba",567856:"f51e12dd138132f0",567883:"1c495f9b422db668",568336:"6c1ccb9ea4934bc2",568445:"67337ac761bd3a44",568481:"fefc3ef5ef7c7569",568740:"faed12df3ae988e2",568770:"280076a60912b00a",568810:"1948bf8591e8953d",568847:"659c97fb0439dd69",569109:"4cc34309e0047b22",569545:"a08bd75ae42f865d",569790:"054d15abcb529a37",570152:"2f6802e221ba9046",570181:"4a248436c91540b0",570266:"a41097f54f690b80",570500:"3732f6e17cad54b2",570822:"d3dd0ad73577c5e1",570841:"0087dc8eba4c4c99",570872:"f16778119ca64e97",571352:"d80236e8da1b462b",571383:"360f2ba0595c258a",571805:"ff3a57a3f26aa5da",571807:"ddfeeb6ec1a3879e",572232:"410cb5a4557ec02b",572324:"ef620fd4406157e5",573051:"4c0f1f4a611ffc65",573067:"2f75bb758e776254",573801:"7d93c6bdc67be52e",574091:"f31c1676fc2f3915",574322:"160e3e7f03a733e9",574329:"6f7bf4d02911c44c",574516:"6dee6e1aaa5be14f",574783:"dd1c715cb5fb5a16",574853:"69044a43db70316b",575238:"e3317e2600379819",575363:"70d1ff9ac29ff187",575533:"09d3ba5c1a3ada3a",575870:"95c16986fd01492a",576118:"697e199e77fd0ca5",576807:"50542419d0bbaac3",577122:"fa72345a8d6a1eab",577550:"47e9b1134af6acac",577808:"59690accc237996c",578195:"67ba7f1b0c509529",578339:"b3345b536da70af5",578454:"eefacac572a96b45",578609:"eb496648250f6b78",578634:"8b6220c7306e0dd1",578857:"013f9b82a410cca0",579088:"bda6b9e8f938d85f",579197:"67a14d62ad861858",579814:"b85fa63c21d85051",579821:"6217c58fb2bf4900",579880:"2f942dc7ccf7681c",579947:"dc633143b8aee41b",579984:"bbdf59d58fdc79c9",580016:"cd6d596be72c24e1",580093:"5982a1983a90816c",580317:"f2142caddd4b541a",580540:"3b2ab35d9b8af284",580562:"9d69fad137e3afd8",580570:"8968bb73ae0c8613",580584:"f2994b187319aaea",580648:"1c8f89c31db7ecdb",580907:"5133a61bdc7941ae",581148:"fe58971eae5e2fa7",581159:"c35ac447e53eb0b3",581249:"9c87754af951c133",581682:"03ace2bf377a0d88",581696:"31c33da1b3bc183f",581706:"21cbffb6c13fe342",581783:"54beca0f7b1e6bd4",581933:"f986bf6d58165dd6",582207:"f2f1c71a67aaae28",582271:"46292edd5edece1d",582290:"ccb5a4e381318aab",582366:"f9ae4dc32cd84457",582418:"d01f18d17ef44a20",582439:"54472aaafb693289",583005:"b917e1a63bd61226",583059:"a9e0dceb6c6d53c6",583110:"ed4b6835067ca07d",583194:"c8d37cebae56ea77",583320:"1745463902092585",583438:"2189ba70613d2fb4",583527:"691cabc2cf1b1609",583607:"d26188d4e45ae000",584197:"ec978b37cda74974",584331:"b6a0c05191049085",584539:"511f8d16aa840f49",584751:"ca8ac31a704ec8bf",584836:"a262fdf49fa436f4",584885:"34233468b1652de4",585077:"eadc04bf27e019e5",585108:"daaa13c3efb958c4",585819:"791ede7913745d56",585843:"f88ca1239564511f",586060:"bdbca2c0e7045555",586090:"7f0f7033881e95b5",586131:"40d1c0817fe16624",586395:"afb12bc5ccfa0552",586496:"6825a7cc1c7c92c9",586509:"3d2406dbc9bc81a3",586754:"c7a8be2868388dd3",586989:"1ab02e47ba8ddf61",587125:"d2760f061b1a52ba",587150:"8c612699c09f6cd0",587384:"ec13514205140b0f",587574:"bbef18207797dbec",587793:"d682b8b0ecc5158c",587846:"e381dfe5ad5499b5",588026:"2cd425fd5b1e0aa8",588243:"efb30a731c8d55d4",588314:"e02194ddee7811b7",588531:"252d5841857de4a1",588720:"d2c0424f9c636644",588890:"3882218f28265d9a",588891:"42234db907d139ad",588919:"cff84ead79605998",589010:"14681a545deaa577",589015:"26e1042db7571d00",589167:"aae3578e3eed99d7",589407:"415b3b5f9c38949d",589544:"24993f6e909a5cc8",589814:"aa12917238b6480b",589835:"3579e06112c30131",590049:"738453368ffd6da7",590631:"fb60bc19bcfe760d",590773:"4c2a9ec5c42240e2",591068:"f940a8105d285591",591366:"8660580b9a35ed52",591460:"977f29899cc06b24",591494:"61062e63db418620",591679:"8039cb64d61054f5",591736:"7ab9694117ea641a",592475:"a5a595d77347c8a3",593492:"42109fd0aabc2dfb",594236:"c6bc4bc22050099f",594449:"261417ab6d341f4f",594772:"9c50411e6c5318d2",594819:"33f70b6da076aa80",594881:"06c63f0590027742",595121:"2d80f6bb5eae0eb1",595162:"65fe8df0a476e9e5",595341:"aec751247b7db792",595487:"10eb3cd3064cb272",595518:"9e12da930ebcfc1b",595862:"2a6de6940594cc2e",596007:"9a41a534875d617a",596021:"7a1f1aae58c20c51",596269:"a032ba471070ead0",596836:"935a10fda8fc8fdb",596893:"5270b7493c84e8e0",597003:"c210603b3a6e6cc7",597085:"c7ef45cdf0741bf9",597266:"b885eaa151a2e6ca",597317:"48b5cb6e7053d5c7",597548:"ac0d94ae33448ad2",597554:"c39b70306c23eacf",597828:"976eacb0a2e35cd3",597900:"585f7235f8a3bf6b",598156:"e02c06a2f6cb6fb8",598523:"e519d1e3cd52d0e4",598731:"de1e5e826942174d",598805:"25ff0cb9ee399e84",598993:"122548aa99695006",599581:"36116367a45fba42",599650:"5a7774fd087a1a79",599657:"137619a40df70396",599710:"0f03c5b5b8089bbb",599928:"5639478a65b26caf",600057:"7cc8a175b9aa823f",600132:"250b71e718874497",600284:"9702bf6211454898",600629:"977bab2371790589",600809:"03cc2e051f1328d2",600950:"629a18d4c5e178cd",601046:"893b7bbbc3b5704e",601638:"94c26aafc06705ee",601938:"b9f22007a57301eb",602064:"71ca516336f78765",602243:"c3e11aa5571b4dda",602460:"8793a336ff97fa09",602478:"fd2ad1a53c7ec43c",602536:"7faf3fd77e1d594a",602764:"bc272fb63323d65f",602936:"67b359bdac9f2d08",602943:"8a8ddb6c2bae23de",603286:"a2b0bec28c11cb94",603576:"a8e6d29a2d89ae97",603612:"035d09d07edf9808",603657:"8295841fa3c6cf77",603683:"f0664212f2b4c9a0",604068:"c550cbddb51f3ce5",604184:"bf476efec04a61bf",604340:"59163e6864355f20",604918:"98b660339c14fff8",605089:"afc6429a662f2699",605363:"e6671cba939f541a",605443:"1b7fdf532864db7a",605543:"5c325b4358c467bb",606085:"a2527fb70c71dd39",606091:"24bb3f626cdc835b",606208:"0660df8db0dcf731",606317:"dc9cf776cb4cb3e8",606408:"0451841d179f2172",606508:"6669fadb929a5783",606545:"8a9467a4453194bb",606695:"fbec5ff1446aa4f8",606768:"38752795cf7ecb9b",606955:"67164d5d3f609939",607673:"0478483fefb8029a",607761:"bcf8a7010d355cb8",607897:"68de83d582fe9b4d",607932:"d018048ce5252b1a",608094:"a3920ace8fdb33bd",608108:"d2131e8d8328fd26",608656:"dfbddfcdede4121d",608983:"80b63f6275cc9280",609050:"72e036c6f872207f",609339:"feff603d0f136131",609436:"05a1115df378e93b",609468:"ebbcd03a06a5407f",609652:"d3c87c8295cd1bd5",609679:"3b982c4aecfa318e",609916:"6ea136878ba97c7c",610190:"47f77fbebbdf6dd1",610319:"ae2c09ee7120cf42",610501:"5f82c5da732cd5f1",610542:"197357721cfc0fcb",610652:"d34237549ad0ace2",610898:"2570845c50d28e8f",611304:"a32122c8670998f3",611682:"76f05ea6e6b0d993",611763:"5f135f2922e9fef6",611859:"eb8c742c3d936eec",611917:"03fd8fa5aa8119ce",612083:"78a634c666ae1cfc",612389:"0a4c5febe4ac97ea",612396:"7927e70338f0c796",612486:"9e689e4931e66c39",613103:"edd8c470da1d8931",613291:"d48d760ebd1c81be",613299:"4a369f1b64130ff0",613306:"065267b8c0cb8a9f",613354:"0af4cf9121a3df46",613392:"8d5ce7ce90d14566",613549:"d100d7fb780d69d8",613609:"89e676c57477312e",613732:"51c77873b609e6fe",613847:"7669fb84ed4fcb90",613980:"0704fa5826933f25",614268:"d6b1cf6816cde4d1",614377:"0c501940e8e07263",614401:"5dd41c26bce4b93d",614474:"be2ad4556b1cb66d",614493:"eea682f900af41fb",614542:"0d08b186a48485f7",614634:"42989e919cd30a57",614646:"30048c2842280d28",615066:"cac2913491f6107a",615798:"35b05c974a816b0b",615837:"8ca9f08df6593e99",616037:"28cee7310a0366b9",616045:"f32d8c0007580d62",616940:"12aacc04f5a63d41",616948:"254c36ac407ee43f",617031:"93926f69f7bd7995",617045:"9068e5f3843d0a20",617263:"a0f92bf6ad944ae3",617434:"d6113a0c08aea349",617439:"8ff8af97fcd26cc3",617557:"b783b94200012b1b",617662:"cb9b801b99a32f43",617794:"79f3df6172851805",617828:"e92641ca61e321cb",618364:"0bbd5c08a590bd23",618719:"80fbc8c3a2bff436",618997:"8e4815f69620f18a",619114:"315d288cdb54ef99",619228:"7e9b8cdcb2c157ec",619599:"56936be82ec1af55",619908:"3fea471aacb28748",620047:"cedb733b5191f59d",620188:"37e49a3fa8bfd377",620272:"c95c0be6e475485e",620295:"9c6ce8ccc9075d56",620356:"4a1dd850702de863",620545:"ed2a59754dd909c4",620756:"ad492f0eee7ba1ed",620948:"7317e484b4848f7c",621372:"abba12de71038a90",621886:"953dea74cf68e275",621993:"e8f21c1871e18c98",622042:"cc161849a4d947c9",622121:"bb6e0b082ff1c492",622504:"6df989739b7ca3dd",622999:"5f41525d97e7349f",623025:"33c9338f2303c395",623213:"9de70021db5526f1",623568:"761c16baab9fc98d",623675:"7a14a7f5c626714b",624556:"cf58c8407fe9d1a1",624764:"616cc1254fecec28",625041:"3e97733f0ef6dea1",625181:"2957843254de09a8",625535:"5f3fcd1d39848322",625622:"4fb895daaa7aea00",625702:"44f00f940354dd67",625756:"3006c7239725b19b",626192:"0631a240eb69a6ac",626317:"8be81982c22f1928",626332:"ccd8d1bb6b64c9c7",626510:"ce689cacd72ea6cf",626759:"c3d814e8b5b41de0",626886:"772ecc7474cc170e",627386:"921699320e85c31c",627455:"7036b448b714fa65",628087:"601af4b122b5f400",628205:"2ed3e5f00ed7285c",628471:"ba451376db2ba03b",628564:"05f964cb4892bd74",628746:"3c21c3da30d44b7e",628907:"944af412dd828090",629095:"430fd9eb6c722634",629741:"17fc0ee373f0efa0",629837:"4b595c7d3ccc0c03",629844:"f649c472d5f693b3",630154:"d5517e5c4a0e0fad",630291:"25e193433c343200",630384:"b3f8aa32e06e1999",630669:"b8459d21d4a73207",631286:"41ec6711ec69ad2f",631702:"8fe0aea642fe299e",631967:"998b46f1c14e3c40",632022:"54ae7b1f5d8d5993",632121:"0038f9577a99eb75",632323:"d56f361880f37eba",632724:"ca5e6eced05745a0",632940:"c9cfe5b551a49bf5",633492:"4c76e8bc348b987d",633586:"34385a69589acabc",633639:"98f4d59cc8ca446f",633642:"8f7625ea8598112b",633738:"b3c9580487e0770b",634075:"956678e65c1847c6",634692:"ecc5ca4f3769a841",634879:"7d87cf7e75180d8a",634884:"fca55f91c9f8fb40",635024:"72ca1517de7679c5",635329:"f964f8139a47a360",635409:"90b2802bb957c6f6",636730:"ea18d108d2284741",636759:"9668e7191d26cb8d",637693:"b578c6b82e4bd94d",637754:"6618ec8ffe720a3a",638002:"2dfbced76ee46f9d",638386:"22442592184223b3",638437:"bbb31a0da1932004",638707:"9711e878df96672a",638952:"13505dafc9b17215",639007:"fa18c1e7bca80b65",639036:"f2723e0e124b4d2f",639363:"f35f690b4fa86797",639624:"2d35c0575ad4ba6f",639874:"f2d4ec989a902e8b",640221:"ea8c42a0149a8623",640583:"e5c2a749f0b2a7f4",640628:"cabe8187be4bd73f",640756:"b9ddb3b78c3e1c0a",641007:"28299d6f64380583",641091:"692cabbe1d0160f6",641127:"286119d514193af4",641143:"96e5ef55e551659d",641272:"cf409655591c37b6",641491:"dd4f7a4a3a6ee934",642143:"c11806b125204bb3",642575:"669586ee1be2819d",642699:"fab0936307472b2f",642742:"24d5f49719581ddc",642768:"33ef3104c79c90ec",643054:"59967ee01937160b",644027:"2b16e3c6ff953a5b",644126:"381b19c5f8b575d3",644386:"bfb820484ce8c75d",644476:"71a957a66dbd0ef2",644584:"70646826c2825104",644634:"40845d37e881496d",645285:"28db28fc94b40b14",645328:"7969ec06ef93510d",645500:"4de59cc0b37a1d73",645508:"2369fbeffc81faf1",645702:"6c2e2feef24009bb",645885:"bdffa8194543df7c",645924:"6f07a8533c4e6bf1",646119:"53a9038bc2c61968",646433:"e3da826bf01e9f26",646581:"0d80892041c382c3",646639:"5b391d8084f78432",646804:"f732050b2bc86601",646978:"9fe73b07351a92b1",647461:"3db2dec558652435",647511:"320e3f0cc1f58e29",647531:"caab13ae060b7f35",647573:"a6d38b3137ae2a75",647812:"c18fe4933bd49253",648147:"afa421539e551c79",648421:"c21656fae6fce2d2",648451:"376a87478a359573",648683:"0b67f2c831035f1e",648736:"bd33a80f43d636fd",649832:"5c79093a02cd590d",649880:"8a63531703972af9",650238:"9a26296f54f9359a",650284:"0783458458ca12f1",650391:"4c373319b5287a53",650462:"bf3237ffb5ec75ba",650609:"2f7dd1437b819e6d",650756:"0ee04d601aa6a3ee",651070:"21dfe7ea85f2ea93",651226:"5b51b291651c6317",651470:"a341261655d3f4d1",652336:"17d26f2006af9f6b",652405:"55914b2f01c90b42",652624:"528465b654b9c3e5",652708:"fc575d6361da3f07",652763:"e117e8282eb4a69c",653075:"7289f52c69e716ea",653188:"98a424e30c7f0a4f",653247:"a5e2b0b1af889912",653484:"ba5c3947fe8edd89",653637:"5ca7aafffb5e5c81",653831:"5323b1d881697d02",654177:"a0c582eb6fdd08e5",654198:"801c9c004cc727f6",654569:"deb10b2f707280da",654761:"a2318f2f8e195c8d",655033:"fb289505b792b753",655151:"f54d6844fdb79c00",655402:"d12738260849897c",655550:"75d2ffa0894f2493",655875:"53f2aa592b3f0d45",656737:"7f508656e3db953a",657426:"524aabb4a3c3066e",657777:"a5ec9662d08e1e50",658142:"db30f984ae84f5e1",658188:"7e7d56d9f33ff43c",658395:"6ecf352eb2e30cbf",659098:"8691c54db69aa158",659286:"c5e9070c8421b001",659412:"0c210f0e6088b4ef",659529:"f6a64ff21db01ff4",659831:"30b2555f8a497b86",660115:"5e1dca26fae58c3d",660148:"8e9bc45ac65033bb",660273:"db5a334142d200b6",660347:"60e7add0d2706782",660417:"94d149fd83211002",660676:"caf093710f2d4e65",660804:"3d7f4a8ff6a5e728",661045:"8192ddb65f71fba3",661051:"9e84b53695fe90bd",661176:"1e9af6b748a32c82",661639:"3b7ccd786958d28e",661701:"3dac2c56d0d5ecc3",661922:"10e26c392c61cd1d",662153:"54d39cf62d3e73a2",662245:"35e45b6f4190039f",662463:"89dca1707e4113e8",662535:"3bb85b26bda5320c",662738:"6011873063d6b50c",662763:"b5a732e708c3e45e",662990:"12b94ab3a7347890",663367:"576eade82da7e5eb",663936:"63f44196702e7936",664089:"b9243a1f798a52ac",664258:"e06866062e924378",664501:"089916ba7b280fc0",664618:"d83fdbe1a472f984",664857:"5564ecf652921c35",664876:"d2c89e0e49c1a298",665054:"c4d510f4481df702",665151:"6190f2d809d07522",665242:"0cf7b6439569c6e6",665347:"f81df509fe7b1933",665515:"f8b7fb02c0a93172",665641:"aaec635a578f31e0",665666:"c23df80ddea57fcd",665785:"6cb35992324b6bf5",666073:"7ff8ea3016f133d2",666326:"09eb0641ce89e484",666482:"1f753784b39c4630",666584:"73b8d9d31d84aa08",666726:"e627887da6f431aa",666836:"5ad5254283f38aa4",667142:"16ade23a0c5d8f85",667288:"aaf14e04184c341e",667417:"6d3f69182b219c19",667442:"02dc8e84fc1ff94c",667569:"83de2e8c314d9175",667643:"1d9f0aea60eda19b",667676:"b137de4f9da41e52",667681:"65ba657f5f928904",668018:"39b875ca473f1ea1",668286:"9b7f7d0ecb9faedd",668299:"ff3c76380dda2d02",668722:"9f090af6177fab6e",668778:"f31182f50e0bd584",669622:"9dd1dbab0213bc27",669652:"40c7562e5b43b552",669891:"dc07520e4c85aea2",669935:"5f0456345c226037",669982:"aef0d3608e23d7c7",669983:"dcaf3aab4667861b",670059:"f185a2fa528a4015",670094:"9ab35a2e2d0fcaaf",670103:"db026cb5493f8cb1",670200:"20e61117e2c59003",670542:"f654fc8a302c38d1",670941:"3e9c635ac1ac4154",670972:"87a8dd997fd54799",671161:"05c5d47e0748d78a",671220:"12ceb2a3c0056598",671326:"c16cab0389c76841",671980:"6cae6c06b5de8f39",672055:"354a9e608da7025b",672617:"09ff607596c17c6c",672658:"43342742e27e2be1",673047:"348e8dffd7ca6d5b",673121:"667e8a5f255e42d8",673321:"7a0a1b0fa630fbc5",673460:"7bb07987c25caa68",673680:"44928ff14107d728",673773:"3db6acb3fab9250c",673889:"b276b780a14357b1",674282:"c67742b68e95f471",674574:"bc50b23c88a0da77",674687:"73480c28021c0e27",674881:"b66fb1e743c950f6",675049:"70398b096c252296",676007:"413828f1c0a52272",676130:"113ce703eaca1939",676179:"eb20043581923d46",676274:"f1b070c64bd3136a",676317:"3e7cbf7f46107297",676327:"dd4c9befe4f2a892",676425:"c54a515cd8c2c272",676513:"8baa93b70ff3f84b",676912:"519bdf3b38838e4e",677093:"ba4a8ec321b73e30",677397:"398a38799c33f303",677496:"96e11f26e4e86aa8",677543:"555684399d9451e1",677740:"82a4c6854c96b828",677793:"3d37f7533fb1d898",678026:"3609857e83fc3341",678130:"1e8155570ba09508",678153:"4aed73ae65d26bf8",678173:"b134d35ecbcc27b7",678220:"b4e0d6d73e585fab",678324:"5a7f3ff3bcff26b0",678408:"2faf601523bc98be",678680:"478dc218058a6431",678729:"ecb0622d9f4427a6",679049:"a8f1195f6cd8845c",679306:"7e0bb72027aeb31f",679499:"521c87bf9f6c66f6",679754:"5527b25721259b20",680217:"d6a238e436dcb00d",680670:"cd54edae8bcbca7d",680707:"34261f9d945e83b4",681102:"d03b23b5ef6c04e1",681698:"1400f3446b35e694",682176:"9f9b88186cff35e2",682522:"88ee821be307923b",682754:"89414743bb085e9f",682831:"2156249f62c52e0c",682989:"4e625628fe19a625",684021:"80f1d2f5fc03b3af",684057:"9cc6ad32b6cf2481",684072:"968aab2092170a03",684091:"7c299087bc8cd18c",684317:"8e9911a8565f2b94",684615:"453f63d6b5307d7e",684956:"54245529871d8d32",685156:"b968b863dd7ea318",685250:"9e17fa32ad8d7ebc",685394:"d21d041e7e1ca96a",685716:"ee51fc8175c5907c",685995:"85cd4d23be2eaa8e",686380:"3cbb7375697a0b16",686824:"d2b26a342be25a90",687254:"a766c356990c04f0",687271:"4b63ae0c46c4e252",687309:"9704f127f74722cc",687391:"9ded336ec52acdf9",687392:"e28c3d6fc3f0ac57",687601:"6f7411e75d20b7dd",687844:"fe77c2fd821cd560",687921:"a1e143f5fa605d1b",687990:"8ae59c4b609871ad",688164:"67749c03fda326d2",688282:"fbb97e8c49d061d9",688314:"ef3e7c592a96b61a",688360:"1d5dbdcc2afc752c",688453:"07ca5ac87f1c82b4",688466:"faa5709a52a65e61",688540:"fe3f8fff7d5fb214",688725:"b4434d682d1f66b7",688901:"a039319989b60d28",689118:"2deb9bb2ddca2bb2",689220:"7c885bde794321c7",689346:"ebc1baeab1188f1e",689430:"ad86029cbe840ffa",689509:"2d76c4ee9687e6cc",689629:"dc0ab7d1ef1bcf13",689961:"32883d395f1e5278",689966:"f9bdd9d0f9d8b379",690086:"b1b467b7348440c1",690094:"67860ca62ef18950",690134:"440e531b76f89fcb",690166:"fc81884169159c7d",690224:"e5ac6c013db2f2c2",690250:"0074ae5aae0eb77b",690514:"dbc73ff4fdf4a3f3",690531:"dceb5329bb48e454",690533:"1bb44eeb6961b816",690534:"97cd54a82f915510",690595:"4cbf632c220ee075",690766:"b7a897cdfa407468",691086:"fc452769a572f619",691138:"bcecb8e7a3a3f7ad",691195:"e3eca598494a7f2e",691291:"367dad016ffb11d1",691643:"6e2010a672253630",691716:"aa64100b26bcea97",691913:"f4546202ed117b81",692186:"360be8473b4d8fe4",692235:"0c82cea97e482895",692724:"69fd9d4e78a131d1",692729:"1a7294953faa6051",693334:"00a37effd86c0266",693371:"2eb8f2c4cec14b13",693467:"29ec29baa06aa377",693514:"765cb89b361e3fd2",693594:"4021cfd3a1e4d18e",693762:"e608cbe465ee4971",693916:"1fc08749585b2af9",694057:"1eb2052bfc773455",694061:"c80ae32ffd14f572",694170:"01989364e6775ccf",694174:"3ba84fcd909ac3df",694243:"257ffabad451a1dc",694535:"2bcdb785206db25b",694543:"22f56873d335666d",694623:"f023ddce56e4731d",694637:"4032e87ef089b318",694945:"651ed5bdd7235510",695268:"a0a44df8cd3a411e",695322:"7295772427f0cc08",695366:"848bee2ead8c9d1e",695875:"6303e4ab3ee9c5ef",695885:"96fbc5510744009f",696540:"a46394ea9482b418",696652:"bbec62a2dc9f2e1c",696980:"b4d1e586741f918d",697014:"ebf14ecfcd2d8add",697147:"d2a53c14b35c2a5f",697206:"e605d1df809cbcd0",697225:"a39ae11fba43bcbb",697437:"be265488c2a48a21",697530:"f018f53c21882d43",697606:"9d44a98b6b2f4a0c",698080:"0b390215c9b72478",698091:"606f628ebcbcfe70",698170:"a8c25b3b8e0c9210",698627:"521fc10fbb8fcccd",698865:"9213ca31d7b306f6",698926:"e5098ecb53463575",698929:"83d144a7b230845d",699329:"f517b266f6bf3a44",699458:"32b3e08bc4fe61a6",699466:"58f66c2929d444c8",699772:"3a8b5c488e4e00bc",699813:"e58ded20fe937192",700052:"e3ce0b32ef3c98f7",700075:"e1f0e322bc295cbd",700106:"af2afa2ae83f4c7a",700369:"1fb91fb5275a97b7",700418:"bbdc074668a43be8",700488:"f9f54b6d4fad4dbc",700632:"4b574994a1297c85",700798:"132ba28453d2a8dc",700826:"bfd53ed7c080aa6b",700878:"8f684449f9b79128",700926:"8a77644696694eb0",701035:"236d9c924c0f4fac",701387:"7b68dd0dac3d9a72",701471:"66e14b732463e43c",701556:"04c3731c785a79a4",701570:"8b0220795cefb913",701583:"cc03aecaf18ac148",701753:"e564ed59476052df",701966:"be0ef967307d534e",703101:"7aa0c01224340eba",703405:"0313473f68d8568b",703414:"294bea9689e45362",703813:"5c7d767fac1e7bfe",703983:"5ed509044d95feb7",704120:"e1d87ec7e5a1b887",704171:"6efb53a8a4f1fe50",704286:"d67d523fc330be87",704288:"24167243234f5997",704475:"66d4e9dbec9c5c5f",704620:"1627c2af31539e30",704822:"883af64329d6db14",704987:"375c55a545de5b10",705170:"85a8e9a6988e92da",705297:"52a78dd0984010e0",705406:"f0bfb3403eb3cc18",705553:"381f6a299a546cd8",705754:"a1928edbd6adde0c",705875:"c2875bbefbe16d8b",705916:"bc58dcf25c6f3573",706013:"8c73abe85fb44b82",706240:"a00f6f880a428cb4",706366:"fa9a927aaa15c3a2",706702:"b728936ea7cd5cb4",706767:"64da423858ac4cf9",706819:"365dd5349e36ef19",707015:"7a1245291f01085b",707040:"9a653122611bfc16",707100:"25c6177ba1ff5aaa",707191:"56c2265081d798cc",707290:"7618c2c1a46b91fd",707368:"bcea55e4e139951a",707463:"667d69d3c93e26b4",707536:"b320f78c429ab7a9",707620:"c21a1512935d480d",707729:"cce0ac4e39d1110b",707902:"a7cc95f76d66d285",707950:"daff64fad1fc1ec8",707959:"1b5428f183cd6245",708174:"f67feeefeadcde06",708204:"86664a8a98d4bd27",708535:"8a1d968b6c4494be",709267:"cf2517c36ad465d0",709372:"6d32817898db3a04",709495:"ca05edcb61ded857",709528:"a48d1e8e2428f33c",709592:"ac13436059ed5138",709675:"cfdc3f9d0d4693f8",709735:"ba34eb068cb972b8",709778:"69acf886aff9e17e",709837:"bb1b4079a11b3c87",709940:"beae891f9176ba37",710589:"153105181dfa6399",710659:"77fee3bc746129d2",710728:"8e82640b7b956b47",710787:"242e84aed8ba411a",711265:"bc69ec66341b09aa",711746:"e08c604d2fd3a5d0",712112:"23fb352a36f4e21c",712252:"de24c78fc6f6b2f2",712274:"7dc0ff7e7818eb5b",712610:"bf21365601ccffdb",713077:"4b9ed6e79b7ea159",713501:"0f864742ff036cc1",713750:"dc7f9b95537c6df0",713838:"554ed6d796160521",714065:"341fa0bacebad96a",714076:"5c5ec40ef4356344",714133:"72c1ff5dc115f43e",714421:"6ee2ec1d7640b15e",714653:"996698a62d5af383",714927:"3e5615e8284a0ff2",715271:"3091df6119d588c9",715369:"c1225d1c7d8e4116",715442:"055e2085455fc2ee",715523:"24bd1f8b93d417a3",715657:"695383164309fd69",715905:"8ab3760152464fbe",716089:"2335de40e88e1ca9",716151:"9c7d42a916d262fd",716313:"25051d21387a90d9",716316:"504d62043f23d865",716540:"68e95db89b9a142d",716687:"df065096aaf81bdf",716734:"2588c5a7bb778928",716804:"7226d5964e6ad43f",717142:"cf34a4cca5d4e810",717285:"28c1fed0a9c0e21b",717293:"d21e9264fb189c95",717652:"0feeb6e309c7f0ef",717704:"1f5e1699bd953abf",717795:"e4918275d88a9fe2",718031:"8d52dbb89998f331",718170:"2f790dfa0688d50b",718436:"2c55cb18693f7cbd",718500:"75ddb0728426ef1d",718815:"8fd24701f450cd3e",718884:"b39107e901ba1a80",719050:"a75e40edbf881c33",719109:"0d92619351ed3c35",719997:"79a7f3bcb7adb32e",720013:"e8185ef9a963079a",720718:"dbf60f496473a809",720765:"46e650bd27373e84",720965:"f466b02dc193ad89",720981:"9f901d19b141aa41",721103:"68a055d012144f99",721209:"3186e225dd8a2076",721240:"0fb12285e0ddd41b",721689:"0eb6f785ad08d88c",721941:"1f90d8bdf64137e3",722064:"e44c6469d3a09223",722487:"212af8729f4ada11",722799:"ca940d8bc563e661",723063:"73f8fa47f7e85809",723088:"baddc89c3c5deb1f",723397:"b989a9349f67fd00",723465:"be6d39199fc3eef1",723794:"ecfee49732f6eb5f",723966:"b4a8e69da1f8822d",723968:"5c2bc7d85bace826",723974:"9f2b11daa95da964",724092:"c48568535eecd69a",724526:"5bad5524becbad5f",724924:"86c9666c6436cf5a",724937:"3426baa6815d2762",725106:"07baeeec6e6ef116",725509:"cf25794594464a7b",725606:"e97b3a3c17b9fe67",725700:"6228dd362e324da2",726445:"76e83f9fdee3bd57",726553:"121bbdcaecb8b6a7",726717:"fc7fdc4027c72c59",727013:"a455c4f884c18705",727067:"d2225c922cb4b84a",727202:"d22226992844c039",727513:"c63866a8bc91db18",727648:"23a9e414edfd618f",727662:"43712de3789374e5",727910:"a5fbc8fe3d4e177a",727959:"ec8a6c8217f6d5a6",728176:"ceb481614770f308",728410:"87ddf4922bdf1581",728420:"d573cc80e7180d2e",728549:"447859645b90d39c",728584:"b7262da58806aa73",728992:"4a75a66ba367de5b",729025:"a22227724642047b",729180:"125a732db3977b1e",729284:"61eb7e939bc2704a",729569:"777b2033ebe8676b",729731:"221de9c31201bc45",729961:"275d38d945555c0a",730150:"b24fa70804873c3f",730168:"d701d2ff9fe9ebcb",730235:"4cff3c5653c3c15c",730579:"8f6b76d34c3e17b1",730588:"b5038b184c0a9273",730783:"3970fa8841468c8b",730922:"5f49a4db1ead7653",731167:"fa655ffa66859d27",731210:"1d7099961fb7c64a",731363:"1be9de07c23b2d46",731374:"e38551c5a4e48ece",731503:"e55bf1e3c66f20b2",731513:"80cf6247edeaffd2",731538:"56d5c9f2f9167ed6",731835:"7ce94e3fe9e4a7b4",731908:"60a72fe0653ebaf3",731953:"7cca544a90c5de62",732093:"2f5745871196b33c",732226:"936adcc52bde6327",732240:"3fde24fc83f3199e",732241:"8227e428603b4bc9",732420:"7a5f5089dbd7a455",732521:"acf48fb441df80df",732522:"3e3d62661f8e98fd",732751:"fca0c33f8dac676d",732773:"7e5b00f6e5210403",733014:"4959a32a2caeb56f",733075:"1c76a79677c66c7f",733206:"7ae8024f3cf420eb",733242:"1681715ce46bf287",733488:"e1e4552421e99645",733526:"94de9dd8cffdeba1",733603:"27b962fc8240567c",733689:"b58c099fc7e3462d",733885:"3e73bd16f575cce7",734602:"0cb71f8b8cc6202b",734632:"4684fe020c63143e",734882:"24ad8d3e2cfb0c75",734949:"104d2468d38ceb7a",734966:"a1cb69e48609d54e",735512:"9b0aa1b37ab346fa",735529:"1f345402a1dda650",735551:"1d371b8f4ff94547",735568:"b84da1a63f300d2d",735596:"3ebd7abdc038b45b",735668:"7bf5328481281758",735677:"4a9c9c47b98c9e1f",736173:"fc39835d6456963a",736341:"edae64d468c2bc64",736447:"f284d09b80a67092",736461:"d20c86bc7dd12087",736856:"385dbd9d27a9e3e2",736875:"d284d232daed4909",737097:"5c42cd0f0d86cad2",737155:"4bbcee46d3b8fc03",737249:"5497499b1308546d",737310:"5784860cc2fe339d",737671:"db512ff9dff23b90",738221:"04ad22312f3eee79",738564:"8ed5832eeed7d488",738569:"1b68b8e555c691df",738746:"ccf08bba9fb4169d",739818:"6977f7373f1f15ed",739823:"6bff983f8e726b67",740085:"c2bbad9f4359b389",740114:"e762c91f8ea5915f",740191:"4e22f0468fa6b7bd",740433:"c6da4174f5da3433",740649:"51bcc05d3fa9510a",740802:"337a042b4bd94b14",740851:"24088846a6f16d8c",740868:"a3ad4532396d3221",740953:"0d3cf7f53299e6bc",741127:"0da4d846ed5cd1df",741480:"cfc15366755e64e7",741627:"383ff9587a0dcaba",741897:"b1f0470169346d3a",742008:"d2954d1daba1b8a6",742122:"2af450c7507797f5",742302:"37f5433fa041582a",742477:"40d68f9c2aafeafc",742842:"94112926f50f04bf",743061:"342d38367a32cad0",743583:"f84ed6ae75db4353",743665:"bf974a69a3d88f5c",744334:"356414b7f612649e",744357:"51cda1f4559452be",744470:"2f02199fa1ba120b",744551:"cbda1ffc326e34ac",744746:"01f19ba0d60408d8",744778:"ffdc5e92a35a33ad",745250:"1aa03cae4183d889",745303:"100bc4a1825f744a",745321:"2bf3acfdab9129b0",745698:"ddfc19bff4759bf5",745999:"682ee1bf842c1f53",746169:"752c55f72503babf",746685:"50c648861125f31a",746873:"abc6278f01141de9",746979:"60952f6410c4c6ff",747049:"d15539a34f342e02",747384:"a6fcbbefc751b52a",747579:"afed61eca4a4aae0",748113:"c4359da157a3d426",748307:"a6ea1f1eafb78efa",750553:"d3790c13cbe098d8",750616:"6aad4c34ab0ea653",750970:"663318baef95703c",751309:"ed3464d995ad3c27",751359:"e15cce6250e88977",751414:"924ae4f291955507",751534:"c186db8321352f31",751661:"3c01d45f60009272",751667:"89215db91b95f65e",751744:"259a3619a98de0a1",751748:"b161a07a21b5161c",751789:"f6542f280e1a8cbc",751803:"c94f2d8643adc679",751868:"4cfabb69edf34558",751921:"666db0137fb7b2b8",751949:"36f7e2d0bf4f2968",752567:"4bc88fc50c125563",752579:"89ebfab409c5cc91",752866:"13debe7f83a67ca8",753029:"eb791d21b2b010fd",753681:"a2396ea885bd55f5",754309:"8a948d26beaa982c",754432:"dc66578bfa179379",754447:"2d373fda79af7aa1",754509:"290d15cfffa70780",754902:"ab182127df39c4df",755206:"0446d3d31afb4cf9",755279:"1854dd0f2dc9b4b8",755340:"773b784df7be554c",755553:"1396f1917305e9d0",755715:"af0507005644ed9e",756204:"64f9ee5d946d5aec",756244:"1f740b27898e597d",756300:"1a1c68dda9ab47b2",756335:"6e9aeee8887c38f3",756387:"3d1f5b0e8e8776d1",756391:"1eb8f1d25b018c75",756425:"cfbe8eb59a5e49fb",756679:"5025ba63c04a9dbd",756774:"bfa27f0a312394f5",756864:"7aa8f41e24248746",757052:"dd9980afdf858e58",757545:"f028c90a4efbcd38",757628:"3b7943ad3e1be6ba",757663:"9d86539728921287",757721:"d602b13e7b304725",757839:"ace5d0ac9850ac07",757912:"a575ab3b288a29af",758622:"4ec3f3716d8a82a9",758629:"b93ece116b382e54",758670:"8974e4b810a839a1",758673:"9231c59a3af51ec2",758693:"ec67f9cb8cbcf5cd",759082:"420ef714e23bb290",759084:"8bb4ffbb4b0ea2e0",759238:"04c0f9eeabb6f0a5",760323:"12636e47683ab2ed",760325:"9dbb6fd9f7b31d8d",760438:"09c4e60ea75256df",760500:"452ad8d4f2a8a080",761030:"8ffd0eb53fb89f63",761263:"14dc8ca87c314a52",761286:"7639e0c752814882",761489:"ce507300c397f4c4",761569:"dcd34ab6012ce99c",761618:"14d0a374be27f55c",761865:"ddb54efc69880d19",761949:"9209b34298370094",762058:"ec6499600efed299",762151:"a9fc671a9c5e8d43",762198:"49581e9cd3edf966",762755:"62a47ce1b4188906",762781:"dae4918762f0b00d",762993:"774598467b6fb749",763140:"9c12d9cc0b99c43d",763233:"ece56f6fd05d38b7",763417:"df84b956fb2d4bfc",763509:"193f7aabbab3e4b4",763702:"89acf4d6db16084e",763823:"44d26b67bb4e5f47",763871:"d2310ef75b3c21b8",763903:"e53400d50d25419e",764e3:"87282cc5888110be",764009:"17afeba12c2ec64a",764010:"977127144fbcf0ab",764055:"d31b836006776658",764100:"10d353668cfcedc7",764139:"9dbe4e11775fcfe7",764175:"bea71e0e3969c90a",764816:"48e9aa524d15f4e4",764897:"7194c803d4f797dd",765065:"495583dcad0e3cdb",765121:"6544ec9221cbe657",765556:"0152e14c362f16b5",765707:"6db050122d36823d",766138:"d6e785bd4149923b",766167:"dab0c1e309726023",766186:"fa6afc3bebd0a8f7",766610:"3e9a92bb65fff108",766761:"208fd2e9c9c72542",766793:"224491c6a2fc1767",766933:"fe91a20ec43232b2",767326:"8c55a9132ef4cf21",767433:"d90b38eb4234a94c",767546:"ec297fa696d7a811",767634:"8bf15dbcf4e613d4",767650:"23611644ae36d554",767973:"f424ceda745ad8d9",768748:"de51b3cccfbdb8cf",768781:"f3eee2be66499ca2",768935:"b0675fa76abdfa0b",769085:"91d7f53187b5cefb",769167:"7121c1931eea512e",769229:"22a575f4214ac916",769415:"6d37a228d24c53c6",769663:"d8aa1885b49576b7",769675:"e81162f0d7e3bc2b",770041:"6bf151c28b8c2d19",770293:"e92a72491f6a7798",770326:"16d502e38a4968a6",770357:"96f662ac4dc79899",770824:"17d7201b3783524b",771216:"c0ef127387fba56e",771285:"f17a0c7fd0b825d0",771326:"4e51672698d2e5e4",771401:"c15aa38a11fd76ac",771478:"cab7ea1d659cacfa",771852:"84a3b473e268dc21",772001:"5bbaa73815d5316e",772287:"d60243fb16d44812",772928:"fef740902c28aa6e",773170:"0b24931a6858f5eb",773343:"2593e4a4d1af340a",773349:"09b02915d9f44836",773696:"55ece3cefadde8cf",773956:"c36756fa58e7cce1",773969:"99cfe0a197e8e57a",773998:"bff01cc3c569a18c",774180:"1207128fdef75b69",774224:"3f342df54f12a2d4",774604:"a49d666b364db2e5",774660:"dd300b6971e7806b",774896:"40f0870f48dfaea1",775039:"3d56f3df59429a4e",775123:"8798b99e8f11444f",775141:"2ec8517ac19aceb4",775238:"6a2ee49deba509c2",775294:"1e2aa80b7a059e51",775447:"02784b0890933775",775546:"3c17323e637c06e6",775629:"d764a7e399348be1",775729:"ea74de552b4c7d76",775931:"d9e3080107c4b0ac",776205:"ef8bff59c1a6d620",776281:"e19096b778211f7a",776418:"ccda898338b993bc",776426:"aa5fb6fd67da7fa2",776945:"a6555204b839cc85",777067:"2457119ba774ad17",777085:"3c4052c25ae4baf0",777093:"a978336627dfa0d8",777384:"046296ecb2d625cf",777618:"68713bbc95d4ecfe",777649:"ada994af335ca2c6",778013:"70aa787b162cd2de",778026:"02fc783ef91aa3b5",778516:"1c03cc0bf9a7fc3d",778773:"377e8fc8367da111",778858:"68fb8df47905730e",779188:"39a41d78ea2feec7",779458:"b41e3c6df3100c1d",779737:"632ce72ea71ff09e",779804:"396b9fafdc7fc036",779813:"62281355378e8525",780163:"933595f8e1a3ef4f",780192:"42b921514c64f345",780694:"ff379c36ffa8947e",781074:"b852eb1e81a9b9cb",781164:"60a4720fbeabd68a",781288:"3613b6604f36097a",781529:"62529051ec940452",782136:"eb6c4f105631c336",782196:"cd0ce0585b4f9509",782856:"3d2a867dfd4fd831",782964:"65e0912efc34ab95",783226:"0fa22a92eabc7b8f",783619:"5576a516ef6912ff",784198:"e6f928b06c5f7ad4",784224:"9efb5c69fe4cd6d8",784384:"dac7d113bba94acb",784434:"6a8c0606ea98e10b",784497:"525526dc14c8e098",785333:"35ebbc9b581328a5",785918:"6a16d2c1ebe2ecd1",786016:"01ee6c884499b10c",786113:"21e30b12950dcea2",786155:"6494c7ece2d5228f",786183:"a44f534895e6c265",786261:"a5262331e4a3bffd",786549:"62705735edfbc07f",786757:"c2e5b220cda0bf78",786910:"8089e621d1db62b8",787173:"11a8197a71c03731",787227:"401b2e3ffd3c9e34",787329:"214d883145a3308b",787479:"29490a11903d2097",787480:"914db0edbde8dc50",787970:"b0320547e8217455",788207:"10dd95b6bdcb04d9",788273:"ce7172991efd0099",788434:"80e699cbc23f8f06",788582:"8e4ddbb11eb3489d",788811:"cba475122ea83983",788861:"e6f1ac200a4cbbe7",788864:"ffba10baf03c632e",789080:"e80d1dcc85db8dde",789162:"3bdd39e713b08ba8",789183:"708aec13068d50f1",789499:"4595878c08dab35c",789525:"585a381ee1ede8ce",790141:"4d490ba3e729b6fa",790447:"e224de16cbf4c201",790694:"11669c348dc94296",790752:"c0f5d013350dedb0",791496:"8ff323ee5804e166",791510:"d1da061e3e7f4951",791761:"11cc0606179436b0",791789:"42d956c44e308f0e",792168:"4f38d8cdcd52dff3",792193:"5d6c9df41d4f797f",792574:"49ada50f91b84b90",792589:"51de3f19d89e29b9",792621:"d180cdc8822f90bf",792722:"e4c310828cd959c9",792876:"63448eb21a110b5b",792966:"c06c061b3ecd35ed",793200:"4730c0a88ddf27be",793241:"ab692f273f94c64e",793300:"02a6ce8248e54c36",793337:"631858601a1b94a6",793400:"892f54b7fe0e4bd1",793477:"a480e38d0aeb492e",793518:"eb6fc48883a0ee44",793653:"c012bb518de619db",793800:"9f47a4301d1b6316",793844:"96e3d447d5dd8b89",793944:"4f278d2f3185a16c",794033:"ee5911da244dc9d7",794159:"9a473c382d2c8a05",794166:"41e259efcf032ae6",794844:"ee8286e355ff4603",794914:"e214486765a5cfed",795037:"04524a6590c034cc",795422:"7d6366c94baa7e85",795571:"820c107ea2d5d6fd",795691:"aa28d55390b922a6",795898:"d9639df56382846b",796078:"d1863b8d9862dc9a",796317:"5cc821a992bfb47e",796736:"e07b9c9d76af8f73",796795:"3d8385281c4d210e",797069:"e10aa3d2f07f59b5",797119:"94e609d857aa8d4a",797146:"3792cc2cd22bc07b",797153:"444c9cb953322aa2",797371:"b2045cf10bd2ce10",797433:"9e5378fcdbd701a6",797550:"2fb81e7987f46494",798176:"9b5779b47baec257",798498:"258dc36f67533377",798654:"ff8fccddcad38d77",798696:"7cc85d5e83d5eaa9",798972:"92945d0b3652d31f",799030:"0f26fdf9e56fdde1",799106:"b5e530ae5c32a853",799666:"334ee75eaf820450",799793:"e765e41929325bd2",799938:"b6e2b236757d0756",799981:"271b4d7accf384c4",800274:"4d86be2eea069a6b",800432:"b925c4105ecd6725",800481:"48032ab39df7c87f",800509:"6bb2256762a2cb80",800692:"07a5f1d791ffafb0",800824:"dd45465f60f62daf",801551:"056f797b9637e379",801595:"9b9c45a66e782035",801811:"eb2176ab2f90a3e3",802054:"04e428bea5b6ee32",802090:"33e23eb3622699dd",802297:"4105872e4e98d4a6",802517:"1e8880579980b0ff",802733:"ffc16bd476a5cc55",802849:"361dd29c70562648",802859:"0e04fbfd5a6936f3",802989:"6ebda857f775c896",803073:"e24ac327f9970b93",803106:"40cb0fb2c406f635",803120:"6fb7f539a80ba78d",803184:"05ec4dea4d5bc65e",803214:"ae4a6c1615a9254f",803466:"b467524770f20a37",803698:"217841ea3a57702e",803891:"78f6def572dc888c",803941:"dc8d2ca99bbaf4a6",804102:"901000c82404eaf2",805131:"26606f38ac956161",805164:"e438ee3015feda95",805203:"93cce5b65a6c569c",805235:"7f315063cc44fba3",805430:"d0d7e8bcd6031263",805588:"eec000263559afb6",805794:"c05e00f425a30524",806023:"1947dcdbff488456",806389:"c9c45b275cac9f5b",806582:"fc3503850ef4311f",806726:"f3543209557788ad",806856:"b29b04acdf7794e0",806994:"ab2a3e95d5a5a6eb",807178:"ec36bd6960fd894c",807205:"e099a056f102eee2",808111:"a3ea29a6944b7a93",808376:"489bb68cc0c9a52f",808427:"119e8227180cf22d",808438:"06afbedc68e02fa7",808521:"d475ccec27ca043d",808985:"38c7eaadeb0ab0f7",809170:"0124cf18219c67b9",809193:"0cb8c28479b6ccdb",809257:"e503661a6322846b",809326:"a6ce2b076c96be3d",809820:"2612961355b0778f",810016:"0af29c0e2d83729d",810072:"da2658bdbffca6c4",810146:"ae5407400d17345e",810222:"d7cd5ace1d24a3e4",810284:"9b95d1bcf15d7ab1",810439:"6a301a21736e9052",810589:"5291c0333cb1616c",810933:"71164646e6ee5576",810970:"766f5662eb95a027",811131:"2654ee467990c55b",811287:"b815e7849b49da2b",811334:"080f3349c4f1f194",811930:"58b4b8fa6feb974c",812070:"d93e7f3c9d3c2767",812090:"c0595a28dc6338b4",812118:"9322b4f5af07e650",812190:"562bec6f030b8140",812302:"5045a2e4f67001f1",812409:"823d8bb6819f0693",812464:"fd257716eb8a0aa3",812502:"56af46a4bc5aee6e",812695:"f503a92004048e69",812946:"6725fd00336955d7",813454:"9bc28a65aa3a65f6",813652:"1355659114b6253e",813769:"51176149377c3032",813794:"57a98fbd37b955ac",813802:"0755ab334eed1091",814408:"7517e4a0df585501",814644:"6b71717a3ebb3dcf",814834:"61747e88363ef257",815463:"65d76337c60b95ca",815469:"6624a4f3d8074e4f",815633:"cdb4cd648c0de1e4",815768:"ff42e8397539b0e8",815783:"03ff4e06a28b30a1",815923:"56dba5a3c36a2107",815994:"3b7130798594da6c",816436:"0c4bef13ab8d8cc6",816523:"0cb58125f5e0dbd6",816611:"fb3891e4935ea2cc",816702:"4bf0ece661f28d37",816705:"79238d6cb25989d1",816733:"12e612e18b1e9a1c",816877:"72932c90d16b9781",816981:"4b5447e14dede7f1",817233:"4f43ee429e68b119",817400:"af6820e53f02be58",817542:"9ef5d7b0ec655bc9",817586:"2b37d28a7931a52e",817638:"c8f1cc445a6578d6",818344:"8c5f5be0ee31e681",818364:"76e70fba8022612a",818447:"a4af8d2af020ea34",818773:"c95178363d4558de",818787:"a72c1da6abd54a8d",819210:"74c41658143ce0bb",819211:"1453a285e26247bb",819212:"f97ade0b5ba6d025",819371:"386441c3a9764a0e",819433:"bfdac1ff75280860",819521:"bf0da073606c0bef",819707:"6aa710299d045ba3",820382:"79114f58ada0a3c0",820464:"dd8ae0b7ac7c6451",820516:"c4b6f5b8c43b5a5e",820672:"8fb3124ff6a6e92c",820691:"f246c3d9ea55a269",821083:"cc26fa9f2cf19b22",821181:"3ea9269883ebc5d7",821558:"269e0257b79280d5",821706:"296315c773837b1a",821836:"5fce267002dc03a0",821838:"7ab37df7b9608aa6",822099:"954682c61ced7a19",822359:"ed554be8ea80189e",822423:"1070925567291f54",822555:"a51c8374d9794143",822918:"072f2b2cc46b9613",823065:"3ebc84ac83493958",823264:"c54ea12aa64168ab",823308:"a915fce8c052ebd5",823921:"1137ea2d865b6854",823954:"d43a783d4d9f442b",824014:"6f42959f7a71287f",824087:"0208508345936fce",825066:"b020a010abb69620",825268:"0b17dedc9ce990c9",825471:"d278f336bc773511",825659:"b89fb1ae24223a36",825970:"2f403024a26df7db",826354:"725d7fc511f8b6ca",827005:"028e9ecb0da78346",827365:"88bb18bd2357e3cb",827593:"afeff82238594955",827610:"3de04a5fbb64c7cb",827947:"60353df7f004552f",827986:"8ff768a418865eaf",828135:"d599ec79e82ce30f",828178:"019aacb4e654d74d",828582:"cbf2eb1c1ac7be9c",828716:"bf190e6fa557608d",828729:"6719349365a676b7",828853:"aa911546256b015e",828862:"9935d0fd637862a3",829046:"afa35ebf6d523c8e",829122:"4e06d1517d2e73d4",829144:"43620c460dd43674",829311:"ae6b3649927e7ab4",829357:"9ce040f21fab7034",829722:"40252da695b8f307",829782:"d3bfaf56ce72f5be",829861:"c6c3777c9d445094",829881:"205910380eb22199",829955:"ad73692464aa40f6",830590:"a77112279a57e605",830683:"ccdcbd00fa69ee88",831e3:"65fdb21f939683a5",831081:"bfe92376a02bcaff",831192:"869ba1a3536d5680",831251:"092e2e13594af86e",831367:"af3064b240e31105",831506:"47de1418924f3a6b",831730:"667a1b40568b8d40",832023:"204acc518ab8beb5",832057:"0b8e3cda80c74b6d",832078:"03de65b0ceb885bf",833238:"855187eabdac3715",833477:"7d4b3362b7f59df7",833637:"d6b1844b03f482a4",833665:"fee571cef139195f",833885:"0cd810bd199211cb",834117:"907932c024ef9124",834322:"eb606b848088421f",834379:"2e3a9c6529f01d1c",834425:"3a004c58132f309d",834544:"8d212603ffb8cc7c",834595:"755edcc2531770eb",834652:"b975585ba03773ae",834869:"d71220b08078c910",835066:"7ab8147d563dc179",835208:"cf1966d2b15bef4b",835241:"0be27f223086b623",835588:"564d6eb006a1e127",835927:"8d37a950a16b706c",836010:"fbf0b5fd6bcb00bd",836083:"3d50ca31c09dcf15",836720:"4b1365ddf36a197d",836783:"1ea6fdda06c5e525",836980:"8b99d2b08183b5d8",837437:"ae5fa88faa9644e6",838018:"844e5d6ecbf7baf5",838089:"db2d04212cc62efa",838174:"e7e7ff6ec85aae0e",838195:"ce709dd71ff3d992",838267:"c9c6f4c1272b39b4",838355:"e50696db26741dd9",838461:"f42f5df897092a9a",838608:"87dda75fee4a0e99",838653:"1f577dc283a32a3a",838806:"6eb76ecc77927dde",838937:"68114525deb4a893",839412:"6bd9e8335406695d",840174:"bce0ea1d3e1e864d",840177:"4ab0d70ff61bc963",840596:"8e0cb2960c1117b4",840684:"5df92b0b1bd3d155",840697:"8fe9bc3bdc842a1a",840879:"3df34e65c0339a5e",841140:"7a6eb88166647f6d",841327:"90251b198f9909a7",841417:"5bec380c2052080c",841746:"88687ef0e2dae7da",841795:"bdbe96f098ffb339",841992:"34147d0180b4085f",842120:"1e2a98fe81b85752",842330:"05f96b105c0b8f07",842564:"12a85e1bc681f198",842905:"b913799655c26cec",842931:"bb58318dbb0e12bb",843214:"4b73103db368845c",843455:"f1b95ef76fb74af8",843532:"f5cf1f587fdd6eba",843695:"5ee1b13487fd0147",843991:"c9cbfad9cafc6ddc",844129:"48bcfab568142e9f",844264:"997aaf05fd5accd1",844596:"c404a6afdf16794c",844871:"26f734f7a76fafee",845153:"8ac10b4ac4812f98",845241:"20f89805e5628715",845362:"0b9ba74890ec6b4f",845483:"6f416f70f7ca00c8",845665:"fab0225c72ad2ef3",845702:"6c9aa60dc6b63880",845871:"a7e615a80ccde646",845884:"022f5e29befbac72",845906:"8c2afc4d633739ec",846261:"05f2b04549390b83",846266:"102dcd508d321ce8",846532:"26527bfdcdae5642",846534:"764408e3c07009c9",846697:"d40528a012d3c779",846730:"de89c62067353882",846736:"7e8c3f4f776b2644",847282:"7346a5ee04d3687d",847401:"b15c90163480c598",847663:"c18f398208bc2aea",847794:"f1040bc22d9b77d4",847834:"8780b6988030fb63",848129:"4c952cc5de43ad60",848170:"77ca9dc4a5749380",848219:"eb4d32cdb6f8ab67",848506:"463375ccefebcc94",848522:"c1cb94a1a5973ebc",848588:"585701095403f986",848923:"ca3060b2c8c6e100",848937:"b94d7015b4948250",848943:"3f96ced924f2516b",849120:"5392147bdfb50ae3",849209:"ea2c8de312cbf952",849378:"37c5da7e1ecb49e5",849448:"83f1e44ad09c7f7c",849672:"483cd484b22e3f6e",849736:"a379d29d560af69f",849761:"b5d25fc8c1247dcc",849810:"3c5b448ee4838d00",849885:"badbb9dff7dc8460",849899:"4e5b651d6c65cfe7",850175:"054b4e767e20509a",850206:"d1bf41a5617cf2e8",850366:"1c1f34c5dff12a64",850419:"20617f8b8d793c3e",850539:"ce004caa87dabafd",850771:"3a6555086a04c57d",850926:"5510116fc123bebb",851710:"bc09aa8a2792524b",852443:"313d63662f1f3b1e",852676:"bbb6c79be6a31e43",852683:"4688a3c4ffb5c979",852943:"2e158e068a839692",852944:"e1cad090d51d0d07",853084:"30a837426830826a",853223:"5297841ee32c67b0",853664:"14e4707be1dcf9db",854022:"e17361075fd02d07",854314:"662cc12f50639a86",854515:"8bc4efde7680a81c",854668:"fdf8a450c9e90ab9",854937:"fcaed3c0a398c613",854980:"be48f9b2c0502e4e",855200:"ae637a6e137042f7",855228:"a32f48af21b0001d",855308:"be947bf34b7bc3a0",855320:"997a653ba333e5f5",855439:"678f4e0a43b72de7",855531:"928aa2e578e4da3b",855777:"bda7ea6fd4113175",855936:"b12aeeaec4e60b82",856130:"1b4f621ba0fe63ef",856330:"4dec53496f340452",856532:"b837e816276e449f",856693:"0ea221e3999b3ad7",856795:"7ef047291547e5b9",857088:"77cbc48de0ad5098",857330:"01eca364ae347bb3",857441:"2e9a5fd069d46300",857495:"4b6bd77a75334be6",857549:"256573411008fc0b",857561:"74a6ec47192fc3f8",857564:"cfcfd5599b975d24",858365:"19bf6fc8bc70fe62",858549:"e0061a5cc5175095",858686:"acfdcb8f1a236d41",858764:"c701cb563074b094",859019:"0123d7cd07435c6b",859086:"cffbb081bf84b9a2",859215:"384ac490e0d5c262",859746:"cb48264793ba488f",860005:"4397d79ed95065da",860024:"d57a83257bc91b11",860175:"ad0c911d00fedffe",860319:"99bba5d2b810378c",860332:"6852fbfee80adef0",860494:"ec641d4cab654462",860506:"b18b8cdcbbe630a1",860639:"89d13265072a47ce",860698:"3852f5af4b7a0675",860863:"f03eec2d2687075b",861064:"2df0776c89661935",861330:"23637c5cdf8047c3",861366:"473c506ae217ac8c",861386:"6bbc895cccbdd3ce",861440:"a0182ab4d2329438",861472:"be2c4c32a7291cac",861605:"5762de738c35151e",861844:"ac43ec31a9a1ff9d",862108:"571325b87fae819a",862136:"f06502e7ad330e6d",862151:"c493b22c6df199ab",862198:"aa841dc4895dc6cf",862580:"04c9fddece01bb07",862678:"dc1d51ffe9386a24",862732:"24c8054d226ecc3f",862980:"da4a2e8b6cd6599e",862982:"11417ae9ebdc437c",863185:"48ff636933eb3781",863199:"80c39a9a6854eb5f",863732:"27fa3902999b5f30",863766:"4877ee0079dd4ea3",864055:"c7f7f9b22a52be85",864274:"cc85c88561c4c54d",864422:"079f081b81e0b321",864438:"4cd2460d0c34b6ba",864466:"ae21a12d0d780447",864502:"8da4cf82503225fb",864574:"8ad6b2de3a3e2a1e",865129:"0be16caae4ded9e9",865365:"cfade4312fa1d2b9",865378:"5c67d0be5aad5060",865398:"3af8d02bd72e63f0",865414:"a4b4f3e2329d03f9",865471:"470e93c7d4277664",865807:"01e2336be305f475",865947:"51a1ffc3bf358c4e",866188:"a350cbeea69e1857",866846:"ae4d7eaae1af66df",867186:"bb4cb14bed9c4eb6",867409:"2527280c9fb6fe55",867526:"65914ea1cb15c790",868095:"34eb6f9d8f194692",868123:"b5173f1681a1d39f",868452:"935f080f4acbce17",868507:"12db6358e0f4fb5e",868858:"786da28318c3d537",869144:"1d9110507a83a0a9",869519:"2a4b7354d8c0ee28",869731:"4292d415b3c45645",869907:"e0b3771418e6ec2c",870125:"fa3fbd7725656c69",870246:"2a9d0067e402dafa",870337:"0cd0189e204b5d86",870715:"5e156f69fad0e60f",870716:"a79331f607b63ef9",870723:"39a504ae57b7c4ef",870902:"a8e21d23ebbedf70",870913:"b82f76933c97cf45",870950:"d424d25edf50580a",871288:"d8186d5e65c43aa8",871409:"ba7595888c402e5e",871470:"46429c9c93b32db4",871552:"ff8340f29ab535eb",872484:"b915a93d12698bb8",872501:"ae8724fb1a9d6967",872564:"0b99dbb7d3ebaaaa",873166:"1ce36f48a79872d5",873312:"97856c4e129b3af7",873316:"ec000b06a7b04a55",873339:"b19e523964cdc67b",873354:"c430feb2067a91f3",873507:"4d598621c42a6be6",873523:"0f9d5a50ce3e1ad5",873533:"aef50f4a7cdabcc6",874186:"af65bbf88b726dfc",874188:"b20bbf8e183cc40c",874189:"68f3bb7398b8b244",874906:"07cf8056321ff137",875059:"8c7bd61964b904e6",875229:"0510ed3ccae01c24",875230:"9639be3a15abf16d",875613:"761691b7bc3242fd",875833:"a8b428abddb81be1",875873:"367ec1452600e314",875985:"4a7760b6b1bc9ac5",876003:"56e12004b9290836",876138:"cf718a51c2870008",876240:"a71357a826fea577",876316:"5f55f425e4c58d07",876378:"384818a0f0ae7472",876504:"2397b369de872fd0",876710:"516b7a10fd321e70",876813:"87c086170b50a1df",877174:"9b74ef542a621d10",877233:"56381c025e93a454",877357:"34835eed98391ad9",877414:"cc193d2fa82634a4",877606:"91106ca775931cc3",877725:"32681383bbad73dd",877837:"2a34d7c65726688b",877869:"82d19df0c96e69b0",878052:"bcb38dbb80ea59ce",878713:"52a4e45506c29c2d",878858:"042daf86eb855964",878864:"5de0886e6d45127c",878981:"739f0cc97edb2643",879537:"4cceff2b5d7e6454",879622:"8c61cd6032d4fafc",879629:"a7f601b5dd651038",879659:"85cbdca92009d473",879833:"43e10cd261f87828",880144:"eb152cd73f6f7355",880184:"0323a0100391f25f",880246:"b34eb0c2f69760d3",880414:"06a11c1985210623",880592:"51695ee36923bf24",880956:"9f21d501b1acf3c2",881223:"59f605a3c2adc6b3",881275:"98e409fe853af639",881626:"faa2cc4db302bebd",881735:"28dc3ee08e81da0d",881916:"602f648110eb9e1f",882453:"0d5b15dbd628a239",882880:"ff701364a4e5d918",882927:"da57e0e28e2120ae",883254:"c88d29bf366a7093",883498:"a1cca7104199fa1d",883548:"fc21ea25ff8e07ff",883654:"d8524d7e84d3f232",883750:"3122d8eec43633d6",883819:"760ebcbded9ed420",884265:"7228a7b7a9e3be6c",884441:"fb37246d4b9b7b85",884717:"7504d11f0ed71670",884766:"4c5b3337b4dcb040",884843:"b7ea7c8b84e744fc",885075:"a7c48c34197b358b",885212:"0bf3132a2bf0708d",885976:"f65de5511f38f06f",886205:"b6c904bd666e834d",886258:"aebcd6246dbed520",886793:"631e6b1f44d35b9a",886845:"c945070b59ec90cd",887150:"243daa863c005d2d",887434:"d16b83a5e5a22170",887574:"0f88d0308ba2860c",887584:"3917de4beae53297",887811:"c55c5eb620ad9164",887857:"072764eb99e72c87",888087:"ff46c9284ac09fc3",888094:"331dc10a8e83ca83",888394:"64964c27839addce",888409:"120fc271c9de390e",888441:"feb3c9e895fd9806",889131:"bbeac950f19b72ef",889483:"e920f9a6047b0dab",889907:"1f337b2a41b05425",890330:"be5417e8d8a77355",890565:"9f68e3f927da72fd",890694:"9837bfaae38e5da7",890770:"db04594915467429",890868:"086d6e7dd950954c",891041:"afe071fd991d7c74",891107:"4d970928bf9781e4",891234:"4c97122e0d86be30",891546:"7e1f620d392999da",891643:"2d18e33d75f37619",892617:"b9db1b851130f063",892942:"77bf93c09d7d7290",893098:"88ae09c0349dfe46",893232:"e119c5a1a6933b47",893288:"6923906f249ea088",893295:"230c09be204a1ab9",893393:"6200e9394872eae9",893479:"d64f3141192604ce",893497:"2e5d9a103d77094c",893718:"f883f77d9c8bbb4c",893870:"f7198e1454710813",894087:"48a9b45cc160c106",894598:"cf3dd5c7be45ac7d",894766:"42c08c72d8d30a8a",895146:"53715f56f5a40aba",895195:"716f2f372e5d10c0",895267:"5cc9fc2e1857bc28",895444:"49c95361c488467e",895669:"51b625c8eb8b432e",895768:"0db01545ab10c9ae",895847:"bca8053a2b868508",895972:"5916c936664ee0dc",896008:"e34acaa198ce3596",896317:"b6fb47a6bf800038",896555:"985e5129012926b4",896650:"a747b58869e813fa",896793:"2b13cdb34f862967",896851:"fd4e2fbe6e64212a",897213:"654296c662c18471",897327:"a4f264d2c7aecf3e",897526:"61197e66794d6d49",897620:"0e1343dd375e3be6",897704:"a019001b86925340",897778:"7463e31928d1d549",897783:"48d82f515029fde0",897810:"17ca871f42df36bc",897962:"4c1cc5de6691e54c",898261:"932cb7692101081a",898278:"adb658d000a90e27",898471:"621ccda6fc9c3c52",898701:"2d798abf0100eb3d",898724:"41bac13297576209",898787:"272ec7dbb85cba22",899164:"545f3005ff8aa16d",899367:"a23806eb31fabb64",899405:"fceb33b5981e73d3",900183:"b0c00fd58f2e5504",900218:"0e39036486d88c2f",900551:"d8ca651085b36a67",900675:"68ac64d9a0586d0c",900819:"06890c76a9494e25",900902:"9f6fef237f65b00c",901383:"61675afa788667eb",901510:"1007cac586bc2cc1",901530:"9e6f95f8f2c29a76",901891:"2c33b874ea7c04e4",902016:"fd69bf4e8eecfc15",902078:"55431fd4abacc590",902140:"c0e24bea792207ce",902600:"91318b1f7dd83c8a",902970:"30dde6eba3a77644",903024:"14b2eeb062948266",903301:"7fce5373b16a833d",903420:"d0a73a1f06cb0b5a",903584:"4223ae687ec0f103",903632:"60aac6e40fb41337",904115:"b620670b918a0d0f",904221:"557b14b7685f6b97",904248:"40c42b1ee5a8e76b",904289:"c8e3fc586ad27346",904615:"4f73fac3f84734a4",904642:"953575a89e9619ac",904685:"773729ec596fcec9",905049:"6967b99486fc590b",905058:"df0e5927d2c70e0a",905108:"71df75c31b94229b",905188:"94db2f6770b28290",905224:"114808f8a66de9ae",905421:"dc12458bcb608ff0",905440:"06ed7fe7d78382a0",905462:"ce5f991be1b9903a",905752:"8aed90e94b82315a",905784:"8a8d02214e9c8122",906055:"875e213027124444",906854:"e15a6418dc938cc0",906874:"4468dd70931559b9",906897:"5e08134c47a25ae2",906966:"e746d9bac21bbd22",906990:"e578603d1b8f6bd6",907378:"aa79204c74ffa52e",907696:"d0b2dafc41d5d9a2",907718:"992ddf556798830b",907784:"5652a62e28434b5a",908331:"621e419e773e83f8",908915:"dfe7ede2cf61e4bd",909293:"5d0b861a92baab4a",909664:"c2f4c07a66fe72b0",909890:"9a0f76bd2c6db16a",910066:"c14c4b94f619801b",910122:"102b9406e25fa4d4",910183:"71668bd037113bd7",910562:"ccfe57fb41d84e68",910701:"eed22378f4f6734e",910902:"bee038531fb09044",910942:"f1bf1d0a34625772",911157:"8aedd6a7de4d60a9",911182:"e7fe67e26e48173a",911205:"e4ba36d240fa10b0",911371:"59c9b889259c3d2e",911637:"48f9acc68812e331",911846:"9ad1fe4bd214f6cd",911969:"cc7de6063040f1a5",912081:"46905700da4842e4",912671:"6b66db441f26ba40",913066:"aff87bcbae29b712",913271:"d0cb097d119a5ef9",913386:"eaa096092e745f83",913418:"4a84921fa2d76d2c",913749:"0acb567f3484cc5e",914044:"f936184e669039ac",914091:"fc718d57f409a6de",914129:"a56d963a5223adf4",914475:"c5f10d0ab168e279",914590:"7d75dfda055b06ba",914629:"1138b44d1e4591d6",914682:"e4b9ace9d28396b5",914712:"211741297a66276a",914743:"bad625324ad8d311",915120:"3ae979fbe8581451",915522:"5d3c32ab3688d3e1",915585:"8753010ca39057f3",917133:"dc5b342016fcc895",917692:"361edfb061704650",917706:"92ce8464e8dfcb85",917716:"f56d454725c6576a",917805:"98260717154dab91",917844:"2b93b47c9d1236ab",918199:"1a29b5fb3105aceb",918797:"8447acd7d04d7e67",919220:"eeec24d757023355",919353:"d879750e73dbb587",919389:"6b79d501d6a95013",919534:"84847a8b42d4581a",919778:"d6140d8ab376f4c0",920058:"b25a0068331911ea",920432:"eec525c54e5a06d5",920668:"014cabcd2b0c0277",921132:"9e32348e0131c299",921278:"e55007ab6d45003a",921350:"8799d666bbd17db7",921777:"988f01079ad6be41",921779:"93ae4f28af30d3c8",921978:"0b6d094957fc1018",921979:"4a520cd2971af5ff",922069:"5f6a9f9cbb925093",922194:"618afcc22e648450",922724:"974e84f229a1437c",922761:"24bca5d4aac2ccde",923200:"0486c906c048607c",923449:"323e3f0eeb1c12ec",923557:"c492a9fd3b4d1f6f",923752:"f1cbb376a253f89c",924251:"a0159d19860e8637",924294:"02a603c7fa841fc3",924625:"6b1dbb6bd7ae6c0a",924820:"30837e005812c81b",924860:"6919676464737ca1",925312:"0b241ba8ee30f933",925375:"20a8730fdcb61130",925383:"760e0d97dbad77dd",925409:"4c5d8fbadbf6401b",925442:"8a5753ba37ec466e",925447:"38843824c3e54518",925580:"11235287cd512485",926094:"459a60eedcb573d2",926340:"996bd75c4d19bad2",926858:"3dc2b72f553f2737",926884:"71a8089757081a21",926934:"6e620b3c2e96e2ff",926946:"d6628cf5fe9c7c41",927006:"b51fd6d6b2200305",927030:"3fda61d1dbb775fc",927075:"e788403c13f8f1fc",927245:"0cb885d54884a5e7",927946:"c8143f7d80e62a1a",928299:"8dea5287d31e2191",928400:"16802be66cfe8bb8",928673:"4323fe9f0f7c56e9",929087:"6c886caf72380197",929118:"69dcb88f55797eb1",929389:"5d6e8391ce2969ca",929532:"89b3fba5133bc32b",929813:"93f0f5273176b0a0",929922:"edcfa2ec421968b6",930038:"2572817175a41733",930087:"a36662a592e77059",930217:"7250437bcd8fe051",930384:"a0bb074fc41cb67d",930972:"b3ed7f03968ac5e6",931063:"95838178e559760d",931172:"a9778890590dbe77",931517:"a851a030663380c2",931811:"818993b80fe4d91f",932610:"5ed002cf4b18a467",932639:"23d4f80f043f8393",933139:"a4deeb6567803f93",933181:"f3fcc4909cf117ad",933346:"8dfb257fe1efebcf",933545:"df596ac8b4292934",933611:"16c516b07e014fd9",934038:"a28daa5bb82ab3bf",934060:"85bffbb957c7bb06",934067:"5722331bced05e78",934188:"739ff1387c8eec77",934672:"bdc0d6b085710f1c",934882:"1a3e0c5ab28583e5",935577:"7b0b9c82594db2df",935592:"3930ee721944cd48",936333:"d64bdd043d314d37",936406:"fc9c1e4b817126d4",936614:"64374e3e24f49896",936688:"92aebaec898c59ac",936934:"4856cea42e13c372",937102:"6e50f2314164aec1",937398:"52176c2abef8667c",937813:"1a3fd15d2fb699b2",937827:"a642636ba91060e1",938319:"87b2dd135ecc0a03",938452:"e809916802d6dc59",938652:"c7ff1e2eb4e9c89d",938699:"8c868ff80f5ea122",938968:"2354f0a91ff4eff5",939079:"70b535c972da60e9",939090:"d84fc7eb03d2dbb6",939109:"91689007d67f0d8e",939262:"4686e9ddb6ece024",939387:"6a6fa3c73ba1321f",939626:"9f53d64782f5ca12",939724:"a08498727ecba9f6",940042:"729d985fdb8adcc4",940125:"fb46b09b1ae20d95",940693:"e1a69a2de774711e",940782:"7c34b4f7ed2ad6bb",941193:"5e83e5f533fe684d",941337:"7efddfe477a4357d",941445:"85395fc9b00f797d",941684:"88a7f1b0b4477506",941787:"fc8ee236c14f25e4",941792:"46bde4458625a15d",942049:"a950967d5ef70878",942194:"48530f7b0d110fe0",942239:"58c809fcc6fc91e9",942475:"442a416aa6134b85",942595:"707fba09ff74c8b6",942941:"1e67aba9b57db7a9",943212:"f37e47cca2555b7b",943505:"b4e44330992c532d",943579:"5aaf782033badafc",943743:"adc70c774c3337b3",943950:"cfbeb5059928512a",944013:"5bac0746fe259a90",944047:"9d4fec553f7ead7a",944283:"5e6b17edd222f6c1",944284:"053f9fdb79e74e04",944507:"6d1987b359758b61",944706:"aa8d3c576e1088d7",944731:"a057b605c71c4f66",944942:"fde310574b021c0a",945024:"2dd26b8a806cfba3",945138:"d3db6310d1cba9f4",945170:"f457a2f6da70cc18",945489:"9ba3b4a1c8fc1e6a",945801:"0c397bb4c62a26da",945877:"83817fc064dae46e",946067:"699b4a8b93e5dc80",946089:"c8355efa9a18a8e4",946283:"9b441519a21903ea",946342:"ba8e5b482d6ee052",946573:"542a7f1ecf5ec48b",946712:"ea15ea5ea0f22f38",946838:"19dbc02ac9269ee2",947280:"5e2bbfc6e5da50c7",947806:"703e48bc8c80cf5e",948066:"f154829e0acaf310",948195:"9097c8ec5245bef1",948408:"5649038cbdbffe5c",948418:"e9a76c808efd8f50",948550:"290f0036230dc68c",948606:"2e46747bf02cd8e4",948693:"3550752726508bc5",948715:"c4e94595afef08cc",949567:"286698e1693876e3",949576:"1481622b1c03cce3",949619:"d76c70c81fadb8b1",949742:"8dde0d2722785d5b",950104:"9b7d1599b697b4f5",950615:"cf9155e7d8162fc8",950636:"863e135d2b5fe622",950743:"72bf06d2d9462c12",950747:"5ebbac9292ab4df8",950801:"fe2ecd62a7f2f71d",950839:"2a936901a7186789",951582:"aeb805007e9a3d16",951654:"48d4aca754135e0f",952102:"7e1f7b9884e408d3",952157:"e5a14a802575fa76",952318:"2ced590bd671c03b",952344:"d1821649e812cbbd",953154:"9f8b7cf7722c3c58",953228:"fe163ab7c0b5980d",953303:"f5134d46990741dc",953361:"19a6b84f03acabfb",953578:"c7b2efbe252e5598",953598:"52e1c8aee2af706f",953668:"475efc68fb7719a6",953808:"00fb19cc1e71f852",953871:"ede29066c1a246ff",953993:"bf7f4520b8b7f99b",954009:"a297b6bb86751812",954233:"e9b0f4f6d35b2687",954578:"fb3a3ff95a8c9162",954603:"74e47ce3ed6830d0",954964:"47b36800cffbddbb",955264:"b619e50baf49df16",956010:"2f98a190a62a296c",956081:"cf61c2adcde14243",956097:"5c2d00a66363f5d4",956210:"13f149dd665cc69c",956343:"abf5450e20543ba9",956357:"faccc2582d37ba94",956633:"c6e0c0b8eae189f8",956641:"2da2503d45f56be2",956714:"6ab951583183d201",956867:"3e85e4448666a63b",957156:"8afbe4e0c95b0794",957302:"8a2a1d8a246dfebc",957625:"d8eb55be88b2cd6b",957796:"8b4825b3b0f8791e",957900:"4719304d31bcf83e",957960:"e6f1c5575844afc8",958076:"6d9c8d9c819b9704",958163:"23401751141eb3b2",958359:"5b475e94e252bec7",958636:"04cf651823e7f584",958646:"59f966c4bf25baae",959048:"884b7d082cf6e374",959139:"5ae3eef21304fa6e",959151:"13822f69865c4bed",959258:"16f45c2a0077877a",959362:"79758d2fb114ac4b",959684:"ba85f799400d1918",959752:"63b6deba30a470a8",959860:"c7f1f1d3e291adcb",959930:"7ced27879af807f3",960100:"23d9fb57839d4d9a",960185:"a16b678e09072cfe",960430:"bfc582a6e836b1d3",960489:"bb319bc7c22a694c",960778:"a3fb93424b534262",960877:"a29e00e0bee6deef",960969:"e5b2245a8e839679",960988:"e64efde427322a8f",961038:"f79db6671fed91c7",961074:"17e423f755d109d1",961235:"da3e912a2431eaf1",961320:"39afe0b897929fe6",961331:"fc065f35320a4205",961543:"6680d0aafebcca5e",961702:"a9b674bd60e1d911",962139:"af9f61bb079582bb",962294:"def4e6a6b02f887c",962351:"5700136bd6d2b33b",962382:"384c699888e8fa2b",962457:"900c3e199db6e2f8",962476:"400857ae725c610c",963433:"239d6b41e245dbe3",963809:"44dc91cf20949da6",963825:"18f3ea5bd0f45497",963835:"db4145a26d6bcc04",963957:"70b4ac0261efe21a",964068:"d95f10457b9e2c4d",964070:"a09442057bfdf9b3",964110:"2cd907d56c810aa0",964278:"b7b19eb6a8a853c6",964536:"0d417dd2dcc2b5f8",964702:"5402c38cfe5c543e",964750:"54598ee537197fe1",964754:"9bd18e52f13c5abf",964944:"4b8cf3d48228ca17",965028:"a30878e3c66c6da8",965041:"9aecc196823c3daa",965579:"9837042519b292ca",965851:"a9c750e97618a3a9",966268:"217bffb15bcc2ebe",966652:"2dc6761b72e7b7db",966725:"13341fd59bb5bf41",966761:"edeebd1b9307cc38",966963:"d1ad23594effe60b",967498:"312ccc0f418f50b6",967540:"8be729536c138fc0",967566:"4acbe9ab76694d60",967658:"0e75aaec06dea812",967742:"cb2f361d19dc8831",967847:"22f597bd2aef9976",967953:"f88719a492c0fd23",968204:"f914f491e84e2fe2",968634:"0afbe2f977a75e50",968640:"a59abfc48756a4aa",969198:"35a518ac902dcf67",969345:"cc064da20c3a1c04",969417:"b9a0ed9600ca73c9",969706:"9300b29cfc8100bf",970167:"964cbfc61d7a60d9",970245:"f91cb2e87def9a36",970265:"a9f13f09ccde7379",970357:"db98983b30319896",970421:"a39ff249434215d2",970498:"358525a38a1f8703",970823:"9c5223b40a505df9",971085:"d4828e25a3751661",971592:"99531d8af5d55865",972258:"5738ab4e4e31626d",972297:"3dc640bd2967b839",972463:"3f523f4e1368f392",972572:"63b8faabdb31c6b6",972642:"b06a542a6be972e3",972813:"5f656f5997b48cd2",972925:"161616f6f118c437",972944:"fba1e7906ddad83e",972986:"8b838461570f4bb0",973142:"7c6aeaee13a54a8f",973649:"d8277a484110cbe8",973698:"bf1e3448201963b8",973736:"b4712bf7e1d34ed1",973771:"7fdfc99b49dab03f",973938:"defc6e941bba03aa",973956:"c777029edb1ed797",974237:"7fcdce00a6aaf460",974471:"20e3c091dddfc8b1",974743:"8403afd6e830432b",975145:"c23ac90075edc20a",975421:"6ee61c78cd2de106",975499:"fc9cf3dc50057779",975504:"cb289a867c29463d",975651:"25667ee5879e178b",976003:"90acfb040e159da0",976025:"eced43657c497bd5",976217:"ec245eaee58d1d24",976260:"78e4904f3db07c47",976486:"9d19ac90475c96b0",976738:"ef96b3de125c752f",976808:"aa800aa3c9d8a60f",976830:"d87b584e5ae3aab1",976940:"87e47ed5488b0669",977090:"06136c8e2d650da0",977153:"79a0d334daa62618",977511:"8b2a930e7195242f",977540:"53e20e07b9757b6f",977570:"cabe63bf31902dba",978433:"c10d4384a506f3c5",978537:"045b9ca5435e7c0f",978641:"f7ae5f58fbaed9ae",978848:"1eed1cfed4066b09",978981:"beefc906929d1796",978994:"ad0680cf21a0798f",979019:"9e6fe036a4dc61cf",979307:"2c1d7b72b0bc68f7",979355:"4d93670e4853dc98",979523:"27a901a084747629",979533:"7c184a1424871da1",979753:"c9990fae6157a6f9",979948:"dc84e52726e272e8",980117:"325e1b455ebb6776",980126:"3d479a185cd26be5",980799:"1e8131099f0a1461",980839:"d6a40fb1d163f037",981004:"60eb03f1ebf7abba",981484:"df927440dd2b8be1",981578:"b2ea021e128e49f6",981674:"b065d1743bb99559",981879:"a199b81da2f81ebf",981900:"58584b8dfdb5ec70",982053:"665360e558ee8e39",982110:"a32381605a25e9d7",982175:"2f9b066002b4260f",982265:"08cf0da01e5f977f",983017:"8f4f7174cda9e3ca",983089:"79d8ecbf1b072688",983206:"bad86378ff625924",983695:"6903ab1329574d83",983906:"70a1bebce9517c1b",983999:"783d8b347a710bf9",984267:"b1a6e9d10f95793e",984299:"ad8d1510c5a669e6",984324:"dfc28de3febb0b3d",984335:"fc314b6d9e153827",984360:"943316876fd23bab",984597:"a2abe255f978ed5f",984633:"59ef59b91297f0e7",984964:"5d3f8a3082d61c33",984975:"7727e98ac6228937",984982:"af23097f79c672e1",985340:"9a1b1a09ee3b86ae",985381:"5cd83f9db64264ca",985550:"499f3bc8411fe34f",985552:"f5173850f5d15088",985653:"bf5d3ce832821484",986101:"5e5b129be7975a96",986639:"86c040fb0b9618d7",986892:"6cea3ed668aeabe2",987110:"821bafba143862e7",987311:"9eeffc4e65e171f3",987554:"d5a348c7cf03bdd5",987666:"31bb95183fb0cb91",987864:"d41578e01b27bf65",987927:"fe98fea6441f3093",988486:"cb2f054dc9a179a0",988558:"ae932b05e243cb7c",988681:"faf21c4ed021c940",988876:"c5469a9d7b763d1c",988909:"f342d029053b3d88",989139:"fd49aa5c99f9356c",989419:"d411508874eb2fd6",989465:"b852be8d18e2535c",989537:"03a88d4fd302df2e",989676:"b446d1bef898480c",989689:"3b433622d35d82ce",989829:"cedaf4ed00a0c445",989847:"20061c8fa443b50f",990255:"bd89d5f477d9b584",990477:"5c04720f5c998b0e",990500:"4a996f47300aa43a",990708:"d5c7cec1ab62590a",990776:"b42e520a2be58158",990963:"b5d82051b8302034",991457:"bbf65426eb07ee58",991487:"686d0e867082de7f",991596:"f4967040f9cae15c",991883:"dc883e6bd2120d63",991941:"9be77346cf9b0ec0",992029:"500b64e637a5d62b",992037:"2c0ce397143b3a51",992326:"2f5de505ee3efedf",992338:"1c8be0df29627006",992480:"1a1aefd0b1235c91",992680:"80f7a243e0169775",992784:"d041684f89ec64a7",992948:"8fe03166e6fbc6e2",993088:"4dcef4abffe715fa",993207:"5da33f4c30534d1a",993305:"73a00678f37c3967",993348:"714f7e9542b820ef",993376:"ded10df36137fe15",993820:"0dffb2b905b38119",994009:"976f49199a63fddf",994411:"c3111451d61f55c8",994623:"8e5e725e6003ecfb",994785:"0eb7c926707ffaf5",994959:"8f941da3b58b29be",995020:"cb3af390d66bd14f",995052:"4673f31fae560d4d",995278:"abf6f499d1a1dedf",995582:"6594c67325123061",995682:"8c1de358784d1bf8",995859:"ab6dbf3d79f68ed4",995904:"fc08080c616cd7ff",995954:"677711c6d6411041",996137:"79f1c00496283f2d",996357:"9059f87a14b30b2f",996449:"d5d2147756af98eb",996583:"686f6552bdf98e3a",996696:"8cd8c831dca1631c",996708:"1006c9ae6aaf9dae",996736:"c6ca1e8a2e5caf47",996802:"da8c5a51d9839c1a",996866:"a26c8afb3a549c47",996970:"2ea43acbb2805dba",997071:"410335002fd578c8",997083:"63bf1cab3c1006ab",997203:"c3e8bcae1d7b7671",997267:"4aa7dca950c4ccfc",997378:"e97ed3f37ca1fbb8",997494:"9f6aae06644c3b7d",997686:"ef68c6ee67b5be62",997758:"491b9cf100f70176",998474:"98f6f4ccea123664",998529:"d709720c46cc1254",998813:"d4a6c92120ec3f84",998947:"e8fd10a6a3127d92",999114:"a3e21318e855273b",999200:"0b290db18a181687",999323:"2f180e5f2f0bd828",999856:"65f10bdc31ab1074",999918:"43004c0db8e9e3df"}[e]+".js"),__webpack_require__.miniCssF=e=>({294157:"web_recorder_v2",769663:"pskin",995954:"fluentMtc"}[e]+"-"+{294157:"58f5d2dfd724871e",769663:"17cfde5df911a0a3",995954:"517ca3747d5f5339"}[e]+".css"),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="@msteams/multi-window:",__webpack_require__.l=(e,t,n,i)=>{if(inProgress[e])inProgress[e].push(t);else{var a,o;if(void 0!==n)for(var r=document.getElementsByTagName("script"),s=0;s<r.length;s++){var l=r[s];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==dataWebpackPrefix+n){a=l;break}}a||(o=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=60,__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.setAttribute("data-webpack",dataWebpackPrefix+n),a.src=__webpack_require__.tu(e),0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous")),inProgress[e]=[t];var c=(t,n)=>{a.onerror=a.onload=null,clearTimeout(d);var i=inProgress[e];if(delete inProgress[e],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},d=setTimeout(c.bind(null,void 0,{type:"timeout",target:a}),6e4);a.onerror=c.bind(null,a.onerror),a.onload=c.bind(null,a.onload),o&&document.head.appendChild(a)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.j=740179,__webpack_require__.tu=e=>(void 0===policy&&(policy={createScriptURL:e=>e},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(policy=trustedTypes.createPolicy("@msteams/multi-window",policy))),policy.createScriptURL(e)),__webpack_require__.p="https://statics.teams.cdn.office.net/teams-modular-packages/hashed-assets/",(()=>{if(void 0!==__webpack_require__){var e=__webpack_require__.u,t=__webpack_require__.e,n=new Map,i=new Map;__webpack_require__.u=function(t){return e(t)+(n.has(t)?"?"+n.get(t):"")},__webpack_require__.e=function(a){return t(a).catch((function(t){var o=i.has(a)?i.get(a):1;if(o<1){var r=e(a);throw t.message="Loading chunk "+a+" failed after 1 retries.\n("+r+")",t.request=r,t}var s="ts="+Date.now();return n.set(a,s),i.set(a,o-1),__webpack_require__.e(a)}))}}})(),void 0!==__webpack_require__&&(__webpack_require__.p=__webpack_require__.g&&__webpack_require__.g.__webpack_public_path__||__webpack_require__.p),loadStylesheet=e=>new Promise(((t,n)=>{var i=__webpack_require__.miniCssF(e),a=__webpack_require__.p+i;if(((e,t)=>{for(var n=document.getElementsByTagName("link"),i=0;i<n.length;i++){var a=(r=n[i]).getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(a===e||a===t))return r}var o=document.getElementsByTagName("style");for(i=0;i<o.length;i++){var r;if((a=(r=o[i]).getAttribute("data-href"))===e||a===t)return r}})(i,a))return t();((e,t,n,i)=>{var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.onerror=a.onload=o=>{if(a.onerror=a.onload=null,"load"===o.type)n();else{var r=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=r,l.request=s,a.parentNode.removeChild(a),i(l)}},a.href=t,0!==a.href.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous"),document.head.appendChild(a)})(e,a,t,n)})),installedCssChunks={740179:0,222474:0},__webpack_require__.f.miniCss=(e,t)=>{installedCssChunks[e]?t.push(installedCssChunks[e]):0!==installedCssChunks[e]&&{294157:1,769663:1,995954:1}[e]&&t.push(installedCssChunks[e]=loadStylesheet(e).then((()=>{installedCssChunks[e]=0}),(t=>{throw delete installedCssChunks[e],t})))},(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={740179:0,222474:0};__webpack_require__.f.j=(t,n)=>{var i=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else if(995954!=t){var a=new Promise(((n,a)=>i=e[t]=[n,a]));n.push(i[2]=a);var o=__webpack_require__.p+__webpack_require__.u(t),r=new Error;__webpack_require__.l(o,(n=>{if(__webpack_require__.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;r.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",r.name="ChunkLoadError",r.type=a,r.request=o,i[1](r)}}),"chunk-"+t,t)}else e[t]=0},__webpack_require__.F.j=t=>{if((!__webpack_require__.o(e,t)||void 0===e[t])&&995954!=t){e[t]=null;var n=document.createElement("link");n.crossOrigin="anonymous",__webpack_require__.nc&&n.setAttribute("nonce",__webpack_require__.nc),n.rel="prefetch",n.as="script",n.href=__webpack_require__.p+__webpack_require__.u(t),document.head.appendChild(n)}},__webpack_require__.H.j=t=>{if((!__webpack_require__.o(e,t)||void 0===e[t])&&995954!=t){e[t]=null;var n=document.createElement("link");n.charset="utf-8",__webpack_require__.nc&&n.setAttribute("nonce",__webpack_require__.nc),n.rel="preload",n.as="script",n.href=__webpack_require__.p+__webpack_require__.u(t),0!==n.href.indexOf(window.location.origin+"/")&&(n.crossOrigin="anonymous"),document.head.appendChild(n)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,n)=>{var i,a,[o,r,s]=n,l=0;if(o.some((t=>0!==e[t]))){for(i in r)__webpack_require__.o(r,i)&&(__webpack_require__.m[i]=r[i]);if(s)var c=s(__webpack_require__)}for(t&&t(n);l<o.length;l++)a=o[l],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(c)},n=this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),chunkToChildrenMap={124197:[706240],279673:[706240],397423:[706240],462030:[188100],481647:[188100],589407:[410202,758629,8809,205870,255165,750553,782964,316600,16083,565656,468318],665242:[706240],707959:[706240]},__webpack_require__.f.prefetch=(e,t)=>Promise.all(t).then((()=>{var t=chunkToChildrenMap[e];Array.isArray(t)&&t.map(__webpack_require__.E)})),(()=>{var e={175925:[203831,716151,812946,283035]};__webpack_require__.f.preload=t=>{var n=e[t];Array.isArray(n)&&n.map(__webpack_require__.G)}})();var __webpack_exports__=__webpack_require__.O(void 0,[197981,259196,86052,671433,636762,499057,836870,213104,384420,216998,181896,863993,344767,626598,814497,61627,4528,719823,191280,86048,481321,384848,674818,38090,860125,628212,540864,835115,446086,920855,499444,648558,479247,766340,540927,530658,926721,247614,905697,990306,520070,858141,924897,495706,307826,511720],(()=>__webpack_require__(97037)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/main-f0ec5187a146b612.js.map