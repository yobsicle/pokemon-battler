"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[990306],{778764:(e,t,r)=>{if(r.d(t,{w:()=>l,K:()=>p,su:()=>c}),740179==r.j)var n=r(912825);var i=r(595068),o=r(47135),a=r(948519);const s=e=>e&&e.startsWith(i.V.Bot),d=e=>s(e)?e.slice(3):e.slice(e.includes("_")?41:8),l=(e,t)=>{let r=[];return r=s(e)&&!s(t)?[d(t),d(e)]:!s(e)&&s(t)?[d(e),d(t)]:[d(e),d(t)].sort(),`19:${r[0]}_${r[1]}@unq.gbl.spaces`};function p(){const[e,t]=(0,n.M)(2);return`${e}${t}`.substr(0,19)}function c(e){const{ageGroup:t}=e.get(o.J.AgeConsent);return t===a.zH.MinorWithMsaParentalConsent||t===a.zH.MinorWithoutMsaParentalConsent}},443467:(e,t,r)=>{r.d(t,{ne:()=>d,cx:()=>l,zP:()=>v});var n=r(381583),i=r(556569),o=r(533207),a=r(97600),s=r(197981);const d=(e,t,r,n)=>{const o=i.eo.getRequestCount(e),{accountEnabled:a,mri:s,objectId:d,displayName:l,givenName:h,surname:v,type:P,jobTitle:g,userPrincipalName:T,email:b,tenantId:S,sipProxyAddress:y,mobile:M,telephoneNumber:I,tenantName:U,decoratedDisplayName:w,cid:A,description:L,externalCalendarEmailAddress:E,homeMri:N,homeTenantId:x,profileType:B}=e,k={__typename:"User",accountEnabled:a,id:C(e),objectId:d,mri:s,displayName:l,givenName:h,surname:v,type:P,jobTitle:g,userPrincipalName:T,email:b,tenantId:r||S||null,sipProxyAddress:y,mobile:M,telephoneNumber:I,requestCount:o,preferredUserName:t,tenantName:U||null,decoratedDisplayName:w||null,cid:A,description:L,externalCalendarEmailAddress:E,emailForQuery:n,homeMri:N,homeTenantId:x,profileType:B};return function(e,t){const r=e.department;r&&(t.department=r)}(e,k),m(e,k),u(e,k),p(e,k),c(e,k),f(k),k},l=e=>{const{id:t,displayName:r,description:n,email:i,phone:o,mri:a,requestCount:s,syncSource:d}=e;return{__typename:"User",id:t,mri:a,objectId:a,displayName:r,userPrincipalName:a,givenName:r,surname:r,description:n,email:i,mobile:o,telephoneNumber:o,requestCount:s,syncSource:d}},p=(e,t)=>{var r;if(function(e){var t;const r=e;return void 0!==r.isFederated||void 0!==r.isAnonymousB2bUser||"federated"===(null===(t=r.type)||void 0===t?void 0:t.toLowerCase())}(e)){const{isFederated:n,fetchErrorCode:i,isAnonymousB2bUser:o}=e;t.isFederated=n||"federated"===(null===(r=e.type)||void 0===r?void 0:r.toLowerCase()),t.fetchErrorCode=i,t.isAnonymousB2bUser=o}else t.isFederated=null,t.fetchErrorCode=null,t.isAnonymousB2bUser=null},c=(e,t)=>{e.featureSettings&&(t.featureSettings=e.featureSettings),e.isBlocked&&(t.isBlocked=e.isBlocked),e.cid&&(t.cid=e.cid),e.isIbBarred&&(t.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(t.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(t.phonesInfo=(0,s.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(t.emailsInfo=(0,s.cloneDeep)(e.emailsInfo)),e.xtapUser&&(t.xtapUser=e.xtapUser),e.companyName&&(t.companyName=e.companyName),e.tenantName&&(t.tenantName=e.tenantName),e.imageUri&&(t.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(t.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),e.avatarEtag&&(t.avatarEtag=e.avatarEtag),e.avatarUrl&&(t.avatarUrl=e.avatarUrl),t.isShortProfile=e.isShortProfile},u=(e,t)=>{(function(e){return void 0!==e.userType}(e)||function(e){const t=e;return t.type?t.type===n.t.botType:(0,a.bl)(e.mri)}(e)||function(e){var t,r;return"aduser"===(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())||"aduser"===(null===(r=e.$$subType)||void 0===r?void 0:r.toLowerCase())}(e))&&(t.userType=e.userType,t.description=e.description,t.isUnified=e.isUnified,t.securityEnabled=e.securityEnabled,t.featureSettings=e.featureSettings,t.imageUri=e.imageUri,t.userLocation=e.userLocation)},m=(e,t)=>{const r=e.phones;r&&(t.phones=r.map((e=>h(e))))},h=e=>({number:e.number,type:e.type}),f=e=>{const{mri:t}=e;if((0,o.EG)(t)&&!e.displayName){const r=(0,o.Ol)(t);e.displayName=r,e.givenName=r}else if(t&&(0,a.MR)(t)&&!e.displayName){const r=(0,a.vq)(t);e.displayName=r,e.givenName=r}else e.displayName||(e.displayName="Unknown User");return e},v=e=>!!e&&!("string"!=typeof e||!i.eo.isTFLSmsVerifiedMri(e)),C=e=>e.mri||e.objectId||e.concatenatedId},595208:(e,t,r)=>{var n,i,o,a,s,d,l,p,c,u,m,h,f,v,C,P,g,T,b,S,y,M,I,U,w,A;r.d(t,{qi:()=>n,qb:()=>i,OM:()=>o,Pw:()=>a,aZ:()=>s,Aj:()=>d,jD:()=>l,BU:()=>p,YV:()=>c,Ye:()=>u,Uh:()=>m,i8:()=>h,Z9:()=>f,o1:()=>M,g7:()=>I,Hd:()=>U,_W:()=>w,n$:()=>A}),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat"}(n||(n={})),function(e){e.Pin="Pin",e.Unpin="Unpin",e.Reorder="Reorder"}(i||(i={})),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(o||(o={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Messaging="Messaging",e.Connector="Connector"}(a||(a={})),function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced"}(s||(s={})),function(e){e.Unknown="Unknown",e.SidePanel="SidePanel",e.Stage="Stage"}(d||(d={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(l||(l={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.TeamLevelApp="TeamLevelApp"}(p||(p={})),function(e){e.Application="Application",e.Delegated="Delegated"}(c||(c={})),function(e){e.MRU="MRU",e.AlphabeticalAsc="AlphabeticalAsc",e.AlphabeticalDesc="AlphabeticalDesc"}(u||(u={})),function(e){e.NewUpload="NewUpload",e.Update="Update",e.Upgrade="Upgrade"}(m||(m={})),function(e){e.NewUpload="NewUpload",e.Update="Update"}(h||(h={})),function(e){e.Unknown="Unknown",e.PrivateChannel="PrivateChannel"}(f||(f={})),function(e){e.Mail="mail"}(v||(v={})),function(e){e.Desktop="desktop",e.Mobile="mobile"}(C||(C={})),function(e){e.General="general"}(P||(P={})),function(e){e.Short="short",e.Long="long"}(g||(g={})),function(e){e.MailRead="mailRead",e.MailCompose="mailCompose",e.MeetingDetailsOrganizer="meetingDetailsOrganizer",e.MeetingDetailsAttendee="meetingDetailsAttendee"}(T||(T={})),function(e){e.After="after",e.Before="before"}(b||(b={})),function(e){e.Button="button",e.Menu="menu"}(S||(S={})),function(e){e.PromptUser="promptUser",e.SoftBlock="softBlock",e.Block="block"}(y||(y={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(M||(M={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(I||(I={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition"}(U||(U={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(w||(w={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(A||(A={}))},209114:(e,t,r)=>{r.d(t,{dP:()=>n,qN:()=>i,iv:()=>o,vO:()=>s,VS:()=>p,f1:()=>c,b:()=>u});var n,i,o,a,s,d,l=r(469929);!function(e){e.ScheduledDraft="ScheduledDraft"}(n||(n={})),function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DeltaSync=7]="DeltaSync",e[e.SyncOnDemandFromLongpoll=8]="SyncOnDemandFromLongpoll",e[e.AdHocPropertyUpdate=9]="AdHocPropertyUpdate"}(i||(i={})),function(e){e[e.Sending=0]="Sending",e[e.Delivered=1]="Delivered",e[e.Received=2]="Received",e[e.Error=3]="Error",e[e.Deleted=4]="Deleted"}(o||(o={})),function(e){e[e.Muted=0]="Muted",e[e.Simple=1]="Simple",e[e.Important=2]="Important",e[e.Mentioned=3]="Mentioned"}(a||(a={})),function(e){e[e.StartupSyncClean=1]="StartupSyncClean",e[e.StartupSyncUpdate=2]="StartupSyncUpdate",e[e.ThreadDetailsSync=3]="ThreadDetailsSync",e[e.LongPoll=4]="LongPoll",e[e.ResolverPutConversation=5]="ResolverPutConversation",e[e.LocalUpdate=6]="LocalUpdate",e[e.PutConversationLie=7]="PutConversationLie",e[e.AddUsersToConversation=8]="AddUsersToConversation",e[e.ConversationFetchJob=9]="ConversationFetchJob",e[e.GroupChatsStartupJob=10]="GroupChatsStartupJob",e[e.OneToOneChatFetchJob=11]="OneToOneChatFetchJob",e[e.NonRecentChatsStartupJob=12]="NonRecentChatsStartupJob",e[e.NonRecentChatsStartupRetryJob=13]="NonRecentChatsStartupRetryJob"}(s||(s={}));class p{}p.NotificationConversationId=`${l.at.PrivateFeed}notifications`,p.StarredConversationId=`${l.at.PrivateFeed}starred`,p.CallLogConversationId=`${l.at.PrivateFeed}calllogs`,p.AnnotationsConversationId=`${l.at.PrivateFeed}annotations`,function(e){e[e.Message=0]="Message"}(d||(d={}));const c="x-ms-request-priority";var u;!function(e){e[e.RealTimeSync=0]="RealTimeSync",e[e.ForegroundSync=10]="ForegroundSync",e[e.BackgroundSync=20]="BackgroundSync"}(u||(u={}))},844943:(e,t,r)=>{r.d(t,{wT:()=>m,Ut:()=>h,GS:()=>f,c_:()=>v,B8:()=>g,_2:()=>T,LQ:()=>b,Jn:()=>S,Iy:()=>y,R8:()=>M,vJ:()=>I,re:()=>U,mO:()=>w,dk:()=>A,io:()=>L,Bu:()=>E,x:()=>N,X5:()=>x,$n:()=>B,_T:()=>k,MQ:()=>D,Xc:()=>Q,DA:()=>O,gw:()=>F,lj:()=>W,oy:()=>R,lF:()=>$});var n=r(47135),i=r(469929),o=r(737170),a=r(197981),s=r(209114),d=r(97600),l=r(65903),p=r(402527),c=r(310070),u=r(60746);const m=({isActionToAccept:e,isUserBlocked:t,isInQuarantine:r,quarantineCounter:o,creator:a,currentUserMri:s},d)=>{let l=i.uI.Accepted;if(e){if(t){const e=a===s,{maxInviteFreeQuarantineCounter:t}=d.get(n.J.People),p=o>=(t||0);r&&!e?l=i.uI.AcceptPending:e&&p&&(l=i.uI.Quarantined)}}else l=i.uI.Blocked;return l},h=e=>!!(null==e?void 0:e.startsWith(i.at.PhonelinkSmsPrefix)),f=(e,t)=>v(e.id,t)&&T(e,t),v=(e,t)=>{if(!P(e))return!1;const{overrideThreadTypeForPrivateFeeds:r}=t.get(n.J.Sync);return(!(0,d.dV)(e)||!r)&&!h(e)},C=/^\d+[:]{1}.+/,P=e=>!(0,a.isUndefined)(e)&&e!==i.kK&&e!==i.Ov&&!h(e)&&!e.includes(i.YP)&&!e.includes(i.BQ)&&C.test(e),g=e=>e.startsWith(i.IK)?"MRI conv id":e,T=(e,t)=>!(b(e)&&!function(e){const{msgEnableSfbCloudFromBVD:t}=e.get(n.J.Messaging),{isSfbCloud:r,isSipEnabled:i,isSfbCloudInBVD:o,isSipEnabledInBVD:a}=e.get(n.J.UserResources);return!!(t?a&&o:i&&r)}(t));function b(e){return((0,a.isString)(e)?e:e.id).endsWith(i.GQ)}const S=e=>!!e&&b(e),y=e=>{var t;const r=null===(t=e.memberProperties)||void 0===t?void 0:t[i.e0.RelationshipState];return!!(null==r?void 0:r.edRedemptionRequired)},M=e=>{var t;const r=null===(t=e.memberProperties)||void 0===t?void 0:t[i.e0.RelationshipState];return!!(null==r?void 0:r.blockTime)};const I=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[i.e0.IsModerator])},U=e=>e.threadProperties&&!!e.threadProperties[i.Q5.ParentSpaces],w=e=>e.threadProperties&&e.threadProperties[i.Q5.ThreadType]===o.T.Team&&U(e),A=e=>{var t,r;if(e.threadProperties&&(null===(t=e.threadProperties)||void 0===t?void 0:t[i.Q5.ParentSpaces]))try{const t=JSON.parse(null===(r=e.threadProperties)||void 0===r?void 0:r[i.Q5.ParentSpaces]);return t&&t.linkedSpaceInfoItems&&t.linkedSpaceInfoItems[0]&&t.linkedSpaceInfoItems[0].spaceThreadId&&t.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},L=e=>{if(e.threadProperties)try{const t=e.threadProperties.meeting,r=t?JSON.parse(t):void 0;return r?r.meetingType:void 0}catch(e){return}},E=e=>{if(e)try{const t=e.meeting,r=t?JSON.parse(t):void 0,n=r?r.isCommentStream:void 0;return!0===n||"true"===(null==n?void 0:n.toLowerCase())}catch(e){return}},N=e=>x(e.type),x=e=>!!e&&e.toLowerCase&&e.toLowerCase()===i.i1.Meeting.toLowerCase(),B=e=>{let t;if(N(e)&&e.threadProperties.meeting)try{const r=JSON.parse(e.threadProperties.meeting);r.subject&&(t=r.subject)}catch(e){return t}return t},k=e=>e===i.Cs.Text||e===i.Cs.RichText||e===i.Cs.HTML,D=e=>{var t;return!!(null===(t=e.members)||void 0===t?void 0:t.some((e=>(0,d.Nl)(e.id))))},Q=e=>{var t;return e.id===s.VS.CallLogConversationId||(0,d.u5)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},O=e=>{const t=c.I*p.kg*c.s;if(!e||isNaN(e))return!0;return e-Date.now()<t},F=e=>(null==e?void 0:e.threadProperties)&&((null==e?void 0:e.threadProperties[i.Q5.ThreadType])===o.T.Community||(null==e?void 0:e.threadProperties[i.Q5.SpaceType])===i.Q5.SpaceType_Community),W=e=>e.threadProperties&&e.threadProperties[i.Q5.SubstrateGroupId]||"",R=e=>{var t,r;const n=null===(r=null===(t=e.threadProperties)||void 0===t?void 0:t[i.Q5.ThreadSubType])||void 0===r?void 0:r.toLowerCase();return n||u.YF.Unknown},$=e=>{const t=e.threadProperties&&e.threadProperties[i.Q5.ThreadType];return J(t)},J=e=>{if(e)return"space"===e||"topic"===e?l.k2e.Channel:"meeting"===e?l.k2e.Meeting:l.k2e.None}},490503:(e,t,r)=>{r.d(t,{MJ:()=>u,K6:()=>m,Du:()=>h,ut:()=>f,uY:()=>v,pl:()=>C,ky:()=>P,Fz:()=>g,zb:()=>T,s6:()=>b,rt:()=>S,xb:()=>y,eb:()=>M,HU:()=>I,X3:()=>U,Dq:()=>A,iX:()=>L,S5:()=>E,nV:()=>N,$V:()=>x,JJ:()=>B,J6:()=>k,sL:()=>D,pi:()=>Q,Cd:()=>O,hk:()=>F,rj:()=>W,Fv:()=>R,hu:()=>$,dO:()=>J,BL:()=>G,jo:()=>V,nZ:()=>_,iE:()=>j,hP:()=>q,qo:()=>z,CB:()=>H,au:()=>X,ZY:()=>Y,T7:()=>K,Xg:()=>Z,YP:()=>ee,Zg:()=>te,j8:()=>ne,W7:()=>ie,is:()=>oe,dG:()=>le,Lg:()=>pe,Su:()=>ce,rP:()=>ue,As:()=>me,nL:()=>he,Bl:()=>fe,mB:()=>ve,Eu:()=>Ce,hC:()=>Pe,DZ:()=>ge,me:()=>Te,BU:()=>be,Ii:()=>Se,$c:()=>ye,tl:()=>Me,Ts:()=>Ie,wU:()=>Ue,jM:()=>Le,Il:()=>Ee,Fx:()=>Ne,Ki:()=>xe,rf:()=>Be,cu:()=>ke,ln:()=>De,iK:()=>Qe,y5:()=>Oe,Ti:()=>Fe});var n=r(209114),i=r(197981),o=r(47135),a=r(97600),s=r(469929),d=r(737170),l=r(60746),p=r(844943),c=r(991161);var u;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(u||(u={}));const m=e=>{const t=M(e);return(0,p.LQ)(e)?t:t||(0,p.Jn)(e)},h=e=>{var t;return(null===(t=e.threadProperties)||void 0===t?void 0:t[s.Q5.Creator])||null},f=e=>e.threadProperties&&e.threadProperties[s.Q5.CreatedAt]?e.threadProperties[s.Q5.CreatedAt]:null,v=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const t=e.threadProperties.isDeleted||e.threadProperties[s.Q5.IsDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},C=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const t=e.properties.isDeleted||e.properties[s.Ff.isDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},P=(e,t)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const r=J(e,t);return 0!==r&&(!(0,i.isNil)(e.lastMessageTimeUtc)&&r>=e.lastMessageTimeUtc)},g=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Followed])&&"true"===(null===(t=e.properties[s.Ff.Followed])||void 0===t?void 0:t.toLowerCase())},T=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Collapsed])&&"true"===(null===(t=e.properties[s.Ff.Collapsed])||void 0===t?void 0:t.toLowerCase())},b=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,S=e=>b(e)||!q(e);function y(e){return e.includes(s.YP)||e.includes(s.BQ)||e===s.kK}const M=e=>{var t;return(0,a.Q5)(e.id,null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)&&y(e.id)},I=e=>e.threadProperties&&(e.threadProperties[s.Q5.ThreadType]===d.T.Team||e.threadProperties[s.Q5.ThreadType]===d.T.Community)&&!(0,p.re)(e),U=e=>Q(e)?Te(e)||"":K(e)||"";function w(e){return!!e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===d.T.Team}const A=e=>{var t;if(e.properties){if(e.properties[s.Ff.Favorite])return"true"===(null===(t=e.properties[s.Ff.Favorite])||void 0===t?void 0:t.toLowerCase());if(w(e))return!0}return!1},L=(e,t=!1)=>E(e.type,t),E=(e,t=!1)=>!(0,i.isNil)(e)&&(e.toLowerCase()===s.i1.Chat.toLowerCase()||e.toLowerCase()===s.i1.PhoneChat.toLowerCase()||e.toLowerCase()===s.i1.Phonelink1on1Chat.toLowerCase()||e.toLowerCase()===s.i1.PhonelinkGroupChat.toLowerCase()||e.toLowerCase()===s.i1.OneOnOne.toLowerCase()||e.toLowerCase()===s.i1.StreamOfNotes.toLowerCase()||!t&&(0,p.X5)(e)),N=e=>e.type===s.i1.RCC,x=e=>{var t;return e.id===n.VS.NotificationConversationId||(0,a.j6)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},B=e=>e===n.VS.AnnotationsConversationId,k=e=>e.type===s.i1.Team||e.type===s.i1.Topic,D=e=>z(e)===l.xu.Shared,Q=e=>(0,p.mO)(e)&&(0,p.dk)(e)&&z(e)===l.xu.Private,O=e=>I(e)&&!!e.memberProperties&&!!e.memberProperties[s.e0.ChannelOnlyMember],F=e=>{if(!(0,p.x)(e))return!1;const t=(0,p.io)(e);return!!t&&t===s.wJ.Adhoc},W=e=>{if(!(0,p.x)(e))return!1;const t=(0,p.io)(e);return!!t&&t===s.wJ.Scheduled},R=(e,t)=>e.from.substring(e.from.indexOf("/")+1)===(-1===t.indexOf(s.rK)?s.rK+t:t),$=(e,t)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:r}=t.get(o.J.Sync),n=r||D(e)?e.threadProperties.retentionHorizonV2:0;return n&&isFinite(Number(n))?Number(n):0},J=(e,t)=>{if(!e.properties)return 0;if(C(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const r=(!t||!!t.get(o.J.Messaging).enableDeleteChat)&&L(e)?e.properties.clearHistoryTime:0;return r&&isFinite(Number(r))?Number(r):0},G=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,V=(e,t,r)=>{const n=$(t,r);return!isNaN(Number(e))&&!isNaN(n)&&Number(e)<n},_=(e,t,r)=>{const n=J(t,r),i=Number(e);return!isNaN(i)&&!isNaN(n)&&i<n},j=(e,t,r=!1)=>{var n;if((0,a.Q5)(e.id,null===(n=null==e?void 0:e.threadProperties)||void 0===n?void 0:n.threadType)&&!b(e)){if(e.memberProperties&&r)return e.memberProperties[s.e0.ExpirationTime];if(e.members&&t){const r=(0,i.find)(e.members,(e=>e&&e.id===t));return r&&r.memberExpirationTime}return e.memberProperties&&e.memberProperties[s.e0.ExpirationTime]}},q=(e,t)=>{var r;return!(0,a.Q5)(e.id,null===(r=null==e?void 0:e.threadProperties)||void 0===r?void 0:r.threadType)||!b(e)&&!v(e)&&((0,i.isArray)(e.members)&&t?(0,i.some)(e.members,(e=>e&&e.id===t)):!(e.threadProperties&&k(e)&&!e.threadProperties[s.Q5.LastLeaveAt]&&!e.threadProperties[s.Q5.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[s.Q5.LastLeaveAt]&&(!e.threadProperties[s.Q5.LastJoinAt]||e.threadProperties[s.Q5.LastJoinAt]<e.threadProperties[s.Q5.LastLeaveAt])))};function z(e){if(!e||!k(e))return;const t=e.threadProperties[s.Q5.SpaceTypes],r=t?parseInt(t,10):0,n=!!e.threadProperties[s.Q5.SubstrateGroupId],i=(0,p.oy)(e);return n?i===l.YF.PrivateChannel?l.xu.Private:l.xu.Shared:(r&l.tG.Private)===l.tG.Private?l.xu.Private:l.xu.Standard}const H=(e,t)=>{var r;if(!!e.threadProperties.isLastMessageFromMe)return!0;const n=null===(r=e.lastMessage)||void 0===r?void 0:r.from;if(!n)return!1;return t===(0,i.last)(n.split("/"))},X=(e,t)=>(0,i.reduce)(e.members,((e,r)=>{const n=r.id;return n&&n!==t&&e.push(n),e}),[]),Y=(e,t,r)=>{let n;const o=!e.members||!!e.members&&(0,i.some)(e.members,(e=>!e));if(r&&!o){const i=X(e,t);n=M(e)&&1===i.length?r[i[0]]:r[e.id]}return n},K=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(L(e)){let t=e.threadProperties.topic;if(t&&-1!==t.indexOf(":")&&(t=void 0),!t&&(0,p.x)(e)){const r=(0,p.$n)(e);r&&(t=r)}return t}if(w(e)&&le(e)){const t=Te(e);if(t&&t.trim())return t}else{const t=e.threadProperties.topic,r=e.threadProperties[s.Q5.TopicThreadTopic];if(t&&t.trim())return t;if(r&&r.trim())return r}}return""},Z=(e,t=!1)=>L(e,!0)&&!ee(e,t),ee=(e,t=!1)=>{var r;const n=e.members&&e.members.length<=2;return L(e,!0)&&n&&(oe(e)||M(e)||de(e)||!t&&se(e)||re(e))&&!(null===(r=e.members)||void 0===r?void 0:r.some((e=>(0,a.$i)(e.id))))},te=e=>{var t;return ee(e)&&(null===(t=e.members)||void 0===t?void 0:t.some((({id:e})=>(0,a.bl)(e))))},re=e=>e.members&&e.members.length<=2&&ae(e)&&(e.type===s.i1.PhoneChat||e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===d.T.PhoneChat),ne=e=>(0,p.Ut)(e),ie=e=>e.type===s.i1.PhonelinkGroupChat,oe=e=>e.type===s.i1.Phonelink1on1Chat,ae=e=>(0,i.some)(e.members,(e=>!!e.id&&e.id.startsWith(s.at.Pstn))),se=e=>L(e,!0)&&e.members&&2===e.members.length&&!(0,i.isNil)(e.threadProperties)&&parseInt(e.threadProperties[s.Q5.CreatedAt],10)<s.Yv,de=e=>{var t,r;return!!e.id&&e.id.indexOf(s.B3)>-1||"true"===(null===(r=null===(t=e.threadProperties[s.Q5.P2PChatUniqueRosterThread])||void 0===t?void 0:t.toString())||void 0===r?void 0:r.toLowerCase())||we(e)},le=e=>e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===d.T.Topic||Q(e)||D(e),pe=e=>(0,p.Jn)(e),ce=e=>fe(e&&e.id),ue=e=>pe(e)||(e=>me(e))(e)||ce(e),me=e=>{const t=(0,i.isString)(e)?e:e.id;return(0,i.endsWith)(t,s.M9)||(0,i.endsWith)(t,s.IS)||(0,i.startsWith)(t,s.X2)},he=e=>me(e)||Ue(e),fe=e=>!!e&&((0,i.endsWith)(e,s.RS)||(0,i.startsWith)(e,s.QV)),ve=e=>e===s.Z,Ce=e=>{const t=(0,i.endsWith)(e,s.M9)||(0,i.endsWith)(e,s.IS)||(0,i.startsWith)(e,s.X2),r=e.endsWith(s.GQ),n=fe(e);return t||r||n},Pe=e=>{const t=j(e),r=t&&t<Date.now();return q(e)&&!r},ge=e=>{if(e.threadProperties&&e.threadProperties[s.Q5.Topics]){const t=e.threadProperties[s.Q5.Topics];if("["!==t.substr(0,1))return t.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(t)}catch(e){return[]}}return[]},Te=e=>{if(e.threadProperties){if(e.threadProperties[s.Q5.XTeamName])return e.threadProperties[s.Q5.XTeamName];if(e.type===s.i1.Team&&e.threadProperties.topic)return e.threadProperties.topic}},be=e=>{const t=ge(e),r=Te(e);return t.map((t=>{const n={},i=t.name;return n[s.Q5.CreatedAt]=parseInt(t.createdat,10),n[s.Q5.Picture]=t.picture,n[s.Q5.IsDeleted]=t.isdeleted,n[s.Q5.XTeamName]=t.isShared?i:r,n.topic=i,n[s.Q5.TopicThreadTopic]=i,{threadProperties:n,id:t.id,members:[],messages:"",properties:{},version:0,type:s.i1.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},Se=e=>{if(e.parentId)return e.parentId;if((0,p.re)(e))try{const t=JSON.parse(e.threadProperties[s.Q5.ParentSpaces]),r=t.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,i.isEmpty)(r))return r}catch(e){return}},ye=e=>{const t=e.threadProperties&&e.threadProperties[s.Q5.SpaceId];return(I(e)?e.id:(0,p.re)(e)?Se(e):t)||e.teamId},Me=e=>{var t;const r=e.properties?null===(t=e.properties[s.Ff.Alerts])||void 0===t?void 0:t.trim().toLowerCase():void 0;return"true"!==r&&("false"===r||void 0)},Ie=e=>e.threadProperties&&((0,i.isBoolean)(e.threadProperties[s.Q5.GapDetectionEnabled])?e.threadProperties[s.Q5.GapDetectionEnabled]:"true"===(0,i.lowerCase)(e.threadProperties[s.Q5.GapDetectionEnabled])),Ue=e=>{const t=Le(e);return t&&!me(e)&&ee(e)&&(0,i.some)(e.members,(e=>e.tenantId&&e.tenantId!==t))||Ae(e.id)||Ae(e.localClientId||"")},we=e=>{var t,r;return!(0,i.isNil)(e.threadProperties)&&(e.threadProperties[s.Q5.TemplateType]===s.Q5.ImmutableRoster||"true"===(null===(r=null===(t=e.threadProperties[s.Q5.IsStickyThread])||void 0===t?void 0:t.toString())||void 0===r?void 0:r.toLowerCase()))},Ae=e=>(0,i.startsWith)(e,s.At),Le=e=>e.threadProperties&&e.threadProperties[s.Q5.TenantId],Ee=e=>{const t=I(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Space.toLowerCase(),r=k(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Topic.toLowerCase();return t||r},Ne=e=>function(e){if(!e.properties)return!1;return function(e){if(!e)return 0;const t=new Date(e),r=t?t.getTime():0;return isNaN(r)?0:r}(e.properties[s.Ff.LastImportantImTime])>Number(xe(e).originalArrivalTime)}(e),xe=e=>(0,i.isEmpty)(e.properties&&e.properties[s.Ff.ConsumptionHorizonBookmark])?(0,c.bf)(e):(0,c.BU)(e);const Be=e=>{if(!e||!e.properties)return!1;const t=e.properties[s.Ff.isPinned];return!!t&&("boolean"==typeof t?t:"string"==typeof t&&"true"===t.toLowerCase())},ke=e=>{var t;const r=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return!!(null==r?void 0:r.inQuarantine)},De=e=>{var t;const r=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return"number"==typeof(null==r?void 0:r.quarantineCounter)?null==r?void 0:r.quarantineCounter:0},Qe=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.ExplicitlyAdded])},Oe=e=>{var t;return(null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.supressLastMessageUpdate)===s.Zt.Sender},Fe=e=>{var t;return ee(e)&&!(null===(t=e.usersProps)||void 0===t?void 0:t.hasFederatedUser)&&(0,i.every)(e.members,(e=>{var t;return null===(t=e.id)||void 0===t?void 0:t.startsWith(s.rK)}))||!1}},513368:(e,t,r)=>{r.d(t,{Fd:()=>a,s3:()=>d,HC:()=>l,wm:()=>p,LY:()=>c,Bj:()=>u});var n=r(197981);if(740179==r.j)var i=r(759704);var o=r(469929);function a(e,t){try{const r=s(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,n.uniqBy)(t,(e=>e.toLowerCase()))){let t="";const n=e.split(".");for(let e=0;e<n.length;e++)t+=(e>0?"[.]":"")+n[e].replace("*","[^/^.]+");const i=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(r.match(i))return!0}}catch(e){return!1}return!1}const s=e=>new URL(e).href,d=(e,t)=>{let r="";if(!e.id||p(e.id))return r;switch(e.type){case i.p.extensions:try{r=JSON.parse(e.id).threadId}catch(t){r=e.id}break;case i.p.chats:r=e.id.replace("replyChainId","messageid");break;case i.p.communities:case i.p.channels:let n;try{n=JSON.parse(e.id).channelId}catch(t){n=e.id}r=t?`${n};messageid=${t}`:n;break;case i.p.shareformdialog:break;default:r=e.id}return r},l=e=>e&&e.replace(new RegExp(`^${o.at.BotPrefix}`),""),p=e=>"newchat"===e||(null==e?void 0:e.includes("preview")),c=(e,t=o.Cs.Call)=>t===o.Cs.Call&&/<partlist/.test(e)&&!u(e,t),u=(e,t=o.Cs.Call)=>t===o.Cs.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},325276:(e,t,r)=>{r.d(t,{hN:()=>o,jE:()=>s,mo:()=>p,PI:()=>c,Xn:()=>u,BN:()=>f,Np:()=>v,mW:()=>C,Qz:()=>P,zG:()=>g,cE:()=>T,Wg:()=>b,_Y:()=>S,cI:()=>M,t_:()=>I,gC:()=>A});var n=r(469929);if(740179==r.j)var i=r(97600);var o,a,s,d=r(197981);if(740179==r.j)var l=r(381583);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(o||(o={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(a||(a={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(s||(s={}));const p=e=>!!(e&&e.coExistenceMode&&o[e.coExistenceMode]),c=e=>!(e!==o.TeamsOnly),u=e=>!(-1===[o.Islands,o.IslandsWithTempInterop,o.IslandsWithVoipDeepLinking].indexOf(e)),m=e=>!(-1===[o.SfBOnly,o.SfBWithTeamsCollab,o.SfBWithTeamsCollabAndMeetings].indexOf(e)),h=(e,t,r=!1)=>{const i=[n.Jq,n.Dr,n.iO,n.TO,n.pk,n.P_],o=e.split(":");return i.some((e=>{const n=o.findIndex((t=>t===e.slice(0,-1)));return n>=0&&(r?o.splice(n+1,1):o.splice(n+1,0,t.slice(0,-1)),!0)})),o.join(":")},f=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.pW,e)&&e.includes(n.pW),v=e=>!e||f(e)?e:e.includes(n.at.SkypeSpacesUser)?h(e,n.pW):void 0,C=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.m_,e)&&e.includes(n.m_),P=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.U0,e)&&e.includes(`:${n.U0}`),g=e=>!e||P(e)?e:e.includes(n.at.SkypeSpacesUser)?h(e,n.U0):void 0,T=e=>!e||C(e)?e:e.includes(n.at.SkypeSpacesUser)?h(e,n.m_):void 0,b=e=>{if(e){if(f(e))return h(e,n.pW,!0);if(C(e))return h(e,n.m_,!0)}return e},S=e=>e?P(e)?h(e,n.U0,!0):void 0:e,y={isAllowed:!1},M=(e,t,r,n,i,o,a,s)=>{const d=a&&a.coExistenceMode,l=o&&o.coExistenceMode;if(!d||!l)return{isAllowed:!0};if(n){const n=((e,t,r,n,i,o,a)=>{const s=a.newLogger("sfb-interop","services-utilities-sfb-interop");return o.isFederated?!n&&r?(s.log("Chat Disabled: current user is not provisioned on Sfb online"),y):o.coExistenceMode&&i.coExistenceMode?e&&r&&c(i.coExistenceMode)&&c(o.coExistenceMode)?{isAllowed:!1,mri:T(o.mri||"")}:r||t||!u(i.coExistenceMode)&&!u(o.coExistenceMode)?!r&&m(o.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:o.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:o.mri}:(s.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(s.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(o))})(e,t,r,i,o,a,s);if(!n.isAllowed)return n}else{const e=((e,t)=>t.coExistenceMode?e&&c(t.coExistenceMode)?{isAllowed:!1,mri:b(t.mri||"")}:!e&&m(t.coExistenceMode)?{isAllowed:!1,mri:v(t.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(r,a);if(!e.isAllowed)return e}return{isAllowed:!0}},I=e=>{const t=C(e);return U(e)||f(e)||t?t?e.replace(n.m_,""):e.replace(n.pW,"").replace(n.zt,""):e},U=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.zt,e)&&e.includes(n.zt),w=(e,t,r,n)=>{const i=e.isFederated,o=(s=e.mri||"",(0,d.endsWith)(s,"@sfbonprem.unq.gbl.spaces"));var s;if(t&&i&&!o&&e.coExistenceMode){const t=a[e.coExistenceMode],i=r===a.TeamsOnly&&t===a.TeamsOnly;return i||n.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${a[r]} recipientCoexistenceMode:${a[t]}`),i}return n.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${t} isFederated:${i} isOnPremFederated:${o} coExistenceMode:${e.coExistenceMode}`),!1},A=(e,t,r,n,o,d)=>{if(!(e&&e.mri&&e.userType!==l.vf.guest&&e.type!==l.vf.skypeConsumer&&e.type!==l.vf.tflUser&&(0,i.eZ)(e.mri)))return r.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),s.Teams;if(e.isFederated)return r.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),w(e,o,d,r)?s.NativeFederated:s.Federated;const p=((e,t,r)=>{const n=e.coExistenceMode,i=a[n];if(r.log(`getCoexistenceChatMode - caller: ${t}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${a[i]}, MT coExistenceMode: ${n}`),a[i]!==n&&r.error(`getUserChatMode - Mapping error - coExistenceMode : ${a[i]}, MT coExistenceMode: ${n}`),i){const e=[a.SfBOnly,a.SfBWithTeamsCollab,a.SfBWithTeamsCollabAndMeetings],t=[a.TeamsOnly,a.Islands,a.IslandsWithVoipDeepLinking];if(e.includes(i))return s.SfB;if(t.includes(i))return s.Teams;r.warn(`getUserChatMode - unknown coExistenceMode ${a[i]}`)}else e.isShortProfile||r.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,t,r);if(p)return p;const c=f(e.mri),u=e.isSkypeTeamsUser,m=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return r.log(`getUserChatMode - caller: ${t}, mri: ${e.mri}, isSfbMri: ${c}, isTeamsChatEnabled: ${m}, hasLoggedInToTeams: ${u}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${n}`),!c&&u&&m||e.isSipDisabled||!n?s.Teams:s.SfB}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/990306-6d0775251d9492d6.js.map