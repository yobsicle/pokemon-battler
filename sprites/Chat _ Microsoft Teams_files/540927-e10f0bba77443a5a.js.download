"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[540927],{116003:(e,t,r)=>{var n;r.d(t,{m:()=>n}),function(e){e.Chat="Chat",e.Meeting="Meeting",e.Channel="Channel",e.ChannelMeeting="ChannelMeeting",e.PrivateMeetingSchedulingForm="PrivateMeetingSchedulingForm",e.ChannelMeetingSchedulingForm="ChannelMeetingSchedulingForm",e.SingleTeamGridView="SingleTeamGridView",e.MeetingChat="MeetingChat",e.SelectAppEntity="SelectAppEntity"}(n||(n={}))},437194:(e,t,r)=>{r.d(t,{Hb:()=>m,fb:()=>v});var n=r(65903),a=r(469929),i=r(97600);const s="default",l="CallableChannelOboCall",o="callParkService",c=e=>"twoParty"===e?n.BdF.TwoParty:"multiParty"===e?n.BdF.MultiParty:n.BdF.Unknown,d=e=>{switch(e){case"default":return n.FTP.Default;case"screenSharing":case"ScreenSharing":return n.FTP.ScreenSharing;case"emergencyGroupCall":return n.FTP.EmergencyGroupCall;default:return n.FTP.Unknown}},u=e=>e?Object.assign(Object.assign({},e),{type:e.type||s}):void 0,p={__typename:"CallLogParticipant",displayName:"Unknown",id:"28:unknown",type:s},g=(e,t)=>{var r;if(!e)return"";const n='value="',a=null===(r=e.find((e=>e.indexOf(t)>=0)))||void 0===r?void 0:r.match(/value="(.*?)"/g);return a?a[0].substr(n.length,a[0].length-n.length-1):""},f=(e,t,r,n,i)=>{let s,l,o,c,d=(new Date).toISOString();if(i===a.Cs.CallTranscript){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,"")));return{callId:e.callId,userParticipantId:e.originatorParticipantId,transcriptMsg:{scopeId:e.scopeId}}}catch(t){return void e.error("failed to parse transcription content.",t)}})(e,r);if(!t)return;s=t.callId,l=t.userParticipantId,o=t.transcriptMsg}else if(i===a.Cs.CallLogTranscript){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,""))),{CallId:r,UserParticipantId:n,ThreadId:a,MessageId:i}=e;return{callId:r,userParticipantId:n,transcriptMsg:{linkedMessage:{conversationId:a,messageId:i}}}}catch(t){return void e.error("failed to parse transcription content.",t)}})(e,r);if(!t)return;s=t.callId,l=t.userParticipantId,o=t.transcriptMsg}else if(i===a.Cs.CallLogRecording){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,""))),{CallId:r,UserParticipantId:n,ThreadId:a,MessageId:i}=e;return{callId:r,userParticipantId:n,recordingMsg:{linkedMessage:{conversationId:a,messageId:i}}}}catch(t){return void e.error("failed to parse recording message content.",t)}})(e,r);if(!t)return;s=t.callId,l=t.userParticipantId,c=t.recordingMsg}else if(i===a.Cs.CallRecording){const e=((e,t)=>{if(!e)return;const r=e.match(/<.*?>/g),n=g(r,'<Id type="callId"'),i=g(r,'<Id type="OriginatorParticipantId"'),s=g(r,"<RecordingInitiatorId ");return{callId:n,userParticipantId:i,recordingMsg:{conversationId:a.wS,messageId:t||"",initiatorId:s,content:e}}})(r,n);if(!e)return;s=e.callId,l=e.userParticipantId,c=e.recordingMsg}else s=t.callId,l=null==t?void 0:t.userParticipantId,d=t.startTime;return{callId:null!=s?s:"",userParticipantId:l,transcript:o,recordings:c&&[c],startTime:null!=d?d:""}},m=(e,t,r,a,i,l,o)=>{var g;if(O(t,r))return;const m=l.newLogger("CallHistoryHelper","data-resolvers-calling");try{const r=_(t),{callDirection:l,callState:O,callType:b,connectTime:F,endTime:k,isDeleted:R,messageId:N,originatorParticipant:A,participantList:D,sessionType:U,sharedCorrelationId:E,targetParticipant:B,threadId:W,spamProperties:L,callAttributes:H,forwardingInfo:j,transferInfo:J,sharedLineAppearanceParticipantList:$,targetDelegator:G}=r,Q=M(r),V=f(m,r,i,e,a);if(!V)return;let x=u(A);x||(x=p,m.warn(`Could not parse valid participant from ${t}`));const z=(e=>{switch(e){case"missed":return n.Qv1.Missed;case"accepted":return n.Qv1.Accepted;case"declined":return n.Qv1.Declined;case"acceptedElsewhere":return n.Qv1.AcceptedElsewhere;default:return n.Qv1.Unknown}})(O),X=(e=>"incoming"===e?n.kwT.Incoming:"outgoing"===e?n.kwT.Outgoing:n.kwT.Unknown)(l),Y=T(D,null==B?void 0:B.type,null==A?void 0:A.type,null===(g=null==H?void 0:H.transferor)||void 0===g?void 0:g.type,null==J?void 0:J.parkType),K=P(m,r),{validTargetParticipant:q,forwarderParticipant:Z,forwardedTargetParticipant:ee}=h(z,B,j,H,o,!!K.isSharedLineAppearanceActivated,G),{transferorParticipant:te,transferTargetParticipant:re}=y(H,J,Y);return Object.assign(Object.assign(Object.assign(Object.assign({applicationContent:Q&&(v=Q,{type:v.type,configId:v.configId,onBehalfOf:v.onBehalfOf&&Object.assign(Object.assign({},v.onBehalfOf),{type:s}),details:v.details&&Object.assign(Object.assign({},v.details),{type:s})}),callDirection:X,callState:z,callType:c(b),connectTime:F,endTime:k,isDeleted:R,messageId:N,originatorParticipant:x,participantList:D?D.map(u):[],targetParticipant:q,threadId:W,sessionType:d(U),sharedCorrelationId:null!=E?E:"",spamRiskLevel:L?L.riskLevel:null},V),{transferorParticipant:te,transferTargetParticipant:re,transferTime:null==J?void 0:J.transferTime,transferStatus:(null==J?void 0:J.transferStatus)&&I(J.transferStatus),forwarderParticipant:Z,forwardedTargetParticipant:ee,forwardedTargetType:w(null==j?void 0:j.forwardingDestinationType),forwardingType:C(null==j?void 0:j.forwardingType)}),o?S(m,r):K),{sharedLineAppearanceParticipantList:$?$.map(u):[]})}catch(e){m.warn(`UnhandledException in message transformation: ${e}`)}var v},v=e=>{const t={callHistoryInput:void 0,isSlaCallHistory:!1};return e&&(e["sla-call-history"]?(t.callHistoryInput=e["sla-call-history"],t.isSlaCallHistory=!0):e["call-log"]&&(t.callHistoryInput=e["call-log"])),t},h=(e,t,r,a,i,s,l)=>{let o,c,d=t&&u(t);return e===n.Qv1.Accepted&&(null==r?void 0:r.acceptedBy)&&(o=i?l&&u(l):d,d=u(r.acceptedBy)),(null==a?void 0:a.forwardedFrom)&&(o=u(a.forwardedFrom)),(e===n.Qv1.AcceptedElsewhere||i||s)&&(null==r?void 0:r.acceptedBy)&&(c=u(r.acceptedBy)),(null==a?void 0:a.delegator)&&(o=u(a.delegator)),{validTargetParticipant:d,forwarderParticipant:o,forwardedTargetParticipant:c}},y=(e,t,r)=>{let n,a;return r||((null==e?void 0:e.transferor)&&(n=u(e.transferor)),(null==t?void 0:t.transferor)&&(n=u(t.transferor)),(null==t?void 0:t.transferTarget)&&(a=u(t.transferTarget))),{transferorParticipant:n,transferTargetParticipant:a}},I=e=>{switch(e){case"transferred":return n.hyV.Transferred;case"transferAccepted":return n.hyV.TransferAccepted;case"transferFailed":return n.hyV.TransferFailed;case"transferSucceeded":return n.hyV.TransferSucceeded;default:return n.hyV.Unknown}},T=(e,t,r,n,a)=>{const i=a&&"none"!==a&&"Unknown"!==a;return i||i&&!!(null==e?void 0:e.find((e=>e.type&&e.type===o)))||t===o||r===o||n===o},C=e=>{switch(e){case"immediate":return n.Io1.Immediate;case"simultaneous":return n.Io1.Simultaneous;default:return}},w=e=>{switch(e){case"user":return n.Ryo.SingleTarget;case"group":return n.Ryo.Group;case"delegates":return n.Ryo.MyDelegates;case"voicemail":return n.Ryo.Voicemail;default:return}},S=(e,t)=>{const{sharedLineAppearanceForwardType:r,originatorDelegator:n,targetDelegator:a}=t;return e.log("[toCallHistoryItem] This is an SLA Call created as part of Shared History"),{isSharedLineAppearanceCallHistory:!0,forwardingType:C(r),originatorDelegator:n&&u(n),targetDelegator:a&&u(a)}},P=(e,t)=>{var r;const{callAttributes:n,forwardingInfo:a,sharedLineAppearanceActivated:s}=t,l=(null===(r=null==n?void 0:n.onBehalfOf)||void 0===r?void 0:r.id)&&(0,i.lp)(n.onBehalfOf.id);return e.log("[toCallHistoryItem] This is an SLA Call created as part of Personal History"),{isSharedLineAppearanceActivated:!!(s||(null==n?void 0:n.delegator)||l||"delegates"===(null==a?void 0:a.forwardingDestinationType)),originatorDelegator:l&&(null==n?void 0:n.onBehalfOf)?u(n.onBehalfOf):void 0,targetDelegator:(null==n?void 0:n.delegator)?u(n.delegator):void 0}},O=(e,t)=>void 0===t?!e:t!==a.wS,_=e=>e?JSON.parse(e):{},M=e=>{var t,r,n;const{applicationContent:a,callAttributes:i,onBehalfOfContext:s}=e;let o;return o=s&&!a?{type:l,configId:s.id||"",onBehalfOf:{type:(null===(t=null==i?void 0:i.onBehalfOf)||void 0===t?void 0:t.type)||l,id:(null===(r=null==i?void 0:i.onBehalfOf)||void 0===r?void 0:r.id)||"",displayName:(null===(n=null==i?void 0:i.onBehalfOf)||void 0===n?void 0:n.displayName)||""}}:a,o}},258248:(e,t,r)=>{r.d(t,{N:()=>a,n:()=>i});var n=r(65903);const a=e=>{if(e)switch(e){default:case"Success":return n.OQk.Success;case"SendFailure":return n.OQk.SendFailure;case"SendFailureCanRetry":return n.OQk.SendFailureCanRetry;case"EditFailure":return n.OQk.EditFailure;case"EditFailureCanRetry":return n.OQk.EditFailureCanRetry;case"DeleteSingleFailure":return n.OQk.DeleteSingleFailure;case"DeleteSingleFailureCanRetry":return n.OQk.DeleteSingleFailureCanRetry;case"DeleteAllFailure":return n.OQk.DeleteAllFailure;case"DeleteAllFailureCanRetry":return n.OQk.DeleteAllFailureCanRetry}},i=e=>!(!e||!/^\[[^\]]+\]$/gi.test(e))},761734:(e,t,r)=>{r.d(t,{Ew:()=>a,aw:()=>i,Hu:()=>s});var n=r(469929);function a(e){const t=[n.Cs.AddMember,n.Cs.Call,n.Cs.CallRecording,n.Cs.CallTranscript];return!!e&&(t.indexOf(e.messageType)>=0||function(e){return!!e.deleteTime}(e))}function i(e,t){var r;return!!(null===(r=null==e?void 0:e.mentions)||void 0===r?void 0:r.some((e=>e.userId===t)))}const s=(e,t)=>{var r;return(null==e?void 0:e.from)!==t&&!!(null===(r=null==e?void 0:e.mentions)||void 0===r?void 0:r.some((e=>"everyone"===e.mentionType)))}},895961:(e,t,r)=>{r.d(t,{w:()=>s});var n=r(786884),a=r(471285),i=r(197981);const s=e=>{const{scheduledMeetingInfo:t}=e,r=l(t);if(r.length)throw(0,n.Tr)(a.w5.DataLayerClient,a.jK.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${r.join(", ")}`);return e},l=e=>{if(!e)return[];const t="meeting.scheduledMeetingInfo";let r=d(e,["startTime","endTime","eventType"],t);const{eventRecurrenceRange:n,eventRecurrencePattern:a}=e;return r=[...r,...o(n,t),...c(a,t)],r},o=(e,t)=>d(e,["startDate"],`${t}.eventRecurrenceRange`),c=(e,t)=>{let r=[];if(e){const{daily:n,weekly:a,monthly:s,yearly:l,relativeMonthly:o,relativeYearly:c}=e;r=[...d(e,["patternType"],`${t}.eventRecurrencePattern`),...d(n,["interval"],`${t}.eventRecurrencePattern.daily`),...d(a,["interval","daysOfTheWeek"],`${t}.eventRecurrencePattern.weekly`),...d(s,["interval","dayOfMonth"],`${t}.eventRecurrencePattern.monthly`),...d(l,["month","dayOfTheMonth"],`${t}.eventRecurrencePattern.yearly`),...d(o,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeMonthly`),...d(c,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeYearly`)],a&&a.daysOfTheWeek&&a.daysOfTheWeek.some((e=>(0,i.isNil)(e)))&&r.push(`${t}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return r},d=(e,t,r)=>{const n=[];return(0,i.isNil)(e)||t.forEach((t=>{(0,i.isNil)(e[t])&&n.push(`${r}.${t}`)})),n}},379720:(e,t,r)=>{r.d(t,{wU:()=>s,jY:()=>l,gy:()=>o});var n,a,i=r(65903);!function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(n||(n={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(a||(a={}));const s=e=>o(e)===i.Ntc.Important,l=e=>a[e]||a.Standard,o=e=>{switch(e){case a.Important:case n.Important:return i.Ntc.Important;case a.Urgent:case n.Urgent:return i.Ntc.Urgent;case a.Standard:case n.Standard:default:return i.Ntc.Standard}}},310070:(e,t,r)=>{r.d(t,{I:()=>n,s:()=>a});const n=1209600,a=.5},991161:(e,t,r)=>{r.d(t,{xV:()=>s,Hs:()=>l,bf:()=>o,zA:()=>c,BU:()=>d});var n=r(197981),a=r(97600),i=r(469929);const s=e=>{var t;const r=o(e),a=d(e);let i=e.lastMessageTimeUtc;if((0,n.isNil)(i)){const r=null===(t=e.lastMessage)||void 0===t?void 0:t.originalarrivaltime;i=r&&new Date(r).getTime()||0}return i<=r.originalArrivalTime&&0===a.originalArrivalTime},l=(e,t)=>{let r="";e.lastMessage&&((0,a.gs)(e.lastMessage)?r=u(e.lastMessage)||"":e.lastMessage.from&&(r=(0,n.last)(e.lastMessage.from.split("/"))||""));const i=d(e);return s(e)||-1!==r.indexOf(t)&&0===i.originalArrivalTime},o=e=>p(e.properties&&e.properties[i.Ff.ConsumptionHorizon]||i.Mp),c=e=>(null==e?void 0:e.userConsumptionHorizon)||(null==e?void 0:e.consumptionHorizonBookmark)||null,d=e=>p(c(e.properties)||i.Mp),u=e=>{let t="";if((0,a.gs)(e)&&e.content){const r=e.content.match(/<initiator>(.*?)<\/initiator>/i);r&&r[1]&&(t=r[1].trim())}return t};function p(e){const[t,r,a]=function(e){const t=3,r=e.split(";");return r&&r.length===t&&r[0]&&!isNaN(Number(r[0]))&&r[1]&&!isNaN(Number(r[1]))&&r[2]&&!(0,n.isNil)(Number(r[2]))?r:i.Mp.split(";")}(e),s=Number(r)||0;return{originalArrivalTime:Number(t)||0,timeStamp:s,clientMessageId:a}}},622419:(e,t,r)=>{r.d(t,{t:()=>m});var n=r(76672),a=r(469929);const i=/^([^(（]+)[(（]?/;function s(e,t){const r=function(e){var t,r,n;let a="";if(!(null==e?void 0:e.displayName))return a;const s=null!==(t=e.displayName)&&void 0!==t?t:"",l=null!==(r=e.givenName)&&void 0!==r?r:"",o=null!==(n=e.surname)&&void 0!==n?n:"",c=null!==l&&s.startsWith(l),d=null!==o&&s.startsWith(o);if(null!==l&&c&&!d)a=l;else if(d&&!c){const e=i.exec(s);e&&e.length>1&&(a=e[1].trim())}return a=a||s,a||""}(t);return r||(e?e.split(" ")[0]:"")}var l=r(47135),o=r(615465),c=r(97600),d=r(490503),u=r(182302);const p=(e,t,r)=>{const{enableGroupChatInviteFlow:n}=r.get(l.J.Messaging),a=(0,u.rh)(e);return!!n&&!t&&!a},g=(e,t,r,n,a)=>{var i;if(n)return!1;const s=!!(0,c.eX)(e.id);return((e,t,r)=>{const n=(0,d.Bl)(e);return!(!t||!r||n)})(e.id,r,!!(null===(i=e.usersProps)||void 0===i?void 0:i.hasConsumerUser))||((e,t,r,n,a)=>{var i;const s=[];null===(i=e.members)||void 0===i||i.forEach((e=>{const t=n[e.id];t&&s.push(t)}));const l=(0,u.C)(s,a);return(0,c._K)(e.id,t,r,!!l.length||t,s.map((e=>e.id)))})(e,s,r,t,a)||(l=e.id,(0,d.Bl)(l));var l};var f=r(399330);const m=e=>{var t,r,i;const{conversation:c,profilesMap:m,coreSettings:v,i18n:h,loggerFactory:y,currentUserMri:I,currentUserTenantId:T,addSenderName:C=!1}=e,w=!!(0,d.YP)(c),S=(0,n.F)(null!==(r=null===(t=null==c?void 0:c.lastMessage)||void 0===t?void 0:t.from)&&void 0!==r?r:""),P=m[S],O=((e,t,r,n,i,s,c)=>{var d;let u;const{environment:f}=r.get(l.J.Metadata),m=f===o.s.life;switch(null===(d=e.properties)||void 0===d?void 0:d.interopconversationstatus){case a.uI.ExtendedDirectoryAcceptPending:u=n.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:(null==c?void 0:c.displayName)||n.stringTranslate("peoplePicker","unknown_user")});break;case a.uI.AcceptPending:u=p(e.id,i,r)||g(e,t,i,m,s)?n.stringTranslate("messaging","tmp_group_chat_invite_flow_chat_list_preview"):n.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:(null==c?void 0:c.displayName)||n.stringTranslate("peoplePicker","unknown_user")});break;case a.uI.Blocked:u=n.stringTranslate("people","blocked_sfc_chat_preview_message")}return u})(c,m,v,h,w,T,P);if(O)return O;const _=c.lastMessage;if(!_){return(0,d.xb)(c.id)?h.stringTranslate("messaging","chats_messageDraftPreview_default"):""}if(null===(i=_.properties)||void 0===i?void 0:i.deletetime)return h.stringTranslate("messaging","chats_messagePreview_lastMessage_deleted");const M=(0,u.DE)(y,_.messagetype,_.properties);let b=function(e,t,r){var n;const i=(null===(n=e.lastMessage)||void 0===n?void 0:n.content)||"";switch(r){case a.Cs.MediaCard:return t.stringTranslate("messaging","chats_messagePreview_sent_a_card");case a.Cs.CallRecording:return"";case a.Cs.AddMember:return t.stringTranslate("messaging","chats_messagePreview_user_added");case a.Cs.CallTranscript:return t.stringTranslate("messaging","chats_messagePreview_call_transcript");case a.Cs.Collaborate:return""}return/^<img\b[^>]*>$/.test(i)?t.stringTranslate("messaging","chats_messagePreview_sent_an_image"):(s=i,/^<video[^>]*>[^<>]*<\/video>$/.test(s)?t.stringTranslate("messaging","chats_messagePreview_sent_an_inline_video"):i);var s}(c,h,M);if(""===b.trim()&&(b=function(e,t,r){const n=(0,u.jz)(r,e.properties),a=(0,u.le)(r,e.properties);return(null==n?void 0:n.length)?t.stringTranslate("messaging","chats_messagePreview_sent_a_file"):(null==a?void 0:a.some((e=>e.contentType===f.s.Audio)))?t.stringTranslate("messaging","recent_conversations_sent_an_voice_message"):(null==a?void 0:a.some((e=>"bfb101ece45946be988be560a74322f2"===e.cardClientId)))?t.stringTranslate("messaging","recent_conversations_sent_a_location_message"):""}(_,h,y)),!b)return"";if(!C)return b;const F=S===I,k=function(e,t,r,n,i){if(e===a.Cs.Call||e===a.Cs.AddMember||e===a.Cs.CallRecording||e===a.Cs.CallTranscript||i&&!n)return{key:"chats_messagePreview_withoutDisplayName"};if(n)return{key:"chats_messagePreview_fromSelf"};const l=s(t,r);return l?{key:"chats_messagePreview_withDisplayName",displayName:l}:{key:"chats_messagePreview_withoutDisplayName"}}(M,_.imdisplayname,P,F,!!w);return b=h.stringTranslate("messaging",k.key,{message:b,displayName:k.displayName}),b}},660329:(e,t,r)=>{r.d(t,{n:()=>n});const n=(e,t,r)=>{const n=e?parseInt(e,10):null,a=t?new Date(t).getTime():0,i=r?parseInt(r,10):null;return!!(i&&i>=a)||!!n&&!(a&&n<a)}},182302:(e,t,r)=>{r.d(t,{le:()=>c,DE:()=>d,jz:()=>f,rh:()=>m,C:()=>v});var n=r(65903),a=r(297055),i=r(786884),s=r(471285),l=r(197981),o=r(469929);const c=(e,t,r)=>{if(!t||!t.cards||"string"!=typeof t.cards&&!r)return null;try{let e=String(t.cards);r&&(e=r);return JSON.parse(e).map((({appIcon:e,appId:t,appName:r,cardClientId:n,content:a,contentType:i,locale:s,userSpecificContent:l})=>Object.assign({appIcon:e,appId:t||"",appName:r,cardClientId:n,content:JSON.stringify(a),contentType:i,locale:s},!!l&&{userSpecificContent:l})))}catch(t){return e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards."),null}},d=(e,t,r)=>{if(t===o.Cs.HTML){if(((e,t)=>{const r=c(e,t);if(!r)return!1;const n=(0,l.find)(r,(e=>"application/vnd.microsoft.card.fluid"===e.contentType));return!!n&&!!JSON.parse(n.content).componentUrl})(e,r))return o.Cs.Collaborate;if(((e,t)=>{const r=c(e,t);if(!r)return!1;const n=(0,l.find)(r,(e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));return!!n&&!!JSON.parse(n.content).componentUrl})(e,r))return o.Cs.Embed}return t};var u;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(u||(u={}));const p=(e,t)=>{try{const t=JSON.parse(e);if(!t||!t.code)return;const r=(e=>{switch(e){case n.mFJ.BOX:return n.mFJ.BOX;case n.mFJ.DROPBOX:return n.mFJ.DROPBOX;case n.mFJ.EGNYTE:return n.mFJ.EGNYTE;case n.mFJ.GOOGLEDRIVE:return n.mFJ.GOOGLEDRIVE;case n.mFJ.SHAREFILE:return n.mFJ.SHAREFILE;default:throw new Error("Invalid provider code")}})(t.code);return{code:r,type:(e=>{switch(e){case u.Sharepoint:return n.RWp.Sharepoint;case u.WOPI:return n.RWp.WOPI;case u.Google:return n.RWp.Google;case u.OneDrive:return n.RWp.OneDrive;case u.Recent:return n.RWp.Recent;case u.Aggregate:return n.RWp.Aggregate;case u.FileSystem:return n.RWp.FileSystem;case u.Search:return n.RWp.Search;case u.AllFiles:return n.RWp.AllFiles;case u.SharedWithMe:return n.RWp.SharedWithMe;default:throw new Error("Not a valid provider type")}})(parseInt(t.type,10))}}catch(e){return void t.newLogger("Chat Helper","services-io-chat").log(`UnhandledException in message transformation: ${e}`)}},g=(e,t)=>{{const r=2,l=["http","https"],{filePreview:o,chicletBreadcrumbs:c,fileInfo:d,anchorFileId:u,progressComplete:g,isUploadError:f,fileChicletState:m,providerData:v}=e,{shareUrl:h,shareId:y,itemId:I}=d,T=o||{},C=null==m?void 0:m.serviceName,{id:w,baseUrl:S,objectUrl:P,type:O,title:_,state:M}=((e,t)=>{var r;const{version:n}=e;let{id:a,baseUrl:l,objectUrl:o,type:c,title:d,state:u}=e;if(n!==t&&(({itemid:a,fileName:d,fileType:c,fileInfo:{fileUrl:o,siteUrl:l}}=e),u=null===(r=e.fileChicletState)||void 0===r?void 0:r.state),"string"!=typeof a)throw(0,i.Tr)("ChatHelpers",s.jK.Undefined,"toFiles",{id:a,version:n,type:c},"File id is missing");return{id:a,baseUrl:l,objectUrl:o,type:c,title:d,state:u}})(e,r),b="active"!==M&&"hidden"!==M,F=p(v,t);return Object.assign({id:w,itemId:I,chicletBreadcrumbs:c,baseUrl:(0,a.Nm)(S,l),objectUrl:(0,a.Nm)(P,l),shareId:y,shareUrl:h,type:O,title:_,fileId:w,isReferencedFile:b,anchorFileId:u,progressComplete:g&&parseInt(g,10)||null,serviceName:C&&n.a4b[C],state:M&&n.cj1[M],hasUploadFailed:f,providerDataV2:F},T)}},f=(e,t)=>{if(!t||!t.files||"string"!=typeof t.files)return null;try{let r=JSON.parse(t.files);r=r.filter((e=>"deeplink"!==e.type));return(0,l.map)(r,(t=>g(t,e)))}catch(e){return null}},m=e=>!!e&&e.includes(o.IX),v=(e,t)=>e.filter((({tenantId:e,isFederated:r})=>r||t&&e&&e!==t))},30791:(e,t,r)=>{function n(e){const t=e.startsWith("?")||e.startsWith("#");e=t?e.substring(1):e;const r={};return e.split("&").forEach((e=>{const[t,n]=e.split("=");r[t]=decodeURIComponent((n||"").replace(/^.+?(=)/,""))})),r}r.d(t,{d:()=>n})},399330:(e,t,r)=>{var n;r.d(t,{s:()=>n}),function(e){e.Adaptive="application/vnd.microsoft.card.adaptive",e.AnnouncementHeader="application/vnd.microsoft.teams.messaging-announcementBanner",e.Audio="application/vnd.microsoft.card.audio",e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.FileConsent="application/vnd.microsoft.teams.card.file.consent",e.Hero="application/vnd.microsoft.card.hero",e.Keyboard="application.vnd.microsoft.keyboard",e.List="application/vnd.microsoft.teams.card.list",e.O365connector="application/vnd.microsoft.teams.card.o365connector",e.O365connectorAlias="application/vnd.microsoft.card.o365connector",e.Profile="application/vnd.microsoft.teams.card.profile",e.Receipt="application/vnd.microsoft.card.receipt",e.Signin="application/vnd.microsoft.card.signin",e.Thumbnail="application/vnd.microsoft.card.thumbnail"}(n||(n={}))},912825:(e,t,r)=>{function n(e=1){const t=new Uint32Array(e),n=r.g;if(n.msCrypto)n.msCrypto.getRandomValues(t);else if(n.crypto)n.crypto.getRandomValues(t);else{let r=e;for(;r--;){const e=4294967296;t[r]=Math.floor(Math.random()*e)}}return Array.from(t)}r.d(t,{M:()=>n})}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/540927-e10f0bba77443a5a.js.map