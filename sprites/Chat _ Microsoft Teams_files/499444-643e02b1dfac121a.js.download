"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[499444],{497276:(e,t,i)=>{var s;i.d(t,{h:()=>s}),function(e){e.default="default"}(s||(s={}))},31516:(e,t,i)=>{i.d(t,{k:()=>a,H:()=>o});var s=i(47135),n=i(412229),r=i(343324);const a=-1;class o{constructor(){this.FractionalBuckets=1e3,this.ConvertToWholeDeviser=10,this.WholeNumberBuckets=100,this.DefaultCohort=0,this.DefaultSampleRate=100,this.rulesLookup={},this.cohortBoundary=this.DefaultCohort,this.telemetrySettings={},this.deviceId=null,this.userId=null,this.blockZeroSampleRate=!1,this.preAuthUserSamplingId=null,this.updateSamplingSettings=e=>{if(e){this.telemetrySettings=e;let t={};e.samplingRules&&(t=e.samplingRules,this.rulesLookup=t),this.setCohortBoundry(),this.blockZeroSampleRate=e.enableBlockZeroSampleRate}}}initialize(e){e.getObservable(s.J.Telemetry).subscribe(this.updateSamplingSettings),this.telemetrySettings=e.get(s.J.Telemetry),this.updateSamplingSettings(this.telemetrySettings)}static getInstance(){return this.eventSuppressionService||(this.eventSuppressionService=new o),this.eventSuppressionService}setSamplingByUser(e){this.userId||(this.userId=e,this.setCohortBoundry())}setSamplingByPreAuthId(e){this.preAuthUserSamplingId=e,this.setCohortBoundry()}setSamplingByDevice(e){this.deviceId=e,this.setCohortBoundry()}getCurrentCohort(){return this.cohortBoundary}shouldSuppressEvent(e,t="*"){return this.getSampleRate(e,t,"*")===a}getCrossClientScenarioSampleRate(e){if(this.telemetrySettings.enableExpandedCrossClientScenarioDefaultSampling&&e===r.t7.Expanded)return this.DefaultSampleRate}getSampleRate(e,t="*",i="*"){const s=this.rulesLookup[e];if(void 0!==s){const e=void 0!==s[`${t}|${i}`]?s[`${t}|${i}`]:void 0!==s[t]?s[t]:void 0!==s[`*|${i}`]?s[`*|${i}`]:void 0!==s["*"]?s["*"]:this.DefaultSampleRate;if(0===e&&this.blockZeroSampleRate)return a;if(this.cohortBoundary!==this.DefaultCohort)return this.cohortBoundary>e?a:e}return this.DefaultSampleRate}setCohortBoundaryByIdType(e,t){return t&&t>a&&t<=this.DefaultSampleRate?void(this.cohortBoundary=t):e}setCohortBoundry(){if(this.cohortBoundary!==this.DefaultCohort)return;let e=null;const t=this.telemetrySettings;!this.userId&&t.enablePreAuthIdSampling?e=this.preAuthUserSamplingId:t.enableDeviceIdSampling?e=this.setCohortBoundaryByIdType(this.deviceId,this.telemetrySettings.deviceIdSampleCohort):t.enableUserIdSamplingV2&&(e=this.setCohortBoundaryByIdType(this.userId,this.telemetrySettings.userIdSampleCohort)),t.enablePreAuthIdSampling||t.enableDeviceIdSampling||t.enableUserIdSamplingV2?e&&(this.cohortBoundary=((0,n.E)(e)%this.FractionalBuckets+1)/this.ConvertToWholeDeviser):this.userId&&(this.cohortBoundary=(0,n.E)(this.userId)%this.WholeNumberBuckets+1)}}},187203:(e,t,i)=>{i.d(t,{G:()=>T});var s,n=i(361366),r=i(574487),a=i(871543),o=i(497276),l=i(343324);!function(e){e.Desktop="Desktop",e.Messaging="Messaging",e.Files="Files",e.Apps="Apps",e.Activity="Activity",e.Feeds="Feeds",e.Teams="Teams",e.CMD="CMD",e.Notifications="Notifications",e.Foundation="Foundation"}(s||(s={}));const d=new Map;d.set(l.RG.WindowLaunchTime,{featureArea:s.Foundation,customDimensions:["App"]});var h=i(47135),u=i(786918),c=i(27994),_=i(31516);class p{constructor(){this.propagators={}}addCallback(e,t){const i=this.propagators[e];this.propagators[e]=i?Object.assign(Object.assign({},i),{callbacks:[...i.callbacks,t]}):{filters:void 0,usingCache:!1,cache:{},callbacks:[t]};const s=this.propagators[e];if(s){const{cache:e,usingCache:i}=s;i&&Object.keys(e).forEach((i=>{const s=e[i];s&&t(i,s[0],s[1])}))}}updateFilter(e,t,i=!1){const s=this.propagators[e];s?(s.filters=t,s.usingCache=i):this.propagators[e]={filters:t,usingCache:i,cache:{},callbacks:[]}}send(e,t,i){Object.keys(this.propagators).forEach((s=>{var n,r;const a=this.propagators[s];if(a){const o=a.filters;o?o.has(e)&&(a.usingCache&&(a.cache[e]=[t,i]),null===(n=this.propagators[s])||void 0===n||n.callbacks.forEach((s=>s(e,t,i)))):null===(r=this.propagators[s])||void 0===r||r.callbacks.forEach((s=>s(e,t,i)))}}))}}class C{constructor(e,t){this.router=e,this.coreSettings=t,this.categorySubscriptions=new Map}init(){this.channel=new MessageChannel,this.router.postMessage("initCoreSettingsWorker",void 0,[this.channel.port2]),this.registerListeners()}registerListeners(){this.channel&&(this.channel.port1.onmessage=e=>{const{data:t}=e;"settingsRequest"===t.type&&this.handleSettings(t.payload),"subscribeCategory"===t.type&&this.handleSubscription(t.payload),"unsubscribeCategory"===t.type&&this.handleUnsubscription(t.payload)})}handleSubscription({category:e}){if(this.categorySubscriptions.has(e))return;const t=this.coreSettings.getObservable(e).subscribe((t=>{var i;null===(i=this.channel)||void 0===i||i.port1.postMessage({type:"categorySubscriptionResponse",payload:{values:t,category:e}})}));this.categorySubscriptions.set(e,t)}handleUnsubscription({category:e}){const t=this.categorySubscriptions.get(e);t&&(t.unsubscribe(),this.categorySubscriptions.delete(e))}handleSettings({category:e,settings:t,id:i}){var s;const n=this.coreSettings.get(e),r={};null==t||t.forEach((e=>{r[e]=n[e]})),null===(s=this.channel)||void 0===s||s.port1.postMessage({type:"settingsResponse",payload:{values:r,id:i}})}}const g="default";class S{constructor(){this._contextPropagator=new p,this._sessionId="",this._silent=!1,this._sharedWorkerOptions={delayLoadingWorker:!1,isSharedWorkerEnabled:!1,isWorkerEnabled:!1},this._cachedOperation=[],this._workerInited=!1,this._capturingEventsForDiagnosticPanel=!1,this._capturingContextForDiagnosticPanel=!1,this._capturedEvents={},this._capturedContext={},this._primaryUserId="",this._primaryTenantId="",this._users=new Set,this.defaultLoggerName=o.h.default,(0,c.Y)((()=>{this._cachedOperation=[],this._sharedWorkerOptions.sharedWorkerUrl=void 0}))}getUsers(){return this._users}getPrimaryUserId(){return this._primaryUserId}getPrimaryTenantId(){return this._primaryTenantId}get sessionId(){return this._sessionId}startCapturingEventsAndContext(){this._capturingContextForDiagnosticPanel=!0,this._capturingEventsForDiagnosticPanel=!0}stopCapturingEventsAndContext(){this._capturingContextForDiagnosticPanel=!1,this._capturingEventsForDiagnosticPanel=!1}get capturedContext(){return this._capturedContext}get capturedEvents(){return this._capturedEvents}clearCapturedEvents(){this._capturedEvents={[g]:[]}}setCdlContextCallback(e){this._contextPropagator.addCallback("cdl",((t,i,s)=>{var n;e(t,null!==(n=null==i?void 0:i.toString())&&void 0!==n?n:"",s)}))}setMultiContextCallback(e){this._contextPropagator.addCallback("maglev",((t,i,s)=>{var n;e(t,null!==(n=null==i?void 0:i.toString())&&void 0!==n?n:"",s)}))}setEndpointHealth(e){this._getEndpointHealth=e}getEndpointHealth(e,t){var i;return this._getEndpointHealth?null===(i=this._getEndpointHealth(e,t))||void 0===i?void 0:i.isHealthy:void 0}setupReinitSubscriptions(e){var t;if(!this._initializeParams||!e.enableTelemetryRegionReinit)return;let i=!1;e.oneDsCollectorUrl&&this._initializeParams.oneDsCollectorUrl!==e.oneDsCollectorUrl&&(this._initializeParams.oneDsCollectorUrl=e.oneDsCollectorUrl,i=!0),e.telemetryServer&&this._initializeParams.config.collectorUrl!==e.telemetryServer&&(this._initializeParams.config.collectorUrl=e.telemetryServer,i=!0),void 0!==e.enableOneDsSdkNs&&this._initializeParams.enableOneDsSdkNs.toString()!==(null===(t=e.enableOneDsSdkNs)||void 0===t?void 0:t.toString())&&(this._initializeParams.enableOneDsSdkNs=e.enableOneDsSdkNs||!1,i=!0),e.defaultToken&&this._initializeParams.appTokens.default!==e.defaultToken&&(this._initializeParams.appTokens.default=e.defaultToken,i=!0),i&&(this._sendOrCacheOperation("flushForReinit",this._initializeParams),this.logReinitEvent()),void 0!==e.telemetryRegionFetchComplete&&null!==e.telemetryRegionFetchComplete&&this.setContext("telemetryRegionFetchComplete",e.telemetryRegionFetchComplete),e.telemetryRegion&&this.setContext("UserInfo.TelemetryRegion",e.telemetryRegion)}initialize(e,t,i,s,a){var o,l,d,u,c;const{createTelemetryWorkerFn:p}=e,g=(0,n.__rest)(e,["createTelemetryWorkerFn"]);this._initializeParams=g,this._initializeParams.defaultLoggerName=this.defaultLoggerName,this._silent=g.isSilent,this._sharedWorkerOptions.delayLoadingWorker=null!==(o=g.delayLoadingWorker)&&void 0!==o&&o,this._sharedWorkerOptions.isSharedWorkerEnabled=null!==(l=g.enableSharedWorker)&&void 0!==l&&l,this._capturingEventsForDiagnosticPanel=null===(d=g.debugMenuSettings)||void 0===d?void 0:d.debugMenuCaptureEvents,this._capturingContextForDiagnosticPanel=null===(u=g.debugMenuSettings)||void 0===u?void 0:u.debugMenuCaptureContext,t&&(this._consoleLogger=t,g.config.log=void 0,g.enableDebugTrace=!0);const{workerType:S,workerUrlCallback:T}=s;this.columnSuppressionService=a,this._router=p(S,T),this._setupWorker(this._router),this._sendOrCacheOperation("newLogger",{key:this.defaultLoggerName,value:g.appTokens.default}),this._sendOrCacheOperation("logSession",{name:this.defaultLoggerName,state:r.sM.STARTED,sessionId:g.sessionId,sessionStartTime:g.sessionStartTime}),this._sendOrCacheOperation("sessionId",g.sessionId),this._router.postMessage("initialize",g);const I=i.get(h.J.Telemetry),m=new Set(null!==(c=I.multiContextColumns)&&void 0!==c?c:[]),E=new Set(I.cdlMultiContextColumns);this._contextPropagator.updateFilter("maglev",m),this._contextPropagator.updateFilter("cdl",E,!0),g.documentInfo.deviceId&&_.H.getInstance().setSamplingByDevice(g.documentInfo.deviceId);if(i.getObservable(h.J.Telemetry).subscribe((e=>{this._updateSDKwithPrivacyGuard(e),this._updateSecondPartyTelemetryFlag(e),this.setupReinitSubscriptions(e)})),this.setContext("Session.TelemetryWorkerType",S),"shared"===S||"dedicated"===S){new C(this._router,i).init()}}createEvent(e,t,i,s,n,a){var o;const l=new r.kc;return l.name=e,l.eventType=t,l.timestamp=Date.now(),l.setProperty("EventInfo.BaseType",t),i&&(this._copyEventProperties(l,i,s),null===(o=this.columnSuppressionService)||void 0===o||o.applyColumnBlockingRules(e,null!=a?a:t,l,n),n&&l.setProperty(n.columnName,(0,u.XC)(n.packedData))),a&&l.setProperty("EventInfo.Identifier",a),l}flush(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._silent?new Promise(((e,t)=>{t()})):new Promise(((e,t)=>{this._router?(this._router.registerMessageHandler("flushed",(()=>{this._router&&this._router.unregisterMessageHandler("flushed"),e()})),this._router.postMessage("flush")):t()}))}))}logEvent(e,t,i=""){this._silent||(this._sendOrCacheOperation("logEvent",{key:e,value:t,userContextId:i}),this._addCapturedEvent(t,i))}initializeSecondPartyLogger(e,t,i=!1){this.enableSecondPartyTelemetry&&this._sendOrCacheOperation("newSecondPartyOneDsLogger",{key:e,value:{ingestionToken:t,useTeamsContext:i}})}logSecondPartyEvent(e,t){this.enableSecondPartyTelemetry&&!this._silent&&this._sendOrCacheOperation("logSecondPartyEvent",{key:e,value:t})}initializeLogger(e,t){this._sendOrCacheOperation("newLogger",{key:e,value:t})}logOutUser(e){e&&(this._sendOrCacheOperation("logOutUser",{userContextId:e}),this._users.delete(e))}setPrimaryUser(e,t){e&&(this._primaryUserId=e,this._primaryTenantId=t,this._users.has(e)||this._users.add(e),this._sendOrCacheOperation("setPrimaryUser",{userContextId:e,userTenantId:t}))}setContext(e,t,i,s){var n;if("UserInfo.Id"===e&&"string"==typeof t&&(_.H.getInstance().setSamplingByUser(t),t&&!this._users.has(t)&&this._users.add(t)),!(null===(n=this.columnSuppressionService)||void 0===n?void 0:n.isContextColumnOk(e)))return;const r=(0,u.XC)(null!=t?t:"");this._sendOrCacheOperation("setContext",{key:e,value:r,pii:i,userContextId:s}),this._addCapturedContext(e,r,s),this._contextPropagator.send(e,t,s)}setPrivacyGuardUserInfo(e,t){this._sendOrCacheOperation("setPrivacyGuardUserInfo",{userNames:e,upns:t})}setDeviceAuthToken(e){this._sendOrCacheOperation("setDeviceAuthToken",e)}start(){this._silent||this._sendOrCacheOperation("start")}stop(){this._silent||this._sendOrCacheOperation("stop")}sendPulsarSignal(e){this._sendOrCacheOperation("pulsarSignal",e)}registerPulsarBackchannelListener(e){var t;null===(t=this._router)||void 0===t||t.registerMessageHandler("pulsarSignal",e)}Verbose(e){this._consoleLogger&&this._consoleLogger.debug(e)}Error(e){this._consoleLogger&&this._consoleLogger.error(e)}Info(e){this._consoleLogger&&this._consoleLogger.debug(e)}_addCapturedEvent(e,t){const i=5e3;this._capturingEventsForDiagnosticPanel&&(t&&!this._capturedEvents[t]?this._capturedEvents[t]=[]:t||this._capturedEvents.default||(this._capturedEvents.default=[]),this._capturedEvents[t||g].unshift(e),this._capturedEvents[t||g].length>=i&&(this._capturedEvents[t||g].length=i-Math.floor(500)))}_addCapturedContext(e,t,i){this._capturingContextForDiagnosticPanel&&e&&(i&&!this._capturedContext[i]?this._capturedContext[i]={}:i||this._capturedContext.default||(this._capturedContext.default={}),this._capturedContext[i||g][e]=t)}_setupWorker(e){return e.registerMessageHandler("sessionId",(e=>{this._sessionId=null==e?void 0:e.value})),e.registerMessageHandler("batchDone",(()=>{this._workerInited=!0})),e.registerMessageHandler("workerInitialized",(()=>{this._cachedOperation.length>0&&this._router&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[])})),e.registerMessageHandler("error",(e=>{this.Error(e)})),e.registerMessageHandler("info",(e=>{this.Info(e)})),e.registerMessageHandler("verbose",(e=>{this.Verbose(e)})),e}logReinitEvent(){const e="loggingns",t="instrumentation_reinit",i="info",s=_.H.getInstance().getSampleRate(e,t,i);if(s===_.k)return;const n=this.createEvent(e,t,{message:"Triggering logger reinit",sampleRate:s,"EventInfo.Identifier":t,logLevel:i});this.logEvent(o.h.default,n)}static getInstance(){return this.telemetryProviderInstance||(this.telemetryProviderInstance=new S),this.telemetryProviderInstance}_sendOrCacheOperation(e,t){this._workerInited&&this._router?(this._cachedOperation.length>0&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[]),this._router.postMessage(e,t)):this._cachedOperation.push({name:e,params:t})}_copyEventProperties(e,t,i){let s=null;for(const i in t)t.hasOwnProperty(i)&&(s=t[i],null!=s&&""!==s&&("object"==typeof s&&Object.prototype.hasOwnProperty.call(s,"piiKind")&&Object.prototype.hasOwnProperty.call(s,"value")&&s.piiKind in a.A4?e.setProperty(i,(0,u.XC)(s.value),s.piiKind):e.setProperty(i,(0,u.XC)(s))));if(i){const t=d.get(e.eventType);t&&this._copyMonitoringData(e,t,i)}}_copyMonitoringData(e,t,i){const s=[void 0,void 0,void 0],n=t.customDimensions.length;e.setProperty("Scenario.Priority",i.scenarioPriority),i.scenarioErrorCode&&e.setProperty("Scenario.ErrorCode",i.scenarioErrorCode),i.data.forEach((i=>{i.value&&e.setProperty(this._createMonitoringKey(t.featureArea,i.key),i.value);const n=t.customDimensions.findIndex((e=>e===i.key));n>0&&n<3&&(s[n]=i.value)}));let r="";for(let e=0;e<n;e++){const t=void 0===s[e]?"":s[e];r=e===n-1?`${r}${t}`:`${r}${t},`}e.setProperty("CombinedMonitoringDimensions",r)}_createMonitoringKey(e,t){return`QoS.${e}_${t}`}_updateSecondPartyTelemetryFlag(e){this.enableSecondPartyTelemetry=Boolean(e.enableSecondPartyTelemetry)}_updateSDKwithPrivacyGuard(e){var t,i;if(e&&(null===(t=this._initializeParams)||void 0===t?void 0:t.enableOneDsSdkNs)){const t=!!e.enablePrivacyGuard;t!==(null===(i=this._initializeParams)||void 0===i?void 0:i.enablePrivacyGuard)&&(this._initializeParams.enablePrivacyGuard=t,this._sendOrCacheOperation("updateSDKWithPrivacyGuard",t))}}}const T=()=>S.getInstance()},488190:(e,t,i)=>{var s,n;i.d(t,{V:()=>s}),function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(s||(s={})),function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(n||(n={}))},624965:(e,t,i)=>{i.d(t,{D:()=>s});class s{constructor(){this._buffer=[]}Add(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})}AddOrReplace(e,t){var i=this._getIndex(e);i>=0?this._buffer[i]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})}Remove(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)}Count(){return this._buffer.length}GetBuffer(){return this._buffer}ContainsKey(e){return this._getIndex(e)>=0}Get(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null}_getIndex(e){for(var t=0,i=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){i=t;break}return i}}},709148:(e,t,i)=>{i.d(t,{ni:()=>r,zM:()=>a,Mr:()=>o,Pp:()=>l,KS:()=>d,rH:()=>h});var s=i(488190),n=i(896147);class r{constructor(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}Equals(e){var t=new r(e);return this.low==t.low&&this.high==t.high}}class a{constructor(e){this.low=0,this.high=0,this.low=parseInt(e)}Equals(e){var t=new a(e);return this.low==t.low&&this.high==t.high}}class o{static ToByte(e){return this.ToUInt8(e)}static ToInt8(e){return 127&e|(128&e)<<24>>24}static ToInt16(e){return 32767&e|(32768&e)<<16>>16}static ToInt32(e){return 2147483647&e|2147483648&e}static ToUInt8(e){return 255&e}static ToUInt16(e){return 65535&e}static ToUInt32(e){return 4294967295&e}}class l{constructor(e){this.Message=e}}class d{static IsDataViewSupport(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView}}class h{constructor(e){this._stream=e}WriteBlob(e){this._stream.Write(e,0,e.length)}WriteBool(e){this._stream.WriteByte(e?1:0)}WriteContainerBegin(e,t){this.WriteUInt8(t),this.WriteUInt32(e)}WriteMapContainerBegin(e,t,i){this.WriteUInt8(t),this.WriteUInt8(i),this.WriteUInt32(e)}WriteContainerEnd(){}WriteDouble(e){var t=n.bh.GetBytes(e);this._stream.Write(t,0,t.length)}WriteFloat(e){var t=n.bv.GetBytes(e);this._stream.Write(t,0,t.length)}WriteFieldBegin(e,t,i){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))}WriteFieldEnd(){}WriteFieldOmitted(e,t,i){}WriteInt16(e){e=n.if.EncodeZigzag16(e),this.WriteUInt16(e)}WriteInt32(e){e=n.if.EncodeZigzag32(e),this.WriteUInt32(e)}WriteInt64(e){this.WriteUInt64(n.if.EncodeZigzag64(e))}WriteInt8(e){this._stream.WriteByte(o.ToInt8(e))}WriteString(e){if(""==e)this.WriteUInt32(0);else{var t=n.di.GetBytes(e);this.WriteUInt32(t.length),this._stream.Write(t,0,t.length)}}WriteStructBegin(e,t){}WriteStructEnd(e){this.WriteUInt8(e?s.V.BT_STOP_BASE:s.V.BT_STOP)}WriteUInt16(e){var t=n.Km.GetBytes(o.ToUInt16(e));this._stream.Write(t,0,t.length)}WriteUInt32(e){var t=n.Km.GetBytes(o.ToUInt32(e));this._stream.Write(t,0,t.length)}WriteUInt64(e){var t=n.Ms.GetBytes(e);this._stream.Write(t,0,t.length)}WriteUInt8(e){this._stream.WriteByte(o.ToUInt8(e))}WriteWString(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var i=e.charCodeAt(t);this._stream.WriteByte(i),this._stream.WriteByte(i>>>8)}}}},871543:(e,t,i)=>{i.d(t,{P6:()=>d,A4:()=>r,WV:()=>u,Pm:()=>c,$L:()=>_});var s,n,r,a=i(709148),o=i(488190),l=i(624965);class d{static GetGuid(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")}static GetTimeStamp(){var e=(new Date).getTime(),t=new a.ni("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t}static GetTimeStampWithValue(e){var t=new a.ni("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t}}!function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(s||(s={})),function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"}(n||(n={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy",e[e.FilePath=14]="FilePath"}(r||(r={}));class h{constructor(){this.ScrubType=n.NotSet,this.Kind=r.NotSet,this.RawContent=""}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){e.WriteStructBegin(null,t),this.ScrubType!=n.NotSet?(e.WriteFieldBegin(o.V.BT_INT32,1,null),e.WriteInt32(this.ScrubType),e.WriteFieldEnd()):e.WriteFieldOmitted(o.V.BT_INT32,1,null),this.Kind!=r.NotSet?(e.WriteFieldBegin(o.V.BT_INT32,2,null),e.WriteInt32(this.Kind),e.WriteFieldEnd()):e.WriteFieldOmitted(o.V.BT_INT32,2,null),""!=this.RawContent?(e.WriteFieldBegin(o.V.BT_STRING,3,null),e.WriteString(this.RawContent),e.WriteFieldEnd()):e.WriteFieldOmitted(o.V.BT_STRING,3,null),e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class u{constructor(){this.Id=d.GetGuid(),this.Timestamp=d.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new l.D,this.RecordType=s.NotSet,this.PIIExtensions=new l.D}AddOrReplacePII(e,t,i){var s=new h;s.RawContent=t,s.Kind=i,s.ScrubType=n.O365,this.PIIExtensions.AddOrReplace(e,s)}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),""!=this.Id?(e.WriteFieldBegin(o.V.BT_STRING,1,null),e.WriteString(this.Id),e.WriteFieldEnd()):e.WriteFieldOmitted(o.V.BT_STRING,1,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(o.V.BT_INT64,3,null):(e.WriteFieldBegin(o.V.BT_INT64,3,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),""!=this.Type?(e.WriteFieldBegin(o.V.BT_STRING,5,null),e.WriteString(this.Type),e.WriteFieldEnd()):e.WriteFieldOmitted(o.V.BT_STRING,5,null),""!=this.EventType?(e.WriteFieldBegin(o.V.BT_STRING,6,null),e.WriteString(this.EventType),e.WriteFieldEnd()):e.WriteFieldOmitted(o.V.BT_STRING,6,null),this.Extension.Count()){e.WriteFieldBegin(o.V.BT_MAP,13,null),e.WriteMapContainerBegin(this.Extension.Count(),o.V.BT_STRING,o.V.BT_STRING);for(var i=0;i<this.Extension.GetBuffer().length;++i)e.WriteString(this.Extension.GetBuffer()[i].Key),e.WriteString(this.Extension.GetBuffer()[i].Value);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(o.V.BT_MAP,13,null);if(this.RecordType!=s.NotSet?(e.WriteFieldBegin(o.V.BT_INT32,24,null),e.WriteInt32(this.RecordType),e.WriteFieldEnd()):e.WriteFieldOmitted(o.V.BT_INT32,24,null),this.PIIExtensions.Count()){e.WriteFieldBegin(o.V.BT_MAP,30,null),e.WriteMapContainerBegin(this.PIIExtensions.Count(),o.V.BT_STRING,o.V.BT_STRUCT);for(var n=0;n<this.PIIExtensions.GetBuffer().length;++n)e.WriteString(this.PIIExtensions.GetBuffer()[n].Key),this.PIIExtensions.GetBuffer()[n].Value.WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(o.V.BT_MAP,30,null);e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class c{constructor(){this.Source="",this.DataPackageId="",this.Timestamp=new a.ni("0"),this.Records=[]}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(o.V.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(o.V.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(o.V.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(o.V.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(o.V.BT_INT64,6,null):(e.WriteFieldBegin(o.V.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(o.V.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,o.V.BT_STRUCT);for(var i=0;i<this.Records.length;++i)this.Records[i].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(o.V.BT_LIST,8,null);e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class _{constructor(){this.DataPackages=[],this.RequestRetryCount=0}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(o.V.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,o.V.BT_STRUCT);for(var i=0;i<this.DataPackages.length;++i)this.DataPackages[i].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(o.V.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(o.V.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(o.V.BT_INT32,2,null),e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}},807109:(e,t,i)=>{i.d(t,{Mk:()=>T,sE:()=>I});var s=i(871543);class n{static IsSafariOrFirefox(){return null===n._isSafariOrFirefox&&n._DetectBrowser(),n._isSafariOrFirefox}static ajax(e){var t=n._createConnection();if(e.headers){var i="qsp=true";for(var s in e.headers)i+="&",i+=encodeURIComponent(s),i+="=",i+=encodeURIComponent(e.headers[s]);e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=i}t.open(e.type,e.url),e.complete&&(t.onload=()=>{void 0===t.status&&(t.status=200),e.complete(t)},t.ontimeout=()=>{void 0===t.status&&(t.status=500),e.complete(t)},t.onerror=()=>{e.complete(t)}),t.send(e.data)}static keys(e){if(Object.keys)return Object.keys(e);var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t}static IsUsingXDomainRequest(){null==n._usingXDomainRequest&&(void 0===(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?n._usingXDomainRequest=!0:n._usingXDomainRequest=!1);return n._usingXDomainRequest}static _createConnection(){var e=new XMLHttpRequest;return n.IsUsingXDomainRequest()?new XDomainRequest:e}static _DetectBrowser(){var e=navigator.userAgent.toLowerCase();(e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0?n._isSafariOrFirefox=!0:n._isSafariOrFirefox=!1}}n._isSafariOrFirefox=null,n._usingXDomainRequest=null;var r,a,o,l=i(896147),d=i(709148);class h{constructor(){this._buffer=[]}WriteByte(e){this._buffer.push(d.Mr.ToByte(e))}Write(e,t,i){for(;i--;)this.WriteByte(e[t++])}GetBuffer(){return this._buffer}}class u{constructor(){this.data=[]}WriteBlob(e){let t={type:"blob",value:e};this.data.push(t)}WriteBool(e){let t={type:"boolean",value:e};this.data.push(t)}WriteContainerBegin(e,t){let i={type:"containerBegin",size:e,elementType:t};this.data.push(i)}WriteMapContainerBegin(e,t,i){let s={type:"mapContainerBegin",size:e,keyType:t,valueType:i};this.data.push(s)}WriteContainerEnd(){this.data.push({type:"containerEnd"})}WriteDouble(e){let t={type:"number",value:e};this.data.push(t)}WriteFloat(e){let t={type:"number",value:e};this.data.push(t)}WriteFieldBegin(e,t,i){let s={type:"fieldBegin",id:t};this.data.push(s)}WriteFieldEnd(){this.data.push({type:"fieldEnd"})}WriteFieldOmitted(e,t,i){let s={type:"fieldOmitted",id:t};this.data.push(s)}WriteInt16(e){let t={type:"number",value:e};this.data.push(t)}WriteInt32(e){let t={type:"number",value:e};this.data.push(t)}WriteInt64(e){let t={type:"number",value:4294967296*e.high+e.low};this.data.push(t)}WriteInt8(e){let t={type:"number",value:e};this.data.push(t)}WriteString(e){let t={type:"string",value:e};this.data.push(t)}WriteStructBegin(e,t){let i={type:"structBegin",isBase:t};this.data.push(i)}WriteStructEnd(e){let t={type:"structEnd",isBase:e};this.data.push(t)}WriteUInt16(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt32(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt64(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt8(e){let t={type:"number",value:e};this.data.push(t)}WriteWString(e){let t={type:"string",value:e};this.data.push(t)}}!function(e){e[e.ECS_ERROR_OK=0]="ECS_ERROR_OK",e[e.ECS_ERROR_INVALID_STATUS=1]="ECS_ERROR_INVALID_STATUS",e[e.ECS_ERROR_INVALID_RESPONSE=6]="ECS_ERROR_INVALID_RESPONSE",e[e.ECS_ERROR_INVALID_CONFIG=8]="ECS_ERROR_INVALID_CONFIG"}(r||(r={}));!function(e){e[e.CONFIG_UPDATED=0]="CONFIG_UPDATED",e[e.TOKEN_IS_INVALID=1]="TOKEN_IS_INVALID"}(a||(a={}));class c{}c.Servers=["https://config.teams.microsoft.com/config/v1/Skype/"],c.RefreshIntervalInMS=36e5,c.FailedRetryFactorInMS=1e4,c.MaxRetryIntervalForFailedInMS=36e5,function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started",e[e.Loading=3]="Loading"}(o||(o={}));var _,p,C,g=i(174415);!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"}(_||(_={})),function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(p||(p={}));class S{constructor(e){this._errorCode=p.DATARV_ERROR_OK,this._errorCode=e}ErrorCode(){return this._errorCode}toString(){switch(this._errorCode){case p.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case p.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case p.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case p.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case p.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case p.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}}}class T{constructor(){this.eventsLimitInMem=1e4}}class I{static CreateTelemetryManager(){return new E}}class m{}m.MaxPackageSizeInBytes=3e6,m.TimeIntervalForNextSendInMS=15e3,function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"}(C||(C={}));class E{constructor(){this._MaxPackageSizeInBytes=m.MaxPackageSizeInBytes,this._listeners=[],this._status=C.Created,this._ecsClient=null,this._etag=null,this._ecsCallback=null,this._testServerResponseHook=null,this._testHookListeners=[]}Initialize(e){if(this._status!=C.Created)throw new S(p.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new S(p.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=C.Initialized,e.ecsClient&&(this._Verbose("ECS object assigned. Do integration"),this._ecsClient=e.ecsClient),e.overwriteSendTimeInterval&&e.overwriteSendTimeInterval>=0&&(m.TimeIntervalForNextSendInMS=e.overwriteSendTimeInterval),this._Verbose("Initialize() done")}setEventsLimitInMem(e){this._eventsCache.setEventsLimitInMem(e)}AddListener(e){if(this._status<C.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)}RemoveListener(e){if(this._status<C.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)}Start(){if(this._status<C.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",E._tag].join(" ")),this._status>=C.Started&&this._Verbose("Start() already, ignore"),this._ecsClient&&(this._ecsCallback=this._CreateEcsCallback(),this._ecsClient.AddListener(this._ecsCallback),this._etag=this._ecsClient.GetETag()),++E._tag,this._status=C.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",E._tag].join(""))}Stop(){if(this._status<C.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);this._Verbose("Stop(), status: "+this._status),this._status!=C.Initialized?(this._Reset(),this._status=C.Initialized,this._Verbose("Stop() done, status: "+this._status)):this._Verbose("Stop() already, ignore")}Flush(e){this._eventsCache.IsEmpty()||this._WorkThread(e)}SendAsync(e,t){var i;if(this._status<C.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",t.length].join(" ")),this._status<C.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!t)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new S(p.DATARV_ERROR_INVALID_ARG);for(var s=0;s<t.length;++s)if(!t[s].Id||!E._eventTypeRegex.test(t[s].EventType)||t[s].Timestamp.Equals("0"))throw this._Error(["eventId:",t[s].Id,"eventType:",t[s].EventType,"timestamp high:",t[s].Timestamp.high,"timestamp low:",t[s].Timestamp.low].join("")),new S(p.DATARV_ERROR_INVALID_EVENT);return null===(i=this._eventsCache)||void 0===i||i.AddEvents(e,t),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0}_WorkThread(e){var t;try{var i=Date.now();if(this._Verbose("_WorkThread, status: "+this._status),this._status<C.Started)return void this._Verbose("_WorkThread, status is not started, return");var s=this._eventsCache.DequeuEvents();if(null==s)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var r=s.events.length,a=this._PackEvents(s.tenantToken,s.events);null===(t=this._eventsCache)||void 0===t||t.AddEvents(s.tenantToken,a.remainedEvents);var o=a.remainedEvents.length;if(null==a.buffer||0==a.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testHookListeners)for(var d=0;d<this._testHookListeners.length;++d)this._testHookListeners[d](a.sendEvents);if(this._testServerResponseHook){var h=this._testServerResponseHook();return void setTimeout((()=>this._SendCallback(c,s.tenantToken,a.sendEvents,h,null)),100)}var u={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+g.w.version},complete:t=>this._SendCallback(c,s.tenantToken,a.sendEvents,t,e)};this._config.useJsonTextStream?(u.data=a.buffer,u.headers["content-type"]="application/json"):n.IsSafariOrFirefox()||"undefined"==typeof Uint8Array?(this._Verbose("Uint8Array is undefined, send with base64 encode."),u.data=l.DS.GetString(a.buffer),u.headers["content-encoding"]="base64"):(this._Verbose("Uint8Array is defined, send with binary format directly."),u.data=new Uint8Array(a.buffer)),s.tenantToken&&(u.headers["x-apikey"]=s.tenantToken);var c=E._tag;this._lastActiveTime=(new Date).getTime(),n.ajax(u),this._Verbose("_Workthread, send via jquery, tag: "+c),this._Info("Processing telemetry events took "+(Date.now()-i)+" ms for "+(r-o)+" events with total size of "+a.buffer.length+" bytes, remaining events - "+o)}catch(e){this._Error("_WorkThread, exception: "+e)}}_PackEvents(e,t){this._Verbose("_PackageEvents, total Count: "+t.length);var i,n=new s.$L,r=new s.Pm;r.Source="JS_default_source",r.DataPackageId=s.P6.GetGuid(),r.Timestamp=s.P6.GetTimeStamp();var a=t;if(t=[],a.length>200){var o=a.splice(0,200);t.push.apply(t,a),a=o}for(;r.Records=[],r.Records.push.apply(r.Records,a),n.DataPackages=[],n.DataPackages.push(r),i=this._Serialize(n),this._Verbose(["_PackageEvents, sendEvents.length:",a.length," buffer.length:",i.length," MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(i.length<this._MaxPackageSizeInBytes);){if(1==a.length){a=[],i=null;break}var l=a.splice(0,Math.floor(a.length/2));this._Verbose("_PackageEvents, too large, package again"),t.push.apply(t,a),a=l}return this._Verbose(["_PakcageEvents done, sendEventsCount:",a.length,"buffer.length:",null==i?0:i.length,"remained events:",t.length].join("")),{buffer:i,sendEvents:a,remainedEvents:t}}_Serialize(e){if(this._config.useJsonTextStream){var t=new u;return e.Write(t),JSON.stringify(t.data)}var i=new h,s=new d.rH(i);return e.Write(s),i.GetBuffer()}_SendCallback(e,t,i,s,n){var r;if(this._Verbose(["_SendCallback","tag:",e,"current tag:",E._tag,"tenantToken:",t,"events count:",i.length,"jqXHR:",s].join("")),null==n){var a=null!=s&&s.status>=200&&s.status<300;if(this._status<C.Started||e<E._tag)this._Verbose("_SendCallback, is not started, or tag is not the same, return");else{if(!(a||s&&400==s.status))return this._Verbose("retry statusCode: "+(s?s.status:0)),null===(r=this._eventsCache)||void 0===r||r.AddEvents(t,i),void this._ScheduleTimer(!0);for(var o=0;o<this._listeners.length;++o)this._listeners[o](a?_.SENT:_.SEND_FAILED,s?s.status:0,t,i);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}}else n(s?s.status:0,t,i)}_CleanTimer(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)}_ScheduleTimer(e){if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);t=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout((()=>this._WorkThread(null)),1e3*t),this._Verbose("_ScheduleTimer, next try (s): "+t),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var t=0,i=(new Date).getTime()-this._lastActiveTime;t=i>m.TimeIntervalForNextSendInMS?0:m.TimeIntervalForNextSendInMS-i,this._timer=setTimeout((()=>this._WorkThread(null)),t),this._Verbose("_ScheduleTimer, next try: "+t),this._rescheduleFactor=1}}_Verbose(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)}_Info(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)}_Error(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)}_Reset(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new A(this._config.log,this._config.eventsLimitInMem),this._ecsClient&&(this._ecsClient.RemoveListener(this._ecsCallback),this._ecsCallback=null)}_CreateEcsCallback(){return e=>{e==a.CONFIG_UPDATED&&(this._etag=this._ecsClient.GetETag())}}__AddTestHookListener(e){if(this._status<C.Initialized)throw new S(p.DATARV_ERROR_INVALID_STATUS);for(var t=0;t<this._testHookListeners.length;++t)if(this._testHookListeners[t]==e)return;this._testHookListeners.push(e)}__ClearTestHookListener(){this._testHookListeners=[]}__GetListenerArray(){return this._listeners}__GetTotalEventsCount(){return this._eventsCache.GetTotalEventsCount()}__IsScheduled(){return null!=this._timer}__ChageMaxPackageSizeInKB(e){this._MaxPackageSizeInBytes=1024*e}__SetTestServerResponseHook(e){this._testServerResponseHook=e}}E._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,E._tag=0;class A{constructor(e,t){this._logger=e,this._eventsLimitInMem=t,this._events={},this._tokens=[]}AddEvents(e,t){t.length&&(t.length>this._eventsLimitInMem?this._logDroppedEvents(e,t.length):(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t)))}IsEmpty(){return 0==this._tokens.length}DequeuEvents(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}}GetTotalEventsCount(){var e=0;for(var t in this._events)e+=this._events[t].length;return e}setEventsLimitInMem(e){this._eventsLimitInMem=e}_logDroppedEvents(e,t){if(!this._logger)return;let i=0;this._events[e]&&(i=this._events[e].length),this._logger.Verbose(`[TelemetryEventCache]: Size of dropped events: ${t},\n      events size currently in queue for tenant ${e}: ${i}`)}}},174415:(e,t,i)=>{i.d(t,{w:()=>s});class s{static get version(){return"2.5.0"}}},574487:(e,t,i)=>{i.d(t,{cS:()=>h,kc:()=>c,sM:()=>n,hD:()=>g,Yd:()=>S});var s,n,r=i(807109),a=i(871543),o=i(624965),l=i(174415),d=null;function h(e){d=e}class u{constructor(){this.key=null,this.value=null,this.pii=null}static _isPii(e){if(e==a.A4.NotSet)return!1;var t=!1;for(var i in a.A4)isNaN(i)||i==e&&(t=!0);return t}}class c{constructor(){this.name=null,this.timestamp=null,this.properties=[],this.eventType=null}setProperty(e,t,i){if(!e||!this.properties[e]&&!c._propertyNameRegex.test(e))throw new _(s.INVALID_PROPERTY_NAME);this.properties[e]={key:e,value:t,pii:i!=a.A4.NotSet?i:null}}unsetProperty(e){if(!e)throw new _(s.INVALID_PROPERTY_NAME);void 0!==this.properties[e]&&(this.properties[e]=void 0,delete this.properties[e])}}c._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.INVALID_COLLECTOR_URL=4]="INVALID_COLLECTOR_URL",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE"}(s||(s={}));class _{constructor(e){this.errorCode=null,this.errorCode=e}ErrorCode(){return this.errorCode}toString(){switch(this.errorCode){case s.INVALID_TENANT_TOKEN:return"Invalid tenant token";case s.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case s.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$";case s.INVALID_COLLECTOR_URL:return"Collector url can't be null or empty.";case s.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case s.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case s.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case s.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case s.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";default:return"Unknown error"}}}class p{constructor(e){this.contextMap=new o.D,this.piiKind=a.A4.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}setAppId(e){e&&this.contextMap.Add("AppInfo.Id",e)}setAppVersion(e){e&&this.contextMap.Add("AppInfo.Version",e)}setAppClientType(e){e&&this.contextMap.Add("AppInfo.ClientType",e)}setAppLanguage(e){e&&this.contextMap.Add("AppInfo.Language",e)}setDeviceId(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.Id",e)}setDeviceOsName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsName",e)}setDeviceOsVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsVersion",e)}setDeviceBrowserName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserName",e)}setDeviceBrowserVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserVersion",e)}setUserId(e,t){e&&this.contextMap.Add("UserInfo.Id",e),u._isPii(t)&&(this.piiKind=t)}setUserMsaId(e){e&&this.contextMap.Add("UserInfo.MsaId",e)}setUserANID(e){e&&this.contextMap.Add("UserInfo.ANID",e)}setUserAdvertisingId(e){e&&this.contextMap.Add("UserInfo.AdvertisingId",e)}setUserTimeZone(e){e&&this.contextMap.Add("UserInfo.TimeZone",e)}setUserLanguage(e){e&&this.contextMap.Add("UserInfo.Language",e)}setUserRing(e){e&&this.contextMap.Add("UserInfo.Ring",e)}setUserTenantId(e){e&&this.contextMap.Add("UserInfo.TenantId",e)}}class C{static initialize(e){C.documentInfo=e;var t=e.appLanguage;t&&C.semanticContext.setAppLanguage(t);var i=e.userLanguage;i&&C.semanticContext.setUserLanguage(i);var s=(new Date).getTimezoneOffset(),n=s%60,r=(s-n)/60,a="+";r>0&&(a="-"),n=Math.abs(n);var o=a+((r=Math.abs(r))<10?"0"+r:r.toString())+":"+(n<10?"0"+n:n.toString());C.semanticContext.setUserTimeZone(o),C.semanticContext.setDeviceBrowserName(C._getBrowserName()),C.semanticContext.setDeviceBrowserVersion(C._getBrowserVersion()),C.semanticContext.setDeviceOsName(C._getOsName()),C.semanticContext.setDeviceOsVersion(C._getOsVersion()),C.semanticContext.setDeviceId(e.deviceId),C.firstLaunchTime=e.firstLaunchTime,C.semanticContext.setAppVersion(e.appVersion)}static _getUserAgent(){return C.documentInfo.userAgent}static _userAgentContainsString(e){return C._getUserAgent().indexOf(e)>-1}static _isIe(){return C._userAgentContainsString("Trident")}static _isEdge(){return C._userAgentContainsString(C.BROWSERS.EDGE)}static _isEdgeAnaheim(){return C._userAgentContainsString("Edg/")}static _isOpera(){return C._userAgentContainsString("OPR/")}static _getBrowserName(){return C._isOpera()?C.BROWSERS.UNKNOWN:C._userAgentContainsString(C.BROWSERS.PHANTOMJS)?C.BROWSERS.PHANTOMJS:C._isEdge()?C.BROWSERS.EDGE:C._isEdgeAnaheim()?C.BROWSERS.EDGEANAHEIM:C._userAgentContainsString(C.BROWSERS.ELECTRON)?C.BROWSERS.ELECTRON:C._userAgentContainsString(C.BROWSERS.CHROME)?C.BROWSERS.CHROME:C._userAgentContainsString(C.BROWSERS.FIREFOX)?C.BROWSERS.FIREFOX:C._userAgentContainsString(C.BROWSERS.SAFARI)?C.BROWSERS.SAFARI:C._userAgentContainsString(C.BROWSERS.SKYPE_SHELL)?C.BROWSERS.SKYPE_SHELL:C._isIe()?C.BROWSERS.MSIE:C.BROWSERS.UNKNOWN}static _getBrowserVersion(){return C._isIe()?function(){var e,t=C._getUserAgent(),i=t.match(new RegExp(C.BROWSERS.MSIE+" "+C.REGEX_VERSION));if(i)return i[1];if(e=t.match(new RegExp("rv:"+C.REGEX_VERSION)))return e[1]}():function(e){var t;e===C.BROWSERS.SAFARI?e="Version":e===C.BROWSERS.EDGEANAHEIM&&(e="Edg");if(t=C._getUserAgent().match(new RegExp(e+"/"+C.REGEX_VERSION)))return t[1];return C.UNKNOWN_VERSION}(C._getBrowserName())}static _getOsName(){return C._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?C.OPERATING_SYSTEMS.WINDOWS_PHONE:C._getUserAgent().match(/ arm;/i)?C.OPERATING_SYSTEMS.WINDOWS_RT:C._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?C.OPERATING_SYSTEMS.IOS:C._getUserAgent().match(/android/i)?C.OPERATING_SYSTEMS.ANDROID:C._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?C.OPERATING_SYSTEMS.LINUX:C._getUserAgent().match(/(macintosh|mac os x)/i)?C.OPERATING_SYSTEMS.MACOSX:C._getUserAgent().match(/(windows|win32)/i)?C.OPERATING_SYSTEMS.WINDOWS:C.OPERATING_SYSTEMS.UNKNOWN}static _getOsVersion(){return C._getOsName()===C.OPERATING_SYSTEMS.WINDOWS?function(){var e=C._getUserAgent().match(new RegExp("Windows NT "+C.REGEX_VERSION));if(e&&C.VERSION_MAPPINGS[e[1]])return C.VERSION_MAPPINGS[e[1]];return C.UNKNOWN_VERSION}():C._getOsName()===C.OPERATING_SYSTEMS.MACOSX?function(){var e=C._getUserAgent().match(new RegExp(C.OPERATING_SYSTEMS.MACOSX+" "+C.REGEX_VERSION_MAC));if(e){var t=e[1].replace(/_/g,".");if(t){var i=function(e){if(e.indexOf(".")>-1)return".";if(e.indexOf("_")>-1)return"_";return null}(t);return i?t.split(i)[0]:t}}return C.UNKNOWN_VERSION}():C.UNKNOWN_VERSION}}C.semanticContext=new p(!0),C.firstLaunchTime=-1,C.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGEANAHEIM:"EdgeAnaheim",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},C.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},C.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},C.REGEX_VERSION="([\\d,.]+)",C.REGEX_VERSION_MAC="([\\d,_,.]+)",C.UNKNOWN_VERSION="Unknown",C.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",C.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(n||(n={}));class g{static initialize(e,t){if(!g._initialized){if(!t)throw new _(s.INVALID_TENANT_TOKEN);g._defaultToken=t,g._config.collectorUrl||(g._config.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),d||(d=r.sE.CreateTelemetryManager()).Initialize(g._config),d.Start(),C.initialize(e),g._initialized=!0}}static initializeWithConfiguration(e,t,i){if(!i.collectorUrl)throw new _(s.INVALID_COLLECTOR_URL);g._config.collectorUrl=i.collectorUrl,g.initialize(e,t)}static flush(e){d.Flush(e)}static addCallbackListener(e){g._initialized&&d.AddListener(e)}static setContext(e,t,i){""!==t&&"null"!==t&&"undefined"!==t?g._contextProperties.setProperty(e,t,i):g._contextProperties.unsetProperty(e)}static isInitialized(){return g._initialized}static getDefaultToken(){return g._defaultToken}static getSemanticContext(){return g._semanticContext}static __addTestHookListener(e){g._initialized&&d.__AddTestHookListener(e)}static __clearTestHookListener(){g._initialized&&d.__ClearTestHookListener()}static __backToUninitialized(){g._config=new r.Mk,g._semanticContext=new p(!0),g._contextProperties=new c,d=r.sE.CreateTelemetryManager(),g._initialized=!1}}g._initialized=!1,g._defaultToken=null,g._config=new r.Mk,g._contextProperties=new c,g._semanticContext=new p(!0);class S{constructor(e){this._initId=a.P6.GetGuid(),this._sequence=0,this._tenantToken=null,this._contextProperties=new c,this._semanticContext=new p(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||g.getDefaultToken()}logEvent(e){if(!e.name)throw new _(s.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addCustomPropertiesToEvent(t,e),this._sendRecord(t)}logFailure(e,t,i,n,r){if(!e)throw new _(s.MISSING_FAILURE_SIGNATURE);if(!t)throw new _(s.MISSING_FAILURE_DETAIL);var a=this._createEventRecord("failure","failure");a.Extension.Add("Failure.Signature",e),a.Extension.Add("Failure.Detail",t),i&&a.Extension.Add("Failure.Category",i),n&&a.Extension.Add("Failure.Id",n),this._addCustomPropertiesToEvent(a,r),this._sendRecord(a)}logPageView(e,t,i,n,r,a){if(!e)throw new _(s.MISSING_PAGEVIEW_ID);if(!t)throw new _(s.MISSING_PAGEVIEW_NAME);var o=this._createEventRecord("pageview","pageview");o.Extension.Add("PageView.Id",e),o.Extension.Add("PageView.Name",t),i&&o.Extension.Add("PageView.Category",i),n&&o.Extension.Add("PageView.Uri",n),r&&o.Extension.Add("PageView.ReferrerUri",r),this._addCustomPropertiesToEvent(o,a),this._sendRecord(o)}logSession(e,t,i,r){if(e!==n.STARTED&&e!==n.ENDED)throw new _(s.INVALID_SESSION_STATE);var o=this._createEventRecord("session","session");if(e===n.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=r||(new Date).getTime(),this._sessionId=i||a.P6.GetGuid(),o.Extension.Add("Session.Id",this._sessionId),o.Extension.Add("Session.State","Started")}else if(e===n.ENDED){if(0==this._sessionStartTime)return;var l=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);o.Extension.Add("Session.Duration",l.toString()),o.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(l)),o.Extension.Add("Session.Id",this._sessionId),o.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}o.Extension.Add("Session.FirstLaunchTime",new Date(C.firstLaunchTime).toISOString()),this._addCustomPropertiesToEvent(o,t),this._sendRecord(o)}getSessionId(){return this._sessionId}setContext(e,t,i){this._contextProperties.setProperty(e,t,i)}getSemanticContext(){return this._semanticContext}_getSessionDurationFromTime(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"}_createEventRecord(e,t){var i=new a.WV;t||(t="custom"),i.EventType=e.toLowerCase(),i.Type=t.toLowerCase(),i.Extension.Add("EventInfo.Source","JS_default_source"),i.Extension.Add("EventInfo.InitId",this._initId),this._sequence++,i.Extension.Add("EventInfo.Sequence",this._sequence.toString()),i.Extension.Add("EventInfo.Name",e.toLowerCase());var s=new Date;return i.Timestamp=a.P6.GetTimeStampWithValue(s.getTime()),i.Extension.Add("EventInfo.Time",s.toISOString()),i.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+l.w.version),i}_addCustomPropertiesToEvent(e,t){this._addSemanticContext(e,C.semanticContext),this._addSemanticContext(e,g._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,g._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)}_addSemanticContext(e,t){if(t&&t.contextMap.Count()>0)for(var i=t.contextMap.GetBuffer(),s=0;s<i.length;s++)"UserInfo.Id"==i[s].Key&&t.piiKind!=a.A4.NotSet?e.AddOrReplacePII(i[s].Key,i[s].Value,t.piiKind):e.Extension.AddOrReplace(i[s].Key,i[s].Value)}_addEventPropertiesToEvent(e,t){if(t){t.timestamp&&t.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=a.P6.GetTimeStampWithValue(t.timestamp),e.Extension.AddOrReplace("EventInfo.Time",new Date(t.timestamp).toISOString())),t.name&&(e.EventType=t.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",t.name.toLowerCase()));var i=t.properties;if(i)for(var s in i)i[s].key&&"string"==typeof i[s].key&&(i[s].value||0==i[s].value||0==i[s].value||""==i[s].value)&&(u._isPii(i[s].pii)?(e.AddOrReplacePII(i[s].key,i[s].value.toString(),i[s].pii),e.Extension.Remove(i[s].key)):(e.Extension.AddOrReplace(i[s].key,i[s].value.toString()),e.PIIExtensions.Remove(i[s].key)))}}_sendRecord(e){g.isInitialized()&&d.SendAsync(this._tenantToken,[e])}}},508907:(e,t,i)=>{i.d(t,{a:()=>c,B:()=>u});var s=i(936210);const n=[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.DL,s.Cb.ModernGroup,s.Cb.PersonalContact,s.Cb.UserDefinedGroup,s.Cb.Pstn,s.Cb.CallQandAA,s.Cb.Room,s.Cb.TeamTags,s.Cb.GroupChats,s.Cb.Xtap,s.Cb.TflOffNetworkEmails,s.Cb.TflOffNetworkPhones,s.Cb.TflConsumer,s.Cb.ImplicitContacts],r=[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.DL,s.Cb.ModernGroup,s.Cb.UserDefinedGroup,s.Cb.Pstn,s.Cb.CallQandAA,s.Cb.Room,s.Cb.TeamTags,s.Cb.GroupChats,s.Cb.Xtap,s.Cb.TflOffNetworkEmails,s.Cb.TflOffNetworkPhones,s.Cb.TflConsumer,s.Cb.ImplicitContacts],a=[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.DL,s.Cb.ModernGroup,s.Cb.UserDefinedGroup,s.Cb.Pstn,s.Cb.CallQandAA,s.Cb.Room,s.Cb.TeamTags,s.Cb.GroupChats,s.Cb.Xtap,s.Cb.TflOffNetworkEmails,s.Cb.TflOffNetworkPhones,s.Cb.TflConsumer,s.Cb.ImplicitContacts],o=[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.DL,s.Cb.ModernGroup,s.Cb.UserDefinedGroup,s.Cb.Pstn,s.Cb.CallQandAA,s.Cb.Room,s.Cb.GroupChats,s.Cb.Xtap,s.Cb.Meetings,s.Cb.TflSmsName],l=(s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.DL,s.Cb.ModernGroup,s.Cb.PersonalContact,s.Cb.UserDefinedGroup,s.Cb.Pstn,{[s.TS.callForwardGroupSelection]:[s.Cb.AADTenant,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Pstn,s.Cb.CallQandAA],[s.TS.allTrue]:n,[s.TS.meetingRoomCall]:r,[s.TS.searchSuggestions]:o,[s.TS.addToMeetingForSharedChannel]:a,[s.TS.calendarPeoplePicker]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.DisabledUser,s.Cb.PersonalContact,s.Cb.ModernGroup,s.Cb.DL],[s.TS.searchResults]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.ModernGroup,s.Cb.UserDefinedGroup,s.Cb.Pstn,s.Cb.CallQandAA],[s.TS.addToTeam]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.Pstn],[s.TS.newChat]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.DL,s.Cb.ModernGroup,s.Cb.UserDefinedGroup,s.Cb.TeamTags,s.Cb.Room,s.Cb.TflSmsName,s.Cb.ExtendedDirectoryUsers],[s.TS.transfer]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.DisabledUser,s.Cb.DL,s.Cb.ModernGroup,s.Cb.UserDefinedGroup,s.Cb.Pstn,s.Cb.CallQandAA],[s.TS.addToCall]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.UserDefinedGroup,s.Cb.Pstn,s.Cb.PersonalContact,s.Cb.CallQandAA,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.ImplicitContacts,s.Cb.TflConsumer,s.Cb.Xtap],[s.TS.addToChat]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.DisabledUser,s.Cb.TeamTags,s.Cb.Room],[s.TS.searchPeopleFilter]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.Pstn,s.Cb.TeamTags],[s.TS.callRouting]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.DL,s.Cb.UserDefinedGroup,s.Cb.Pstn,s.Cb.CallQandAA],[s.TS.delegationSelection]:[s.Cb.AADTenant],[s.TS.presenceSettings]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Pstn],[s.TS.addToMeeting]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.DL,s.Cb.ModernGroup,s.Cb.UserDefinedGroup,s.Cb.Pstn],[s.TS.meetingSchedule]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.DL,s.Cb.ModernGroup,s.Cb.Pstn],[s.TS.addToSpeedDialOrContacts]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.CallQandAA],[s.TS.atMention]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Bot,s.Cb.Pstn],[s.TS.orgChart]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Pstn],[s.TS.priorityContactsSelection]:[s.Cb.AADTenant,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Pstn],[s.TS.taggedContactsSelection]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.DL],[s.TS.shareToTeams]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.DisabledUser,s.Cb.UserDefinedGroup],[s.TS.escalateMessage]:[s.Cb.AADTenant],[s.TS.voicemailTransferTarget]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.Bot,s.Cb.DisabledUser,s.Cb.ModernGroup,s.Cb.UserDefinedGroup,s.Cb.Pstn,s.Cb.CallQandAA],[s.TS.addToSharedChannel]:[s.Cb.AADTenant,s.Cb.Xtap],[s.TS.allFalse]:[],[s.TS.custom]:[]});var d=i(197981);const h=(e,t)=>(0,d.flatten)(e.filter((([e,i])=>e===t)).map((([e,t])=>t))),u={[s.H8.Substrate]:[s.Cb.AADTenant,s.Cb.Guest,s.Cb.GroupChats,s.Cb.DL,s.Cb.ModernGroup,s.Cb.Room,s.Cb.ExtendedDirectoryUsers,s.Cb.PersonalContact,s.Cb.MTOUsers],[s.H8.AAD]:[s.Cb.Guest],[s.H8.IndexedDb]:[s.Cb.Federated,s.Cb.FederatedConsumer,s.Cb.Bot,s.Cb.Pstn],[s.H8.MiddleTier]:[],[s.H8.TopNCache]:[],[s.H8.Memory]:[],[s.H8.TFLZeroState]:[]};class c{constructor(e,t){this.includeFeatures=e,this.name=t,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeOffNetworkEmails=!1,this.includeOffNetworkPhones=!1,this.includeTflConsumer=!1,this.includeTflSmsName=!1,this.includeImplicitContacts=!1,this.includeExtendedDirectoryUsers=!1,this.includeMTOUsers=!1,this.includeAADTenant=(0,d.includes)(e,s.Cb.AADTenant),this.includeGuest=(0,d.includes)(e,s.Cb.Guest),this.includeFederated=(0,d.includes)(e,s.Cb.Federated),this.includeFederatedConsumer=(0,d.includes)(e,s.Cb.FederatedConsumer),this.includeBot=(0,d.includes)(e,s.Cb.Bot),this.includeDisabledUser=(0,d.includes)(e,s.Cb.DisabledUser),this.includeDL=(0,d.includes)(e,s.Cb.DL),this.includeModernGroup=(0,d.includes)(e,s.Cb.ModernGroup),this.includePersonalContact=(0,d.includes)(e,s.Cb.PersonalContact),this.includeUserDefinedGroup=(0,d.includes)(e,s.Cb.UserDefinedGroup),this.includePstn=(0,d.includes)(e,s.Cb.Pstn),this.includeCallQandAA=(0,d.includes)(e,s.Cb.CallQandAA),this.includeRoom=(0,d.includes)(e,s.Cb.Room),this.includeTeamTags=(0,d.includes)(e,s.Cb.TeamTags),this.includeGroupChats=(0,d.includes)(e,s.Cb.GroupChats),this.includeMeetingChats=(0,d.includes)(e,s.Cb.Meetings),this.includeXtap=(0,d.includes)(e,s.Cb.Xtap),this.includeOffNetworkEmails=(0,d.includes)(e,s.Cb.TflOffNetworkEmails),this.includeOffNetworkPhones=(0,d.includes)(e,s.Cb.TflOffNetworkPhones),this.includeTflConsumer=(0,d.includes)(e,s.Cb.TflConsumer),this.includeTflSmsName=(0,d.includes)(e,s.Cb.TflSmsName),this.includeImplicitContacts=(0,d.includes)(e,s.Cb.ImplicitContacts),this.includeExtendedDirectoryUsers=(0,d.includes)(e,s.Cb.ExtendedDirectoryUsers),this.includeMTOUsers=(0,d.includes)(e,s.Cb.MTOUsers)}}c.fromName=(e,t=[])=>{if(!(e in l))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const i=h(t,!0),s=h(t,!1),n=d.without.apply(null,[(0,d.concat)(l[e],i),...s]);return new c(n,e)},c.createFrom=(e,t,i)=>new c(t||e.includeFeatures,i||e.name),c.includesAll=(e,t)=>(0,d.every)(t,(t=>(0,d.includes)(e.includeFeatures,t))),c.includesAny=(e,t)=>(0,d.some)(t,(t=>(0,d.includes)(e.includeFeatures,t)))},412229:(e,t,i)=>{function s(e){let t=5381;for(let i=0;i<e.length;i++)t=(t<<5)+t+e.charCodeAt(i);return t>>>0}i.d(t,{E:()=>s})}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/499444-643e02b1dfac121a.js.map