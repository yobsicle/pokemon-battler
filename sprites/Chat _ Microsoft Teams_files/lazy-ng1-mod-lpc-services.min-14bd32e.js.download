webpackJsonp([23],{142:function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){function i(e){return e instanceof t?e:new t(function(n){n(e)})}return new(t||(t=Promise))(function(t,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?t(e.value):i(e.value).then(a,s)}c((r=r.apply(e,n||[])).next())})},i=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,o=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=n.call(e,c)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(n,"__esModule",{value:!0}),n.determineLPCPersonaType=function(e,n){var t=e.type||e.userType;if(!t)return"NotResolved";switch(t){case n.userTypes.federated:case n.userTypes.skypeConsumer:case n.userTypes.tflConsumer:return"External";case"person":return e.role===n.userTypes.guest?"NotResolved":"User";default:return"User"}},n.determineCardTypeForTargetUser=function(e,n,t,r,i,o,a){if(a.isUnknownEmail(t))return"UnknownUser";if(r)return"Me";if(i)return"External";switch(n){case o.userTypes.federated:case o.userTypes.skypeConsumer:case o.userTypes.tflConsumer:return"External";case"person":case"ADUser":return"Guest"===e?"Guest":"User";default:return"User"}},n.getCleanUpn=function(e){return!e||SkypeX.Services.ChatServiceUtils.isMri(e)?void 0:e},n.serializeHostAppPersonaId=function(e){return JSON.stringify(e)},n.isLinkedInEnabled=function(e,n){return e.valueAsBoolean(n.settings.names.enableLinkedInInLPC)},n.deserializeHostAppPersonaId=function(e){if(!e)return{userId:void 0,isSharedChannel:!1,hostTenantId:void 0,hostConversationId:void 0,isExchangeOnlyContact:!1};var n=JSON.parse(e);return{userId:n.userId,isSharedChannel:!0===n.isSharedChannel,hostTenantId:n.hostTenantId,hostConversationId:n.hostConversationId,isExchangeOnlyContact:!0===n.isExchangeOnlyContact}},n.getTimeFormat=function(e){var n=e.getDateFormatValue("shortTime",!1);return"HH:mm"===n?[n,!0]:[n,!1]},n.resolveMriIfNeeded=function(e,n,t){return r(this,void 0,void 0,function(){var r,o;return i(this,function(i){switch(i.label){case 0:return e.TeamsMri?[2,e.TeamsMri]:(r=e.Upn||e.Smtp)?[4,n.getAllPeopleProfile([r],t,!0,r===e.Smtp)]:[2,void 0];case 1:return 0===(o=i.sent()).length?[2,void 0]:[2,o[0].mri]}})})},n.getLPCPlatform=function(e){return e.isWeb()?"Web":"Desktop"},n.isUnknownUser=function(e,n){return e.isUnknownEmail(n.Smtp)}},2405:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t(2406)},2406:function(e,n,t){"use strict";var r=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,n,t,r){function i(e){return e instanceof t?e:new t(function(n){n(e)})}return new(t||(t=Promise))(function(t,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?t(e.value):i(e.value).then(a,s)}c((r=r.apply(e,n||[])).next())})},a=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,o=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=n.call(e,c)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(n,"__esModule",{value:!0});var s=t(2407),c=t(34),u=t(142),l=t(2408),f=t(2409),d=t(2410),p=t(2411),v=t(2415),g=function(e){function n(n,t,r,i,o,a,s,c,u,l,f,d,p,v,g,h,m,y){var b=e.call(this,l)||this;return b.constants=n,b.utilityService=t,b.settingsService=r,b.authenticationService=i,b.sxConfig=o,b.localizationService=a,b.eventingService=s,b.appStateService=c,b.desktopUtilityService=u,b.loggingService=f,b.logger=d,b.actionCallbacks=p,b.dataCallbacks=v,b.telemetryCallbacks=g,b.analyticsService=h,b.analyticsStateService=m,b.$state=y,b.changeTheme=function(e){var n=window.LPC;n&&n.loadTheme(b.getTheme(e))},b.initializeOnAppLaunchAndReinit("First Initialize"),b}return r(n,e),Object.defineProperty(n.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLivePersonaCardEnabled",{get:function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard)},enumerable:!0,configurable:!0}),n.prototype.mtmaTelemetryIdentifier=function(){return"LivePersonaCardService"},n.prototype.cleanupOnAppTeardown=function(e){this.logger.log("LivePersonaCardService onAppTeardown: reason = {0}",e),this.lpcPromise=null,window.LPC=null,this.unbsubscribeFromAppStateChanges&&(this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=null)},n.prototype.initializeOnAppLaunchAndReinit=function(e){var n=this;this.logger.log("LivePersonaCardService Initialize reason {0}",e),this.eventingService.unsafeOnWithTenantScope(this.constants.events.layout.themeChanged,function(e,t){n.isLivePersonaCardInitialized&&n.changeTheme(t)}),this.unbsubscribeFromAppStateChanges&&this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=this.eventingService.unsafeOnWithTenantScope(this.constants.events.appState.changed,function(e,t){n.onAppStateChanged(t)})},n.prototype.initializeLPC=function(){return o(this,void 0,void 0,function(){var e,n,t,r,o,c,l,f,d,p,v,g,h,m,y,b,C,S,w,P,T,k,I,x,A,L,O,E,U,_,M,D,B,R,F,N,H,G,z,j,X,V;return a(this,function(a){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];if(e=this.loggingService.newScenario("LivePersonaCard_Initialize"),n=this.utilityService.generateUUID(),t=this.localizationService.getLocale(),r=this.settingsService.getVersion().clientVersion,o=this.settingsService.valueFor(this.constants.settings.names.lpcComplianceEnvironment),c=this.authenticationService.getUserTypeInTenant(),l=this.sxConfig.getCurrentSkypeMri(),f=c===teamspace.services.UserTypeInTenant.Guest,d=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTimeZoneInLPC),p=this.settingsService.valueAsBoolean(this.constants.settings.names.enableExpandedViewInLPC),v=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePronounsInLPC),g=this.settingsService.valueAsBoolean(this.constants.settings.names.enableVersionLockLPC),h=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePeopleHighlightsInLPC),m=this.settingsService.valueAsBoolean(this.constants.settings.names.enableVivaSalesInLPC),y=this.settingsService.valueAsBoolean(this.constants.settings.names.enableVivaTopicsInLPC),b=this.settingsService.valueAsBoolean(this.constants.settings.names.enableNextAvailabilityInLPC),C=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTrustedTypesForLPC),S=this.settingsService.valueAsBoolean(this.constants.settings.names.enableAliasVisibilitySettings),w=u.isLinkedInEnabled(this.settingsService,this.constants),P=this.settingsService.valueAsBoolean(this.constants.settings.names.enableAnonymousUsersInLPC),T=this.settingsService.valueAsBoolean(this.constants.settings.names.enableExtendedDirectory),k=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePresenceInContactInLPC),I=this.settingsService.valueAsBoolean(this.constants.settings.names.enableHybridLocationInLPC),x=this.settingsService.valueAsBoolean(this.constants.settings.names.enableRichAvailabilityPanelInLPC),A=this.settingsService.valueAsBoolean(this.constants.settings.names.enableWorkingHoursInLPC),L=this.constants.settings.names.lpcRegion,O=this.settingsService.valueFor(L),E=!f&&O,U=E?O:"",!window)throw V="Window object is undefined",e.fail({message:V,clientCorrelationId:n,lpcRegion:U,userTypeInTenant:c}),new Error(V);if(!this.appStateService.isOnline)throw V="App is Offline",e.fail({message:V,clientCorrelationId:n,lpcRegion:U,userTypeInTenant:c}),new Error(V);_=this.getTeamsConfig(n,t,U,o),M=this.settingsService.getRing(),D=this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCardV2),B={isLivePersonaCardV2Enabled:D},R=u.getTimeFormat(this.localizationService),F=R[0],N=R[1],H=this.settingsService.valueFor("lpcLokiUrlOverride"),this.logger.info("Client Correlation ID for LivePersonaCard in Teams Main Window: clientCorrelationId="+n);try{return G=M&&M.id?M.id:void 0,z=r,j=u.getLPCPlatform(this.desktopUtilityService),this.lpcPromise=s.loadLPC(g,i(i({},_),{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,telemetryCallbacks:this.telemetryCallbacks,getAuthToken:this.getAuthToken(n),theme:this.getTheme(this.settingsService.getActiveTheme()),hostAppRing:G,hostAppVersion:z,platform:j,options:{hostAppRing:G,hostAppVersion:z,isLoggedInAsTeamsGuestUser:f,isTimeZoneEnabled:d,isNavigateToExpandedViewEnabled:p,isPronounsEnabled:v,isPeopleHighlightsEnabled:h,isVivaSalesLpcEnabled:m,isNextAvailabilityEnabled:b,isPresenceInContactEnabled:k,isAliasVisibilityEnabled:S,isLinkedInEnabledInHostApp:w,isAnonymousUsersEnabled:P,isExtendedDirectoryEnabled:T,isHybridLocationEnabled:I,isRichAvailabilityPanelEnabled:x,isWorkingHoursEnabledLPCv2:A,is24HourFormat:N,timeFormat:F,isTrustedTypesEnabled:C,lokiUrlOverride:H,isVivaTopicsEnabled:y},hostAppConfiguration:B,loggedInUserTeamsMri:l,targetWindow:window})),X=D?"LPCv2":"LPCv1",this.lpcPromise.then(function(){var t=window.LPC&&window.LPC.version||"";e.stop({message:"LivePersonaCard loaded",version:t,clientCorrelationId:n,lpcRegion:U,userTypeInTenant:c,lpcArchitectureVersion:X})}).catch(function(t){throw e.fail({message:"Could not load LivePersonaCard",clientCorrelationId:n,lpcRegion:U,userTypeInTenant:c,lpcArchitectureVersion:X}),t}),[2,this.lpcPromise]}catch(t){throw V="Could not load live persona card: "+t,e.fail({message:V,clientCorrelationId:n,lpcRegion:U,userTypeInTenant:c}),new Error(V)}return[2]})})},n.prototype.createLPC=function(e,n){var t=n.profile,r=n.behavior,o=n.ariaLabel,a=n.externalAppSessionCorrelationId,s=n.disableAccessibilityDefaults,c=n.tabIndex,l=n.clientScenario,f=n.isSharedChannel,d=n.hostTenantId,p=n.hostConversationId,v=n.isExchangeOnlyContact,g=n.contactId;{if(this.isLivePersonaCardInitialized){var h=u.determineLPCPersonaType(t,this.constants),m=u.getCleanUpn(t.userPrincipalName),y={personaInfo:{identifiers:{PersonaType:h,AadObjectId:t.objectId,TeamsMri:t.mri,OlsPersonaId:g,HostAppPersonaId:u.serializeHostAppPersonaId({userId:t.mri,isSharedChannel:f,hostTenantId:d,hostConversationId:p,isExchangeOnlyContact:v}),Upn:m,Smtp:t.email},skypeId:t.skypeId},behavior:i({disableHover:!1,cardPlacementMode:"AnchorSide"},r),ariaLabel:o,disableAccessibilityDefaults:!!s,tabIndex:c,externalAppSessionCorrelationId:a,clientScenario:l};this.attachHoverTargetAsync(e,y);var b=function(){window.requestIdleCallback&&window.requestIdleCallback(function(){window.LPC&&window.LPC.removedPersonaFromPage(e)})}.bind(this);return{destroy:function(){b()}}}this.logger.error("Not initialized")}},n.prototype.openCard=function(e,n,t,r,s){var c=this;if(this.isLivePersonaCardInitialized){var u=this.utilityService.generateUUID(),l={openCardTriggerType:n,personaInfo:{displayName:t.displayName,identifiers:i({PersonaType:"NotResolved"},t.identifiers)},behavior:{locationToOpen:r,cardPlacementMode:"AnchorSide",onCardOpen:function(){return o(c,void 0,void 0,function(){var e,n;return a(this,function(t){return s&&s.onCardOpen&&s.onCardOpen(),e=this.analyticsStateService.getPreviousRoute(),n={panel:{type:teamspace.PanelType[teamspace.PanelType.livePersonaCard],region:teamspace.PanelRegion[teamspace.PanelRegion.popover],viewId:this.utilityService.generateUUID(),uri:this.$state.current.name,previousUri:e&&e.state?e.state.name:void 0}},this.analyticsService.sendPanelView(n),[2]})})},onCardClose:function(){s&&s.onCardClose&&s.onCardClose();var e=c.analyticsStateService.getPreviousRoute(),n={panel:{type:teamspace.PanelType[teamspace.PanelType.livePersonaCard],region:teamspace.PanelRegion[teamspace.PanelRegion.popover],viewId:c.utilityService.generateUUID(),uri:c.$state.current.name,previousUri:e&&e.state?e.state.name:void 0},action:{gesture:teamspace.components.PanelActionGesture[teamspace.components.PanelActionGesture.hover],outcome:teamspace.components.PanelActionOutcome[teamspace.components.PanelActionOutcome.closeDialog],scenario:teamspace.components.PanelActionScenario.livePersonaCard,scenarioType:teamspace.components.PanelActionScenarioType.people},module:{name:teamspace.components.PanelModuleName.personCard.toString(),type:teamspace.components.PanelModuleType[teamspace.components.PanelModuleType.other]}};c.analyticsService.sendPanelAction(n)}},externalAppSessionCorrelationId:u};window.LPC.openCard(e,l)}else this.logger.error("Not initialized")},n.prototype.onAppStateChanged=function(e){var n=e.prevState,t=n===teamspace.services.ApplicationState.Offline||n===teamspace.services.ApplicationState.Disconnected||n===teamspace.services.ApplicationState.Disabled,r=this.appStateService.isOnline&&t,i=this.settingsService.valueAsBoolean(this.constants.settings.names.disableLpcOnlineRecovery);r&&!i&&!this.isLivePersonaCardInitialized&&window?(s.freeBootstrapperMemory(window),this.initializeLPC()):this.logger.info("onAppStateChanged: Skip initializeLPC(). isBackOnlineAfterBeingOffline = {0}, disableLpcOnlineRecovery = {1}, this.isLivePersonaCardInitialized = {2}",r,i,this.isLivePersonaCardInitialized)},n.prototype.attachHoverTargetAsync=function(e,n){window.LPC.addedPersonaToPageV2(e,n)},n.prototype.getTheme=function(e){switch(e){case c.TeamsTheme.Dark:case c.TeamsTheme.DarkV2:return p.darkTheme;case c.TeamsTheme.HighContrast:return p.highContrastTheme;case c.TeamsTheme.Default:case c.TeamsTheme.DefaultV2:default:return p.defaultTheme}},n.prototype.getTeamsConfig=function(e,n,t,r){var i=this.authenticationService.isCurrentUserTFLOrMsaAccount();return{culture:n||window.navigator.language||"en-us",region:t,clientCorrelationId:e,clientType:"MicrosoftTeamsAngular",clientContextType:"Generic",complianceEnvironment:r,options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!1},isConsumer:i}},n.prototype.getAuthToken=function(e){var n=this;return function(t,r){return o(n,void 0,void 0,function(){var n,i,o,s,c,u,l,f,d,p,v,g,h,m,y,b;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),n=this.constants.settings.names,i=n.lokiTokenResourceUrl,o=n.enableSilentLokiAuthTokenRetrieval,s=this.settingsService.valueAsBoolean(o),[4,this.authenticationService.getAuthTokens([this.settingsService.valueFor(i)],[],s)];case 1:return(c=a.sent())?("string"!=typeof c&&(u=c,l=Boolean(u.token)?"true":"false",this.logger.service.event("lokitoken_format_workaround",{data:"ContainedToken:"+l}),c=null!==(b=u.token)&&void 0!==b?b:""),t(c,e)):r("[AuthError] Error retrieving auth token, details: Empty token",e),[3,3];case 2:return f=a.sent(),this.logger.error("Error acquiring access token for LOKI"),d=!1,p="Unexpected Error",v=void 0,f&&(v=_.isString(f)?f:f.authStatus+"-"+f.message,v=v.toLowerCase()),v&&(g=v.includes("retry fetch of adal tokens"),h=v.includes("nativewam:3")||v.includes("tokenrevoked"),m=v.includes("mt_token_expired")||v.includes("receivedexpiredtoken"),y=v.includes("renewaltimeout")||v.includes("token renewal"),d=g||y||m||h,g?p="Retry fetch of ADAL tokens failed":y?p="Token renewal call timed out":h?p="Token revoked":m&&(p="Token expired")),r("[AuthError] Error retrieving auth token, details: "+p,e,d),[3,3];case 3:return[2]}})})}},n}(teamspace.services.MTMABase);n.LivePersonaCardService=g,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.dialogService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsAsyncService","teamspace.localizationService","teamspace.eventingService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService","teamspace.platformDetectService","teamspace.extendedDirectoryOnlyPolicyService"]).factory("lpcService",["constants","callingPolicyStore","messagingPolicySettingsStore","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsAsyncService","localizationService","eventingService","messageService","peopleService","dialogService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService","platformDetectService","profilePictureLoaderService","orchestrationService","analyticsService","callBlockingService","appStateService","desktopUtilityService","sxConfig","routeUtilityService","messagingPolicyUtilsService","flatContactListService","telemetryProvider","chatListService","tenantSettingsStore","extendedDirectoryOnlyPolicyService","analyticsStateService","hybridContentVisibilityManager","$state",function(e,n,t,r,i,o,a,s,c,u,p,h,m,y,b,C,S,w,P,T,k,I,x,A,L,O,E,U,_,M,D,B,R,F,N,H,G,z,j,X,V){var q=o.newLogger("LivePersonaCardService"),W=new v.LpcTelemetryHelper(E,o,u),K=W.logPanelActionEvent.bind(W),Q=a.getUserTypeInTenant(),J=l.LPCActionCallbackFactory(s,e,q,y,u,a,c,C,m,U,b,i,H,X,K,D),$=f.LPCDataCallbackFactory(q,u,S,y,r,w,P,i,e,T,k,I,x,A,p,L,U,n,t,Q,D,a,B,R,F,G,z,_),Z=i.valueAsBoolean(e.settings.names.enableLpcSecondPartyTelemetry)?d.LPCTelemetryCallbackFactory(N):void 0;return new g(e,r,i,a,D,p,h,_,M,O,o,q,J,$,Z,E,j,V)}])},2407:function(e,n,t){(function(n){!function(n,t){e.exports=t()}(self,function(){return function(){"use strict";function e(e,n,t){try{t.sessionStorage&&t.sessionStorage.setItem&&t.sessionStorage.setItem(e,n)}catch(e){}}function t(n,t,r){return new Promise(function(i,o){n?(e(Ct,n,r),i(n)):t(function(n,t){n?(e(Ct,n,r),i(n)):o(new bt("GetAuthTokenError","Auth token is undefined",t))},function(e,n,t){var r=function(e,n){var t=/^AADSTS\d+?:/.test(e),r=function(e,n){if(n&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0}return!1}(e,n);return t||r}(e,t)?e:"";o(new bt("GetAuthTokenError",r,n,t))})})}function r(){for(var e=function(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),n=0;n<31;n++)e[n]=Math.floor(16*Math.random());return e}();var e}(),n=0,t="",r=0;r<36;r++)switch(r){case 8:case 13:case 18:case 23:n+=1,t+="-";break;case 14:n+=1,t+="4";break;case 19:t+=(e[r-n]%4+8).toString(16);break;default:t+=(e[r-n]%16).toString(16)}return t}function i(e,n){void 0===n&&(n=window);var t="";if(n){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(n.location.search);t=r&&n.decodeURIComponent(r[1].replace(/\+/g," "))||""}return t}function o(e,n,t){var r,i,o,a,s,c,u=function(e,n){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(n.location.search),r=n.decodeURIComponent||window.decodeURIComponent;return null===t?"":r&&r(t[1].replace(/\+/g," "))||""}(Ut,t),l=(i=n.region,o=n.complianceEnvironment,a=u||n.culture,s=null===(r=n.options)||void 0===r?void 0:r.lokiUrlOverride,c=function(e,n){var t=function(e){return"df"===e?yt.Dogfood:"msit"===e?yt.MSIT:void 0}(i);return t||(t=function(e){switch(e){case"Df":return yt.Dogfood;case"Msit":return yt.MSIT;case"Blackforest":return yt.Blackforest;case"GccModerate":return yt.GccModerate;case"GccHigh":return yt.GccHigh;case"DoD":return yt.DOD;case"Gallatin":return yt.Gallatin;case"Prod":return yt.TopLevel;case"AG08":return yt.AG08;case"AG09":return yt.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return e}}(n)),t}(0,o),s?St.replace("{0}",s).replace("{1}",a):St.replace("{0}",c).replace("{1}",a));return Ot(l,e,Et(Et({},n),{clientFeature:"LivePersonaCard"}),t)}function a(e,n,t){var r,i,o;void 0===t&&(t=Xt);var s=Object.keys(e).filter(function(e){return!n.includes(e)}),c=mt({},e);try{for(var u=function(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(s),l=u.next();!l.done;l=u.next()){var f=l.value,d=c[f];if("object"!=typeof d||Array.isArray(d))c=Object.assign(c,t(f,c[f]));else{var p=a(c[f],n,t);c=Object.assign(c,((o={})[f]=p,o))}}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return c}function s(e){void 0===e&&(e=!0);var n=!1===e?null:tr;return n||(typeof globalThis!==Wt&&(n=globalThis),n||typeof self===Wt||(n=self),n||typeof window===Wt||(n=window),n||typeof gt.g===Wt||(n=gt.g),tr=n),n}function c(e){throw new TypeError(e)}function u(e){function n(){}if(Yt)return Yt(e);if(null==e)return{};var t=typeof e;return t!==qt&&t!==Vt&&c("Object prototype may only be an Object:"+e),n[Kt]=e,new n}function l(e,n){function t(){this.constructor=e}typeof n!==Vt&&null!==n&&c("Class extends value "+String(n)+" is not a constructor or null"),or(e,n),e[Kt]=null===n?u(n):(t[Kt]=n[Kt],new t)}function f(e,n){for(var t=0,r=n.length,i=e.length;t<r;t++,i++)e[i]=n[t];return e}function d(e,n){return e&&Tr[cr].hasOwnProperty.call(e,n)}function p(e){return e&&(e===Tr[cr]||e===Array[cr])}function v(e){return p(e)||e===Function[cr]}function g(e){var n;if(e){if(kr)return kr(e);var t=e[yr]||e[cr]||(e[sr]?e[sr][cr]:null);n=e[br]||t,d(e,br)||(delete e[Sr],n=e[br]=e[Sr]||e[br],e[Sr]=t)}return n}function h(e,n){var t=[];if(Ir)t=Ir(e);else for(var r in e)"string"==typeof r&&d(e,r)&&t.push(r);if(t&&t.length>0)for(var i=0;i<t.length;i++)n(t[i])}function m(e,n,t){return n!==sr&&typeof e[n]===ur&&(t||d(e,n))}function y(e){throw new TypeError("DynamicProto: "+e)}function b(e,n){for(var t=e.length-1;t>=0;t--)if(e[t]===n)return!0;return!1}function C(e,n,t,r,i){if(!p(e)){var o=t[lr]=t[lr]||{},a=o[n]=o[n]||{};!1!==o[gr]&&(o[gr]=!!i),h(t,function(n){m(t,n,!1)&&t[n]!==r[n]&&(a[n]=t[n],delete t[n],(!d(e,n)||e[n]&&!e[n][fr])&&(e[n]=function(e,n){var t=function(){return(function(e,n,t,r){var i=null;if(e&&d(t,dr)){var o=e[lr]||{};if((i=(o[t[dr]]||{})[n])||y("Missing ["+n+"] "+ur),!i[vr]&&!1!==o[gr]){for(var a=!d(e,n),s=g(e),c=[];a&&s&&!v(s)&&!b(c,s);){var u=s[n];if(u){a=u===r;break}c.push(s),s=g(s)}try{a&&(e[n]=i),i[vr]=1}catch(e){o[gr]=!1}}}return i}(this,n,e,t)||function(e,n,t){var r=n[e];return r===t&&(r=g(n)[e]),typeof r!==ur&&y("["+e+"] is not a "+ur),r}(n,e,t)).apply(this,arguments)};return t[fr]=1,t}(e,n)))})}}function S(e,n){return d(e,cr)?e.name||n||mr:((e||{})[sr]||{}).name||n||mr}function w(e,n,t,r){d(e,cr)||y("theClass is an invalid class definition.");var i=e[cr];(function(e,n){if(kr){for(var t=[],r=g(n);r&&!v(r)&&!b(t,r);){if(r===e)return!0;t.push(r),r=g(r)}return!1}return!0})(i,n)||y("["+S(e)+"] not in hierarchy of ["+S(n)+"]");var o=null;d(i,dr)?o=i[dr]:(o=pr+S(e,"_")+"$"+Ar.n,Ar.n++,i[dr]=o);var a=w[hr],s=!!a[wr];s&&r&&void 0!==r[wr]&&(s=!!r[wr]);var c=function(e){var n={};return h(e,function(t){!n[t]&&m(e,t,!1)&&(n[t]=e[t])}),n}(n);t(n,function(e,n,t,r){function i(e,n,t){var i=n[t];if(i[fr]&&r){var o=e[lr]||{};!1!==o[gr]&&(i=(o[n[dr]]||{})[t]||i)}return function(){return i.apply(e,arguments)}}var o={};h(t,function(e){o[e]=i(n,t,e)});for(var a=g(e),s=[];a&&!v(a)&&!b(s,a);)h(a,function(e){!o[e]&&m(a,e,!kr)&&(o[e]=i(n,a,e))}),s.push(a),a=g(a);return o}(i,n,c,s));var u=!!kr&&!!a[Pr];u&&r&&(u=!!r[Pr]),C(i,o,n,c,!1!==u)}function P(e){return void 0===e||typeof e===Wt}function T(e){return null===e||P(e)}function k(e){return!T(e)}function I(e){return!(!e||typeof e!==qt)}function x(e){return!(!e||typeof e!==Vt)}function A(e){var n=e;return n&&U(n)&&(n=(n=(n=n[mi](go,function(e,n){return n.toUpperCase()}))[mi](ho,"_"))[mi](mo,function(e,n){return"_"+n})),n}function L(e,n){if(e)for(var t in e)nr[Si](e,t)&&n[Si](e,t,e[t])}function O(e,n){var t=!1;return e&&n&&!(t=e===n)&&(t=co?e[Ji](n):function(e,n){var t=!1,r=n?n[Hr]:0;if(e&&r&&e[Hr]>=r&&!(t=e===n)){for(var i=0;i<r;i++)if(e[i]!==n[i])return!1;t=!0}return t}(e,n)),t}function E(e,n){return!(!e||!n)&&-1!==e[ui](n)}function U(e){return"string"==typeof e}function _(e){return"number"==typeof e}function M(e){return"boolean"==typeof e}function D(e){var n=!1;if(e&&"object"==typeof e){var t=yo?yo(e):function(e){if(e){if(yo)return yo(e);var n=e[eo]||e[Kt]||e[no];if(n)return n}return null}(e);t?(t[no]&&nr[Si](t,no)&&(t=t[no]),n=typeof t===Vt&&po[Si](t)===vo):n=!0}return n}function B(e){if(e)return uo?e[Ki]():function(e){if(e&&e.getUTCFullYear){var n=function(e){var n=String(e);return 1===n[Hr]&&(n="0"+n),n};return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function R(e,n,t){var r=e[Hr];try{for(var i=0;i<r&&(!(i in e)||-1!==n[Si](t||e,e[i],i,e));i++);}catch(e){}}function F(e,n,t){if(e){if(e[$i])return e[$i](n,t);var r=e[Hr],i=t||0;try{for(var o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===n)return o}catch(e){}}return-1}function N(e){return e&&(e=ao&&e[Zi]?e[Zi]():e[mi]?e[mi](/^\s+|(?=\s)\s+$/g,Ui):e),e}function H(e){var n=typeof e;if(n===Vt||n===qt&&null!==e||c("objKeys called on non-object"),!Co&&io)return io(e);var t=[];for(var r in e)e&&nr[Si](e,r)&&t[Dr](r);if(Co)for(var i=So[Hr],o=0;o<i;o++)e&&nr[Si](e,So[o])&&t[Dr](So[o]);return t}function G(e,n,t,r){if(to)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),r&&(i.set=r),to(e,n,i),!0}catch(e){}return!1}function z(e){return ro&&L(e,function(e,n){(bo(n)||I(n))&&ro(n)}),wo(e)}function j(){var e=Date;return e.now?e.now():(new e).getTime()}function X(e){return(n=e)&&"[object Error]"===fo[Si](n)?e[Ur]:Ui;var n}function V(e,n,t,r,i){var o=t;return e&&((o=e[n])===t||i&&!i(o)||r&&!r(t)||(o=t,e[n]=o)),o}function q(e,n,t){var r;return e?!(r=e[n])&&T(r)&&(r=P(t)?{}:t,e[n]=r):r=P(t)?{}:t,r}function W(e,n){return T(e)?n:e}function K(e){return!!e}function Q(e){throw new Error(e)}function J(e,n,t,r,i){e&&n&&t&&(!1!==i||P(e[n]))&&(e[n]=function(e,n){var t=null,r=null;return x(e)?t=e:r=e,function(){var e=arguments;if(t&&(r=t()),r)return r[n][hi](r,e)}}(t,r))}function $(e){return e&&Zt&&(e=Jt(Zt({},e))),e}function Z(e,n,t,r,i,o){var a=arguments,s=a[0]||{},c=a[Hr],u=!1,l=1;for(c>0&&M(s)&&(u=s,s=a[l]||{},l++),I(s)||(s={});l<c;l++){var f=a[l],d=bo(f),p=I(f);for(var v in f)if(d&&v in f||p&&nr[Si](f,v)){var g=f[v],h=void 0;if(u&&g&&((h=bo(g))||D(g))){var m=s[v];h?bo(m)||(m=[]):D(m)||(m={}),g=Z(u,m,g)}void 0!==g&&(s[v]=g)}}return s}function Y(e,n,t,r,i){if(e){var o=e;if(o[Wi]&&(o=o[Wi]()),o){var a=void 0,s=o[Ii](Lo);try{if(a=o.create(n(),r,i)){if(s&&a[xi]&&(a[xi](xo[To],s),s[Ii]&&s[xi])){var c=s[Ii](xo[ko]);c||(c=[],s[xi](xo[ko],c)),c[Dr](a)}return o[xi](Lo,a),t(a)}}catch(e){a&&a[xi]&&a[xi]("exception",e)}finally{a&&o.fire(a),o[xi](Lo,s)}}}return t()}function ee(e,n){var t=!1;if(e){try{if(!(t=n in e)){var r=e[Kt];r&&(t=n in r)}}catch(e){}if(!t)try{t=!P((new e)[n])}catch(e){}}return t}function ne(e){var n=s();return n&&n[e]?n[e]:e===Oo&&te()?window:null}function te(){return Boolean(typeof window===qt&&window)}function re(){return te()?window:ne(Oo)}function ie(){return Boolean(typeof document===qt&&document)}function oe(){return ie()?document:ne(Eo)}function ae(){return Boolean(typeof navigator===qt&&navigator)}function se(){return ae()?navigator:ne(Uo)}function ce(e){if(e&&Xo){var n=ne("__mockLocation");if(n)return n}return typeof location===qt&&location?location:ne(_o)}function ue(){return Boolean(typeof JSON===qt&&JSON||null!==ne(Do))}function le(){return ue()?JSON||ne(Do):null}function fe(){var e=se();return!(!e||!e.product)&&e.product===Fo}function de(){var e=se();if(e&&(e[fi]!==jo||null===zo)){var n=((jo=e[fi])||Ui)[Ci]();zo=E(n,No)||E(n,Ho)}return zo}function pe(e){var n=Object[Kt].toString[Si](e),t=Ui;return"[object Error]"===n?t="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[Ur]+"'":ue()&&(t=le().stringify(e)),n+t}function ve(){return null===qo&&(qo=ae()&&Boolean(se().sendBeacon)),qo}function ge(e){var n=!1;try{n=!!ne("fetch");var t=ne("Request");n&&e&&t&&(n=ee(t,"keepalive"))}catch(e){}return n}function he(){var e=!1;try{e=!!ne(Go)}catch(e){}return e}function me(e,n){return function(){var t=arguments,r=ye(n);if(r){var i=r.listener;i&&i[e]&&i[e][hi](i,t)}}}function ye(e){var n,t=Ko;return t||!0===e.disableDbgExt||(t=Ko||((n=ne("Microsoft"))&&(Ko=n.ApplicationInsights),Ko)),t?t.ChromeDbgExt:null}function be(e){if(!Lr){Lr={};for(var n=0;n<Wo[Hr];n++)Lr[Wo[n]]=me(Wo[n],e)}return Lr}function Ce(e){return e?'"'+e[mi](/\"/g,Ui)+'"':Ui}function Se(e,n){var t=typeof console!==Wt?console:ne(Mo);if(t){var r="log";t[e]&&(r=e),x(t[r])&&t[r](n)}}function we(e,n){return(e||{})[Nr]||new Yo(n)}function Pe(e){return e||new Yo}function Te(e,n,t,r,i,o){void 0===o&&(o=!1),Pe(e).throwInternal(n,t,r,i,o)}function ke(e,n){Pe(e)[qi](n)}function Ie(){try{var e=2147483647&j();(n=(Math.random()*ea^e)+e)<0&&(n>>>=0),ra=123456789+n&na,ia=987654321-n&na,ta=!0}catch(e){}var n}function xe(e){var n=0,t=ne(Bo)||ne(Ro);return t&&t.getRandomValues&&(n=t.getRandomValues(new Uint32Array(1))[0]&na),0===n&&de()&&(ta||Ie(),n=function(e){var n=((ia=36969*(65535&ia)+(ia>>16)&na)<<16)+(65535&(ra=18e3*(65535&ra)+(ra>>16)&na))>>>0&na|0;return n>>>=0}()&na),0===n&&(n=Math.floor(ea*Math.random()|0)),e||(n>>>=0),n}function Ae(e){void 0===e&&(e=22);for(var n=xe()>>>0,t=0,r=Ui;r[Hr]<e;)t++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&n),n>>>=6,5===t&&(n=(xe()<<2&4294967295|3&n)>>>0,t=0);return r}function Le(e){return 1===e[gi]||9===e[gi]||!+e[gi]}function Oe(e,n){return void 0===n&&(n=!1),A(e+ca+++(n?"."+aa:Ui)+sa)}function Ee(e){var n={id:Oe("_aiData-"+(e||Ui)+"."+aa),accept:function(e){return Le(e)},get:function(e,t,r,i){var o=e[n.id];return o?o[A(t)]:(i&&((o=function(e,n){var t=n[e.id];if(!t){t={};try{Le(n)&&(function(e,n,t){if(oa)try{return oa(e,n,{value:t,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(n,e.id,t)||(n[e.id]=t))}catch(e){}}return t}(n,e))[A(t)]=r),r)},kill:function(e,n){if(e&&e[n])try{delete e[n]}catch(e){}}};return n}function Ue(e,n,t){return!(!e||e[Hr]!==n||e===t||!e.match(/^[\da-f]*$/))}function _e(e){return Ue(e,32,ua)}function Me(e){return Ue(e,16,la)}function De(e){return fa.get(e,"state",{},!0)}function Be(e,n){for(var t,r=[],i=null,o=e[ii]();o;){var a=o[Kr]();a&&(i&&x(i[ai])&&x(a[Ni])&&i[ai](a),(x(a[Br])?a[Br]():(t=De(a))[Br])||r[Dr](a),i=a,o=o[ii]())}R(r,function(r){var i=e[Mi]();r[Er](e.getCfg(),i,n,e[ii]()),t=De(r),r[Mi]||t[Mi]||(t[Mi]=i),t[Br]=!0,delete t[Zr]})}function Re(e){return e.sort(function(e,n){var t=0;if(n){var r=x(n[Ni]);x(e[Ni])?t=r?e[Hi]-n[Hi]:1:r&&(t=-1)}else t=e?1:-1;return t})}function Fe(e,n,t,r){function i(e,t,r){var i;if(void 0===t&&(t={}),void 0===r&&(r=0),n){var o=n[Ri];o&&e&&(i=o[e])}if(i){if(I(t)&&0!==r){var a=Z(!0,t,i);n&&2===r&&L(t,function(e){if(T(a[e])){var t=n[e];T(t)||(a[e]=t)}}),i=a}}else i=t;return i}var o=null,a=[];null!==r&&(o=r?function(e,n,t){for(;e;){if(e[Kr]()===t)return e;e=e[ii]()}return ze([t],n[Rr]||{},n)}(e,t,r):e);var s={_next:function(){var e=o;if(o=e?e[ii]():null,!e){var n=a;n&&n[Hr]>0&&(R(n,function(e){try{e.func[Si](e.self,e.args)}catch(e){Te(t[Nr],2,73,"Unexpected Exception during onComplete - "+pe(e))}}),a=[])}return e},ctx:{core:function(){return t},diagLog:function(){return we(t,n)},getCfg:function(){return n},getExtCfg:i,getConfig:function(e,t,r){void 0===r&&(r=!1);var o,a=i(e,null);return a&&!T(a[t])?o=a[t]:n&&!T(n[t])&&(o=n[t]),T(o)?r:o},hasNext:function(){return!!o},getNext:function(){return o},setNext:function(e){o=e},iterate:function(e){for(var n;n=s._next();){var t=n[Kr]();t&&e(t)}},onComplete:function(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];e&&a[Dr]({func:e,self:P(n)?s.ctx:n,args:t})}}};return s}function Ne(e,n,t,r){var i=Fe(e,n,t,r),o=i.ctx;return o[zr]=function(e){var n=i._next();return n&&n[Ni](e,o),!n},o[si]=function(e,r){return void 0===e&&(e=null),bo(e)&&(e=ze(e,n,t,r)),Ne(e||o[ii](),n,t,r)},o}function He(e,n,t){var r=n[Rr]||{},i=Fe(e,r,n,t),o=i.ctx;return o[zr]=function(e){var n=i._next();return n&&n.unload(o,e),!n},o[si]=function(e,t){return void 0===e&&(e=null),bo(e)&&(e=ze(e,r,n,t)),He(e||o[ii](),n,t)},o}function Ge(e,n,t){var r=n[Rr]||{},i=Fe(e,r,n,t).ctx;return i[zr]=function(e){return i.iterate(function(n){x(n[ri])&&n[ri](i,e)})},i[si]=function(e,t){return void 0===e&&(e=null),bo(e)&&(e=ze(e,r,n,t)),Ge(e||i[ii](),n,t)},i}function ze(e,n,t,r){var i=null,o=!r;if(bo(e)&&e[Hr]>0){var a=null;R(e,function(e){if(o||r!==e||(o=!0),o&&e&&x(e[Ni])){var s=function(e,n,t){function r(n,t,r,a,s){var c=!1,u=e?e[Mr]:da,l=n[pa];return l||(l=n[pa]={}),n.setNext(o),e&&Y(n[Mi](),function(){return u+":"+r},function(){l[i]=!0;try{var e=o?o._id:Ui;e&&(l[e]=!1),c=t(n)}catch(e){var a=!o||l[o._id];a&&(c=!0),o&&a||Te(n[oi](),1,73,"Plugin ["+u+"] failed during "+r+" - "+pe(e)+", run flags: "+pe(l))}},a,s),c}var i,o=null,a=x(e[Ni]),s=x(e[ai]),c={getPlugin:function(){return e},getNext:function(){return o},processTelemetry:function(i,u){r(u=u||function(){var r;return e&&x(e[va])&&(r=e[va]()),r||(r=Ne(c,n,t)),r}(),function(n){if(!e||!a)return!1;var t=De(e);return!t[Zr]&&!t[Bi]&&(s&&e[ai](o),e[Ni](i,n),!0)},"processTelemetry",function(){return{item:i}},!i.sync)||u[zr](i)},unload:function(n,t){r(n,function(){var r=!1;if(e){var i=De(e),o=e[Mi]||i[Mi];!e||o&&o!==n.core()||i[Zr]||(i[Mi]=null,i[Zr]=!0,i[Br]=!1,e[Zr]&&!0===e[Zr](n,t)&&(r=!0))}return r},"unload",function(){},t[ni])||n[zr](t)},update:function(n,t){r(n,function(){var r=!1;if(e){var i=De(e),o=e[Mi]||i[Mi];!e||o&&o!==n.core()||i[Zr]||e[ri]&&!0===e[ri](n,t)&&(r=!0)}return r},"update",function(){},!1)||n[zr](t)},_id:i=e?e[Mr]+"-"+e[Hi]+"-"+ga++:"Unknown-0-"+ga++,_setNext:function(e){o=e}};return wo(c)}(e,n,t);i||(i=s),a&&a._setNext(s),a=s}})}return r&&!i?ze([r],n,t):i}function je(e,n,t){n&&bo(n)&&n[Hr]>0&&(R(n=n.sort(function(e,n){return e[Hi]-n[Hi]}),function(e){e[Hi]<ha&&Q(ma+e[Mr])}),e[Dr]({queue:wo(n),chain:ze(n,t[Rr],t)}))}function Xe(e){return!e||e.isEnabled()}function Ve(e,n){return!!(n&&e&&bo(e.ignoreCookies))&&-1!==e.ignoreCookies[ui](n)}function qe(e,n){var t;if(e)t=e.getCookieMgr();else if(n){var r=n[ci];t=r[ka]?r[ka]:We(n)}return t||(t=function(e,n){var t=We[ka]||Ea[ka];return t||(t=We[ka]=We(e,n),Ea[ka]=t),t}(n,(e||{})[Nr])),t}function We(e,n){var t,r=function(e){var n=e[ci]=e[ci]||{};if(V(n,"domain",e.cookieDomain,k,T),V(n,"path",e.cookiePath||"/",null,T),T(n[wa])){var t=void 0;P(e[Pa])||(t=!e[Pa]),P(e[Ta])||(t=!e[Ta]),n[wa]=t}return n}(e||Ea),i=r.path||"/",o=r.domain,a=!1!==r[wa],s=((t={isEnabled:function(){var e=a&&Ke(n),t=Ea[ka];return e&&t&&s!==t&&(e=Xe(t)),e}})[pi]=function(e){a=!1!==e},t.set=function(e,n,t,a,c){var u,l=!1;if(Xe(s)&&!function(e,n){return!!(n&&e&&bo(e.blockedCookies)&&-1!==e.blockedCookies[ui](n))||Ve(e,n)}(r,e)){var f={},d=N(n||Ui),p=d[ui](";");if(-1!==p&&(d=N(n[li](0,p)),f=Qe(n[li](p+1))),V(f,"domain",a||o,K,P),!T(t)){var v=de();if(P(f[Sa])){var g=j()+1e3*t;if(g>0){var h=new Date;h.setTime(g),V(f,Sa,Je(h,v?ya:ba)||Je(h,v?ya:ba)||Ui,K)}}v||V(f,"max-age",Ui+t,null,P)}var m=ce();m&&"https:"===m.protocol&&(V(f,"secure",null,null,P),null===xa&&(u=(se()||{})[fi],xa=!(U(u)&&(E(u,"CPU iPhone OS 12")||E(u,"iPad; CPU OS 12")||E(u,"Macintosh; Intel Mac OS X 10_14")&&E(u,"Version/")&&E(u,"Safari")||E(u,"Macintosh; Intel Mac OS X 10_14")&&function(e,n){var t=!1;return e&&n&&!(t=e===n)&&(t=so?e[Qi](n):function(e,n){var t=!1,r=n[Hr],i=e?e[Hr]:0;if(r&&i&&i>=r&&!(t=e===n)){for(var o=i-1,a=r-1;a>=0;a--){if(e[o]!=n[a])return!1;o--}t=!0}return t}(e,n)),t}(u,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||E(u,"Chrome/5")||E(u,"Chrome/6")||E(u,"UnrealEngine")&&!E(u,"Chrome")||E(u,"UCBrowser/12")||E(u,"UCBrowser/11")))),xa&&V(f,"SameSite","None",null,P)),V(f,"path",c||i,null,P),(r.setCookie||Ye)(e,$e(d,f)),l=!0}return l},t.get=function(e){var n=Ui;return Xe(s)&&!Ve(r,e)&&(n=(r.getCookie||Ze)(e)),n},t.del=function(e,n){var t=!1;return Xe(s)&&(t=s.purge(e,n)),t},t.purge=function(e,t){var i,o=!1;if(Ke(n)){var a=((i={}).path=t||"/",i[Sa]="Thu, 01 Jan 1970 00:00:01 GMT",i);de()||(a["max-age"]="0"),(r.delCookie||Ye)(e,$e(Ui,a)),o=!0}return o},t);return s[ka]=s,s}function Ke(e){if(null===Ia){Ia=!1;try{Ia=void 0!==(La||{})[Ca]}catch(n){Te(e,2,68,"Cannot access document.cookie - "+X(n),{exception:pe(n)})}}return Ia}function Qe(e){var n={};return e&&e[Hr]&&R(N(e)[di](";"),function(e){if(e=N(e||Ui)){var t=e[ui]("=");-1===t?n[e]=null:n[N(e[li](0,t))]=N(e[li](t+1))}}),n}function Je(e,n){return x(e[n])?e[n]():null}function $e(e,n){var t=e||Ui;return L(n,function(e,n){t+="; "+e+(T(n)?Ui:"="+n)}),t}function Ze(e){var n=Ui;if(La){var t=La[Ca]||Ui;Aa!==t&&(Oa=Qe(t),Aa=t),n=N(Oa[e]||Ui)}return n}function Ye(e,n){La&&(La[Ca]=e+"="+n)}function en(){var e=[];return{add:function(n){n&&e[Dr](n)},run:function(n,t){R(e,function(e){try{e(n,t)}catch(e){Te(n[oi](),2,73,"Unexpected error calling unload handler - "+pe(e))}}),e=[]}}}function nn(e,n){return new Ao(n)}function tn(e,n){var t=!1;return R(n,function(n){if(n===e)return t=!0,-1}),t}function rn(e,n,t,r){R(e,function(e){if(e&&e[n])if(t)setTimeout(function(){return r(e)},0);else try{r(e)}catch(e){}})}function on(e){return e&&e[mi]?e[mi](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Ui):e}function an(e,n){var t;if(n){var r=Ui;bo(n)?(r=Ui,R(n,function(e){(e=on(e))&&("."!==e[0]&&(e="."+e),r+=e)})):r=on(n),r&&("."!==r[0]&&(r="."+r),e=(e||Ui)+r)}var i=ls.exec(e||Ui)||[];return(t={})[wi]=i[1],t.ns=(i[2]||Ui).replace(as,".").replace(ss,Ui)[di](".").sort().join("."),t}function sn(e,n,t){void 0===t&&(t=!0);var r=us.get(e,Za,{},t),i=r[n];return i||(i=r[n]=[]),i}function cn(e,n,t,r){e&&n&&n[wi]&&(e[$a]?e[$a](n[wi],t,r):e[Ja]&&e[Ja](Wa+n[wi],t))}function un(e,n,t,r){for(var i=n[Hr];i--;){var o=n[i];o&&(t.ns&&t.ns!==o.evtName.ns||r&&!r(o)||(cn(e,o.evtName,o[Pi],o.capture),n[$r](i,1)))}}function ln(e,n){return n?an("xx",bo(n)?[e].concat(n):[e,n]).ns[di]("."):e}function fn(e,n,t,r,i){var o;void 0===i&&(i=!1);var a=!1;if(e)try{var s=an(n,r);if((a=function(e,n,t,r){var i=!1;return e&&n&&n[wi]&&t&&(e[Qa]?(e[Qa](n[wi],t,r),i=!0):e[Ka]&&(e[Ka](Wa+n[wi],t),i=!0)),i}(e,s,t,i))&&us.accept(e)){var c=((o={guid:cs++,evtName:s})[Pi]=t,o.capture=i,o);sn(e,s.type)[Dr](c)}}catch(e){}return a}function dn(e,n,t,r,i){if(void 0===i&&(i=!1),e)try{var o=an(n,r),a=!1;!function(e,n,t){if(n[wi])un(e,sn(e,n[wi]),n,t);else{var r=us.get(e,Za,{});L(r,function(r,i){un(e,i,n,t)}),0===H(r)[Hr]&&us.kill(e,Za)}}(e,o,function(e){return!((!o.ns||t)&&e[Pi]!==t||(a=!0,0))}),a||cn(e,o,t,i)}catch(e){}}function pn(e,n,t,r){var i=!1;return n&&e&&e[Hr]>0&&R(e,function(e){e&&(t&&-1!==F(t,e)||(i=function(e,n,t){var r=!1,i=re();i&&(r=fn(i,e,n,t),r=fn(i.body,e,n,t)||r);var o=oe();return o&&(r=fn(o,e,n,t)||r),r}(e,n,r)||i))}),i}function vn(e,n,t){e&&bo(e)&&R(e,function(e){e&&function(e,n,t){var r=re();r&&(dn(r,e,n,t),dn(r.body,e,n,t));var i=oe();i&&dn(i,e,n,t)}(e,n,t)})}function gn(e,n,t){var r=ln(is,t),i=pn([es],e,n,r);return n&&-1!==F(n,Ya)||(i=pn([Ya],function(n){var t=oe();e&&t&&"hidden"===t.visibilityState&&e(n)},n,r)||i),!i&&n&&(i=gn(e,null,t)),i}function hn(e,n,t){var r=ln(os,t),i=pn([ns],e,n,r);return!(i=pn([Ya],function(n){var t=oe();e&&t&&"visible"===t.visibilityState&&e(n)},n,r)||i)&&n&&(i=hn(e,null,t)),i}function mn(){var e=yn();return e[li](0,8)+"-"+e[li](8,12)+"-"+e[li](12,16)+"-"+e[li](16,20)+"-"+e[li](20)}function yn(){for(var e,n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],t=Ui,r=0;r<4;r++)t+=n[15&(e=xe())]+n[e>>4&15]+n[e>>8&15]+n[e>>12&15]+n[e>>16&15]+n[e>>20&15]+n[e>>24&15]+n[e>>28&15];var i=n[8+(3&xe())|0];return t[vi](0,8)+t[vi](9,4)+"4"+t[vi](13,3)+i+t[vi](16,3)+t[vi](19,12)}function bn(e){return!(e===ja||T(e))}function Cn(e,n,t){var r=-1;if(!P(e))if(n>0&&(32===n?r=8192:n<=13&&(r=n<<5)),function(e){return e>=0&&e<=9}(t))-1===r&&(r=0),r|=t;else{var i=gs[kn(e)]||-1;-1!==r&&-1!==i?r|=i:6===i&&(r=i)}return r}function Sn(e,n,t){var r;return void 0===t&&(t=!0),e&&(r=e.get(n),t&&r&&decodeURIComponent&&(r=decodeURIComponent(r))),r||ja}function wn(e){void 0===e&&(e="D");var n=mn();return"B"===e?n="{"+n+"}":"P"===e?n="("+n+")":"N"===e&&(n=n.replace(/-/g,ja)),n}function Pn(e,n,t,r,i){var o={},a=!1,s=0,c=arguments.length,u=arguments;for("[object Boolean]"===Object[Kt].toString.call(u[0])&&(a=u[0],s++);s<c;s++)L(u[s],function(e,n){a&&n&&I(n)?bo(n)?(o[e]=o[e]||[],R(n,function(n,t){n&&I(n)?o[e][t]=Pn(!0,o[e][t],n):o[e][t]=n})):o[e]=Pn(!0,o[e],n):o[e]=n});return o}function Tn(e,n){var t=e;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[n]=bs()}function kn(e){var n=0;if(null!=e){var t=typeof e;"string"===t?n=1:"number"===t?n=2:"boolean"===t?n=3:t===qt&&(n=4,bo(e)?(n=4096,e.length>0&&(n|=kn(e[0]))):nr.call(e,"value")&&(n=8192|kn(e.value)))}return n}function In(e){var n={};return L(e,function(e,t){n[e]=t[1],n[t[0]]=t[1]}),z(n)}function xn(){return void 0===hs&&(hs=!!Ln(0)),hs}function An(){return xn()?Ln(0):null}function Ln(e){var n,t,r=null;try{var i=s();if(!i)return null;t=new Date,(r=0===e?i.localStorage:i.sessionStorage)&&x(r.setItem)&&(r.setItem(t,t),n=r.getItem(t)!==t,r.removeItem(t),n&&(r=null))}catch(e){r=null}return r}function On(){return this.getId()}function En(e){this.setId(e)}function Un(e,n){void 0===n&&(n=Ns);var t=null;if(e)for(var r=e.split(","),i=0;i<r.length;i++)_n(r[i],n)&&(t?t+=","+r[i]:t=r[i]);return t}function _n(e,n){if(void 0===n&&(n=Ns),!e||e.length<4)return!1;for(var t=!1,r=e.substring(0,3).toString().toUpperCase(),i=0;i<n.length;i++)if(n[i]+":"===r&&e.length<=256){t=!0;break}return t}function Mn(){return this.getExpId()}function Dn(){return this.getMsfpc()}function Bn(){return this.getAnid()}function Rn(e,n){var t=e.match(new RegExp(n+" "+Ws));return t?qs[t[1]]?qs[t[1]]:t[1]:Qs}function Fn(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}function Nn(){return this.getLocalId()}function Hn(e){this[nc](e)}function Gn(e,n){return n.indexOf(e)>-1}function zn(e,n){for(var t=0;t<n.length;t++)if(e==n[t].brand)return n[t].version;return null}function jn(){return this.getUserConsent()}function Xn(e,n,t,r,i){var o=n.ext[ws[e]];return o&&L(r,function(e,n){if(U(n)||_(n)||M(n)){var r=o[t[e]];!i&&(r||U(r)||_(r)||M(r))&&(n=r),o[t[e]]=n}}),o}function Vn(e){var n=(e.ext||{}).intweb;return n&&bn(n[Hc])?n[Hc]:null}function qn(e){for(var n=null,t=0;null===n&&t<e.length;t++)n=Vn(e[t]);return n}function Wn(e){var n,t=Qc*Wc,r=Qc*Kc,i=Math.floor(Math.random()*(r-t))+t;return n=Math.pow(2,e)*i,Math.min(n,Jc)}function Kn(e,n,t,r){if(r&&e){var i=Cn(r.value,r.kind,r.propertyType);if(i>-1){var o=e[tu];o||(o=e[tu]={f:{}});var a=o[ru];if(a||(a=o[ru]={}),n)for(var s=0;s<n.length;s++){var c=n[s];a[c]||(a[c]={f:{}});var u=a[c][ru];u||(u=a[c][ru]={}),a=u}a=a[t]={},bo(r.value)?a.a={t:i}:a.t=i}}}function Qn(e,n,t){uu[e]=n,!1!==t&&(lu[n]=e)}function Jn(e){try{return e.responseText}catch(e){}return mc}function $n(e,n){var t,r,i=!1;if(e&&n){var o=H(e);if(o&&o.length>0)for(var a=n.toLowerCase(),s=0;s<o.length;s++){var c=o[s];if(c&&(r=c,(t=n)&&nr[Si](t,r))&&c.toLowerCase()===a){i=!0;break}}}return i}function Zn(e,n,t,r){n&&t&&t.length>0&&(r&&uu[n]?(e.hdrs[uu[n]]=t,e.useHdrs=!0):e.url+="&"+n+"="+t)}function Yn(e,n){return n&&(_(n)?e=[n].concat(e):bo(n)&&(e=n.concat(e))),e}function et(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout(e,n,t)}function nt(e){clearTimeout(e)}function tt(e,n){return{set:e||et,clear:n||nt}}function rt(e,n){var t=new Map,r=e.telemetryCollectorUrlOneDs,i=function(t){var i=e.app,o={disableCookiesUsage:!0,instrumentationKey:t,extensions:[],extensionConfig:[],channelConfiguration:{autoFlushEventsLimit:50,ignoreMc1Ms0CookieProcessing:!0,overrideEndpointUrl:r},propertyConfiguration:{serviceName:i,sessionAsGuid:!0,populateBrowserInfo:!0}},a=new xu;return a.initialize(o,[]),function(){var t=e.culture,r=e.region,i=e.clientType,o=e.clientContextType,a=e.complianceEnvironment,s=e.versionOverride,c=e.hostAppRing,u=e.hostAppVersion,l=e.app,f=e.platform,d=e.isConsumer,p=void 0!==d&&d,v=e.clientCorrelationId;n.setContextProperty("culture",t),n.setContextProperty("region",r),n.setContextProperty("clientType",i),n.setContextProperty("clientContextType",o),n.setContextProperty("bootstrapperVersion",Lu),n.setContextProperty("complianceEnvironment",a),n.setContextProperty("isConsumer",JSON.stringify(p)),n.setContextProperty("versionOverride",s||""),n.setContextProperty("hostAppRing",c||""),n.setContextProperty("hostAppVersion",u||""),l&&n.setContextProperty("app",l),f&&n.setContextProperty("platform",f),n.setContextProperty("clientCorrelationId",v)}(),a},o=function(e,o){var a=t.get(e);a||(a=i(e));var s=n.createTelemetryEvent(o,function(){return!r});a.track(s),a.flush()};return{logEvent:o,logVerboseEvent:function(n,t){e.enableVerboseLogging&&o(n,t)},updateContextWithLokiConfig:function(e,o){var a=o.ClientTelemetryCollectorUrls;(null==a?void 0:a.OneDs)&&(r=a.OneDs),t.get(e)||t.set(e,i(e));var s=o.LokiUrl,c=o.Flights,u=o.Settings,l=o.TenantAadObjectId,f=o.UserAadObjectId,d=o.UserPuid;s&&n.setContextProperty("lokiUrl",s),c&&n.setContextProperty("flights",c.join(",")),d&&n.setContextProperty("userPuid",d),f&&n.setContextProperty("userAadObjectId",f),l&&n.setContextProperty("tenantAadObjectId",l),u&&n.setContextProperty("settings",JSON.stringify(u))}}}function it(e,n){var t=new URL(Eu),r=n&&n!==Du&&"/"!==n?new URL(n):void 0,i=new URL(e,document.baseURI).origin;if(i===t.origin||r&&i===r.origin||function(e){return Mu.includes(e)}(i)||Uu.test(i))return e;throw new Error("TrustedType policy does not allow loading scripts from ".concat(i,", only from ").concat(t.origin,", ").concat(null==r?void 0:r.origin," and localhost."))}function ot(){if(void 0===fu&&(fu=null,"undefined"!=typeof self&&self.trustedTypes))try{fu=self.trustedTypes.createPolicy("@1js/midgard-trusted-types",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e,n){return void 0===n&&(n=_u),it(e,n)}})}catch(e){}return fu}function at(e,n,t,r,i){return new Promise(function(o,a){n||a(new bt("StartLivePersonaCardError","targetWindow is undefined in appendScriptToDocumentAsync"));var s=n.document.querySelectorAll("script[".concat(Nu,"]"));if(r&&2===s.length)o();else{var c=function(e,n,t){void 0===n&&(n=_u),void 0===t&&(t=!0);var r,i=null,o=ot();try{i=t&&o?o.createScriptURL(e,n):it(e,n)}catch(e){r=e.message}return{error:r,url:i,trustedTypeAvailable:!!o}}(e,gt.p,t);if(c.error)return a(new bt("LoadScriptError",c.error));var u=n.document.createElement("script");u.type="text/javascript",u.charset="utf-8",u.setAttribute(Nu,""),u.crossOrigin="anonymous",u.src=c.url,u.addEventListener("load",function(){i&&i({name:"LoadScriptSuccess",properties:{isLPCDefined:!!n.LPC,lpcWindowId:n.lpcWindowId}}),o()}),u.addEventListener("error",function(){i&&i({name:"LoadScriptFailure",properties:{isLPCDefined:!!n.LPC,lpcWindowId:n.lpcWindowId}}),a(new bt("LoadScriptError","Unexpected error while loading script on page, lpcWindowId:"+n.lpcWindowId))}),n.document.body.appendChild(u)}})}function st(e){var n,t=e.targetWindow||window,i=Gu.get(t);return i?i.bootstrapperConfig=Hu(Hu({},i.bootstrapperConfig),e):(i={bootstrapperConfig:Hu(Hu({},e),{targetWindow:t}),oneDsLogger:rt(e,(n={},{setContextProperty:function(e,t){n[e]=t},getContextProperties:function(){return n},createTelemetryEvent:function(e,t){var r=Ou({},e);r.properties=Object.assign(r.properties,n);var i=function(e,n,t,r){return(jt(r)?r(e):r)?a(e,n,t):e}(r,Au,function(e){var n;return(n={})[e]="EUPI_SCRUBBED",n},t);return{name:i.name,data:Ou({},i.properties)}}})),initializationPromise:void 0,lpeInitializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshLpeInitializationPromise:!1,forceRefreshInitializationTimeout:void 0,abandonInitializationPromise:void 0},i.bootstrapperConfig.targetWindow.lpcWindowId=r()),Gu.set(t,i),i}function ct(e,n,t){return zu(this,void 0,void 0,function(){var r,i;return ju(this,function(o){switch(o.label){case 0:return(i=st(n)).lpcConfig?(r=i.lpcConfig,[3,3]):[3,1];case 1:return[4,ut(e,n,t)];case 2:r=o.sent(),i.lpcConfig=r,o.label=3;case 3:return[2,r]}})})}function ut(e,n,r){return zu(this,void 0,void 0,function(){var i,a;return ju(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,8]),[4,o(e,n,r)];case 1:return i=s.sent(),[3,8];case 2:return(a=s.sent()).statusCode&&401===a.statusCode?[4,t(void 0,n.getAuthToken,r)]:[3,4];case 3:e=s.sent(),s.label=4;case 4:return Vu<Xu?(Vu++,[4,ut(e,n,r)]):[3,6];case 5:return i=s.sent(),[3,7];case 6:throw a.numberOfRetries=Vu,a;case 7:return[3,8];case 8:return[2,i]}})})}function lt(e,n,t,r,i){var o=e.ResourceUrls||[];if(0===o.length){var a=e.Resources?e.Resources[Ku]:"",s=e.Resources?null==e?void 0:e.Resources[qu]:"";"OwaPeopleHub"===e.Workload&&(s=e.Resources?e.Resources[Wu]:""),o=[a,s].filter(function(e){return""!==e})}return Promise.all(o.map(function(e){return function(e,n,t,r,i){var o=this;void 0===r&&(r=!1),void 0===i&&(i=!1);var a=0,s=function(e,n){return Bu(o,void 0,void 0,function(){var o;return Ru(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,6]),[4,at(e,n,r,i,t)];case 1:return c.sent(),[3,6];case 2:return o=c.sent(),a<Fu?(a++,[4,s(e,n)]):[3,4];case 3:return c.sent(),[3,5];case 4:throw o.numberOfRetries=a,o;case 5:return[3,6];case 6:return[2]}})})};return s(e,n)}(e,n,t,r,i)})).then(function(){return o})}function ft(e,n){var t=this,r=n.targetWindow;return new Promise(function(i,o){setTimeout(function(){return Qu(t,void 0,void 0,function(){var t,a;return Ju(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),r||o(new bt("StartLivePersonaCardError","targetWindow is undefined in startLivePersonaCardAsync")),r.LPC||o(new bt("StartLivePersonaCardError","targetWindow.LPC is undefined., lpcWindowId:"+r.lpcWindowId)),r.LivePersonaCardStrings&&r.LivePersonaCardStrings.strings||r.LivePersonaCardStringsLpcMini&&r.LivePersonaCardStringsLpcMini.strings||o(new bt("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined, lpcWindowId:"+r.lpcWindowId)),t=function(e,n){var t,r,i,o,a,s=n.targetWindow;return{accountId:n.accountId,refreshAuthToken:(a=n.getAuthToken,function(e){a(function(n,t){e(n,"",t,void 0)},function(n,t){e("",n,t,void 0)})}),contextType:n.clientContextType,strings:s.LivePersonaCardStringsLpcMini&&s.LivePersonaCardStringsLpcMini.strings||s.LivePersonaCardStrings&&s.LivePersonaCardStrings.strings,source:n.clientType,consumerCorrelationId:n.clientCorrelationId&&(o=n.clientCorrelationId,!function(e){return!e||e===wt}(o)&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o||""))?n.clientCorrelationId:"00000000-0000-0000-0000-000000000000",activeFlights:e.Flights?$u([],e.Flights,!0):[],isDebug:!1,culture:n.culture,dataCallbacks:n.dataCallbacks,actionCallbacks:n.actionCallbacks,telemetryCallbacks:n.telemetryCallbacks,dataUpdateBroadcaster:n.dataUpdateBroadcaster,privateDataCallbacks:n.privateDataCallbacks,options:n.options?n.options:{hideDocumentFilter:!1},theme:n.theme,setConfigurationManagerForTesting:n.setConfigurationManagerForTesting,lokiUrl:(null===(t=n.options)||void 0===t?void 0:t.lokiUrlOverride)||e.LokiUrl||"",lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId||"",userAadObjectId:e.UserAadObjectId||"",userPuid:e.UserPuid||"",ecsConfigIds:e.EcsConfigIds?$u([],e.EcsConfigIds,!0):[],ecsETag:e.EcsEtag||"",loggedInUserUpn:e.Upn||"",loggedInUserTeamsMri:n.loggedInUserTeamsMri,complianceEnvironment:n.complianceEnvironment,userDisplayName:e.UserDisplayName||"",app:n.app,platform:n.platform,telemetryCollectorUrlAria:(null===(r=e.ClientTelemetryCollectorUrls)||void 0===r?void 0:r.Aria)||n.telemetryCollectorUrlAria,telemetryCollectorUrlOneDs:(null===(i=e.ClientTelemetryCollectorUrls)||void 0===i?void 0:i.OneDs)||n.telemetryCollectorUrlOneDs,versionOverride:n.versionOverride}}(e,n),[4,r.LPC.start(t)];case 1:return s.sent(),i(),[3,3];case 2:return a=s.sent(),o(new bt("StartLivePersonaCardError",a.name)),[3,3];case 3:return[2]}})})},0)})}function dt(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}function pt(e){return void 0===e||"string"!=typeof e||""===e||null===e}function vt(e){!function(e){!function(e){var n,t,r=Gu.get(e);if(r){var i=r.bootstrapperConfig.targetWindow,o=null===(n=r.bootstrapperConfig.options)||void 0===n?void 0:n.isReuseScriptsEnabled;if(i&&(i.LPC&&i.LPC.cleanUp&&i.LPC.cleanUp(),!o)){delete i.LPC,delete i.LivePersonaCardHoverTarget,delete i.LivePersonaCardHoverTargetV2,delete i.LivePersonaCardStrings,delete i.LivePersonaCardStringsLpcMini,delete i.MeetingInsightsV2,delete i.MidgardBootstrapper,delete i.PersonaInsightRing,delete i.LPE,delete i.lpcWindowId;try{i.document.querySelectorAll("script[".concat(Nu,"]")).forEach(function(e){return e.remove()})}catch(e){console.warn("midgard-bootstrapper:deleteBootstrapperInstance(): Failed removing one or more script tags")}}null===(t=r.abandonInitializationPromise)||void 0===t||t.call(r),delete r.bootstrapperConfig.targetWindow,delete r.oneDsLogger,delete r.bootstrapperConfig,delete r.initializationPromise,delete r.abandonInitializationPromise,clearTimeout(r.forceRefreshInitializationTimeout)}Gu.delete(e)}(e)}(e)}var gt={d:function(e,n){for(var t in n)gt.o(n,t)&&!gt.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})}};gt.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),gt.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},gt.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e;gt.g.importScripts&&(e=gt.g.location+"");var n=gt.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");t.length&&(e=t[t.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),gt.p=e}();var ht={};gt.r(ht),gt.d(ht,{freeBootstrapperMemory:function(){return vt},loadLPC:function(){return al}});var mt=function(){return(mt=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};Object.create,Object.create;var yt,bt=function(e,n,t,r,i,o){this.name=e,this.message=n,this.rootCorrelationId=t,this.isExpected=r,this.statusCode=i,this.numberOfRetries=o},Ct="LokiAuthToken";!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(yt||(yt={}));var St="{0}/api/v1/livepersonacard/configuration?cultureName={1}",wt="00000000-0000-0000-0000-000000000000",Pt="LivePersonaEditorBranchOverride",Tt="LivePersonaCardVersionOverride",kt="MidgardVersion",It="MidgardBranch",xt="HostAppConfiguration",At="LivePersonaEditorVersionOverride",Lt=function(e,n,t,r,i,o){this.name=e,this.message=n,this.rootCorrelationId=t,this.isExpected=r,this.statusCode=i,this.numberOfRetries=o},Ot=function(e,n,t,o,a,s,c){return void 0===a&&(a={}),void 0===s&&(s=6e4),new Promise(function(u,l){var f,d=new XMLHttpRequest,p=function(e,n){var t=i("ClientTypeOverride",n)||e.clientType,r=i("MidgardOnlyOverrideCatalog",n),o=i(xt,n),a=i(kt,n);return{clientTypeOverride:t,hostAppConfigurationQSP:o,versionOverride:(r?"":a)||i(Tt,n)||e.versionOverride||"",lpeVersionOverride:(r?"":a)||i(At,n),lpeBranchOverride:i(Pt,n),midgardBranchOverride:r?"":i(It,n)}}(t,o),v=p.clientTypeOverride,g=p.hostAppConfigurationQSP,h=p.versionOverride,m=p.lpeVersionOverride,y=p.lpeBranchOverride,b=p.midgardBranchOverride;d.open("GET",e,!0),d.setRequestHeader("Authorization","Bearer "+n),d.setRequestHeader("Accept","application/json");var C=null!==(f=a.requestId)&&void 0!==f?f:r();if(d.setRequestHeader("X-RootCorrelationId",C),d.setRequestHeader("X-CorrelationId",C),d.setRequestHeader("X-ClientCorrelationId",t.clientCorrelationId),d.setRequestHeader("X-ClientFeature",t.clientFeature),d.setRequestHeader("X-ClientArchitectureVersion","v2"),d.setRequestHeader("X-ClientScenario","GetConfiguration"),c&&d.setRequestHeader("X-LPCVersion",c),v&&d.setRequestHeader("X-ClientType",v),t.app&&d.setRequestHeader("X-HostAppApp",t.app),t.platform&&d.setRequestHeader("X-HostAppPlatform",t.platform),t.hostAppRing&&d.setRequestHeader("X-HostAppRing",t.hostAppRing),t.hostAppVersion&&d.setRequestHeader("X-HostAppVersion",t.hostAppVersion),t.hostAppConfiguration&&d.setRequestHeader("X-HostAppConfiguration",JSON.stringify(t.hostAppConfiguration)),g){var S={};g.split(";").forEach(function(e){var n=e.split(":"),t=n[0],r=n[1];S[t]=r}),d.setRequestHeader(xt,JSON.stringify(S))}o&&o.React&&o.React.version&&o.ReactDOM&&d.setRequestHeader("X-HostAppReactVersion",o.React.version),h&&(d.setRequestHeader(Tt,h),d.setRequestHeader(kt,h)),m&&d.setRequestHeader("X-".concat(At),m),y&&d.setRequestHeader("X-".concat(Pt),y),b&&(d.setRequestHeader(It,b),d.setRequestHeader("X-".concat(It),b)),d.addEventListener("load",function(){if(200===d.status)try{var e=JSON.parse(d.response);e.RootCorrelationId=C,e.LokiVersion=d.getResponseHeader("x-serverversion")||"",u(e)}catch(e){l(new Lt("GetLokiConfigError","Failed to parse initialization config.",C))}else l(new Lt("GetLokiConfigError","Couldn't retrieve initialization config. Status code is ".concat(d.status),C,!1,d.status))}),d.addEventListener("error",function(){l(new Lt("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",C))}),d.addEventListener("timeout",function(){l(new Lt("GetLokiConfigError","Loki config request timed out after ".concat(s," ms."),C))}),d.timeout=s,d.send()})},Et=function(){return(Et=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)},Ut="LivePersonaCardCultureOverride",_t="object"==typeof n&&n&&n.Object===Object&&n,Mt="object"==typeof self&&self&&self.Object===Object&&self,Dt=(_t||Mt||Function("return this")()).Symbol,Bt=Object.prototype,Rt=Bt.hasOwnProperty,Ft=Bt.toString,Nt=Dt?Dt.toStringTag:void 0,Ht=Object.prototype.toString,Gt=Dt?Dt.toStringTag:void 0,zt=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Gt&&Gt in Object(e)?function(e){var n=Rt.call(e,Nt),t=e[Nt];try{e[Nt]=void 0;var r=!0}catch(e){}var i=Ft.call(e);return r&&(n?e[Nt]=t:delete e[Nt]),i}(e):function(e){return Ht.call(e)}(e)},jt=function(e){if(!function(e){var n=typeof e;return null!=e&&("object"==n||"function"==n)}(e))return!1;var n=zt(e);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n},Xt=function(e){var n;return(n={})[e]="SCRUBBED",n},Vt="function",qt="object",Wt="undefined",Kt="prototype",Qt="hasOwnProperty",Jt=Object,$t=Jt[Kt],Zt=Jt.assign,Yt=Jt.create,er=Jt.defineProperty,nr=$t[Qt],tr=null;s(),s();var rr,ir,or=function(e,n){return(or=Jt.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n[Qt](t)&&(e[t]=n[t])})(e,n)},ar="undefined",sr="constructor",cr="prototype",ur="function",lr="_dynInstFuncs",fr="_isDynProxy",dr="_dynClass",pr="_dynCls$",vr="_dynInstChk",gr=vr,hr="_dfOpts",mr="_unknown_",yr="__proto__",br="_dyn"+yr,Cr="__dynProto$Gbl",Sr="_dynInstProto",wr="useBaseInst",Pr="setInstFuncs",Tr=Object,kr=Tr.getPrototypeOf,Ir=Tr.getOwnPropertyNames,xr=(typeof globalThis!==ar&&(ir=globalThis),ir||typeof self===ar||(ir=self),ir||typeof window===ar||(ir=window),ir||typeof gt.g===ar||(ir=gt.g),ir||{}),Ar=xr[Cr]||(xr[Cr]={o:(rr={},rr[Pr]=!0,rr[wr]=!0,rr),n:1e3});w[hr]=Ar.o;var Lr,Or,Er="initialize",Ur="name",_r="getNotifyMgr",Mr="identifier",Dr="push",Br="isInitialized",Rr="config",Fr="instrumentationKey",Nr="logger",Hr="length",Gr="time",zr="processNext",jr="getProcessTelContext",Xr="addNotificationListener",Vr="removeNotificationListener",qr="stopPollingInternalLogs",Wr="onComplete",Kr="getPlugin",Qr="flush",Jr="_extensions",$r="splice",Zr="teardown",Yr="messageId",ei="message",ni="isAsync",ti="_doTeardown",ri="update",ii="getNext",oi="diagLog",ai="setNextPlugin",si="createNew",ci="cookieCfg",ui="indexOf",li="substring",fi="userAgent",di="split",pi="setEnabled",vi="substr",gi="nodeType",hi="apply",mi="replace",yi="enableDebugExceptions",bi="logInternalMessage",Ci="toLowerCase",Si="call",wi="type",Pi="handler",Ti="listeners",ki="isChildEvt",Ii="getCtx",xi="setCtx",Ai="complete",Li="traceId",Oi="spanId",Ei="traceFlags",Ui="",_i="channels",Mi="core",Di="createPerfMgr",Bi="disabled",Ri="extensionConfig",Fi="extensions",Ni="processTelemetry",Hi="priority",Gi="eventsSent",zi="eventsDiscarded",ji="eventsSendRequest",Xi="perfEvent",Vi="errorToConsole",qi="warnToConsole",Wi="getPerfMgr",Ki="toISOString",Qi="endsWith",Ji="startsWith",$i="indexOf",Zi="trim",Yi="toString",eo="__proto__",no="constructor",to=er,ro=Jt.freeze,io=(Jt.seal,Jt.keys),oo=String[Kt],ao=oo[Zi],so=oo[Qi],co=oo[Ji],uo=Date[Kt][Ki],lo=Array.isArray,fo=$t[Yi],po=nr[Yi],vo=po[Si](Jt),go=/-([a-z])/g,ho=/([^\w\d_$])/g,mo=/^(\d+[\w\d_$])/,yo=Object.getPrototypeOf,bo=lo||function(e){return!(!e||"[object Array]"!==fo[Si](e))},Co=!{toString:null}.propertyIsEnumerable("toString"),So=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],wo=ro||function(e){return e},Po="ctx",To="ParentContextKey",ko="ChildrenContextKey",Io=null,xo=function(){function e(n,t,r){var i,o=this,a=!1;o.start=j(),o[Ur]=n,o[ni]=r,o[ki]=function(){return!1},x(t)&&(a=G(o,"payload",function(){return!i&&x(t)&&(i=t(),t=null),i})),o[Ii]=function(n){return n?n===e[To]||n===e[ko]?o[n]:(o[Po]||{})[n]:null},o[xi]=function(n,t){n&&(n===e[To]?(o[n]||(o[ki]=function(){return!0}),o[n]=t):n===e[ko]?o[n]=t:(o[Po]=o[Po]||{})[n]=t)},o[Ai]=function(){var n=0,r=o[Ii](e[ko]);if(bo(r))for(var i=0;i<r[Hr];i++){var s=r[i];s&&(n+=s[Gr])}o[Gr]=j()-o.start,o.exTime=o[Gr]-n,o[Ai]=function(){},!a&&x(t)&&(o.payload=t())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Ao=function(){function e(n){this.ctx={},w(e,this,function(e){e.create=function(e,n,t){return new xo(e,n,t)},e.fire=function(e){e&&(e[Ai](),n&&x(n[Xi])&&n[Xi](e))},e[xi]=function(n,t){n&&((e[Po]=e[Po]||{})[n]=t)},e[Ii]=function(n){return(e[Po]||{})[n]}})}return e.__ieDyn=1,e}(),Lo="CoreUtils.doPerf",Oo="window",Eo="document",Uo="navigator",_o="location",Mo="console",Do="JSON",Bo="crypto",Ro="msCrypto",Fo="ReactNative",No="msie",Ho="trident/",Go="XMLHttpRequest",zo=null,jo=null,Xo=!1,Vo=null,qo=null,Wo=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],Ko=null,Qo="AI (Internal): ",Jo="AI: ",$o="AITR_",Zo=function(){function e(e,n,t,r){void 0===t&&(t=!1);var i=this;i[Yr]=e,i[ei]=(t?Jo:Qo)+e;var o=Ui;ue()&&(o=le().stringify(r));var a=(n?" message:"+Ce(n):Ui)+(r?" props:"+Ce(o):Ui);i[ei]+=a}return e.dataType="MessageData",e}(),Yo=function(){function e(n){this.identifier="DiagnosticLogger",this.queue=[];var t,r,i,o,a=0,s={};w(e,this,function(e){function c(n,t){if(!(a>=i)){var o=!0,c=$o+t[Yr];if(s[c]?o=!1:s[c]=!0,o&&(n<=r&&(e.queue[Dr](t),a++,u(1===n?"error":"warn",t)),a===i)){var l="Internal events throttle limit per PageView reached for this app.",f=new Zo(23,l,!1);e.queue[Dr](f),1===n?e[Vi](l):e[qi](l)}}}function u(e,t){var r=ye(n||{});r&&r[oi]&&r[oi](e,t)}!function(e){t=W(e.loggingLevelConsole,0),r=W(e.loggingLevelTelemetry,1),i=W(e.maxMessageLimit,25),o=W(e[yi],!1)}(n||{}),e.consoleLoggingLevel=function(){return t},e.telemetryLoggingLevel=function(){return r},e.maxInternalMessageLimit=function(){return i},e[yi]=function(){return o},e.throwInternal=function(n,r,i,a,l){void 0===l&&(l=!1);var f=new Zo(r,i,l,a);if(o)throw pe(f);var d=1===n?Vi:qi;if(P(f[ei]))u("throw"+(1===n?"Critical":"Warning"),f);else{if(l){var p=+f[Yr];!s[p]&&t>=n&&(e[d](f[ei]),s[p]=!0)}else t>=n&&e[d](f[ei]);c(n,f)}},e[qi]=function(e){Se("warn",e),u("warning",e)},e[Vi]=function(e){Se("error",e),u("error",e)},e.resetInternalMessageCount=function(){a=0,s={}},e[bi]=c})}return e.__ieDyn=1,e}(),ea=4294967296,na=4294967295,ta=!1,ra=123456789,ia=987654321,oa=er,aa="2.8.9",sa="."+Ae(6),ca=0,ua="00000000000000000000000000000000",la="0000000000000000",fa=Ee("plugin"),da="TelemetryPluginChain",pa="_hasRun",va="_getTelCtx",ga=0,ha=500,ma="Channel has invalid priority - ",ya="toGMTString",ba="toUTCString",Ca="cookie",Sa="expires",wa="enabled",Pa="isCookieUseDisabled",Ta="disableCookiesUsage",ka="_ckMgr",Ia=null,xa=null,Aa=null,La=oe(),Oa={},Ea={},Ua="getPlugin",_a=function(){function e(){function n(e){void 0===e&&(e=null);var n=e;if(!n){var t=o||Ne(null,{},u[Mi]);n=a&&a[Ua]?t[si](null,a[Ua]):t[si](null,a)}return n}function t(e,n,t){e&&V(e,Ri,[],null,T),!t&&n&&(t=n[jr]()[ii]());var r=a;a&&a[Ua]&&(r=a[Ua]()),u[Mi]=n,o=Ne(t,e,n,r)}function r(){i=!1,u[Mi]=null,o=null,a=null,c=[],s=en()}var i,o,a,s,c,u=this;r(),w(e,u,function(e){e[Er]=function(e,n,r,o){t(e,n,o),i=!0},e[Zr]=function(n,t){function i(){if(!f){f=!0,s.run(d,t);var e=c;c=[],R(e,function(e){e.rm()}),!0===l&&d[zr](p),r()}}var o,u=e[Mi];if(u&&(!n||u===n[Mi]())){var l,f=!1,d=n||He(null,u,a&&a[Ua]?a[Ua]():a),p=t||((o={reason:0})[ni]=!1,o);return e[ti]&&!0===e[ti](d,p,i)?l=!0:i(),l}},e[ri]=function(n,r){function i(){c||(c=!0,t(u.getCfg(),u.core(),u[ii]()))}var o=e[Mi];if(o&&(!n||o===n[Mi]())){var s,c=!1,u=n||Ge(null,o,a&&a[Ua]?a[Ua]():a),l=r||{reason:0};return e._doUpdate&&!0===e._doUpdate(u,l,i)?s=!0:i(),s}},e._addHook=function(e){e&&(bo(e)?c=c.concat(e):c[Dr](e))},J(e,"_addUnloadCb",function(){return s},"add")}),u[oi]=function(e){return n(e)[oi]()},u[Br]=function(){return i},u.setInitialized=function(e){i=e},u[ai]=function(e){a=e},u[zr]=function(e,n){n?n[zr](e):a&&x(a[Ni])&&a[Ni](e,null)},u._getTelCtx=n}return e.__ieDyn=1,e}(),Ma=function(e){function n(){function t(){r=0,i=[]}var r,i,o=e.call(this)||this;return o.identifier="TelemetryInitializerPlugin",o.priority=199,t(),w(n,o,function(e,n){e.addTelemetryInitializer=function(e){var n={id:r++,fn:e};return i[Dr](n),{remove:function(){R(i,function(e,t){if(e.id===n.id)return i[$r](t,1),-1})}}},e[Ni]=function(n,t){for(var r=!1,o=i[Hr],a=0;a<o;++a){var s=i[a];if(s)try{if(!1===s.fn[hi](null,[n])){r=!0;break}}catch(e){Te(t[oi](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+X(e),{exception:pe(e)},!0)}}r||e[zr](n,t)},e[ti]=function(){t()}}),o}return l(n,e),n.__ieDyn=1,n}(_a),Da="Plugins must provide initialize method",Ba="_notificationManager",Ra="SDK is still unloading...",Fa="SDK is not initialized",Na={loggingLevelConsole:1},Ha=function(){function e(){var n,t,r,i,o,a,s,c,l,d,p,v,g,h,m,y,b,C,S,P,k=0;w(e,this,function(e){function w(){t=!1,n=Z(!0,{},Na),e[Rr]=n,e[Nr]=new Yo(n),e[Jr]=[],m=new Ma,r=[],i=null,o=null,a=null,s=null,c=null,d=null,l=[],p=null,v=null,g=null,h=!1,y=null,b=Oe("AIBaseCore",!0),C=en(),P=null}function A(){return Ne(E(),n,e)}function L(t){var r=function(e,n,t){var r,i=[],o={};return R(t,function(t){(T(t)||T(t[Er]))&&Q(Da);var r=t[Hi],a=t[Mr];t&&r&&(T(o[r])?o[r]=a:ke(e,"Two extensions have same priority #"+r+" - "+o[r]+", "+a)),(!r||r<n)&&i[Dr](t)}),(r={all:t})[Mi]=i,r}(e[Nr],ha,l);d=r[Mi],c=null;var i=r.all;if(g=wo(function(e,n,t){var r=[];if(e&&R(e,function(e){return je(r,e,t)}),n){var i=[];R(n,function(e){e[Hi]>ha&&i[Dr](e)}),je(r,i,t)}return r}(v,i,e)),p){var o=F(i,p);-1!==o&&i[$r](o,1),-1!==(o=F(d,p))&&d[$r](o,1),p._setQueue(g)}else p=function(e,n){function t(){return Ne(null,n[Rr],n,null)}function r(e,n,t,r){function i(){0==--o&&(r&&r(),r=null)}var o=e?e[Hr]+1:1;o>0&&R(e,function(e){if(e&&e.queue[Hr]>0){var r=e.chain,a=n[si](r);a[Wr](i),t(a)}else o--}),i()}var i=!1;return{identifier:"ChannelControllerPlugin",priority:ha,initialize:function(n,t,r,o){i=!0,R(e,function(e){e&&e.queue[Hr]>0&&Be(Ne(e.chain,n,t),r)})},isInitialized:function(){return i},processTelemetry:function(n,i){r(e,i||t(),function(e){e[zr](n)},function(){i[zr](n)})},update:function(n,t){var i=t||{reason:0};return r(e,n,function(e){e[zr](i)},function(){n[zr](i)}),!0},pause:function(){r(e,t(),function(e){e.iterate(function(e){e.pause&&e.pause()})},null)},resume:function(){r(e,t(),function(e){e.iterate(function(e){e.resume&&e.resume()})},null)},teardown:function(n,t){var o=t||{reason:0,isAsync:!1};return r(e,n,function(e){e[zr](o)},function(){n[zr](o),i=!1}),!0},getChannel:function(n){var t=null;return e&&e[Hr]>0&&R(e,function(e){if(e&&e.queue[Hr]>0&&(R(e.queue,function(e){if(e[Mr]===n)return t=e,-1}),t))return-1}),t},flush:function(n,i,o,a){function s(){c--,u&&0===c&&(l&&(clearTimeout(l),l=null),i&&i(u),i=null)}var c=1,u=!1,l=null;return a=a||5e3,r(e,t(),function(e){e.iterate(function(e){if(e[Qr]){c++;var t=!1;e[Qr](n,function(){t=!0,s()},o)||t||(n&&null==l?l=setTimeout(function(){l=null,s()},a):s())}})},function(){u=!0,s()}),!0},_setQueue:function(n){e=n}}}(g,e);i[Dr](p),d[Dr](p),e[Jr]=Re(i),p[Er](n,e,i),Be(A(),i),e[Jr]=wo(Re(d||[])).slice(),t&&function(n){var t=Ge(E(),e);e._updateHook&&!0===e._updateHook(t,n)||t[zr](n)}(t)}function O(n){var t,r=null,i=null;return R(e[Jr],function(e){if(e[Mr]===n&&e!==p&&e!==m)return i=e,-1}),!i&&p&&(i=p.getChannel(n)),i&&((t={plugin:i})[pi]=function(e){De(i)[Bi]=!e},t.isEnabled=function(){var e=De(i);return!e[Zr]&&!e[Bi]},t.remove=function(e,n){var t;void 0===e&&(e=!0);var r=[i],o=((t={reason:1})[ni]=e,t);_(r,o,function(e){e&&L({reason:32,removed:r}),n&&n(e)})},r=t),r}function E(){if(!c){var t=(d||[]).slice();-1===F(t,m)&&t[Dr](m),c=ze(Re(t),n,e)}return c}function _(t,r,i){if(t&&t[Hr]>0){var o=He(ze(t,n,e),e);o[Wr](function(){var e=!1,n=[];R(l,function(r,i){tn(r,t)?e=!0:n[Dr](r)}),l=n;var r=[];v&&(R(v,function(n,i){var o=[];R(n,function(n){tn(n,t)?e=!0:o[Dr](n)}),r[Dr](o)}),v=r),i&&i(e)}),o[zr](r)}else i(!1)}function M(){var t=e[Nr]?e[Nr].queue:[];t&&(R(t,function(t){var r,i=((r={})[Ur]=y||"InternalMessageId: "+t[Yr],r.iKey=W(n[Fr]),r.time=B(new Date),r.baseType=Zo.dataType,r.baseData={message:t[ei]},r);e.track(i)}),t[Hr]=0)}function D(e,n,t,r){return p?p[Qr](e,n,t||6,r):(n&&n(!1),!0)}function N(n){var t=e[Nr];t?Te(t,2,73,n):Q(n)}var H,G,z;w(),e[Br]=function(){return t},e[Er]=function(r,o,s,c){var u,d;h&&Q(Ra),e[Br]()&&Q("Core should not be initialized more than once"),n=r||{},e[Rr]=n,T(r[Fr])&&Q("Please provide instrumentation key"),i=c,e[Ba]=c,!0===(d=W(n.disableDbgExt))&&S&&(i[Vr](S),S=null),i&&!S&&!0!==d&&(S=be(n),i[Xr](S)),!(u=W(n.enablePerfMgr))&&a&&(a=null),u&&q(n,Di,nn),q(n,Ri,{}).NotificationManager=i,s&&(e[Nr]=s);var p=q(n,Fi,[]);(l=[])[Dr].apply(l,f(f([],o),p)),v=q(n,_i,[]),L(null),g&&0!==g[Hr]||Q("No "+_i+" available"),t=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return g&&R(g,function(n){e[Dr](n.queue)}),wo(e)},e.track=function(t){t.iKey=t.iKey||n[Fr],t[Gr]=t[Gr]||B(new Date),t.ver=t.ver||"4.0",!h&&e[Br]()?A()[zr](t):r[Dr](t)},e[jr]=A,e[_r]=function(){return i||(i=function(){var e;return u(((e={})[Xr]=function(e){},e[Vr]=function(e){},e[Gi]=function(e){},e[zi]=function(e,n){},e[ji]=function(e,n){},e))}(),e[Ba]=i),i},e[Xr]=function(e){i&&i[Xr](e)},e[Vr]=function(e){i&&i[Vr](e)},e.getCookieMgr=function(){return s||(s=We(n,e[Nr])),s},e.setCookieMgr=function(e){s=e},e[Wi]=function(){if(!o&&!a&&W(n.enablePerfMgr)){var t=W(n[Di]);x(t)&&(a=t(e,e[_r]()))}return o||a||Io},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return r[Hr]},e.releaseQueue=function(){if(t&&r[Hr]>0){var e=r;r=[],R(e,function(e){A()[zr](e)})}},e.pollInternalLogs=function(e){y=e||null;var t=W(n.diagnosticLogInterval);return t&&t>0||(t=1e4),k&&clearInterval(k),k=setInterval(function(){M()},t)},e[qr]=function(){k&&(clearInterval(k),k=0,M())},G=function(){return m},z=["addTelemetryInitializer"],(H=e)&&G&&I(H)&&bo(z)&&R(z,function(e){U(e)&&J(H,e,G,e,void 0)}),e.unload=function(n,r,i){function o(n){s.flushComplete=n,h=!0,C.run(c,s),e[qr](),c[zr](s)}var a;void 0===n&&(n=!0),t||Q(Fa),h&&Q(Ra);var s=((a={reason:50})[ni]=n,a.flushComplete=!1,a),c=He(E(),e);c[Wr](function(){w(),r&&r(s)},e),D(n,o,6,i)||o(!1)},e[Kr]=O,e.addPlugin=function(e,n,t,r){function i(n){l[Dr](e),a.added=[e],L(a),r&&r(!0)}if(!e)return r&&r(!1),void N(Da);var o=O(e[Mr]);if(o&&!n)return r&&r(!1),void N("Plugin ["+e[Mr]+"] is already loaded!");var a={reason:16};if(o){var s=[o.plugin];_(s,{reason:2,isAsync:!!t},function(e){e?(a.removed=s,a.reason|=32,i()):r&&r(!1)})}else i()},e.evtNamespace=function(){return b},e[Qr]=D,e.getTraceCtx=function(e){var n;return P||(n={},P={getName:function(){return n[Ur]},setName:function(e){n[Ur]=e},getTraceId:function(){return n[Li]},setTraceId:function(e){_e(e)&&(n[Li]=e)},getSpanId:function(){return n[Oi]},setSpanId:function(e){Me(e)&&(n[Oi]=e)},getTraceFlags:function(){return n[Ei]},setTraceFlags:function(e){n[Ei]=e}}),P},e.setTraceCtx=function(e){P=e||null},J(e,"addUnloadCb",function(){return C},"add")})}return e.__ieDyn=1,e}(),Ga=function(){function e(n){this.listeners=[];var t=!!(n||{}).perfEvtsSendAll;w(e,this,function(e){e[Xr]=function(n){e.listeners[Dr](n)},e[Vr]=function(n){for(var t=F(e[Ti],n);t>-1;)e.listeners[$r](t,1),t=F(e[Ti],n)},e[Gi]=function(n){rn(e[Ti],Gi,!0,function(e){e[Gi](n)})},e[zi]=function(n,t){rn(e[Ti],zi,!0,function(e){e[zi](n,t)})},e[ji]=function(n,t){rn(e[Ti],ji,t,function(e){e[ji](n,t)})},e[Xi]=function(n){n&&(!t&&n[ki]()||rn(e[Ti],Xi,!1,function(e){n[ni]?setTimeout(function(){return e[Xi](n)},0):e[Xi](n)}))}})}return e.__ieDyn=1,e}(),za=function(e){function n(){var t=e.call(this)||this;return w(n,t,function(e,n){function t(n){var t=e[_r]();t&&t[zi]([n],2)}e[Er]=function(e,t,r,i){n[Er](e,t,r||new Yo(e),i||new Ga(e))},e.track=function(r){Y(e[Wi](),function(){return"AppInsightsCore:track"},function(){null===r&&(t(r),Q("Invalid telemetry item")),function(e){T(e[Ur])&&(t(e),Q("telemetry name required"))}(r),n.track(r)},function(){return{item:r}},!r.sync)}}),t}return l(n,e),n.__ieDyn=1,n}(Ha),ja="",Xa="https://browser.events.data.microsoft.com/OneCollector/1.0/",Va="version",qa="properties",Wa="on",Ka="attachEvent",Qa="addEventListener",Ja="detachEvent",$a="removeEventListener",Za="events",Ya="visibilitychange",es="pagehide",ns="pageshow",ts="unload",rs="beforeunload",is=Oe("aiEvtPageHide"),os=Oe("aiEvtPageShow"),as=/\.[\.]+/g,ss=/[\.]+$/,cs=1,us=Ee("events"),ls=/^([^.]*)(?:\.(.+)|)/,fs="1DS-Web-JS-3.2.8",ds="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",ps="withCredentials",vs="timeout",gs=((Or={})[0]=0,Or[2]=6,Or[1]=1,Or[3]=7,Or[4098]=6,Or[4097]=1,Or[4099]=7,Or);Boolean(oe()),Boolean(re());var hs,ms,ys,bs=function(){var e=ne("performance");return e&&e.now?e.now():j()},Cs=function(e){function n(){var t=e.call(this)||this;return t.pluginVersionStringArr=[],w(n,t,function(e,n){e.logger&&e.logger.queue||(e.logger=new Yo({loggingLevelConsole:1})),e.initialize=function(t,r,i,o){Y(e,function(){return"AppInsightsCore.initialize"},function(){var a=e.pluginVersionStringArr;if(t){t.endpointUrl||(t.endpointUrl=Xa);var s=t.propertyStorageOverride;!s||s.getProperty&&s.setProperty||Q("Invalid property storage override passed."),t.channels&&R(t.channels,function(e){e&&R(e,function(e){if(e.identifier&&e.version){var n=e.identifier+"="+e.version;a.push(n)}})})}e.getWParam=function(){return"undefined"!=typeof document||t.enableWParam?0:-1},r&&R(r,function(e){if(e&&e.identifier&&e.version){var n=e.identifier+"="+e.version;a.push(n)}}),e.pluginVersionString=a.join(";"),e.pluginVersionStringArr=a;try{n.initialize(t,r,i,o),e.pollInternalLogs("InternalLog")}catch(n){var c=e.logger,u=pe(n);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),Te(c,1,514,"SDK Initialization Failed - no telemetry will be sent: "+u)}},function(){return{config:t,extensions:r,logger:i,notificationManager:o}})},e.track=function(t){Y(e,function(){return"AppInsightsCore.track"},function(){var r,i=t;if(i){i.timings=i.timings||{},i.timings.trackStart=bs(),(r=i.latency)&&_(r)&&r>=1&&r<=4||(i.latency=1);var o=i.ext=i.ext||{};o.sdk=o.sdk||{},o.sdk.ver=fs;var a=i.baseData=i.baseData||{};a[qa]=a[qa]||{};var s=a[qa];s[Va]=s[Va]||e.pluginVersionString||ja}n.track(i)},function(){return{item:t}},!t.sync)}}),t}return l(n,e),n.__ieDyn=1,n}(za),Ss="name",ws=In({UserExt:[0,"user"],DeviceExt:[1,"device"],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"],DtExt:[11,"dt"]}),Ps=In({id:[0,"id"],ver:[1,"ver"],appName:[2,Ss],locale:[3,"locale"],expId:[4,"expId"],env:[5,"env"]}),Ts=In({domain:[0,"domain"],browser:[1,"browser"],browserVer:[2,"browserVer"],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),ks=In({locale:[0,"locale"],localId:[1,"localId"],id:[2,"id"]}),Is=In({osName:[0,Ss],ver:[1,"ver"]}),xs=In({ver:[0,"ver"],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),As=In({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,"serviceName"]}),Ls=In({popSample:[0,"popSample"],eventFlags:[1,"eventFlags"]}),Os=In({tz:[0,"tz"]}),Es=In({sessionId:[0,"sesId"]}),Us=In({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),_s=In({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),Ms=In({traceId:[0,"traceID"],traceName:[1,Ss],parentId:[2,"parentID"]}),Ds=In({traceId:[0,"traceId"],spanId:[1,"spanId"],traceFlags:[2,"traceFlags"]}),Bs=function(){function e(){w(e,this,function(e){e.setId=function(n){e.customId=n},e.getId=function(){return U(e.customId)?e.customId:e.automaticId}})}return e._staticInit=void G(e.prototype,"id",On,En),e}(),Rs="ai_session",Fs=function(){function e(n,t){var r,i,o=we(n),a=qe(n);w(e,this,function(n){function s(e){var t=n.automaticSession,r=e.split("|");r.length>0&&t.setId(r[0]);try{if(r.length>1){var i=+r[1];t.acquisitionDate=+new Date(i),t.acquisitionDate=t.acquisitionDate>0?t.acquisitionDate:0}if(r.length>2){var a=+r[2];t.renewalDate=+new Date(a),t.renewalDate=t.renewalDate>0?t.renewalDate:0}}catch(e){Te(o,1,510,"Error parsing ai_session cookie, session will be reset: "+e)}0===t.renewalDate&&Te(o,2,517,"AI session renewal date is 0, session will be reset.")}function c(){var e=n.automaticSession,t=(new Date).getTime(),r=n.config.sessionAsGuid();!P(r)&&r?M(r)?e.setId(wn()):e.setId(wn(r)):e.setId(Ae(f&&f.idLength?f.idLength():22)),e.acquisitionDate=t,e.renewalDate=t,u(e.getId(),e.acquisitionDate,e.renewalDate),xn()||Te(o,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function u(e,t,o){var s=t+n.config.sessionExpirationMs(),c=o+n.config.sessionRenewalMs(),u=new Date,l=[e,t,o];s<c?u.setTime(s):u.setTime(c);var f=n.config.cookieDomain?n.config.cookieDomain():null;a.set(i(),l.join("|")+";expires="+u.toUTCString(),null,f),r=(new Date).getTime()}var l,f={sessionRenewalMs:(l=t).sessionRenewalMs&&function(){return l.sessionRenewalMs},sessionExpirationMs:l.sessionExpirationMs&&function(){return l.sessionExpirationMs},cookieDomain:l.cookieDomain&&function(){return l.cookieDomain},namePrefix:l.namePrefix&&function(){return l.namePrefix},sessionAsGuid:function(){return l.sessionAsGuid},idLength:function(){return l.idLength?l.idLength:22}};x(t.sessionExpirationMs)||(f.sessionExpirationMs=function(){return e.acquisitionSpan}),x(t.sessionRenewalMs)||(f.sessionRenewalMs=function(){return e.renewalSpan}),n.config=f,i=function(){return n.config.namePrefix&&n.config.namePrefix()?Rs+n.config.namePrefix():Rs},n.automaticSession=new Bs,n.update=function(){n.automaticSession.getId()||function(){var e=a.get(i());if(e&&x(e.split))s(e);else{var t=function(e,n){var t=An();if(null!==t)try{return t.getItem(n)}catch(n){hs=!1,Te(e,1,503,"Browser failed read of local storage. "+n)}return null}(o,i());t&&s(t)}n.automaticSession.getId()||c()}();var t=n.automaticSession,l=n.config,f=(new Date).getTime(),d=f-t.acquisitionDate>l.sessionExpirationMs(),p=f-t.renewalDate>l.sessionRenewalMs();d||p?c():(!r||f-r>e.cookieUpdateInterval)&&(t.renewalDate=f,u(t.getId(),t.acquisitionDate,t.renewalDate))},n.backup=function(){var e,t,r,a=n.automaticSession;e=a.getId(),t=a.acquisitionDate,r=a.renewalDate,function(e,n,t){var r=An();if(null!==r)try{r.setItem(n,t)}catch(n){hs=!1,Te(e,1,504,"Browser failed write to local storage. "+n)}}(o,i(),[e,t,r].join("|"))}})}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e}(),Ns=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"],Hs=function(){function e(n,t){var r=null,i=Ns.slice(0),o=qe(t),a=n;w(e,this,function(e){function t(e){e!==r&&(r=Un(e,i))}if(ie()){var s=oe().documentElement;s&&(e.locale=s.lang)}e.env=n.env?n.env:function(e){var n,t={},r=oe();if(r){n=r&&r.querySelectorAll("meta");for(var i=0;i<n.length;i++){var o=n[i];o.name&&0===o.name.toLowerCase().indexOf(e)&&(t[o.name.replace(e,"")]=o.content)}}return t}("awa-").env,e.getExpId=function(){return a.expId?(t(a.expId),r):(t(Sn(o,"Treatments")),r)}})}return e.validateAppExpId=Un,e._staticInit=void G(e.prototype,"expId",Mn),e}(),Gs=function(){},zs=function(){},js=function(){function e(n,t){var r=qe(t);w(e,this,function(e){n.serviceName&&(e.serviceName=n.serviceName),e.getMsfpc=function(){return Sn(r,"MSFPC")},e.getAnid=function(){return Sn(r,"ANON").slice(0,34)}})}var n;return e._staticInit=(G(n=e.prototype,"msfpc",Dn),void G(n,"anid",Bn)),e}(),Xs=function(){var e=(new Date).getTimezoneOffset(),n=e%60,t=(e-n)/60,r="+";t>0&&(r="-"),t=Math.abs(t),n=Math.abs(n),this.tz=r+(t<10?"0"+t:t.toString())+":"+(n<10?"0"+n:n.toString())},Vs={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},qs={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Ws="([\\d,.]+)",Ks="([\\d,_,.]+)",Qs="Unknown",Js=[{r:Vs.WINPHONE,os:"Windows Phone"},{r:Vs.WINRT,os:"Windows RT"},{r:Vs.WIN,os:"Windows"},{r:Vs.IOS,os:"iOS"},{r:Vs.ANDROID,os:"Android"},{r:Vs.LINUX,os:"Linux"},{r:Vs.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:Vs.OSX,os:"Mac OS X"}],$s=function(e){if(e.populateOperatingSystemInfo){var n=this,t=se()||{},r=e.userAgent||t.userAgent||"",i=e.userAgentData||t.userAgentData||{};if(r){var o=function(e){for(var n=0;n<Js.length;n++){var t=Js[n];if(t.r&&e.match(t.r))return t.os;if(t.s&&-1!==e.indexOf(t.s))return t.os}return Qs}(r.toLowerCase());n.name=o,n.ver=function(e,n){return"Windows"===n?Rn(e,"Windows NT"):"Android"===n?Rn(e,n):"Mac OS X"===n?function(e){var n=e.match(new RegExp("Mac OS X "+Ks));if(n){var t=n[1].replace(/_/g,".");if(t){var r=Fn(t);return r?t.split(r)[0]:t}}return Qs}(e):"iOS"===n?function(e){var n=e.match(new RegExp("OS "+Ks));if(n){var t=n[1].replace(/_/g,".");if(t){var r=Fn(t);return r?t.split(r)[0]:t}}return Qs}(e):Qs}(r,o)}n.name&&n.name!==Qs||!U(i.platform)||(n.name=i.platform)}},Zs="MicrosoftApplicationsTelemetryDeviceId",Ys=function(){function e(n,t){var r=0;w(e,this,function(e){var i=n.propertyStorageOverride;e.seq=r,e.epoch=xe(!1).toString();var o=qe(t,n);if(o.isEnabled()||i){var a=function(e,n,t){return n?n.getProperty(t)||"":Sn(e,t)}(o,i,Zs);a||(a=mn()),function(e,n,t,r){n?n.setProperty(t,r):e.set(t,r,31536e3)}(o,i,Zs,a),e.installId=a}else o.purge(Zs);e.getSequenceId=function(){return++r}})}return e.__ieDyn=1,e}(),ec=function(e,n,t,r){var i=this;if(i.traceId=n||yn(),e.enableDistributedTracing&&!t&&(t=yn().substring(0,16)),i.parentId=t,e.enableApplicationInsightsTrace){i.name=r;var o=ce();o&&o.pathname&&(i.name=o.pathname)}},nc="setLocalId",tc=function(){function e(n,t,r){var i,o=t,a=qe(r,n);w(e,this,function(t){function r(){if(!o.hashIdentifiers&&!o.dropIdentifiers){var e=Sn(a,"MUID");e&&(i="t:"+e)}return i}if(a&&a.isEnabled()&&(r(),o.enableApplicationInsightsUser)){var s=Sn(a,e.userCookieName);if(s){var c=s.split(e.cookieSeparator);c.length>0&&(t.id=c[0])}if(!t.id){t.id=Ae(n&&!P(n.idLength)?n.idLength:22);var u=B(new Date);t.accountAcquisitionDate=u;var l=[t.id,u],f=o.cookieDomain?o.cookieDomain:void 0;a.set(e.userCookieName,l.join(e.cookieSeparator),31536e3,f)}}if("undefined"!=typeof navigator){var d=navigator;t.locale=d.userLanguage||d.language}t.getLocalId=function(){return i||r()},t[nc]=function(e){i=e}})}return e.cookieSeparator="|",e.userCookieName="ai_user",e._staticInit=void G(e.prototype,"localId",Nn,Hn),e}(),rc=function(e){var n=this;n.popSample=100,n.eventFlags=0,e.hashIdentifiers&&(n.eventFlags=1048576|n.eventFlags),e.dropIdentifiers&&(n.eventFlags=2097152|n.eventFlags)},ic="([\\d,.]+)",oc="Unknown",ac="Edg/",sc=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:ac,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],cc=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}],uc=function(){function e(n,t){var r=qe(t),i=n||{};w(e,this,function(e){var n=ce();if(n){var t=n.hostname;t&&(e.domain="file:"===n.protocol?"local":t)}if(i.populateBrowserInfo){var o=i.userAgent,a=(i.userAgentData||{}).brands,s=se();s&&(o=o||s.userAgent||"",a=a||(s.userAgentData||{}).brands),function(n,t){if(bo(t))try{for(var r=0;r<cc.length;r++){var i=zn(cc[r].br,t);if(i)return e.browser=cc[r].b,void(e.browserVer=i)}}catch(e){}if(n){var o=function(e){if(e)for(var n=0;n<sc.length;n++)if(Gn(sc[n].ua,e))return sc[n].b;return oc}(n);e.browser=o,e.browserVer=function(e,n){return"MSIE"===n?function(e){var n=e.match(new RegExp("MSIE "+ic));if(n)return n[1];var t=e.match(new RegExp("rv:"+ic));return t?t[1]:void 0}(e):function(e,n){"Safari"===e?e="Version":"Edge"===e&&Gn(ac,n)&&(e="Edg");var t=n.match(new RegExp(e+"/"+ic));return t||"Opera"===e&&(t=n.match(new RegExp("OPR/"+ic)))?t[1]:oc}(n,e)}(n,o)}}(o,a);var c=function(){var e={h:0,w:0},n=re();return n&&n.screen&&(e.h=screen.height,e.w=screen.width),e}();e.screenRes=c.w+"X"+c.h}e.getUserConsent=function(){return i.userConsented||!!Sn(r,i.userConsentCookieName||"MSCC")},e.getUserConsentDetails=function(){try{var e=i.callback;if(e&&e.userConsentDetails){var n=e.userConsentDetails();if(n)return JSON.stringify({Required:n.Required||!1,Analytics:n.Analytics||!1,SocialMedia:n.SocialMedia||!1,Advertising:n.Advertising||!1})}}catch(e){}return null},G(e,"userConsent",e.getUserConsent)})}return e._staticInit=void G(e.prototype,"userConsent",jn),e}(),lc=function(){function e(n,t,r){w(e,this,function(e){function i(){var n=e.session;if(n&&U(n.customId))return n.customId;u.update();var t=u.automaticSession;if(t){var r=t.getId();r&&U(r)&&(n.automaticId=r)}return n.automaticId}function o(){var e=p;return r&&r.getTraceCtx&&(e=r.getTraceCtx(!1)||p),e}e.app=new Hs(t,r),e.cloud=new Gs,e.user=new tc(n,t,r),e.os=new $s(t),e.web=new uc(t,r);var a=new Ys(n,r),s=new js(t,r),c=new rc(t);e.loc=new Xs,e.device=new zs;var u=new Fs(r,t);e.session=new Bs;var l,f,d,p=(l=new ec(t),f=o(),d=l||{},{getName:function(){return d.name},setName:function(e){f&&f.setName(e),d.name=e},getTraceId:function(){return d.traceId},setTraceId:function(e){f&&f.setTraceId(e),_e(e)&&(d.traceId=e)},getSpanId:function(){return d.parentId},setSpanId:function(e){f&&f.setSpanId(e),Me(e)&&(d.parentId=e)},getTraceFlags:function(){return d.traceFlags},setTraceFlags:function(e){f&&f.setTraceFlags(e),d.traceFlags=e}}),v=!(t||{}).eventContainExtFields;e.getTraceCtx=function(){return p},e.getSessionId=i,e.applyApplicationContext=function(n){var t,r=e.app;Xn(4,n,Ps,((t={})[0]=r.id,t[1]=r.ver,t[2]=r.name,t[3]=r.locale,t[4]=r.getExpId(),t[5]=r.env,t),v)},e.applyUserContext=function(n){var t,r=e.user;Xn(0,n,ks,((t={})[1]=r.getLocalId(),t[0]=r.locale,t[2]=r.id,t),v)},e.applyWebContext=function(n){var t,r=e.web;Xn(3,n,Ts,((t={})[0]=r.domain,t[1]=r.browser,t[2]=r.browserVer,t[3]=r.screenRes,t[5]=r.getUserConsentDetails(),t[4]=r.getUserConsent(),t),v)},e.applyOsContext=function(n){var t,r=e.os;Xn(5,n,Is,((t={})[0]=r.name,t[1]=r.ver,t),v)},e.applySdkContext=function(e){var n;Xn(6,e,xs,((n={})[2]=a.installId,n[1]=a.getSequenceId(),n[3]=a.epoch,n),v)},e.applyIntWebContext=function(e){var n;Xn(7,e,As,((n={})[0]=s.getMsfpc(),n[1]=s.getAnid(),n[2]=s.serviceName,n),v)},e.applyUtcContext=function(e){var n,t=((n={})[0]=c.popSample,n);c.eventFlags>0&&(t[1]=c.eventFlags),Xn(8,e,Ls,t,v)},e.applyLocContext=function(n){var t;Xn(9,n,Os,((t={})[0]=e.loc.tz,t),v)},e.applySessionContext=function(e){var n;Xn(4,e,Es,((n={})[0]=i(),n),v)},e.applyDeviceContext=function(n){var t,r=e.device;Xn(1,n,Us,((t={})[0]=r.localId,t[2]=r.make,t[3]=r.model,t[1]=r.deviceClass,t),v)},e.applyCloudContext=function(n){var t,r=e.cloud;Xn(10,n,_s,((t={})[0]=r.role,t[1]=r.roleInstance,t[2]=r.roleVer,t),v)},e.applyAITraceContext=function(e){var n;if(t.enableApplicationInsightsTrace){var r=o();r&&Xn(2,e,Ms,((n={})[0]=r.getTraceId(),n[1]=r.getName(),n[2]=r.getSpanId(),n),!1)}},e.applyDistributedTraceContext=function(e){var n,t=o();if(t){var r=((n={})[0]=t.getTraceId(),n[1]=t.getSpanId(),n),i=t.getTraceFlags();T(i)||(r[2]=i),Xn(11,e,Ds,r,!1)}}})}return e.__ieDyn=1,e}(),fc=[ws[4],ws[0],ws[3],ws[5],ws[6],ws[7],ws[8],ws[9],ws[1],ws[2],ws[11],ws[10]],dc=function(e){function n(){var t,r,i,o=e.call(this)||this;return o.identifier="SystemPropertiesCollector",o.priority=3,o.version="3.2.8",w(n,o,function(e,n){function o(){t=null,r={}}o(),e.initialize=function(r,o,a){n.initialize(r,o,a),i=e._getTelCtx().getExtCfg(e.identifier),t=new lc(r,i,o),o&&o.setTraceCtx&&o.setTraceCtx(t.getTraceCtx())},e.processTelemetry=function(n,o){Tn(n,e.identifier),o=e._getTelCtx(o);var a,s,c=n.ext=n.ext?n.ext:{};n.data=n.data?n.data:{},R(fc,function(e){c[e]=c[e]||{}}),t&&(t.applyApplicationContext(n),t.applyUserContext(n),t.applyWebContext(n),t.applyOsContext(n),t.applySdkContext(n),t.applyIntWebContext(n),t.applyUtcContext(n),t.applyLocContext(n),t.applySessionContext(n),t.applyDeviceContext(n),i.enableApplicationInsightsTrace&&t.applyAITraceContext(n),i.enableDistributedTracing&&t.applyDistributedTraceContext(n),t.applyCloudContext(n)),R(H(c),function(e){0===H(c[e]).length&&delete c[e]}),a=r,s=n.data,a&&L(a,function(e,n){s[e]||(s[e]=n)}),e.processNext(n,o)},e.getPropertiesContext=function(){return t},e.setProperty=function(e,n){r[e]=n},e._doTeardown=function(e,n){var r=(e||{}).core();if(r&&r.getTraceCtx&&t){var i=r.getTraceCtx(!1);i&&i===t.getTraceCtx()&&r.setTraceCtx(null)}o()}}),o}return l(n,e),n.__ieDyn=1,n}(_a),pc=(ms={},L({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},function(e,n){ms[e]=n,ms[n]=e}),z(ms)),vc="REAL_TIME",gc="NEAR_REAL_TIME",hc="BEST_EFFORT",mc="",yc="POST",bc="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Cc="drop",Sc="send",wc="requeue",Pc="rspFail",Tc="oth",kc="no-cache, no-store",Ic="application/x-json-stream",xc="cache-control",Ac="content-type",Lc="kill-tokens",Oc="kill-duration",Ec="kill-duration-seconds",Uc="time-delta-millis",_c="client-version",Mc="client-id",Dc="time-delta-to-apply-millis",Bc="upload-time",Rc="apikey",Fc="AuthMsaDeviceTicket",Nc="AuthXToken",Hc="msfpc",Gc="trace",zc="user",jc=function(){function e(n,t){var r=t?[].concat(t):[],i=this,o=qn(r);i.iKey=function(){return n},i.Msfpc=function(){return o||mc},i.count=function(){return r.length},i.events=function(){return r},i.addEvent=function(e){return!!e&&(r.push(e),o||(o=Vn(e)),!0)},i.split=function(t,i){var a;if(t<r.length){var s=r.length-t;T(i)||(s=i<s?i:s),a=r.splice(t,s),o=qn(r)}return new e(n,a)}}return e.create=function(n,t){return new e(n,t)},e}(),Xc=function(){function e(){var n=!0,t=!0,r=!0,i="use-collector-delta",o=!1;w(e,this,function(e){e.allowRequestSending=function(){return n},e.firstRequestSent=function(){r&&(r=!1,o||(n=!1))},e.shouldAddClockSkewHeaders=function(){return t},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,t=!0,o=!0):t=!1,n=!0)}})}return e.__ieDyn=1,e}(),Vc=1e3,qc=function(){function e(){var n={};w(e,this,function(e){e.setKillSwitchTenants=function(e,t){if(e&&t)try{var r=function(e){var n=[];return e&&R(e,function(e){n.push(N(e))}),n}(e.split(","));if("this-request-only"===t)return r;for(var i=parseInt(t,10)*Vc,o=0;o<r.length;++o)n[r[o]]=j()+i}catch(e){return[]}return[]},e.isTenantKilled=function(e){var t=n,r=N(e);return void 0!==t[r]&&t[r]>j()||(delete t[r],!1)}})}return e.__ieDyn=1,e}(),Wc=.8,Kc=1.2,Qc=3e3,Jc=6e5,$c=20,Zc=3984588,Yc=65e3,eu=2e6,nu=Math.min(eu,Yc),tu="metadata",ru="f",iu=/\./,ou=function(){function e(n,t,r,i){var o="data",a="baseData",s=!!i,c=t,u={};w(e,this,function(e){function t(e,n,i,o,a,l,f){L(e,function(e,d){var p=null;if(d||bn(d)){var v=i,g=e,h=a,m=n;if(s&&!o&&iu.test(e)){var y=e.split("."),b=y.length;if(b>1){h&&(h=h.slice());for(var C=0;C<b-1;C++){var S=y[C];m=m[S]=m[S]||{},v+="."+S,h&&h.push(S)}g=y[b-1]}}if(p=!(o&&function(e,n){var t=u[e];return void 0===t&&(e.length>=7&&(t=O(e,"ext.metadata")||O(e,"ext.web")),u[e]=t),t}(v))&&c&&c.handleField(v,g)?c.value(v,g,d,r):function(e,n,t){if(!n&&!bn(n)||"string"!=typeof e)return null;var r=typeof n;if("string"===r||"number"===r||"boolean"===r||bo(n))n={value:n};else if("object"!==r||nr.call(n,"value")){if(T(n.value)||n.value===ja||!U(n.value)&&!_(n.value)&&!M(n.value)&&!bo(n.value))return null}else n={value:t?JSON.stringify(n):n};if(bo(n.value)&&!(n.value.length>0))return null;if(!T(n.kind)){if(bo(n.value)||!(0===(i=n.kind)||i>0&&i<=13||32===i))return null;n.value=n.value.toString()}var i;return n}(g,d,r)){var w=p.value;if(m[g]=w,l&&l(h,g,p),f&&"object"==typeof w&&!bo(w)){var P=h;P&&(P=P.slice()).push(g),t(d,w,v+"."+g,o,P,l,f)}}}})}e.createPayload=function(e,n,t,r,i,o){return{apiKeys:[],payloadBlob:mc,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:n,isSync:t,isBeacon:r,sendType:o,sendReason:i}},e.appendPayload=function(t,r,i){var o=t&&r&&!t.overflow;return o&&Y(n,function(){return"Serializer:appendPayload"},function(){for(var n=r.events(),o=t.payloadBlob,a=t.numEvents,s=!1,c=[],u=[],l=t.isBeacon,f=l?Yc:Zc,d=l?nu:eu,p=0,v=0;p<n.length;){var g=n[p];if(g){if(a>=i){t.overflow=r.split(p);break}var h=e.getEventBlob(g);if(h&&h.length<=d){var m=h.length;if(o.length+m>f){t.overflow=r.split(p);break}o&&(o+="\n"),o+=h,++v>$c&&(o.substr(0,1),v=0),s=!0,a++}else h?c.push(g):u.push(g),n.splice(p,1),p--}p++}if(c&&c.length>0&&t.sizeExceed.push(jc.create(r.iKey(),c)),u&&u.length>0&&t.failedEvts.push(jc.create(r.iKey(),u)),s){t.batches.push(r),t.payloadBlob=o,t.numEvents=a;var y=r.iKey();-1===F(t.apiKeys,y)&&t.apiKeys.push(y)}},function(){return{payload:t,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}}),o},e.getEventBlob=function(e){try{return Y(n,function(){return"Serializer.getEventBlob"},function(){var n={};n.name=e.name,n.time=e.time,n.ver=e.ver,n.iKey="o:"+function(e){if(e){var n=e.indexOf("-");if(n>-1)return e.substring(0,n)}return ja}(e.iKey);var r={},i=e.ext;i&&(n.ext=r,L(i,function(e,n){t(n,r[e]={},"ext."+e,!0,null,null,!0)}));var s=n[o]={};s.baseType=e.baseType;var c=s[a]={};return t(e.baseData,c,a,!1,[a],function(e,n,t){Kn(r,e,n,t)},!0),t(e.data,s,o,!1,[],function(e,n,t){Kn(r,e,n,t)},!0),JSON.stringify(n)},function(){return{item:e}})}catch(e){return null}}})}return e.__ieDyn=1,e}(),au="sendAttempt",su="&NoResponseBody=true",cu=((ys={})[1]=wc,ys[100]=wc,ys[200]="sent",ys[8004]=Cc,ys[8003]=Cc,ys),uu={},lu={};Qn(Fc,Fc,!1),Qn(_c,_c),Qn(Mc,"Client-Id"),Qn(Rc,Rc),Qn(Dc,Dc),Qn(Bc,Bc),Qn(Nc,Nc);var fu,du=function(){function e(n,t,r,i,o){this._responseHandlers=[];var a,s,c,u,l,f,d,p,v,g,h="?cors=true&"+Ac.toLowerCase()+"="+Ic,m=new qc,y=!1,b=new Xc,C=!1,S=0,k=!0,I=[],x={},A=[],O=null,E=!1,_=!1,M=!1;w(e,this,function(e){function w(e,n){for(var t=0,r=null,i=0;null==r&&i<e.length;)1===(t=e[i])?(null===Vo&&(Vo=typeof XDomainRequest!==Wt)&&he()&&(Vo=Vo&&!ee(ne(Go),"withCredentials")),Vo?r=D:he()&&(r=F)):2===t&&ge(n)&&(!n||n&&!p)?r=B:C&&3===t&&ve()&&(r=z),i++;return r?{_transport:t,_isSync:n,sendPOST:r}:null}function D(e,n,t){var r=new XDomainRequest;r.open(yc,e.urlString),e.timeout&&(r.timeout=e.timeout),r.onload=function(){var e=Jn(r);G(n,200,{},e),re(e)},r.onerror=function(){G(n,400,{})},r.ontimeout=function(){G(n,500,{})},r.onprogress=function(){},t?r.send(e.data):o.set(function(){r.send(e.data)},0)}function B(e,n,t){var r,i=e.urlString,a=!1,s=!1,c=((r={body:e.data,method:yc})[bc]=!0,r);t&&(c.keepalive=!0,2===e._sendReason&&(a=!0,g&&(i+=su))),oe&&(c.credentials="include"),e.headers&&H(e.headers).length>0&&(c.headers=e.headers),fetch(i,c).then(function(e){var t={},r=mc,i=e.headers;i&&i.forEach(function(e,n){t[n]=e}),e.body&&e.text().then(function(e){r=e}),s||(s=!0,G(n,e.status,t,r),re(r))}).catch(function(e){s||(s=!0,G(n,0,{}))}),a&&!s&&(s=!0,G(n,200,{})),!s&&e.timeout>0&&o.set(function(){s||(s=!0,G(n,500,{}))},e.timeout)}function F(e,n,t){function r(e,n,t){if(!e[t]&&n&&n.getResponseHeader){var r=n.getResponseHeader(t);r&&(e[t]=N(r))}return e}function i(e,t){G(n,e.status,function(e){var n,t,i={};return e.getAllResponseHeaders?(n=e.getAllResponseHeaders(),t={},U(n)&&R(N(n).split(/[\r\n]+/),function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=N(e.substring(0,n)).toLowerCase(),i=N(e.substring(n+1));t[r]=i}else t[N(e)]=1}}),i=t):(i=r(i,e,Uc),i=r(i,e,Oc),i=r(i,e,Ec)),i}(e),t)}var o=e.urlString;t&&e.disableXhrSync&&(t=!1);var a=function(e,n,t,r,i,o){function a(e,n,t){try{e[n]=t}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return r&&a(s,ds,r),t&&a(s,ps,t),s.open(e,n,!i),t&&a(s,ps,t),!i&&o&&a(s,vs,o),s}(yc,o,oe,!0,t,e.timeout);L(e.headers,function(e,n){a.setRequestHeader(e,n)}),a.onload=function(){var e=Jn(a);i(a,e),re(e)},a.onerror=function(){i(a)},a.ontimeout=function(){i(a)},a.send(e.data)}function G(e,n,t,r){try{e(n,t,r)}catch(e){Te(s,2,518,pe(e))}}function z(e,n,t){var r=200,i=e._thePayload,o=e.urlString+(g?su:mc);try{var a=se();if(!a.sendBeacon(o,e.data))if(i){var c=[];R(i.batches,function(e){if(c&&e&&e.count()>0){for(var n=e.events(),t=0;t<n.length;t++)if(!a.sendBeacon(o,O.getEventBlob(n[t]))){c.push(e.split(t));break}}else c.push(e.split(0))}),ie(c,8003,i.sendType,!0)}else r=0}catch(e){ke(s,"Failed to send telemetry using sendBeacon API. Ex:"+pe(e)),r=0}finally{G(n,r,{},mc)}}function X(e){return 2===e||3===e}function V(e){return _&&X(e)&&(e=2),e}function q(){return!y&&S<t}function W(){var e=A;return A=[],e}function K(e,n,t){var r=!1;return e&&e.length>0&&!y&&c[n]&&O&&(r=0!==n||q()&&(t>0||b.allowRequestSending())),r}function Q(e){var n={};return e&&R(e,function(e,t){n[t]={iKey:e.iKey(),evts:e.events()}}),n}function J(e,t,r,i,o){if(e&&0!==e.length)if(y)ie(e,1,i);else{i=V(i);try{var a=e,l=0!==i;Y(u,function(){return"HttpManager:_sendBatches"},function(a){a&&(e=e.slice(0));for(var s=[],u=null,f=bs(),d=c[i]||(l?c[1]:c[0]),p=d&&d._transport,g=v&&(_||X(i)||3===p||d._isSync&&2===p);K(e,i,t);){var h=e.shift();h&&h.count()>0&&(m.isTenantKilled(h.iKey())?s.push(h):(u=u||O.createPayload(t,r,l,g,o,i),O.appendPayload(u,h,n)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,Z(u,f,bs(),o),f=bs(),u=null):(Z(u,f,bs(),o),f=bs(),e=[h].concat(e),u=null)))}u&&Z(u,f,bs(),o),e.length>0&&(A=e.concat(A)),ie(s,8004,i)},function(){return{batches:Q(a),retryCount:t,isTeardown:r,isSynchronous:l,sendReason:o,useSendBeacon:X(i),sendType:i}},!l)}catch(e){Te(s,2,48,"Unexpected Exception sending batch: "+pe(e))}}}function $(e,n,t){e[n]=e[n]||{},e[n][a.identifier]=t}function Z(n,t,i,o){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var l=!!e.sendHook,v=c[n.sendType];!X(n.sendType)&&n.isBeacon&&2===n.sendReason&&(v=c[2]||c[3]||v);var g=M;(n.isBeacon||3===v._transport)&&(g=!1);var y=function(e,n){var t={url:h,hdrs:{},useHdrs:!1};n?(t.hdrs=Pn(t.hdrs,x),t.useHdrs=H(t.hdrs).length>0):L(x,function(e,n){lu[e]?Zn(t,lu[e],n,!1):(t.hdrs[e]=n,t.useHdrs=!0)}),Zn(t,Mc,"NO_AUTH",n),Zn(t,_c,fs,n);var r=mc;R(e.apiKeys,function(e){r.length>0&&(r+=","),r+=e}),Zn(t,Rc,r,n),Zn(t,Bc,j().toString(),n);var i=function(e){for(var n=0;n<e.batches.length;n++){var t=e.batches[n].Msfpc();if(t)return encodeURIComponent(t)}return mc}(e);if(bn(i)&&(t.url+="&ext.intweb.msfpc="+i),b.shouldAddClockSkewHeaders()&&Zn(t,Dc,b.getClockSkewHeaderValue(),n),u.getWParam){var o=u.getWParam();o>=0&&(t.url+="&w="+o)}for(var a=0;a<I.length;a++)t.url+="&"+I[a].name+"="+I[a].value;return t}(n,g);g=g||y.useHdrs;var C=bs();Y(u,function(){return"HttpManager:_doPayloadSend"},function(){for(var c=0;c<n.batches.length;c++)for(var h=n.batches[c].events(),w=0;w<h.length;w++){var P=h[w];if(E){var T=P.timings=P.timings||{};$(T,"sendEventStart",C),$(T,"serializationStart",t),$(T,"serializationCompleted",i)}P[au]>0?P[au]++:P[au]=1}ie(n.batches,1e3+(o||0),n.sendType,!0);var I={data:n.payloadBlob,urlString:y.url,headers:y.hdrs,_thePayload:n,_sendReason:o,timeout:f,disableXhrSync:d,disableFetchKeepAlive:p};g&&($n(I.headers,xc)||(I.headers[xc]=kc),$n(I.headers,Ac)||(I.headers[Ac]=Ic));var x=null;v&&(x=function(t){b.firstRequestSent();var i=function(t,i){!function(n,t,i,o){var s,c=9e3,u=null,l=!1,f=!1;try{var d=!0;if(typeof n!==Wt){if(t){b.setClockSkew(t[Uc]);var p=t[Oc]||t["kill-duration-seconds"];R(m.setKillSwitchTenants(t[Lc],p),function(e){R(i.batches,function(n){if(n.iKey()===e){u=u||[];var t=n.split(0);i.numEvents-=t.count(),u.push(t)}})})}if(200==n||204==n)return void(c=200);((s=n)>=300&&s<500&&408!=s&&429!=s||501==s||505==s||i.numEvents<=0)&&(d=!1),c=9e3+n%1e3}if(d){c=100;var v=i.retryCnt;0===i.sendType&&(v<r?(l=!0,te(function(){0===i.sendType&&S--,J(i.batches,v+1,i.isTeardown,_?2:i.sendType,5)},_,Wn(v))):(f=!0,_&&(c=8001)))}}finally{l||(b.setClockSkew(),function(n,t,r,i){try{i&&a._backOffTransmission(),200===t&&(i||n.isSync||a._clearBackOff(),function(e){if(E){var n=bs();R(e,function(e){e&&e.count()>0&&function(e,n){E&&R(e,function(e){$(e.timings=e.timings||{},"sendEventCompleted",n)})}(e.events(),n)})}}(n.batches)),ie(n.batches,t,n.sendType,!0)}finally{0===n.sendType&&(S--,5!==r&&e.sendQueuedRequests(n.sendType,r))}}(i,c,o,f)),ie(u,8004,i.sendType)}}(t,i,n,o)},c=n.isTeardown||n.isSync;try{v.sendPOST(t,i,c),e.sendListener&&e.sendListener(I,t,c,n.isBeacon)}catch(e){ke(s,"Unexpected exception sending payload. Ex:"+pe(e)),G(i,0,{})}}),Y(u,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(x)if(0===n.sendType&&S++,l&&!n.isBeacon&&3!==v._transport){var t={data:I.data,urlString:I.urlString,headers:Pn({},I.headers),timeout:I.timeout,disableXhrSync:I.disableXhrSync,disableFetchKeepAlive:I.disableFetchKeepAlive},r=!1;Y(u,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{e.sendHook(t,function(e){r=!0,k||e._thePayload||(e._thePayload=e._thePayload||I._thePayload,e._sendReason=e._sendReason||I._sendReason),x(e)},n.isSync||n.isTeardown)}catch(e){r||x(I)}})}else x(I)})},function(){return{thePayload:n,serializationStart:t,serializationCompleted:i,sendReason:o}},n.isSync)}n.sizeExceed&&n.sizeExceed.length>0&&ie(n.sizeExceed,8003,n.sendType),n.failedEvts&&n.failedEvts.length>0&&ie(n.failedEvts,8002,n.sendType)}function te(e,n,t){n?e():o.set(e,t)}function re(n){var t=e._responseHandlers;try{for(var r=0;r<t.length;r++)try{t[r](n)}catch(e){Te(s,1,519,"Response handler failed: "+e)}if(n){var i=JSON.parse(n);bn(i.webResult)&&bn(i.webResult[Hc])&&l.set("MSFPC",i.webResult[Hc],31536e3)}}catch(e){}}function ie(e,n,t,r){if(e&&e.length>0&&i){var o=i[(c=n,l=cu[c],bn(l)||(l=Tc,c>=9e3&&c<=9999?l=Pc:c>=8e3&&c<=8999?l=Cc:c>=1e3&&c<=1999&&(l=Sc)),l)];if(o){var a=0!==t;Y(u,function(){return"HttpManager:_sendBatchesNotification"},function(){te(function(){try{o.call(i,e,n,a,t)}catch(e){Te(s,1,74,"send request notification failed: "+e)}},r||a,0)},function(){return{batches:Q(e),reason:n,isSync:a,sendSync:r,sendType:t}},!a)}}var c,l}var oe=!0;e.initialize=function(e,n,t,r,i){var o;i||(i={}),h=e+h,M=!!P(i.avoidOptions)||!i.avoidOptions,u=n,l=n.getCookieMgr(),E=!u.config.disableEventTimings;var m=!!u.config.enableCompoundKey;s=(a=t).diagLog();var y=i.valueSanitizer,b=i.stringifyObjects;P(i.enableCompoundKey)||(m=!!i.enableCompoundKey),f=i.xhrTimeout,d=!!i.disableXhrSync,p=!!i.disableFetchKeepAlive,g=!1!==i.addNoResponse,C=!fe(),O=new ou(u,y,b,m),T(i.useSendBeacon)||(C=!!i.useSendBeacon);var S=r,I=i.alwaysUseXhrOverride?r:null,x=i.alwaysUseXhrOverride?r:null,A=[3,2];if(!r){k=!1;var L=ce();L&&L.protocol&&"file:"===L.protocol.toLowerCase()&&(oe=!1);var U=[];fe()?(U=[2,1],A=[2,1,3]):U=[1,2,3],(r=w(U=Yn(U,i.transports),!1))||ke(s,"No available transport to send events"),S=w(U,!0)}I||(I=w(A=Yn(A,i.unloadTransports),!0)),v=!k&&(C&&ve()||!p&&ge(!0)),(o={})[0]=r,o[1]=S||w([1,2,3],!0),o[2]=I||S||w([1],!0),o[3]=x||w([2,3],!0)||S||w([1],!0),c=o},e._getDbgPlgTargets=function(){return[c[0],m,O,c]},e.addQueryStringParameter=function(e,n){for(var t=0;t<I.length;t++)if(I[t].name===e)return void(I[t].value=n);I.push({name:e,value:n})},e.addHeader=function(e,n){x[e]=n},e.canSendRequest=function(){return q()&&b.allowRequestSending()},e.sendQueuedRequests=function(e,n){P(e)&&(e=0),_&&(e=V(e),n=2),K(A,e,0)&&J(W(),0,!1,e,n||0)},e.isCompletelyIdle=function(){return!y&&0===S&&0===A.length},e.setUnloading=function(e){_=e},e.addBatch=function(e){if(e&&e.count()>0){if(m.isTenantKilled(e.iKey()))return!1;A.push(e)}return!0},e.teardown=function(){A.length>0&&J(W(),0,!0,2,2)},e.pause=function(){y=!0},e.resume=function(){y=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,n,t){e&&e.count()>0&&(T(n)&&(n=1),_&&(n=V(n),t=2),J([e],0,!1,n,t||0))}})}return e.__ieDyn=1,e}(),pu=.25,vu=500,gu=20,hu=6,mu=2,yu=4,bu=2,Cu=1,Su="eventsDiscarded",wu="overrideInstrumentationKey",Pu="maxEventRetryAttempts",Tu="maxUnloadEventRetryAttempts",ku="addUnloadCb",Iu=function(e){function n(){var t,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.2.8";var i,o,a,s,c,u,l,f=!1,d=[],p=null,v=!1,g=0,h=500,m=0,y=1e4,b={},C=vc,S=null,P=null,T=0,k=0,I={},x=-1,A=!0,O=!1,E=hu,U=mu;return w(n,r,function(e,n){function r(e){"beforeunload"!==(e||re().event).type&&(O=!0,o.setUnloading(O)),j(2,2)}function w(e){O=!1,o.setUnloading(O)}function M(e,n){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext[Gc]&&delete e.ext[Gc],e.ext&&e.ext[zc]&&e.ext[zc].id&&delete e.ext[zc].id,A&&(e.ext=$(e.ext),e.baseData&&(e.baseData=$(e.baseData)),e.data&&(e.data=$(e.data))),e.sync)if(T||v)e.latency=3,e.sync=!1;else if(o)return A&&(e=$(e)),void o.sendSynchronousBatch(jc.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var t=e.latency,r=m,i=y;4===t&&(r=g,i=h);var a=!1;if(r<i)a=!q(e,n);else{var s=1,c=gu;4===t&&(s=4,c=1),a=!0,function(e,n,t,r){for(;t<=n;){var i=X(e,n,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return 4===t?g-=a:m-=a,oe(Su,[o],pc.QueueFull),!0}t++}return W(),!1}(e.iKey,e.latency,s,c)&&(a=!q(e,n))}a&&ie(Su,[e],pc.QueueFull)}function D(e,n,t){var r=K(e,n,t);return o.sendQueuedRequests(n,t),r}function B(){return m>0}function F(){if(x>=0&&K(x,0,c)&&o.sendQueuedRequests(0,c),g>0&&!P&&!v){var e=b[C][2];e>=0&&(P=H(function(){P=null,D(4,0,1),F()},e))}var n=b[C][1];!S&&!p&&n>=0&&!v&&(B()?S=H(function(){S=null,D(0===k?3:1,0,1),k++,k%=2,F()},n):k=0)}function N(){t=null,f=!1,d=[],p=null,v=!1,g=0,h=500,m=0,y=1e4,b={},C=vc,S=null,P=null,T=0,k=0,i=null,I={},a=void 0,s=0,x=-1,c=null,A=!0,O=!1,E=hu,U=mu,u=null,l=tt(),o=new du(vu,bu,Cu,{requeue:ee,send:ae,sent:se,drop:ce,rspFail:ue,oth:le},l),Z(),I[4]={batches:[],iKeyMap:{}},I[3]={batches:[],iKeyMap:{}},I[2]={batches:[],iKeyMap:{}},I[1]={batches:[],iKeyMap:{}},fe()}function H(e,n){0===n&&T&&(n=1);var t=1e3;return T&&(t=Wn(T-1)),l.set(e,n*t)}function z(){return null!==S&&(l.clear(S),S=null,k=0,!0)}function j(e,n){z(),p&&(l.clear(p),p=null),v||D(1,e,n)}function X(e,n,t){var r=I[n];r||(r=I[n=1]);var i=r.iKeyMap[e];return!i&&t&&(i=jc.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function V(n,t){o.canSendRequest()&&!T&&(a>0&&m>a&&(t=!0),t&&null==p&&e.flush(n,null,20))}function q(e,n){A&&(e=$(e));var t=e.latency,r=X(e.iKey,t,!0);return!!r.addEvent(e)&&(4!==t?(m++,n&&0===e.sendAttempt&&V(!e.sync,s>0&&r.count()>=s)):g++,!0)}function W(){for(var e=0,n=0,t=1;t<=4;t++)!function(t){var r=I[t];r&&r.batches&&R(r.batches,function(r){4===t?e+=r.count():n+=r.count()})}(t);m=n,g=e}function K(n,t,r){var i=!1,a=0===t;return!a||o.canSendRequest()?Y(e.core,function(){return"PostChannel._queueBatches"},function(){for(var e=[],t=4;t>=n;){var r=I[t];r&&r.batches&&r.batches.length>0&&(R(r.batches,function(n){o.addBatch(n)?i=i||n&&n.count()>0:e=e.concat(n.events()),4===t?g-=n.count():m-=n.count()}),r.batches=[],r.iKeyMap={}),t--}e.length>0&&ie(Su,e,pc.KillSwitch),i&&x>=n&&(x=-1,c=0)},function(){return{latency:n,sendType:t,sendReason:r}},!a):(x=x>=0?Math.min(x,n):n,c=Math.max(c,r)),i}function Q(e,n){D(1,0,n),W(),J(function(){e&&e(),d.length>0?p=H(function(){p=null,Q(d.shift(),n)},0):(p=null,F())})}function J(e){o.isCompletelyIdle()?e():p=H(function(){p=null,J(e)},pu)}function Z(){(b={})[vc]=[2,1,0],b[gc]=[6,3,0],b[hc]=[18,9,0]}function ee(n,t){var r=[],i=E;O&&(i=U),R(n,function(n){n&&n.count()>0&&R(n.events(),function(n){n&&(n.sync&&(n.latency=4,n.sync=!1),n.sendAttempt<i?(Tn(n,e.identifier),M(n,!1)):r.push(n))})}),r.length>0&&ie(Su,r,pc.NonRetryableStatus),O&&j(2,2)}function te(n,t){var r=e._notificationManager||{},i=r[n];if(i)try{i.apply(r,t)}catch(t){Te(e.diagLog(),1,74,n+" notification failed: "+t)}}function ie(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&te(e,[n].concat(t))}function oe(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&R(n,function(n){n&&n.count()>0&&te(e,[n.events()].concat(t))})}function ae(e,n,t){e&&e.length>0&&te("eventsSendRequest",[n>=1e3&&n<=1999?n-1e3:0,!0!==t])}function se(e,n){oe("eventsSent",e,n),F()}function ce(e,n){oe(Su,e,n>=8e3&&n<=8999?n-8e3:pc.Unknown)}function ue(e){oe(Su,e,pc.NonRetryableStatus),F()}function le(e,n){oe(Su,e,pc.Unknown),F()}function fe(){s=t&&t.disableAutoBatchFlushLimit?0:Math.max(vu*(bu+1),y/6)}N(),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(s,c,f){Y(c,function(){return"PostChannel:initialize"},function(){var d=c;n.initialize(s,c,f);try{c[ku],u=ln(Oe(e.identifier),c.evtNamespace&&c.evtNamespace());var p=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},t=p.getExtCfg(e.identifier),l=tt(t.setTimeoutOverride,t.clearTimeoutOverride),A=!t.disableOptimizeObj&&!!ne("chrome"),function(e){var n=e.getWParam;e.getWParam=function(){var e=0;return t.ignoreMc1Ms0CookieProcessing&&(e|=2),e|n()}}(d),t.eventsLimitInMem>0&&(y=t.eventsLimitInMem),t.immediateEventLimit>0&&(h=t.immediateEventLimit),t.autoFlushEventsLimit>0&&(a=t.autoFlushEventsLimit),_(t[Pu])&&(E=t[Pu]),_(t[Tu])&&(U=t[Tu]),fe(),t.httpXHROverride&&t.httpXHROverride.sendPOST&&(i=t.httpXHROverride),bn(s.anonCookieName)&&o.addQueryStringParameter("anoncknm",s.anonCookieName),o.sendHook=t.payloadPreprocessor,o.sendListener=t.payloadListener;var v=t.overrideEndpointUrl?t.overrideEndpointUrl:s.endpointUrl;e._notificationManager=c.getNotifyMgr(),o.initialize(v,e.core,e,i,t);var g=s.disablePageUnloadEvents||[];(function(e,n,t,r){n&&e&&bo(e)&&!pn(e,n,t,r)&&t&&t[Hr]>0&&pn(e,n,null,r)})([rs,ts,es],r,g,u),gn(r,g,u),hn(w,s.disablePageShowEvents,u)}catch(n){throw e.setInitialized(!1),n}},function(){return{coreConfig:s,core:c,extensions:f}})},e.processTelemetry=function(n,r){Tn(n,e.identifier);var i=(r=e._getTelCtx(r)).getExtCfg(e.identifier),o=!!t.disableTelemetry;i&&(o=o||!!i.disableTelemetry);var a=n;o||f||(t[wu]&&(a.iKey=t[wu]),i&&i[wu]&&(a.iKey=i[wu]),M(a,!0),O?j(2,2):F()),e.processNext(a,r)},e._doTeardown=function(e,n){var t;j(2,2),f=!0,o.teardown(),vn([rs,ts,es],null,u),t=ln(is,u),vn([es],null,t),vn([Ya],null,t),function(e,n){var t=ln(os,u);vn([ns],null,t),vn([Ya],null,t)}(),N()},e.setEventQueueLimits=function(e,n){y=e>0?e:1e4,a=n>0?n:0,fe();var t=m>e;if(!t&&s>0)for(var r=1;!t&&r<=3;r++){var i=I[r];i&&i.batches&&R(i.batches,function(e){e&&e.count()>=s&&(t=!0)})}V(!0,t)},e.pause=function(){z(),v=!0,o.pause()},e.resume=function(){v=!1,o.resume(),F()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){z(),Z(),C=vc,F(),L(e,function(e,n){var t=n.length;if(t>=2){var r=t>2?n[2]:0;if(n.splice(0,t-2),n[1]<0&&(n[0]=-1),n[1]>0&&n[0]>0){var i=n[0]/n[1];n[0]=Math.ceil(i)*n[1]}r>=0&&n[1]>=0&&r>n[1]&&(r=n[1]),n.push(r),b[e]=n}})},e.flush=function(e,n,t){if(void 0===e&&(e=!0),!v)if(t=t||1,e)null==p?(z(),K(1,0,t),p=H(function(){p=null,Q(n,t)},0)):d.push(n);else{var r=z();D(1,1,t),null!=n&&n(),r&&F()}},e.setMsaAuthTicket=function(e){o.addHeader(Fc,e)},e.hasEvents=B,e._setTransmitProfile=function(e){C!==e&&void 0!==b[e]&&(z(),C=e,F())},e._backOffTransmission=function(){T<yu&&(T++,z(),F())},e._clearBackOff=function(){T&&(T=0,z(),F())},G(e,"_setTimeoutOverride",function(){return l.set},function(e){l=tt(e,l.clear)}),G(e,"_clearTimeoutOverride",function(){return l.clear},function(e){l=tt(l.set,e)})}),r}return l(n,e),n.__ieDyn=1,n}(_a),xu=function(e){function n(){var t,r,i=e.call(this)||this;return w(n,i,function(e,n){e.initialize=function(e,o){var a=i;Y(i,function(){return"ApplicationInsights:initialize"},function(){t=new Iu;var i=[r=new dc];o&&(i=i.concat(o)),e||Q("You must provide a config object!");var s=e.channels;if(s&&s.length>0){for(var c=!1,u=0;u<s[0].length;u++)if(s[0][u].identifier===t.identifier){c=!0;break}c||s[0].push(t)}else e.channels=[[t]];var l=e.extensionConfig=e.extensionConfig||[];l[t.identifier]=e?e.channelConfiguration:{},l[r.identifier]=e?e.propertyConfiguration:{};try{n.initialize(e,i)}catch(e){Te(a.logger,1,514,"Failed to initialize SDK."+pe(e))}},function(){return{config:e,extensions:o}})},e.getPropertyManager=function(){return r},e.getPostChannel=function(){return t}}),i}return l(n,e),n.__ieDyn=1,n}(Cs),Au=["app","bootstrapperVersion","clientContextType","clientType","complianceEnvironment","culture","ErrorMessage","ErrorType","flights","hostAppRing","hostAppVersion","IsClientOnline","isConsumer","isConsumer","IsExpected","lokiUrl","name","Perf_AuthRequestDuration","Perf_GetAuthTokenDuration","Perf_GetAuthTokenFromStartDuration","Perf_GetLokiConfigDuration","Perf_GetLokiConfigFromStartDuration","Perf_GetLpcBundlesDuration","Perf_GetLpcBundlesFromStartDuration","Perf_GetLpeBundlesDuration","Perf_GetLpeBundlesFromStartDuration","Perf_InitConfigRequestDuration","Perf_LpcBundleRequestDuration","Perf_LpcStringsRequestDuration","Perf_StartLpcDuration","Perf_StartLpcFromStartDuration","platform","region","settings","versionOverride"],Lu="1.20230502.6.0",Ou=function(){return(Ou=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)},Eu="https://midgardbranches.blob.core.windows.net/lpc/refs/heads/",Uu=new RegExp("https?://localhost(:|/|$)"),_u=gt.p,Mu=["https://res.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-1.cdn.partner.office365.cn","https://outlook-1-cdn.azureedge.eaglex.ic.gov","https://outlook-1-cdn.azureedge.microsoft.scloud"],Du="/_next/",Bu=function(e,n,t,r){return new(t||(t=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):((n=e.value)instanceof t?n:new t(function(e){e(n)})).then(a,s)}c((r=r.apply(e,n||[])).next())})},Ru=function(e,n){function t(t){return function(c){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,t[0]&&(s=0)),s;)try{if(r=1,i&&(o=2&t[0]?i.return:t[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,t[1])).done)return o;switch(i=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(e,s)}catch(e){t=[6,e],i=0}finally{r=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,c])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Fu=2,Nu="data-is-midgard-bootstrapper-script",Hu=function(){return(Hu=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)},Gu=new WeakMap,zu=function(e,n,t,r){return new(t||(t=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):((n=e.value)instanceof t?n:new t(function(e){e(n)})).then(a,s)}c((r=r.apply(e,n||[])).next())})},ju=function(e,n){function t(t){return function(c){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,t[0]&&(s=0)),s;)try{if(r=1,i&&(o=2&t[0]?i.return:t[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,t[1])).done)return o;switch(i=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(e,s)}catch(e){t=[6,e],i=0}finally{r=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,c])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Xu=2,Vu=0,qu="livepersonacard_with-react",Wu="livepersonacard_without-react",Ku="livepersonacardstrings",Qu=function(e,n,t,r){return new(t||(t=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):((n=e.value)instanceof t?n:new t(function(e){e(n)})).then(a,s)}c((r=r.apply(e,n||[])).next())})},Ju=function(e,n){function t(t){return function(c){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,t[0]&&(s=0)),s;)try{if(r=1,i&&(o=2&t[0]?i.return:t[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,t[1])).done)return o;switch(i=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(e,s)}catch(e){t=[6,e],i=0}finally{r=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,c])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},$u=function(e,n,t){if(t||2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))},Zu=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-start"))}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-end")),this.targetWindow.performance.measure(e,"".concat(e,"-start"),"".concat(e,"-end"));var n=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(n.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var n=this.targetWindow.performance.getEntriesByType("resource");n&&n.forEach(function(n){if(n&&n.name){var t=n.name.toLowerCase(),r=Math.round(n.duration);-1!==t.indexOf("authtoken/loki")||-1!==t.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?e.timings.Perf_AuthRequestDuration=r:-1!==t.indexOf("/lpc/versionless/livepersonacard_")?e.timings.Perf_LpcBundleRequestDuration=r:-1!==t.indexOf("/lpc/versionless/livepersonacardstrings")?e.timings.Perf_LpcStringsRequestDuration=r:-1!==t.indexOf("/api/v1/configuration/")&&(e.timings.Perf_InitConfigRequestDuration=r)}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}(),Yu=["Df","Msit","Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin","AG08","AG09","Unknown"],el=["msit","df"],nl=function(){return(nl=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)},tl=function(e,n,t,r){return new(t||(t=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):((n=e.value)instanceof t?n:new t(function(e){e(n)})).then(a,s)}c((r=r.apply(e,n||[])).next())})},rl=function(e,n){function t(t){return function(c){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,t[0]&&(s=0)),s;)try{if(r=1,i&&(o=2&t[0]?i.return:t[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,t[1])).done)return o;switch(i=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(e,s)}catch(e){t=[6,e],i=0}finally{r=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,c])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};try{var il=window.document.createElement("link"),ol=Boolean("onmscontentzoom"in window.document);il.rel=ol?"dns-prefetch":"preconnect",il.href="https://res-1.cdn.office.net/",window.document.head.appendChild(il)}catch(gt){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",gt)}var al=function(e,n){var r=e?"1.20230114.4.0":void 0;return n.versionOverride&&(r=n.versionOverride),function(e){return tl(this,void 0,void 0,function(){var n,r,i,o,a=this;return rl(this,function(s){return!(n=st(e)).forceRefreshInitializationPromise&&n.initializationPromise||(r=function(){return n?n.oneDsLogger:void 0},i=n.bootstrapperConfig.targetWindow,o=new Zu(i),n.forceRefreshInitializationPromise=!1,n.initializationPromise=new Promise(function(s,c){return tl(a,void 0,void 0,function(){var a,u,l,f,d,p,v,g,h,m,y;return rl(this,function(b){switch(b.label){case 0:n.abandonInitializationPromise=function(){var n,t={name:"LPCInitializationAbandonmentError",message:"Live persona card initialization was abandoned",isExpected:!0},s=o.getAllTimings();null===(n=r())||void 0===n||n.logEvent(a,{name:"initializeLivePersonaCard_failure",properties:nl(nl(nl({},dt(t)),s),{isConsumer:"".concat(e.isConsumer),lpcWindowId:i.lpcWindowId})}),c("Failed to initialize Live Persona Card: ".concat(t.name," ").concat(t.message))},a=function(e){switch(e.complianceEnvironment){case"Blackforest":return"e5ad760145754ffc9704e67c800087f2-accc9196-f40d-49fd-8968-2e6240e5d84c-7381";case"GccHigh":return"e5ad760145754ffc9704e67c800087f2-3831d322-8b62-464b-8147-272e41908150-7184";case"DoD":return"e5ad760145754ffc9704e67c800087f2-27405810-62d9-4796-a308-28b057a92523-6970";case"Gallatin":return"e5ad760145754ffc9704e67c800087f2-97d9a12c-35b6-4ec7-9bb9-d00d7b5d28d2-7079";case"AG08":case"AG09":return"";default:return"e5ad760145754ffc9704e67c800087f2-994e0432-dd0e-4a24-9a3d-bb9d8a6b83f3-7303"}}(e),b.label=1;case 1:return b.trys.push([1,6,,7]),function(e){var n,t="";if(e){var r=[];pt(e.culture)&&r.push("culture"),pt(e.clientType)&&r.push("clientType"),pt(e.clientContextType)&&r.push("clientContextType"),pt(e.clientCorrelationId)&&r.push("clientCorrelationId"),(void 0===(n=e.getAuthToken)||"function"!=typeof n)&&r.push("getAuthToken"),r.length>0&&(t="Invalid required parameter(s): ".concat(r.join(", "),". Check the values and types you're passing. ")),e.region&&-1===el.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, "+"and ".concat(el.join(", ")," for pre-production environments. ")),-1===Yu.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: ".concat(Yu.join(", "),". We currently don't support other Sovereign Clouds."))}else t="Config must be defined.";if(t)throw new bt("ValidateBootstrapperConfigError",t)}(e),o.startCustomTiming("Perf_GetAuthTokenDuration"),[4,t(e.authToken,e.getAuthToken,i)];case 2:return u=b.sent(),o.endCustomTiming("Perf_GetAuthTokenDuration"),o.measureFromStart("Perf_GetAuthTokenFromStartDuration"),o.startCustomTiming("Perf_GetLokiConfigDuration"),[4,ct(u,e,i)];case 3:return l=b.sent(),o.endCustomTiming("Perf_GetLokiConfigDuration"),o.measureFromStart("Perf_GetLokiConfigFromStartDuration"),o.startCustomTiming("Perf_GetLpcBundlesDuration"),null===(v=r())||void 0===v||v.updateContextWithLokiConfig(a,l),f=function(e){var n;null===(n=r())||void 0===n||n.logVerboseEvent(a,e)},[4,lt(l,i,f,null===(g=e.options)||void 0===g?void 0:g.isTrustedTypesEnabled,null===(h=e.options)||void 0===h?void 0:h.isReuseScriptsEnabled)];case 4:return b.sent(),o.endCustomTiming("Perf_GetLpcBundlesDuration"),o.measureFromStart("Perf_GetLpcBundlesFromStartDuration"),o.startCustomTiming("Perf_StartLpcDuration"),[4,ft(l,n.bootstrapperConfig)];case 5:return b.sent(),o.endCustomTiming("Perf_StartLpcDuration"),o.measureFromStart("Perf_StartLpcFromStartDuration"),null===(m=r())||void 0===m||m.logEvent(a,{name:"initializeLivePersonaCard_success",properties:nl(nl({},o.getAllTimings()),{RootCorrelationId:l.RootCorrelationId,isConsumer:"".concat(e.isConsumer),lpcWindowId:i.lpcWindowId})}),s(),[3,7];case 6:return d=b.sent(),p=o.getAllTimings(),null===(y=r())||void 0===y||y.logEvent(a,{name:"initializeLivePersonaCard_failure",properties:nl(nl(nl({},dt(d)),p),{isConsumer:"".concat(e.isConsumer),lpcWindowId:i.lpcWindowId})}),c("Failed to initialize Live Persona Card: ".concat(d.name," ").concat(d.message)),[3,7];case 7:return n.abandonInitializationPromise=void 0,[2]}})})}),n.initializationPromise.catch(function(){n.forceRefreshInitializationTimeout=window.setTimeout(function(){n&&(n.forceRefreshInitializationPromise=!0)},3e5)})),[2,n.initializationPromise]})})}(mt(mt({},n),{versionOverride:r}))};return ht}()})}).call(n,t(53))},2408:function(e,n,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,n,t,r){function i(e){return e instanceof t?e:new t(function(n){n(e)})}return new(t||(t=Promise))(function(t,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?t(e.value):i(e.value).then(a,s)}c((r=r.apply(e,n||[])).next())})},o=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,o=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=n.call(e,c)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(n,"__esModule",{value:!0});var a=t(34),s=t(129),c=t(285),u=t(142),l=function(e,n,t){return function(r){var i={slug:r.peopleSlug||r.slug,groupName:r.groupName||r.teamName,middlePane:r.middlePane,threadId:r.threadId,messageId:void 0,ctx:r.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return t.navigatePromise(n,e.states.appConversation,i)}},f=function(e,n){return function(t,r){return void 0===r&&(r=!1),i(void 0,void 0,void 0,function(){var i,a,s;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e.getChatConversationWith(t)];case 1:if(!(i=o.sent()))throw"Invalid chat conversation.";return[3,3];case 2:return a=o.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(a),[2,Promise.reject("_placeCall(): Failed to find chat conversation with error "+s)];case 3:return[2,n.placeCall({conversationId:i.id,withVideo:r,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})]}})})}},d=function(e,n){return function(t,r){return i(void 0,void 0,void 0,function(){var i,a,s,c;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e.getChatConversationWith(t)];case 1:if(!(i=o.sent()))throw"Invalid chat conversation";return[3,3];case 2:return a=o.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(a),[2,Promise.reject("_sendMessage(): Cannot find the chat with error "+s)];case 3:return c=SkypeX.Services.Utilities.newClientMessageId(),[2,n.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:r,messagePreview:r,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:c,externalId:null,draftObjectId:null,inlineImages:null})]}})})}},p=function(e,n,t,c,u,l,f){return function(d,p){var v=d.persona;return i(void 0,void 0,void 0,function(){var i,d,g,h,m,y,b,C,S,w;return o(this,function(o){switch(o.label){case 0:n.info("LPC::Starting chat"),o.label=1;case 1:return o.trys.push([1,5,,6]),i=t.getFreshnessInMs(),d=e.scenarios.people.lpcStartChat,g=v.TeamsMri,h=v.Upn,[4,t.getAllPeopleProfile([g||h],d,!Boolean(g),!1,i)];case 2:return m=o.sent()[0],y=u.isCurrentUserTFLOrMsaAccount(),(b=s.getIsMixedChatUser(y,m.type))&&m.type===e.userTypes.tflConsumer&&(m=r(r({},m),{mri:g.replace("8:","8:tfl:")})),[4,c.getConversationWithV2(m.mri,d)];case 3:return C=o.sent(),[4,l({groupName:m.displayName,peopleSlug:C.id,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 4:return o.sent(),p(!0),f(a.LpcCallbackTelemetryType.lpcStartChat,m.mri),[3,6];case 5:return S=o.sent(),w="Failed to navigate to chat",n.error(w),p(!1,w),[3,6];case 6:return[2]}})})}},v=function(e,n,t,r,s,c){return function(u,l){return i(void 0,void 0,void 0,function(){var i,f,d,p,v,g,h;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),n.info("LPC::Navigating to user's org chart"),i=t.getFreshnessInMs(),f=e.scenarios.people.lpcOrgChart,d=u.TeamsMri,p=u.Upn,[4,t.getAllPeopleProfile([d||p],f,!Boolean(d),!1,i)];case 1:return v=o.sent()[0],(d=v.mri)!==c.getCurrentSkypeMri()?[3,3]:[4,r({slug:SkypeX.Services.ChatServiceUtils.SelfChatConversationId,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 2:return o.sent(),[3,5];case 3:return[4,r({groupName:v.displayName,slug:d,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 4:o.sent(),o.label=5;case 5:return l(!0),s(a.LpcCallbackTelemetryType.lpcOrgChart,d),[3,7];case 6:return g=o.sent(),h="Failed to navigate to org chat",n.error(h),l(!1,h),[3,7];case 7:return[2]}})})}},g=function(e,n,t,r,s,c){return function(l,f){return i(void 0,void 0,void 0,function(){var i,d,p,v,g,h;return o(this,function(o){switch(o.label){case 0:return i=e.scenarios.people.lpcLinkedIn,[4,u.resolveMriIfNeeded(l,t,i)];case 1:d=o.sent(),o.label=2;case 2:return o.trys.push([2,6,,7]),n.info("LPC::Navigating to user's LinkedIn"),[4,t.getPeopleProfile(d,i,!1)];case 3:return p=o.sent(),[4,r.getChatConversationWith(d)];case 4:return v=o.sent(),[4,s({groupName:p.displayName,slug:v.id,middlePane:e.peopleTab.panes.linkedin,ctx:e.navigation.context.chat})];case 5:return o.sent(),f&&f(!0),c(a.LpcCallbackTelemetryType.lpcLinkedIn,d),[3,7];case 6:return g=o.sent(),h="Failed to navigate to LinkedIn.",n.error(h),f&&f(!1,h),[3,7];case 7:return[2]}})})}},h=function(e,n,t,r,s){return function(c,l){return i(void 0,void 0,void 0,function(){var i,f,d,p;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),n.info("LPC::Starting audio call"),i=e.scenarios.people.lpcGetPersonaInfo,[4,u.resolveMriIfNeeded(c,t,i)];case 1:return f=o.sent(),[4,r(f)];case 2:return o.sent(),l(!0),s(a.LpcCallbackTelemetryType.lpcAudioCall,f),[3,4];case 3:return d=o.sent(),p="Failed to start audio call with",n.error(p),l(!1,p),[3,4];case 4:return[2]}})})}},m=function(e,n,t,r,s){return function(c,l){return i(void 0,void 0,void 0,function(){var i,f,d,p;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),n.info("LPC::Starting video call"),i=e.scenarios.people.lpcGetPersonaInfo,[4,u.resolveMriIfNeeded(c,t,i)];case 1:return f=o.sent(),[4,r(f,!0)];case 2:return o.sent(),l(!0),s(a.LpcCallbackTelemetryType.lpcVideoCall,f),[3,4];case 3:return d=o.sent(),p="Failed to start video call with",n.error(p),l(!1,p),[3,4];case 4:return[2]}})})}};n.makeSendQuickMessage=function(e,n,t,r,s){return function(c,u,l){return i(void 0,void 0,void 0,function(){var i,f,d,p,v,g;return o(this,function(o){switch(o.label){case 0:if(i=c.TeamsMri)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),f=e.scenarios.people.lpcSendQuickMessage,[4,t.getAllShortPeopleProfile([c.Upn],f,!0,void 0,!0,void 0,!0)];case 2:return d=o.sent()[0],i=null===d||void 0===d?void 0:d.mri,[3,4];case 3:return p=o.sent(),g="Could not resolve user",n.error(g),l(!1,g),[2];case 4:return o.trys.push([4,6,,7]),n.info("LPC::Sending message to user, message length {0}",u&&u.length),[4,r(i,u)];case 5:return o.sent(),l(!0),s(a.LpcCallbackTelemetryType.lpcQuickIM,c.TeamsMri),[3,7];case 6:return v=o.sent(),g="Failed to send message",n.error(g),l(!1,g),[3,7];case 7:return[2]}})})}};var y=function(e,n,t,r,a,s,u,l,f){return function(d,p){return i(void 0,void 0,void 0,function(){var i,v,g,h,m,y,b,C,S,w,P,T;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,7,,8]),n.info("LPC::Blocking contact"),i=e.scenarios.people.lpcBlockContact,v=d.TeamsMri,g=f.valueAsBoolean(e.settings.names.enableTfwToTfwFederatedInviteFree),[4,s.getAllShortPeopleProfile([v],i,!1,void 0,!0,void 0,!1)];case 1:return h=o.sent()[0],m=a.isCurrentUserTFLOrMsaAccount(),y=h.type,(b=c.isMixedChatUserinTFW(y,m,e.userTypes.tflConsumer))&&(v=d.TeamsMri.replace("8:","8:tfl:")),[4,t.getConversationWithV2(v,"LivePersonaCard")];case 2:return(C=o.sent())?[4,u.acceptBlockChat(C.id,!1)]:[3,4];case 3:return o.sent(),[3,6];case 4:return[4,r.addBlockedMri(d.TeamsMri,"LivePersonaCard")];case 5:o.sent(),o.label=6;case 6:return p(!0),l(c.getBlockTelemetryType(m,y,g),v,c.getTelemetryDatabag(m,h,e,null===(T=null===(P=null===C||void 0===C?void 0:C.memberProperties)||void 0===P?void 0:P.relationshipState)||void 0===T?void 0:T.edRedemptionRequired)),[3,8];case 7:return S=o.sent(),w="Failed to block contact",n.error(w),p(!1,w),[3,8];case 8:return[2]}})})}},b=function(e,n,t,r,a,s,u,l){return function(f,d){return i(void 0,void 0,void 0,function(){var i,p,v,g,h,m,y,b,C,S,w,P;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,7,,8]),n.info("LPC::Unblocking contact"),i=e.scenarios.people.lpcUnblockContact,p=f.TeamsMri,v=l.valueAsBoolean(e.settings.names.enableTfwToTfwFederatedInviteFree),[4,s.getAllShortPeopleProfile([p],i,!1,void 0,!0,void 0,!1)];case 1:return g=o.sent()[0],h=a.isCurrentUserTFLOrMsaAccount(),m=g.type,(y=c.isMixedChatUserinTFW(m,h,e.userTypes.tflConsumer))&&(p=f.TeamsMri.replace("8:","8:tfl:")),[4,t.getConversationWithV2(p,"LivePersonaCard")];case 2:return(b=o.sent())?[4,t.acceptBlockChat(b.id,!0,"LivePersonaCard")]:[3,4];case 3:return o.sent(),[3,6];case 4:return[4,r.deleteBlockedMri(f.TeamsMri,"LivePersonaCard")];case 5:o.sent(),o.label=6;case 6:return d(!0),u(c.getUnblockTelemetryType(h,m,v),p,c.getTelemetryDatabag(h,g,e,null===(P=null===(w=null===b||void 0===b?void 0:b.memberProperties)||void 0===w?void 0:w.relationshipState)||void 0===P?void 0:P.edRedemptionRequired)),[3,8];case 7:return C=o.sent(),S="Failed to unblock contact",n.error(S),d(!1,S),[3,8];case 8:return[2]}})})}},C=function(e,n,t,r,s){return function(c,u){return i(void 0,void 0,void 0,function(){var i,l,f,d;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e.info("LPC::Edit Me Profile"),[4,r.getMeMSAProfile(t.scenarios.people.lpcEditProfile,!1)];case 1:return i=o.sent(),l=t.appHeaderBar.buttonid.profileButton,n.open(t.dialogs.updateUserProfile,{isFre:!1,preActiveElementIds:[l],user:i,isMSAEditNameClick:!0}),u(!0),s(a.LpcCallbackTelemetryType.lpcEditMeProfile,c.TeamsMri),[3,3];case 2:return f=o.sent(),d="Failed to edit me user profile",e.error(d),u(!1,d),[3,3];case 3:return[2]}})})}},S=function(e,n,t,r,s){if(t.valueAsBoolean(r.settings.names.enableManageAliasPrivacy))return function(t,c){return i(void 0,void 0,void 0,function(){var i;return o(this,function(o){try{e.info("LPC::Manage discoverability settings"),n.open(r.dialogs.manageAliasPrivacyDialog,{backButtonShouldOpenSettings:!0}),c(!0),s(a.LpcCallbackTelemetryType.lpcManageDiscoverabilitySettings,t.TeamsMri)}catch(n){i="Failed to manage discoverability settings",e.error(i),c(!1,i)}return[2]})})}},w=function(e,n,t,r){if(t.valueAsBoolean(r.settings.names.enableAliasVisibilitySettings))return function(t){try{e.info("LPC::Manage alias visibility settings"),n.open(r.dialogs.manageAliasVisibilityDialog,{backButtonShouldOpenSettings:!0,referrer:r.manageAliasVisibilityDialogReferrer.lpcMeProfileCard}),t(!0)}catch(n){var i="Failed to open the Manage alias visibility settings dialog";e.error(i),t(!1,i)}}},P=function(e,n,t,r){return function(s){return i(void 0,void 0,void 0,function(){var i,c,u;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e.info("LPC::Open meeting details"),i=s.replace(/\//g,"-"),[4,t.navigateToCalendarScheduleForm(n.dialogs.meetingDetail,{slug:i,eventId:i,providerType:services.CalendarEventProviderType.userEventUsingEventId,navCtx:n.navContext.livePersonaCard})];case 1:return o.sent(),r(a.LpcCallbackTelemetryType.lpcOpenMeetingDetails,i),[3,3];case 2:throw c=o.sent(),u="Error opening meeting details",e.error(u),u;case 3:return[2]}})})}},T=function(e,n,t,r,s){return function(c,u,l){return i(void 0,void 0,void 0,function(){var i,f,d,p;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,5,,6]),e.info("LPC::Open conversation"),!Boolean(c)||!Boolean(u))throw new Error("clientThreadId and internetMessageId cannot be nullish.");return l?[4,t.navigateToChat(u,n.navigation.context.chat)]:[3,2];case 1:return o.sent(),[3,4];case 2:return i={id:JSON.stringify({channelId:c,replyChainId:u}),type:"channels",action:"view"},f={entity:i,command:{stateTransition:"new",visibilityState:"show",correlation:{source:n.navContext.livePersonaCard,startTimestamp:Date.now()}},entityOptions:{channelId:c,threadId:c,messageId:u}},[4,r.enqueueEntityCommand(f)];case 3:o.sent(),o.label=4;case 4:return s(a.LpcCallbackTelemetryType.lpcOpenConversation,u),[3,6];case 5:throw d=o.sent(),p="Error opening conversation details",e.error(p),p;case 6:return[2]}})})}},k=function(e,n,t,r){return function(a,s){return i(void 0,void 0,void 0,function(){var i,u,l,f,d,p,v,g;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e.info("LPC::Navigate to {0} within the card",a),(i=c.getTelemetryTypeFromLpcCardView(a))?(u=t.getFreshnessInMs(),l=n.scenarios.people.lpcSignalInternalNavigation,f=s.TeamsMri,d=s.Upn,[4,t.getAllShortPeopleProfile([f||d],l,!Boolean(f),void 0,!0,void 0,!0)]):(e.warn("LPC::Navigate to unsupported {0} within the card",a),[2]);case 1:return p=o.sent()[0],f=p.mri,r(i,f),[3,3];case 2:return v=o.sent(),g="Error in logging the LPC internal event navigating to "+a,e.error(g),[3,3];case 3:return[2]}})})}},I=function(e,n,t,r){return function(i,o){try{e.info("LPC::Edit Profile Photo"),n.open(t.dialogs.changeUserPicture),o(!0),r(a.LpcCallbackTelemetryType.lpcOpenEditPictureDialog,i.TeamsMri)}catch(n){var s="Failed to edit profile picture";e.error(s),o(!1,s)}}};n.LPCActionCallbackFactory=function(e,t,r,i,o,a,s,c,u,x,A,L,O,E,U,_){var M=l(t,e,s),D=f(o,c),B=d(o,u);return{startChat:p(t,r,i,o,a,M,U),showOrgChart:v(t,r,i,M,U,_),showLinkedIn:g(t,r,i,o,M,U),sendQuickMessage:n.makeSendQuickMessage(t,r,i,B,U),startVideoCall:m(t,r,i,D,U),startAudioCall:h(t,r,i,D,U),blockContact:y(t,r,o,x,a,i,O,U,L),unblockContact:b(t,r,o,x,a,i,U,L),editMeProfile:C(r,A,t,i,U),manageDiscoverabilitySettings:S(r,A,L,t,U),openAliasVisibilitySettings:w(r,A,L,t),openMeetingAsync:P(r,t,s,U),openTeamsConversationAsync:T(r,t,s,E,U),signalInternalNavigationAsync:k(r,t,i,U),updatePhoto:I(r,A,t,U)}}},2409:function(e,n,t){"use strict";function r(e,n){return{disableChatFromKillSwitch:e.valueAsBoolean(n.settings.names.disableLpcStartChatHeaderButton),disableOrgChartFromKillSwitch:e.valueAsBoolean(n.settings.names.disableLpcOrgChartHeaderButton),disableVideoFromKillSwitch:e.valueAsBoolean(n.settings.names.disableLpcStartVideoCallHeaderButton),disableAudioCallFromKillSwitch:e.valueAsBoolean(n.settings.names.disableLpcStartAudioCallHeaderButton)}}function i(e){return e&&validator.isEmail(e)}function o(e,n,t){var r=this;return function(i,o,a){return l(r,void 0,void 0,function(){var r,o,s,c,u,l;return f(this,function(f){switch(f.label){case 0:r=n.service.newScenario(t.scenarios.people.lpcGetOrgChart),o=i.TeamsMri||i.Smtp||i.Upn,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,e.getOrgChart(o,t.scenarios.people.lpcCallerName)];case 2:return(s=f.sent())?(c=v.getDirectReportsAndManager(s.value),r.stop(),a(c,void 0)):(l="No orgChart returned",n.error(l),r.stop({reason:l}),a(void 0,l)),[3,4];case 3:return u=f.sent(),l="Exception in orgChart call",n.error("getOrgChart failed in LPC data callback"),r.fail({reason:l}),a(void 0,l),[3,4];case 4:return[2]}})})}}function a(e,n,t,r){var i=this;return function(o,a){return l(i,void 0,void 0,function(){var i,s,c,u,l,d,p,g;return f(this,function(f){switch(f.label){case 0:if(!n.valueAsBoolean(r.settings.names.enableFetchOrgchartProfilesFromHost))return a(void 0,"enableFetchOrgchartProfilesFromHost flag is set to false"),[2];if(!o||0===o.length)return a(void 0,"list of identifiers should not be empty"),[2];i=t.service.newScenario(r.scenarios.people.lpcGetPersonaProfiles),f.label=1;case 1:return f.trys.push([1,3,,4]),s=v.getUpnOrSmtpListFromPersonaIdentifiersList(o),[4,e.getAllShortPeopleProfile(s,r.scenarios.people.lpcGetPersonaProfiles,!0)];case 2:return(c=f.sent())&&0!==c.length?(l=c.map(function(e){return{displayName:e.displayName,department:e.department,jobTitle:e.jobTitle,upn:e.userPrincipalName,teamsMri:e.mri,aadObjectId:e.objectId}}),a(l,void 0),[3,4]):(u="People profiles not found",t.error(u),i.stop({reason:u}),a(void 0,u),[2]);case 3:return d=f.sent(),p=teamspace.services.AppsServiceUtils.getSafeError(d),g="getPeopleProfilesCallback(): Failed with error: "+p.message,t.error(g),i.fail({errorMessage:p.message,errorCode:p.errorCode}),a(void 0,g),[3,4];case 4:return[2]}})})}}function s(e,n,t,r,i,o,a){var s=this;return function(c,u,d){return l(s,void 0,void 0,function(){var s,u,l,h,m,y,b,C,S,w,P,T,k,I,x,A,L,O,E,U,_,D,B;return f(this,function(f){switch(f.label){case 0:if(s=n.service.newScenario(i.scenarios.people.lpcGetHeaderInfo),c.TopicId)return u={cardType:"Topic",headerInfo:{userHeaderInfo:{}}},s.stop(),d(u,void 0),[2];l=c.TeamsMri||c.Smtp||c.Upn,f.label=1;case 1:return f.trys.push([1,8,,9]),h=p.deserializeHostAppPersonaId(c.HostAppPersonaId),m=h.isSharedChannel,y=h.hostTenantId,b=h.hostConversationId,C=h.isExchangeOnlyContact,S=void 0,m?[4,e.getAllPeopleProfileForConversation([l],b,!1,i.scenarios.people.lpcGetHeaderInfoSC,void 0,m,y)]:[3,3];case 2:return S=f.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfoSC),[3,7];case 3:return C?[4,v.getPersonaProfileByContactId(c.OlsPersonaId,n,o,s,i.scenarios.people.lpcGetHeaderInfoEC)]:[3,5];case 4:return(S=f.sent())?[3,7]:[2,d(void 0,"No profile returned for exchange contact in LPC getHeaderInfoAndCardType callback")];case 5:return[4,e.getAllPeopleProfile([l],i.scenarios.people.lpcGetHeaderInfo,!Boolean(c.TeamsMri))];case 6:S=f.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfo),f.label=7;case 7:return(w=S[0])?(P=w,T=t.getCurrentSkypeMri(),k=T===c.TeamsMri,I=SkypeX.Services.ChatServiceUtils.isAnonymousUserMri(c.TeamsMri),x=p.determineCardTypeForTargetUser(P.role,P.type,P.email,k,I,i,e),A=r.valueAsBoolean(i.settings.names.showOnlySearchablePhonesAndEmailsInLPC),L=a.isCurrentUserTFLOrMsaAccount(),O=v.getIsMixedChatUser(L,P.type),E=m&&P.xtapUser?P.tenantName:void 0,U=g.isExtendedDirectoryUser(P.userType,i),_=M(x,P,A,O,E,m,L,U),s.stop(),d(_,void 0)):(B="No profile returned",n.error("getAllPeopleProfile returned no profile in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:B}),d(void 0,B)),[3,9];case 8:return D=f.sent(),B="Exception in profile call",n.error("getAllPeopleProfile failed in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:B}),d(void 0,B),[3,9];case 9:return[2]}})})}}function c(e,n,t,r,i,o,a){var s=this;return function(c,u){return l(s,void 0,void 0,function(){var s,l,d,h,m,y,b,C,S,w,P,T,k,I,x,A,L,O,E,U,_;return f(this,function(f){switch(f.label){case 0:s=n.service.newScenario(r.scenarios.people.lpcGetPersonaInfo),l=c.TeamsMri||c.Smtp||c.Upn,f.label=1;case 1:return f.trys.push([1,8,,9]),d=p.deserializeHostAppPersonaId(c.HostAppPersonaId),h=d.isSharedChannel,m=d.hostTenantId,y=d.hostConversationId,b=d.isExchangeOnlyContact,C=void 0,h?[4,e.getAllPeopleProfileForConversation([l],y,!1,r.scenarios.people.lpcGetPersonaInfoSC,void 0,h,m)]:[3,3];case 2:return C=f.sent(),s.mark(r.scenarios.people.lpcGetPersonaInfoSC),[3,7];case 3:return b?[4,v.getPersonaProfileByContactId(c.OlsPersonaId,n,i,s,r.scenarios.people.lpcGetPersonaInfoEC)]:[3,5];case 4:return(C=f.sent())?[3,7]:[2,u(void 0,"No profile returned for exchange contact in LPC getPersonaInfo callback")];case 5:return[4,e.getAllPeopleProfile([l],r.scenarios.people.lpcGetPersonaInfo,!Boolean(c.TeamsMri))];case 6:C=f.sent(),s.mark(r.scenarios.people.lpcGetPersonaInfo),f.label=7;case 7:return(S=C[0])?(w=S,P=o.isCurrentUserTFLOrMsaAccount(),T=v.getIsMixedChatUser(P,w.type),k=P&&T,I=g.isExtendedDirectoryUser(w.userType,r),x=t.valueAsBoolean(r.settings.names.showOnlySearchablePhonesAndEmailsInLPC)&&!k,A=t.valueAsBoolean(r.settings.names.enableAliasVisibilitySettings),L=a.getCurrentSkypeMri(),O=L===c.TeamsMri,E={aadObjectId:w.objectId,department:w.department,company:w.companyName||w.tenantName||void 0,displayName:w.displayName,email:A&&P&&O?void 0:v.getEmail(w,x),extraEmails:A?v.getVisibleEmails(w):v.getEmails(w,x),firstName:w.givenName,hostAppPersonaId:c.HostAppPersonaId,isInformationBarrierBarred:w.isIbBarred,isMixedChatUser:T,isExtendedDirectoryUser:I,jobTitle:w.jobTitle,lastName:w.surname,officeLocation:w.userLocation,phoneNumbersAndUrls:A?v.getVisiblePhones(w):v.getPhoneNumbers(w,x),skypeId:w.skypeId,teamsMri:c.TeamsMri||w.mri,upn:w.userPrincipalName,userType:p.determineLPCPersonaType(w,r)},s.stop(),u(E,void 0)):(_="No profile returned",n.error("getAllPeopleProfile returned no profile in LPC GetPersonaInfo callback"),s.fail({reason:_}),u(void 0,_)),[3,9];case 8:return U=f.sent(),_="Exception in profile call",n.error("getAllPeopleProfile failed in LPC GetPersonaInfo callback"),s.fail({reason:_}),u(void 0,_),[3,9];case 9:return[2]}})})}}var u=this&&this.__assign||function(){return(u=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)},l=this&&this.__awaiter||function(e,n,t,r){function i(e){return e instanceof t?e:new t(function(n){n(e)})}return new(t||(t=Promise))(function(t,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?t(e.value):i(e.value).then(a,s)}c((r=r.apply(e,n||[])).next())})},f=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,o=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=n.call(e,c)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(n,"__esModule",{value:!0});var d=t(34),p=t(142),v=t(129),g=t(39);n.convertHTMLEntities=function(e,n){return e=n.decodeHtml(e),e=n.replaceNewlines(e),e=e.replace(/=""/g,"")},n.unescapeHtmlEntities=function(e,t){if(!e)return e;var r=document.createElement("textarea"),i=(new DOMParser).parseFromString(e,"text/html").body.innerHTML.toString(),o=n.convertHTMLEntities(i,t);return r.textContent=o,r.value};var h=function(e,n,t,r,o){return function(a,s){return l(void 0,void 0,void 0,function(){var c,l,d,g,h,m,y,b,C,S,w,P,T,k;return f(this,function(f){switch(f.label){case 0:if(c=e.service.newScenario(t.scenarios.people.lpcGetImageUri),l=p.deserializeHostAppPersonaId(a.HostAppPersonaId),d=l.isSharedChannel,g=l.hostTenantId,h=l.hostConversationId,m=l.isExchangeOnlyContact,y={mri:a.TeamsMri,principalName:a.Upn||a.Smtp||a.TeamsMri,displayName:a.DisplayName||"",size:t.profilePictureSizes.medium},b=!1,C=i(y.principalName),S=d&&!C,a.DisplayName&&!S)return[3,9];w=a.TeamsMri||a.Smtp||a.Upn,f.label=1;case 1:return f.trys.push([1,8,,9]),P=void 0,d?[4,r.getAllPeopleProfileForConversation([w],h,!0,t.scenarios.people.lpcGetImageUriSC,void 0,d,g)]:[3,3];case 2:return P=f.sent(),c.mark(t.scenarios.people.lpcGetImageUriSC),[3,7];case 3:return m?[4,v.getPersonaProfileByContactId(a.OlsPersonaId,e,o,c,t.scenarios.people.lpcGetImageUriEC)]:[3,5];case 4:return P=f.sent(),[3,7];case 5:return[4,r.getAllShortPeopleProfile([w],t.scenarios.people.lpcGetImageUri,!Boolean(a.TeamsMri))];case 6:P=f.sent(),c.mark(t.scenarios.people.lpcGetImageUri),f.label=7;case 7:return(T=P[0])&&(y=u(u({},y),{displayName:T.displayName}),S&&(y=u(u({},y),{principalName:T.userPrincipalName})),T.isIbBarred&&(b=!0)),[3,9];case 8:return k=f.sent(),e.error("Failed to fetch persona profile in getAndPrefetchPersonaImageUri callback"),[3,9];case 9:return d&&(y=u(u({},y),{isSharedChannel:d,hostTenantId:g,conversationId:h})),m&&(y=u(u({},y),{isExchangeOnlyContact:m})),y=u(u({},y),{isExternalUser:"External"===a.PersonaType,isGuestUser:"Guest"===a.PersonaType}),n.loadImage(y,!1,b,!1,d?t.scenarios.people.lpcGetImageUriSC:t.scenarios.people.lpcGetImageUri).then(function(e){var n=e&&e.imgUrl||"";c.stop(),s(n,{})}).catch(function(e){c.fail({reason:"Failed to fetch persona"}),s(void 0,void 0,e)}),[2]}})})}};n.getSkypeConsumerChatStatus=function(e,n,t,r){return l(void 0,void 0,void 0,function(){var i,o,a,s;return f(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,n.findConversationWith(t)];case 1:return(i=c.sent())&&i.isSfC()?(o=i.InteropConversationStatus())===e.interopConversationStatus.blocked?[2,d.PersonaPresence.blocked]:[2,d.PersonaPresence.none]:[2,void 0];case 2:return a=c.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(a),r.debug("getSkypeConsumerChatStatus(): Failed to get skype consumer chat status with error "+s),[2,void 0];case 3:return[2]}})})};var m=function(e,t,r,i,o,a){return l(void 0,void 0,void 0,function(){var s,c,u;return f(this,function(l){switch(l.label){case 0:return[4,n.getSkypeConsumerChatStatus(r,i,o,a)];case 1:if(void 0!==(s=l.sent()))return[2,s];if(c=e.status,u=e.flwPresence,t.valueAsBoolean(r.settings.names.enableFlwPresence)){if(u===SkypeX.Services.UserFlwPresence.OffShift)return[2,d.PersonaPresence.offline];if(u===SkypeX.Services.UserFlwPresence.OnShift)switch(c){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:return[2,d.PersonaPresence.busy];default:return[2,d.PersonaPresence.online]}}switch(c){case SkypeX.Services.UserStatus.Online:return[2,d.PersonaPresence.online];case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.Unknown:return[2,d.PersonaPresence.offline];case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return[2,d.PersonaPresence.away];case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return[2,d.PersonaPresence.busy];case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return[2,d.PersonaPresence.dnd];default:return[2,d.PersonaPresence.offline]}return[2]}})})},y=function(e,n,t,r,i,o,a){if(!n||0===n.length)return e;var s=r.getLocalTimezone();if(t&&s!==t){var c=(new Date).toLocaleDateString(i.getLocale(),{timeZoneName:"short"}).split(" "),u=c.length>0?c[c.length-1]:null;u&&(n=o.instant(a.strings.person_card_on_shift_end_time_with_timezone,{shiftEndTime:n,timeZoneCode:u}))}return o.instant(a.strings.person_card_on_shift_status_label,{onShiftStatus:e,shiftEndTime:n})},b=function(e,n,t,r,i,o,a,s,c){if(!e)return{};var u=e.status,l=e.calendarData,f=e.lastSeenAt,d=e.flwPresence,p=e.extensions;if(n.valueAsBoolean(i.settings.names.enableFlwPresence)){if(d===SkypeX.Services.UserFlwPresence.OffShift)return{presenceText:t.GetTranslatedStatusText(SkypeX.Services.UserStatus.OffShift)};if(d===SkypeX.Services.UserFlwPresence.OnShift){var v=void 0,g=void 0,h=SkypeX.Services.UnifiedPresenceExtensionsParser.getShiftsData(p);switch(h&&h.currentShift&&(v=c.getDate(new Date(h.currentShift.endTime),"shortTime"),g=h.currentShift.teamOlsonCode),u){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.Presenting:var m=r.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:t.GetTranslatedStatusText(u),secondaryStatus:t.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift)});return{presenceText:y(m,v,g,s,c,r,o)};default:var b=t.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift);return{presenceText:y(b,v,g,s,c,r,o)}}}}var C=f&&(new Date).getTime()-f.getTime()<=i.timeInMiliseconds.year,S=n.valueAsBoolean(i.settings.names.enableRichAvailabilityPanelInLPC);if(l&&l.isOutOfOffice)switch(u){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return S?{presenceText:t.GetTranslatedStatusText(u)}:{presenceText:r.instant(o.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:t.GetTranslatedStatusText(u),secondaryStatus:t.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)})};case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:if(C){w=a.transformIntoTimeagoStrings(f);return{presenceText:r.instant(o.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:w.timeAgo}),presenceTextLong:w.timeAgoLong?r.instant(o.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:w.timeAgoLong}):void 0}}return{presenceText:t.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)};default:return{presenceText:t.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)}}else switch(u){case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:if(C){var w=a.transformIntoTimeagoStrings(f);return{presenceText:r.instant(o.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:w.timeAgo}),presenceTextLong:w.timeAgoLong?r.instant(o.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:w.timeAgoLong}):void 0}}return{presenceText:t.GetTranslatedStatusText(u)};default:return{presenceText:t.GetTranslatedStatusText(u)}}},C=function(e,n,t,r,i){var o="";return e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(o=r.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),o},S=function(e,n,t,r,i,o){var a={message:"",publishTime:""};if(e.note){var s=e.note.message,c=e.note.publishTime;if(c&&c.trim()){var u=new Date(c);a.publishTime=o.getMessageDisplayableDateTime(u)}if(s){var l=r.stripHtml(i.sanitizeHtml(s)).trim(),f=C(e,0,0,r,i);l.length&&!f.length&&(a.message=l)}}return a.message&&a.publishTime?a:void 0},w=function(e,t,r,i){var o=[],a=function(i){_.each(i,function(i){if("span"===i.name&&i.attribs&&i.attribs.itemtype===t.semanticObjectSchemas.mention&&i.attribs["data-itemprops"]){var s=r.DomUtils.getText(i),c=e.decodeHtml(i.attribs["data-itemprops"]),u=v.removeZeroWidthSpace(c),l=JSON.parse(u).mri;o.push({text:n.unescapeHtmlEntities(s,e),hostAppPersonaId:l,mri:l})}else"text"===i.type?o.push({text:n.unescapeHtmlEntities(r.DomUtils.getText(i),e),hostAppPersonaId:void 0}):"br"===i.name?o.push({text:" ",hostAppPersonaId:void 0}):i.children&&i.children.length>0&&a(i.children)})};return a(i),o},P=function(e,n,t,r,i,o){if(n.valueAsBoolean(t.settings.names.enableStatusNoteV2)&&e.note){var a={message:[],publishTime:""},s=e.note.message,c=e.note.publishTime;if(s){var u=i.sanitizeHtml(s).trim(),l=window.htmlparser2,f=l.parseDOM("<div>"+u+"</div>"),d=w(r,t,l,f);a.message=d}if(c&&c.trim()){var p=new Date(c);a.publishTime=o.getMessageDisplayableDateTime(p)}return a.message.length&&a.publishTime?a:void 0}},T=function(e){var n;return n=e&&e.location?e.location:SkypeX.Services.PresenceWorkLocation[SkypeX.Services.PresenceWorkLocation.Unknown],{location:n}},k=function(e,n,t,r,i,o,a,s,c,p,v,g,h,y,w){return function(k,I){return l(void 0,void 0,void 0,function(){var l,x,A;return f(this,function(f){switch(f.label){case 0:return(l=y.isBlockedContact(k))?[2,{presence:d.PersonaPresence.blocked,presenceText:a.GetTranslatedStatusText(SkypeX.Services.UserStatus.Blocked)}]:[4,e.getPresenceOnce(k,I)];case 1:return x=f.sent(),A={},[4,m(x,i,o,h,k,w)];case 2:return[2,u.apply(void 0,[u.apply(void 0,[(A.presence=f.sent(),A.isOutOfOffice=x&&!!x.calendarData&&!!x.calendarData.isOutOfOffice,A.oofMessage=x&&C(x,0,0,n,t),A),b(x,i,a,s,o,c,p,v,g)]),{statusNote:x&&S(x,0,0,n,t,r),statusNoteV2:x&&P(x,i,o,n,t,r),workLocation:T(x)}])]}})})}},I=function(e,n,t,r){return function(i){return l(void 0,void 0,void 0,function(){var o,a,s,c,u,l;return f(this,function(f){switch(f.label){case 0:o=n.getRootRouteParams(),a=o&&o.ctx===t.navigation.context.chat&&o.slug,f.label=1;case 1:return f.trys.push([1,6,,7]),a?[4,e.getConversation(o.slug)]:[3,3];case 2:(s=f.sent())&&!s.isOneOnOne()&&(s=void 0),f.label=3;case 3:return(c=s)?[3,5]:[4,e.findConversationWith(i)];case 4:c=f.sent(),f.label=5;case 5:return(s=c)&&s.isInteropChat()?[2,Promise.resolve(SkypeX.Services.PresenceSource.SFB)]:[2,Promise.resolve(SkypeX.Services.PresenceSource.UPS)];case 6:return u=f.sent(),l=teamspace.services.AppsServiceUtils.getSafeError(u),r.debug("getPresenceSourceInternal(): Failed to get presence with error "+l),[2,Promise.resolve(SkypeX.Services.PresenceSource.UPS)];case 7:return[2]}})})}},x=function(e,n,t,r,i,o,a,s,c,u,d,v,g,h,m,y,b){return function(C,S){return l(void 0,void 0,void 0,function(){var l,w,P,T,x,A,L,O,E,U;return f(this,function(f){switch(f.label){case 0:if(l=p.deserializeHostAppPersonaId(C.HostAppPersonaId).isExchangeOnlyContact)return[2,S(null,void 0)];w=a.scenarios.people.lpcGetRichPresence,P=b.service.newScenario(w),f.label=1;case 1:return f.trys.push([1,5,,6]),T=I(e,m,a,b),x=k(n,t,r,i,o,a,s,c,u,d,v,g,e,h,b),[4,p.resolveMriIfNeeded(C,y,w)];case 2:return A=f.sent(),[4,T(A)];case 3:return L=f.sent(),[4,x(A,L)];case 4:return O=f.sent(),P.stop(),S(O,void 0),[3,6];case 5:return E=f.sent(),P.fail(),U=teamspace.services.AppsServiceUtils.getSafeError(E),S(void 0,"getPresenceCallback(): Failed to execute presence callback with error "+U),[3,6];case 6:return[2]}})})}},A=function(e,n,t,i,o,a,s,c,d,h,m,y,b,C,S){return function(w){return l(void 0,void 0,void 0,function(){var l,P,T,k,I,x,A,O,E,U,_,M,D,B,R,F,N,H,G,z,j,X,V,q,W,K,Q,J,$,Z,Y,ee,ne,te,re,ie,oe,ae,se,ce,ue,le,fe,de,pe,ve,ge,he,me,ye,be,Ce,Se,we,Pe,Te;return f(this,function(f){switch(f.label){case 0:return l=o.scenarios.people.lpcGetHeaderActionsPolicy,P=i.service.newScenario(l),T={disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0,disableLinkedIn:!0},w&&p.isUnknownUser(t,w)?(P.stop({reason:"Unknown User"}),[2,T]):(k=d.getCurrentSkypeMri(),[4,p.resolveMriIfNeeded(w,t,l)]);case 1:return I=f.sent(),x=k===I,A=y.valueAsBoolean(o.settings.names.msgEnableSelfChat),O=y.valueAsBoolean(o.settings.names.enableExpandedViewInLPC),E=p.deserializeHostAppPersonaId(w.HostAppPersonaId),U=E.isSharedChannel,_=E.hostTenantId,M=E.hostConversationId,D=E.isExchangeOnlyContact,x&&!A||D?(x?P.stop({reason:"User is me"}):P.stop({reason:"Out-of-tenant outlook Contact"}),[2,u(u({},T),{disableLinkedIn:!O})]):[4,C.isPersonReachable(I)];case 2:if(B=!f.sent())return P.stop({reason:"ED only policy enabled, but user is not in Extended Directory"}),[2,T];R=y.valueAsBoolean(o.settings.names.enableSurvivabilityV2),F=!!R&&!(null===S||void 0===S?void 0:S.isOnline),N=!c.isCurrentUserTFLOrMsaAccount(),H=u(u({},T),{disableChat:!1,disableCall:!1,disableVideo:F,disableBlockUnblock:N}),G=s.isBlockedContact(I),z=r(y,o),j=z.disableChatFromKillSwitch,X=z.disableOrgChartFromKillSwitch,V=z.disableVideoFromKillSwitch,q=z.disableAudioCallFromKillSwitch,W=e.getSettingValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling),H.disableCall=q||!W||x,H.disableVideo=H.disableVideo||V||!W||x,K=n.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),Q=b.getSettingValue(SkypeX.Services.TenantSettingsStorageKey.isOrganizationTabEnabled),f.label=3;case 3:return f.trys.push([3,14,,15]),J=void 0,U?[4,t.getAllPeopleProfileForConversation([I],M,!1,o.scenarios.people.lpcGetHeaderActionsPolicySC,void 0,U,_)]:[3,5];case 4:return J=f.sent(),P.mark(o.scenarios.people.lpcGetHeaderActionsPolicySC),[3,7];case 5:return[4,t.getAllPeopleProfile([I],o.scenarios.people.lpcGetHeaderActionsPolicy,!I)];case 6:J=f.sent(),P.mark(o.scenarios.people.lpcGetHeaderActionsPolicy),f.label=7;case 7:return($=J[0])?(Z=$.featureSettings,Y=$.type,ee=$.userType,ne=$.isAnonymousUser,te=$.mri,re=$.isIbBarred,ie=$.isFederated,ne||re?(ne?P.stop({reason:"Anonymous User"}):P.stop({reason:"IB Barred User"}),[2,T]):(oe=c.isCurrentUserTFLOrMsaAccount(),ae=v.getIsMixedChatUser(oe,$.type),se=y.valueAsBoolean(o.settings.names.disableAcsOutgoingCallbackEntryPoints),ce=SkypeX.Services.ChatServiceUtils.isCallingButtonsEnabled({userMri:w.TeamsMri,disableAcsOutgoingCallbackEntryPointsFF:se}).isAudioButtonEnabled,ue=$.type===v.PersonaType.SkypeConsumer,le=y.valueAsBoolean(o.settings.names.enableTfwToTfwFederatedInviteFree),fe=!v.shouldEnableBlockUnblock({isMe:x,isAnonymousUser:ne,isLoggedInUserConsumer:oe,personaProfile:$,isTfwToTfwFederatedInviteFreeEnabled:le}),H.disableBlockUnblock=fe,G?(P.stop({reason:"Blocked Contact"}),[2,u(u({},T),{disableBlockUnblock:fe})]):(de=y.valueAsBoolean(o.settings.names.enableExtendedDirectory))&&g.isExtendedDirectoryUser(null===$||void 0===$?void 0:$.userType,o)?(P.stop({reason:"Extended Directory user"}),[2,L({disableChat:!1,disableOrg:!0,disableCalling:!0,disableBlockUnblock:!1,disableLinkedIn:!0,settingsService:y,constants:o,messagingPolicySettingsStore:n,featureSettings:Z})]):ue?[2,L({disableChat:!1,disableOrg:!0,disableCalling:!1,disableBlockUnblock:!1,disableLinkedIn:!O,settingsService:y,constants:o,messagingPolicySettingsStore:n,featureSettings:Z,isAppInOfflineMode:F})]:ae?[2,L({disableChat:!1,disableOrg:!0,disableCalling:!0,disableBlockUnblock:!1,disableLinkedIn:!O,settingsService:y,constants:o,messagingPolicySettingsStore:n,featureSettings:Z})]:ce?(pe=SkypeX.Services.ChatServiceUtils.isPstnMri(te))?(P.stop({reason:"PSTN User"}),[2,u(u({},T),{disableCall:q||!1})]):(ve=Z&&Z.isPrivateChatEnabled,ge=Y&&Y.toLowerCase()===o.userTypes.person.toLowerCase(),he=ee&&ee.toLowerCase()===o.userTypes.guest.toLowerCase(),me=a===teamspace.services.UserTypeInTenant.Guest,ye=SkypeX.Services.ChatServiceUtils.isSFBMri(te),be=ie||Y&&Y.toLowerCase()===o.userTypes.federated.toLowerCase(),H.disableChat=j||!1===ve||!K,H.disableOrg=X||!(ge&&!he)||me||!Q,H.disableLinkedIn=(be||ye)&&!O,H.disableChat?[3,12]:[4,h.getChatConversationWith(te)]):[2,L({disableChat:!1,disableOrg:!0,disableCalling:!0,disableBlockUnblock:!1,disableLinkedIn:!O,settingsService:y,constants:o,messagingPolicySettingsStore:n,featureSettings:Z})])):[3,13];case 8:if(!(Ce=f.sent())||SkypeX.Services.SkypeConversationLocal.isLie(Ce.id))return[3,12];f.label=9;case 9:return f.trys.push([9,11,,12]),[4,m.validateUpgradePolicyOfChatRecipient(Ce.id,!1)];case 10:return Se=f.sent(),we=Se&&Se.isValidChat,H.disableChat=!we,[3,12];case 11:return Pe=f.sent(),i.error("Failed to validate chat in LPC data callbacks"),[3,12];case 12:P.stop(),f.label=13;case 13:return[3,15];case 14:return Te=f.sent(),P.fail({reason:"Error while fetching persona"}),i.error("Failed to fetch persona profile in LPC data callbacks"),[3,15];case 15:return[2,H]}})})}},L=function(e){var n=e.disableChat,t=e.disableOrg,i=e.disableCalling,o=e.disableBlockUnblock,a=e.disableLinkedIn,s=e.settingsService,c=e.constants,u=e.messagingPolicySettingsStore,l=e.featureSettings,f=e.isAppInOfflineMode,d=r(s,c),p=d.disableChatFromKillSwitch,v=d.disableOrgChartFromKillSwitch,g=d.disableVideoFromKillSwitch,h=d.disableAudioCallFromKillSwitch,m=u.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),y=null===l||void 0===l?void 0:l.isPrivateChatEnabled;return{disableChat:n||Boolean(p)||!m||!1===y,disableOrg:n||t||Boolean(v),disableCall:i||Boolean(h),disableVideo:i||Boolean(g)||f,disableBlockUnblock:o,disableLinkedIn:n||a}},O=function(e,n,t,r,i,o,a,s){var c=v.getEmail(n,t);return{cardType:e,headerInfo:{userHeaderInfo:{displayName:n.displayName,firstName:n.givenName,lastName:n.surname,title:n.jobTitle,department:v.getDepartment({profile:n,isLoggedInUserConsumer:a,isSharedChannel:o,isExtendedDirectoryUser:s}),location:n.userLocation,profilePictureUrl:n.imageUri,mobilePhone:n.mobile,phone:v.getPhoneNumber(n,t),userPrincipalName:n.userPrincipalName,email:c&&c.Address,imAddress:n.skypeId,tenantName:i},isMixedChatUser:r,isExtendedDirectoryUser:s}}},E=function(e,n){return{cardType:e,headerInfo:{unresolvedHeaderInfo:{email:n}}}},U=function(e,n,t){var r=v.getEmail(n,t);return{cardType:e,headerInfo:{userHeaderInfo:{displayName:n.displayName,firstName:n.givenName,lastName:n.surname,profilePictureUrl:n.imageUri,userPrincipalName:n.userPrincipalName,email:r&&r.Address}}}},M=function(e,n,t,r,i,o,a,s){return"NotResolved"===e?E(e,n.email):"UnknownUser"===e?U(e,n,t):O(e,n,t,r,i,o,a,s)};n.makeGetHeaderInfoAndCardTypeCallback=s,n.GetPresenceSourceFunction=I,n.GetRichPresenceFunction=k,n.LPCDataCallbackFactory=function(e,n,t,r,i,u,l,f,d,p,v,g,m,y,b,C,S,w,P,T,k,I,L,O,E,U,_,M){return{getAndPrefetchPersonaImageUri:h(e,C,d,r,E),getRichPresence:x(n,t,i,u,l,f,d,p,v,g,m,y,b,S,L,r,e),getHeaderActionsPolicyAsync:A(w,P,r,e,d,T,S,I,k,n,O,f,U,_,M),getPersonaInfo:c(r,e,f,d,E,I,k),getOrgChart:o(r,e,d),getHeaderInfoAndCardType:s(r,e,k,f,d,E,I),getBatchPersonaProfiles:a(r,f,e,d)}}},2410:function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){function i(e){return e instanceof t?e:new t(function(n){n(e)})}return new(t||(t=Promise))(function(t,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?t(e.value):i(e.value).then(a,s)}c((r=r.apply(e,n||[])).next())})},i=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,o=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=n.call(e,c)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){return function(n,t){return r(void 0,void 0,void 0,function(){return i(this,function(r){return e.newSecondPartyOneDsLogger(n,t),[2]})})}},a=function(e){return function(n,t){return r(void 0,void 0,void 0,function(){return i(this,function(r){return e.logSecondPartyEvent(n,t),[2]})})}};n.LPCTelemetryCallbackFactory=function(e){return{initializeExternalOneDsTelemetry:o(e),sendExternalOneDsTelemetryEvent:a(e)}}},2411:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(2412);n.defaultTheme=r.defaultTheme;var i=t(2413);n.darkTheme=i.darkTheme;var o=t(2414);n.highContrastTheme=o.highContrastTheme},2412:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(34),i="rgba(37,36,36,0.75)",o={themeDarker:"#34365c",themePrimary:i,themeSecondary:i,neutralPrimary:"#252424",neutralSecondary:i,neutralLight:"#FAF9F8",neutralLighter:"#f3f2f1",neutralLighterAlt:"#ffffff",neutralPrimaryAlt:"#FAF9F8",neutralSecondaryAlt:"#2A2828",neutralTertiary:"#c8c6c4",neutralTertiaryAlt:"#FAF9F8",neutralQuaternary:"#f3f2f1",neutralQuaternaryAlt:"#ffffff",whiteTranslucent40:"#808080",purple:"#5B5FC7",magenta:"#943670",magentaDark:"rgba(148,54,112,0.05)",purpleLight:"#E5E5F1",purpleDark:"#6264a7",neutralDark:"#616161",neutralHover:"#f3f2f1",accent:"#6264a7"};n.defaultTheme={palette:o,semanticColors:{accentButtonBackground:"#5B5FC7",listItemBackgroundHovered:"#FAF9F8",infoIcon:"#5B5FC7",menuItemTextHovered:"#252424",buttonBackgroundHovered:"#f3f2f1",bodyTextChecked:"#616161"},isInverted:!1,themeName:r.LPCTheme.Default}},2413:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(34);n.fontColor="rgba(255,255,255,0.75)",n.white="#2d2c2c",n.darkThemePalette={themeDarker:"#C5CBFA",themePrimary:n.fontColor,themeSecondary:n.fontColor,neutralPrimary:"#ffffff",neutralSecondary:n.fontColor,neutralLight:"#3b3a39",neutralLighter:"#201F1F",neutralLighterAlt:n.white,neutralPrimaryAlt:"#3B3A3A",neutralSecondaryAlt:n.fontColor,neutralTertiary:"#605e5c",neutralTertiaryAlt:"#3b3a39",neutralQuaternary:"#201F1F",neutralQuaternaryAlt:"#201F1F",white:n.white,whiteTranslucent40:"#949494",purple:"#9399f5",magenta:"#ae3d84",magentaDark:"rgba(207,96,152,0.1)",black:"#ffffff",purpleLight:"#3D3E66",purpleDark:"#9ea2ff",neutralDark:"#D1D1D1",neutralHover:"#3B3A39",accent:"#9ea2ff"},n.darkTheme={palette:n.darkThemePalette,semanticColors:{accentButtonBackground:"#9399f5",listItemBackgroundHovered:"#3b3a39",infoIcon:"#9399f5",menuItemTextHovered:"#ffffff",buttonBackgroundHovered:"#201f1f",bodyTextChecked:"#adadad"},isInverted:!0,themeName:r.LPCTheme.Dark}},2414:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(34),i="#000000",o="#ffffff",a={themeDarker:"#ffff73",themePrimary:"#ffffff",themeSecondary:"#ffffff",neutralPrimary:o,neutralSecondary:"#ffffff",neutralLight:i,neutralLighter:o,neutralLighterAlt:o,neutralPrimaryAlt:i,neutralSecondaryAlt:"#ffffff",neutralTertiary:"#30f42c",neutralTertiaryAlt:i,neutralQuaternary:i,neutralQuaternaryAlt:o,white:i,whiteTranslucent40:"#fff",black:o,purple:"#ffff00",magenta:o,magentaDark:i,purpleLight:"#ffff01",purpleDark:"#000",neutralDark:"#fff",neutralHover:"#1aebff",accent:"#1aebff"};n.highContrastTheme={palette:a,semanticColors:{accentButtonBackground:"#ffffff",listItemBackgroundHovered:"#ffff00",infoIcon:"#000000",inputBorder:"1px solid #ffffff",menuItemTextHovered:"#000000",buttonBackgroundHovered:"#1aebff",bodyTextChecked:"#000000"},isInverted:!0,themeName:r.LPCTheme.HighContrast}},2415:function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){function i(e){return e instanceof t?e:new t(function(n){n(e)})}return new(t||(t=Promise))(function(t,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?t(e.value):i(e.value).then(a,s)}c((r=r.apply(e,n||[])).next())})},i=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,o=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=n.call(e,c)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(n,"__esModule",{value:!0});var o=teamspace.components.PanelActionGesture,a=teamspace.components.PanelActionOutcome,s=teamspace.components.PanelActionScenario,c=teamspace.components.PanelActionScenarioType,u=teamspace.components.PanelModuleName,l=teamspace.components.PanelModuleType,f=teamspace.components.WorkLoad,d=teamspace.components.SubWorkLoad,p=teamspace.PanelType,v=t(34),g=function(){function e(e,n,t){this.analyticsService=e,this.loggingService=n,this.conversationsAsyncService=t}return e.prototype.logPanelActionEvent=function(e,n,t){return r(this,void 0,void 0,function(){var r,g,h,m,y,b,C,S,w,P,T,k,I,x,A,L=this;return i(this,function(i){switch(i.label){case 0:switch(b=l.people,S=a.nav,w=a.nav,P=teamspace.PanelRegion.popover,T=f.chatContent,k=d.composeMsg,e){case v.LpcCallbackTelemetryType.lpcAudioCall:g=o.click,h=s.navCalling,m=u.lpcAudioCall,r="lpcAudioCall";break;case v.LpcCallbackTelemetryType.lpcStartChat:g=o.click,h=s.navChat,m=u.lpcStartChat,r="lpcStartChat";break;case v.LpcCallbackTelemetryType.lpcOrgChart:g=o.click,h=s.orgChart,m=u.lpcOrgChart,r="lpcOrgChart";break;case v.LpcCallbackTelemetryType.lpcOpenMeetingDetails:g=o.click,h=s.navMeetings,m=u.viewMeeting,r="lpcOpenMeeting";break;case v.LpcCallbackTelemetryType.lpcQuickIM:g=o.click,S=a.submit,w=a.submit,h=s.quickIM,m=u.lpcQuickIM,y=u.sendButton,C=l.compose,r="lpcQuickIM";break;case v.LpcCallbackTelemetryType.lpcVideoCall:g=o.click,h=s.navCalling,m=u.lpcVideoCall,r="lpcVideoCall";break;case v.LpcCallbackTelemetryType.lpcBlockContact:g=o.click,h=s.blockUser,m=u.lpcBlockContact,r="lpcBlockContact";break;case v.LpcCallbackTelemetryType.lpcUnblockContact:g=o.click,h=s.unblockUser,m=u.lpcUnblockContact,r="lpcUnblockContact";break;case v.LpcCallbackTelemetryType.lpcLinkedIn:g=o.click,h=s.navLinkedIn,m=u.lpcLinkedIn,r="lpcLinkedIn";break;case v.LpcCallbackTelemetryType.lpcBlockTfwToTfwFederatedUser:h=s.blockUser,m=u.lpcBlockContact,b=l.blockButton,S=a.submit,g=o.click,T=void 0,k=void 0,I=p.livePersonaCard;break;case v.LpcCallbackTelemetryType.lpcUnblockTfwToTfwFederatedUser:h=s.unblockUser,m=u.lpcUnblockContact,b=l.unblockButton,S=a.submit,g=o.click,T=void 0,k=void 0,I=p.livePersonaCard;break;default:return[2]}return A={action:{gesture:g,outcome:S,outcomeNew:w,scenario:h||null,scenarioType:c.people,workLoad:T||null,subWorkLoad:k||null},module:{name:(null===m||void 0===m?void 0:m.toString())||null,nameNew:y?teamspace.shared.AttributeHelper.tryGetEnum(y.toString(),u,this.loggingService):null,type:b||null,typeNew:C?teamspace.shared.AttributeHelper.tryGetEnum(C.toString(),l,this.loggingService):null,summary:r},panel:{type:I?p[I]:null}},[4,this.getTargetThreadType(n)];case 1:return A.targetThread=i.sent(),A.dataBag=t,x=A,this.analyticsService.getAnalyticsPanelActionEventData(x,P).then(function(e){L.analyticsService.sendPanelAction(e)}),[2]}})})},e.prototype.getTargetThreadType=function(e){return r(this,void 0,void 0,function(){var n,t,r,o;return i(this,function(i){switch(i.label){case 0:if(!e)return[2,null];n="OneOnOneChat",i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.conversationsAsyncService.getConversation(e)];case 2:return t=i.sent(),n=t&&t.conversationType||n,[3,5];case 3:return r=i.sent(),o=teamspace.services.AppsServiceUtils.getSafeError(r),this.loggingService.error("getTargetThreadType(): Failed to get conversation with error "+JSON.stringify(o)),[3,5];case 4:return[2,{type:n}];case 5:return[2]}})})},e}();n.LpcTelemetryHelper=g}},[2405]);
//# sourceMappingURL=[[staticsPath]]/hashed/lazy-ng1-mod-lpc-services.min-3ba25da.js.map