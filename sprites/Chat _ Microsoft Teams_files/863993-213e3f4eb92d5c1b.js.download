"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[863993],{111576:(e,t,n)=>{var i;n.d(t,{Z:()=>g});var a=new Uint8Array(16);function o(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(a)}const r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const s=function(e){return"string"==typeof e&&r.test(e)};for(var l=[],c=0;c<256;++c)l.push((c+256).toString(16).substr(1));const d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n};const g=function(e,t,n){var i=(e=e||{}).random||(e.rng||o)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=i[a];return t}return d(i)}},892953:(e,t,n)=>{var i={};n.r(i),n.d(i,{TrouterState:()=>a,UserActivityState:()=>o});var a,o,r=n(801123);!function(e){e[e.Unknown=0]="Unknown",e[e.Connected=2]="Connected",e[e.Disconnected=3]="Disconnected",e[e.Switching=9]="Switching"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.Active=1]="Active",e[e.Inactive=2]="Inactive"}(o||(o={})),(0,r.Y)(i,"skype.trouter")},801123:(e,t,n)=>{n.d(t,{Y:()=>i,P:()=>a});const i=(e,t)=>{if(!t)throw new Error("Namespace is not specified.");const n=window,i=t.split(".");let a=null;if(i.reduce(((e,t)=>(a=e,e[t]=e[t]||{},e[t])),n),!a)throw new Error("OOPS, we shouldn't be here.");a[i[i.length-1]]=Object.assign(Object.assign({},a[i[i.length-1]]),e)},a=(e,t)=>{const n=window,i=t.split(".");let a=null;if(i.reduce(((e,t)=>(a=e,e[t]=e[t]||{},e[t])),n),!a)throw new Error("OOPS, we shouldn't be here.");a[i[i.length-1]]=Object.assign({},a[i[i.length-1]],e)}},56136:(e,t,n)=>{n.d(t,{z:()=>i});class i{}i.Type_ActiveCallsChanged="active-calls-changed",i.Type_ActiveCallAdded="active-call-added",i.Type_ActiveCallRemoved="active-call-removed"},780670:(e,t,n)=>{var i,a,o,r,s,l,c,d,g,u,p,C,h,m,S,v;n.d(t,{sr:()=>i,Eo:()=>a,k1:()=>o,Xb:()=>r,kw:()=>s,jK:()=>l,My:()=>c,nr:()=>d,Ib:()=>g,cC:()=>u,m7:()=>p,UG:()=>C,vY:()=>h,BH:()=>m,ZS:()=>S,FT:()=>v}),function(e){e[e.Version=0]="Version",e[e.Feature=1]="Feature",e[e.Locale=2]="Locale",e[e.Event=3]="Event",e[e.Context=4]="Context",e[e.CallState=5]="CallState",e[e.Telemetry=6]="Telemetry",e[e.Custom=15]="Custom"}(i||(i={})),function(e){e[e.None=0]="None",e[e.MissedCall=1]="MissedCall",e[e.Meeting=2]="Meeting",e[e.Voicemail=4]="Voicemail",e[e.Dailer=8]="Dailer",e[e.Cortana=16]="Cortana",e[e.Telemetry=32]="Telemetry"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Custom=1]="Custom"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Logo1=1]="Logo1",e[e.Logo2=2]="Logo2",e[e.Logo3=3]="Logo3"}(r||(r={})),function(e){e[e.Decline=0]="Decline",e[e.Accept=1]="Accept"}(s||(s={})),function(e){e[e.UnknownFailure=0]="UnknownFailure",e[e.MessageFormat=1]="MessageFormat",e[e.FeatureSupport=2]="FeatureSupport"}(l||(l={})),function(e){e[e.Listening=1]="Listening",e[e.Thinking=2]="Thinking",e[e.Speaking=3]="Speaking"}(c||(c={})),function(e){e[e.None=0]="None",e[e.ActiveCall=3]="ActiveCall"}(d||(d={})),function(e){e[e.Narrowband=1]="Narrowband",e[e.Wideband=2]="Wideband"}(g||(g={})),function(e){e[e.Off=1]="Off",e[e.CriticallyLow=2]="CriticallyLow",e[e.Medium=3]="Medium",e[e.High=4]="High"}(u||(u={})),function(e){e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High"}(p||(p={})),function(e){e[e.No=0]="No",e[e.Yes=1]="Yes",e[e.Unsupported=255]="Unsupported"}(C||(C={})),function(e){e[e.callStart=0]="callStart",e[e.pairedWirelessDeviceUpdated=1]="pairedWirelessDeviceUpdated",e[e.periodicDataFromSelectedDevice=2]="periodicDataFromSelectedDevice",e[e.selectedDeviceChangedFromHid=3]="selectedDeviceChangedFromHid",e[e.selectedDeviceChangedFromUI=4]="selectedDeviceChangedFromUI",e[e.selectedDeviceTriggered=5]="selectedDeviceTriggered"}(h||(h={})),function(e){e[e.ClientTriggered=0]="ClientTriggered",e[e.DeviceTriggered=1]="DeviceTriggered",e[e.ClientorDeviceTriggered=2]="ClientorDeviceTriggered",e[e.ClientTriggeredPeriodic=3]="ClientTriggeredPeriodic"}(m||(m={})),function(e){e[e.EndpointCurrentFirmware=1]="EndpointCurrentFirmware",e[e.DongleCurrentFirmware=2]="DongleCurrentFirmware",e[e.DonToAnswer=3]="DonToAnswer",e[e.EndpointDeviceModelID=4]="EndpointDeviceModelID",e[e.DeviceEndpointSerialNumber=6]="DeviceEndpointSerialNumber",e[e.BaseSerialNumber=7]="BaseSerialNumber",e[e.SideToneLevel=8]="SideToneLevel",e[e.AudioCodec=9]="AudioCodec",e[e.EnabledDSPEffects=10]="EnabledDSPEffects",e[e.MuteLock=11]="MuteLock",e[e.HeadsetWorn=12]="HeadsetWorn",e[e.BatteryLevel=13]="BatteryLevel",e[e.DeviceReady=14]="DeviceReady",e[e.RadioLinkQuality=15]="RadioLinkQuality",e[e.ErrorMessage=16]="ErrorMessage",e[e.ButtonPressInfo=17]="ButtonPressInfo",e[e.ConnectedWirelessDeviceChange=18]="ConnectedWirelessDeviceChange",e[e.PeopleCount=19]="PeopleCount",e[e.LocalConferenceCount=20]="LocalConferenceCount",e[e.DeviceMicrophoneStatus=21]="DeviceMicrophoneStatus",e[e.DeviceSpeakerStatus=22]="DeviceSpeakerStatus",e[e.DeviceAudioStreamsStatus=23]="DeviceAudioStreamsStatus",e[e.DeviceVideoAndMetadataStreamsStatus=24]="DeviceVideoAndMetadataStreamsStatus",e[e.AiModelandModelVersion=25]="AiModelandModelVersion",e[e.DeviceResourceUsage=32]="DeviceResourceUsage",e[e.VoiceActivityWhileMuted=33]="VoiceActivityWhileMuted"}(S||(S={})),function(e){e[e.MeetingNotified=0]="MeetingNotified",e[e.InPrejoin=1]="InPrejoin",e[e.InMeeting=2]="InMeeting",e[e.None=3]="None"}(v||(v={}))},383209:(e,t,n)=>{var i,a,o;n.d(t,{d3:()=>i,G7:()=>a,Ki:()=>o}),function(e){e[e.HidDevice=0]="HidDevice",e[e.GattDevice=1]="GattDevice"}(i||(i={})),function(e){e[e.Microphone=0]="Microphone",e[e.Camera=1]="Camera"}(a||(a={})),function(e){e[e.shortPress=1]="shortPress",e[e.longPress=2]="longPress"}(o||(o={}))},347543:(e,t,n)=>{var i;n.d(t,{q:()=>i}),function(e){e.Type_MissedCallEvent="missed-call-generated",e.Type_VoiceMailEvent="voicemail-generated",e.Type_JoinMeetingEvent="join-meeting-notification",e.Type_StartMeetingEvent="start-meeting-notification",e.Type_Dismiss_MissedCallEvent="missed-call-dismissed",e.Type_Dismiss_MissedCallEvent_NStar="missed-call-dismissed",e.Type_Dismiss_VoiceMailEvent="voicemail-dismissed",e.Type_Dismiss_VoiceMailEvent_NStar="voicemail-dismissed",e.Type_Dismiss_JoinMeetingEvent="join-meeting-dismissed",e.Type_Dismiss_StartMeetingEvent="start-meeting-dismissed",e.Type_CancelEventComplete="dismiss-event-execution-completed"}(i||(i={}))},700828:(e,t,n)=>{var i;n.d(t,{y:()=>i}),function(e){e.Response="response",e.Pair="pair",e.Unpair="unpair",e.Mute="mute",e.Unmute="unmute",e.Broadcast="broadcast",e.Autopair="autopair",e.Locked="locked",e.Unlocked="unlocked",e.ReplyOnDesktop="replyondesktop",e.OpenFileOnDesktop="openfileondesktop",e.UpdateEndpoint="updateendpoint",e.OpenShare="openshare",e.StartCall="startcall",e.EndCall="endcall",e.StartVideo="startvideo",e.StopVideo="stopvideo",e.StartAudio="startaudio",e.StopAudio="stopaudio",e.HoldCall="holdcall",e.UnholdCall="unholdcall",e.ReportProblem="uploadbettertogetherlogs",e.CameraOn="cameraOn",e.CameraOff="cameraOff",e.VolumeUp="volumeUp",e.VolumeDown="volumeDown",e.CaptionsOff="captionsOff",e.CaptionsOn="captionsOn",e.ShowVideoGallery="showVideoGallery",e.ShowContent="showContent",e.ShowVideoGalleryAndContent="showVideoGalleryAndContent",e.ShowLargeGallery="showLargeGallery",e.ShowTogether="showTogether",e.ShowFrontRow="showFrontRow",e.LeaveMeeting="leaveMeeting",e.UpdateState="stateUpdate",e.UpdateCapabilities="capabilityUpdate"}(i||(i={}))},696953:(e,t,n)=>{var i,a,o,r,s;n.d(t,{bJ:()=>i,pZ:()=>a,KP:()=>o,Fk:()=>r,du:()=>s}),function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected"}(i||(i={})),function(e){e[e.Success=0]="Success",e[e.Timeout=1]="Timeout",e[e.Duplicate=2]="Duplicate",e[e.Incomplete=3]="Incomplete",e[e.Disconnected=4]="Disconnected"}(a||(a={})),function(e){e[e.None=0]="None",e[e.BetterTogether=1]="BetterTogether",e[e.RemoteControl=2]="RemoteControl"}(o||(o={})),function(e){e[e.IncomingSession=122]="IncomingSession"}(r||(r={})),function(e){e[e.Success=0]="Success",e[e.BadPayload_DecodeFailed=1]="BadPayload_DecodeFailed",e[e.BadPayload_Format=2]="BadPayload_Format",e[e.BadEventType=3]="BadEventType",e[e.SessionAlreadyExists=4]="SessionAlreadyExists",e[e.UnexpectedError=5]="UnexpectedError"}(s||(s={}))},872047:(e,t,n)=>{var i,a;n.d(t,{R:()=>i,C:()=>a}),function(e){e.BulkMove="BulkMove",e.Client="Client",e.BulkUpdate="BulkUpdate",e.BRTab="BRTab",e.BulkOpeningClosing="BulkOpeningClosing"}(i||(i={})),function(e){e[e.GetRoomFailed=1]="GetRoomFailed"}(a||(a={}))},717409:(e,t,n)=>{var i,a,o,r,s,l,c;n.d(t,{TP:()=>i,N2:()=>a,tf:()=>o,PT:()=>r,gC:()=>s,IR:()=>l,Vo:()=>c}),function(e){e.NotStarted="notStarted",e.Starting="starting",e.Started="started",e.Stopping="stopping",e.Stopped="stopped"}(i||(i={})),function(e){e.none="none",e.setLayout="setLayout",e.start="start",e.stop="stop",e.switchPrimary="switchPrimary",e.failoverInstance="instanceFailover",e.updateMediaState="updateMediaState",e.restart="restart"}(a||(a={})),function(e){e[e.Producer=0]="Producer",e[e.Contributor=1]="Contributor",e[e.Attendee=2]="Attendee",e[e.None=3]="None"}(o||(o={})),function(e){e.None="None",e.AppMinimized="AppMinimized",e.AppRestored="AppRestored"}(r||(r={})),function(e){e.Sending="Sending",e.Stalled="Stalled",e.Stopped="Stopped"}(s||(s={})),function(e){e[e.init=0]="init",e[e.live=1]="live",e[e.userLive=2]="userLive",e[e.ended=3]="ended"}(l||(l={})),function(e){e.None="none",e.PPTDown="pptDown",e.VideoDown="videoDown",e.VbssDown="vbssDown",e.CompDown="compDown",e.InitFail="initFail"}(c||(c={}))},201954:(e,t,n)=>{n.d(t,{t:()=>i});class i{}i.CanTransferChanged="CallConsultationServiceCanTransferChanged",i.CallConsultationStateChanged="CallConsultationServiceCallConsultationStateChanged",i.ChatConsultationStateChanged="CallConsultationServiceChatConsultationStateChanged"},221170:(e,t,n)=>{var i,a;n.d(t,{d2:()=>i,dJ:()=>a,eg:()=>o}),function(e){e[e.IM=0]="IM",e[e.AV=1]="AV"}(i||(i={})),function(e){e[e.None=0]="None",e[e.ConsultingWithIM=1]="ConsultingWithIM",e[e.ConsultingWithAV=2]="ConsultingWithAV"}(a||(a={}));class o{}o.StateChanged="CallConsultationStateChanged"},151220:(e,t,n)=>{var i;n.d(t,{c:()=>i}),function(e){e[e.Legacy=0]="Legacy",e[e.MeetingData=1]="MeetingData"}(i||(i={}))},17110:(e,t,n)=>{var i;n.d(t,{O:()=>i,d:()=>a}),function(e){e[e.None=0]="None",e[e.Escalating=1]="Escalating",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed"}(i||(i={}));class a{}a.CallEscalationStateChanged="CallEscalationStateChanged"},17496:(e,t,n)=>{var i,a,o,r,s,l,c,d;n.r(t),n.d(t,{CallHealthState:()=>i,CallHealthStateNumber:()=>a,CallHealthMetricCompareType:()=>o,CallHealthMetricCameraCodec:()=>r,CallHealthMetricMediaSharingPolicyState:()=>s,CallHealthDataAdapterType:()=>l,CallHealthEvent:()=>c,MeetingPanelLocation:()=>d}),function(e){e.NotAvailable="NotAvailable",e.Green="Green",e.Amber="Amber",e.Red="Red"}(i||(i={})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Green=1]="Green",e[e.Amber=2]="Amber",e[e.Red=3]="Red"}(a||(a={})),function(e){e.None="None",e.Custom="Custom",e.HigherIsBetter="HigherIsBetter",e.LowerIsBetter="LowerIsBetter"}(o||(o={})),function(e){e.Hardware="Hardware",e.Software="Software",e.HardwareSoftwareFluctuation="HardwareSoftwareFluctuation",e.NotAvailable="NotAvailable"}(r||(r={})),function(e){e.OnlyIPVideoEnabled="OnlyIPVideoEnabled",e.OnlyScreenSharingEnabled="OnlyScreenSharingEnabled",e.BothEnabled="BothEnabled",e.BothDisabled="BothDisabled"}(s||(s={})),function(e){e.CallTechnicalInfo="CallTechnicalInfo",e.MeetingSettingsStore="MeetingSettingsStore"}(l||(l={})),function(e){e.VideoTurnedOff_Disable="VideoTurnedOff_Disable",e.VideoTurnedOn_Enable="VideoTurnedOn_Enable",e.ScreenSharingTurnedOff_Disable="ScreenSharingTurnedOff_Disable",e.ScreenSharingTurnedOn_Enable="ScreenSharingTurnedOn_Enable",e.AudioTurnedOff_Disable="AudioTurnedOff_Disable",e.AudioTurnedOn_Enable="AudioTurnedOn_Enable",e.PariticipantScreenSharingOn_Enable="PariticipantScreenSharingOn_Enable",e.PariticipantScreenSharingOff_Disable="PariticipantScreenSharingOff_Disable"}(c||(c={})),function(e){e.ProducerScreen="ProducerScreen",e.ContributorScreen="ContributorScreen",e.CallingScreen="CallingScreen",e.CallHealthScreen="CallHealthScreen"}(d||(d={}))},498246:(e,t,n)=>{var i;n.d(t,{K:()=>i}),function(e){e[e.Add=0]="Add",e[e.Remove=1]="Remove",e[e.Get=2]="Get"}(i||(i={}))},474906:(e,t,n)=>{var i;n.d(t,{U:()=>i}),function(e){e[e.None=0]="None",e[e.Admitting=1]="Admitting",e[e.Denying=2]="Denying",e[e.AdmitError=3]="AdmitError",e[e.DenyError=4]="DenyError"}(i||(i={}))},966203:(e,t,n)=>{var i;n.d(t,{H:()=>i}),function(e){e[e.P2PAndP2P=0]="P2PAndP2P",e[e.GroupAndP2P=1]="GroupAndP2P",e[e.P2PAndGroup=2]="P2PAndGroup",e[e.MoH=3]="MoH"}(i||(i={}))},430753:(e,t,n)=>{n.d(t,{f:()=>a,r:()=>o});var i=n(686621);const a=e=>({syncedWith:()=>e});class o{constructor(e){this.args=e}mixTeamsCall(e,t){return this.mixin=this.args.createMixin(e),i.TeamsCallService.bindMethods(e,this.mixin,this.args.methods,t,!!this.args.forceBind),i.TeamsCallService.bindProps(e,this.mixin,this.args.props,t,!!this.args.forceBind),this.args.postInit?()=>{try{return this.args.postInit(this.mixin)}catch(e){null==t||t.error(`postInit failed: ${e.message}`)}}:void 0}}},793226:(e,t,n)=>{var i;n.d(t,{v:()=>i}),function(e){e[e.None=0]="None",e[e.ShowDtmfKeypad=1]="ShowDtmfKeypad",e[e.StartTransferring=2]="StartTransferring",e[e.StartConsulting=3]="StartConsulting",e[e.ToggleHold=4]="ToggleHold",e[e.ToggleIncomingVideoOn=5]="ToggleIncomingVideoOn",e[e.ToggleIncomingVideoOff=6]="ToggleIncomingVideoOff",e[e.OpenManageMeetingAudioDialog=7]="OpenManageMeetingAudioDialog"}(i||(i={}))},317583:(e,t,n)=>{var i;n.d(t,{X:()=>i}),function(e){e[e.Presenters=0]="Presenters",e[e.Attendees=1]="Attendees",e[e.Interpreters=2]="Interpreters",e[e.All=3]="All"}(i||(i={}))},190847:(e,t,n)=>{n.d(t,{CH:()=>i,hz:()=>a,Qz:()=>o});class i{}var a;i.CallParkStateChanged="CallParkStateChanged",function(e){e[e.None=0]="None",e[e.Parking=1]="Parking",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed",e[e.MusicOnHold=4]="MusicOnHold"}(a||(a={}));const o={Hold:"multi_window_hold",Resume:"multi_window_resume",Transfer:"multi_window_transfer",ConsultativeTransfer:"multi_window_consultative_transfer",MultiWindow:"multi_window"}},881359:(e,t,n)=>{var i;n.d(t,{l:()=>i}),function(e){e[e.CallMeBack=0]="CallMeBack",e[e.RosterOpened=1]="RosterOpened",e[e.RecordingUfdDismissed=2]="RecordingUfdDismissed",e[e.RecordingSpotlightUfdDismissed=3]="RecordingSpotlightUfdDismissed",e[e.RecordingStoppedUfdDismissed=4]="RecordingStoppedUfdDismissed",e[e.RecordingPPTUfdDismissed=5]="RecordingPPTUfdDismissed",e[e.RecordingWhiteboardUfdDismissed=6]="RecordingWhiteboardUfdDismissed",e[e.ScreensharingUfdDismissed=7]="ScreensharingUfdDismissed",e[e.VoiceCollectionStartedUfdDismissed=8]="VoiceCollectionStartedUfdDismissed",e[e.VoiceCollectionStoppedUfdDismissed=9]="VoiceCollectionStoppedUfdDismissed",e[e.PstnDialogDismissed=10]="PstnDialogDismissed",e[e.UfdNoPstnDismissed=11]="UfdNoPstnDismissed",e[e.CallingRosterAccordion=12]="CallingRosterAccordion",e[e.PinningProperties=13]="PinningProperties",e[e.ParticipantVideoScalingModes=14]="ParticipantVideoScalingModes",e[e.VDINotOptimizedUfdDismissed=15]="VDINotOptimizedUfdDismissed",e[e.WasPstnCoachmarkDisplayed=16]="WasPstnCoachmarkDisplayed",e[e.WasShareInviteDialogShown=17]="WasShareInviteDialogShown",e[e.MaxVideosOnStage=18]="MaxVideosOnStage",e[e.XlMeetingJoinedWithOldClientDismissed=19]="XlMeetingJoinedWithOldClientDismissed"}(i||(i={}))},192115:(e,t,n)=>{n.d(t,{K:()=>i});const i=581},275782:(e,t,n)=>{n.r(t),n.d(t,{RecorderActions:()=>i,CallRecordingRestClientService:()=>o});var i,a=n(2781);!function(e){e.SetUserToken="setUserToken",e.Pause="pause",e.Resume="resume"}(i||(i={}));class o{constructor(e,t,n,i,o,r=a.EsPromiseFactory){this.config=e,this.authenticationService=t,this.sxConfig=n,this.httpService=i,this.helpers=o,this.promiseFactory=r}getCallOptions(e,t){const n={callType:"recorder",skipCommonHeaders:!0,url:e};return t&&(n.headers=t),n}performRecorderApiCall(e,t,n){const i={participantMri:this.sxConfig.getCurrentSkypeMri(),action:t,mode:"recording",participantLegId:"",timestamp:this.helpers.getTimestamp()};return this.promiseFactory.toNgPromise(this.httpService.post(e,this.getCallOptions(e,n),i))}getAuthenticationHeaders(e){return this.authenticationService.getAuthHeaders({},[this.config.callRecordingResource()],[e],!0)}}},812113:(e,t,n)=>{var i,a,o;n.d(t,{Kp:()=>i,LW:()=>a,s6:()=>o}),function(e){e[e.recordingStarted=0]="recordingStarted",e[e.recordingDisabled=1]="recordingDisabled",e[e.recordingStopped=2]="recordingStopped",e[e.joinersRecordingStarted=3]="joinersRecordingStarted",e[e.initiatorRecordingStarted=4]="initiatorRecordingStarted",e[e.initiatorRecordingFailed=5]="initiatorRecordingFailed",e[e.recordingPPT=6]="recordingPPT",e[e.recordingWhiteboard=7]="recordingWhiteboard",e[e.recordingSpotlight=8]="recordingSpotlight"}(i||(i={})),function(e){e[e.Ongoing=0]="Ongoing",e[e.Successful=1]="Successful",e[e.Failed=2]="Failed",e[e.FailedQuotaExceeded=3]="FailedQuotaExceeded",e[e.FailedAMSNoContent=4]="FailedAMSNoContent",e[e.FailedAMSViewGeneration=5]="FailedAMSViewGeneration",e[e.FailedODB=6]="FailedODB",e[e.FailedODBCreateSession=7]="FailedODBCreateSession",e[e.FailedODBShareLinkGeneration=8]="FailedODBShareLinkGeneration",e[e.FailedInsufficientLicense=9]="FailedInsufficientLicense",e[e.SoftFailed=10]="SoftFailed",e[e.SoftFailedPostToChannelErrorCode=11]="SoftFailedPostToChannelErrorCode",e[e.SoftFailedRoleAssignmentErrorCode=12]="SoftFailedRoleAssignmentErrorCode",e[e.SoftFailedPostToChannelOrRoleAssignmentError=13]="SoftFailedPostToChannelOrRoleAssignmentError",e[e.Processing=14]="Processing",e[e.TokenError=15]="TokenError",e[e.FailedAllInstancesBusy=16]="FailedAllInstancesBusy",e[e.None=17]="None",e[e.FailedAADError=18]="FailedAADError",e[e.FailedODBLicenseProblem=19]="FailedODBLicenseProblem",e[e.FailedODBQuotaReached=20]="FailedODBQuotaReached",e[e.FailedODBIpPolicy=21]="FailedODBIpPolicy",e[e.FailedODBManagedDevicePolicy=22]="FailedODBManagedDevicePolicy"}(a||(a={})),function(e){e[e.Stream=0]="Stream",e[e.ODB=1]="ODB"}(o||(o={}))},513646:(e,t,n)=>{var i,a,o,r;n.d(t,{Jn:()=>i,c3:()=>a,nt:()=>o,WR:()=>r}),function(e){e[e.Mute=1]="Mute",e[e.Unmute=2]="Unmute"}(i||(i={})),function(e){e[e.App=1]="App",e[e.OS=2]="OS",e[e.MW=3]="MW"}(a||(a={})),function(e){e[e.Hold=1]="Hold",e[e.Unhold=2]="Unhold"}(o||(o={})),function(e){e[e.Whiteboard=0]="Whiteboard",e[e.HdmiIngest=1]="HdmiIngest",e[e.Generic=2]="Generic"}(r||(r={}))},785018:(e,t,n)=>{var i,a;n.d(t,{pF:()=>i,q5:()=>o,$x:()=>a}),function(e){e[e.None=0]="None",e[e.Transferring=1]="Transferring",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed"}(i||(i={}));class o{}o.CallTransferStateChanged="CallTransferStateChanged",function(e){e[e.Pstn=0]="Pstn",e[e.Voicemail=1]="Voicemail",e[e.People=2]="People"}(a||(a={}))},989888:(e,t,n)=>{n.r(t),n.d(t,{BroadcastCommandResponseWatcher:()=>a});var i=n(717409);class a{constructor(e,t,n){this.broadcastMeeting=e,this.logger=t,this.utilityService=n,this.success_status="success",this.currentCommandsResponseWatcherByCommandId={}}waitForCommandResponse(e,t,n){return new Promise(((i,a)=>{const o=this.getCommandStatus(e,t);if(o)return this.logger.log("Command status found for commandId in the state object. Returning status {0}",t),void("success"===o.result?i(o):a({commandId:o.id,errorCode:o.result,subcode:o.detail&&o.detail.subcode,sourceIds:o.detail&&o.detail.sourceIds&&o.detail.sourceIds.toString()}));this.waitForCommandResponseOrTimeout(e,t,n).then((e=>i(e))).catch((e=>a(e)))}))}dispose(){for(const[e,t]of Object.entries(this.currentCommandsResponseWatcherByCommandId))this.disposeWatcherForCommandId(e,!1);this.currentCommandsResponseWatcherByCommandId={}}waitForCommandResponseOrTimeout(e,t,n){return new Promise(((i,a)=>{const o=JSON.stringify(this.broadcastMeeting.broadcastState),r=this.utilityService.setTimeoutMs((()=>{this.logger.error("Timeout happened while waiting response of command {0}",t),this.disposeWatcherForCommandId(t),a({commandId:t,errorCode:"timeout"})}),1e3*n),s=this.broadcastMeeting.changed((()=>{const n=JSON.stringify(this.broadcastMeeting.broadcastState);if(o===n)return void this.logger.info("same metadata update. skipping");const r=this.getCommandStatus(e,t);r?(this.logger.info("Command status found in the state object for commandId {0}",t),this.disposeWatcherForCommandId(t),r.result===this.success_status?i(r):a({commandId:r.id,errorCode:r.result,subcode:r.detail&&r.detail.subcode,sourceIds:r.detail&&r.detail.sourceIds&&r.detail.sourceIds.toString()})):this.logger.info(`Watching for command Id ${t}. But no status found in current metadata update. ${n}`)}));this.currentCommandsResponseWatcherByCommandId[t]={unsubscribeTimeoutId:r,callChangedDisposable:s}}))}getCommandStatus(e,t){const n=this.broadcastMeeting.broadcastState;if(!n)return this.logger.info("Broadcast state is not yet available"),null;switch(e){case i.N2.stop:if(n.status===i.TP.Stopping||n.status===i.TP.Stopped){this.logger.info("Broadcast status is stopping/stopped. So broadcast has stopped.");const n={};return n.id=t,n.name=e,n.result=this.success_status,n}return null;case i.N2.start:let a=this.getDefaultBroadcastCommandStatus(n,t);return n.status!==i.TP.Starting&&n.status!==i.TP.Started||(a||(a={},a.id=t,a.name=e),a.result=this.success_status),a;default:return this.getDefaultBroadcastCommandStatus(n,t)}}getDefaultBroadcastCommandStatus(e,t){if(!e.commandStatus||!e.commandStatus.length)return this.logger.info("Broadcast state or command status is null while watching command {0}",t),null;const n=e.commandStatus.filter((e=>e&&e.id===t));return n&&n.length>0?n[0]:null}disposeWatcherForCommandId(e,t=!0){const n=this.currentCommandsResponseWatcherByCommandId[e];n&&(t&&delete this.currentCommandsResponseWatcherByCommandId[e],n.callChangedDisposable&&n.callChangedDisposable.dispose(),n.unsubscribeTimeoutId&&clearTimeout(n.unsubscribeTimeoutId))}}},743954:(e,t,n)=>{var i;n.r(t),n.d(t,{BroadcastModalityDisconnectReason:()=>i,BroadcastMeetingConstants:()=>a,BroadcastPlaybackType:()=>o,BroadcastAttendeeVisibilityModes:()=>r,BroadcastMeetingAccessLevel:()=>s}),function(e){e[e.None=0]="None",e[e.ModalityLinksNotReceived=1]="ModalityLinksNotReceived",e[e.BmcUpdatesNotReceived=2]="BmcUpdatesNotReceived"}(i||(i={}));const a={links:{PRODUCER:"producer",CONTRIBUTOR:"contributor",PARTICIPANTSESSION:"participantSession"},errorCode:{Invalid_Command:"Invalid_Command",Unknown:"Unknown",NotConnected:"bmc_notconnected",Invalid_Role:"Invalid_Role",CallState_Invalid:"CallState_Invalid"},headers:{CORRELATION_ID:"X-Microsoft-Skype-Chain-ID",PARTICIPANT_ID:"X-Microsoft-Skype-Participant-ID",MESSAGE_ID:"X-Microsoft-Skype-Message-ID"},role:{producer:"producer",contributor:"contributor"},commands:{setLayout:"setLayout",start:"start",stop:"stop",switchPrimary:"switchPrimary",failoverInstance:"failoverInstance",updateMediaState:"updateMediaState",restart:"restart"},subcode:{Timeout:"timeout",VideoSubscriptionFailed:"videoSubscriptionFailed",VideoStalled:"videoStalled",InvalidOperation:"invalidOperation",Superceded:"superceded"}};var o,r,s;!function(e){e[e.AMS=1]="AMS",e[e.Stream=2]="Stream",e[e.Overflow=3]="Overflow"}(o||(o={})),function(e){e.Everyone="Everyone",e.EveryoneInCompany="EveryoneInCompany",e.EveryoneInCompanyAndExternal="EveryoneInCompanyAndExternal",e.InvitedUsersInCompany="InvitedUsersInCompany",e.InvitedUsersInCompanyAndExternal="InvitedUsersInCompanyAndExternal"}(r||(r={})),function(e){e[e.Anonymous=0]="Anonymous",e[e.AllCompany=1]="AllCompany",e[e.InvitationOnly=2]="InvitationOnly"}(s||(s={}))},744094:(e,t,n)=>{n.r(t),n.d(t,{BroadcastMeeting:()=>I});var i=n(360452),a=n(197981),o=n(796973),r=n(520940),s=n(318845),l=n(611743),c=n(610322),d=n(516902),g=n(958285),u=n(202496),p=n(306402),C=n(860810),h=n(989888),m=n(743954),S=n(442718),v=n(119779);class I extends C.ObservableBase{constructor(e,t,n,a,o,r,s,l){super(),this.loggingService=e,this.sxConfig=t,this.authenticationService=n,this.httpClient=a,this.utilityService=o,this.interval=r,this.call=s,this.appConfig=l,this.isDisposed=!1,this.logger=e.newLogger("Broadcast Call"),this.callbackFunctions={},this.modalityState=i.Zs.None,this.commandResponseWatcher=new h.BroadcastCommandResponseWatcher(this,this.logger,this.utilityService),this.modalityStateManager=new v.BroadcastModalityStateManager(e,this),l.disableBroadcastModalityHealthCheck()||this.registerCallbackOnCallConnected("initializeHealthWatcher",(()=>{this.modalityHealthWatcher=new S.BroadcastModalityHealthWatcher(e,r,this,this.modalityStateManager,s,{bmcStateUpdatePingInterval:l.bmcStateUpdatePingInterval})})),this.links={}}setLayout(e){return this.validateProducerCommand(I.constants.commands.setLayout).then((()=>{if(!this.broadcastState.commands.setLayout)return this.logger.error("Set layout command not available. Available commands are {0}. CallId {1}",this.broadcastState.commands,this.call.callId),Promise.reject(this.createNewError(I.constants.commands.setLayout,I.constants.errorCode.Invalid_Command,"Set layout command not available"));const t={ver:1};return t.command=new c.ProducerSetLayoutCommand(this.utilityService),t.command.sources=e.sources,this.executeProducerRequest(t,r.N.setLayout)}))}start(){return this.validateProducerCommand(I.constants.commands.start).then((()=>{if(!this.broadcastState.commands.start)return this.logger.error("Start command not available. Available commands are {0}. CallId {1}",this.broadcastState.commands,this.call.callId),Promise.reject(this.createNewError(I.constants.commands.start,I.constants.errorCode.Invalid_Command,"Start command not available"));const e={};return e.command=new d.ProducerStartCommand(this.utilityService),e.ver=1,this.executeProducerRequest(e,r.N.start)}))}stop(){return this.validateProducerCommand(I.constants.commands.stop).then((()=>{if(!this.broadcastState.commands.stop)return this.logger.error("Stop command not available. Available commands are {0}",this.broadcastState.commands),Promise.reject(this.createNewError(I.constants.commands.stop,I.constants.errorCode.Invalid_Command,"Stop command not available"));const e={ver:1};return e.command=new g.ProducerStopCommand(this.utilityService),this.executeProducerRequest(e,r.N.stop)}))}switchPrimary(){return this.validateProducerCommand(I.constants.commands.switchPrimary).then((()=>{if(!this.broadcastState.commands.switchPrimary)return this.logger.error("switchPrimary command not available. Available commands are {0}",this.broadcastState.commands),Promise.reject(this.createNewError(I.constants.commands.switchPrimary,I.constants.errorCode.Invalid_Command,"switchPrimary command not available"));const e={ver:1};return e.command=new u.ProducerSwitchPrimaryCommand(this.utilityService),this.executeProducerRequest(e,r.N.switchPrimary)}))}failoverInstance(e){return this.validateProducerCommand(I.constants.commands.failoverInstance).then((()=>{if(!this.broadcastState.commands.instanceFailover)return this.logger.error("instanceFailover command not available. Available commands are {0}",this.broadcastState.commands),Promise.reject(this.createNewError(I.constants.commands.failoverInstance,I.constants.errorCode.Invalid_Command,"instanceFailover command not available"));const t={ver:1};return t.command=new s.ProducerFailoverInstanceCommand(this.utilityService,e),this.executeProducerRequest(t,r.N.failoverInstance)}))}updateMediaState(e,t,n){return this.validateCommand(I.constants.commands.updateMediaState).then((()=>{if(!this.broadcastState.commands.updateMediaState)return this.logger.error("updateMediaState command not available. Available commands are {0}",this.broadcastState.commands),Promise.reject(this.createNewError(I.constants.commands.updateMediaState,I.constants.errorCode.Invalid_Command,"updateMediaState command not available"));const i={ver:1};return i.command=new p.ProducerUpdateMediaStateCommand(this.utilityService,e,t,n),this.executeProducerRequest(i,r.N.updateMediaState)}))}restart(){return this.validateProducerCommand(I.constants.commands.restart).then((()=>{if(!this.broadcastState.commands.restart)return this.logger.error("Restart command not available. Available commands are {0}. CallId {1}",this.broadcastState.commands,this.call.callId),Promise.reject(this.createNewError(I.constants.commands.restart,I.constants.errorCode.Invalid_Command,"Restart command not available"));const e={};return e.command=new l.ProducerRestartCommand(this.utilityService),e.ver=1,this.executeProducerRequest(e,r.N.restart)}))}joinModality(e){return this.modalityState!==i.Zs.Ringing&&this.modalityState!==i.Zs.Disconnected?(this.logger.error("Cannot join. current state {0}-{1}",this.modalityState,this.disconnectReason),Promise.reject("Cannot join as current state is not ringing or disconnected")):(this.modalityStateManager.setModalityState(i.Zs.Connecting),this.joinModalityInternal(2,e).then((()=>{this.modalityStateManager.setModalityState(i.Zs.Connected)}),(e=>(this.modalityStateManager.setModalityState(i.Zs.Disconnected),this.logger.error("Error while connecting to the BMC link {0}",e),Promise.reject(e)))))}metadataChanged(e){if(!e||this.serializedMetadata===e)return;let t;try{if(t=!e||(0,a.isEmpty)(e)?null:JSON.parse(e),!t)return void this.logger.error("Metadata from BMC is null");const n=t.broadcastState;this.logBroadcastState(n,void 0===this.metadata),this.onValidCallState(e,(e=>{this.serializedMetadata=e;const i=this.metadata;this.metadata=t,this.handleBroadcastControllerUrlChange(i,t),this.handleBroadcastStateCallbackUrlChange(i,t),this.broadcastState=n,this.raiseChanged(),this.modalityHealthWatcher&&this.modalityHealthWatcher.metadataChanged()}))}catch(t){this.logger.error(`Failed to parse the raw broadcast metadata blob. Error: ${t}, Broadcast metadata: ${e}`)}}joinModalityInternal(e,t){if(!this.metadata.broadcastControllerUrl)return this.logger.error("No broadcast controller url"),Promise.reject("No broadcast controller url");if(this.call.state===i.OX.Disconnected||this.call.state===i.OX.Disconnecting){this.logger.error("Call is in disconnect or disconnecting state {0}",this.call.state);const e={code:I.constants.errorCode.CallState_Invalid,message:"Call is in disconnect or disconnecting state"};return Promise.reject(e)}this.logger.info("Attempting to join BMC modality");const n=this.buildRequestHeaders(),a=new Promise((e=>{this.authenticationService.getAuthTokens([this.appConfig.bmcAuthResource()]).then((t=>{e(t)})).catch((t=>{this.logger.error(`Error while getting auth token for BMC: ${t}`),e(null)}))})),o=new Promise((e=>{this.authenticationService.getUserInformation().then((t=>{e(t.userName)})).catch((t=>{this.logger.error(`Error while getting userInfo: ${t}`),e("")}))}));return a.then((e=>o.then((n=>{const i={participants:{from:{id:this.sxConfig.getCurrentSkypeMri(),displayName:n,endpointId:this.call.endpointId,participantId:this.call.participantId,languageId:"en-US"}},observationLinks:{sessionUpdate:this.metadata.broadcastStateCallbackUrl,sessionEnd:this.metadata.broadcastStateCallbackUrl}};return t&&(i.broadcast={roleHint:t}),e&&!this.appConfig.disableUserTokenToCSForBroadcast()&&(i.broadcast||(i.broadcast={}),i.broadcast.userToken=e),i})))).then((t=>this.httpClient.post(this.metadata.broadcastControllerUrl,n,t,"join-bmc",e))).then((e=>{if(!e.broadcast||!e.broadcast.role)throw new Error(this.utilityService.format("Invalid response format for the join response. MessageId {0}",n[I.constants.headers.MESSAGE_ID]));this.role=e.broadcast.role,this.links[I.constants.links.PRODUCER]=e.links.producer,this.links[I.constants.links.CONTRIBUTOR]=e.links.contributor,this.links[I.constants.links.PARTICIPANTSESSION]=e.links.participantSession,this.logger.log("New state from join"),this.role===I.constants.role.producer?this.broadcastState=e.broadcast.producerState:this.broadcastState=e.broadcast.contributorState,this.logBroadcastState(this.broadcastState)})).catch((e=>(this.logger.error("Failed to join BMC modality"),Promise.reject(e))))}setModalityState(e,t=!0){e!==this.modalityState&&(this.logger.info("Setting modality state from {0} to {1}",this.modalityState,e),this.modalityState=e,t&&this.raiseChanged())}dispose(){this.isDisposed||(this.isDisposed=!0,this.logger.info("Disposing the broadcast meeting"),this.commandResponseWatcher.dispose(),this.modalityHealthWatcher&&this.modalityHealthWatcher.dispose(),this.callDisposable&&(this.callDisposable.dispose(),this.callDisposable=void 0))}executeProducerRequest(e,t,n=75){const i=this.buildRequestHeaders();return Promise.resolve().then((()=>this.httpClient.post(this.links[I.constants.links.PRODUCER],i,e,`broadcast-${t}`))).then((()=>t===r.N.restart?(this.logger.info("Broadcast {0} command {1} with messageId {2} has been executed successfully",t,e.command.id,i[I.constants.headers.MESSAGE_ID]),Promise.resolve({id:e.command.id,name:e.command.name,result:"success",detail:null})):(this.logger.info("Broadcast {0} command {1} with messageid {2} has been accepted",t,e.command.id,i[I.constants.headers.MESSAGE_ID]),this.commandResponseWatcher.waitForCommandResponse(t,e.command.id,n)))).then((()=>{this.logger.info("Broadcast {0} command {1} with messageId {2} has been executed successfully",t,e.command.id,i[I.constants.headers.MESSAGE_ID])})).catch((n=>(this.logger.error("Error occurred while executing {0}. Command Id {1}. MessageId {2}. Error {3}",t,e.command.id,i[I.constants.headers.MESSAGE_ID],n),Promise.reject(n))))}validateProducerCommand(e){return this.role!==I.constants.role.producer?(this.logger.error('Current role is not producer, so exiting command. Expected role "producer". Actual {0}',this.role),Promise.reject(this.createNewError(e,I.constants.errorCode.Invalid_Role,"Invalid role for the caller"))):this.validateCommand(e)}validateCommand(e){return this.modalityState!==i.Zs.Connected?(this.logger.error("Broadcast modality is not connected"),Promise.reject(this.createNewError(e,I.constants.errorCode.NotConnected,"Broadcast modality is not connected"))):this.broadcastState&&this.broadcastState.commands?Promise.resolve():(this.logger.error("Invalid producer state"),Promise.reject(this.createNewError(e,I.constants.errorCode.Unknown,"Invalid producer state")))}handleBroadcastControllerUrlChange(e,t){if(this.modalityState!==i.Zs.None)return this.logger.info("Skipping modality join as it is either connected or connecting {0}",this.modalityState),Promise.resolve();const n=t.broadcastControllerUrl;if(!n)return this.logger.warn("Join link not yet available. Waiting for BMC join link"),Promise.resolve();e&&e.broadcastControllerUrl!==n&&this.logger.warn("Broadcast controller url changed from the previous url. State {0}",this.getNonPIIState(t)),this.modalityStateManager.setModalityState(i.Zs.Ringing)}handleBroadcastStateCallbackUrlChange(e,t){if(!e||!e.broadcastStateCallbackUrl)return void this.logger.info("No old metadata present. This might be the first metadata event");if(this.modalityState!==i.Zs.Connected)return void this.logger.info("Skipping callback url registration change as state is not connected {0}",this.modalityState);if(e.broadcastStateCallbackUrl===t.broadcastStateCallbackUrl)return void this.logger.info("Skipping callback url registration change as callback url has not changed");this.logger.warn("Broadcast callback url changed. trying to join again");const n=this.loggingService.newScenario(o.Constants.scenarios.broadcast.updateCallbackUrl);n.cancelIfOffline=!0,this.joinModalityInternal().then((()=>{n.stop({callId:this.call.callId,participantId:this.call.participantId})}),(e=>{this.logger.error("Cannot update the callback url. {0}",e),n.fail({callId:this.call.callId,participantId:this.call.participantId}),this.modalityStateManager.setModalityState(i.Zs.Disconnected)}))}registerCallbackOnCallConnected(e,t){t&&this.call&&(this.call.state!==i.OX.Connected?this.callbackFunctions[e]||(this.callbackFunctions[e]=t,this.callDisposable||(this.callDisposable=this.call.changed((()=>{this.call.state===i.OX.Connected?(this.logger.info("User seems to be admitted to the meeting now."),(0,a.each)(this.callbackFunctions,(e=>e())),this.callbackFunctions={},this.callDisposable&&(this.callDisposable.dispose(),this.callDisposable=void 0)):this.logger.info("User not in connected state.")})))):t())}onValidCallState(e,t){if(!this.call)return void this.logger.error("Invalid call object. Ignoring metadata change");if(this.call.state!==i.OX.InLobby)return void t(e);const n=e;this.logger.warn("User is in lobby state. Wait for user call to be connected"),this.registerCallbackOnCallConnected("onValidCallState",(()=>{t(n)}))}logBroadcastState(e,t=!1){t||this.logger.info("Broadcast state: {0}",JSON.stringify(this.getNonPIIState(e)))}getNonPIIState(e){return e?(0,a.pick)(e,["commands","error","sequenceNumber","status","commandStatus","sources","layout","previewSourceId"]):(this.logger.error("empty broadcast state logged"),{})}buildRequestHeaders(){const e={};return e[I.constants.headers.CORRELATION_ID]=this.call.callId,e[I.constants.headers.PARTICIPANT_ID]=this.call.participantId,e[I.constants.headers.MESSAGE_ID]=this.utilityService.generateUUID(),e}createNewError(e,t,n){return{command:e,errorCode:t,message:n}}}I.constants=m.BroadcastMeetingConstants},442718:(e,t,n)=>{n.r(t),n.d(t,{BroadcastModalityHealthWatcher:()=>s});var i=n(360452),a=n(717409),o=n(743954),r=n(796973);class s{constructor(e,t,n,i,a,o){this.loggingService=e,this.interval=t,this.broadcastMeeting=n,this.modalityStateManager=i,this.call=a,this.config=o,this.clientCheckHealthInterval=3e4,this.moveToConnectedStateOnMetadataChange=!1,this.currentMissedStateCount=0,this.logger=e.newLogger(`BroadcastModalityHealth ${a.callId}`),this.intervalPromise=this.interval.set(this.checkForBroadcastConnection.bind(this),this.clientCheckHealthInterval),this.lastMetadataUpdateTimestamp=Date.now().valueOf()}metadataChanged(){this.logger.info("metadata change triggered for broadcast"),this.lastMetadataUpdateTimestamp=Date.now().valueOf(),this.currentMissedStateCount=0,this.moveToConnectedStateOnMetadataChange&&this.broadcastMeeting.modalityState===i.Zs.Disconnected&&(this.modalityStateManager.setModalityState(i.Zs.Connected),this.moveToConnectedStateOnMetadataChange=!1)}dispose(){this.stopConnectionHealthCheckTimer()}stopConnectionHealthCheckTimer(){this.intervalPromise&&(this.interval.cancel(this.intervalPromise),this.intervalPromise=null)}checkForBroadcastConnection(){if(this.broadcastMeeting.broadcastState&&(this.broadcastMeeting.broadcastState.status===a.TP.Stopped||this.broadcastMeeting.broadcastState.status===a.TP.Stopping))return this.logger.info("Broadcast meeting ended, stopping BMC health check timer"),void this.stopConnectionHealthCheckTimer();const e=Date.now().valueOf();switch(this.broadcastMeeting.modalityState){case i.Zs.None:this.handleMissedNotificationOnNoneState(e);break;case i.Zs.Ringing:case i.Zs.Connecting:this.logger.warn("Broadcast modality is still ringing/connecting. no client has yet joined. {0}",this.broadcastMeeting.modalityState);break;case i.Zs.Connected:this.handleMissedNotificationOnConnectedState(e)}}handleMissedNotificationOnNoneState(e){e-this.lastMetadataUpdateTimestamp>=3e4&&(this.logger.error("Didn't received any bmc metadata update from bmc. Moving to disconnect state"),this.setModalityStateToDisconnected(o.BroadcastModalityDisconnectReason.ModalityLinksNotReceived))}handleMissedNotificationOnConnectedState(e){const t=this.config.bmcStateUpdatePingInterval()+r.Constants.scenarios.broadcast.bmcStateUpdateNetworkLatencyWait;if(e-this.lastMetadataUpdateTimestamp<=t)return void this.logger.info("We got an update within the expected ping interval. Health is good");if(this.currentMissedStateCount++,this.logger.warn("Missed broadcast state update. No. of updates missed {0}. Health might be bad. Max timeout {1}",this.currentMissedStateCount,t),1===this.currentMissedStateCount){this.logger.info("trying to join the broadast modality again");const e=this.loggingService.newScenario(r.Constants.scenarios.broadcast.autoJoinModality);return e.cancelIfOffline=!0,this.broadcastMeeting.joinModalityInternal().then((()=>{this.logger.info("Modality join is successful"),e.stop(),this.metadataChanged()})).catch((t=>{const n={};n[r.Constants.counters.eventNames.callId]=this.call.callId,n[r.Constants.scenarioDataPropNames.broadcastError]=JSON.stringify({error:t}),n[r.Constants.counters.eventNames.wasPoppedOut]=this.call.wasPoppedOut,n[r.Constants.categories.callWasPoppedOut]=this.call.wasPoppedOut,t&&t.code===o.BroadcastMeetingConstants.errorCode.CallState_Invalid?e.cancel(n):e.fail(n),this.logger.error("Cannot join modality again. We will move to disconnect state {0}",t),this.setModalityStateToDisconnected(o.BroadcastModalityDisconnectReason.BmcUpdatesNotReceived)}))}this.currentMissedStateCount>=2&&(this.logger.error("More than 2 missing states. Health is bad. Current count {0}",this.currentMissedStateCount),this.setModalityStateToDisconnected(o.BroadcastModalityDisconnectReason.BmcUpdatesNotReceived))}setModalityStateToDisconnected(e){e===o.BroadcastModalityDisconnectReason.BmcUpdatesNotReceived&&(this.moveToConnectedStateOnMetadataChange=!0),this.broadcastMeeting.disconnectReason=e,this.modalityStateManager.setModalityState(i.Zs.Disconnected)}}},119779:(e,t,n)=>{n.r(t),n.d(t,{BroadcastModalityStateManager:()=>a});var i=n(360452);class a{constructor(e,t){this.broadcastMeeting=t,this.logger=e.newLogger("BroadcastModalityStateManager")}setModalityState(e,t=!0){switch(e){case i.Zs.Connected:return this.setModalityStateToConnected(t);case i.Zs.Connecting:return this.setModalityStateToConnecting(t);case i.Zs.Ringing:return this.setModalityStateToRinging(t);case i.Zs.Disconnected:return this.broadcastMeeting.setModalityState(e,t);default:this.logger.error("Invalid state for modality {0}",e)}}setModalityStateToRinging(e){this.broadcastMeeting.setModalityState(i.Zs.Ringing,e)}setModalityStateToConnecting(e){const t=this.broadcastMeeting.modalityState;t===i.Zs.Ringing?this.broadcastMeeting.setModalityState(i.Zs.Connecting,e):this.logger.error("Invalid state transition. Expected new state {0}. Current state {1}",i.Zs.Connecting,t)}setModalityStateToConnected(e){const t=this.broadcastMeeting.modalityState;t===i.Zs.Disconnected||t===i.Zs.Connecting?this.broadcastMeeting.setModalityState(i.Zs.Connected,e):this.logger.error("Invalid state transition. Expected new state {0}. Current state {1}",i.Zs.Connected,t)}}},860417:(e,t,n)=>{n.d(t,{M:()=>i});class i{}i.slaRegistryChanged="slaRegistryChanged"},926305:(e,t,n)=>{var i,a,o,r,s;n.d(t,{NK:()=>i,MA:()=>a,V6:()=>o,C1:()=>r,QN:()=>s}),function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e[e.Standalone=3]="Standalone"}(i||(i={})),function(e){e[e.CallScreen=0]="CallScreen",e[e.CallMonitor=1]="CallMonitor",e[e.ExternalCallMonitor=2]="ExternalCallMonitor",e[e.CallingHeader=3]="CallingHeader",e[e.CallingFooter=4]="CallingFooter",e[e.Custom=5]="Custom",e[e.CallScreensharingPanel=6]="CallScreensharingPanel"}(a||(a={}));!function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom"}(o||(o={})),function(e){e[e.CallingAlertBanner=1]="CallingAlertBanner",e[e.CallingActionButtons=2]="CallingActionButtons",e[e.CallingCenterScreen=3]="CallingCenterScreen"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Roster=1]="Roster",e[e.CallingChat=2]="CallingChat",e[e.DeviceSettings=3]="DeviceSettings",e[e.MeetingInfo=4]="MeetingInfo",e[e.MeetingNotes=5]="MeetingNotes",e[e.BroadcastQna=6]="BroadcastQna",e[e.BroadcastYammer=7]="BroadcastYammer",e[e.BroadcastAnalytics=8]="BroadcastAnalytics",e[e.CallTranscript=9]="CallTranscript",e[e.CallHealth=10]="CallHealth",e[e.VideoBackgroundSettings=11]="VideoBackgroundSettings"}(s||(s={}))},458239:(e,t,n)=>{var i,a;n.r(t),n.d(t,{DataChannelOwnerId:()=>i,CallingBotDataType:()=>a,CaptionDefaultSpokenLanguage:()=>o}),function(e){e[e.ClosedCaptions=0]="ClosedCaptions",e[e.ClosedCaptionsMW=1]="ClosedCaptionsMW",e[e.Transcript=2]="Transcript",e[e.TranscriptMW=3]="TranscriptMW",e[e.Coach=4]="Coach",e[e.CoachMW=5]="CoachMW",e[e.Facestream=6]="Facestream",e[e.CloudPeopleFeed=7]="CloudPeopleFeed",e[e.CombinedRecordingAndTranscription=8]="CombinedRecordingAndTranscription"}(i||(i={})),function(e){e[e.Event=0]="Event",e[e.Coach=1]="Coach",e[e.TextTrack=2]="TextTrack"}(a||(a={}));const o="<spokenLanguage>"},688408:(e,t,n)=>{n.d(t,{ku:()=>i,o5:()=>a,k2:()=>o});const i="-1";var a,o;!function(e){e.CALLING_CONVERSATION_EVENT="CallingConversationEvent",e.UNREAD_MESSAGE_EVENT="UnreadMessageEvent",e.MESSAGE_EVENT="MessageEvent"}(a||(a={})),function(e){e.None="None",e.Meeting="Meeting",e.Channel="Channel"}(o||(o={}))},952415:(e,t,n)=>{var i,a;n.d(t,{_n:()=>i,T_:()=>a,lX:()=>o}),function(e){e[e.Unknown=0]="Unknown",e[e.ScheduledMeeting=1]="ScheduledMeeting",e[e.PrivateMeeting=2]="PrivateMeeting",e[e.AdhocMeeting=3]="AdhocMeeting",e[e.Call=4]="Call"}(i||(i={})),function(e){e.Legacy="legacy",e.MeetingData="meetingData"}(a||(a={}));const o={TypeParamName:"btype",RoleParamName:"role",StreamTypeValue:"s",AMSTypeValue:"a",AttendeeRoleValue:"a",StreamVideoIdParamName:"vid"}},337846:(e,t,n)=>{n.r(t),n.d(t,{CallingDeepLinkService:()=>C});var i=n(361366),a=n(360452),o=n(197981),r=n(972858),s=n(796973),l=n(2781),c=n(62606),d=n(952415),g=n(347123),u=n(151220);class p{constructor(e){this.deeplinkId=e,this.call=null,this.timeout=null}}class C{constructor(e,t,n,i,a,o,r,s,c,d=!0,g=l.EsPromiseFactory){this.config=e,this.timeout=t,this.location=n,this.callingTelemetryService=i,this.utilityService=a,this.loggingService=o,this.eventingService=r,this.storageService=s,this.chatServiceUtils=c,this.promiseFactory=g,this.logger=o.newLogger("callingDeepLinkService"),d&&this.initializeOnAppLaunchAndReinit()}disposeService(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return new Promise((t=>{this.cleanupOnAppTeardown(e.reason),t()}))}))}initializeOnAppLaunchAndReinit(){this.eventingService.registerHandlerForExternalEvent(s.Constants.events.calling.callDisposed,(e=>{this.deeplinkTrace&&this.deeplinkTrace.call===e&&this.stopTracingCurrentDeeplink()})),this.stopTracingCurrentDeeplink()}cleanupOnAppTeardown(e){this.stopTracingCurrentDeeplink(),this.deeplinkTrace=void 0,this.pendingMeetupLink=void 0,this.deepLinkParams=void 0}mtmaTelemetryIdentifier(){return"CallingDeepLinkService"}startOrMarkScenario(e,t,n){const i=this.getDeeplinkContext(e,n);if(!i||![s.Constants.deepLinkTypes.meetupJoin,s.Constants.deepLinkTypes.meetingWithCode].includes(i.linkType))return;const a=(0,o.isString)(e)?e:void 0,r=this.getMeetingData(i,n,a),l=this.reportTelemetry(i.context,r,n);return l.mark(t),l}getDeeplinkScenario(e,t){return this.callingTelemetryService.getStartCallScenario({type:g.G.Meeting,joinType:u.c.Legacy,conversationId:e,rootMessageId:t,messageId:"",tenantId:"",organizerId:"",meetingCloud:"",isChannel:!1,isAdhoc:!1},"")}getDeeplinkParamsFromUrl(e){try{const t=this.utilityService.parseUrl(e);return this.getDeeplinkContext(t.pathname+t.search)}catch(e){return this.logger.warn(`Failed parsing deeplink params from url: ${r.CallingTelemetryService.getErrorMessage(e)}`),null}}getDeepLinkHash(){if(this.deepLinkParams)return this.buildEUIIfreeLinkFromParams(this.deepLinkParams)}getSavedDeeplinkParams(){return this.deepLinkParams}cleanSavedDeeplinkParams(){this.deepLinkParams=void 0}decodeString(e){this.logger.info(`Starting to decode input: ${e}`);let t=e;try{if(t=decodeURIComponent(e),this.config.enableDecodingDeepLinkMultipleTimes())for(;t!==decodeURIComponent(t);)t=decodeURIComponent(t)}catch(t){this.logger.error(`Got error: ${t} when decoding input: ${e}`)}return this.logger.info(`Decoding finished. Result: ${t}`),t}getDeeplinkContext(e,t,n=!0){let i,a,r;if(!(0,o.isString)(e))return i=this.buildDeeplinkParamsFromContextObject(e,t),this.deepLinkParams=i,i;try{const t=this.decodeString(e);r=t.match(/\/(.*)\?/)[1],a=e.indexOf("meetup-join")>=0?t.match(/{(.*)}/)[0]:""}catch(t){return void(e&&e.indexOf("meet")>=0?this.logger.error(`failed to decode URI component: ${t}`):this.logger.warn(`failed to decode URI component: ${t}`))}if(!r)return;const l=e.match(/[&?]deeplinkId=(.*?)($|&)/i),c=l?l[1]:"",g=e.match(/[&?]homeCloud=(.*?)($|&)/i),u=g?g[1]:"",p=r.split("/"),C=4===p.length,h=2===p.length;if(!C&&!h){const t="Deeplink URL has wrong type or format";return n&&this.reportIncompleteDeeplinkScenario({DeeplinkId:c,correlationId:c,deeplinkURL:e},t),void this.logger.error(t)}if(C){const e=p[3].split("?")[0];i={context:Object.assign(Object.assign({},this.parseDeepLinkContext(a)),{DeeplinkId:c,correlationId:c||this.utilityService.generateUUID(),homeCloud:u}),linkType:p[1],conversationId:p[2],messageId:e,type:d.T_.Legacy},n&&!this.isConversationIdValid(i.conversationId)&&(this.getAndMarkScenario(i.conversationId,i.messageId,s.Constants.scenarios.steps.calling.joinOrCreateMeetupFromLink.malformedConversationId),this.logger.warn(`Got malformed conversationId in getDeeplinkContext, conversationId: ${i.conversationId}`))}else{const t=e.match(/[&?]p=(.*?)($|&)/i),n=t?t[1]:"";i={context:Object.assign(Object.assign({},a&&this.parseDeepLinkContext(a)),{DeeplinkId:c,correlationId:c||this.utilityService.generateUUID(),homeCloud:u}),linkType:p[0],code:p[1],passcode:n,url:e,type:d.T_.MeetingData}}return this.deepLinkParams=i,i}buildDeeplinkParamsFromContextObject(e,t){this.updateContextForBroadcast(e),e.isUniquePresenterLink=!!t.participantPin;const n=Object.assign({context:e,linkType:t.type===d.T_.MeetingData?s.Constants.deepLinkTypes.meetingWithCode:s.Constants.deepLinkTypes.meetupJoin},t);return n.context.correlationId||(n.context.correlationId=e.DeeplinkId||this.utilityService.generateUUID()),n}getAndMarkScenario(e,t,n){const i=this.getDeeplinkScenario(e,t);i&&i.mark(n)}getOrCreateDeeplinkScenario(e,t,n){let i=this.getDeeplinkScenario(t,n);if(!i){const a={[s.Constants.categories.deepLinkSource]:e.Origin||"unknown",[s.Constants.categories.meetingType]:"Unknown",[s.Constants.categories.deeplinkId]:e.DeeplinkId||"unknown",[s.Constants.counters.eventNames.correlationId]:e.correlationId};i=this.reportTelemetry(e,a,{conversationId:t,messageId:n,type:d.T_.Legacy})}return i}reportIncompleteDeeplinkScenario(e,t){const n=this.utilityService.scrubEuii(t),i=this.getOrCreateDeeplinkScenario(e,"",""),a={errorMessage:n,terminatedReason:n};this.config.logUrlOnParseFailure()&&(a.deeplinkURL=this.utilityService.scrubEuii(e.deeplinkURL)),this.logger.error(t),i.incomplete(a)}parseDeepLinkContext(e){let t;try{t=JSON.parse(this.decodeString(e))}catch(n){try{this.logger.error(`Error while parsing the url: ${n}`);const i=e.replace(/(?:['"])?([\w-]+)(?:['"])?\s*:\s*(?:['"])?([\w-]+)(?:['"])?/g,((e,t,n)=>`"${t}":"${n}"`));t=JSON.parse(i)}catch(n){this.logger.error(`Couldn't get context for calling deep link: ${n}`),t=this.tryParseAsBroadcastDeepLink(e)}}return this.updateContextForBroadcast(t),t}updateContextForBroadcast(e){e&&1===e.b&&(e.IsBroadcastMeeting=!0)}shouldTraceDeeplink(e){return!!e&&this.config.enableDeeplinkTracing()}stopTracingCurrentDeeplink(){this.deeplinkTrace&&this.stopTracingDeeplink(this.deeplinkTrace.deeplinkId)}traceDeeplink(e){if(!this.shouldTraceDeeplink(e))return;this.deeplinkTrace?this.deeplinkTrace.deeplinkId!==e?(this.stopTracingCurrentDeeplink(),this.deeplinkTrace=new p(e)):this.timeout.cancel(this.deeplinkTrace.timeout):this.deeplinkTrace=new p(e);const t=this.deeplinkTrace;t.timeout=this.timeout.set((()=>{t.call||(this.logger.error(`Deeplink tracing timed out: ${e}`),this.stopTracingDeeplink(e))}),this.config.deeplinkTracingTimeout(),!1),this.loggingService.setContext(s.Constants.categories.deeplinkId,e)}traceDeeplinkPromise(e,t){this.shouldTraceDeeplink(e)&&(this.traceDeeplink(e),t.catch((()=>this.stopTracingDeeplink(e))))}traceDeeplinkCall(e,t){if(!this.shouldTraceDeeplink(e))return;this.traceDeeplink(e);const n=this.deeplinkTrace;n.call?n.call!==t&&this.logger.error(`Unexpected tracing of same deeplink with different calls: ${e}`):(n.call=t,c.CallUtilities.waitForCallConnection(t,this.promiseFactory).then((()=>{this.stopTracingDeeplink(e)})))}stopTracingDeeplink(e){if(!this.shouldTraceDeeplink(e))return;const t=this.deeplinkTrace;this.deeplinkTrace=null,t&&t.deeplinkId===e&&(t.timeout&&this.timeout.cancel(t.timeout),this.loggingService.setContext(s.Constants.categories.deeplinkId,""))}stopTracingIfNoCall(e){this.deeplinkTrace&&!this.deeplinkTrace.call&&this.stopTracingDeeplink(e)}processPendingLinkIfAvailable(){if(this.enablePendingDeeplinkReload){const e=this.storageService.get(s.Constants.storageNames.pendingMeetupDeeplink),t=this.storageService.get(s.Constants.storageNames.pendingMeetupDeeplinkUsed),n=e&&this.utilityService.isMeetupJoinUrl(e,!1);if(t||!n)this.cleanupPendingMeetupLink();else if(n){const t=this.loggingService.newScenario(s.Constants.scenarios.calling.pendingMeetupDeeplinkUsed);this.storageService.set(s.Constants.storageNames.pendingMeetupDeeplinkUsed,"true"),this.location.hash.set(e),t.stop()}}}setPendingMeetupLink(e){this.enablePendingDeeplinkReload&&(this.pendingMeetupLink=e)}storePendingMeetupLink(){this.enablePendingDeeplinkReload&&this.pendingMeetupLink&&this.utilityService.isMeetupJoinUrl(this.pendingMeetupLink,!1)&&this.storageService.set(s.Constants.storageNames.pendingMeetupDeeplink,this.pendingMeetupLink)}cleanupPendingMeetupLink(){this.enablePendingDeeplinkReload&&(this.pendingMeetupLink=void 0,this.storageService.remove(s.Constants.storageNames.pendingMeetupDeeplink),this.storageService.remove(s.Constants.storageNames.pendingMeetupDeeplinkUsed))}get enablePendingDeeplinkReload(){return!this.config.disablePendingDeeplinkReload()}tryParseAsBroadcastDeepLink(e){const t=e.match(/\{\"Tid\":\"([\w\-]{36})\",\"Oid\":\"([\w\-]{36})\",\"IsBr/);if(!t||3!=t.length)return null;const n={};return n.Tid=t[1],n.Oid=t[2],n.IsBroadcastMeeting=!0,this.config.forceAttendeeJoinBroadcastTruncatedUrl()&&(n[d.lX.RoleParamName]=d.lX.AttendeeRoleValue),n}static isSpecialCallMessageId(e){return!e||"0"===e}isConversationIdValid(e){if(!this.config.enableConversationIdValidationWhenJoiningFromDeepLink())return!0;return/^[0-9]+\:[a-z]*[\_,\-\:]{0,1}[A-Za-z0-9\-\_]+\@{0,1}[\w\.]*$/g.test(e)}static getMeetingInfo(e,t,n){if(!e.Oid)return null;const i=C.getDeepLinkType(e,t,n)===d._n.PrivateMeeting?a.Wr.Private:a.Wr.Channel,o={tenantId:e.Tid,organizerId:e.Oid,meetingType:i,replyChainMessageId:e.MessageId?e.MessageId:t,isBroadcast:e.IsBroadcastMeeting};return o.isBroadcast&&e.BroadcastRole&&(o.broadcastRole=e.BroadcastRole),o}static hasMeetingContext(e){return!!(e&&e.Tid&&e.Oid)&&!e.IsCall}static getDeepLinkType(e,t,n){const i=C.hasMeetingContext(e);return C.isSpecialCallMessageId(t)?i?d._n.PrivateMeeting:d._n.Call:n(t)?i?d._n.ScheduledMeeting:d._n.AdhocMeeting:d._n.Unknown}getScenarioName(e){return e?e.prid?s.Constants.scenarios.webinars.joinScheduledWebinarFromLink:"true"===e.IsCall?s.Constants.scenarios.calling.joinOrCreateCallFromLink:e.isUniquePresenterLink?s.Constants.scenarios.calling.joinScheduledMeetupFromUniqueLink:!0===e.IsBroadcastMeeting?s.Constants.scenarios.broadcast.joinOrCreateBroadcastFromLink:s.Constants.scenarios.calling.joinOrCreateMeetupFromLink:s.Constants.scenarios.calling.joinOrCreateMeetupFromLink}deeplinkCoordinatesToMeetingCoordinates(e,t){return e.type===d.T_.MeetingData?{type:g.G.Meeting,joinType:u.c.MeetingData,isAdhoc:!1,meetingData:{meetingCode:e.code,passcode:e.passcode,url:e.url}}:{type:g.G.Meeting,joinType:u.c.Legacy,conversationId:e.conversationId,rootMessageId:e.messageId,isChannel:!1,isAdhoc:!1,messageId:"",tenantId:t.Tid,organizerId:t.Oid,meetingCloud:t.homeCloud}}reportTelemetry(e,t,n){const i=Object.assign(Object.assign({},this.stopCallingIntentScenario(t)),t),a=this.deeplinkCoordinatesToMeetingCoordinates(n,e);return this.callingTelemetryService.createStartCallScenario(a,{scenarioName:this.getScenarioName(e),teamsCall:null,meetingEventData:i,correlationId:e.correlationId})}getMeetingData(e,t,n){const i=e.context,a=t.type===d.T_.MeetingData?d._n.ScheduledMeeting:C.getDeepLinkType(i,t.messageId,this.chatServiceUtils.isValidId),o={joinOrCreate:i.isMeetingCreation?"create":"join",meetingType:a,[s.Constants.categories.deepLinkSource]:i.Origin||"unknown",[s.Constants.categories.deeplinkId]:i.DeeplinkId||"unknown",correlationId:i.correlationId,isBroadcast:i.IsBroadcastMeeting,[s.Constants.counters.eventNames.broadcastRole]:i.BroadcastRole,[s.Constants.counters.eventNames.meetingTenantId]:i.Tid,launchAgent:i.launchAgent,[s.Constants.counters.eventNames.webinar.participantRegistrationId]:i.prid,[s.Constants.counters.eventNames.webinar.isPublicEvent]:i.isPublic,laEntry:i.laEntry,laExpId:i.laExpId,meetupJoinAfterTenantSwitch:i.meetupJoinAfterTenantSwitch,isUsingAttendeeLink:i.isUsingAttendeeLink,isUsingContextRoleLink:"a"===i.role,participantPin:encodeURIComponent(t.participantPin),broadcastData:JSON.stringify({isUsingAttendeeLink:i.isUsingAttendeeLink,isUsingContextRoleLink:"a"===i.role})};return t.type===d.T_.MeetingData?(o.meetingCode=t.code,o.deeplinkUrl=this.buildEUIIfreeLinkFromParams(e)):(o.threadId=t.conversationId,o.messageId=t.messageId),"true"===i.FromAnonymous&&(o[s.Constants.scenarios.calling.context.isRejoin]="true"===i.Rejoin),n&&(o.launchAgent=o.launchAgent||this.utilityService.getLaunchAgent(n),o.missingDeeplinkIdReceived=this.utilityService.getMissingDeeplinkId(n),!0===i.IsBroadcastMeeting&&(o.deeplinkUrl=this.buildEUIIfreeLinkFromParams(e)),o.homeCloud=i.homeCloud),o}stopCallingIntentScenario(e){const t=this.callingTelemetryService.getCallingIntentScenario();return this.callingTelemetryService.completeCallingIntentScenario(t,e)}buildEUIIfreeLinkFromParams(e){const t=e.type===d.T_.Legacy?`l/${e.linkType}`:e.linkType,n=e.type===d.T_.Legacy?e.conversationId:e.code,i=e.type===d.T_.MeetingData?`p=${e.passcode}`:"",a=e.context.laExpId?`laExpId=${encodeURIComponent(e.context.laExpId)}`:"",o=e.context.laEntry?`laEntry=${encodeURIComponent(e.context.laEntry)}`:"",r=e.context.DeeplinkId?`deeplinkId=${encodeURIComponent(e.context.DeeplinkId)}`:"",s=e.context.launchAgent?`launchAgent=${encodeURIComponent(e.context.launchAgent)}`:"",l=[e.context.Tid?`"Tid": ${e.context.Tid}`:"",e.context.Oid?`"Oid": ${e.context.Oid}`:""].filter((e=>""!==e)).join(","),c=l?`context=%7B${encodeURIComponent(l)}%7D`:"";return`${t}/${n}${e.type===d.T_.Legacy?`/${e.messageId}`:""}?${[c,r,s,i,a,o].filter((e=>""!==e)).join("&")}`}}},680586:(e,t,n)=>{var i;n.d(t,{Q:()=>i}),function(e){e[e.Unknown=0]="Unknown",e[e.Speaker=1]="Speaker",e[e.Mic=2]="Mic",e[e.Network=3]="Network",e[e.Camera=4]="Camera"}(i||(i={}))},352935:(e,t,n)=>{var i,a,o;n.d(t,{ie:()=>i,bW:()=>a,C8:()=>o}),function(e){e.EndCallingIntent="end-calling-intent",e.CleanupApp="cleanup-app",e.ChildWindowClosed="child-window-closed",e.ChildWindowCrashed="child-window-crashed",e.RejoinCall="rejoin-call",e.ExperienceRendererCrashed="experience-renderer-crashed",e.PluginHostCrashed="plugin-host-crash"}(i||(i={})),function(e){e.ExperienceContainer="Experience container",e.PluginHost="PluginHost"}(a||(a={})),function(e){e.ContentAlreadyVisible="content-already-visible",e.IntentIdAlreadyAssociatedToCall="intent-id-already-associated-to-call",e.IntentIdDoesNotExist="intent-id-does-not-exist",e.IntentIdExistsForCall="intent-id-exists-for-call",e.InvalidCall="invalid-call",e.InvalidIntentId="invalid-intent-id"}(o||(o={}))},347123:(e,t,n)=>{var i;n.d(t,{G:()=>i}),function(e){e[e.OngoingCall=0]="OngoingCall",e[e.Meeting=1]="Meeting",e[e.OneToOneCall=2]="OneToOneCall",e[e.GroupCall=3]="GroupCall"}(i||(i={}))},576057:(e,t,n)=>{var i,a,o,r,s,l,c,d;n.d(t,{wm:()=>a,qt:()=>o,MP:()=>r,q_:()=>s,Hn:()=>l,w9:()=>c,bU:()=>d}),function(e){e[e.PreJoinConnecting=0]="PreJoinConnecting",e[e.PreJoin=1]="PreJoin",e[e.PreJoinV2=2]="PreJoinV2",e[e.CallingLobby=3]="CallingLobby",e[e.Calling=4]="Calling",e[e.InCall=5]="InCall",e[e.CallEnd=6]="CallEnd"}(i||(i={})),function(e){e.SingleWindowExperience="single-window-experience",e.MultiWindowExperience="multi-window-experience"}(a||(a={})),function(e){e.CallStackFailedToInit="call-stack-failed-init",e.CallStackNotInitialized="call-stack-uninit",e.DuplicateScenarioCreation="duplicate-scenario-creation",e.FailedToGenerateIntentId="failed-to-generate-intent-id",e.InvalidStateParameters="invalid-state-parameters",e.ModernCallingContainerRemoved="modern-calling-container-removed",e.NotRelevantDuplicateAction="not-relevant-duplicate-action",e.NotWaitedForCallStackInit="not-waited-for-call-stack-init",e.TimeoutInCallStackInit="timeout-call-stack-init",e.WaitedForCallStackInit="waited-for-call-stack-init",e.WindowOpenResultError="window-open-result-err",e.UncaughtError="uncaught-err",e.UnknownEnqueueEntityCommandError="unknown-enqueue-entity-command-error",e.UnknownNavigatePromiseError="unknown-navigate-promise-error"}(o||(o={})),function(e){e.NavigatePromiseBiMError="navigate-promise-bim-error",e.DuplicateScenarioCreation="duplicate-scenario-creation"}(r||(r={})),function(e){e.ScenarioNotFound="scenario-not-found",e.IntentNotFoundForCallingWindowingContainerId="intent-not-found-for-calling-windowing-container-id",e.ContainerNotFoundForCallingWindowingContainerId="container-not-found-for-calling-windowing-container-id",e.InvalidUpdateType="invalid-update-type"}(s||(s={})),function(e){e.TargetContentFetchFailure="target-content-fetch-error",e.TargetIntenttNotFound="target-intent-not-found",e.TargetContentNotShown="target-content-not-shown",e.RerenderActionDuplicated="rerender-action-duplicated",e.NewContentAlreadyRendering="new-content-already-rendering",e.NewContentFailedToBeReplaced="new-content-failed-to-be-replaced",e.NewContentFailedToBeFocused="new-content-failed-to-be-focused",e.UnexpectedErroForGetExistingIntent="unexpected-error-for-get-existing-intent",e.ContentUpdateTimeout="content-update-timeout"}(l||(l={})),function(e){e.ExperienceContainerNotLoaded="exp-not-loaded",e.ExperienceContainerNotEnabled="exp-not-enabled",e.CommandSentSuccessfully="success",e.TabWindowWithoutCommand="tab-no-cmd",e.ChildWindowWithoutCommand="window-no-cmd",e.ExperienceRendererCrashed="exp-rend-crash",e.PluginHostCrashed="plugin-host-crash"}(c||(c={})),function(e){e.BreakoutRooms="BreakoutRooms",e.CallTransfer="CallTransfer",e.InstantMeetingDeferredConvID="InstantMeetingDeferredConvID"}(d||(d={}))},273326:(e,t,n)=>{var i;n.d(t,{n:()=>i}),function(e){e[e.DelegatorForward=0]="DelegatorForward",e[e.Forward=1]="Forward",e[e.OnBehalfOf=2]="OnBehalfOf",e[e.Transfer=3]="Transfer",e[e.CallQueue=4]="CallQueue",e[e.CallSafeTransferRingback=5]="CallSafeTransferRingback"}(i||(i={}))},592084:(e,t,n)=>{n.r(t),n.d(t,{PRIVATE_MEETUP_MESSAGE_ID:()=>a,TerminatedReasonsToCancelScenario:()=>o,ValidParticipantStateReasons:()=>r,TerminatedReasonsToIncompleteScenario:()=>s,ValidTerminatedReasons:()=>l,CallStatesWithoutModalities:()=>c,ActiveCallStates:()=>d,CallAbortReason:()=>g,CallAttemptFailureReason:()=>u,ClientSubCode:()=>p,CallingServiceState:()=>C,CallingUnsupportedServiceStates:()=>h,CallingServiceEvents:()=>m});var i=n(360452);const a="0",o=[i.yb.Success,i.yb.Cancelled],r=[i.NW.NoResponse,i.NW.Abandoned,i.NW.Declined,i.NW.NotReachable,i.NW.PstnInsufficientFunds,i.NW.PstnInvalidNumber,i.NW.PstnCreditExpired,i.NW.PstnCreditExpiredButEnough,i.NW.PstnNoSubscriptionCover,i.NW.PstnBlockedByUs,i.NW.PstnBlockedRegulatoryIndia,i.NW.PstnNumberForbidden,i.NW.Kicked,i.NW.ParticipantDoesNotExist,i.NW.DeniedInLobby,i.NW.TimedOutInLobby,i.NW.Cancelled,i.NW.Busy,i.NW.TemporarilyUnavailable,i.NW.EnterprisePstnUnavailable,i.NW.EnterprisePstnInvalidNumber,i.NW.EnterprisePstnForbidden,i.NW.ConfParticipantCountLimitReached,i.NW.ActionNotAllowed,i.NW.ForbiddenDueToPolicy,i.NW.InsufficientCapabilitiesForCallee,i.NW.AccessDenied,i.NW.NoPermission,i.NW.ConfLobbyParticipantCountLimitReached,i.NW.AnonymousJoinDisabledByPolicy,i.NW.NoLobbyForBroadcastJoin,i.NW.NotAllowedDueToInformationBarrier,i.NW.BroadcastLimitReached,i.NW.B2bJoinDisabledByPolicy,i.NW.NoSignalingFromPeer],s=[i.yb.Declined,i.yb.NoNgcEndpoint,i.yb.CallAccepted,i.yb.CallForwarded,i.yb.CallForwardedToVoicemail,i.yb.LocalHttpStackError,i.yb.Missed,i.yb.TemporarilyUnavailable,i.yb.NoSignalingFromPeer,i.yb.Kicked,i.yb.DeniedInLobby,i.yb.TimedOutInLobby,i.yb.ConfParticipantCountLimitReached,i.yb.InsufficientCapabilitiesForCallee,i.yb.BroadcastLimitReached,i.yb.NoLobbyForBroadcastJoin,i.yb.NotAllowedDueToInformationBarrier,i.yb.AnonymousJoinDisabledByPolicy,i.yb.TeamParkPolicyDisabled,i.yb.B2bJoinDisabledByPolicy,i.yb.ConfLobbyParticipantCountLimitReached],l=[...o,...s],c=[i.OX.Observing,i.OX.Preheating,i.OX.Preheated],d=[i.OX.Connecting,i.OX.EarlyMedia,i.OX.InLobby,i.OX.Connected,i.OX.LocalHold,i.OX.RemoteHold,i.OX.Staging];var g,u,p,C;!function(e){e[e.InitFailed=0]="InitFailed",e[e.JoinFailed=1]="JoinFailed",e[e.AcceptFailed=2]="AcceptFailed",e[e.ObservingCallTimeout=3]="ObservingCallTimeout"}(g||(g={})),function(e){e[e.NotSupported=1]="NotSupported",e[e.NotSupportedButDeeplinkedIntoDesktop=2]="NotSupportedButDeeplinkedIntoDesktop",e[e.CallingStackVersionMismatch=3]="CallingStackVersionMismatch",e[e.FailedCallingServiceInit=4]="FailedCallingServiceInit",e[e.FailedHandlingOngoingCalls=5]="FailedHandlingOngoingCalls",e[e.FailedCallingServiceNotInitialized=6]="FailedCallingServiceNotInitialized",e[e.UserCancelledAttemptDueToOngoingCall=7]="UserCancelledAttemptDueToOngoingCall",e[e.B2bCallJoinDisabled=8]="B2bCallJoinDisabled",e[e.MultiCallLimitReached=9]="MultiCallLimitReached",e[e.ReceivedEmptyCallObject=10]="ReceivedEmptyCallObject",e[e.PstnCallingNotAllowed=11]="PstnCallingNotAllowed"}(u||(u={})),function(e){e[e.MultiWindowCrashed=100]="MultiWindowCrashed"}(p||(p={})),function(e){e[e.Failed=0]="Failed",e[e.Uninitialized=1]="Uninitialized",e[e.Initializing=2]="Initializing",e[e.Initialized=3]="Initialized",e[e.NotSupported=4]="NotSupported",e[e.IncompatibleVersions=5]="IncompatibleVersions",e[e.Disabled=6]="Disabled"}(C||(C={}));const h=[C.Failed,C.IncompatibleVersions,C.NotSupported];class m{}m.Type_CallWithoutModalityAdded="call-without-modality-added"},147758:(e,t,n)=>{var i;n.d(t,{M:()=>i}),function(e){e[e.none=0]="none",e[e.setupAnonymous=1]="setupAnonymous",e[e.preJoinCallingScreen=2]="preJoinCallingScreen",e[e.callingScreen=3]="callingScreen",e[e.surfaceHubHomeScreen=4]="surfaceHubHomeScreen",e[e.postCallingScreen=5]="postCallingScreen",e[e.intermediateScreen=6]="intermediateScreen",e[e.postEchoBotCallingScreen=7]="postEchoBotCallingScreen"}(i||(i={}))},343508:(e,t,n)=>{var i;n.d(t,{l:()=>i}),function(e){e.ReplyChain="ReplyChain",e.CallHistory="CallHistory",e.CallHistoryDoubleClick="CallHistoryDoubleClick",e.ContactsTab="ContactsTab",e.Dialpad="Dialpad",e.ExchangeContactsTab="ExchangeContactsTab",e.EchoBotCall="EchoBotCall",e.Voicemail="Voicemail",e.RetryCall="RetryCall",e.RejoinCall="RejoinCall",e.RetryCallFromChildWindow="RetryCallFromChildWindow",e.RejoinCallFromChildWindow="RejoinCallFromChildWindow",e.CallingAnonMeetingEndScreen="CallingAnonMeetingEndScreen",e.HIDTriggered="HIDTriggered",e.ScreensharingPanelDialog="ScreensharingPanelDialog",e.SlashCommand="SlashCommand",e.VoicemailList="VoicemailList",e.VoiceSkillsCall="VoiceSkillsCall",e.VoiceSkillsPstnCall="VoiceSkillsPstnCall",e.Unpark="Unpark",e.RigelConsoleNewMeeting="RigelConsoleNewMeeting",e.AcceptCall="AcceptCall",e.AcceptCallFromHid="AcceptCallFromHid",e.RejectCallFromHid="RejectCallFromHid",e.AcceptCallFromShortcut="AcceptCallFromShortcut",e.RejectCallFromShortcut="RejectCallFromShortcut",e.AnswerMutedCall="AnswerMutedCall",e.AutoAcceptBreakoutRoomInvite="AutoAcceptBreakoutRoomInvite",e.AutoAcceptMainMeetingInvite="AutoAcceptMainMeetingInvite",e.AcceptBreakoutRoomInvite="AcceptBreakoutRoomInvite",e.AcceptMainMeetingInvite="AcceptMainMeetingInvite",e.GoToAssignedBreakoutRoom="GoToAssignedBreakoutRoom",e.GoBackToMainMeetingFromBreakoutRoom="GoBackToMainMeetingFromBreakoutRoom",e.DeclineBreakoutRoomInvite="DeclineBreakoutRoomInvite",e.DeclineMainMeetingInvite="DeclineMainMeetingInvite",e.BreakoutRoomInviteTimeOut="BreakoutRoomInviteTimeOut",e.MainMeetingInviteTimeOut="MainMeetingInviteTimeOut",e.CloseBreakoutRoom="CloseBreakoutRoom",e.MultipleBreakoutRoomWindowsNotAllowed="SingleBreakoutRoomWindowOnlyAllowed",e.BreakoutRoomMoveWithinSameWindow="BreakoutRoomMoveWithinSameWindow",e.GetUserMediaReload="GetUserMediaReload",e.AcceptFromJoinCall="AcceptFromJoinCall",e.StartConsultation="StartConsultation",e.CallingDeeplinkDialog="CallingDeeplinkDialog",e.CallingStartButton="CallingStartButton",e.CallingStartButtonWithDropdown="CallingStartButtonWithDropdown",e.CentralDataLayer="CentralDataLayer",e.LivePersonCard="LivePersonCard",e.PromptToTalk="PromptToTalk",e.CallingProtocolDialog="CallingProtocolDialog",e.MultiWindowScreensharingPanelDialog="MultiWindowScreensharingPanelDialog",e.PlaceCallViaDeepLink="PlaceCallViaDeepLink",e.StartMeetup="StartMeetup",e.StartMeetupFromCode="StartMeetupFromCode",e.MultiWindow="MultiWindow",e.MeetingJoinButton="meeting_join_button",e.GroupCallJoinButton="group_call_join_button",e.DeepLink="DeepLink",e.ChildWindowChatCallButton="ChildWindowChatCallButton",e.CallsAppV2Dialpad="callsapp_v2_dialpad",e.MeetingChatHeader="meeting_chat_header",e.MeetingDetailFullPage="meeting_detail_full_page",e.MeetingAttendeeDetails="meeting_attendee_details",e.MeetingStartedNotification="meeting_started_notification",e.MeetingQuickCalendar="meeting_quick_calendar",e.CalendarPrivateAdhoc="calendar_private_adhoc",e.JoinMeetingFromNotificationToDevice="join_meeting_notification_device",e.JoinMeetingFromToastNotification="join_meeting_from_toast",e.JoinCallFromIntentMutation="JoinCallFromIntentMutation",e.JoinCallFromIdMutation="JoinCallFromIdMutation",e.Channel="channel",e.ChannelPersistent="channel-persistent",e.ChatHeader="chat-header",e.ChatHeaderCallTransfer="chat-header-call-transfer",e.NavigateToCall="navigate-to-call",e.VoiceSkillsJoinMeeting="voice_skills_join_meeting",e.MeetingSurfaceHubCalendar="meeting_surface_hub_calendar",e.ScreenshareFromchat="screenshare_from_call",e.ScreenshareFromMwCall="screenshare-from-mw-call",e.HIDDialpad="HIDDialpad",e.Banner="Banner",e.JoinCallFromIdBridgeMutation="join_with_id_flyout_bridge",e.JoinCallByInvitationContent="join_call_by_invitation_content",e.JoinCallWithoutModality="join_call_without_modality",e.CallingResolvers="calling-resolvers",e.ObservableCallService="observableCallService",e.BreakoutRoomWithAssignment="breakout-room-with-assignment-distribution-service",e.JoinNotificationService="joinNotificationService",e.CallingEventsPublisher="calling-events-publisher",e.CallingThreadHeader="calling-thread-header",e.CalendarMeetings="calendar-meetings",e.CallingPreJoinScreen="calling-pre-join-screen"}(i||(i={}))},972858:(e,t,n)=>{n.r(t),n.d(t,{BaseCallEndRules:()=>O,CallingTelemetryService:()=>_,MeetingJoinScenarioGroups:()=>R,NoopScenario:()=>w,ResultCategoryStrings:()=>N});var i=n(361366),a=n(360452),o=n(197981),r=n(796973),s=n(524060),l=n(576057),c=n(352935),d=n(592084),g=n(952415),u=n(347123),p=n(2781),C=n(686621),h=n(62606),m=n(376617),S=n(124534);class v{constructor(e,t){this.source=e,this.target=t,this.appendEventData=e=>this.source.appendEventData(e),this.cancel=e=>this.source.cancel(e),this.fail=e=>this.source.fail(e),this.incomplete=e=>this.source.incomplete(e),this.mark=(e,t,n)=>this.source.mark(e,t,n),this.pause=e=>this.source.pause(e),this.resume=e=>this.source.resume(e),this.stop=(e,t,n)=>this.source.stop(e,t,n),this.timeoutInMs=e=>this.source.timeoutInMs(e),t.appendEventData(Object.assign(Object.assign({},e.eventData),{mirroredScenarioName:e.name,mirroredScenarioClientId:e.clientId})),this.setUpMirroring(e,t)}get cancelIfOffline(){return this.source.cancelIfOffline}set cancelIfOffline(e){this.target.cancelIfOffline=e,this.source.cancelIfOffline=e}get clientId(){return this.source.clientId}set clientId(e){this.source.clientId=e}get eventData(){return this.source.eventData}set eventData(e){this.target.eventData=e,this.source.eventData=e}get id(){return this.source.id}set id(e){this.source.id=e}get name(){return this.source.name}set name(e){this.source.name=e}get whenStopped(){return this.source.whenStopped}set whenStopped(e){this.source.whenStopped=e}setUpMirroring(e,t){const n=e.appendEventData.bind(e);e.appendEventData=e=>(t.appendEventData(e),n(e));const i=e.cancel.bind(e);e.cancel=e=>(t.cancel(e),i(e));const a=e.fail.bind(e);e.fail=e=>(t.fail(e),a(e));const o=e.incomplete.bind(e);e.incomplete=e=>(t.incomplete(e),o(e));const r=e.mark.bind(e);e.mark=(e,n,i)=>(t.mark(e,n,i),r(e,n,i));const s=e.pause.bind(e);e.pause=e=>(t.pause(e),s(e));const l=e.resume.bind(e);e.resume=e=>(t.resume(e),l(e));const c=e.timeoutInMs.bind(e);e.timeoutInMs=e=>(t.timeoutInMs(e),c(e));const d=e.stop.bind(e);e.stop=(e,n,i)=>(t.stop(e,n,i),d(e,n,i))}}class I{constructor(e){this.loggingService=e.loggingService,this.utilityService=e.utilityService,this.baseScenarioIdToMirrorScenario=new Map,this.globalScenarioToPrevStep=new Map,this.globalScenarios=new Set,this.globalIdToBaseScenario=new Map,this.contributors=new Set,this.nonSteps=f()}startGlobalScenario(e,t){const n=e.id;if(this.baseScenarioIdToMirrorScenario.has(n))return this.baseScenarioIdToMirrorScenario.get(n);const i=this.utilityService.generateUUID(),a=this.loggingService.newScenario(t.name,void 0,(e=>{this.globalScenarioCleanup(a,n)}),t.timeoutMs,void 0,void 0,void 0,void 0,void 0,i,(e=>{this.globalScenarioCleanup(a,n)}));this.globalScenarios.add(a),this.globalIdToBaseScenario.set(i,e);const o=new v(e,a);return n&&this.baseScenarioIdToMirrorScenario.set(n,o),this.setUpMarkToTrackPreviousStep(a),o}registerGlobalContributor(e){this.contributors.has(e)||(this.setUpContributor(e),this.contributors.add(e))}globalScenarioCleanup(e,t){this.globalScenarioToPrevStep.delete(e.clientId),this.globalScenarios.delete(e),this.globalIdToBaseScenario.delete(e.clientId),this.baseScenarioIdToMirrorScenario.delete(t)}setUpMarkToTrackPreviousStep(e){const t=e.mark.bind(e);e.mark=(n,i,a)=>{const o=this.globalScenarioToPrevStep.get(e.clientId);t(n,Object.assign(Object.assign({},i),{previousStep:o}),a),this.nonSteps.has(n)||this.globalScenarioToPrevStep.set(e.clientId,n)}}setUpContributor(e){const t=this.globalScenarios;e.whenStopped.then((t=>{this.contributors.delete(e)}));const n=e.appendEventData.bind(e);e.appendEventData=i=>(this.aggregateMark(e,t,T.mirroredScenario.steps.appendEventData,i),n(i));const i=e.cancel.bind(e);e.cancel=n=>(this.aggregateMark(e,t,T.mirroredScenario.steps.cancel,n),i(n));const a=e.fail.bind(e);e.fail=n=>(this.aggregateMark(e,t,T.mirroredScenario.steps.fail,n),a(n));const o=e.incomplete.bind(e);e.incomplete=n=>(this.aggregateMark(e,t,T.mirroredScenario.steps.incomplete,n),o(n));const r=e.mark.bind(e);e.mark=(n,i,a)=>(this.aggregateMark(e,t,n,i,a),r(n,i,a));const s=e.pause.bind(e);e.pause=n=>(this.aggregateMark(e,t,T.mirroredScenario.steps.pause,n),s(n));const l=e.resume.bind(e);e.resume=n=>(this.aggregateMark(e,t,T.mirroredScenario.steps.resume,n),l(n));const c=e.stop.bind(e);e.stop=(n,i,a)=>(this.aggregateMark(e,t,T.mirroredScenario.steps.stop,n,a),c(n,i,a));const d=e.timeoutInMs.bind(e);e.timeoutInMs=n=>(this.aggregateMark(e,t,T.mirroredScenario.steps.timeoutInMs,{extension:n}),d(n))}aggregateMark(e,t,n,i,a){t.forEach((t=>{this.globalIdToBaseScenario.get(t.clientId)!==e&&t.mark(n,Object.assign(Object.assign(Object.assign({},e.eventData),i),{sourceScenarioName:e.name,sourceScenarioClientId:e.clientId}),a)}))}}const f=()=>{const e=Object.values(T.mirroredScenario.steps);return new Set(e)},T={mirroredScenario:{steps:{appendEventData:"aggregate-append-event-data",cancel:"aggregate-cancel",fail:"aggregate-fail",incomplete:"aggregate-incomplete",pause:"aggregate-pause",resume:"aggregate-resume",setCancelIfOffline:"aggregate-cancel-if-offline",setClientId:"aggregate-set-client-id",setEventData:"aggregate-set-event-data",setId:"aggregate-set-id",setName:"aggregate-set-name",setWhenStopped:"aggregate-set-when-stopped",stop:"aggregate-stop",timeoutInMs:"aggregate-timeout-in-ms"}}},y=[r.Constants.scenarios.calling.callAccept,r.Constants.scenarios.calling.callingServiceInit,r.Constants.scenarios.calling.createMeetup,r.Constants.scenarios.calling.mediaConnected,r.Constants.events.rigel.service.scenarios.joinMeetingStart,"cal_join_online_meeting",r.Constants.scenarios.calling.joinOrCreateMeetupFromLink,r.Constants.scenarios.calling.joinScheduledMeetup,r.Constants.scenarios.calling.joinScheduledMeetupFromUniqueLink,r.Constants.scenarios.webinars.joinScheduledWebinarFromLink],E=(e,t,n)=>{if(!y.includes(e.name))return;if(!t)return;const i=A(t,n),a=M(t);e.appendEventData(Object.assign(Object.assign({},i),a))},A=(e,t)=>{var n;if(!t)return;let i;const a=null===(n=e.meetingDetails)||void 0===n?void 0:n.meetingCapability;if(a&&t){const{video:e,screenshare:n}=t.getWatermarkMeetingOptions(a);i=b(e||!1,n||!1)}return i},b=(e,t)=>({[r.Constants.scenarios.premiumCapability.watermark.videoEnabled]:e,[r.Constants.scenarios.premiumCapability.watermark.screenShareEnabled]:t}),M=e=>{var t;let n;const i=null===(t=e.meetingDetails)||void 0===t?void 0:t.meetingCapability;if(i){const{meetingEndToEndEncryptionEnabled:e=!1}=i;n=D(e)}return n},D=e=>({[r.Constants.scenarios.premiumCapability.e2ee.meetingEndToEndEncryptionEnabled]:e});var P=skype.trouter.TrouterState;const R=[r.Constants.scenarios.calling.callingIntent,r.Constants.scenarios.broadcast.joinMeetupBroadcast,r.Constants.scenarios.broadcast.joinOrCreateBroadcastFromLink,r.Constants.scenarios.calling.callingStackInit,r.Constants.scenarios.calling.joinMeetup,r.Constants.scenarios.calling.callingPerformance,r.Constants.scenarios.calling.joinMeetingFromToastNotification,r.Constants.scenarios.calling.joinOrCreateMeetupFromLink,r.Constants.scenarios.calling.joinScheduledMeetup,r.Constants.scenarios.calling.joinMeetupFromReplyChain];var N;!function(e){e.Success="success",e.ExpectedError="expectederror",e.ExpectedNoNetworkError="expectednonetworkerror",e.UnexpectedNetworkError="unexpectednetworkerror",e.UnexpectedClientError="unexpectedclienterror",e.UnexpectedServerError="unexpectedservererror"}(N||(N={}));const O=[{scenarios:["create_one_to_one_pstn_call"],ccSubCodes:[500001,[560400,560404],[560406,560410],[560480,560488],[560500,560504],560513,560600,560603,560604,560606,560607,569002,569003,[569006,569009],569013],action:"incomplete"}];class _{constructor(e,t,n,i,a,o,s,l,c,d,g,u,C,h,m=!0,S=p.EsPromiseFactory,v){this.config=e,this.conversationsAsyncService=t,this.callingAgentsService=n,this.loggingService=i,this.trouterService=a,this.timeout=o,this.utilityService=s,this.deviceManagerService=l,this.eventingService=c,this.callingSupportService=d,this.messagingTelemetryService=g,this.servicesProvider=u,this.helpers=C,this.chatServiceUtils=h,this.promiseFactory=S,this.appStateService=v,this.userRoles={},this.isSendingLogs=!1,this.callsWithExistingSubcriptions=new WeakSet,this.enableCallingDisconnectedAutoBrb=!1,this.callingCallDisconnectedCrashReported=!1,this.maxVideosToRender=0,this.enableTfWMeetingCode=!1,this.isTflUser=!1,this.ongoingJoinAttempts=[],this.isFirstLoad=!1,this.logger=i.newLogger("CallingTelemetryService");const I=r.Constants.scenarios.calling;this.callingScenarios=[I.createMeetup,I.joinMeetupFromReplyChain,I.joinOrCreateMeetupFromLink,I.joinScheduledMeetup,I.callAccept,I.createOneToOneCall,I.createOneToOneInteropCall,I.createOneToOneInteropSfcCall,I.createOneToOnePstnCall,I.createGroupCall,I.joinGroupCall,I.screenshareAccept,I.createGroupScreenshareCall,I.createOneToOneScreenshareCall,I.joinScreenshareCall,I.incomingScreenshareCall,I.screenshareCallEscalate,I.lbrEnabledCall,I.callqueue.incoming,I.callqueue.accept,I.callqueue.transferRequest,I.callqueue.transferAcceptedCall,r.Constants.scenarios.broadcast.callAcceptBroadcast,r.Constants.scenarios.broadcast.joinMeetupBroadcast,r.Constants.scenarios.broadcast.joinOrCreateBroadcastFromLink,r.Constants.scenarios.broadcast.joinScheduledMeetupBroadcast,r.Constants.scenarios.calling.joinOrCreateCallFromLink],m&&this.initializeOnAppLaunchAndReinit()}disposeService(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return new Promise((t=>{this.cleanupOnAppTeardown(e.reason),t()}))}))}initializeOnAppLaunchAndReinit(e){this.isAttachCallingLogsEnabled=this.config.enableAttachCallingLogs(),this.isDesktopApp=this.config.isDesktopApp(),this.shouldCancelScenarioIfOffline=this.config.abandonCallingMeetingScenario(),this.enableCallingDisconnectedAutoBrb=this.config.enableCallingDisconnectedAutoBrb(),this.maxVideosToRender=0,this.isFirstLoad=!0,this.callEndRules=[...O,...this.config.extraCallEndRules()],this.sendAutoBRBForTimeoutCallingScenarios=this.config.timeoutScenarioNamesToSendAutoBrb()||[],this.sendAutoBRBForFailedCallingScenarios=this.config.failedScenarioNamesToSendAutoBrb()||[],this.enableTfWMeetingCode=this.config.enableTfWMeetingCode(),this.isTflUser=this.config.isTflUser(),this.globalTelemetry=new I({loggingService:this.loggingService,utilityService:this.utilityService})}cleanupOnAppTeardown(e){this.callInLoggingContext=void 0,this.isDesktopApp=void 0,this.noopScenario=void 0,this.userRoles={},this.isSendingLogs=!1,this.isAttachCallingLogsEnabled=void 0,this.callsWithExistingSubcriptions=new WeakSet,this.shouldCancelScenarioIfOffline=void 0,this.enableCallingDisconnectedAutoBrb=!1,this.callingCallDisconnectedCrashReported=!1,this.ongoingJoinAttempts=[],this.isFirstLoad=!1,this.callEndRules=[],this.sendAutoBRBForTimeoutCallingScenarios=[],this.sendAutoBRBForFailedCallingScenarios=[],this.enableTfWMeetingCode=!1,this.isTflUser=!1,this.globalTelemetry=void 0}createStartCallScenario(e,t){const n=this.processStartCallTelemetry(e,t);if(n)return n;const i=this.newMeetingScenario(t.teamsCall,t.scenarioName,t.meetingEventData,void 0,(()=>this.updateOngoingJoinAttempts(e,t)));return this.ongoingJoinAttempts.push({scenario:i,coordinates:e,correlationIds:t.correlationId?[t.correlationId]:[],mainAttemptCorrelationId:t.correlationId}),i}getStartCallScenario(e,t){const n=this.getOngoingJoinAttempt(e,t);return null==n?void 0:n.scenario}wasScenarioAttemptedMultipleTimes(e,t){const n=this.getOngoingJoinAttempt(e,t);return!!(null==n?void 0:n.wasAttemptedMultipleTimes)}isScenarioAlreadyStarted(e,t){const n=this.getOngoingJoinAttempt(e,t);return!!n&&n.correlationIds.some((e=>e!==t))}getAcceptCallScenarioName(e,t){return e.isCallQueue?r.Constants.scenarios.calling.callqueue.accept:e.isScreenshareFromChat?r.Constants.scenarios.calling.screenshareAccept:t?r.Constants.scenarios.broadcast.callAcceptBroadcast:["scheduledMeeting","adHocMeeting"].includes(e.conversationType)?r.Constants.scenarios.calling.callAcceptMeeting:r.Constants.scenarios.calling.callAccept}static getSubscriptionStateAsString(e){switch(e){case P.Connected:return"Connected";case P.Disconnected:return"Disconnected";case P.Switching:return"Switching"}return"Unknown"}static getFrameTypeAsString(e){switch(e){case a.Qp.None:return"none";case a.Qp.Software:return"software";case a.Qp.Hardware:return"hardware";default:return"unknown"}}static getErrorMessage(e,t,n=_.DEFAULT_PROPS_GET_ERROR_MSG){if(null==e)return"";if("string"==typeof e)return e;if("object"==typeof e&&e instanceof Error)return JSON.stringify(e,n);let i;try{i=JSON.stringify(e)}catch(e){i=`passing bad object to JSON.stringify. ${e.message}`,t&&t.error(`passing bad object to JSON.stringify. ${e}`)}return i}incompleteCallingScenarios(e,t,n){const i=this.utilityService.scrubEuii(e),a=this.utilityService.scrubEuii(n);R.forEach((e=>this.loggingService.findAllScenariosByName(e).forEach((e=>e.incomplete({reason:i,errorCode:t,errorMessage:a})))))}setUserRoleForCall(e,t){this.userRoles[e.teamsCallId]=t,e.getStartCallScenario().then((e=>{e.eventData[r.Constants.counters.eventNames.callParticipantUserRole]=t})).catch((e=>{this.logger.warn(this.utilityService.getErrorLoggingString(e))})),this.eventingService.emit(r.Constants.events.calling.callParticipantUserRoleChanged,{teamsCallId:e.teamsCallId,userRole:t})}setCrossCloudCall(e,t){var n,i;const a=null===(i=null===(n=e.getIntent())||void 0===n?void 0:n.joinOptions)||void 0===i?void 0:i.homeCloud,o=t||!!a;e.getStartCallScenario().then((e=>{e.eventData[r.Constants.counters.eventNames.homeCloud]=a,e.eventData[r.Constants.counters.eventNames.isCrossCloudCall]=o})).catch((e=>{this.logger.warn(this.utilityService.getErrorLoggingString(e))}))}newCallingInitScenario(){const e=this.loggingService.newScenario(r.Constants.scenarios.calling.callingServiceInit,null,null,null,!0);return e.eventData.isWindowsN=this.isWindowsN(),e.eventData[r.Constants.counters.eventNames.environmentSupport]=this.callingAgentsService.getEnvironmentSupport(),e}newMeetingScenario(e,t,n,i,a){return this.newCallingScenario(e,t,this.getEventData(n),i,void 0,a)}newCallingIntentScenario(e,t,n,i){const a=r.Constants.scenarios.calling.callingIntent;(n=Object.assign(Object.assign({[r.Constants.counters.eventNames.method]:s.LW[e]},this.getCommonEventData(t)),n))[r.Constants.counters.eventNames.correlationId]=n[r.Constants.counters.eventNames.correlationId]||this.utilityService.generateUUID();const o=this.messagingTelemetryService.previousSwitchScenario;o&&(n[r.Constants.counters.eventNames.previousStep]=JSON.stringify({scenarioName:o.name,feedsType:o.eventData.feedsType,[r.Constants.counters.eventNames.feedsSubtype]:o.eventData[r.Constants.counters.eventNames.feedsSubtype],[r.Constants.counters.eventNames.messageId]:o.eventData[r.Constants.counters.eventNames.messageId]}));const l=this.loggingService.newScenario(a,null,null,null,!0);return l.clientId=t?C.TeamsCallService.getTeamsCallIdAsString(t.teamsCallId):i||this.utilityService.generateUUID(),l.appendEventData(n),l}getCallingWindowPopoutScenario(e){return this.loggingService.findScenarioByNameAndId(r.Constants.scenarios.calling.callingWindowPopoutIntent,e.id)}getCallingWindowingCreateContainerScenario(e){return this.loggingService.findScenarioByNameAndId(r.Constants.scenarios.calling.callingWindowingCreateContainer.scenarioName,e)}getCallingWindowingShowContainerInit(e){return this.loggingService.findScenarioByNameAndId(r.Constants.scenarios.calling.callingWindowingShowContainerInit.scenarioName,e)}newCallingWindowPopoutScenario(e,t){const n=r.Constants.scenarios.calling.callingWindowPopoutIntent,i=this.getCallingWindowPopoutScenario(e);if(i)return i;const a=S.CallingIntentUtilities.intentToTelemetryData(e);a.fromChildWindow=t,a[r.Constants.counters.eventNames.correlationId]=e.joinOptions.correlationId||e.id;const o=this.loggingService.newScenario(n,null,null,null,!0);return o.clientId=e.id,o.appendEventData(a),o}newCallingWindowingCreateContainerScenario(e,t,n,i,a,o,s,c){var d,g;const u=r.Constants.scenarios.calling.callingWindowingCreateContainer.scenarioName,p=this.getCallingWindowingCreateContainerScenario(s);if(p){const t=`The scenario is already existed. [intentId=${e}, windowingActionId=${a}]`;this.logger.error(t);const n=l.qt.DuplicateScenarioCreation;p.fail({reasonCMD:n,reason:n})}const C={windowing_mode:t,calling_intent_type:n,context:o,window_type:c,windowing_action_id:a,calling_intent_id_input:i,calling_intent_id_generated:e},h=this.loggingService.newScenario(u,null,null,null,!0);return h.clientId=s,(null===(g=(d=this.config).callingScenarioExtendedTimeout)||void 0===g?void 0:g.call(d))>0&&h.timeoutInMs(+this.config.callingScenarioExtendedTimeout()),h.appendEventData(C),h}newCallingWindowingUpdateContainerScenario(e,t,n,i,a,o){const s=r.Constants.scenarios.calling.callingWindowingUpdateContainer.scenarioName,c=this.loggingService.findScenarioByNameAndId(r.Constants.scenarios.calling.callingWindowingUpdateContainer.scenarioName,t);if(c){const e=`The scenario is already existed. [windowingActionId=${t}]`;this.logger.error(e);const n=l.MP.DuplicateScenarioCreation;c.fail({reasonCMD:n,reason:n})}const d={windowingMode:e,context:i,windowType:o,windowingActionId:t,intentIdInput:n},g=this.loggingService.newScenario(s,null,null,a,!0);return g.clientId=t,g.appendEventData(d),g}newCallingWindowingShowContainerInitScenario(e,t,n,i,a,o){const s=r.Constants.scenarios.calling.callingWindowingShowContainerInit.scenarioName,c=this.getCallingWindowingShowContainerInit(i);if(c){const t=`The scenario is already existed. [intentId=${e}, windowingActionId=${i}]`;this.logger.error(t);const n=l.qt.DuplicateScenarioCreation;c.fail({reasonCMD:n,reason:n})}const d={windowing_mode:t,calling_intent_type:n,context:a,window_type:o,windowing_action_id:i,calling_intent_id_input:e},g=this.loggingService.newScenario(s,null,null,null,!0);return g.clientId=i,g.appendEventData(d),g}newContentSharingScenario(e,t,n,i,a={},o){return this.newCallingScenario(e,t,Object.assign(Object.assign({},a),{correlationId:n,type:i}),o)}getOrCreateCallingIntentScenario(e,t,n,i){const a=e&&this.getCallingIntentScenario(e);return a||this.newCallingIntentScenario(t,n,i)}getCallingIntentScenario(e){return e?this.loggingService.findScenarioByNameAndId(r.Constants.scenarios.calling.callingIntent,e):this.loggingService.findScenario(r.Constants.scenarios.calling.callingIntent)}completeCallingIntentScenario(e,t){if(e)return this.logger.info(`complete calling intent scenario ${(0,o.cloneDeep)(t)}`),this.getDeficiencyDataFromIntentScenario(e)}getDeficiencyDataFromIntentScenario(e){return{[r.Constants.counters.eventNames.deficiency]:e.eventData[r.Constants.counters.eventNames.deficiency],[r.Constants.counters.eventNames.limitedDeviceAccess]:e.eventData[r.Constants.counters.eventNames.limitedDeviceAccess],[r.Constants.counters.eventNames.permissions]:e.eventData[r.Constants.counters.eventNames.permissions],[r.Constants.counters.eventNames.constraints]:e.eventData[r.Constants.counters.eventNames.constraints],[r.Constants.counters.eventNames.correlationId]:e.eventData[r.Constants.counters.eventNames.correlationId]}}newCallingScenario(e,t,n,i,a,o,r){let s,l={};_.isTeamsCall(e)?(s=e.teamsCallId,l=this.getCommonEventData(e)):s=e;const c=n&&n.overrideTimestamp||null,d=c?this.loggingService.newScenario(t,null,o,i,!0,null,c,void 0,void 0,void 0,void 0,r):this.loggingService.newScenario(t,null,o,i,!0,null,void 0,void 0,void 0,void 0,void 0,r);return d.clientId=a||(s?C.TeamsCallService.getTeamsCallIdAsString(s):this.utilityService.generateUUID()),d.appendEventData(Object.assign(Object.assign(Object.assign({},l),n),{clientId:d.clientId})),this.shouldCancelScenarioIfOffline&&(d.cancelIfOffline=!0),this.sendAutoBrbOnSceanrioStop(d),E(d,_.isTeamsCall(e)?e:void 0,this.callingSupportService),d}newCallsAppScenario(e){const t=this.loggingService.findScenario(r.Constants.scenarios.calling.callsMainAppLoad);if(t){const e="trying to navigate to screen again before previous attempt completed";this.logger.error(e),t.eventData.reason=e,t.fail()}const n=this.loggingService.newScenario(r.Constants.scenarios.calling.callsMainAppLoad,null,null,null,!0);return n.clientId=r.Constants.callsMainApp.clientId,n.eventData.context=e,n}newCallableChannelAppScenario(e,t){const n=this.loggingService.findScenario(r.Constants.scenarios.calling.callableChannelAppLoad);if(n){const e="trying to navigate to screen again before previous attempt completed";this.logger.error(e),n.eventData.reason=e,n.fail()}const i=this.loggingService.newScenario(r.Constants.scenarios.calling.callableChannelAppLoad,null,null,null,!0);return i.clientId=t,i.eventData.context=e,i}generateRendererId(){return this.utilityService.generateUUID()}handleCallSuccess(e,t,n){e.then((e=>{[e,...t].forEach((e=>{e?((0,o.forIn)(this.getCommonEventData(n),((t,n)=>{e.eventData[n]=t})),e.name===r.Constants.scenarios.calling.callingIntent&&e.stop()):this.logger.error(`Received null scenario in handleCallSuccess for TeamsCall-callId: ${n.callId}`)}))}))}handleCallFailure(e,t,n,i){const a=this.utilityService.getErrorLoggingString(n);let r,s;this.loggingService.error(`handleCallFailure: ${a}`);const l=[c.ie.ChildWindowClosed,c.ie.CleanupApp,c.ie.EndCallingIntent,c.ie.RejoinCall];if((0,o.includes)(l,n)&&(r="incomplete"),this.isCallAttemptFailureType(n))switch(s=d.CallAttemptFailureReason[n.reason],n.reason){case d.CallAttemptFailureReason.NotSupported:case d.CallAttemptFailureReason.NotSupportedButDeeplinkedIntoDesktop:case d.CallAttemptFailureReason.CallingStackVersionMismatch:case d.CallAttemptFailureReason.B2bCallJoinDisabled:case d.CallAttemptFailureReason.MultiCallLimitReached:case d.CallAttemptFailureReason.PstnCallingNotAllowed:r="incomplete";break;case d.CallAttemptFailureReason.UserCancelledAttemptDueToOngoingCall:r="cancel";break;case d.CallAttemptFailureReason.FailedCallingServiceInit:case d.CallAttemptFailureReason.FailedHandlingOngoingCalls:case d.CallAttemptFailureReason.FailedCallingServiceNotInitialized:case d.CallAttemptFailureReason.ReceivedEmptyCallObject:r="fail"}s=s||a,e.then((e=>{[e,...t].forEach((e=>{e.appendEventData({error:a,reason:s,reasonCMD:s}),i?this.finishCallScenarios(i,[e],r,s):this.endCallScenarios([e],e.name,r,s)}))}))}newCallingStopScenario(e,t,n){const i=Object.assign({[r.Constants.counters.eventNames.context]:t},n);return this.newCallingScenario(e,r.Constants.scenarios.calling.endMeetup,i)}searchForAnyCallStartScenario(){for(const e of this.callingScenarios){const t=this.loggingService.findScenario(e);if(t)return t}}newCallingLeaveScenario(e,t,n){const i=r.Constants.scenarios.calling.leaveScenarioMaxWaitTime,a=Object.assign({[r.Constants.counters.eventNames.context]:t},n);if("string"==typeof e){const e=this.loggingService.newScenario(r.Constants.scenarios.calling.leaveMeetup,void 0,void 0,i,!0);return e.appendEventData(a),e}const o=e.isScreenshareFromChat?r.Constants.scenarios.calling.leaveScreenshare:r.Constants.scenarios.calling.leaveMeetup;return this.newCallingScenario(e,o,a,i)}getPrepareCallScenario(){return this.loggingService.findScenario(r.Constants.scenarios.calling.prepareCall)}getCoMeAutoJoinCallScenario(){return this.loggingService.findScenario(r.Constants.scenarios.coordinatedMeetings.joinCall)}newStartVideoScenario(e,t,n){const i=Object.assign(Object.assign({},n),{[r.Constants.counters.eventNames.context]:t});return this.newCallingScenario(e,r.Constants.scenarios.calling.startVideo,i)}newStopVideoScenario(e,t,n){const i=Object.assign(Object.assign({},n),{[r.Constants.counters.eventNames.context]:t});return this.newCallingScenario(e,r.Constants.scenarios.calling.stopVideo,i)}newDeviceBlurringCapabilityScenario(e){const t={[r.Constants.counters.eventNames.context]:e};return this.newCallingScenario(null,r.Constants.scenarios.calling.blurringGetEffectsCapability,t)}newWhiteboardSetVideoEffectsScenario(e,t){const n={[r.Constants.counters.eventNames.context]:e,[r.Constants.counters.eventNames.effectType]:t};return this.newCallingScenario(null,r.Constants.scenarios.calling.whiteboardSetEffects,n)}newSetVideoCaptureConfigScenario(e){const t={[r.Constants.counters.eventNames.context]:e};return this.newCallingScenario(null,r.Constants.scenarios.calling.setVideoCaptureConfig,t)}newBackgroundEffectLoaderDuration(e,t){const n={[r.Constants.counters.eventNames.context]:t};return this.newCallingScenario(e,r.Constants.scenarios.calling.blurringWebLoaderDuration,n)}newBlurringSetVideoEffectsScenario(e,t,n){const i={[r.Constants.counters.eventNames.context]:t,[r.Constants.counters.eventNames.effectType]:n};return this.newCallingScenario(e,r.Constants.scenarios.calling.blurringSetEffects,i)}newSetBackgroundImagesScenario(e,t,n,i,a){const o={[r.Constants.counters.eventNames.context]:t,[r.Constants.counters.eventNames.effectType]:n,[r.Constants.counters.eventNames.imageType]:i,[r.Constants.counters.eventNames.isDefaultImage]:a};return this.newCallingScenario(e,r.Constants.scenarios.calling.setVideoBackgroundImage,o)}newVideoStreamStartedRenderingScenario(e,t){const n=r.Constants.timeInMiliseconds.minute;return this.newCallingScenario(e,r.Constants.scenarios.calling.videoStreamRendering,t,n)}newCreateCompositorScenario(e,t){const n=r.Constants.timeInMiliseconds.minute;return this.newCallingScenario(e,r.Constants.scenarios.calling.compositor.scenarios.createCompositor,t,n)}newVideoStreamStoppedRenderingScenario(e,t){const n=r.Constants.timeInMiliseconds.minute;return this.newCallingScenario(e,r.Constants.scenarios.calling.videoStreamStopped,t,n)}newHoldResumeCallScenario(e,t,n,i){const a=n?r.Constants.scenarios.calling.holdCall:r.Constants.scenarios.calling.resumeCall,o={[r.Constants.counters.eventNames.context]:t,[r.Constants.counters.eventNames.reason]:i};return this.newCallingScenario(e,a,o)}newCallSwitchingScenario(e,t,n){const i={[r.Constants.counters.eventNames.context]:t,[r.Constants.counters.eventNames.holdDurationInMillis]:n};return this.newCallingScenario(e,r.Constants.scenarios.calling.multiCallList.callResumeClicked,i)}getOrCreatePreJoinScenario(e,t,n=!0,i=!1){if(!(this.callingSupportService.isPreJoinEnabled()&&n||i))return this.noopScenario||(this.noopScenario=new w),this.noopScenario;const a=i?r.Constants.scenarios.broadcast.joinMeetupBroadcast:r.Constants.scenarios.calling.joinMeetup;e||(e=this.utilityService.generateUUID());let o=this.loggingService.findScenarioByNameAndId(a,e);return o||(t||(t={}),o=this.loggingService.newScenario(a,null,null,null,!0),o.clientId=e,o.appendEventData(t),o)}getOrCreateCallCompanionTransferScenario(e,t){const n=r.Constants.scenarios.calling.joinCallFromCompanionTransfer;e||(e=this.utilityService.generateUUID());let i=this.loggingService.findScenarioByNameAndId(n,e);return i||(t||(t={}),i=this.loggingService.newScenario(n,null,null,null,!0),i.clientId=e,i.appendEventData(t),i)}trackCallProgress(e,t){var n,i;if(!e){const e="no call object received";return t&&t.fail({reason:e}),this.promiseFactory.reject(e)}if(!t)return this.promiseFactory.resolve(e);if(this.callsWithExistingSubcriptions.has(e))return this.promiseFactory.resolve(e);if(this.callsWithExistingSubcriptions.add(e),t.appendEventData(this.getCommonEventData(e)),E(t,e,this.callingSupportService),!(null===(i=(n=this.config).skipTrackCallProgressCallingTelemetryService)||void 0===i?void 0:i.call(n))){let n=e.state;const i=e.on("callStateChanged",(()=>{switch(t.mark(r.Constants.scenarios.steps.calling.joinMeetup.callStateChanged,{oldState:h.CallUtilities.stringifyCallState(n),newState:h.CallUtilities.stringifyCallState(e.state)}),n=e.state,e.state){case a.OX.InLobby:t.appendEventData({[r.Constants.counters.eventNames.endpointId]:e.endpointId,[r.Constants.counters.eventNames.wasInLobby]:!0}),t.pause({reason:r.Constants.scenarios.steps.calling.inLobby});break;case a.OX.Staging:t.eventData[r.Constants.counters.eventNames.endpointId]=e.endpointId,t.stop({reason:r.Constants.scenarios.steps.calling.inStaging});break;case a.OX.Connected:t.eventData[r.Constants.counters.eventNames.endpointId]=e.endpointId,t.appendEventData({wasPreheatAttempted:e.isPreheatEnabled,wasPreheatCompleted:e.preheatCompleted}),t.resume(),t.mark(r.Constants.scenarios.steps.calling.connected),t.stop({reason:r.Constants.scenarios.steps.calling.connected});break;case a.OX.Disconnected:t.stop({reason:r.Constants.scenarios.steps.calling.disconnected,terminatedReason:e.terminatedReason})}})),o=this.eventingService.registerHandlerForExternalEvent(r.Constants.events.calling.callDisposed,(t=>{t===e&&(o(),i.dispose())}))}return this.promiseFactory.resolve(e)}markCallStateScenario(e,t,n,i){if(e){const a=C.TeamsCallService.getTeamsCallIdAsString(e.teamsCallId);let o=this.loggingService.findScenarioByNameAndId(r.Constants.scenarios.calling.callState,a);if(o||(o=this.newCallingScenario(e,r.Constants.scenarios.calling.callState,{},r.Constants.timeInMiliseconds.day,a),this.servicesProvider.coordinatedMeetingsService().isCoMeAvailable(e)&&o.appendEventData({isCoMeCall:!0})),t){const a=h.CallUtilities.stringifyCallState(t)+(n?`_${n}`:"");i?o.mark(a,this.getCommonEventData(e),i):o.mark(a,this.getCommonEventData(e))}return E(o,e,this.callingSupportService),o}return null}getSubscriptionState(){return _.getSubscriptionStateAsString(this.trouterState)}getTrouterClientState(){return this.trouterService.clientState()}getCommonEventData(e){var t,n,i,a,o,s;if(!e)return{};const l=this.getBaseEventData(e);this.callingSupportService.isAvatarEnabled()&&(l[r.Constants.counters.eventNames.isAvatarOn]=this.deviceManagerService.isAvatarOn),e.meetingData&&(l[r.Constants.counters.eventNames.meetingCode]=e.meetingData.meetingCode),e.messageId&&(l[r.Constants.counters.eventNames.messageId]=e.messageId),e.broadcastMeeting&&(l[r.Constants.categories.isBroadcast]="true",l[r.Constants.categories.broadcastRole]=e.broadcastMeeting.role),e.isScreenshareFromChat&&(l[r.Constants.categories.isScreenshareFromChat]="true"),e.isCrossCloudCall&&(l[r.Constants.counters.eventNames.isCrossCloudCall]=e.isCrossCloudCall),e.homeCloud&&(l[r.Constants.counters.eventNames.homeCloud]=e.homeCloud),e.participantId&&(l[r.Constants.counters.eventNames.participantId]=e.participantId);const c=(e.participants&&e.participants.length)>0?e.participants[0].id:null;(this.chatServiceUtils.isPstnMri(e.callerMri)||this.chatServiceUtils.isPstnMri(c))&&(l[r.Constants.counters.eventNames.endpointType]="pstn"),this.userRoles[e.teamsCallId]&&(l[r.Constants.counters.eventNames.callParticipantUserRole]=this.userRoles[e.teamsCallId]),e.isEmergencyCall&&(l[r.Constants.counters.eventNames.emergencyCall]=!0),this.isSfbCall(e)&&(l[r.Constants.counters.eventNames.endpointType]="sfbInterop"),h.CallUtilities.isSkypeConsumerCall(e)&&(l[r.Constants.counters.eventNames.endpointType]="sfcInterop"),h.CallUtilities.isImmersiveMeetingCall(e)&&(l[r.Constants.counters.eventNames.endpointType]="immersiveMeeting"),e.transferorMri&&(l[r.Constants.counters.eventNames.transferorMri]=this.chatServiceUtils.scrubMri(e.transferorMri)),e.transferorType&&(l[r.Constants.counters.eventNames.transferorType]=e.transferorType),e.onBehalfOfMri&&(l[r.Constants.counters.eventNames.onBehalfOfMri]=this.chatServiceUtils.scrubMri(e.onBehalfOfMri)),e.forwardingDestinationType&&(l[r.Constants.counters.eventNames.forwardingDestinationType]=e.forwardingDestinationType),this.setMeetingCapabilityDependentData(e,l),l[r.Constants.counters.eventNames.meetingRole]=null==e?void 0:e.meetingRole;const d=null===(n=null===(t=null==e?void 0:e.meetingDetails)||void 0===t?void 0:t.meetingCapability)||void 0===n?void 0:n.allowRegisteredUsersToBypassLobby,g=null===(a=null===(i=null==e?void 0:e.meetingDetails)||void 0===i?void 0:i.meetingCapability)||void 0===a?void 0:a.disableLobby;l[r.Constants.scenarioDataPropNames.allowRegisteredUsersToBypassLobby]=d,l[r.Constants.scenarioDataPropNames.disableLobby]=g;const u=null===(s=null===(o=null==e?void 0:e.meetingDetails)||void 0===o?void 0:o.templateDetails)||void 0===s?void 0:s.id;return l[r.Constants.counters.eventNames.templateId]=u,l}enrichEventDataWithDialInOutInfo(e,t,n){const i=n||2e3;return this.helpers.getPromiseWithTimeout(e.getMeetingInfoAsync(),i,"Not able to get meeting info from TeamsCall").then((e=>{t[r.Constants.counters.eventNames.dialIn]=!(!e||!e.pstnDetails),t[r.Constants.counters.eventNames.dialOut]=!1}))}static getCallDiagnosticsData(e,t){var n;let i=`Diagnostics information for all ${null===(n=null==e?void 0:e.participants)||void 0===n?void 0:n.length} participants in the call:\n`;return(0,o.forEach)(null==e?void 0:e.participants,(e=>{const n=(null==e?void 0:e.callEndDiagnosticsInfo)||{};i+=`scrubbedParticipantId=${t(null==e?void 0:e.id)}, callControllerCode=${n.callControllerCode}, callControllerSubCode=${n.callControllerSubCode}\n`})),i}static findCallingScenarioEndRule(e,t,n,i,a,o,r,s,l,c){let d=0,g=null;for(const c of e){const e=_.getCallingScenarioEndRuleMatchRank(c,t,n,i,a,o,r,s,l);e>0&&e>=d&&(d=e,g=c)}return c&&c.info(`CallingScenarioEnd rule match [call][scenarioName=${t}][terminatedReason=${n}][participantStateReason=${i}][ccCode=${a}][ccSubCode=${o}][slimCore=${s}][tsCalling=${l}][resultCategories=${(r||[]).join(",")}][bestRank=${d}][bestRule=${g}]`),g}static endScenario(e,t,n){switch(t){case"success":e.stop(n);break;case"incomplete":e.incomplete(n);break;case"cancel":e.cancel(n);break;case"fail":default:e.fail(n)}}reportCallDisconnected(e,t){var n;const s=h.CallUtilities.stringifyCallState(a.OX.Connecting);if(!e.stateChanges.some((e=>e.startsWith(s))))return this.promiseFactory.resolve();const l=this.loggingService.newScenario(r.Constants.scenarios.calling.callDisconnected,null,null,null,!0),c=r.Constants.counters.eventNames;let d={[c.id]:e.ids.callId,[c.callId]:e.ids.callId,[c.endpointId]:e.ids.endpointId,[c.participantId]:this.chatServiceUtils.scrubMri(e.ids.participantId),[c.correlationId]:e.ids.correlationId,[r.Constants.categories.deeplinkId]:e.ids.deeplinkId,[c.meetingCode]:e.ids.meetingCode,[r.Constants.categories.ndiEnabled]:e.ndiEnabled,[r.Constants.categories.ndiWasCaptured]:e.ndiWasCaptured,[c.homeCloud]:e.homeCloud,[c.isCrossCloudCall]:e.isCrossCloudCall,[c.wasPoppedOut]:t?t.wasPoppedOut:e.aggregate.wasChildWindowShown,[c.callDataBag]:{entryId:e.ids.id,sessionId:e.ids.sessionId,stateChanges:e.stateChanges.join(";"),stagingRoomStateChanges:null===(n=e.stagingRoomStateChanges)||void 0===n?void 0:n.join(";"),events:e.events.join(";"),hadOffline:e.aggregate.hadOfflineState,hadSuspendEvent:e.aggregate.hadSuspendEvent,hadCriticalBattery:e.aggregate.hadCriticalBattery,hadScreenSharing:e.aggregate.hadScreenSharing,hadDialInShown:e.aggregate.hadDialInShown,hadDialOutShown:e.aggregate.hadDialOutShown,hadNetworkReconnect:e.aggregate.hadNetworkReconnect,didAppQuit:e.aggregate.didAppQuit,deviceCacheUsed:this.deviceManagerService.getDeviceCacheUsed(),meetingTransferred:t&&t.isMeetingTransferred(),wasChildWindowShown:e.aggregate.wasChildWindowShown,stageSize:this.maxVideosToRender,nsMode:this.deviceManagerService.getNoiseSuppressionMode()}},g=this.promiseFactory.resolve({});e.participantUserRole&&(d[c.callParticipantUserRole]=e.participantUserRole);const u=!!e.isBroadcast;d[c.isBroadcast]=u,u&&(d[c.broadcastRole]=e.broadcastRole),e.callType&&(d[c.callType]=e.callType),e.signalingScenarioName&&(d[c.signalingScenarioName]=e.signalingScenarioName),e.signalingScenarioStatus&&(d[c.signalingScenarioStatus]=e.signalingScenarioStatus),e.ids.callIdOverride&&(d[c.callIdOverride]=e.ids.callIdOverride),e.termination&&e.termination.leaveCallContext&&(d[c.leaveCallContext]=e.termination.leaveCallContext),e.termination&&e.termination.leaveCallReasonCMD&&(d[c.leaveCallReasonCMD]=e.termination.leaveCallReasonCMD);const p=t?this.getCommonEventData(t):void 0;if(t&&this.helpers.getLatencyTracer()&&(0,o.isFunction)(this.helpers.getLatencyTracer().getData)&&(0,o.isFunction)(this.helpers.getLatencyTracer().reset)){const e=Object.assign(Object.assign({},p),d);e[c.callIPCStats]=JSON.stringify(this.helpers.getLatencyTracer().getData()),this.helpers.getLatencyTracer().reset();const t=this.loggingService.newScenario(r.Constants.scenarios.calling.callIPCStats,null,null,null,!0);t.appendEventData(e),t.stop()}let C=!1;if(t&&!this.isPluginHostCrash(e))d=Object.assign(Object.assign({},p),d);else if((!e.termination||this.isPluginHostCrash(e))&&(d[c.callDataBag].callInterrupted=!0,e.stateChanges&&e.stateChanges[0])){const n=parseInt(e.stateChanges[0].split(":")[1]);n?(g=this.getCrashInfo(n),C=this.getObsoleteCallCrashInfo(e,n,d,t)):this.loggingService.error(`Invalid timestamp in calling telemetry entry ${e.stateChanges[0]}`)}return this.promiseFactory.finalized(g.then((n=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,a;n&&"osReportedCrash"in n&&!n.reportId&&!n.exceptionCode&&delete n.osReportedCrash,d[c.callDataBag]=Object.assign(Object.assign({},n),d[c.callDataBag]);const o=e.termination&&e.termination.reason||t&&t.terminatedReason;d[r.Constants.counters.eventNames.terminatedReason]=_.convertTerminatedReasonToString(o),d[r.Constants.counters.eventNames.abortReason]=t?t.abortReason:e.termination&&e.termination.abortReason;const s=t&&t.callEndDiagnosticsInfo||(null===(i=e.termination)||void 0===i?void 0:i.callEndDiagnosticsInfo)||(null===(a=e.termination)||void 0===a?void 0:a.transferDiagnosticsInfo)||{},{callControllerCode:g,callControllerSubCode:u,additionalTransactionEnd:p}=s;if(d[r.Constants.counters.eventNames.callControllerCode]=g,d[r.Constants.counters.eventNames.callControllerSubCode]=u,d[r.Constants.counters.eventNames.additionalTransactionEnd]=JSON.stringify(p),l.appendEventData(d),this.loggingService.error(`${r.Constants.scenarios.calling.callDisconnected}(${e.ids.callId}): participantId=${this.chatServiceUtils.scrubMri(e.ids.participantId)}, endpointId=${e.ids.endpointId}, sessionId=${e.ids.sessionId}`),e.termination&&this.loggingService.error(`${r.Constants.scenarios.calling.callDisconnected}(${e.ids.callId}): leaveCallContext=${e.termination.leaveCallContext}, leaveCallReasonCMD=${e.termination.leaveCallReasonCMD}`),this.loggingService.error(`${r.Constants.scenarios.calling.callDisconnected}(${e.ids.callId}): offlineState=${e.aggregate.hadOfflineState}, suspendEvent=${e.aggregate.hadSuspendEvent}, criticalBattery=${e.aggregate.hadCriticalBattery}, screenSharing=${e.aggregate.hadScreenSharing}`),n.reportId&&this.loggingService.error(`${r.Constants.scenarios.calling.callDisconnected}(${e.ids.callId}): crashReportId=${n.reportId}`),n.exceptionCode&&this.loggingService.error(`${r.Constants.scenarios.calling.callDisconnected}(${e.ids.callId}): crashExceptionCode=${n.exceptionCode}`),n.osReportedCrash&&this.enableCallingDisconnectedAutoBrb&&!this.callingCallDisconnectedCrashReported&&this.reportCrash(n)){this.callingCallDisconnectedCrashReported=!0;const t=n.processType||"unknown",i=n.crashType||"unknown",a=n.crashCause||"unknown",o=n.exceptionCode||"unknown",s=n.reportId||"unknown";this.servicesProvider.brbV2FeedbackService().sendFeedbackToBrbV2(!0,{category:r.Constants.feedback.categories.other,title:`[AutoBrb] - Detected app crash during a call (${t}, ${i}, ${a}, ${o})`,description:`[AutoBrb] - Application crash detected during a call, reporting auto brb.\nCallId: ${e.ids.callId}\nProcessType: ${t}\nCrashType: ${i}\nCrashCause: ${a}\nExceptionCode: ${o}\nReportId: ${s}\n`,allowScreenshots:!1,includeBackgroundBlurImages:!1,includeHeapSnapshot:!1})}t&&delete this.userRoles[t.teamsCallId];try{yield null==t?void 0:t.callDisposedDefer.promise}catch(e){const t=this.utilityService.asString(e);return l.fail({reasonCMD:t}),void this.logger.error(`Call disposed failed: ${t}`)}this.setCallDisconnectedStatus(e,C,l,t)})))).catch((e=>{this.logger.error(`Unexpected error while reporting call disconnect: ${e}`),null==l||l.appendEventData(Object.assign(Object.assign({},d),{reasonCMD:this.utilityService.asString(e)})),null==l||l.fail()})),(()=>{this.loggingService.setContext(r.Constants.categories.callWasPoppedOut,"")}))}finishCallScenarios(e,t,n,i){const a=e.abortReason,o=e.terminatedReason,s=t.length>0?t[0].name:null,l=this.getDiagnosticsInfo(e,s,i),c=l&&l.callControllerCode,d=l&&l.callControllerSubCode,g=l&&l.phrase,u=(null==l?void 0:l.resultCategories)||[];n=n||this.findCallEndAction(s,_.getCallTerminationInfo(e,this.appStateService),e);const p=t.map((e=>e.name)).join(", ");this.logger.info(["Finish start call scenarios [call]",`[callId=${e.callId}]`,`[action=${n}]`,`[abortReason=${a}]`,`[terminatedReason=${o}]`,`[callControllerCode=${c}]`,`[callControllerSubCode=${d}]`,`[reason=${i}]`,`[primaryScenario=${s}]`,`[scenarios=${p}]`,`[resultCategories=${u.join(",")}]`,`[message=${g}]`].join("")),t.forEach((e=>{this.addCallErrorCodesToEventData(e.eventData,a,o,c,d,i,u,g)})),p.includes(r.Constants.scenarios.calling.emergencyCall)&&r.Constants.emergencyCallFailureErrorcodes.includes(d)&&this.eventingService.emit(r.Constants.events.calling.emergencyCallFailed),this.endCallScenarios(t,p,n,i,e)}findCallEndAction(e,t,n,i=!0){if(t.isExperienceContainerError)return"fail";if(this.shouldCancelScenarios(t))return i||t.reason!==a.yb.Success?"cancel":"success";let o,r;if(this.shouldIncompleteScenarios(t)&&(o="incomplete"),!o){const{callControllerCode:n,callControllerSubCode:i}=t.callEndDiagnosticsInfo||t.transferDiagnosticsInfo||{},a=this.callingAgentsService.getVersions(),s=_.findCallingScenarioEndRule(this.callEndRules,e,t.reason,void 0,n,i,t.resultCategories,null==a?void 0:a.slimCore,null==a?void 0:a.tsCalling,this.logger);s&&(o=s.action,r=!0)}if(this.config.enableResultCategoryUsage()){const t=this.getActionBasedOnResultCategory(n,e);o?this.sendMismatchTelemetry(o,t,n,e,r):o=t}return null!=o?o:"fail"}setCallIdOverride(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.getStartCallScenario().then((n=>{n.appendEventData({[r.Constants.counters.eventNames.callId]:t}),n.mark(r.Constants.scenarios.steps.calling.callIdChanged,this.getCommonEventData(e))})).catch((e=>{this.logger.warn(this.utilityService.getErrorLoggingString(e))})),yield this.setLoggingContext(e)}))}updateParticipantId(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.getStartCallScenario().then((e=>{e.eventData[r.Constants.counters.eventNames.participantId]=t})).catch((e=>{this.logger.warn(this.utilityService.getErrorLoggingString(e))})),yield this.setLoggingContext(e)}))}setCallMode(e){e.callType==a.rf.Conference&&this.loggingService.setContext(r.Constants.categories.callMode,e.callMode)}setMaxVideosToRender(e){this.maxVideosToRender=Math.max(e,this.maxVideosToRender)}setLoggingContext(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let[t,n,i]=["","",""];e&&(t=e.callId,n=e.participantId,i=`${e.wasPoppedOut}`),yield this.updateLoggingContextCallType(e),this.loggingService.setContext(r.Constants.categories.callId,t),this.loggingService.setContext(r.Constants.categories.participantId,n),this.loggingService.setContext(r.Constants.categories.callWasPoppedOut,i),this.setBroadcastLoggingContext(e),this.callInLoggingContext=e}))}setBroadcastLoggingContext(e){var t;let[n,i,a,o,s]=["","","","",""];if(e&&e.broadcastMeeting){const l=e.broadcastMeeting.broadcastState;[n,i,a,o,s]=["true",e.broadcastMeeting.role,m.BroadcastUtilities.stringifyBroadcastState(e.broadcastMeeting.modalityState),this.utilityService.asString(null===(t=null==l?void 0:l.sources)||void 0===t?void 0:t.length),e.threadId],s&&this.loggingService.setContext(r.Constants.categories.threadId,s),this.loggingService.setContext(r.Constants.categories.broadcastRole,i),this.loggingService.setContext(r.Constants.categories.broadcastModalityState,a),this.loggingService.setContext(r.Constants.categories.broadcastMediaCount,o)}this.loggingService.setContext(r.Constants.categories.isBroadcast,n)}submitIssueWithLogs(e,t){if(!this.isAttachCallingLogsEnabled)return this.promiseFactory.reject("Feature flag not enabled");if(this.isSendingLogs)return this.promiseFactory.reject("Currently sending logs");this.isSendingLogs=!0;const n=`${t} call failure (callId: ${e.callId}, teamsCallId: ${e.teamsCallId})`;let i;try{i=JSON.stringify({failureType:e.failureType,abortReason:e.abortReason,mediaConnected:e.mediaConnected,mediaWhitelistingIssueRaised:e.mediaWhitelistingIssueRaised,terminatedReason:e.terminatedReason})}catch(e){i=n}const a=String(r.Constants.feedback.categories.other);return this.promiseFactory.finalized(this.servicesProvider.brbV2FeedbackService().sendFeedbackToBrbV2(!0,{category:a,title:n,description:i,allowScreenshots:!1}).catch((e=>{this.loggingService.error(e)})),(()=>{this.isSendingLogs=!1}))}static convertTerminatedReasonToString(e){switch(e){case a.yb.Undefined:return"Undefined";case a.yb.Success:return"Success";case a.yb.NoNgcEndpoint:return"NoNgcEndpoint";case a.yb.NetworkError:return"NetworkError";case a.yb.MediaDroppedError:return"MediaDroppedError";case a.yb.BadRequest:return"BadRequest";case a.yb.CallEstablishmentTimeout:return"CallEstablishmentTimeout";case a.yb.CallSetupError:return"CallSetupError";case a.yb.NoPermission:return"NoPermission";case a.yb.Missed:return"Missed";case a.yb.Declined:return"Declined";case a.yb.Busy:return"Busy";case a.yb.Cancelled:return"Cancelled";case a.yb.Dropped:return"Dropped";case a.yb.PstnInsufficientFunds:return"PstnInsufficientFunds";case a.yb.PstnSkypeoutAccountBlocked:return"PstnSkypeoutAccountBlocked";case a.yb.PstnCouldNotConnectToSkypeProxy:return"PstnCouldNotConnectToSkypeProxy";case a.yb.PstnBlockedByUs:return"PstnBlockedByUs";case a.yb.PstnBlockedRegulatoryIndia:return"PstnBlockedRegulatoryIndia";case a.yb.PstnInvalidNumber:return"PstnInvalidNumber";case a.yb.PstnNumberForbidden:return"PstnNumberForbidden";case a.yb.PstnCallTerminated:return"PstnCallTerminated";case a.yb.PstnNumberUnavailable:return"PstnNumberUnavailable";case a.yb.PstnEmergencyCallDenied:return"PstnEmergencyCallDenied";case a.yb.CallNotFound:return"CallNotFound";case a.yb.LocalError:return"LocalError";case a.yb.NotAcceptableHere:return"NotAcceptableHere";case a.yb.CallForwarded:return"CallForwarded";case a.yb.CallForwardedToVoicemail:return"CallForwardedToVoicemail";case a.yb.SkypeTokenError:return"SkypeTokenError";case a.yb.CallAccepted:return"CallAccepted";case a.yb.LocalHttpStackError:return"LocalHttpStackError";case a.yb.UnknownError:return"UnknownError";case a.yb.PstnNoSubscriptionCover:return"PstnNoSubscriptionCover";case a.yb.SessionNotFound:return"SessionNotFound";case a.yb.SessionTimedOut:return"SessionTimedOut";case a.yb.PstnCreditExpired:return"PstnCreditExpired";case a.yb.PstnCreditExpiredButEnough:return"PstnCreditExpiredButEnough";case a.yb.RetargetNotSupported:return"RetargetNotSupported";case a.yb.EnterprisePstnInternalError:return"EnterprisePstnInternalError";case a.yb.EnterprisePstnUnavailable:return"EnterprisePstnUnavailable";case a.yb.EnterprisePstnForbidden:return"EnterprisePstnForbidden";case a.yb.EnterprisePstnInvalidNumber:return"EnterprisePstnInvalidNumber";case a.yb.EnterprisePstnMiscError:return"EnterprisePstnMiscError";case a.yb.Kicked:return"Kicked";case a.yb.NetworkRequestTimeoutError:return"NetworkRequestTimeoutError";case a.yb.CallDoesNotExist:return"CallDoesNotExist";case a.yb.MediaSetupFailure:return"MediaSetupFailure";case a.yb.ServiceUnavailable:return"ServiceUnavailable";case a.yb.SignalingError:return"SignalingError";case a.yb.ConversationEstablishmentFailed:return"ConversationEstablishmentFailed";case a.yb.TemporarilyUnavailable:return"TemporarilyUnavailable";case a.yb.CannotConnectToNetworkError:return"CannotConnectToNetworkError";case a.yb.MediaRelayWhiteListingIssue:return"MediaRelayWhiteListingIssue";case a.yb.NoSignalingFromPeer:return"NoSignalingFromPeer";case a.yb.DeniedInLobby:return"DeniedInLobby";case a.yb.TimedOutInLobby:return"TimedOutInLobby";case a.yb.CallFailedConflict:return"CallFailedConflict";case a.yb.DevicePermissionDenied:return"DevicePermissionDenied";case a.yb.ConfParticipantCountLimitReached:return"ConfParticipantCountLimitReached";case a.yb.ActionNotAllowed:return"ActionNotAllowed";case a.yb.Abandoned:return"Abandoned";case a.yb.ForbiddenDueToPolicy:return"ForbiddenDueToPolicy";case a.yb.InsufficientCapabilitiesForCallee:return"InsufficientCapabilitiesForCallee";case a.yb.UserBlocked:return"UserBlocked";case a.yb.AccessDenied:return"AccessDenied";case a.yb.AnonymousJoinDisabledByPolicy:return"AnonymousJoinDisabledByPolicy";case a.yb.NoLobbyForBroadcastJoin:return"NoLobbyForBroadcastJoin";case a.yb.NotAllowedDueToInformationBarrier:return"NotAllowedDueToInformationBarrier";case a.yb.BroadcastLimitReached:return"BroadcastLimitReached";case a.yb.TeamParkPolicyDisabled:return"TeamParkPolicyDisabled";case a.yb.B2bJoinDisabledByPolicy:return"B2bJoinDisabledByPolicy";case a.yb.LocationBasedRoutingError:return"LocationBasedRoutingError";case a.yb.ConfLobbyParticipantCountLimitReached:return"ConfLobbyParticipantCountLimitReached";default:return`Unknown: ${e}`}}markMultiWindowCallingTelemetry(e){return(e=e||{}).fromMultiWindow="true",e}static getCallTerminationInfo(e,t){return{leaveCallContext:e.leaveCallContext,leaveCallReasonCMD:e.leaveCallReasonCMD,reason:e.terminatedReason,abortReason:e.abortReason,resultCategories:e.getDiagnosticsResultCategories(),isExperienceContainerError:e.isExperienceContainerError,callEndDiagnosticsInfo:e.callEndDiagnosticsInfo,transferDiagnosticsInfo:e.transferDiagnosticsInfo,hasNoActiveNetworkInterface:e.hasNoActiveNetworkInterface(),isNotAllowedToJoinBreakoutRoom:e.isNotAllowedToJoinBreakoutRoom(),isMeetingJoinBlockedByPolicy:e.isMeetingJoinBlockedByPolicy(),isMeetingInvalidOrExpired:e.isMeetingInvalidOrExpired(),isInvalidMeetingCode:e.isInvalidMeetingCode(),isMeetingLifetimeExceededFailure:e.isMeetingLifetimeExceededFailure(),isMeetingXlBlockedByBreakoutRooms:e.isMeetingXlBlockedByBreakoutRooms(),hasFailedDueToInvalidSkypeToken:e.hasFailedDueToInvalidSkypeToken(),isSkypeAuthUp:t.isSkypeAuthUp}}newCallingWindowingNavigationScenario(e,t,n,i,a,o){const s=r.Constants.scenarios.calling.callingWindowingNavigation.scenarioName,l=this.loggingService.newScenario(s,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,i,void 0),c={calling_intent_id:e,calling_intent_type:n,context:a,window_type:o,windowing_action_id:i,windowing_mode:t};return l.appendEventData(c),l}startGlobalScenario(e,t){return this.globalTelemetry.startGlobalScenario(e,t)}registerGlobalContributor(e){return this.globalTelemetry.registerGlobalContributor(e)}getBaseEventData(e){var t,n,i;const a=this.deviceManagerService.getSelectedDevices();return{[r.Constants.counters.eventNames.id]:e.callId,[r.Constants.counters.eventNames.callId]:e.callId,[r.Constants.counters.eventNames.callMode]:null==e?void 0:e.callMode,[r.Constants.counters.eventNames.teamsCallId]:e.teamsCallId,[r.Constants.counters.eventNames.endpointId]:e.endpointId,[r.Constants.counters.eventNames.wasPoppedOut]:e.wasPoppedOut,[r.Constants.counters.eventNames.isVideoOn]:e.isVideoOn,[r.Constants.categories.threadId]:this.chatServiceUtils.isPstnMri(e.callerMri)?r.Constants.pstn.userType:e.conversationId,[r.Constants.counters.eventNames.stagingRoomEnabled]:null===(t=e.stagingRoomProperties)||void 0===t?void 0:t.stagingRoomEnabled,[r.Constants.counters.eventNames.stagingRoomEventActive]:null===(n=e.stagingRoomProperties)||void 0===n?void 0:n.eventActive,[r.Constants.categories.trouterState]:this.getSubscriptionState(),[r.Constants.categories.trouterClientState]:this.getTrouterClientState(),[r.Constants.categories.trouterUrls]:this.trouterService.trouterUrl(),[r.Constants.counters.eventNames.isManagedModeEnabled]:this.callingSupportService.isHostViewModeActive(null===(i=null==e?void 0:e.meetingDetails)||void 0===i?void 0:i.meetingCapability),[r.Constants.counters.eventNames.selectedCameraId]:a.camera,[r.Constants.counters.eventNames.selectedMicrophoneId]:a.microphone,[r.Constants.counters.eventNames.selectedSpeakerId]:a.speaker}}getDiagnosticsInfo(e,t,n){var i;if(!e)return null;const{callEndDiagnosticsInfo:o,transferDiagnosticsInfo:s,teamsCallType:l,participants:c}=e;if(o)return o;if(t&&t===r.Constants.scenarios.calling.transferCall&&s)return s;if(c){const e=c.length>0&&(null===(i=c[0])||void 0===i?void 0:i.callEndDiagnosticsInfo);if(l===a.rf.P2P&&e)return c[0].callEndDiagnosticsInfo}if(n){const{code:e,subCode:t,phrase:i}=h.CallUtilities.safeJsonParse(n);if(e||t||i)return{callControllerCode:e,callControllerSubCode:t,phrase:i}}return null}isCallAttemptFailureType(e){return void 0!==(null==e?void 0:e.reason)}isMatchingJoinAttempt(e,t,n){return!!e.correlationIds.some((e=>e===n))||S.CallingIntentUtilities.areCoordinatesEquivalent(e.coordinates,t,this.servicesProvider.callingService())}updateOngoingJoinAttempts(e,t){this.ongoingJoinAttempts=this.ongoingJoinAttempts.filter((n=>!this.isMatchingJoinAttempt(n,e,t.correlationId))),this.maxVideosToRender=0}addCallErrorCodesToEventData(e,t,n,i,a,s,l,c){const d=r.Constants.counters.eventNames;e[d.abortReason]=t,n&&(e[d.terminatedReason]=n),(0,o.isNil)(i)||(e[d.callControllerCode]=i),(0,o.isNil)(a)||(e[d.callControllerSubCode]=a),s&&(e[d.reason]=s),l&&l.length&&(e[d.resultcategory]=l.join(",")),e[d.message]=c}endCallScenarios(e,t,n,i,o){switch(e.forEach((e=>{e.appendEventData({isSkypeAuthUp:this.appStateService.isSkypeAuthUp})})),n){case"cancel":e.forEach((e=>e.cancel()));break;case"incomplete":e.forEach((e=>e.incomplete()));break;case"success":e.forEach((e=>e.stop()));break;default:const n=_.getCallDiagnosticsData(o,(e=>this.chatServiceUtils.scrubMri(e)));this.logger.error(`Failing scenarios [${t}] because call\n              was terminated with terminatedReason: ${null==o?void 0:o.terminatedReason}\n              with following diagnostics data: ${n}\n              [call][callId=${null==o?void 0:o.callId}][reason=${i}][callType=${null==o?void 0:o.teamsCallType}][scenarioName=${t}]`),e.forEach((e=>{(null==o?void 0:o.teamsCallType)!==a.rf.P2P&&(e.eventData[r.Constants.counters.eventNames.diagnosticsData]=n),e.fail()}))}}sendMismatchTelemetry(e,t,n,i,a){if(t===e)return;const o=this.logger.service.newScenario(r.Constants.scenarios.calling.inconsistentResultCategory),s=r.Constants.counters.eventNames,l=this.getDiagnosticsInfo(n,i),c=null==l?void 0:l.callControllerCode,d=null==l?void 0:l.callControllerSubCode,g=null==l?void 0:l.resultCategories,u=null==l?void 0:l.additionalTransactionEnd,p=null==n?void 0:n.terminatedReason;this.logger.info(`sendMismatchTelemetry: [mismatchedScenario=${i}][terminatedReason=${p}][ccCode=${c}][ccSubCode=${d}][resultCategories=${(g||[]).join(",")}][Action=${e}][ActionBasedonResultCategory=${t}][isActionFromConfig=${a}]`);const C={[s.callId]:null==n?void 0:n.callId,[s.callMode]:null==n?void 0:n.callMode,[s.callControllerCode]:c,[s.callControllerSubCode]:d,[s.message]:`Action: ${e}, result category action: ${t} for scenario: ${i}`,[s.resultcategory]:null==g?void 0:g.join(","),[s.terminatedReason]:p,[s.additionalTransactionEnd]:JSON.stringify(u),action:e,actionFromResultCategory:t,mismatchedScenario:i,isActionFromConfig:a};o.appendEventData(C),o.fail()}getActionBasedOnResultCategory(e,t){var n;const i=this.getDiagnosticsInfo(e,t),a=null===(n=null==i?void 0:i.resultCategories)||void 0===n?void 0:n.map((e=>e.toLowerCase()));if(a){if(a.includes(N.Success.toLowerCase()))return"success";if(a.includes(N.ExpectedError.toLowerCase())||a.includes(N.ExpectedNoNetworkError.toLowerCase()))return"incomplete"}}callDisconnectedStatusFor(e,t,n){if(t)return"cancel";if(n&&!n.wasInState(a.OX.Connected))return"incomplete";const i=!!e.signalingScenarioStatus,o=e.signalingScenarioStatus===r.Constants.scenarioStepStatus.success;return i&&!o?"incomplete":e.termination?this.findCallEndAction(r.Constants.scenarios.calling.callDisconnected,e.termination,n,!1):"fail"}getOngoingJoinAttempt(e,t){return this.ongoingJoinAttempts.find((n=>this.isMatchingJoinAttempt(n,e,t)))}static getCallingScenarioEndRuleMatchRank(e,t,n,i,a,r,s,l,c){let d=1;if(e.scenarios){if(e.scenarios.indexOf(t)<0)return 0;d|=2}if(e.terminatedReasons){if(e.terminatedReasons.indexOf(n)<0)return 0;d|=4}if(e.participantStateReasons){if(e.participantStateReasons.indexOf(i)<0)return 0;d|=8}if(e.ccCodes){if(e.ccCodes.indexOf(a)<0)return 0;d|=16}if(e.ccSubCodes){let t=!1;for(const n of e.ccSubCodes)if(Array.isArray(n)){if(2===n.length&&!(0,o.isNil)(r)&&r>=n[0]&&r<=n[1]){t=!0;break}}else if(n===r){t=!0;break}if(!t)return 0;d|=32}if(e.slimCoreVersionPrefix){if(!l||!l.startsWith(e.slimCoreVersionPrefix))return 0;d|=64}if(e.tsCallingVersionPrefix){if(!c||!c.startsWith(e.tsCallingVersionPrefix))return 0;d|=128}return d}isPluginHostCrash(e){var t;return(null===(t=null==e?void 0:e.termination)||void 0===t?void 0:t.leaveCallContext)===r.Constants.scenarios.calling.context.pluginHostCrash}startAndIncompleteScenario(e){this.newMeetingScenario(null,e.scenarioName,e.meetingEventData).incomplete({reason:r.Constants.scenarios.steps.calling.joinMeetup.preJoinDoubleNavigation})}getCrashInfo(e){if(!this.isDesktopApp)return this.promiseFactory.resolve({});const t=this.promiseFactory.createDeferred(),n=this.helpers.ipcUtility.get();let i=this.timeout.set((()=>{t.resolve({getCrashInfoStatus:"Timeout"}),i=null,n.removeAllListeners(r.Constants.events.desktopApp.getCrashInfo)}),r.Constants.scenarios.calling.crashInfoTimeout,!1);return this.helpers.ipcUtility.once(n,r.Constants.events.desktopApp.getCrashInfo,((e,n)=>{i&&(this.timeout.cancel(i),t.resolve(n))}).bind(this)),n.send(r.Constants.events.desktopApp.getCrashInfo,e),t.promise}reportCrash(e){const t=this.config.callingDisconnectedAutoBrbInclude();return t&&t instanceof Array?t.some((t=>t instanceof Object&&!(t instanceof Array)&&Object.keys(t).every((n=>{const i=e[n]||"unknown";return!t[n]||"*"===t[n]||t[n]===i})))):(this.loggingService.warn("reportCrash: crash filter missing or not an array and not an object"),!0)}getEventData(e){const{callId:t,messageId:n,threadId:a,context:o,meetingType:s,joinOrCreate:l}=e,c=(0,i.__rest)(e,["callId","messageId","threadId","context","meetingType","joinOrCreate"]),d=Object.assign(Object.assign({},c),{[r.Constants.categories.meetingType]:g._n[s],[r.Constants.categories.joinType]:l});return t&&(d[r.Constants.counters.eventNames.id]=t,d[r.Constants.counters.eventNames.callId]=t),n&&(d[r.Constants.counters.eventNames.messageId]=n),a&&(d[r.Constants.categories.threadId]=this.chatServiceUtils.isPstnMri(a)?r.Constants.pstn.userType:a),o&&(d[r.Constants.categories.context]=o),e&&e.isBroadcast&&(d[r.Constants.categories.isBroadcast]="true"),d}getCallTypeAsync(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield S.CallingIntentUtilities.coordinatesTypeFromCallAsync(this.conversationsAsyncService,e);switch(t){case u.G.Meeting:case u.G.OngoingCall:return yield this.callingSupportService.getOngoingCallMeetingType(e);case u.G.OneToOneCall:return h.CallUtilities.isOneToOnePstnCall(e)||e.isEmergencyCall?"oneToOnePstnCall":"oneToOneCall";case u.G.GroupCall:return"groupCall";default:const n=t;this.logger.error(`Unhandled type: ${n}`)}}))}get trouterState(){return this.callingAgentsService.getCallSupportDetector().isSlimCoreEnabled()?P.Unknown:this.trouterService.state()}isWindowsN(){try{return this.helpers.isWindowsN()}catch(e){return!1}}isSfbCall(e){if(e.teamsCallType!==a.rf.P2P||1!==e.participants.length||!e.participants[0].endpoints)return!1;return-1!==(0,o.findIndex)(e.participants[0].endpoints.endpointDetails,(e=>e.endpointType===r.Constants.endpointType.lync))}processStartCallTelemetry(e,t){const n=t.correlationId,i=this.getOngoingJoinAttempt(e,n);if(i){i.wasAttemptedMultipleTimes=!0;i.correlationIds.some((e=>e===n))||(this.startAndIncompleteScenario(t),i.correlationIds.push(n));const e=i.scenario;return i.mainAttemptCorrelationId===n&&e.appendEventData(t.meetingEventData),e}}propagateCallType(e,t){e.getStartCallScenario().then((e=>{e.eventData[r.Constants.counters.eventNames.callType]=t})).catch((e=>{this.logger.warn(this.utilityService.getErrorLoggingString(e))})),this.eventingService.emit(r.Constants.events.calling.callTypeChanged,{teamsCallId:e.teamsCallId,callType:t})}shouldCancelScenarios(e){return(0,o.includes)(d.TerminatedReasonsToCancelScenario,e.reason)}shouldIncompleteScenarios(e){return(0,o.includes)(d.TerminatedReasonsToIncompleteScenario,e.reason)||!!e.abortReason||e.hasFailedDueToInvalidSkypeToken&&!e.isSkypeAuthUp||e.isMeetingInvalidOrExpired||e.isInvalidMeetingCode||e.isMeetingLifetimeExceededFailure||e.isMeetingJoinBlockedByPolicy||e.isNotAllowedToJoinBreakoutRoom||e.isMeetingXlBlockedByBreakoutRooms||e.hasNoActiveNetworkInterface}updateLoggingContextCallType(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e)return this.loggingService.setContext(r.Constants.categories.callType,""),void this.loggingService.setContext(r.Constants.categories.callIsChatVersion2,"");if(this.callInLoggingContext===e)return;this.loggingService.setContext(r.Constants.categories.callType,yield this.getCallTypeAsync(e)),this.loggingService.setContext(r.Constants.categories.callIsChatVersion2,"");const t=yield e.getCallingConversationAsync();t.alive(),this.promiseFactory.finalized(t.whenInitialized(e).then((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(this.callInLoggingContext!==e)return;const n=yield this.callingSupportService.getOngoingCallMeetingType(e);this.propagateCallType(e,n),this.loggingService.setContext(r.Constants.categories.callType,n),this.loggingService.setContext(r.Constants.categories.callIsChatVersion2,t.isChatV2())})))),(()=>{t.dispose()}))}))}sendAutoBrbOnSceanrioStop(e){const t=e.name,n=this.sendAutoBRBForTimeoutCallingScenarios.includes(t),i=this.sendAutoBRBForFailedCallingScenarios.includes(t);(n||i)&&e.whenStopped.then((e=>{if(!(n&&"timeout"===e||i&&"failure"===e))return;const a=r.Constants.feedback.categories.meetingsSchedule,o=`[AutoBrb]: ${t} ${e}`,s=n?"[AutoBrb] - Scenario stopped with timeout, reporting auto brb":"[AutoBrb] - Scenario stopped due to failure, reporting auto brb";this.servicesProvider.brbV2FeedbackService().sendFeedbackToBrbV2(!0,{category:a,title:o,description:s,allowScreenshots:!1,includeBackgroundBlurImages:!1,includeHeapSnapshot:!1})}))}getObsoleteCallCrashInfo(e,t,n,i){if(!i&&!e.termination){if(Date.now()-t>r.Constants.telemetry.calling.obsoleteCallCrashSessionGapMs)return n[r.Constants.counters.eventNames.callDataBag]=Object.assign(Object.assign({},n[r.Constants.counters.eventNames.callDataBag]),{isObsoleteCallCrash:!0}),!0}return!1}setCallDisconnectedStatus(e,t,n,i){switch(this.callDisconnectedStatusFor(e,t,i)){case"success":n.stop();break;case"cancel":n.cancel();break;case"incomplete":n.incomplete();break;default:n.fail()}}static isTeamsCall(e){return e&&void 0!==e.teamsCallId}setMeetingCapabilityDependentData(e,t){var n,i,a,o,s,l;const c=null===(i=null===(n=null==e?void 0:e.meetingDetails)||void 0===n?void 0:n.meetingCapability)||void 0===i?void 0:i.forceAttendeeStreaming,d=null===(o=null===(a=null==e?void 0:e.meetingDetails)||void 0===a?void 0:a.meetingCapability)||void 0===o?void 0:o.streamingModeActive;t[r.Constants.scenarioDataPropNames.streamingData]={forceAttendeeStreaming:c,streamingModeActive:d},c?t[r.Constants.counters.eventNames.streamingType]=r.Constants.scenarios.calling.streamingType.townhall:d&&(t[r.Constants.counters.eventNames.streamingType]=r.Constants.scenarios.calling.streamingType.overflowV2),(null===(l=null===(s=null==e?void 0:e.meetingDetails)||void 0===s?void 0:s.meetingCapability)||void 0===l?void 0:l.maskIdentitiesForRole)&&(t[r.Constants.counters.eventNames.maskedMeeting]=!0)}}_.DEFAULT_PROPS_GET_ERROR_MSG=["stack","message","name"];class w{constructor(){this.eventData={},this.whenStopped=new Promise((e=>{this._resolveWhenStopped=e}))}appendEventData(e){}pause(e){}resume(e){}cancel(e,t){this._resolveWhenStopped("cancelled")}cancelAfterDigest(e){this._resolveWhenStopped("cancelled")}stop(e,t,n){this._resolveWhenStopped("stopped")}incomplete(e,t){this._resolveWhenStopped("incomplete")}incompleteAfterDigest(e){this._resolveWhenStopped("incomplete")}addCounter(e){}timeoutInMs(e){}markAggregateStart(e){}markAggregateStop(e){}mark(e,t,n){}stopAfterDigest(e){this._resolveWhenStopped("stopped")}fail(e,t){this._resolveWhenStopped("failed")}failAfterDigest(e){this._resolveWhenStopped("failed")}}},524060:(e,t,n)=>{n.d(t,{LW:()=>i,rs:()=>a,HZ:()=>o,Y6:()=>s});var i,a,o,r=n(360452);!function(e){e[e.StartCall=1]="StartCall",e[e.StartScreenshareCall=2]="StartScreenshareCall",e[e.JoinCall=3]="JoinCall",e[e.JoinScreenshareCall=4]="JoinScreenshareCall",e[e.AcceptCall=5]="AcceptCall",e[e.AcceptScreenshareCall=6]="AcceptScreenshareCall",e[e.StartPstnCall=7]="StartPstnCall",e[e.UnifiedStart=8]="UnifiedStart"}(i||(i={})),function(e){e[e.JoinScheduledMeeting=1]="JoinScheduledMeeting"}(a||(a={})),function(e){e[e.MultiWindow=0]="MultiWindow"}(o||(o={}));const s=[r.OX.Connecting,r.OX.InLobby]},809076:(e,t,n)=>{var i,a;n.d(t,{l:()=>i,i:()=>a}),function(e){e[e.Unestablished=0]="Unestablished",e[e.Viewing=1]="Viewing",e[e.BrowsingPrivately=2]="BrowsingPrivately",e[e.Presenting=3]="Presenting"}(i||(i={})),function(e){e[e.CallCreateContentSharingSessionFailed=1]="CallCreateContentSharingSessionFailed",e[e.SessionStartContentSharingFailed=2]="SessionStartContentSharingFailed",e[e.PresenterFailedToParseSharingContent=10]="PresenterFailedToParseSharingContent",e[e.SessionJoinContentSharingFailed=20]="SessionJoinContentSharingFailed",e[e.ViewerFailedToParseSharingContent=21]="ViewerFailedToParseSharingContent",e[e.SessionUpdateContentSharingParticipantStateToViewerFailed=22]="SessionUpdateContentSharingParticipantStateToViewerFailed",e[e.DtoCreationFailed=23]="DtoCreationFailed",e[e.ViewerSessionCreationFailed=24]="ViewerSessionCreationFailed",e[e.MidSessionContentSharingFailed=25]="MidSessionContentSharingFailed",e[e.RendererInitFailed=30]="RendererInitFailed",e[e.NoProviderFound=100]="NoProviderFound",e[e.Cancelled=101]="Cancelled",e[e.RecordingConsentRequiredButNotProvided=102]="RecordingConsentRequiredButNotProvided",e[e.ProviderSpecificBase=1e3]="ProviderSpecificBase"}(a||(a={}))},405854:(e,t,n)=>{var i,a,o;n.d(t,{Zn:()=>i,F2:()=>a,N7:()=>o}),function(e){e[e.MediaPaused=0]="MediaPaused",e[e.MediaPlayed=1]="MediaPlayed",e[e.MediaStopped=2]="MediaStopped",e[e.MediaSeeked=3]="MediaSeeked",e[e.MediaVolumeChanged=4]="MediaVolumeChanged"}(i||(i={})),function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(a||(a={})),function(e){e[e.InvalidInputParameters=1]="InvalidInputParameters",e[e.UnsupportedFileTypeDetectedInBootstrapper=4]="UnsupportedFileTypeDetectedInBootstrapper",e[e.RegionNotSupported=8]="RegionNotSupported",e[e.MissingFileGetUrlAndBundleUrl=10]="MissingFileGetUrlAndBundleUrl",e[e.UnsupportedModernSlideShowPlatforms=12]="UnsupportedModernSlideShowPlatforms",e[e.UnsupportedModernSlideShowBrowsers=13]="UnsupportedModernSlideShowBrowsers",e[e.BootstrapperLoadFailure=4e6]="BootstrapperLoadFailure",e[e.ComponentLoadTimeout=4000001]="ComponentLoadTimeout",e[e.CannotOpenDocument=5308422]="CannotOpenDocument",e[e.CantOpenDocumentFileType=5341186]="CantOpenDocumentFileType",e[e.CantOpenDocument=5341189]="CantOpenDocument",e[e.CantComposeSlideParse=5341192]="CantComposeSlideParse",e[e.GenericSlideCorruption=5341196]="GenericSlideCorruption",e[e.EditSlideCorruption=5341227]="EditSlideCorruption",e[e.CannotOpenDocumentWrongExt=5341260]="CannotOpenDocumentWrongExt",e[e.CannotOpenDocumentStgDocFileCorrupt=5341261]="CannotOpenDocumentStgDocFileCorrupt",e[e.CannotOpenDocumentMmcfPackagePartNotFound=5341263]="CannotOpenDocumentMmcfPackagePartNotFound",e[e.CannotOpenDocumentArchiveError=5341264]="CannotOpenDocumentArchiveError",e[e.ErrorCannotOpenFileMetroFileCorruption=5341440]="ErrorCannotOpenFileMetroFileCorruption",e[e.ErrorCannotOpenFileXmlError=5341441]="ErrorCannotOpenFileXmlError",e[e.CantOpenDocumentPassword=5341188]="CantOpenDocumentPassword",e[e.CantOpenDocumentSigned=5341219]="CantOpenDocumentSigned",e[e.CannotOpenODPDocumentPassword=5341239]="CannotOpenODPDocumentPassword",e[e.CantOpenDocumentMacro=5341217]="CantOpenDocumentMacro",e[e.CantInstallFonts=5341190]="CantInstallFonts",e[e.CantOpenEmbeddedFonts=5341220]="CantOpenEmbeddedFonts",e[e.CantOpenDocumentIRM=5341187]="CantOpenDocumentIRM",e[e.CannotOpenDocumentStgZeroByteFile=5341338]="CannotOpenDocumentStgZeroByteFile",e[e.CannotOpenDocumentTooLarge=5341301]="CannotOpenDocumentTooLarge",e[e.DownloadNotFound=5341412]="DownloadNotFound",e[e.DownloadStatusCodeUnauthorized=5341414]="DownloadStatusCodeUnauthorized",e[e.DownloadStatusCodeForbidden=5341415]="DownloadStatusCodeForbidden",e[e.DownloadStatusCodeNotFound=5341417]="DownloadStatusCodeNotFound"}(o||(o={}))},732805:(e,t,n)=>{n.r(t),n.d(t,{BaseSharingProvider:()=>o});var i=n(360452),a=n(809076);class o{constructor(e){this.localized=e}translateError(e,t){if(t&&t.terminatedReason===i.yb.NoPermission)return{title:this.localized.callingErrorNotAllowedTitle(),message:this.localized.callingErrorNotAllowed()};let n;switch(e){case a.i.CallCreateContentSharingSessionFailed:case a.i.SessionStartContentSharingFailed:case a.i.PresenterFailedToParseSharingContent:case a.i.DtoCreationFailed:n=this.localized.callingContentSharingPresenterGenericError();break;case a.i.SessionJoinContentSharingFailed:case a.i.RendererInitFailed:n=this.localized.callingContentSharingViewerFailedToDisplay();break;case a.i.SessionUpdateContentSharingParticipantStateToViewerFailed:n=this.localized.callingContentSharingViewerCannotUpdateStatus();break;case a.i.ViewerFailedToParseSharingContent:n=this.localized.calilngContentSharingViewerHasNoAccess();break;default:n=this.localized.callingContentSharingViewerFailedToDisplay()}return{message:n,title:this.localized.callingContentSharingErrorTitle()}}}},464473:(e,t,n)=>{n.d(t,{I:()=>o,K:()=>i});var i,a=n(809076);class o{constructor(e,t,n,i,a){this.errorMessage=e,this.httpResponseCode=t,this.contextId=n,this.internalErrorCode=i,this.isExpected=a}}!function(e){e[e.PresenterFailedToFetchContentSharingFields=a.i.ProviderSpecificBase]="PresenterFailedToFetchContentSharingFields",e[e.FailedToFetchTempAuthToken=a.i.ProviderSpecificBase+3]="FailedToFetchTempAuthToken",e[e.FailedToGetWacUrl=a.i.ProviderSpecificBase+4]="FailedToGetWacUrl",e[e.FailedToUploadExchangeFile=a.i.ProviderSpecificBase+5]="FailedToUploadExchangeFile",e[e.FailedToGetSiteUrl=a.i.ProviderSpecificBase+6]="FailedToGetSiteUrl",e[e.FailedToFetchFromFileRedeemService=a.i.ProviderSpecificBase+7]="FailedToFetchFromFileRedeemService"}(i||(i={}))},864405:(e,t,n)=>{n.r(t),n.d(t,{WhiteboardErrorCode:()=>i,WhiteboardMeetingType:()=>a,WhiteboardProvider:()=>S});var i,a,o=n(361366),r=n(360452),s=n(197981),l=n(809076),c=n(972858),d=n(796973),g=n(2781),u=n(732805);!function(e){e[e.FailedGettingOrganizerId=l.i.ProviderSpecificBase+0]="FailedGettingOrganizerId",e[e.FailedGettingWhiteboardUrl=l.i.ProviderSpecificBase+1]="FailedGettingWhiteboardUrl",e[e.NoConversationId=l.i.ProviderSpecificBase+2]="NoConversationId",e[e.FailedLoadingWhiteboard=l.i.ProviderSpecificBase+3]="FailedLoadingWhiteboard",e[e.FailedToCaptureFrame=l.i.ProviderSpecificBase+4]="FailedToCaptureFrame",e[e.FailedToGetScreenSharingRenderer=l.i.ProviderSpecificBase+5]="FailedToGetScreenSharingRenderer"}(i||(i={})),function(e){e[e.CalendarScheduled=0]="CalendarScheduled",e[e.CalendarAdhoc=1]="CalendarAdhoc",e[e.ChannelScheduled=2]="ChannelScheduled",e[e.ChannelAdhoc=3]="ChannelAdhoc",e[e.GroupCall=4]="GroupCall",e[e.P2P=5]="P2P",e[e.Unknown=6]="Unknown"}(a||(a={}));const p=d.Constants.scenarios.whiteboard.steps,C=/^CallSignalingAgent \(141(6|7)/;var h;!function(e){e.Android="Android",e.iOS="iOS"}(h||(h={}));const m=e=>null==e;class S extends u.BaseSharingProvider{constructor(e,t,n,i,a,o,r,s,l,c,d,u=null,p,C,h=g.EsPromiseFactory){super(C),this.authenticationService=e,this.callingService=t,this.callTitleService=n,this.conversationsAsyncService=i,this.messageFetchService=a,this.loggingService=o,this.whiteboardSharingSessionFactory=r,this.whiteboardClient=s,this.whiteboardPolicyService=l,this.platformDetectService=c,this.config=d,this.helpers=u,this.ipchelper=p,this.localized=C,this.promiseFactory=h,this.logger=o.newLogger("WhiteboardProvider"),this.isElectronAppSurfaceHub=!0===this.platformDetectService.isElectronAppSurfaceHub(),this.isMeetingRoomDevice=!0===this.platformDetectService.isConferenceRoomDevice()}getProvidedType(){return"whiteboard"}dtoToDetailedType(e){return e.url&&e.url.includes("webboard")?"webboard":"whiteboard"}isSameSession(e,t){return!1}getMeetingWhiteboard(e,t,n,a){return this.addFluidInfoScenarioStep(p.meetingWhiteboardQueryStart),this.promiseFactory.all([this.getOrganizerId(e,t),this.getTenantId(e),this.authenticationService.getUserInformation(),this.getICalUid(e),this.whiteboardPolicyService.isEnabledByPolicies(),this.authenticationService.getUserDetails()]).then((([r,s,l,c,g,u])=>(0,o.__awaiter)(this,void 0,void 0,(function*(){var o,C,h,S;if(!r){const e="Organizer id is null";return this.logger.error(`Error getting meeting whiteboard: ${e}`),this.promiseFactory.reject(Object.assign({code:i.FailedGettingOrganizerId,cause:e},this.translateError(i.FailedGettingOrganizerId)))}const v=u.region===d.Constants.authentication.skypeAuthRegionGcc,I=yield this.getMeetingTitle(e,t,n,l),f=l.profile.oid;let T,y=null;return this.isMeetingRoomDevice&&this.config.selectNewInitiatorInShub()&&(y=this.selectNewInTenantInitiator(n),(null===(C=(o=this.config).useAzureForNewShubBoard)||void 0===C?void 0:C.call(o))?T=!1:(null===(S=(h=this.config).useLocalFluidInMeetingDeviceInitiation)||void 0===S?void 0:S.call(h))?(T=!0,m(y)&&(y="")):T=null!==y),this.whiteboardClient.getWhiteboardUrl(e,t,r,s,I,f,c,g.isFluidEnabled,v,this.isMeetingRoomDevice,T,a).then((e=>{this.addFluidInfoScenarioStep(p.meetingWhiteboardUrlResult,e.url);const t=new URL(e.url);t.searchParams.append("initiatorId",f),this.isNewFluidBoard(e.url)&&null!==y&&t.searchParams.append("openDetached","1");const n={type:this.getProvidedType(),url:t.toString(),shareUrl:e.shareUrl};return this.isFluidBoard(e.url)&&null!==y&&(n.initiatorParticipantId=y),n})).catch((e=>(this.logger.error(`Error getting meeting whiteboard: ${e}`),this.promiseFactory.reject(Object.assign({code:i.FailedGettingWhiteboardUrl,cause:e},this.translateError(i.FailedGettingWhiteboardUrl))))))}))))}getShareContent(e){return this.authenticationService.getUserInformation().then((e=>e.profile.tid)).then((t=>e.tenantId&&t!==e.tenantId?(this.addFluidInfoScenarioStep(p.contextTenantDoesNotMatch),[]):this.whiteboardPolicyService.isEnabledByPolicies().then((t=>t.isFluidEnabled||t.isLegacyWhiteboardEnabled?(this.addFluidInfoScenarioStep(p.share_content_success),[{type:this.getProvidedType(),url:null,icon:null,conversationId:e.conversationId,messageId:e.messageId,initiatorParticipantId:e.initiatorParticipantId}]):(this.addFluidInfoScenarioStep(p.fluidAndLegacyWbDisabled),[]))))).catch((e=>(this.logger.error(`Error getting share content: ${e}`),[])))}onContentShareStarting(e,t,n){if(t.appendEventData({meetingType:this.isPrivateMeeting(e.messageId)?"private":"channel"}),e.url)return t.appendEventData({previewType:this.dtoToDetailedType(e)}),this.promiseFactory.resolve();if(!e.conversationId){const e="No conversation id provided";return this.logger.error(`Error on content share starting: ${e}`),this.promiseFactory.reject(Object.assign({code:i.NoConversationId,cause:e},this.translateError(i.NoConversationId)))}return this.getMeetingWhiteboard(e.conversationId,e.messageId,n).then((n=>{t.mark(d.Constants.scenarios.contentSharing.steps.whiteboardUrlRetrieved),e.url=n.url,e.shareUrl=n.shareUrl,!m(n.initiatorParticipantId)&&this.config.selectNewInitiatorInShub()&&this.isMeetingRoomDevice&&this.isFluidBoard(n.url)&&(e.initiatorParticipantId=`${n.initiatorParticipantId}|${e.initiatorParticipantId}`),t.appendEventData({previewType:this.dtoToDetailedType(e)})}))}contentShareToDto(e,t){if(null==t||t.mark(d.Constants.scenarios.contentSharing.steps.contentShareToDto),!this.verifyUrl(e.url)){const t=e.url?"Invalid url found in DTO":"Url in DTO is empty";return this.logger.error(`Error on content share to DTO: ${t}`),this.promiseFactory.reject(Object.assign({code:l.i.DtoCreationFailed,cause:t},this.translateError(l.i.DtoCreationFailed)))}return this.promiseFactory.resolve((0,s.cloneDeep)(e))}dtoToSubject(e){}startOutgoingSession(e,t,n){var i,a,o;const r=this.shouldSetInitiatorFlag(!0,e,t,n);if(n&&(e.url=this.appendMeetingInfoToUrl(e.url,n)),this.isElectronAppSurfaceHub&&this.config.nativeWhiteboardShubEnabled()){const r=this.whiteboardSharingSessionFactory.createSession(t.contentSharingGuid,e,t,n,!0,!0);return r&&r.contentDto&&r.contentDto.shareUrl?(this.logger.info("Sending ipc to desktopClient to open native whiteboard"),null===(o=null===(a=null===(i=this.ipchelper)||void 0===i?void 0:i.ipcUtility)||void 0===a?void 0:a.get())||void 0===o||o.send(d.Constants.whiteboard.openNativeWhiteboardShub,r.contentDto.shareUrl)):this.logger.error("session.contentDto or session.contentDto.shareUrl is not defined"),r}return this.whiteboardSharingSessionFactory.createSession(t.contentSharingGuid,e,t,n,r)}startIncomingSession(e,t,n){var i,a,o;const r=this.shouldSetInitiatorFlag(!1,e,t,n);if(n&&(e.url=this.appendMeetingInfoToUrl(e.url,n)),this.isElectronAppSurfaceHub&&this.config.nativeWhiteboardShubEnabled()){const r=this.whiteboardSharingSessionFactory.createSession(t.contentSharingGuid,e,t,n,!1,!0);return r&&r.contentDto&&r.contentDto.shareUrl?(this.logger.info("Sending ipc to desktopClient to open native whiteboard"),null===(o=null===(a=null===(i=this.ipchelper)||void 0===i?void 0:i.ipcUtility)||void 0===a?void 0:a.get())||void 0===o||o.send(d.Constants.whiteboard.openNativeWhiteboardShub,r.contentDto.shareUrl)):this.logger.error("session.contentDto or session.contentDto.shareUrl is not defined"),r}return this.whiteboardSharingSessionFactory.createSession(t.contentSharingGuid,e,t,n,r)}handleStartError(e,t){this.logger.error(`cannot start content sharing session: ${e&&e.code}`),t.fail({reason:c.CallingTelemetryService.getErrorMessage(e&&e.cause||e),errorCode:e&&e.code})}handleError(e,t,n){const i={reason:c.CallingTelemetryService.getErrorMessage(e&&e.cause||e),errorCode:e&&e.code};return e&&this.isExternalUser(e.cause)?n.incomplete(i):n.fail(i),!0}rethrow(e,t){return t&&this.isExternalUser(t.cause)?this.promiseFactory.reject({code:t.code,message:t.message,title:t.title,cause:t.cause}):this.promiseFactory.reject(Object.assign({code:e,cause:t},super.translateError(e,t)))}verifyUrl(e){if(!e)return!1;try{return new RegExp(this.config.whiteboardUrlRegexp()).test(e)}catch(e){return!1}}isExternalUser(e){return e===d.Constants.telemetry.whiteboard.externalUser}isPrivateMeeting(e){return!e||this.isScheduledMeetingOrGroupCall(e)}isScheduledMeetingOrGroupCall(e){return"0"===e}getCreator(e){return this.conversationsAsyncService.getConversation(e).then((e=>e&&((0,s.get)(e.threadProperties,"creator")||e.creator())))}getOrganizerId(e,t){var n,a;return(null===(a=(n=this.config).whiteboardProviderUseConversation)||void 0===a?void 0:a.call(n))?this.getCreator(e).then((n=>{if(!n){const n=`Conversation with conversationId: ${e} and messageId: ${t} does not contain creator value`;return this.logger.error(`Error getting organizer ID from conversationsAsyncService: ${n}`),this.promiseFactory.reject(Object.assign({code:i.FailedGettingOrganizerId,cause:n},this.translateError(i.FailedGettingOrganizerId)))}return this.promiseFactory.resolve(n)})):this.isPrivateMeeting(t)?this.getCreator(e).then((e=>this.promiseFactory.resolve(e))):this.messageFetchService.getReplyChain({conversationId:e,replyChainId:t}).then((e=>e&&e.firstMessage&&e.firstMessage.creator)).catch((e=>(this.logger.error(`Error getting organizer ID: ${e}`),this.promiseFactory.reject(Object.assign({code:i.FailedGettingOrganizerId,cause:e},this.translateError(i.FailedGettingOrganizerId))))))}getTenantId(e){return this.conversationsAsyncService.getConversation(e).then((e=>{const t=e&&((0,s.get)(e.threadProperties,"tenantid")||e.threadProperties.tenantId);return t?this.promiseFactory.resolve(t):this.authenticationService.getUserInformation().then((e=>{var t;return this.addFluidInfoScenarioStep(p.tenant_id_auth_service,(null===(t=null==e?void 0:e.profile)||void 0===t?void 0:t.tid)?"successfull":"tenantId not found"),e.profile.tid}))}))}constructP2PCallTitle(e){var t,n;const i=null!==(n=null!==(t=e.profile.name)&&void 0!==t?t:e.profile.userName)&&void 0!==n?n:e.profile.upn;return null!==i?i:""}getMeetingTitle(e,t,n,i){if(this.isScheduledMeetingOrGroupCall(t))return this.conversationsAsyncService.getConversation(e).then((e=>{const t=e&&(0,s.get)(e.threadProperties,"topic");return t?this.promiseFactory.resolve(t):this.promiseFactory.resolve("")}));const a=this.callingService.getCallByCallId(n);let o=this.callTitleService.getMeetupTitleForCall(a);return o?this.promiseFactory.resolve(o):(o=this.constructP2PCallTitle(i),o?this.promiseFactory.resolve(o):this.promiseFactory.resolve(""))}getICalUid(e){return this.conversationsAsyncService.getConversation(e).then((e=>{const t=e&&e.getMeetingInfo();return t?(this.addFluidInfoScenarioStep(p.ical_from_meeting),this.promiseFactory.resolve(t.iCalUid)):this.promiseFactory.resolve("")}))}addFluidInfoScenarioStep(e,t){const{initiatorLoadFluidWhiteboard:n,nonInitiatorLoadFluidWhiteboard:i,nonInitiatorReadyForFluidWhiteboard:a}=d.Constants.scenarios.whiteboard;let o=this.loggingService.findScenario(n);o||(o=this.loggingService.findScenario(i)),o||(o=this.loggingService.findScenario(a)),o&&o.mark(e,{context:t||""})}isFluidBoard(e){return e.includes("/meeting?")}isNewFluidBoard(e){return e.includes("/meeting?")&&!e.includes("encodedShareLink")}isValidFluidInitiatorEndpoint(e){var t,n,i,a;if("room"!==e.deviceType){const o=(e=>{if(e){const t=e.match(C);if(t)return"6"===t[1]?h.Android:h.iOS}return null})(e.clientVersion);if(!o||o===h.Android&&(null===(n=(t=this.config).isSelectNewAndroidFluidInitiatorEnabled)||void 0===n?void 0:n.call(t))||o===h.iOS&&(null===(a=(i=this.config).isSelectNewIOSFluidInitiatorEnabled)||void 0===a?void 0:a.call(i)))return!0}return!1}selectNewInTenantInitiator(e){const t=this.callingService.getCallByCallId(e);let n;for(const e of t.participants){if(e.tenantId!==t.tenantId)continue;const i=e.endpoints.endpointDetails;for(const t of i)if(this.isValidFluidInitiatorEndpoint(t)){if("organizer"===e.meetingRole)return t.participantId;n||(n=t.participantId)}}if(n)return n;for(const e of t.endpoints.endpointDetails)if(this.isValidFluidInitiatorEndpoint(e))return e.participantId;return this.logger.info("Couldn't find another valid initiator for whiteboard in meeting, mantaining original initiator"),null}getMeetingType(e){var t;if(e.callType===r.rf.P2P)return a.P2P;if(e.callType===r.rf.Conference){const n=e.getCallingConversation();if(n.isPrivateMeeting())return"Scheduled"===n.meetingInfo.meetingType?a.CalendarScheduled:a.CalendarAdhoc;if(n.isChannel())return"Scheduled"===(null===(t=e.meetingDetails)||void 0===t?void 0:t.meetingType)?a.ChannelScheduled:a.ChannelAdhoc;if(n.isGroup())return a.GroupCall}return a.Unknown}appendMeetingInfoToUrl(e,t){var n;const i=new URL(e);i.searchParams.append("meetingType",this.getMeetingType(t).toString());const a=null===(n=t.meetingInfo)||void 0===n?void 0:n.tenantId;return a&&i.searchParams.append("meetingTenantId",a),i.toString()}shouldSetInitiatorFlag(e,t,n,i){var a;const o=null===(a=t.initiatorParticipantId)||void 0===a?void 0:a.split("|");let r=o&&o.length>0?o[0]:void 0;const s=o&&o.length>1?o[1]:void 0;let l;if(n.contentSharingState)try{l=JSON.parse(n.contentSharingState)}catch(e){this.logger.error("Content Sharing Session state is not a valid JSON string")}if(""===r&&(null==l?void 0:l.initiatorParticipantId)&&(this.logger.info("Retrieved selected whiteboard initiator from cache"),r=l.initiatorParticipantId,t.initiatorParticipantId&&t.initiatorParticipantId.length>0&&"|"===t.initiatorParticipantId[0]&&(t.initiatorParticipantId=r+t.initiatorParticipantId)),!m(r)){if(""!==r||m(s))return this.logger.info("Using initiator participant id field to set isInitiator flag"),r===(null==i?void 0:i.participantId);if(s===i.participantId){const e=new URL(t.url);e&&(e.searchParams.append("openDetachedShub","1"),t.url=e.toString()),this.logger.info("Opened local whiteboard")}else this.logger.info("Desired initiator is empty but other participant is in the meeting");return!1}return this.logger.info("Setting isInitiator based on default value"),e}}},203694:(e,t,n)=>{n.d(t,{R:()=>i});class i{}i.Type_Conversation="conversation",i.Type_List="list",i.Type_Resolve="resolve"},391951:(e,t,n)=>{n.d(t,{V:()=>i});class i{}i.Type_CallConnected="come-call-connected",i.Type_CallDisconnecting="come-call-disconnecting"},197959:(e,t,n)=>{var i,a,o,r,s,l,c;n.r(t),n.d(t,{ImageOrigin:()=>i,CustomVideoBackgroundUploadStatusCode:()=>a,CustomVideoBackgroundManagerStatusCode:()=>o,CustomVideoBackgroundResponseErrorCode:()=>r,CustomBackgroundImageCategory:()=>s,ImageDownloadState:()=>l,ImageContext:()=>c,VIDEO_BACKGROUND_NONE:()=>d,VIDEO_BACKGROUND_BLUR:()=>g,VIDEO_BACKGROUND_BOKEH:()=>u,ANIMATED_FILETYPE_PRESET:()=>p}),function(e){e.MICROSOFT_DEFAULT="MICROSOFT_DEFAULT",e.CUSTOM_USER_UPLOAD="CUSTOM_USER_UPLOAD"}(i||(i={})),function(e){e.UPLOAD_SUCCESS="UPLOAD_SUCCESS",e.UPLOAD_FAILURE="UPLOAD_FAILURE",e.UPLOAD_IMAGE_NOT_ACCEPTED="UPLOAD_IMAGE_NOT_ACCEPTED"}(a||(a={})),function(e){e.FILE_DOWNLOAD_FAILURE="FILE_DOWNLOAD_FAILURE",e.DIR_CREATION_FAILURE="DIR_CREATION_FAILURE",e.DOWNLOAD_URL_FAILURE="DOWNLOAD_URL_FAILURE",e.FILE_DOWNLOAD_SUCCESS="FILE_DOWNLOAD_SUCCESS",e.LOCAL_IMAGES_FAILED_TO_FETCH="LOCAL_IMAGES_FAILED_TO_FETCH",e.LOCAL_IMAGES_FETCHED="LOCAL_IMAGES_FETCHED",e.LOCAL_IMAGE_FAILED_TO_SAVE="LOCAL_IMAGE_FAILED_TO_SAVE",e.LOCAL_IMAGE_SAVED="LOCAL_IMAGE_SAVED",e.LOCAL_IMAGE_DELETED="LOCAL_IMAGE_DELETED",e.LOCAL_IMAGE_FAILED_TO_DELETE="LOCAL_IMAGE_FAILED_TO_DELETE",e.LOCAL_THUMBNAILS_GENERATED="LOCAL_THUMBNAILS_GENERATED",e.LOCAL_FAILED_TO_GENERATE_THUMB="LOCAL_FAILED_TO_GENERATE_THUMB",e.INVALID_IMAGE="INVALID_IMAGE",e.IMAGE_FILE_EXTENSION_NOT_SUPPORTED="IMAGE_FILE_EXTENSION_NOT_SUPPORTED",e.INVALID_PATH_TO_IMAGE="INVALID_PATH_TO_IMAGE",e.GENERATED_IMAGE_SAVED="GENERATED_IMAGE_SAVED",e.GENERATED_IMAGE_FAILED_TO_SAVE="GENERATED_IMAGE_FAILED_TO_SAVE",e.SAVE_GENERATED_IMAGE_IS_UNDEFINED="SAVE_GENERATED_IMAGE_IS_UNDEFINED",e.DELETE_USER_IMAGE_V2_SUCCEEDED="DELETE_USER_IMAGE_V2_SUCCEEDED",e.DELETE_USER_IMAGE_V2_FAILED="DELETE_USER_IMAGE_V2_FAILED",e.UPLOAD_USER_IMAGE_V2_SUCCEEDED="UPLOAD_USER_IMAGE_V2_SUCCEEDED",e.UPLOAD_USER_IMAGE_V2_FAILED="UPLOAD_USER_IMAGE_V2_FAILED",e.DELETE_USER_IMAGE_BY_CATEGORY_SUCCEEDED="DELETE_USER_IMAGE_BY_CATEGORY_SUCCEEDED",e.DELETE_USER_IMAGE_BY_CATEGORY_FAILED="DELETE_USER_IMAGE_BY_CATEGORY_FAILED",e.PERSIST_GENERATED_USER_IMAGE_SUCCEEDED="PERSIST_GENERATED_USER_IMAGE_SUCCEEDED",e.PERSIST_GENERATED_USER_IMAGE_FAILED="PERSIST_GENERATED_USER_IMAGE_FAILED",e.GET_USER_IMAGE_V2_SUCCEEDED="GET_USER_IMAGE_V2_SUCCEEDED",e.GET_USER_IMAGE_V2_FAILED="GET_USER_IMAGE_V2_FAILED"}(o||(o={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.IMAGE_FILE_EXTENSION_NOT_SUPPORTED="IMAGE_FILE_EXTENSION_NOT_SUPPORTED",e.INVALID_REQUEST="INVALID_REQUEST",e.IMAGE_FILE_NOT_EXISTED="IMAGE_FILE_NOT_EXISTED",e.INVALID_FILE_NAME="INVALID_FILE_NAME"}(r||(r={})),function(e){e[e.UPLOAD=0]="UPLOAD",e[e.STYLE_MY_ROOM_TEMP=1]="STYLE_MY_ROOM_TEMP",e[e.STYLE_MY_ROOM=2]="STYLE_MY_ROOM"}(s||(s={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.NONE="NONE",e.SUCCESS="SUCCESS",e.FAIL="FAIL"}(l||(l={})),function(e){e.BackgroundEffect="BackgroundEffect",e.GreenScreenBackgroundEffect="GreenScreenBackgroundEffect",e.BackgroundAPL="BackgroundAPL"}(c||(c={}));const d="microsoft_none",g="microsoft_blur",u="microsoft_bokeh",p=new Set(["mp4","m4a","m4p","m4b","m4r","m4v"])},230620:(e,t,n)=>{var i;n.d(t,{k:()=>i}),function(e){e[e.AddFailedGeneric=0]="AddFailedGeneric",e[e.AddFailedConflict=1]="AddFailedConflict",e[e.AddCallForwardingFailed=2]="AddCallForwardingFailed",e[e.EditFailedGeneric=3]="EditFailedGeneric",e[e.EditCallForwardingFailed=4]="EditCallForwardingFailed",e[e.DeleteFailedGeneric=5]="DeleteFailedGeneric",e[e.DeleteCallForwardingFailed=6]="DeleteCallForwardingFailed"}(i||(i={}))},816639:(e,t,n)=>{var i,a,o;n.d(t,{tH:()=>i,sZ:()=>a,vh:()=>o,K4:()=>r,xv:()=>s,Ch:()=>l}),function(e){e.None="None",e.Normal="Normal",e.Deep="Deep",e.PNS="PNS"}(i||(i={})),function(e){e.EyeContact="EyeContact",e.AutoFraming="AutoFraming"}(a||(a={})),function(e){e.On="On",e.Off="Off",e.Default="Default"}(o||(o={}));class r{}r.NoiseSuppression_Support="ns-support",r.NoiseSuppression_SettingChanged="ns-setting-changed",r.NoiseSuppression_Initialized="ns-init",r.Devices_Initialized="devices-init",r.VoiceSignature_Requested="voicesignature-requested",r.AutomaticGainControl_SettingToggle="agc-setting-toggle",r.SyncDeviceButtons_SettingToggle="sync-device-buttons",r.AutomaticCameraSettingsSelected_SettingToggle="camera-setting-toggle",r.HighFidelityMusicMode_SettingToggle="highfidelitymusicmode-setting-toggle",r.EchoCancellation_SettingToggle="echocancellation-setting-toggle",r.StereoMode_SettingToggle="stereo-mode-setting-toggle";class s{}s.AutoAdjust="AutoAdjust",s.TouchUp="TouchUp",s.EyeContact="EyeContact",s.BackgroundModification="BackgroundModification",s.ContentCamera="ContentCamera",s.GreenScreen="GreenScreen",s.ReplacementChromaKey="ReplacementChromaKey";class l{}l.SendMessagePortFromMainWindowPreloadToMainWorld="video.sendMessagePortFromMainWindowPreloadToMainWorld",l.EnableVideoExtensibility="video.enableVideoExtensibility",l.MessageChannelEstablished="video.messageChannelEstablished",l.VideoEffectDisabled="video.videoEffectDisabled",l.VideoEffectEnabled="video.videoEffectEnabled",l.IpcChangedEvent="video.videoExtensibilityIpcChangedEvent",l.PerformanceErrorEvent="video.videoExtensibilityPerfErrorEvent",l.PerformanceAlertEvent="video.videoExtensibilityPerfAlertEvent"},793579:(e,t,n)=>{var i,a,o,r,s,l,c,d;n.d(t,{wh:()=>i,vR:()=>a,iF:()=>o,Yk:()=>r,E8:()=>s,Lc:()=>l,Ai:()=>c,JM:()=>d}),function(e){e[e.callingScreen=54]="callingScreen",e[e.broadcastScreen=160]="broadcastScreen",e[e.teamsDeviceAttachedPseudo=321]="teamsDeviceAttachedPseudo",e[e.activeCallBanner=353]="activeCallBanner",e[e.ndiInSettingsTurnOn=405]="ndiInSettingsTurnOn",e[e.ndiInSettingsTurnOff=406]="ndiInSettingsTurnOff",e[e.ndiCaptureStart=407]="ndiCaptureStart",e[e.confirmAudioEscalationDialog=334]="confirmAudioEscalationDialog",e[e.callPaywallDurationAlertForSponsor=454]="callPaywallDurationAlertForSponsor",e[e.callPaywallDurationAlertForParticipant=455]="callPaywallDurationAlertForParticipant",e[e.callPaywallCapacityAlert=456]="callPaywallCapacityAlert",e[e.callPaywallTimerStartAlert=457]="callPaywallTimerStartAlert",e[e.hidDeviceASPConnectionFromApp=485]="hidDeviceASPConnectionFromApp",e[e.isolatedAudioInSettingsTurnOn=488]="isolatedAudioInSettingsTurnOn",e[e.isolatedAudioInSettingsTurnOff=489]="isolatedAudioInSettingsTurnOff",e[e.OnDidHookEventViaDevice=495]="OnDidHookEventViaDevice",e[e.OnDidOffHookEventViaDevice=496]="OnDidOffHookEventViaDevice",e[e.OnDidFlashEventViaDevice=497]="OnDidFlashEventViaDevice",e[e.OnDidMuteToggleEventViaDevice=498]="OnDidMuteToggleEventViaDevice",e[e.OnDidVideoMuteEventViaDevice=499]="OnDidVideoMuteEventViaDevice",e[e.OnDidVideoUnmuteEventViaDevice=500]="OnDidVideoUnmuteEventViaDevice",e[e.onDidContentCameraInvokeViaDevice=515]="onDidContentCameraInvokeViaDevice",e[e.onDetectMultipleUltrasoundMTRs=532]="onDetectMultipleUltrasoundMTRs"}(i||(i={})),function(e){e[e.interopScreenshareButtonAlert=2]="interopScreenshareButtonAlert",e[e.mergeFailureButtonAlert=3]="mergeFailureButtonAlert",e[e.messageFromMeetingStartToast=62]="messageFromMeetingStartToast",e[e.meetingStartedNotification=261]="meetingStartedNotification",e[e.meetingStartedFromLobbyNotification=262]="meetingStartedFromLobbyNotification",e[e.openMeetingDetails=331]="openMeetingDetails",e[e.pstnFallbackUFDButton=332]="pstnFallbackUFDButton",e[e.shareScreenButton=592]="shareScreenButton",e[e.emergencyCall=632]="emergencyCall",e[e.showCallToast=665]="showCallToast",e[e.sharePowerPointFileFromDeepLink=685]="sharePowerPointFileFromDeepLink",e[e.joinFromMeetingStartToast=801]="joinFromMeetingStartToast",e[e.activeCallBannerDismiss=803]="activeCallBannerDismiss",e[e.acceptBreakoutRoomInvite=811]="acceptBreakoutRoomInvite",e[e.declineBreakoutRoomInvite=812]="declineBreakoutRoomInvite",e[e.acceptMainMeetingInvite=813]="acceptMainMeetingInvite",e[e.declineMainMeetingInvite=814]="declineMainMeetingInvite",e[e.goToMainMeeting=815]="goToMainMeeting",e[e.downloadAppButton=849]="downloadAppButton",e[e.optOutVoiceCollection=905]="optOutVoiceCollection",e[e.closeVoiceCollection=1559]="closeVoiceCollection",e[e.pstnComponentInPstnFallback=939]="pstnComponentInPstnFallback",e[e.dismiss=940]="dismiss",e[e.unmute=941]="unmute",e[e.shareDesktop=942]="shareDesktop",e[e.switchAudioDevice=943]="switchAudioDevice",e[e.switchToNewPluggedInVideoDevice=945]="switchToNewPluggedInVideoDevice",e[e.switchToCurrentBestCamera=946]="switchToCurrentBestCamera",e[e.openDeviceSettings=947]="openDeviceSettings",e[e.unmuteSpeakers=948]="unmuteSpeakers",e[e.ufdTurnOffAudio=949]="ufdTurnOffAudio",e[e.ufdTurnOffVideo=950]="ufdTurnOffVideo",e[e.ufdTurnOnVideo=951]="ufdTurnOnVideo",e[e.openAudioEscalationDialogButton=952]="openAudioEscalationDialogButton",e[e.betterTogetherTransferCall=953]="betterTogetherTransferCall",e[e.escalateAudio=957]="escalateAudio",e[e.pptTakeControl=974]="pptTakeControl",e[e.pptStartSharing=977]="pptStartSharing",e[e.pptCancelSharing=979]="pptCancelSharing",e[e.pptUnsupportedMeeting=980]="pptUnsupportedMeeting",e[e.pptSharingUnavailable=981]="pptSharingUnavailable",e[e.dismissFromMeetingStartToast=1025]="dismissFromMeetingStartToast",e[e.openSettings=1051]="openSettings",e[e.learnMore=1097]="learnMore",e[e.joinBroadcastMeeting=1103]="joinBroadcastMeeting",e[e.retryBroadcastJoin=1116]="retryBroadcastJoin",e[e.broadcastLearnMoreAlertButton=1195]="broadcastLearnMoreAlertButton",e[e.teamsDeviceVoiceMail=1214]="teamsDeviceVoiceMail",e[e.teamsDeviceMissedCall=1215]="teamsDeviceMissedCall",e[e.teamsDeviceActivateApp=1216]="teamsDeviceActivateApp",e[e.teamsDeviceMeetingJoin=1217]="teamsDeviceMeetingJoin",e[e.teamsDeviceCortanaInvoked=1218]="teamsDeviceCortanaInvoked",e[e.ndiPrivacyPolicyButtonCapturer=1368]="ndiPrivacyPolicyButtonCapturer",e[e.ndiPrivacyPolicyButtonParticipant=1369]="ndiPrivacyPolicyButtonParticipant",e[e.lockMeetingButtonAlert=1408]="lockMeetingButtonAlert",e[e.reportScdFailureButton=1440]="reportScdFailureButton",e[e.liveStreamingPrivacyPolicyButtonParticipant=1469]="liveStreamingPrivacyPolicyButtonParticipant",e[e.paywallUpgradeButton=1504]="paywallUpgradeButton",e[e.paywallDurationAlert=1505]="paywallDurationAlert",e[e.paywallCapacityAlert=1506]="paywallCapacityAlert",e[e.paywallTimerStartAlert=1507]="paywallTimerStartAlert",e[e.highFidelityMusicModeToggleFromUFD=1511]="highFidelityMusicModeToggleFromUFD",e[e.closeVideoApp=1512]="closeVideoApp",e[e.unmuteMicAndSpeakers=1517]="unmuteMicAndSpeakers",e[e.muteMicAndSpeakers=1533]="muteMicAndSpeakers",e[e.viewBreakoutRooms=1540]="viewBreakoutRooms",e[e.interpretationAvailableDialogButton=1541]="interpretationAvailableDialogButton",e[e.controlRoomSystemPanelButton=1550]="controlRoomSystemPanelButton",e[e.recordingStartButton=1560]="recordingStartButton",e[e.lowerHandManualAlert=1590]="lowerHandManualAlert",e[e.keepRaisedHandManualAlert=1591]="keepRaisedHandManualAlert",e[e.keepRaisedHandAutoAlert=1593]="keepRaisedHandAutoAlert",e[e.manualAlertDismissed=1594]="manualAlertDismissed",e[e.autoAlertDismissed=1595]="autoAlertDismissed",e[e.acceptControl=1596]="acceptControl",e[e.denyControl=1597]="denyControl",e[e.terminateControl=1598]="terminateControl"}(a||(a={})),function(e){e[e.callMonitor=17]="callMonitor",e[e.other=45]="other",e[e.button=50]="button",e[e.toast=72]="toast",e[e.callNotification=98]="callNotification",e[e.callPaywallAlert=216]="callPaywallAlert",e[e.callPaywallDurationAlertLearnMore=217]="callPaywallDurationAlertLearnMore",e[e.callPaywallCapacityAlert=218]="callPaywallCapacityAlert",e[e.callPaywallTimerStartAlert=219]="callPaywallTimerStartAlert"}(o||(o={})),function(e){e[e.click=0]="click",e[e.asyncStateChange=6]="asyncStateChange",e[e.auto=8]="auto"}(r||(r={})),function(e){e[e.info=0]="info",e[e.nav=1]="nav",e[e.select=4]="select",e[e.dismiss=13]="dismiss",e[e.show=15]="show",e[e.hide=16]="hide",e[e.joinMeeting=22]="joinMeeting",e[e.confirmAudioEscalation=57]="confirmAudioEscalation"}(s||(s={})),function(e){e[e.mergeFailureAlertDismiss=7]="mergeFailureAlertDismiss",e[e.emergencyCall=10]="emergencyCall",e[e.sharingContent=744]="sharingContent",e[e.showCallToast=774]="showCallToast",e[e.closeActiveCallBanner=921]="closeActiveCallBanner",e[e.escalateAudio=1130]="escalateAudio",e[e.pstnFallbackPstnComponent=1139]="pstnFallbackPstnComponent",e[e.joinBroadcast=1237]="joinBroadcast",e[e.lockMeetingRetryButtonAlert=1500]="lockMeetingRetryButtonAlert",e[e.dismissPaywallAlert=1623]="dismissPaywallAlert",e[e.paywallUpgrade=1624]="paywallUpgrade",e[e.mdpDataCollection=1716]="mdpDataCollection",e[e.lowerHandManualAlert=1733]="lowerHandManualAlert",e[e.keepRaisedHandManualAlert=1734]="keepRaisedHandManualAlert",e[e.keepRaisedHandAutoAlert=1736]="keepRaisedHandAutoAlert",e[e.manualAlertDismissed=1738]="manualAlertDismissed",e[e.autoAlertDismissed=1739]="autoAlertDismissed"}(l||(l={})),function(e){e[e.banner=7]="banner"}(c||(c={})),function(e){e[e.callOrMeetup=23]="callOrMeetup",e[e.emergencyCall=28]="emergencyCall",e[e.openDialog=45]="openDialog",e[e.broadcast=108]="broadcast",e[e.lockMeetingAlert=263]="lockMeetingAlert",e[e.enforcementStatusChangeNotification=292]="enforcementStatusChangeNotification",e[e.meetingIsFullNotification=293]="meetingIsFullNotification",e[e.meetingWillTimeoutNotification=294]="meetingWillTimeoutNotification"}(d||(d={}))},918635:(e,t,n)=>{n.r(t),n.d(t,{ACSRecordingState:()=>On.p,AckChannelType:()=>j.U,ActionNotAllowedSubCode:()=>Jt.B,ActionNotAllowedSubCodes:()=>He,ActiveCallsServiceEvents:()=>s.z,AddMembersSource:()=>Lt,AddRecorderBotParticipantErrorSubCodes:()=>Wt,AlertPosition:()=>l.V6,AlertSoundValue:()=>Ct,AlertType:()=>l.NK,AlertWindowType:()=>l.MA,AmsStorageLocation:()=>Be,AndreaCommunicationsIds:()=>Z.Ab,AnnotationSharingStatus:()=>M.ex,AnnouncedParticipantState:()=>ae.N,ApiResponseErrorType:()=>Nt,ApplicationState:()=>Me,AspDeviceProtocol:()=>X.d3,AspDeviceUsage:()=>X.G7,AttachmentType:()=>Ye,AttendeeRestrictionType:()=>Mn.AttendeeRestrictionType,AttendeeServiceErrorSubcode:()=>kn.N7,AttendeeViewModes:()=>it,AudioCodecTelemetry:()=>Y.Ib,AutoAttendantCallFlowType:()=>fe,BackgroundColor:()=>Q.lP,Backlight:()=>Q.G7,BannerHideSource:()=>o,BannerNotificationIntentLevel:()=>Gt,BatteryLevelTelemetry:()=>Y.cC,BlockingModuleName:()=>yt,BlockingSubModuleName:()=>Et,BlockingUICategory:()=>Tt,BoseIds:()=>Z.J_,BotSourceType:()=>An.BotSourceType,BreakoutRoomBulkOperationContext:()=>W.R,BreakoutRoomErrorCodes:()=>W.C,BroadcastAnnounceStates:()=>c.IR,BroadcastDeepLinkParams:()=>oe.lX,BroadcastParticipantRole:()=>c.tf,BroadcastProducerCaptionSize:()=>st,BroadcastStatus:()=>c.TP,BuddylistGroupEventType:()=>Ae,Button:()=>Q.zx,CQCallDirection:()=>$t.rc,CQCallType:()=>$t.sW,CQUnsuccessReason:()=>$t.Bb,CVOcrType:()=>an.z3,CalendarEventProviderType:()=>Xe,CalendarServiceEvents:()=>Fn,CallAbortReason:()=>d.CallAbortReason,CallAction:()=>re.LW,CallAttemptFailureReason:()=>d.CallAttemptFailureReason,CallClosedCaptionStatus:()=>Kt.CallClosedCaptionStatus,CallConsultationEvents:()=>E.eg,CallConsultationServiceEvents:()=>A.t,CallConsultationState:()=>E.dJ,CallConsultationType:()=>E.d2,CallDisplayState:()=>Z.EX,CallEscalationServiceEvents:()=>g.d,CallEscalationState:()=>g.O,CallForwardingTargetType:()=>It,CallForwardingType:()=>St,CallGroupNotification:()=>mt,CallHealthData:()=>En.CallHealthData,CallHealthDataAdapter:()=>En.CallHealthDataAdapter,CallHealthDataAdapterType:()=>En.CallHealthDataAdapterType,CallHealthEvent:()=>En.CallHealthEvent,CallHealthMetricCameraCodec:()=>En.CallHealthMetricCameraCodec,CallHealthMetricCompareType:()=>En.CallHealthMetricCompareType,CallHealthMetricMediaSharingPolicyState:()=>En.CallHealthMetricMediaSharingPolicyState,CallHealthMetricThreshold:()=>En.CallHealthMetricThreshold,CallHealthState:()=>En.CallHealthState,CallHealthStateNumber:()=>En.CallHealthStateNumber,CallMergeType:()=>h.H,CallMoreOption:()=>le.v,CallParkServiceEvents:()=>S.CH,CallParkState:()=>S.hz,CallProp:()=>I.l,CallRecordingEvents:()=>f.Kp,CallRecordingStatus:()=>nt,CallRedirectionTargetType:()=>vt,CallStackInitializationResultCode:()=>ln.qt,CallStateHid:()=>Y.nr,CallStoreServiceEvents:()=>v.M,CallTelemetryContext:()=>T.l,CallTranscriptStatus:()=>ce.B,CallTransferServiceEvents:()=>y.q5,CallTransferState:()=>y.pF,CallTransferTargetType:()=>y.$x,CallingBotCommand:()=>Yt.CallingBotCommand,CallingBotDataType:()=>Zt.CallingBotDataType,CallingBotTextTrackSource:()=>Xt.CallingBotTextTrackSource,CallingConversationEvent:()=>u.o5,CallingDisabledReason:()=>he.DS,CallingEndScreenCode:()=>Ut,CallingIntentType:()=>p.G,CallingMWEvent:()=>Te,CallingMultiWindowServiceUpdateErrorCodes:()=>ln.q_,CallingServiceState:()=>d.CallingServiceState,CallingSessionState:()=>C.M,CallingVoiceCollectionStatus:()=>en.y,CallingWindowingExperienceMode:()=>ln.wm,ChannelType:()=>Ne,ClearDisplay:()=>Q.Zg,ClientState:()=>Mt,ClientSubCode:()=>d.ClientSubCode,ClosedCaptionsTextTrackSource:()=>Xt.ClosedCaptionsTextTrackSource,CommandIdentifier:()=>et,CommandSource:()=>xt,ConnectingStates:()=>re.Y6,ConsumerChatContext:()=>Le,ContactDataSource:()=>Oe,ContentCameraType:()=>b.WR,ContentMode:()=>Ie.l,ContentSharingErrorCode:()=>Ie.i,ControlRequestState:()=>M.Fj,ControlState:()=>M.bo,ControlStateChangedInfo:()=>M.ControlStateChangedInfo,ConversationsServiceEvents:()=>Ln,ConversationsStoreEvents:()=>r.R,CoordinatedMeetingsServiceEvents:()=>R.V,CortanaHidState:()=>Y.My,CortanaServiceEvents:()=>ot,CortanaState:()=>rt,Custom:()=>Q.$4,CustomLayoutSelection:()=>D.CustomLayoutSelection,DataChannelOwnerId:()=>Zt.DataChannelOwnerId,DayOfTheWeek:()=>Je,DayOfTheWeekIndex:()=>ze,DeepLinkCoordinatesType:()=>oe.T_,DeepLinkType:()=>oe._n,DelegationErrorCode:()=>wn.k,DellIds:()=>Z.S7,DeviceFilter:()=>K.DeviceFilter,DeviceManagerServiceEvents:()=>D.K4,DeviceMeetingJoinPhase:()=>Y.FT,DeviceOpenContext:()=>Z.rC,DeviceTelemetryDataContext:()=>Y.vY,DeviceTelemetryElement:()=>Y.ZS,DeviceVideoEffectType:()=>D.xv,DevicesWindowType:()=>lt,DiagnosticLevel:()=>ut,Display:()=>Q.sS,DisplayManagerState:()=>Z.h_,DriverAssignmentContext:()=>Z.sD,DynamicBandwidth:()=>Q.CR,EchoBotReportCategory:()=>dn.Q,EmergencyLocationType:()=>Sn.LQ,EnableDisplay:()=>Q.dl,EndpointState:()=>se.bJ,EndpointStatus:()=>Pe,EndpointType:()=>se.KP,EntityCommandErrorCode:()=>at,EnvironmentSupport:()=>Re,ErrorCode:()=>Y.jK,EventId:()=>Y.Eo,ExternalLocationLookupMode:()=>Sn.to,FrameSinkEventType:()=>ke,GenericDeviceTelemetry:()=>Y.UG,GestureBasedReactionState:()=>bn.GestureBasedReactionState,GestureBasedReactionStatus:()=>bn.GestureBasedReactionStatus,GestureBasedReactionType:()=>bn.GestureBasedReactionType,GiphyRatingType:()=>we,HPIds:()=>Z.S6,HeaderType:()=>on.n,HidDeviceOperation:()=>Z.UA,HidDeviceOperationType:()=>z.T,HidScenarioResultType:()=>z.$,HidUsageLedState:()=>Z.rk,HoldAction:()=>b.nt,HolographicAnnotationEventV2:()=>Cn.Gz,HolographicAnnotationType:()=>Cn.YR,HolographicCapabilities:()=>We,HolographicChunkID:()=>Cn.Eq,HolographicClientType:()=>Cn.Lg,HolographicDataChannelProtocol:()=>Cn.L1,HolographicInteractionMode:()=>Cn.me,HolographicInteractionRequiredComponents:()=>Cn.fi,HolographicParticipantId:()=>Cn.xh,HttpStatusCode:()=>Qe,ImageOrigin:()=>P.ImageOrigin,ImportanceLevels:()=>Ue,IncomingCommand:()=>ee.y,InstantMeetingError:()=>N.t,JabraIds:()=>Z.Xb,LED:()=>Q.Pl,LcdTextDisplayProperty:()=>Q.q$,LenovoIds:()=>Z.em,LiveCaptionsEnabledTypes:()=>Rt,LiveStateServiceExperience:()=>ne,LiveStateServiceSessionErrorCode:()=>te,LiveStreamingCommandName:()=>Tn.NH,LobbyParticipantActionStatus:()=>O.U,LocationMatchType:()=>Sn.Yx,LogLevel:()=>_e,LogitechIds:()=>Z.Rr,LongPollEventStoreEvents:()=>Bn,MTRExperience:()=>Nn.MTRExperience,MachineState:()=>De,MapOperation:()=>m.K,MediaControlsCapabilities:()=>B,MediaEventType:()=>jt.Zn,MediaReason:()=>c.PT,MediaState:()=>c.gC,MeetingAction:()=>Jt.k,MeetingControlsCapabilities:()=>G,MeetingJoinType:()=>_.c,MeetingPanelLocation:()=>En.MeetingPanelLocation,MeetingReactionType:()=>ye,MeetingStartedNotificationType:()=>i.MeetingStartedNotificationType,MeetingType:()=>Fe,MessageId:()=>Y.sr,MessageStorageState:()=>Ve,MetadataFlag:()=>Y.k1,MicrosoftIds:()=>Z.Td,Month:()=>Ke,MultiWindowBaseTypes:()=>ht,MultichannelAudioBandwidthEvents:()=>yn.MultichannelAudioBandwidthEvents,MultichannelAudioBandwidthMode:()=>yn.MultichannelAudioBandwidthMode,MuteAction:()=>b.Jn,MuteAllSectionScope:()=>de.X,MuteSource:()=>b.c3,MyUserPreferenceStorageKey:()=>Dn.z,NavigationResultType:()=>tt,NdiServiceDownloadErrorType:()=>ge.qj,NdiServiceDownloadStatus:()=>ge.yj,NdiSpecialStreamName:()=>ge.HJ,NdiWatermarkState:()=>ge.cR,NetworkRoamingPolicyUpdateReason:()=>Pn.L,NoiseSuppressionSupport:()=>D.tH,NotificationActionKind:()=>pt,NotificationMode:()=>Sn.ED,NotificationSubType:()=>w.KP,NotificationType:()=>w.k$,NotificationTypeWeb:()=>w.qp,OsPlatform:()=>Ge,OutgoingCommand:()=>k,PPTSharingErrorCode:()=>Se.K,PSTNType:()=>be,Page:()=>Q.T3,PairedConnectionStatus:()=>F,PairedConnectionType:()=>L,PanelActionGesture:()=>In.Yk,PanelActionOutcome:()=>In.E8,PanelActionScenario:()=>In.Lc,PanelActionScenarioType:()=>In.JM,PanelModuleName:()=>In.vR,PanelModuleType:()=>In.iF,PanelRegion:()=>In.Ai,PanelType:()=>In.wh,PeoplePickerFor:()=>wt,PhoneNumberFormat:()=>je,PhoneType:()=>Bt,PlantronicsIds:()=>Z.uM,PolycomIds:()=>Z.FC,PptSharingRole:()=>jt.F2,PrejoinBypassReason:()=>re.HZ,PresencePriority:()=>Dt,ProducerErrorType:()=>c.Vo,ProducerRequestCommandName:()=>Vt,ProtocolFormatID:()=>xe,PstnDeclinedError:()=>ue.K,PushDataActionType:()=>ft,RadioLinkQualityTelemetry:()=>Y.m7,RaiseHandsMessageType:()=>pe.d,RecorderActions:()=>V.RecorderActions,RecordingExportType:()=>f.s6,RecordingResponseStatus:()=>f.LW,RecurrencePatternType:()=>qe,RemoveIntentReason:()=>cn.ie,Report:()=>Q.yG,ResponseId:()=>Y.kw,ResponseSendStatusCode:()=>se.pZ,ResponseType:()=>Ot,RestrictableModalities:()=>zt.RestrictableModalities,RigelSfBState:()=>ct,RigelThemeName:()=>Rn.j,RightPanel:()=>l.QN,RingtoneCallType:()=>fn.s,RingtoneNames:()=>fn.r,RoomRemoteDesktopErrorCodes:()=>x,RoomRemoteLayoutType:()=>Ee,ScdSourceId:()=>an.ve,ScdStatus:()=>an.BI,ScenarioContext:()=>re.rs,SchemaDefinition:()=>vn.v,ScreenRegionForAlert:()=>l.C1,ScreenSelectType:()=>Q.j6,ScreenSharingControlStateAsViewer:()=>sn.C,ScreenshareControlState:()=>M.lJ,ScreenshareEventType:()=>nn.n,ScreensharingCallStates:()=>gn.V,SeatState:()=>kt,SelfLocalRecordingState:()=>_n.J,SennheiserIds:()=>Z.n6,ServiceName:()=>ie,Severity:()=>a,SfbTeamsUpgradePolicyMode:()=>H.b,SharedWindowState:()=>Qt.T,SharingLayoutMode:()=>rn.E,ShortcutEvent:()=>Q.rE,ShowEntityResultCode:()=>ln.w9,ShowIntentErrorCodes:()=>ln.MP,SkypeAuthErrorCode:()=>_t,SkypeMessageSource:()=>hn.q,SkypeTeamMeetingType:()=>$e,SlimCoreVdiStack:()=>me.y,SourceId:()=>Y.Xb,StageLayoutControlsCapabilities:()=>U,StartPreviewStreamErrorCodes:()=>dt,StoreListing:()=>gt,StreamToState:()=>Tn.dx,SurvivabilityTelemetryCounterType:()=>pn.B,SystemAudioDeviceCheckStatus:()=>tn.F,SystemAudioDriverState:()=>un.p,SystemAudioDriverVersions:()=>un.SystemAudioDriverVersions,SystemAudioUfd:()=>tn.S,TaskPriority:()=>bt,TaskState:()=>At,TeamsDeviceNotificationEvents:()=>J.q,TelemetryElementCategory:()=>Y.BH,Telephony:()=>Q.lF,TicketState:()=>Ce.TicketState,ToggleHoldCallContextConstantsMW:()=>S.Qz,ToolbarCloseReason:()=>M.VZ,TpdPairingResult:()=>$.hp,TpdPairingStatus:()=>$.YR,TranscriptDownloadFormat:()=>mn.TranscriptDownloadFormat,TranscriptEditType:()=>mn.TranscriptEditType,TranscriptEventType:()=>mn.TranscriptEventType,TransitionMode:()=>pn.I,UCQDeviceInfoPositions:()=>Z.q5,UnavailableBatteryStatus:()=>Ze,UpdateIntentIdErrorCodes:()=>cn.C8,UserClassification:()=>Ft,UserRoleInConsultCall:()=>qt.UserRoleInConsultCall,UserStatus:()=>Pt,VDIConnectedState:()=>he.MV,VDIDisconnectReason:()=>he.IL,VDIFeatureId:()=>he.O0,VdiProvider:()=>he.$w,VendorIds:()=>Z.O2,VideoExtensibilityResponseCode:()=>Ht,VideoMute:()=>Q.xD,VideoMuteCommand:()=>Q.Kb,VideoMuteState:()=>Q._Y,VoiceSettingsStorageKey:()=>q.VoiceSettingsStorageKey,WhiteboardErrorCode:()=>ve.WhiteboardErrorCode,WrsViewerErrorCode:()=>jt.N7,YammerGroupInfo:()=>kn.fm,YammerGroupVisibility:()=>kn.ab,YealinkIds:()=>Z.b3});var i={};n.r(i);n(892953);var a,o,r=n(203694),s=n(56136),l=n(926305),c=n(717409),d=n(592084),g=n(17110),u=n(688408),p=n(347123),C=n(147758),h=n(966203),m=n(498246),S=n(190847),v=n(860417),I=n(881359),f=n(812113),T=n(343508),y=n(785018),E=n(221170),A=n(201954),b=n(513646),M=n(870556),D=n(816639),P=n(197959),R=n(391951),N=n(853356),O=n(474906),_=n(151220),w=n(746552);!function(e){e[e.Information=0]="Information",e[e.Promo=1]="Promo",e[e.Suggestion=2]="Suggestion",e[e.Warning=3]="Warning",e[e.PromoAlt=4]="PromoAlt",e[e.Meeting=5]="Meeting",e[e.Error=6]="Error",e[e.ServiceIssue=7]="ServiceIssue",e[e.Offline=8]="Offline"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.Close=1]="Close",e[e.Timeout=2]="Timeout"}(o||(o={}));var k,F,L,B,U,G,x,V=n(275782),H=n(906712),W=n(872047),j=n(9718),$=n(808805),q=n(590764),J=n(347543),z=n(969501),K=n(671070),X=n(383209),Y=n(780670),Z=n(495804),Q=n(489219),ee=n(700828);!function(e){e.Response="response",e.KeepAlive="keepalive",e.Unpair="unpair",e.Pair="pair",e.Lock="lock",e.Unlock="unlock",e.JoinCall="joincall",e.StartCall="startcall",e.CreateAndStartCall="createandstartcall",e.DialNumber="dialnumber",e.EndCall="endcall",e.Mute="mute",e.Unmute="unmute",e.StartVideo="startvideo",e.StopVideo="stopvideo",e.StartAudio="startaudio",e.StopAudio="stopaudio",e.HoldCall="holdcall",e.UnholdCall="unholdcall",e.ReportProblem="uploadbettertogetherlogs",e.UpdateState="stateupdate",e.UpdateCapabilities="capabilityupdate",e.CameraOn="cameraon",e.CameraOff="cameraoff",e.VolumeUp="volumeup",e.VolumeDown="volumedown",e.CaptionsOff="captionsoff",e.CaptionsOn="captionson",e.ShowVideoGallery="showvideogallery",e.ShowContent="showcontent",e.ShowVideoGalleryAndContent="showvideogalleryandcontent",e.ShowLargeGallery="showlargegallery",e.ShowTogether="showtogether",e.ShowFrontRow="showfrontrow",e.LeaveMeeting="leavemeeting"}(k||(k={})),function(e){e[e.Connected=0]="Connected",e[e.PairedNotConnected=1]="PairedNotConnected",e[e.Locked=2]="Locked"}(F||(F={})),function(e){e[e.Bluetooth=0]="Bluetooth",e[e.Wired=1]="Wired"}(L||(L={})),function(e){e.ToggleMute="toggleMute",e.ToggleCamera="toggleCamera",e.Volume="volume",e.ToggleCaptions="toggleCaptions"}(B||(B={})),function(e){e.ShowVideoGallery="showVideoGallery",e.ShowContent="showContent",e.ShowVideoGalleryAndContent="showVideoGalleryAndContent",e.ShowLargeGallery="showLargeGallery",e.ShowTogether="showTogether",e.ShowFrontRow="showFrontRow"}(U||(U={})),function(e){e.LeaveMeeting="leaveMeeting"}(G||(G={})),function(e){e[e.OUT_OF_PROXIMITY=0]="OUT_OF_PROXIMITY",e[e.CONNECTION_FAILED=1]="CONNECTION_FAILED",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.COMMAND_FAILED=3]="COMMAND_FAILED"}(x||(x={}));var te,ne,ie,ae=n(940739),oe=n(952415),re=n(524060),se=n(696953),le=n(793226),ce=n(296144),de=n(317583),ge=n(40653),ue=n(192115),pe=n(785654),Ce=n(19393),he=n(2065),me=n(881989),Se=n(464473),ve=n(864405),Ie=n(809076);!function(e){e.ErrorCodeNone="None",e.ErrorCodeEndpointRequestError="EndpointRequestError",e.ErrorCodeAuthRequestError="AuthRequestError",e.ErrorCodeWebSocketConnectError="WebSocketConnectError"}(te||(te={})),function(e){e.reactions="reactions",e.presentationSharing="presentationSharing"}(ne||(ne={})),function(e){e.state="state",e.ic3="ic3"}(ie||(ie={}));var fe,Te,ye,Ee,Ae,be,Me,De,Pe,Re,Ne,Oe,_e,we,ke,Fe,Le,Be,Ue,Ge,xe,Ve,He,We,je,$e,qe,Je,ze,Ke,Xe,Ye,Ze,Qe,et,tt,nt,it,at,ot,rt,st,lt,ct,dt,gt,ut,pt,Ct,ht,mt,St,vt,It,ft,Tt,yt,Et,At,bt,Mt,Dt,Pt,Rt,Nt,Ot,_t,wt,kt,Ft,Lt,Bt,Ut,Gt,xt,Vt,Ht,Wt,jt=n(405854),$t=n(524570),qt=n(30470),Jt=n(773982),zt=n(618466),Kt=n(422254),Xt=n(824990),Yt=n(289712),Zt=n(458239),Qt=n(178831),en=n(720482),tn=n(341189),nn=n(205861),an=n(150165),on=n(273326),rn=n(454938),sn=n(811407),ln=n(576057),cn=n(352935),dn=n(680586),gn=n(285250),un=n(939419),pn=n(504441),Cn=n(961843),hn=n(772573),mn=n(776081),Sn=n(807254),vn=n(344546),In=n(793579),fn=n(447862),Tn=n(878081),yn=n(911868),En=n(17496),An=n(250295),bn=n(56484),Mn=n(386448),Dn=n(239819),Pn=n(364813),Rn=n(98705),Nn=n(50473),On=n(781473),_n=n(323360),wn=n(230620),kn=n(93997);!function(e){e.AfterHours="AfterHours",e.Holiday="Holiday"}(fe||(fe={})),function(e){e.ASK_PERMISSION_TICKET_STATE_CHANGED_EVENT="AskPermissionTicketStateChangedEvent",e.CALL_ADDED="CallAdded",e.CALL_REMOVED="CallRemoved",e.CALL_UPDATED="CallUpdated",e.DOMINANT_SPEAKER_INFO_EVENT="DominantSpeakerInfoEvent",e.STREAMING_INFO_CHANGED_EVENT="StreamingInfoChangedEvent",e.PARTICIPANTS_CHANGED="CallParticipantsChanged",e.PARTICIPANT_COUNTS_CHANGED="CallParticipantCountsChanged",e.PARTICIPANTS_VOICE_LEVELS_CHANGED="CallParticipantsVoiceLevelsChanged",e.PARTICIPANTS_MEETING_REACTIONS_RECEIVED="CallParticipantsReactions",e.RAISE_HAND_STATE_CHANGED="RaiseHandStateChanged",e.CALL_APP_CONTENT_SHARING_ADDED="CallAppContentSharingAdded",e.CALL_APP_CONTENT_SHARING_REMOVED="CallAppContentSharingRemoved",e.CALL_APP_CONTENT_SHARING_STARTED="CallAppContentSharingStarted",e.CALL_APP_CONTENT_SHARING_START_FAILED="CallAppContentSharingStartFailed",e.CALL_APP_CONTENT_SHARING_STATUS_CHANGED="CallAppContentSharingStatusChanged",e.CALL_APP_URL_CHANGED="callAppUrlChanged",e.CALL_PARTICIPANTS_MEETING_REACTIONS_LIVE_STATE="CallParticipantsMeetingReactionsLiveState",e.CALL_CHAT_BUBBLE_TOGGLE="CallChatBubbleToggle",e.CALL_ATTENDEE_RESTRICTIONS_CHANGED="CallAttendeeRestrictionsChanged",e.CALL_PARTICIPANT_AUDIO_RESTRICTIONS_CHANGED="CallParticipantAudioRestrictionsChanged",e.CALL_PARTICIPANT_VIDEO_RESTRICTIONS_CHANGED="CallParticipantVideoRestrictionsChanged",e.ATTENDEE_PARTICIPANT_RESTRICTIONS_CHANGED="AttendeeParticipantRestrictionsChanged",e.CALL_ALERTS_UPDATED="CallAlertsUpdated",e.CALL_PPTSHARING_ADDED="CallPptSharingAdded",e.WHITEBOARD_SHARING_ADDED="WhiteboardSharingAdded",e.CALL_PPTSHARING_MEDIA_UPDATED="CallPptSharingMediaEventUpdated",e.CALL_PPTSHARING_TELEMETRY_UPDATED="CallPptSharingTelemetryUpdated",e.CALL_PPTSHARING_REMOVED="CallPptSharingRemoved",e.CALL_PPTSHARING_SLIDE_CHANGED="CallPptSharingSlideChanged",e.CALL_PPTSHARING_PRIVATE_VIEWING_CHANGED="CallPptSharingPrivateViewingChanged",e.CALL_PPTSHARING_CONTENT_SHARING_STATUS_CHANGED="CallPptSharingContentSharingStatusChanged",e.CALL_PPTSHARING_CHANGE_SLIDE_CORTANA_INVOCATION="CallPptSharingChangeSlideCortanaInvocation",e.CALL_PPTSHARING_PRESENTATION_URL_READY="CallPptSharingPresentationUrlReady",e.WHITEBOARD_SHARING_CONTENT_SHARING_STATUS_CHANGED="WhiteboardSharingContentSharingStatusChanged",e.CALL_LOCAL_RECORDING_STATE_CHANGED="CallLocalRecordingStateChanged",e.CALL_ACS_RECORDING_STATUS_CHANGED="CallACSRecordingStateChanged",e.EXPLICIT_RECORDING_CONSENT_STATE_CHANGED="ExplicitRecordingConsentStateChanged",e.CALL_RECORDING_STATE_CHANGED="CallRecordingStateChanged",e.COMPLIANCE_RECORDING_STATE_CHANGED="ComplianceRecordingStateChanged",e.CALL_FULL_FRAME_REQUESTED="FullFrameRequired",e.CALL_VOICE_COLLECTION_CHANGED="CallVoiceCollectionChanged",e.CALL_CLOSED_CAPTIONS_CHANGED="CallClosedCaptionsChanged",e.CALL_COACH_CHANGED="CallCoachChanged",e.CALL_TITLE_CHANGED="CallTitleChanged",e.CALL_TRANSFERRED="CallTransferred",e.CALL_TRANSFERRED_FAILED="CallTransferredFailed",e.CALL_TRANSFERRED_SUCCEEDED="CallTransferredSucceeded",e.CALL_DEVICELIST_UPDATED="CallDeviceListUpdated",e.CALL_DEVICE_SHORTCUT_EVENT="CallDeviceShortcutEvent",e.CALL_MIC_NRGLEVELS_CHANGED="CallMicNrgLevelsChanged",e.CALL_SPEAKER_VOLUME_CHANGED="CallSpeakerVolumeChanged",e.BLURRING_CAPABILITY_CHANGED="blurringCapabilityChanged",e.HIGH_FIDELITY_AUDIO_SWITCH_CHANGED="HighFidelityAudioSwitchChanged",e.CALL_SPEAKER_MUTED_CHANGED="CallSpeakerMutedChanged",e.CALL_SPEAKER_HWMUTED_CHANGED="CallSpeakerHWMutedChanged",e.CALL_PPT_SHARING_STARTED="CallPptSharingStarted",e.NOISE_SUPPRESSION_CHANGED="NoiseSuppressionChanged",e.BIOMETRIC_ENROLLMENT_USER_ENROLLMENT_STATUS_CHANGED="BiometricEnrollmentUserEnrollmentStatusChanged",e.BIOMETRIC_ENROLLMENT_DEVICES_UPDATED="BiometricEnrollmentDevicesUpdated",e.AUTO_GAIN_CONTROL_CHANGED="AutoGainControlChanged",e.SYNC_DEVICE_BUTTONS_CHANGED="SyncDeviceButtonsChanged",e.MUSIC_MODE_SETTINGS_CHANGED="MusicModeSettingsChanged",e.IGNORE_MIRRORING_VIDEO_PREFERENCE_SETTING_CHANGED="IgnoreMirroringVideoPreferenceSettingChanged",e.TOUCH_UP_TOGGLE_CHANGED="TouchUpToggleChanged",e.TOUCH_UP_STRENGTH_CHANGED="TouchUpStrengthChanged",e.AUTO_ADJUST_TOGGLE_CHANGED="AutoAdjustToggleChanged",e.EYE_CONTACT_TOGGLE_CHANGED="EyeContactToggleChanged",e.EYE_CONTACT_CAPABILITY_CHANGED="EyeContactCapabilityChanged",e.VIDEO_EFFECT_STATE_CHANGED="VideoEffectStateChanged",e.WHITEBOARD_SHARING_STARTED="WhiteboardSharingStarted",e.ANNOTATION_CHANGED="AnnotationChanged",e.DEEPLINK_SHARING_STARTED="DeeplinkSharingStarted",e.WHITEBOARD_URL_CHANGED="WhiteboardUrlChanged",e.FILE_USERPERMISSIONS_CHANGED="FileUserPermissionsChanged",e.EXTENSIBLE_APP_CONTEXT_CHANGED="ExtensibleAppContextChanged",e.CALL_PPT_SHARING_START_FAILED="CallPptSharingStartFailed",e.WHITEBOARD_SHARING_START_FAILED="WhiteboardSharingStartFailed",e.CALL_PPT_SHARING_JOIN_FAILED="CallPptSharingJoinFailed",e.CALL_CONTENT_SHARING_JOIN_INCOMPLETE="CallContentSharingJoinIncomplete",e.HAS_ONGOING_CALLS_CHANGED="HasOngoingCallsChanged",e.SUBSCRIBED_CALL_CHANGED="SubscribedCallChanged",e.CALL_LAYOUT_CHANGED="CallLayoutChanged",e.CALLING_POLICIES_CHANGED_EVENT="CallingPoliciesChangedEvent",e.SYSTEM_AUDIO_STATE_CHANGED="SystemAudioStateChanged",e.SCREENSHARE_CONTROL_STATE_CHANGED="ScreenshareControlStateChanged",e.CALL_CONTENT_CAMERA_SHARING_CHANGED="CallContentCameraSharingChanged",e.CALL_TRANSCRIPT_STATE_EVENT="CallTranscriptStateEvent",e.CALL_TRANSCRIPT_ENTRY_EVENT="CallTranscriptEntryEvent",e.CALL_TRANSCRIPT_EDIT_EVENT="CallTranscriptEditEvent",e.CALL_AUDIENCE_SCENE_CHANGED="CallAudienceSceneChanged",e.CALL_AUDIENCE_SELECT_SCENE_ACK="CallAudienceSelectSceneAck",e.CALL_AUDIENCE_SCENE_SEATING_CHANGED="AudienceSceneSeatingChanged",e.CLOSED_CAPTIONS_ENTRY_EVENT="ClosedCaptionsEntryEvent",e.CLOSED_CAPTIONS_DYNAMIC_ENTRY_EVENT="ClosedCaptionsDynamicEntryEvent",e.ONGOING_CONSULTATION_EVENT="OngoingConsultationEvent",e.PARKED_CALLS_OR_SLA_REGISTRY_CHANGED_EVENT="ParkedCallsOrSLARegistryChangedEvent",e.CALLING_AGGREGATE_SETTINGS_CHANGED_EVENT="CallingAggregateSettingsChangedEvent",e.CALL_QUEUE_INTENT_ID_TEAMS_CALL_ID_CHANGED_EVENT="CallQueueIntentIdTeamsCallIdChangedEvent",e.ESCALATED_CALL_CONVERSATION_CHANGED_EVENT="EscalatedCallConversationChangedEvent",e.TEAMS_CALL_ID_CHANGED="TeamsCallIdChanged",e.VIDEO_AVAILABLE_FOR_CONVERSATION_CHANGED="VideoAvailableForConversationChanged",e.CALL_INCOMING_VIDEO_ON_CHANGED="CallIncomingVideoOnChanged",e.CALLING_INTENT_EVENT="CallingIntentEvent",e.CALLING_WINDOWING_CONTENT_CHANGED_EVENT="CallingWindowingContentChangedEvent",e.COMPANION_STREAM_ADDED_EVENT="CompanionStreamAdded",e.COMPANION_STREAM_REMOVED_EVENT="CompanionStreamRemoved",e.CALL_HOLOGRAPHIC_ANNOTATION_EVENT="CallHolographicAnnotationEvent",e.CALL_HOLOGRAPHIC_CALL_STATE_CHANGED="CallHolographicCallStateChanged",e.CALLING_ALLOWED_EVENT="IsCallingAllowedChanged",e.HARDWARE_OUT_DEVICE_CHANGED="HardwareOutDeviceChanged",e.PSTN_CALLING_ALLOWED_EVENT="IsPSTNCallingAllowedChanged",e.SCD_STATUS_UPDATE="ScdStatusUpdate",e.BUDDY_GROUP_UPDATED_EVENT="buddyGroupChanged",e.BUDDY_GROUPS_CHANGED_EVENT="buddyGroupsChangedEvent",e.CALL_TECHNICAL_INFO_EVENT="CallTechnicalInfoEvent",e.DELEGATE_SETTINGS_CHANGED="DelegateSettingChanged",e.CALLABLE_CHANNEL_UPDATED_EVENT="CallableChannelUpdated",e.OVERFLOW_ROOM_CALL_STATE_CHANGE="OverflowRoomCallStateChange",e.OVERFLOW_ROOM_FOUND_FOR_INTENT_EVENT="OverflowRoomFoundForIntentEvent",e.CALLING_SCREEN_STATUS_CHANGED="CallingScreenStatusChanged",e.MEETING_JOIN_FROM_TEAMS_DEVICE_EVENT="MeetingJoinFromTeamsDeviceEvent",e.CALLING_CLIENT_STATE_EVENT="CallingClientStateEvent",e.CALL_COMPOSITOR_FAILED_EVENT="CallCompositorFailedEvent",e.SLA_CALLS_CHANGED="SLACallsChanged",e.SPATIAL_AUDIO_CONFIGS_CHANGED="SpatialAudioConfigsChanged",e.SPATIAL_AUDIO_TOGGLE_CHANGED="SpatialAudioToggleChanged",e.START_STREAM_EVENT="VideoStreamStarted",e.CALLING_LOCAL_MEDIA_STREAM_EVENT="CallingLocalMediaStreamEvent",e.ACTIVE_CALLS_CHANGED_EVENT="ActiveCallsChanged",e.CONNECTED_CALLS_CHANGED_EVENT="ConnectedCallsChanged",e.NETWORK_ROAMING_POLICY_CHANGED_EVENT="NetworkRoamingPolicyChangedEvent",e.CALL_HEALTH_CATEGORIES_UPDATED_EVENT="callHealthCategoriesUpdatedEvent",e.EMERGENCY_ADDRESS_UPDATED_EVENT="emergencyAddressUpdatedEvent",e.CALL_FORWARDING_SETTINGS_CHANGED_EVENT="callForwardingSettingsChangedEvent",e.EMERGENCY_CUSTOM_DISCLAIMER_UPDATED_EVENT="emergencyCustomDisclaimerUpdatedEvent",e.PTZ_REMOTE_PARTICIPANTS_CHANGED="PtzRemoteParticipantsChanged",e.PTZ_HANDLER_FAILED="PtzHandlerFailed",e.PTZ_REMOTE_CONTROL_DEVICE_STATE_CHANGED="PtzRemoteControlDeviceStateChanged",e.PTZ_SESSION_STATUS_CHANGED="PtzSessionStatusChanged",e.CALL_FRAME_SIZE_CHANGED="FrameSizeChanged",e.E2EE_STATUS_CHANGED_EVENT="E2eeStatusChangedEvent",e.LIVE_STREAM_CHANGED_EVENT="LiveStreamChangedEvent",e.HAS_ONGOINGCALLS_CHANGED_EVENT="hasOngoingCallsChangedEvent",e.CALL_MUTE_NOTIFICATIONS_CHANGED_EVENT="callMuteNotificationsChangedEvent",e.GESTURE_BASED_REACTION_EVENT="GestureBasedReactionEvent",e.VIDEO_CAPABILITY_LIMITS_CHANGED_EVENT="VideoCapabilityLimitsChangedEvent",e.VIDEO_LAYOUT_API_CAPABILITIES_CHANGED_EVENT="VideoLayoutCapabilitiesChangedEvent",e.ROOM_REMOTE_STATE_UPDATE_EVENT="roomRemoteStateUpdateEvent",e.ROOM_REMOTE_CAPABILITIES_UPDATE_EVENT="roomRemoteCapabilitiesUpdateEvent",e.ROOM_REMOTE_PROXIMITY_BANNER_EVENT="roomRemoteProximityBannerEvent",e.FRAME_SINK_EVENTS_CHANGED_EVENT="framesinkEventsChangedEvent",e.VIDEO_EFFECT_READINESS_CHANGED="videoEffectReadinessChanged",e.WINDOWS_EFFECTS_CAPABILITY_CHANGED="windowsEffectsCapabilityChanged",e.VIDEO_EFFECT_CAPABILITIES_CHANGED="videoEffectCapabilitiesChanged",e.PARTICIPANTS_ON_CALL_CONNECTED="participantsOnCallConnected",e.THIRD_PARTY_DEVICE_PAIRING_REQUEST="thirdPartyDevicePairingRequest",e.THIRD_PARTY_DEVICE_MEETING_REACTION_REQUEST="thirdPartyDeviceMeetingReactionRequest",e.THIRD_PARTY_DEVICE_TOGGLE_REQUEST="thirdPartyDeviceToggleRequest",e.CURRENT_SEAT_MAPPING_CHANGED_EVENT="currentSeatMappingChangedEvent",e.AUDIO_STOPPED_EVENT="AudioStoppedEvent",e.VIDEO_EXTENSIBILITY_PERFORMANCE_EVENT="videoExtensibilityPerformanceEvent",e.VIDEO_EXTENSIBILITY_LIFECYCLE_EVENT="videoExtensibilityLifecycleEvent",e.IMMERSIVE_VIEW_CHANGED_EVENT="immersiveViewChangedEvent",e.ATTENDEE_COUNT_UPDATED="AttendeeCountUpdated",e.QNA_FEED_UPDATED="QnaFeedUpdated"}(Te||(Te={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(ye||(ye={})),function(e){e.Grid="Grid",e.LargeGrid="LargeGrid",e.Audience="Audience",e.FrontRow="FrontRow",e.ContentOnly="ContentOnly",e.ContentAndPeople="ContentAndPeople",e.PeopleOnly="PeopleOnly"}(Ee||(Ee={})),function(e){e[e.GroupCreated=0]="GroupCreated",e[e.GroupRenamed=1]="GroupRenamed",e[e.GroupDeleted=2]="GroupDeleted",e[e.GroupMembersUpdated=3]="GroupMembersUpdated"}(Ae||(Ae={})),function(e){e[e.Unknown=0]="Unknown",e[e.Online=1]="Online",e[e.OnPrem=2]="OnPrem"}(be||(be={})),function(e){e[e.Presenting=0]="Presenting",e[e.InCall=1]="InCall",e[e.InBroadcast=2]="InBroadcast",e[e.Interactive=3]="Interactive",e[e.Inactive=4]="Inactive",e[e.LongInactive=5]="LongInactive",e[e.Disabled=6]="Disabled",e[e.Disconnected=7]="Disconnected",e[e.Offline=8]="Offline",e[e.Uninitialized=9]="Uninitialized"}(Me||(Me={})),function(e){e[e.MachineActive=1]="MachineActive",e[e.MachineInactive=2]="MachineInactive",e[e.MachineLongInactive=4]="MachineLongInactive",e[e.MachineLocked=8]="MachineLocked"}(De||(De={})),function(e){e.Connecting="Connecting",e.Connected="Connected",e.Disconnected="Disconnected"}(Pe||(Pe={})),function(e){e[e.NotSupported=1]="NotSupported",e[e.FullySupported=2]="FullySupported"}(Re||(Re={})),function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(Ne||(Ne={})),function(e){e[e.Exchange=0]="Exchange",e[e.BuddyList=1]="BuddyList",e[e.MiddleTier=2]="MiddleTier",e[e.SerializedData=3]="SerializedData"}(Oe||(Oe={})),function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Info=3]="Info",e[e.Debug=4]="Debug",e[e.Verbose=5]="Verbose",e[e.Max=6]="Max"}(_e||(_e={})),function(e){e[e.Strict=0]="Strict",e[e.Moderate=1]="Moderate",e[e.NoRestriction=2]="NoRestriction"}(we||(we={})),function(e){e.Rendering="Rendering",e.FirstFrameRendered="FirstFrameRendered",e.Stopped="Stopped"}(ke||(ke={})),function(e){e[e.None=0]="None",e[e.Team=1]="Team",e[e.Chat=2]="Chat"}(Fe||(Fe={})),function(e){e[e.SfC=0]="SfC",e[e.Tfl=1]="Tfl",e[e.Unknown=2]="Unknown"}(Le||(Le={})),function(e){e[e.Content=0]="Content",e[e.Cards=1]="Cards",e[e.Files=2]="Files"}(Be||(Be={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.HIGH=2]="HIGH",e[e.URGENT=3]="URGENT"}(Ue||(Ue={})),function(e){e[e.Unknown=0]="Unknown",e[e.Windows=1]="Windows",e[e.Mac=2]="Mac",e[e.Linux=3]="Linux"}(Ge||(Ge={}));class Fn{}Fn.Type_CalendarUpdated="calendar-events-updated";class Ln{}Ln.EventType_Batched=r.R.Type_List,Ln.EventType_TopicChanged=r.R.Type_Conversation;class Bn{}Bn.Type_Conversation="%conversation",function(e){e[e.MsftTeamsRoom=0]="MsftTeamsRoom",e[e.PersonalClient=1]="PersonalClient",e[e.CompanionDevice=2]="CompanionDevice"}(xe||(xe={})),function(e){e[e.None=0]="None",e[e.Network=1]="Network",e[e.Local=2]="Local"}(Ve||(Ve={})),function(e){e[e.RoleCheckFail=5625]="RoleCheckFail"}(He||(He={})),function(e){e[e.None=0]="None",e[e.FreezeFrame=1]="FreezeFrame",e[e.GroupCall=2]="GroupCall",e[e.IsNonARDevice=4]="IsNonARDevice"}(We||(We={})),function(e){e[e.E164=0]="E164",e[e.INTERNATIONAL=1]="INTERNATIONAL",e[e.NATIONAL=2]="NATIONAL",e[e.RFC3966=3]="RFC3966"}(je||(je={})),function(e){e[e.Scheduled=0]="Scheduled",e[e.Broadcast=1]="Broadcast",e[e.Adhoc=2]="Adhoc",e[e.Recurring=3]="Recurring",e[e.MeetNow=4]="MeetNow"}($e||($e={})),function(e){e[e.None=0]="None",e[e.Daily=1]="Daily",e[e.Weekly=2]="Weekly",e[e.Monthly=3]="Monthly",e[e.RelativeMonthly=4]="RelativeMonthly",e[e.Yearly=5]="Yearly",e[e.RelativeYearly=6]="RelativeYearly"}(qe||(qe={})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(Je||(Je={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last"}(ze||(ze={})),function(e){e[e.January=1]="January",e[e.February=2]="February",e[e.March=3]="March",e[e.April=4]="April",e[e.May=5]="May",e[e.June=6]="June",e[e.July=7]="July",e[e.August=8]="August",e[e.September=9]="September",e[e.October=10]="October",e[e.November=11]="November",e[e.December=12]="December"}(Ke||(Ke={})),function(e){e[e.userEventUsingEventId=0]="userEventUsingEventId",e[e.teamEventUsingEventId=1]="teamEventUsingEventId",e[e.userEventUsingICalUId=2]="userEventUsingICalUId",e[e.teamEventUsingICalUId=3]="teamEventUsingICalUId",e[e.userSeriesEventUsingOccurenceEventId=4]="userSeriesEventUsingOccurenceEventId"}(Xe||(Xe={})),function(e){e.ItemAttachment="ItemAttachment",e.FileAttachment="FileAttachment",e.ReferenceAttachment="ReferenceAttachment"}(Ye||(Ye={})),function(e){e[e.Initializing=0]="Initializing",e[e.NotAvailable=1]="NotAvailable"}(Ze||(Ze={})),function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.OK=200]="OK",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultipleChoices=300]="MultipleChoices",e[e.Ambiguous=300]="Ambiguous",e[e.MovedPermanently=301]="MovedPermanently",e[e.Moved=301]="Moved",e[e.Found=302]="Found",e[e.Redirect=302]="Redirect",e[e.SeeOther=303]="SeeOther",e[e.RedirectMethod=303]="RedirectMethod",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.RedirectKeepVerb=307]="RedirectKeepVerb",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.RequestUriTooLong=414]="RequestUriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.Throttle=429]="Throttle",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported"}(Qe||(Qe={})),function(e){e[e.AcceptIncomingCallWithVideo=0]="AcceptIncomingCallWithVideo",e[e.AcceptIncomingCallWithAudio=1]="AcceptIncomingCallWithAudio",e[e.AcceptIncomingScreenshareOnlyCall=2]="AcceptIncomingScreenshareOnlyCall",e[e.RejectIncomingCall=6]="RejectIncomingCall",e[e.RejectIncomingScreenshareOnlyCall=7]="RejectIncomingScreenshareOnlyCall",e[e.OpenChatList=13]="OpenChatList",e[e.GoToCurrentCall=21]="GoToCurrentCall",e[e.ToggleMuteCurrentCall=22]="ToggleMuteCurrentCall",e[e.ToggleVideoCurrentCall=23]="ToggleVideoCurrentCall",e[e.ToggleVideoSharingCurrentCall=24]="ToggleVideoSharingCurrentCall",e[e.ToggleBackgroundBlurCurrentCall=25]="ToggleBackgroundBlurCurrentCall",e[e.JoinMeetingFromToast=116]="JoinMeetingFromToast",e[e.PushToTalk=100]="PushToTalk"}(et||(et={})),function(e){e[e.None=0]="None",e[e.FreshNavigation=1]="FreshNavigation",e[e.InplaceNavigation=2]="InplaceNavigation"}(tt||(tt={})),function(e){e[e.none=0]="none",e[e.pending=1]="pending",e[e.recording=2]="recording",e[e.paused=3]="paused",e[e.stopping=4]="stopping",e[e.failed=5]="failed",e[e.disabled=6]="disabled",e[e.waitingformeetinglive=7]="waitingformeetinglive",e[e.waiting=8]="waiting"}(nt||(nt={})),function(e){e.Default="Default",e.HostMode="HostMode",e.Unknown="Unknown"}(it||(it={})),function(e){e.ChunkLoadTimedOut="ChunkLoadTimedOut"}(at||(at={})),function(e){e.stateChanged="stateChanged",e.initialize="initialize",e.destroyed="destroyed"}(ot||(ot={})),function(e){e.Ready="ready",e.Listening="listening",e.Thinking="thinking",e.Speaking="speaking"}(rt||(rt={})),function(e){e[e.Small=1]="Small",e[e.Medium=2]="Medium",e[e.Large=3]="Large"}(st||(st={})),function(e){e.GalleryAndContent="GalleryAndContent",e.Gallery="Gallery",e.Content="Content",e.Main="Main"}(lt||(lt={})),function(e){e[e.Idle=0]="Idle",e[e.InMeeting=1]="InMeeting",e[e.Incoming=2]="Incoming"}(ct||(ct={})),function(e){e.FailedToCreatePreviewRenderer="failed-to-create-preview-renderer"}(dt||(dt={})),function(e){e[e.Unrecognized=0]="Unrecognized",e[e.Local=1]="Local",e[e.Devspaces=2]="Devspaces",e[e.Alpha=3]="Alpha"}(gt||(gt={})),function(e){e[e.Unset=0]="Unset",e[e.Basic=1]="Basic",e[e.Full=2]="Full",e[e.Zero=3]="Zero"}(ut||(ut={})),function(e){e[e.ToastBody=0]="ToastBody",e[e.ToastButton=1]="ToastButton",e[e.ToastDismiss=2]="ToastDismiss",e[e.TimeOut=3]="TimeOut",e[e.Error=4]="Error"}(pt||(pt={})),function(e){e[e.All=0]="All",e[e.CallMentionChats=1]="CallMentionChats",e[e.Off=2]="Off"}(Ct||(Ct={})),function(e){e.Chat="chat",e.File="file",e.Call="call",e.Tab="tab",e.Broadcast="broadcast"}(ht||(ht={})),function(e){e[e.Ring=0]="Ring",e[e.Mute=1]="Mute",e[e.Banner=2]="Banner"}(mt||(mt={})),function(e){e[e.Immediate=0]="Immediate",e[e.Simultaneous=1]="Simultaneous",e[e.Unanswered=2]="Unanswered"}(St||(St={})),function(e){e[e.Voicemail=0]="Voicemail",e[e.SingleTarget=1]="SingleTarget",e[e.MyDelegates=2]="MyDelegates",e[e.DoNothing=3]="DoNothing"}(vt||(vt={})),function(e){e[e.Voicemail=0]="Voicemail",e[e.SingleTarget=1]="SingleTarget",e[e.MyDelegates=2]="MyDelegates",e[e.DoNothing=3]="DoNothing",e[e.Group=4]="Group"}(It||(It={})),function(e){e[e.EXTERNAL_CALLING_SCREEN_FRAME_SINK_EMIT=1]="EXTERNAL_CALLING_SCREEN_FRAME_SINK_EMIT",e[e.EXTERNAL_CALLING_SCREEN_FRAME_SINK_INVOKE=2]="EXTERNAL_CALLING_SCREEN_FRAME_SINK_INVOKE",e[e.EXTERNAL_CALLING_SCREEN_VIDEO_RENDERER_EMIT=3]="EXTERNAL_CALLING_SCREEN_VIDEO_RENDERER_EMIT",e[e.EXTERNAL_CALLING_SCREEN_VIDEO_RENDERER_INVOKE=4]="EXTERNAL_CALLING_SCREEN_VIDEO_RENDERER_INVOKE"}(ft||(ft={})),function(e){e[e.Saving=0]="Saving",e[e.Sending=1]="Sending",e[e.Uploading=2]="Uploading",e[e.Downloading=3]="Downloading",e[e.CallingOrMeeting=4]="CallingOrMeeting",e[e.Moving=5]="Moving",e[e.Copying=6]="Copying",e[e.CallingOrchestration=7]="CallingOrchestration"}(Tt||(Tt={})),function(e){e[e.Wiki=0]="Wiki",e[e.Files=1]="Files",e[e.Calling=2]="Calling"}(yt||(yt={})),function(e){e[e.AutoSaving=0]="AutoSaving",e[e.Downloading=1]="Downloading",e[e.Uploading=2]="Uploading",e[e.Meeting=3]="Meeting",e[e.Broadcast=4]="Broadcast",e[e.OneOnOne=5]="OneOnOne",e[e.Moving=6]="Moving",e[e.Copying=7]="Copying"}(Et||(Et={})),function(e){e[e.Pending=0]="Pending",e[e.Executing=1]="Executing",e[e.Completed=2]="Completed"}(At||(At={})),function(e){e[e.RealTime=0]="RealTime",e[e.High=1]="High",e[e.Normal=2]="Normal",e[e.Background=3]="Background"}(bt||(bt={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.SignedOut=1]="SignedOut",e[e.SigningIn=2]="SigningIn",e[e.SignedIn=3]="SignedIn",e[e.SigningOut=4]="SigningOut",e[e.ShuttingDown=5]="ShuttingDown"}(Mt||(Mt={})),function(e){e[e.Low=1]="Low",e[e.Medium=4]="Medium",e[e.High=16]="High"}(Dt||(Dt={})),function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Busy=2]="Busy",e[e.Away=3]="Away",e[e.Idle=4]="Idle",e[e.OnThePhone=5]="OnThePhone",e[e.OutToLunch=6]="OutToLunch",e[e.BeRightBack=7]="BeRightBack",e[e.Hidden=8]="Hidden",e[e.Disabled=9]="Disabled",e[e.AppearAway=10]="AppearAway",e[e.Reset=11]="Reset",e[e.OutOfOffice=12]="OutOfOffice",e[e.Presenting=13]="Presenting",e[e.InAMeeting=14]="InAMeeting",e[e.Unknown=15]="Unknown",e[e.OnShift=16]="OnShift",e[e.OffShift=17]="OffShift",e[e.Focusing=18]="Focusing",e[e.Blocked=19]="Blocked",e[e.AppearOffline=20]="AppearOffline"}(Pt||(Pt={})),function(e){e.disabled="Disabled",e.enabledUserOverride="EnabledUserOverride",e.disabledUserOverride="DisabledUserOverride"}(Rt||(Rt={})),function(e){e[e.Unknown=0]="Unknown",e[e.UnsupportedCommandServiceMethod=98]="UnsupportedCommandServiceMethod"}(Nt||(Nt={})),function(e){e[e.None=0]="None",e[e.Organizer=1]="Organizer",e[e.Tentative=2]="Tentative",e[e.Accepted=3]="Accepted",e[e.Declined=4]="Declined",e[e.NotResponded=5]="NotResponded"}(Ot||(Ot={})),function(e){e[e.AdminUserLicenseNotPresentForbidden=0]="AdminUserLicenseNotPresentForbidden",e[e.AdminTeamsDisabledForTenantForbidden=1]="AdminTeamsDisabledForTenantForbidden",e[e.UserLicenseNotPresentForbidden=2]="UserLicenseNotPresentForbidden",e[e.TeamsDisabledForTenantForbidden=3]="TeamsDisabledForTenantForbidden",e[e.UserLicenseNotPresentTrialEligible=4]="UserLicenseNotPresentTrialEligible",e[e.TrialLicenseTenantNotReady=5]="TrialLicenseTenantNotReady",e[e.NewFederatedUsersNotAllowed=6]="NewFederatedUsersNotAllowed"}(_t||(_t={})),function(e){e.searchSuggestions="searchSuggestions",e.searchResults="searchResults",e.addToChat="addToChat",e.addToTeam="addToTeam",e.newChat="newChat",e.escalateMessage="escalateMessage",e.transfer="transfer",e.addToCall="addToCall",e.callRouting="callRouting",e.callForwardGroupSelection="callForwardGroupSelection",e.delegationSelection="delegationSelection",e.presenceSettings="presenceSettings",e.addToMeeting="addToMeeting",e.meetingSchedule="meetingSchedule",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.atMention="atMention",e.atMentionSC="atMentionSharedChannels",e.orgChart="orgChart",e.priorityContactsSelection="priorityContactsSelection",e.taggedContactsSelection="taggedContactsSelection",e.statusNote="statusNote",e.voicemailTransferTarget="voicemailTransferTarget",e.searchExpoDisplays="searchExpoDisplays",e.rigelMeeting="rigelMeeting",e.addToSurfaceHubPrivateMeeting="addToSurfaceHubPrivateMeeting",e.sharedChannel="sharedChannel",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.aadTenant="aadTenant",e.adaptiveCard="adaptiveCard",e.selectPeoplePicker="selectPeoplePicker",e.allFalse="allFalse",e.allTrue="allTrue",e.custom="custom",e.default="default"}(wt||(wt={})),function(e){e[e.None=0]="None",e[e.Reserved=1]="Reserved",e[e.Dynamic=2]="Dynamic"}(kt||(kt={})),function(e){e[e.Principal=1]="Principal",e[e.Manager=2]="Manager",e[e.Peer=3]="Peer",e[e.InOrg=4]="InOrg"}(Ft||(Ft={})),function(e){e[e.callHistory=0]="callHistory",e[e.callVoicemail=1]="callVoicemail",e[e.callSpeedDial=2]="callSpeedDial"}(Lt||(Lt={})),function(e){e.Mobile="Mobile",e.Business="Business",e.Other="Other",e.Home="Home"}(Bt||(Bt={})),function(e){e[e.E2EE_UNSUPPORTED_CLIENT_FAILURE=6150]="E2EE_UNSUPPORTED_CLIENT_FAILURE"}(Ut||(Ut={})),function(e){e.MostSevere="MostSevere",e.Live="Live",e.Severe="Severe",e.Positive="Positive",e.Neutral="Neutral"}(Gt||(Gt={})),function(e){e.BannerNotification="BannerNotification"}(xt||(xt={})),function(e){e.none="none",e.setLayout="setLayout",e.start="start",e.stop="stop",e.switchPrimary="switchPrimary",e.failoverInstance="instanceFailover",e.updateMediaState="updateMediaState",e.restart="restart"}(Vt||(Vt={})),function(e){e[e.successResponse=0]="successResponse",e[e.toggleEffectFailure=-1]="toggleEffectFailure",e[e.noCameraFailure=-2]="noCameraFailure",e[e.slimcoreNoBinding=-3]="slimcoreNoBinding"}(Ht||(Ht={})),function(e){e[e.AttendanceReportDisabledInERCMeeting=5238]="AttendanceReportDisabledInERCMeeting",e[e.TrackInReportDisabledInERCMeeting=5239]="TrackInReportDisabledInERCMeeting"}(Wt||(Wt={}))},19393:(e,t,n)=>{var i;n.r(t),n.d(t,{TicketState:()=>i,AskPermissionTicket:()=>a}),function(e){e[e.WaitingForBrowser=0]="WaitingForBrowser",e[e.WaitingForUser=1]="WaitingForUser",e[e.Approved=2]="Approved",e[e.Denied=3]="Denied",e[e.Expired=4]="Expired",e[e.Deficient=5]="Deficient",e[e.NotSupported=6]="NotSupported"}(i||(i={}));class a{constructor(e,t){this.requestedConstraints=e,this.state=i.WaitingForBrowser,this.deviceConstraints={audio:!1,video:!1},this.permissions={audio:!1,video:!1},this.asObservable=t.createObservable(),this.id="ticket_"+a.ticketIdCounter++}setState(e){this.state!==i.Expired&&e!==this.state&&(this.state=e,this.asObservable.trigger())}getConstraints(){return{audio:this.requestedConstraints.audio&&this.deviceConstraints.audio,video:this.requestedConstraints.video&&this.deviceConstraints.video}}isDeficient(){return this.state===i.Deficient&&(!this.permissions.audio&&this.deviceConstraints.audio||!this.permissions.video&&this.deviceConstraints.video)}}a.ticketIdCounter=0},495804:(e,t,n)=>{var i,a,o,r,s,l,c,d,g,u,p,C,h,m,S,v,I,f,T,y,E;n.d(t,{O2:()=>i,J_:()=>a,S6:()=>o,em:()=>r,Td:()=>s,b3:()=>l,uM:()=>c,Xb:()=>d,FC:()=>g,n6:()=>u,Rr:()=>p,Ab:()=>C,S7:()=>h,rk:()=>m,UA:()=>S,EX:()=>v,h_:()=>I,q5:()=>f,Yn:()=>T,sD:()=>y,rC:()=>E}),function(e){e[e.EPOSSennheiser=5013]="EPOSSennheiser",e[e.Microsoft=1118]="Microsoft",e[e.Plantronics=1151]="Plantronics",e[e.Jabra=2830]="Jabra",e[e.Polycom=2397]="Polycom",e[e.Logitech=1133]="Logitech",e[e.AndreaCommunications=2216]="AndreaCommunications",e[e.Yealink=27027]="Yealink",e[e.HP=1008]="HP",e[e.Lenovo=6127]="Lenovo",e[e.Bose=1447]="Bose",e[e.Crestron=5310]="Crestron",e[e.Biamp=10470]="Biamp",e[e.Dell=16700]="Dell",e[e.Sony=1356]="Sony",e[e.Cisco=1446]="Cisco",e[e.BangAndOlufSen=3284]="BangAndOlufSen",e[e.AudioCodes=3430]="AudioCodes",e[e.Anker=10522]="Anker",e[e.Sennheiser=4983]="Sennheiser"}(i||(i={})),function(e){e[e.UC700=41744]="UC700"}(a||(a={})),function(e){e[e.Slice=3430]="Slice"}(o||(o={})),function(e){e[e.HUB500=40983]="HUB500",e[e.HUB700=40984]="HUB700"}(r||(r={})),function(e){e[e.LifeCamStudioa=1906]="LifeCamStudioa",e[e.LifeChatLX4000=1918]="LifeChatLX4000",e[e.LifeChatLX6000=1919]="LifeChatLX6000",e[e.LifeCamStudiob=2065]="LifeCamStudiob",e[e.SurfaceHeadPhones=2488]="SurfaceHeadPhones"}(s||(s={})),function(e){e[e.CP900=45065]="CP900",e[e.MVC800=45066]="MVC800",e[e.MVC500=45067]="MVC500",e[e.WH66=45099]="WH66",e[e.WH67=45130]="WH67",e[e.MP45=45192]="MP45",e[e.MP50=45120]="MP50",e[e.CP700=45083]="CP700",e[e.BT50=45093]="BT50",e[e.BT51=45572]="BT51"}(l||(l={})),function(e){e[e.C720Ma=267]="C720Ma",e[e.C720Mb=293]="C720Mb",e[e.C720Mc=298]="C720Mc",e[e.C710M=314]="C710M",e[e.C720Md=316]="C720Md",e[e.BT600v1=763]="BT600v1",e[e.BT600v2=759]="BT600v2",e[e.SAVIOFFICE=1041]="SAVIOFFICE",e[e.P540M=2577]="P540M",e[e.C620M=43521]="C620M",e[e.C420M=43541]="C420M",e[e.D100M=43793]="D100M",e[e.SAVI7XX=44033]="SAVI7XX",e[e.APU75=44808]="APU75",e[e.ENCOREPRO535=44809]="ENCOREPRO535",e[e.C220M=49154]="C220M",e[e.C320M=49189]="C320M",e[e.C520Mb=49176]="C520Mb",e[e.C510M=49178]="C510M",e[e.C520=49205]="C520",e[e.C520Ma=49206]="C520Ma",e[e.Calisto800Series=51712]="Calisto800Series",e[e.USBHeadSet=55873]="USBHeadSet",e[e.Calisto3200=341]="Calisto3200"}(c||(c={})),function(e){e[e.EVOLVE20SEMS=770]="EVOLVE20SEMS",e[e.EVOLVELINKMS=773]="EVOLVELINKMS",e[e.EVOLVELINK=774]="EVOLVELINK",e[e.EVOKE65=782]="EVOKE65",e[e.VOICE550_A=840]="VOICE550_A",e[e.VOICE750_A=844]="VOICE750_A",e[e.SPEAK410USB_B=1040]="SPEAK410USB_B",e[e.SPEAK410USB_A=1042]="SPEAK410USB_A",e[e.SPEAK510USB_A=1056]="SPEAK510USB_A",e[e.SPEAK510USB_B=1058]="SPEAK510USB_B",e[e.VOICE750MS=1874]="VOICE750MS",e[e.BIZ2400=2314]="BIZ2400",e[e.PRO930=4110]="PRO930",e[e.PRO935=4152]="PRO935",e[e.PRO9470=4162]="PRO9470",e[e.GN2000OC_A=8196]="GN2000OC_A",e[e.GN2000OC_B=8199]="GN2000OC_B",e[e.LINK260MS=8986]="LINK260MS",e[e.BIZ2400II=9299]="BIZ2400II",e[e.SPEAK810_A=9300]="SPEAK810_A",e[e.SPEAK810_B=9302]="SPEAK810_B",e[e.LINK370=9310]="LINK370",e[e.SPEAK710USB_A=9333]="SPEAK710USB_A",e[e.SPEAK710USB_B=9334]="SPEAK710USB_B",e[e.LINK360=41797]="LINK360",e[e.SPEAK710USB_C=9377]="SPEAK710USB_C",e[e.SPEAK710_WIRELESS=9390]="SPEAK710_WIRELESS",e[e.ENGAGE75=1113]="ENGAGE75",e[e.SPEAK750=9392]="SPEAK750"}(d||(d={})),function(e){e[e.VoxBox=80]="VoxBox",e[e.CX300=37377]="CX300",e[e.CCX350=37543]="CCX350",e[e.CCX400=37440]="CCX400",e[e.CCX500=37456]="CCX500",e[e.CCX505=37541]="CCX505",e[e.TRIO8800=37152]="TRIO8800",e[e.TRIO8500=37168]="TRIO8500",e[e.Studio=9217]="Studio"}(g||(g={})),function(e){e[e.HEADSETFORLYNC=43]="HEADSETFORLYNC",e[e.SC60=53]="SC60",e[e.SC660=55]="SC660",e[e.DuplexUSBforLync=63]="DuplexUSBforLync",e[e.SP20=65]="SP20",e[e.SCx5=96]="SCx5",e[e.D10=29706]="D10",e[e.SP30=109]="SP30"}(u||(u={})),function(e){e[e.CC3000e=2118]="CC3000e",e[e.H086e=2158]="H086e",e[e.H570e=2646]="H570e",e[e.H650e=2630]="H650e",e[e.H820e=2633]="H820e",e[e.ConferenceCamConnect=2124]="ConferenceCamConnect",e[e.ConferenceCamConnectVideo=2123]="ConferenceCamConnectVideo",e[e.Group=2178]="Group",e[e.GroupSpeaker=2135]="GroupSpeaker",e[e.GroupVideo=2136]="GroupVideo",e[e.Meetup=2151]="Meetup",e[e.MeetupVideo=2150]="MeetupVideo",e[e.Rally=2181]="Rally",e[e.SpeakerPhoneDock=2764]="SpeakerPhoneDock",e[e.ZonesSuperUnified=2728]="ZonesSuperUnified",e[e.ZonesWired=2733]="ZonesWired",e[e.ZoneWireless=2704]="ZoneWireless"}(p||(p={})),function(e){e[e.PureAudioSA=23]="PureAudioSA"}(C||(C={})),function(e){e[e.C2422HE=49163]="C2422HE",e[e.C2722DE=49165]="C2722DE",e[e.C3422WE=49167]="C3422WE",e[e.BT100Audio1=33281]="BT100Audio1",e[e.BT100Audio2=33282]="BT100Audio2",e[e.BT100Audio3=33283]="BT100Audio3"}(h||(h={})),function(e){e[e.OFF=0]="OFF",e[e.ON=1]="ON"}(m||(m={})),function(e){e[e.open=1]="open",e[e.close=2]="close",e[e.startRinging=3]="startRinging",e[e.stopRinging=4]="stopRinging",e[e.hook=5]="hook",e[e.offHook=6]="offHook",e[e.hold=7]="hold",e[e.resume=8]="resume",e[e.mute=9]="mute",e[e.unmute=10]="unmute",e[e.unsupported=11]="unsupported",e[e.selectDriver=12]="selectDriver",e[e.periodicSync=13]="periodicSync",e[e.aspRequest=14]="aspRequest",e[e.aspResponse=15]="aspResponse",e[e.aspConnection=16]="aspConnection",e[e.pushNotification=17]="pushNotification",e[e.pullNotificationContext=18]="pullNotificationContext",e[e.pushCallState=19]="pushCallState",e[e.teamsButtonClicked=20]="teamsButtonClicked",e[e.requestCallStartTelemetry=21]="requestCallStartTelemetry",e[e.requestDeviceChangeTelemetry=22]="requestDeviceChangeTelemetry",e[e.requestBTDeviceUpdateTelemetry=23]="requestBTDeviceUpdateTelemetry",e[e.requestPeriodicDataFromSelectedDeviceTelemetry=24]="requestPeriodicDataFromSelectedDeviceTelemetry",e[e.deviceTriggeredTelemetry=25]="deviceTriggeredTelemetry",e[e.reject=26]="reject",e[e.deskphoneSetup=27]="deskphoneSetup",e[e.vendorExtension=28]="vendorExtension",e[e.displayAttribute=29]="displayAttribute",e[e.displaySetup=30]="displaySetup",e[e.displayControlReport=31]="displayControlReport",e[e.characterAttributes=32]="characterAttributes",e[e.flash=33]="flash",e[e.dtmfDigitReceived=34]="dtmfDigitReceived",e[e.pushDynamicBandwidthNotification=35]="pushDynamicBandwidthNotification",e[e.hidConfiguration=36]="hidConfiguration",e[e.videoMute=37]="videoMute",e[e.peopleFeed=38]="peopleFeed",e[e.pptLaserPointLongPressed=39]="pptLaserPointLongPressed",e[e.pptLaserPointReleased=40]="pptLaserPointReleased",e[e.pptPrevSlidePressed=41]="pptPrevSlidePressed",e[e.pptNextSlidePressed=42]="pptNextSlidePressed",e[e.shortcutButtonContextPptLiveInactive=43]="shortcutButtonContextPptLiveInactive",e[e.shortcutButtonContextPptLiveActive=44]="shortcutButtonContextPptLiveActive",e[e.contentCamera=45]="contentCamera"}(S||(S={})),function(e){e[e.IdleCall=0]="IdleCall",e[e.ReadyToCall=1]="ReadyToCall",e[e.OutgoingCall=2]="OutgoingCall",e[e.IncomingCall=3]="IncomingCall",e[e.InCall=4]="InCall",e[e.HoldCall=5]="HoldCall",e[e.EndCall=6]="EndCall",e[e.CallFail=7]="CallFail",e[e.ActiveOnAnother=8]="ActiveOnAnother",e[e.LastCall=8]="LastCall"}(v||(v={})),function(e){e[e.Idle=0]="Idle",e[e.ReadyToCall=1]="ReadyToCall",e[e.WaitForInput=2]="WaitForInput",e[e.WaitForDigits=3]="WaitForDigits",e[e.Ringing=4]="Ringing",e[e.Outgoing=5]="Outgoing",e[e.InCall=6]="InCall",e[e.Hold=7]="Hold",e[e.ExtendedHook=8]="ExtendedHook"}(I||(I={})),function(e){e[e.displayPosition=3]="displayPosition",e[e.speakerPhonePosition=4]="speakerPhonePosition",e[e.handsetPosition=5]="handsetPosition",e[e.headsetPosition=6]="headsetPosition",e[e.aecPosition=7]="aecPosition",e[e.wirelessPosition=11]="wirelessPosition",e[e.versionPosition=12]="versionPosition",e[e.sipPosition=16]="sipPosition"}(f||(f={})),function(e){e[e.none=0]="none",e[e.hidController=1]="hidController",e[e.usbAudio=2]="usbAudio"}(T||(T={})),function(e){e[e.ManualAllowList=0]="ManualAllowList",e[e.UCQ=1]="UCQ",e[e.QuerySupportedHID=2]="QuerySupportedHID",e[e.VendorIdMatch=3]="VendorIdMatch",e[e.NotApplicable=4]="NotApplicable"}(y||(y={})),function(e){e[e.devicePropertyReading=0]="devicePropertyReading",e[e.deviceDriverInitialization=1]="deviceDriverInitialization"}(E||(E={}))},671070:(e,t,n)=>{var i,a;n.r(t),n.d(t,{ReportType:()=>i,DeviceFilter:()=>a}),function(e){e[e.Input=0]="Input",e[e.Output=1]="Output",e[e.Feature=2]="Feature"}(i||(i={})),function(e){e[e.All=0]="All",e[e.Telephony=1]="Telephony",e[e.Custom=2]="Custom",e[e.TelephonyAndCustom=3]="TelephonyAndCustom",e[e.TelephonyOrCustom=4]="TelephonyOrCustom"}(a||(a={}))},969501:(e,t,n)=>{var i,a;n.d(t,{T:()=>i,$:()=>a}),function(e){e[e.fromApp=0]="fromApp",e[e.onDevice=1]="onDevice",e[e.fromAppToNonSelectedHidDevice=2]="fromAppToNonSelectedHidDevice",e[e.onNonSelectedHidDevice=3]="onNonSelectedHidDevice"}(i||(i={})),function(e){e[e.cancel=0]="cancel",e[e.fail=1]="fail",e[e.stop=2]="stop"}(a||(a={}))},489219:(e,t,n)=>{var i,a,o,r,s,l,c,d,g,u,p,C,h,m,S,v,I,f,T,y,E,A;n.d(t,{T3:()=>i,zx:()=>a,lF:()=>o,$4:()=>r,xD:()=>s,LP:()=>l,Kb:()=>c,_Y:()=>d,sS:()=>g,Pl:()=>u,q$:()=>p,j6:()=>C,G7:()=>h,Zg:()=>m,dl:()=>S,lP:()=>v,yG:()=>I,CR:()=>f,c_:()=>T,DQ:()=>y,n0:()=>E,rE:()=>A}),function(e){e[e.Undefined=0]="Undefined",e[e.GenericDesktop=1]="GenericDesktop",e[e.Simulation=2]="Simulation",e[e.VR=3]="VR",e[e.Sport=4]="Sport",e[e.Game=5]="Game",e[e.GenericDeviceControls=6]="GenericDeviceControls",e[e.KeyboardOrKeypad=7]="KeyboardOrKeypad",e[e.LEDs=8]="LEDs",e[e.Button=9]="Button",e[e.Ordinal=10]="Ordinal",e[e.Telephony=11]="Telephony",e[e.Consumer=12]="Consumer",e[e.Digitizer=13]="Digitizer",e[e.PID=15]="PID",e[e.Unicode=16]="Unicode",e[e.AlphanumericDisplay=20]="AlphanumericDisplay",e[e.Sensor=32]="Sensor",e[e.Monitor=128]="Monitor",e[e.MonitorEnumerated=129]="MonitorEnumerated",e[e.MonitorVirtual=130]="MonitorVirtual",e[e.MonitorReserved=131]="MonitorReserved",e[e.PowerDevice=132]="PowerDevice",e[e.BatterySystem=133]="BatterySystem",e[e.PowerReserved=134]="PowerReserved",e[e.PowerReserved2=135]="PowerReserved2",e[e.BarCodeScanner=140]="BarCodeScanner",e[e.WeighingDevice=141]="WeighingDevice",e[e.Scale=141]="Scale",e[e.MagneticStripeReader=142]="MagneticStripeReader",e[e.CameraControl=144]="CameraControl",e[e.Arcade=145]="Arcade",e[e.CustomPage=65433]="CustomPage",e[e.VendorDefinedStart=65280]="VendorDefinedStart",e[e.SoftphoneShared=65441]="SoftphoneShared"}(i||(i={})),function(e){e[e.Delete=7]="Delete"}(a||(a={})),function(e){e[e.Phone=1]="Phone",e[e.AnsweringMachine=2]="AnsweringMachine",e[e.MessageControls=3]="MessageControls",e[e.Handset=4]="Handset",e[e.Headset=5]="Headset",e[e.TelephonyKeyPad=6]="TelephonyKeyPad",e[e.ProgrammableButton=7]="ProgrammableButton",e[e.HookSwitch=32]="HookSwitch",e[e.Flash=33]="Flash",e[e.Feature=34]="Feature",e[e.Hold=35]="Hold",e[e.Redial=36]="Redial",e[e.Transfer=37]="Transfer",e[e.Drop=38]="Drop",e[e.Park=39]="Park",e[e.ForwardCalls=40]="ForwardCalls",e[e.AlternateFunction=41]="AlternateFunction",e[e.Line=42]="Line",e[e.SpeakerPhone=43]="SpeakerPhone",e[e.Conference=44]="Conference",e[e.RingEnable=45]="RingEnable",e[e.Ring=46]="Ring",e[e.PhoneMute=47]="PhoneMute",e[e.CallerID=48]="CallerID",e[e.SpeedDial=80]="SpeedDial",e[e.StoreNumber=81]="StoreNumber",e[e.RecallNumber=82]="RecallNumber",e[e.PhoneDirectory=83]="PhoneDirectory",e[e.VoiceMail=112]="VoiceMail",e[e.ScreenCalls=113]="ScreenCalls",e[e.DoNotDisturb=114]="DoNotDisturb",e[e.Message=115]="Message",e[e.AnswerOnOrOff=116]="AnswerOnOrOff",e[e.InsideDialTone=144]="InsideDialTone",e[e.OutsideDialTone=145]="OutsideDialTone",e[e.InsideRingTone=146]="InsideRingTone",e[e.OutsideRingTone=147]="OutsideRingTone",e[e.PriorityRingTone=148]="PriorityRingTone",e[e.InsideRingback=149]="InsideRingback",e[e.PriorityRingback=150]="PriorityRingback",e[e.LineBusyTone=151]="LineBusyTone",e[e.ReorderTone=152]="ReorderTone",e[e.CallWaitingTone=153]="CallWaitingTone",e[e.ConfirmationTone1=154]="ConfirmationTone1",e[e.ConfirmationTone2=155]="ConfirmationTone2",e[e.TonesOff=156]="TonesOff",e[e.OutsideRingback=157]="OutsideRingback",e[e.PhoneKey0=176]="PhoneKey0",e[e.PhoneKey1=177]="PhoneKey1",e[e.PhoneKey2=178]="PhoneKey2",e[e.PhoneKey3=179]="PhoneKey3",e[e.PhoneKey4=180]="PhoneKey4",e[e.PhoneKey5=181]="PhoneKey5",e[e.PhoneKey6=182]="PhoneKey6",e[e.PhoneKey7=183]="PhoneKey7",e[e.PhoneKey8=184]="PhoneKey8",e[e.PhoneKey9=185]="PhoneKey9",e[e.PhoneKeyStar=186]="PhoneKeyStar",e[e.PhoneKeyPound=187]="PhoneKeyPound",e[e.PhoneKeyA=188]="PhoneKeyA",e[e.PhoneKeyB=189]="PhoneKeyB",e[e.PhoneKeyC=190]="PhoneKeyC",e[e.PhoneKeyD=191]="PhoneKeyD"}(o||(o={})),function(e){e[e.ShortcutButton=6]="ShortcutButton",e[e.HidConfiguration=5]="HidConfiguration",e[e.TeamsButton=4]="TeamsButton",e[e.ASPFeature=3]="ASPFeature",e[e.CameraMode=199]="CameraMode"}(r||(r={})),function(e){e[e.Output=1]="Output",e[e.Input=2]="Input"}(s||(s={})),function(e){e[e.Input=3]="Input"}(l||(l={})),function(e){e[e.Mute=0]="Mute",e[e.Unmute=1]="Unmute",e[e.QueryState=2]="QueryState"}(c||(c={})),function(e){e[e.NotInCall=0]="NotInCall",e[e.Off=1]="Off",e[e.On=2]="On",e[e.Blocked=3]="Blocked"}(d||(d={})),function(e){e[e.VendorUsageId=65281]="VendorUsageId",e[e.RowsUsage=53]="RowsUsage",e[e.ScreenSelectUsage=65297]="ScreenSelectUsage",e[e.LastCharacterUsage=65316]="LastCharacterUsage",e[e.TextStringFollowed=65314]="TextStringFollowed",e[e.CustomLangId=100]="CustomLangId",e[e.CustomOcDisplayVersion=101]="CustomOcDisplayVersion"}(g||(g={})),function(e){e[e.NumLock=1]="NumLock",e[e.CapsLock=2]="CapsLock",e[e.ScrollLock=3]="ScrollLock",e[e.Compose=4]="Compose",e[e.Kana=5]="Kana",e[e.Power=6]="Power",e[e.Shift=7]="Shift",e[e.DoNotDisturb=8]="DoNotDisturb",e[e.Mute=9]="Mute",e[e.ToneEnable=10]="ToneEnable",e[e.HighCutFilter=11]="HighCutFilter",e[e.LowCutFilter=12]="LowCutFilter",e[e.EqualizerEnable=13]="EqualizerEnable",e[e.SoundFieldOn=14]="SoundFieldOn",e[e.SurroundOn=15]="SurroundOn",e[e.Repeat=16]="Repeat",e[e.Stereo=17]="Stereo",e[e.SamplingRateDetect=18]="SamplingRateDetect",e[e.Spinning=19]="Spinning",e[e.CAV=20]="CAV",e[e.CLV=21]="CLV",e[e.RecordingFormatDetect=22]="RecordingFormatDetect",e[e.OffHook=23]="OffHook",e[e.Ring=24]="Ring",e[e.MessageWaiting=25]="MessageWaiting",e[e.DataMode=26]="DataMode",e[e.BatteryOperation=27]="BatteryOperation",e[e.BatteryOK=28]="BatteryOK",e[e.BatteryLow=29]="BatteryLow",e[e.Speaker=30]="Speaker",e[e.HeadSet=31]="HeadSet",e[e.Hold=32]="Hold",e[e.Microphone=33]="Microphone",e[e.Coverage=34]="Coverage",e[e.NightMode=35]="NightMode",e[e.SendCalls=36]="SendCalls",e[e.CallPickup=37]="CallPickup",e[e.Conference=38]="Conference",e[e.StandBy=39]="StandBy",e[e.CameraOn=40]="CameraOn",e[e.CameraOff=41]="CameraOff",e[e.OnLine=42]="OnLine",e[e.OffLine=43]="OffLine",e[e.Busy=44]="Busy",e[e.Ready=45]="Ready",e[e.PaperOut=46]="PaperOut",e[e.PaperJam=47]="PaperJam",e[e.Remote=48]="Remote",e[e.Forward=49]="Forward",e[e.Reverse=50]="Reverse",e[e.Stop=51]="Stop",e[e.Rewind=52]="Rewind",e[e.FastForward=53]="FastForward",e[e.Play=54]="Play",e[e.Pause=55]="Pause",e[e.Record=56]="Record",e[e.Error=57]="Error",e[e.Usage=58]="Usage",e[e.UsageInUseIndicator=59]="UsageInUseIndicator",e[e.UsageMultiModeIndicator=60]="UsageMultiModeIndicator",e[e.IndicatorOn=61]="IndicatorOn",e[e.IndicatorFlash=62]="IndicatorFlash",e[e.IndicatorSlowBlink=63]="IndicatorSlowBlink",e[e.IndicatorFastBlink=64]="IndicatorFastBlink",e[e.IndicatorOff=65]="IndicatorOff",e[e.FlashOnTime=66]="FlashOnTime",e[e.SlowBlinkOnTime=67]="SlowBlinkOnTime",e[e.SlowBlinkOffTime=68]="SlowBlinkOffTime",e[e.FastBlinkOnTime=69]="FastBlinkOnTime",e[e.FastBlinkOffTime=70]="FastBlinkOffTime",e[e.UsageIndicatorColor=71]="UsageIndicatorColor",e[e.IndicatorRed=72]="IndicatorRed",e[e.IndicatorGreen=73]="IndicatorGreen",e[e.IndicatorAmber=74]="IndicatorAmber",e[e.GenericIndicator=75]="GenericIndicator",e[e.SystemSuspend=76]="SystemSuspend",e[e.ExternalPowerConnected=77]="ExternalPowerConnected",e[e.PlayerIndicator=78]="PlayerIndicator",e[e.Player1=79]="Player1",e[e.Player2=80]="Player2",e[e.Player3=81]="Player3",e[e.Player4=82]="Player4",e[e.Player5=83]="Player5",e[e.Player6=84]="Player6",e[e.Player7=85]="Player7",e[e.Player8=86]="Player8",e[e.Reserved=65535]="Reserved"}(u||(u={})),function(e){e[e.None=0]="None",e[e.LocalUserName=1]="LocalUserName",e[e.LocalUserStatus=2]="LocalUserStatus",e[e.Date=4]="Date",e[e.Time=8]="Time",e[e.CallStatus=16]="CallStatus",e[e.OtherPartyName=32]="OtherPartyName",e[e.OtherPartyTitle=64]="OtherPartyTitle",e[e.Subject=128]="Subject",e[e.Duration=256]="Duration",e[e.Number=512]="Number",e[e.OtherPartyNumber=1024]="OtherPartyNumber",e[e.ConversationId=2048]="ConversationId"}(p||(p={})),function(e){e[e.NoChange=0]="NoChange",e[e.Idle=1]="Idle",e[e.Active=2]="Active",e[e.ReadyToCall=2]="ReadyToCall",e[e.OutgoingCall=3]="OutgoingCall",e[e.IncomingCall=4]="IncomingCall",e[e.InCall=5]="InCall",e[e.HoldCall=6]="HoldCall",e[e.EndCall=7]="EndCall"}(C||(C={})),function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(h||(h={})),function(e){e[e.NoClear=0]="NoClear",e[e.Clear=1]="Clear"}(m||(m={})),function(e){e[e.Disable=0]="Disable",e[e.Enable=1]="Enable"}(S||(S={})),function(e){e[e.Transparent=0]="Transparent",e[e.White=1]="White",e[e.Gray=2]="Gray",e[e.Blue=3]="Blue",e[e.Pink=4]="Pink"}(v||(v={})),function(e){e[e.Undefined=0]="Undefined"}(I||(I={})),function(e){e[e.reportId=123]="reportId",e[e.usage=65292]="usage"}(f||(f={})),function(e){e[e.reportId=92]="reportId"}(T||(T={})),function(e){e[e.reportId=94]="reportId"}(y||(y={})),function(e){e[e.pptLiveInactive=65536]="pptLiveInactive",e[e.pptLiveActive=65537]="pptLiveActive"}(E||(E={})),function(e){e[e.none=0]="none",e[e.pptLaserPointReleased=65536]="pptLaserPointReleased",e[e.pptLaserPointPressed=65537]="pptLaserPointPressed",e[e.pptLaserPointLongPressed=65538]="pptLaserPointLongPressed",e[e.pptPrevSlideReleased=131072]="pptPrevSlideReleased",e[e.pptPrevSlidePressed=131073]="pptPrevSlidePressed",e[e.pptNextSlideReleased=196608]="pptNextSlideReleased",e[e.pptNextSlidePressed=196609]="pptNextSlidePressed"}(A||(A={}))},961843:(e,t,n)=>{var i,a,o,r,s,l,c,d,g,u;n.d(t,{xh:()=>i,YR:()=>a,me:()=>o,L1:()=>r,fi:()=>s,Lg:()=>l,Gz:()=>c,i4:()=>g,Eq:()=>u}),function(e){e[e.Other=0]="Other",e[e.Self=1]="Self"}(i||(i={})),function(e){e[e.Inking=0]="Inking",e[e.Arrow=1]="Arrow",e[e.Smudge=2]="Smudge"}(a||(a={})),function(e){e[e.Idle=0]="Idle",e[e.Arrows=1]="Arrows",e[e.Inking=2]="Inking"}(o||(o={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Legacy=9]="Legacy",e[e.Chunked=10]="Chunked"}(r||(r={})),function(e){e[e.AnnotationReady=1]="AnnotationReady",e[e.ClientInForeground=2]="ClientInForeground",e[e.Video=4]="Video",e[e.AnnotationLimit=16]="AnnotationLimit",e[e.Tracking=32]="Tracking",e[e.All=55]="All"}(s||(s={})),function(e){e[e.None=0]="None",e[e.HoloLensRemoteAssist=1]="HoloLensRemoteAssist",e[e.AndroidRemoteAssist=2]="AndroidRemoteAssist",e[e.IOSRemoteAssist=3]="IOSRemoteAssist",e[e.HoloLensGuides=4]="HoloLensGuides",e[e.MeshApp=5]="MeshApp"}(l||(l={})),function(e){e[e.RPC_PlaceArrow=0]="RPC_PlaceArrow",e[e.RPC_DeleteAnnotations=1]="RPC_DeleteAnnotations",e[e.RPC_ClearAllAnnotations=2]="RPC_ClearAllAnnotations",e[e.RPC_RecoverAnnotations=3]="RPC_RecoverAnnotations",e[e.RPC_StartInteraction=4]="RPC_StartInteraction",e[e.RPC_StopInteraction=5]="RPC_StopInteraction",e[e.RPC_StartInking=6]="RPC_StartInking",e[e.RPC_StopInking=7]="RPC_StopInking",e[e.RPC_ContinueInking=8]="RPC_ContinueInking",e[e.AnnotationCreated=9]="AnnotationCreated",e[e.AnnotationModified=10]="AnnotationModified",e[e.AnnotationRemoved=11]="AnnotationRemoved",e[e.InteractionReady=12]="InteractionReady",e[e.InteractionTerminated=13]="InteractionTerminated",e[e.ResetAllAnnotations=14]="ResetAllAnnotations",e[e.SnapshotMode2D=15]="SnapshotMode2D",e[e.FreezeFrameEvent=16]="FreezeFrameEvent"}(c||(c={})),function(e){e[e.AnnotationCreated=0]="AnnotationCreated",e[e.AnnotationModified=1]="AnnotationModified",e[e.AnnotationRemoved=2]="AnnotationRemoved",e[e.InteractionReady=3]="InteractionReady",e[e.InteractionTerminated=4]="InteractionTerminated"}(d||(d={})),function(e){e[e.Initiating=0]="Initiating",e[e.ToggledOn=1]="ToggledOn",e[e.ImageInfo=2]="ImageInfo",e[e.ImageLoaded=3]="ImageLoaded",e[e.Ended=4]="Ended"}(g||(g={})),function(e){e[e.AnnotationEvent=0]="AnnotationEvent",e[e.RequestIDs=1]="RequestIDs",e[e.OwnerID=2]="OwnerID",e[e.AnnotationViewportPosition=3]="AnnotationViewportPosition",e[e.PoseMatrix=4]="PoseMatrix",e[e.ProjectionMatrix=5]="ProjectionMatrix",e[e.AnnotationType=6]="AnnotationType",e[e.AnnotationColor=7]="AnnotationColor",e[e.AnnotationScale=8]="AnnotationScale",e[e.AnnotationAngle=9]="AnnotationAngle",e[e.IsPermanent=10]="IsPermanent",e[e.InteractionRequiredComponent=11]="InteractionRequiredComponent",e[e.InteractionRequiredComponentIsCritical=12]="InteractionRequiredComponentIsCritical",e[e.AnnotationViewportPositionArray=13]="AnnotationViewportPositionArray",e[e.OwnerHashCode=14]="OwnerHashCode",e[e.IsEnabled=15]="IsEnabled",e[e.OneDriveUri=16]="OneDriveUri",e[e.FreezeFrameStatus=17]="FreezeFrameStatus"}(u||(u={}))},772573:(e,t,n)=>{var i;n.d(t,{q:()=>i}),function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DB=7]="DB",e[e.TRouter=8]="TRouter"}(i||(i={}))},853356:(e,t,n)=>{var i;n.d(t,{t:()=>i}),function(e){e[e.AppOffline=0]="AppOffline",e[e.UnifiedFlowNotAvailable=1]="UnifiedFlowNotAvailable",e[e.NotAnInstantMeeting=2]="NotAnInstantMeeting",e[e.GetUserError=3]="GetUserError"}(i||(i={}))},323360:(e,t,n)=>{var i;n.d(t,{J:()=>i}),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Recording=2]="Recording",e[e.Stopped=3]="Stopped",e[e.Error=4]="Error"}(i||(i={}))},807254:(e,t,n)=>{var i,a,o,r,s;n.d(t,{LQ:()=>i,to:()=>a,Yx:()=>o,ED:()=>r,H5:()=>s}),function(e){e.LIS="LIS",e.CLS="CLS",e.Assist="Assist",e.Manual="Manual",e.Registered="Registered",e.None="None"}(i||(i={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(a||(a={})),function(e){e.Subnet="Subnet",e.PostalCode="PostalCode"}(o||(o={})),function(e){e.NotificationOnly="NotificationOnly",e.ConferenceMuted="ConferenceMuted",e.ConferenceUnMuted="ConferenceUnMuted"}(r||(r={})),function(e){e.UserLocationPolicy="UserLocationPolicy",e.DynamicLocationResponseECRP="DynamicLocationResponseECRP",e.FallbackStaticECRP="FallbackStaticECRP",e.None="None"}(s||(s={}))},781473:(e,t,n)=>{n.d(t,{p:()=>i,j:()=>d});var i,a=n(361366),o=n(268316),r=n(360452),s=n(926305),l=n(364468),c=n(796973);!function(e){e.None="None",e.Recording="Recording",e.Paused="Paused"}(i||(i={}));class d{constructor(e,t,n,a,o,r){this.teamsCall=e,this.config=t,this.localized=n,this.serviceProvider=a,this.acsBot=r,this.acsRecordingState=i.None,this.oldACSRecordingState=i.None,this.logger=o.newLogger("acsRecordingMixin"),this.config.enableACSCallRecordingNotification()&&(this.privacyUrl=c.Constants.legal.privacyAndCookiesUrl,this.updateAlerts(),this.botStatusSubscription=this.acsBot.on("botStatusChanged",(()=>this.onBotStatusChanged(r))),this.botStateSubscription=this.acsBot.on("botStateChanged",(()=>this.onBotStateChanged(r))),this.subscribeToCall(),this.onBotStatusChanged(r),this.onBotStateChanged(r),Promise.resolve().then((()=>this.updatePrivacyUrlAndAlerts())))}getAcsRecordingState(){return this.acsRecordingState}setRecordingState(e){this.oldACSRecordingState=this.acsRecordingState,this.acsRecordingState=e,this.oldACSRecordingState!==this.acsRecordingState&&(this.teamsCall.raiseTeamsCallEvent("acsRecordingStatusChanged"),this.logger.info(`set ACS recording state to ${this.acsRecordingState}.`),this.oldACSRecordingState!==i.Recording&&this.acsRecordingState!==i.Recording||this.triggerACSRecordingAlert())}triggerACSRecordingAlert(){var e;this.logger.info(`trigger ACS recording alert. acsRecordingState = ${this.acsRecordingState}`),this.dismissAlerts(),null===(e=this.serviceProvider.callingAlertsService())||void 0===e||e.handleOnDemandAlert(this.acsRecordingAlerts[this.acsRecordingState])}updateAlerts(){var e,t,n,a;const{teamsCallId:o}=this.teamsCall,r={dismissable:!0,type:s.NK.Warning,name:"ACSRecordingStarted",title:null===(e=this.localized)||void 0===e?void 0:e.acsRecordingStartedNotification(this.privacyUrl).title,text:null===(t=this.localized)||void 0===t?void 0:t.acsRecordingStartedNotification(this.privacyUrl).text,timeout:-1,teamsCallId:o},l={dismissable:!0,type:s.NK.Warning,name:"ACSRecordingStopped",title:null===(n=this.localized)||void 0===n?void 0:n.acsRecordingStoppedNotification().title,text:null===(a=this.localized)||void 0===a?void 0:a.acsRecordingStoppedNotification().text,timeout:-1,teamsCallId:o};this.acsRecordingAlerts={[i.Recording]:r,[i.Paused]:l,[i.None]:l}}dismissAlerts(){var e,t,n;null===(e=this.serviceProvider.callingAlertsService())||void 0===e||e.dismiss(this.acsRecordingAlerts[i.Recording]),null===(t=this.serviceProvider.callingAlertsService())||void 0===t||t.dismiss(this.acsRecordingAlerts[i.Paused]),null===(n=this.serviceProvider.callingAlertsService())||void 0===n||n.dismiss(this.acsRecordingAlerts[i.None])}updatePrivacyUrlAndAlerts(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.config.getPrivacyLink();e&&this.privacyUrl!==e&&(this.privacyUrl=e,this.updateAlerts())}))}onBotStatusChanged(e){const t=e.getStatus();switch(t){case l.CallingBotStatus.none:case l.CallingBotStatus.removed:case l.CallingBotStatus.failed:this.setRecordingState(i.None)}this.logger.info(`acs bot status changed. Bot status is ${t}.`)}onBotStateChanged(e){const t=e.getProcessingModeState(l.ProcessingMode.Recording);switch(t){case l.ProcessingModeState.Active:this.setRecordingState(i.Recording);break;case l.ProcessingModeState.Paused:this.setRecordingState(i.Paused);break;default:this.setRecordingState(i.None)}this.logger.info(`acs bot state changed. Bot state is ${t}.`)}subscribeToCall(){(0,o.safeSubscribeToCall)(this.teamsCall,(e=>{e.state===r.OX.Disconnected&&(this.botStatusSubscription.dispose(),this.botStateSubscription.dispose())}),!0)}}},618466:(e,t,n)=>{var i;n.r(t),n.d(t,{RestrictableModalities:()=>i}),function(e){e[e.Audio=1]="Audio",e[e.Video=2]="Video",e[e.Chat=4]="Chat"}(i||(i={}))},422254:(e,t,n)=>{var i;n.r(t),n.d(t,{CallClosedCaptionStatus:()=>i,CallClosedCaptionsScenarioMarkerSteps:()=>a,MAX_RETRIES:()=>o,DELAY_BETWEEN_COMMANDS_MS:()=>r}),function(e){e[e.none=0]="none",e[e.disabled=1]="disabled",e[e.started=2]="started",e[e.stopped=3]="stopped",e[e.pending=4]="pending",e[e.failed=5]="failed"}(i||(i={}));const a={Initialization:"Initialization",AddBot:"AddBot",BotAdded:"BotAdded",BotRemoved:"BotRemoved",WaitingForBotReady:"WaitingForBotReady",BotStatusUpdate:"BotStatusUpdate",BotCaptionsUpdate:"BotCaptionsUpdate",CaptionsStateUpdate:"CaptionsStateUpdate",SetAudioMode:"SetAudioMode",UnsetAudioMode:"UnsetAudioMode"},o=10,r=1050},30470:(e,t,n)=>{n.r(t),n.d(t,{UserRoleInConsultCall:()=>i,CallConsultationMixinImplementation:()=>o,CallConsultationMixinService:()=>r});var i,a=n(686621);!function(e){e.admin="admin",e.boss="boss",e.endUser="endUser"}(i||(i={}));class o{constructor(e){this.loggingService=e,this._isConsultCall=!1,this._consultorName=null,this._consulteeName=null,this._consultingWith=null,this._canTransferDuringConsult=!1,this.logger=e.newLogger("CallConsultationMixin")}set isConsultCall(e){this._isConsultCall=!!e,this.logger.info(`[consultTransfer] isConsultCall value is set to ${e}`)}get isConsultCall(){return this._isConsultCall}set consultorName(e){this._consultorName=e||null,this.logger.info(`[consultTransfer] consultorName value is set to ${e}`)}get consultorName(){return this._consultorName}set consulteeName(e){this._consulteeName=e||null,this.logger.info(`[consultTransfer] consulteeName value is set to ${e}`)}get consulteeName(){return this._consulteeName}set consultingWith(e){this._consultingWith=e,this.logger.info(`[consultTransfer] consultingWith value is set to ${e}`)}get consultingWith(){return this._consultingWith}set canTransferDuringConsult(e){this._canTransferDuringConsult=!!e,this.logger.info(`[consultTransfer] canTransferDuringConsult value is set to ${e}`)}get canTransferDuringConsult(){return this._canTransferDuringConsult}}class r{constructor(e){this.loggingService=e,this.logger=e.newLogger("CallConsultationMixinService")}mixTeamsCall(e){const t=new o(this.loggingService);a.TeamsCallService.bindProps(e,t,["isConsultCall","consultorName","consultingWith","consulteeName","canTransferDuringConsult"],this.logger)}}},524570:(e,t,n)=>{var i,a,o;n.d(t,{rc:()=>i,sW:()=>a,Bb:()=>o}),function(e){e[e.Incoming=1]="Incoming",e[e.Outgoing=2]="Outgoing"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.UCAP=1]="UCAP",e[e.NGC=2]="NGC"}(a||(a={})),function(e){e[e.MissingTransferredCall=0]="MissingTransferredCall",e[e.ValidTerminatedIncomingCall=1]="ValidTerminatedIncomingCall",e[e.ValidTerminatedTransferredCall=2]="ValidTerminatedTransferredCall",e[e.FailedTransferredCall=3]="FailedTransferredCall",e[e.FailedConferenceCall=4]="FailedConferenceCall",e[e.FailedCreateConversation=5]="FailedCreateConversation",e[e.ValidTerminatedConferenceCall=6]="ValidTerminatedConferenceCall"}(o||(o={}))},205861:(e,t,n)=>{var i;n.d(t,{n:()=>i}),function(e){e[e.SS_ControlCapable=0]="SS_ControlCapable",e[e.SS_Available=1]="SS_Available",e[e.SS_Stopped=2]="SS_Stopped",e[e.SS_FrameTypeChanged=3]="SS_FrameTypeChanged",e[e.SS_IsRendering=4]="SS_IsRendering",e[e.SS_RendererReused=5]="SS_RendererReused",e[e.SS_Starting=6]="SS_Starting",e[e.SS_RendererCreated=7]="SS_RendererCreated",e[e.SS_Destroyed=8]="SS_Destroyed",e[e.SS_StreamUpdated=9]="SS_StreamUpdated",e[e.SS_RenderingStopped=10]="SS_RenderingStopped"}(i||(i={}))},388994:(e,t,n)=>{n.r(t),n.d(t,{JoinType:()=>i,CallSetupMixinService:()=>d});var i,a=n(360452),o=n(197981),r=n(430753),s=n(796973),l=n(2781);!function(e){e.normal="normal",e.contentOnly="content-only",e.pstn="pstn"}(i||(i={}));class c{constructor(e,t,n,i,a,o,r,c=l.EsPromiseFactory){this.call=e,this.callingIntentMultiWindowService=n,this.activeCallsService=i,this.eventingService=o,this.callingMultiWindowService=r,this.promiseFactory=c,this.setupArgs={isChannelMeeting:!1},this.retryCount=0,this.wasPoppedOut=!1,this.isExperienceContainerError=!1,this.acceptedFromContentOnlyJoinNudge=!1,this.acceptedThroughPrejoin=!1,this.disableDisconnectOnObserving=!1,this.isTeamsCallTypeEnabled=!1,this.isReusable=!1,this.callDisposedDefer=c.createDeferred(),this.isTeamsCallTypeEnabled=t.isTeamsCallTypeEnabled(),this.disableDisconnectOnObserving=t.disableDisconnectOnObserving();const d=o.registerHandlerForExternalEvent(s.Constants.events.calling.callDisposed,(e=>{this.call===e&&(d(),this.dispose())}))}setIntent(e){this.intent=e}setWindowId(e){this.windowId=e}setWasPoppedOut(e=!0){this.wasPoppedOut=e,this.eventingService.emit(s.Constants.events.calling.callWasPoppedOutChanged,this.call)}markAsReusable(){this.isReusable=!0}getMessageIdAsync(){return this.messageIdPromise||(this.messageIdPromise=new Promise(((e,t)=>{if(this.call.messageId)e(this.call.messageId);else{const n=this.call.changed((()=>{this.call.messageId&&(e(this.call.messageId),n.dispose(),clearTimeout(i))}));this.disposeMessageIdSubscription=e=>{t(e),n.dispose(),clearTimeout(i),this.messageIdPromise=null,this.disposeMessageIdSubscription=void 0};const i=setTimeout((()=>{this.disposeMessageIdSubscription("messageId not established within timely fashion")}),s.Constants.timeInMiliseconds.minute)}}))),this.messageIdPromise}get teamsCallType(){return this.isTeamsCallTypeEnabled?this.call.callType===a.rf.Unknown?this.call.callType:this.call.threadId||this.call.isEmergencyCall?a.rf.Conference:a.rf.P2P:this.call.callType}stopIfNotReusable(){if([a.OX.Observing,a.OX.Preheating,a.OX.Preheated].includes(this.call.state)&&!this.isReusable){if(this.activeCallsService.markCallAsEndedLocally(this.call),this.disableDisconnectOnObserving&&this.call.state===a.OX.Observing)return;this.call.stop()}else this.isReusable=!1}get intentId(){return this.intent&&this.intent.id}getIntent(){return this.intent||this.callingIntentMultiWindowService.getExistingIntentForCall(this.call)}isOpenInChildWindow(){return this.callingMultiWindowService.isModernCallingEnabled()&&this.callingMultiWindowService.isCallSupportedInModernCalling(this.call)&&!!this.getIntent()}isBeingPreheated(){return(0,o.includes)([a.OX.Preheated,a.OX.Preheating],this.call.state)||this.call.isPreheatEnabled}dispose(){this.disposeMessageIdSubscription&&this.disposeMessageIdSubscription("Call disposed")}}class d extends r.r{constructor(e,t,n,i,a,o,s,d=l.EsPromiseFactory){super(Object.assign(Object.assign({},(0,r.f)({methods:["markAsReusable","stopIfNotReusable","isBeingPreheated","setIntent","setWindowId","setWasPoppedOut","getIntent","isOpenInChildWindow","getMessageIdAsync"],props:["originalCalleeMri","isInitialized","wasJoinAttempted","callDisposedDefer","setupArgs","initiatedTime","retryCount","conversationId","intentId","windowId","wasPoppedOut","teamsCallType","isExperienceContainerError","acceptedFromContentOnlyJoinNudge","acceptedThroughPrejoin","leaveCallContext","leaveCallReasonCMD","joinType"]}).syncedWith()),{createMixin:t=>new c(t,e,a,o,i,n,s,d)}))}}},341189:(e,t,n)=>{var i,a;n.d(t,{S:()=>i,F:()=>a}),function(e){e[e.started=0]="started",e[e.stopped=1]="stopped",e[e.stoppedWithError=2]="stoppedWithError",e[e.noSpeakers=3]="noSpeakers",e[e.noMicrophone=4]="noMicrophone",e[e.speakersMismatch=5]="speakersMismatch"}(i||(i={})),function(e){e[e.Ok=0]="Ok",e[e.NoSpeakers=1]="NoSpeakers",e[e.NoMicrophone=2]="NoMicrophone",e[e.SpeakersMismatch=3]="SpeakersMismatch"}(a||(a={}))},296144:(e,t,n)=>{var i;n.d(t,{B:()=>i}),function(e){e[e.none=0]="none",e[e.disabled=1]="disabled",e[e.pending=2]="pending",e[e.waiting=3]="waiting",e[e.started=4]="started",e[e.stopping=5]="stopping",e[e.stopped=6]="stopped",e[e.failed=7]="failed",e[e.waitingformeetinglive=8]="waitingformeetinglive"}(i||(i={}))},364468:(e,t,n)=>{var i,a,o,r,s,l;n.r(t),n.d(t,{ProcessingModeState:()=>i,ProcessingMode:()=>a,BotMode:()=>o,TranscriptLastStartReason:()=>r,CallingBotType:()=>s,CallingBotStatus:()=>l}),function(e){e.Active="Active",e.Inactive="Inactive",e.WaitingForMeetingLive="WaitingForMeetingLive",e.Paused="Paused"}(i||(i={})),function(e){e.Recording="recording",e.ClosedCaptions="closedCaptions",e.Transcript="realTimeTranscript",e.Coach="meetingCoach",e.FaceStream="faceStream"}(a||(a={})),function(e){e.RecordingAndTranscription="RecordingAndTranscription",e.Recording="Recording",e.Transcription="Transcription"}(o||(o={})),function(e){e.Unknown="Unknown",e.UserCommand="UserCommand",e.ServiceCommand="ServiceCommand",e.UserInitialPayload="UserInitialPayload",e.ServiceInitialPayload="ServiceInitialPayload",e.ParticipantMetadataChanged="ParticipantMetadataChanged"}(r||(r={})),function(e){e[e.TeamsBot=0]="TeamsBot",e[e.AcsBot=1]="AcsBot"}(s||(s={})),function(e){e[e.none=0]="none",e[e.added=1]="added",e[e.removed=2]="removed",e[e.failed=3]="failed"}(l||(l={}))},824990:(e,t,n)=>{n.r(t),n.d(t,{RecorderFeatures:()=>h.RecorderFeatures,RecorderStorageSettings:()=>h.RecorderStorageSettings,CallingBotConsumerType:()=>i,ClosedCaptionsTextTrackSource:()=>a,CallingBotTextTrackSource:()=>o,getTextTrackSourceFromBotSource:()=>m,getBotSourceFromTextTrackSource:()=>S,areEqualTextTrackSets:()=>v,CallingBot:()=>I});var i,a,o,r=n(361366),s=n(360452),l=n(197981),c=n(62606),d=n(592084),g=n(972858),u=n(860810),p=n(268316),C=n(796973),h=n(364468);!function(e){e.Teams="Teams",e.TeamsForLife="TeamsForLife"}(i||(i={})),function(e){e.Ai="Ai",e.Cart="Cart",e.Cea708="Cea708",e.Mt="Mt"}(a||(a={})),function(e){e.Ai="Ai",e.Cart="Cart",e.Cea708="Cea708",e.Mt="Mt"}(o||(o={}));const m=e=>{switch(e){case o.Ai:return a.Ai;case o.Cart:return a.Cart;case o.Cea708:return a.Cea708;case o.Mt:return a.Mt;default:return a.Ai}},S=e=>{switch(e){case a.Ai:return o.Ai;case a.Cart:return o.Cart;case a.Cea708:return o.Cea708;case a.Mt:return o.Mt;default:return o.Ai}},v=(e,t)=>e&&t?(null==e?void 0:e.length)===(null==t?void 0:t.length)&&0===(0,l.differenceWith)(e,t,l.isEqual).length:e===t;class I extends u.ObservableBase{constructor(e,t,n,i,a,o,r,s,l,c=h.CallingBotType.TeamsBot){super(),this.call=e,this.config=t,this.mode=n,this.defaultBotMRI=i,this.chatServiceUtils=a,this.callTitleService=o,this.channelService=r,this.processingMode=l,this.botType=c,this.status=h.CallingBotStatus.none,this.botMRI=i,this.logger=s.newLogger("CallingBot"),this.disableDefaultBotDataLanguage=t.disableDefaultBotDataLanguage(),this.defaultLanguage=t.defaultLanguage(),this.recorderFeatures={meetingOrganiser:t.meetingOrganiser(),enablePPTSharing:t.enablePPTSharing(),intermediateLiveCaptions:t.intermediateLiveCaptions(),actionItemsEnabled:t.actionItemsEnabled(),enableEmailAndMeetingLanguageModel:t.enableEmailAndMeetingLanguageModel(),ceoSummit:t.ceoSummit(),useUnmixedAudio:t.useUnmixedAudio(),enableTranscriptMeetingChaptering:t.enableTranscriptMeetingChaptering()},this.subscribeToCall()}getStatus(){return this.status}getMri(){return this.botMRI}getBotEndpointId(){return this.botEndpointId}getBotParticipantId(){return this.botParticipantId}getBotActiveModeParticipantId(){var e,t,n,i,a,o;for(const r of null!==(n=null===(t=null===(e=this.bot)||void 0===e?void 0:e.endpoints)||void 0===t?void 0:t.endpointDetails)&&void 0!==n?n:[])if((null===(o=null===(a=null===(i=r.endpointMetadata)||void 0===i?void 0:i.processingModes)||void 0===a?void 0:a[this.processingMode])||void 0===o?void 0:o.state)===h.ProcessingModeState.Active)return r.participantId;return this.botParticipantId}getBotParticipant(){return this.bot}getRecordingInitiatorUserId(){return this.recordingInitiatorUserId||""}hasProcessingMode(e){return this.botProcessingModes&&void 0!==this.botProcessingModes[e]}getProcessingModeState(e){var t,n,i,a,o,r,s,l,c,d,g,u;for(const s of null!==(i=null===(n=null===(t=this.bot)||void 0===t?void 0:t.endpoints)||void 0===n?void 0:n.endpointDetails)&&void 0!==i?i:[])if((null===(r=null===(o=null===(a=null==s?void 0:s.endpointMetadata)||void 0===a?void 0:a.processingModes)||void 0===o?void 0:o[e])||void 0===r?void 0:r.state)===h.ProcessingModeState.Active)return h.ProcessingModeState.Active;return null===(u=null===(g=null===(d=null===(c=null===(l=null===(s=this.bot)||void 0===s?void 0:s.endpoints)||void 0===l?void 0:l.endpointDetails[0])||void 0===c?void 0:c.endpointMetadata)||void 0===d?void 0:d.processingModes)||void 0===g?void 0:g[e])||void 0===u?void 0:u.state}getProcessingModeRequirements(e){return this.botProcessingModes&&this.botProcessingModes[e]&&this.botProcessingModes[e].requirements}getLastError(){return this.lastError}getCommandUrl(){return this.commandUrl}getTranscriptScopeId(){return this.transcriptScopeId}getTranscriptStorageId(){return this.transcriptStorageId}getTranscriptCommandInitiatorUserId(){return this.transcriptCommandInitiatorUserId}getDataChannelSourceId(){return this.dataSourceId===c.CallUtilities.SOURCE_ID_ANY?void 0:this.dataSourceId}getTranscriptEditId(){return this.transcriptEditId}getInRoomAttributionIssues(){return this.inRoomAttributionIssues}getSpokenLanguage(){return this.spokenLanguage}getTextTracks(){return this.textTracks}createRecordingActionParameter(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function*(){null==e||e.forEach((e=>{(null==e?void 0:e.eventData)&&(e.eventData[C.Constants.counters.eventNames.correlationId]=n)}));const i={meetingTitle:(yield this.callTitleService.getDefaultCallTitle(C.Constants.scenarios.calling.context.recording,this.call,1,yield this.call.getCallingConversationAsync())).titleText,recordingFeatures:this.recorderFeatures,recordingStorageSettings:[],iCalUid:t,correlationId:n};let a;this.call.meetingDetails&&this.call.meetingDetails.invitation&&(i.meetingOrganizer=this.getMeetingOrganizer(this.call.meetingDetails.invitation),i.exchangeId=this.call.meetingDetails.exchangeId);return(yield this.call.getCallingConversationAsync()).isChannel()&&(a=yield this.fulfillBotPayloadForChannel(i,this.config,e)),null==e||e.forEach((e=>{null==e||e.mark(C.Constants.scenarios.calling.recording.titleAndTokenResolved,{titleError:a})})),i}))}getBotDefaultMRI(){return this.defaultBotMRI}createBotPayload(e,t,n="",i,a,o){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const r=this.config.getRing(),s={meetingTitle:n,clientInfo:`Teams-${r?r.shortName||r.friendlyName||r.friendlyShortName:"local"}`,callId:this.call.callId,threadId:this.call.threadId||i,recorderFeatures:this.recorderFeatures,mode:this.mode,iCalUid:a||this.call.meetingDetails&&this.call.meetingDetails.iCalUid||null,consumerType:this.getConsumerType(),spokenLanguage:this.call.getClosedCaptionsLanguage(),correlationId:o};let l;t&&(s.initiatorUserToken=t);(yield this.call.getCallingConversationAsync()).isChannel()&&(l=yield this.fulfillBotPayloadForChannel(s,this.config,[e])),this.call.meetingDetails&&this.call.meetingDetails.invitation&&(s.meetingOrganizer=this.getMeetingOrganizer(this.call.meetingDetails.invitation),s.exchangeId=this.call.meetingDetails.exchangeId);const c=this.call.meetingDetails&&this.call.meetingDetails.meetingCapability&&this.call.meetingDetails.meetingCapability.allowTranscription;return!this.disableDefaultBotDataLanguage&&c&&(s.language=this.defaultLanguage),null==e||e.mark(C.Constants.scenarios.calling.recording.titleAndTokenResolved,{titleError:l}),Promise.resolve({participantInvitationData:{botData:s}})}))}getProcessingModesPropertiesAutoTranscript(){var e,t;return this.hasProcessingMode(h.ProcessingMode.Transcript)&&(null===(t=null===(e=this.botProcessingModes[h.ProcessingMode.Transcript])||void 0===e?void 0:e.properties)||void 0===t?void 0:t.lastStartReason)===h.TranscriptLastStartReason.ServiceInitialPayload}isCombinedRecorderBot(){return this.hasProcessingMode(h.ProcessingMode.Transcript)&&this.hasProcessingMode(h.ProcessingMode.Recording)}isBotReady(){return!!this.botProcessingModes}collectTelemetryData(){return{callType:this.call.callType,isOneToOnePstnCall:c.CallUtilities.isOneToOnePstnCall(this.call),callState:this.call.state,botMri:this.getMri(),botParticipantId:this.getBotParticipantId(),botEndpointId:this.getBotEndpointId(),botStatus:h.CallingBotStatus[this.getStatus()],botCommandUrl:this.getCommandUrl(),botProcessingModes:Object.keys(this.botProcessingModes||{}),botLastError:this.lastError}}setStatus(e){this.status=e,this.event("botStatusChanged").raise(),this.logger.info(`CallingBot status is ${e}`)}onBotRemoved(){let e;this.isFailed()?(this.lastError=this.bot.stateReason,e=h.CallingBotStatus.failed):(this.lastError=void 0,e=h.CallingBotStatus.removed),this.bot=void 0,this.botProcessingModes=void 0,this.commandUrl=void 0,this.botParticipantId=void 0,this.botEndpointId=void 0,this.botSubscription&&(this.botSubscription.dispose(),this.botSubscription=void 0),this.setStatus(e)}getProcessingModesPropertiesAutoRecording(){var e,t;return!(!this.hasProcessingMode(h.ProcessingMode.Recording)||!(null===(t=null===(e=this.botProcessingModes[h.ProcessingMode.Recording])||void 0===e?void 0:e.properties)||void 0===t?void 0:t.autoRecording))}isFailed(){return this.bot&&this.bot.stateReason&&!d.ValidParticipantStateReasons.includes(this.bot.stateReason)}botStateChanged(e){var t,n,i;if(e.state===s.b1.Connected||e.state===s.b1.Connecting||e.state===s.b1.Staging)try{let a=e.endpoints.endpointDetails[0];if(null===(t=null==a?void 0:a.endpointMetadata)||void 0===t?void 0:t.joinTime)for(const t of e.endpoints.endpointDetails)new Date(t.endpointMetadata.joinTime)>new Date(a.endpointMetadata.joinTime)&&(a=t);const o=a.endpointMetadata.eventName||"None";if(this.botEndpointId=a.endpointId,this.botParticipantId!==a.participantId&&e.endpoints.endpointDetails.length>1&&this.logger.info(`Handover detected, switch to endpoint(${a.participantId}), joined at ${new Date(a.endpointMetadata.joinTime).toJSON()} to process: ${this.processingMode}, number of endpoints: ${e.endpoints.endpointDetails.length}`),this.botParticipantId=a.participantId,this.commandUrl=a.endpointMetadata.commandUrl,this.spokenLanguage=null===(n=a.endpointMetadata.spokenLanguage)||void 0===n?void 0:n.toLowerCase(),this.botProcessingModes=a.endpointMetadata.processingModes,this.botProcessingModes){if(this.recordingInitiatorUserId=null===(i=a.endpointMetadata.processingModes[h.ProcessingMode.Recording])||void 0===i?void 0:i.userId,this.hasProcessingMode(h.ProcessingMode.Transcript)&&this.botProcessingModes[h.ProcessingMode.Transcript].properties){this.transcriptScopeId=this.botProcessingModes[h.ProcessingMode.Transcript].properties.scopeId,this.transcriptStorageId=this.botProcessingModes[h.ProcessingMode.Transcript].properties.storageId,this.transcriptCommandInitiatorUserId=this.botProcessingModes[h.ProcessingMode.Transcript].userId,this.transcriptEditId=this.botProcessingModes[h.ProcessingMode.Transcript].properties.editId,this.dataSourceId=c.CallUtilities.getSourceIdForMediaTypeFromEndpoint(a,s.DD.Data);this.botProcessingModes[h.ProcessingMode.Transcript].properties.inRoomAttributionIssues?(this.inRoomAttributionIssues=this.botProcessingModes[h.ProcessingMode.Transcript].properties.attributionIssuesDetails,this.logger.info(`Current meeting has in room attribution issues: ${this.inRoomAttributionIssues}`)):this.inRoomAttributionIssues=null}if(this.hasProcessingMode(h.ProcessingMode.Transcript)||this.hasProcessingMode(h.ProcessingMode.ClosedCaptions)){const e=this.getTextTracksFromEndpointMetadata(a.endpointMetadata),t=!v(e,this.textTracks);this.textTracks=t?e:this.textTracks}}this.event("botStateChanged").raise(o)}catch(e){this.logger.error(`Error parsing Calling Bot metadata, ${g.CallingTelemetryService.getErrorMessage(e)}`)}}getTextTracksFromEndpointMetadata(e){var t,n;const i=[];return null===(n=null===(t=null==e?void 0:e.textTracks)||void 0===t?void 0:t.forEach)||void 0===n||n.call(t,(e=>{var t;(null===(t=null==e?void 0:e.translations)||void 0===t?void 0:t.length)>0?i.push(...this.getTextTracksFromEndpointMetadataTrackWithTranslations(e)):i.push(this.getTextTrackFromEndpointMetadataTrack(e))})),i.length>0?i:[this.getDefaultTrack()]}getTextTrackFromEndpointMetadataTrack(e){var t;return{language:null===(t=null==e?void 0:e.lang)||void 0===t?void 0:t.toLowerCase(),source:m(null==e?void 0:e.source)}}getTextTracksFromEndpointMetadataTrackWithTranslations(e){var t;const n=m(null==e?void 0:e.source);return null===(t=e.translations)||void 0===t?void 0:t.map((e=>({language:e,source:n})))}getDefaultTrack(){return{language:this.getSpokenLanguage(),source:a.Ai}}getConsumerType(){return this.config.isTflUser()?i.TeamsForLife:i.Teams}onBotAdded(e){this.bot=e,this.setStatus(h.CallingBotStatus.added),this.botSubscription=e.changed((()=>this.botStateChanged(e))),this.botStateChanged(e)}onBotChanged(e){this.bot&&this.onBotRemoved(),e&&this.onBotAdded(e)}getEndpointMetadataByProcessingMode(e,t){var n,i,a,o,r,s;for(const l of null!==(i=null===(n=null==e?void 0:e.endpoints)||void 0===n?void 0:n.endpointDetails)&&void 0!==i?i:[])if(null===(o=null===(a=null==l?void 0:l.endpointMetadata)||void 0===a?void 0:a.processingModes)||void 0===o?void 0:o[t])return null===(s=null===(r=null==l?void 0:l.endpointMetadata)||void 0===r?void 0:r.processingModes)||void 0===s?void 0:s[t];return null}findBotFromCall(){const e=[];for(const t of this.call.participants){const n=this.getEndpointMetadataByProcessingMode(t,this.processingMode);if(n){if((this.isAcsBot(t)?h.CallingBotType.AcsBot:h.CallingBotType.TeamsBot)!==this.botType)continue}(null==n?void 0:n.state)===h.ProcessingModeState.Active?e.unshift(t):n&&e.push(t)}return e[0]}isAcsBot(e){var t,n;return((null===(n=(t=this.config).getAcsBotMris)||void 0===n?void 0:n.call(t))||["28:6b45c5b6-1c34-47c0-8980-11e98d47d23f"]).includes(e.id)}subscribeToCall(){(0,p.safeSubscribeToCall)(this.call,(e=>{if(e.state===s.OX.Disconnected&&this.bot)return void this.onBotRemoved();const t=null!=this.processingMode?this.findBotFromCall():(0,l.find)(e.participants,(e=>e.id===this.botMRI));t!==this.bot&&(null!=t&&t.id!==this.botMRI&&(this.botMRI=t.id),this.onBotChanged(t))}),!0)}getMeetingOrganizer(e){let t;try{const n=new RegExp("context(.*?)(style|target)","g"),i=new RegExp('"Oid":"(.*?)"',"g"),a=n.exec(e)[1],o=decodeURIComponent(a);t=this.chatServiceUtils.getTeamsUserMriPrefix()+i.exec(decodeURIComponent(o))[1]}catch(e){this.logger.error(`Failed to decode meeting details invitation blob. ${g.CallingTelemetryService.getErrorMessage(e)}`),t=""}return t}fulfillBotPayloadForChannel(e,t,n){var i,a,o,s,l,c,d,g,u;return(0,r.__awaiter)(this,void 0,void 0,(function*(){let r,p,h;return(null===(i=t.enableT2AsyncChannelService)||void 0===i?void 0:i.call(t))?(p=yield null===(o=(a=this.channelService).getChannelByObjectIdAsync)||void 0===o?void 0:o.call(a,this.call.threadId),h=p?yield null===(l=(s=this.channelService).getTeamByObjectIdAsync)||void 0===l?void 0:l.call(s,p.parentTeamId||p.objectId):null):(p=null===(d=(c=this.channelService).getChannelByObjectId)||void 0===d?void 0:d.call(c,this.call.threadId),h=p?null===(u=(g=this.channelService).getTeamByObjectId)||void 0===u?void 0:u.call(g,p.parentTeamId):null),p&&h||(r=`Couldn't get teamName (${!!h}) or channelName (${!!p})`,this.logger.error(r),null==n||n.forEach((e=>{null==e||e.mark(C.Constants.scenarios.calling.recording.channelTeamNotFetched,{channel:!!p,team:!!h})}))),e.modernGroupId=h&&h.siteInfo&&h.siteInfo.groupId,e.teamName=h?h.displayName:this.callTitleService.defaultMeetingTitle,e.channelName=p?p.displayName:this.callTitleService.defaultMeetingTitle,e.meetingTitle=this.callTitleService.getMeetupTitleForCall(this.call)||e.meetingTitle,r}))}}},289712:(e,t,n)=>{n.r(t),n.d(t,{CallingBotCommand:()=>i,CallingBotCommandMode:()=>a,CallingBotCommandCallType:()=>o,CallingBotRestClient:()=>l});var i,a,o,r=n(361366),s=n(796973);!function(e){e.makeAllEntriesEdit="makeAllEntriesEdit",e.makeSingleEntryEdit="makeSingleEntryEdit",e.ovfdMessage="ovfdmessage",e.addLanguage="addLanguage",e.setLanguage="setLanguage",e.start="start",e.stop="stop",e.userSettingsUpdate="userSettingsUpdate",e.setUserToken="setUserToken",e.reportParticipant="editMisrecognizedParticipant"}(i||(i={})),function(e){e.transcription="transcription",e.cloudpeoplefeed="cloudpeoplefeed",e.recording="recording",e.combined="combined"}(a||(a={})),function(e){e.transcript="transcript",e.coach="coach",e.cloudpeoplefeed="cloudpeoplefeed",e.recording="recording"}(o||(o={}));class l{constructor(e,t,n){this.httpService=e,this.authenticationService=t,this.helpers=n}sendCommand(e,t,n,i,o,s,l,c,d,g,u){return(0,r.__awaiter)(this,void 0,void 0,(function*(){let p={timestamp:(new Date).toJSON(),participantMri:n,participantLegId:i,action:t,mode:c,processingModes:d,actionParameters:void 0};c===a.combined&&delete p.mode,g&&(p=Object.assign(Object.assign({},p),{actionParameters:Object.assign(Object.assign({},g),{type:t})}));try{const t=this.getOptions(o,s,l),n=yield this.getAuthenticationHeaders(!1,u),i=Object.assign(Object.assign({},t),{headers:Object.assign(Object.assign({},t.headers),n)});return yield this.httpService.post(e,i,p)}catch(e){throw yield function(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){try{if(e instanceof Response){const t=yield e.text(),n={statusCode:e.status,errorBody:{},errorMessage:t,toString:()=>t};try{n.errorBody=JSON.parse(t)}catch(e){n.errorBody.Message=t}return n}return{statusCode:e.statusCode,errorBody:JSON.parse(e.errorMessage),errorMessage:e.errorMessage,toString:()=>e.errorMessage}}catch(t){throw e}}))}(e)}}))}getAuthenticationHeaders(e=!1,t){return Promise.all([this.authenticationService.getSkypeToken(e),this.helpers.getAuthToken().catch((()=>null))]).then((([e,n])=>(n||(null==t||t.forEach((e=>null==e?void 0:e.mark(s.Constants.scenarios.calling.combinedRecordingBot.commandSteps.getTokenFailed))),n=e),{[s.Constants.headers.tokens.authorization]:`Bearer ${n}`,[s.Constants.headers.tokens.xSkypeToken]:e})))}getOptions(e,t,n){return{callType:n,headers:{[s.Constants.headers.contentType]:s.Constants.headers.jsonContent,[s.Constants.categories.requestId]:t,[s.Constants.headers.skypeChainId]:e}}}}},285250:(e,t,n)=>{n.d(t,{H:()=>a,V:()=>o});var i=n(360452);const a=[i.OX.Notified,i.OX.Connecting,i.OX.Connected,i.OX.Disconnecting,i.OX.Disconnected,i.OX.Observing];var o;!function(e){e[e.Unknown=0]="Unknown",e[e.Regular=1]="Regular",e[e.ScreensharingOnly=2]="ScreensharingOnly",e[e.Escalated=3]="Escalated"}(o||(o={}))},178831:(e,t,n)=>{var i;n.d(t,{T:()=>i}),function(e){e[e.WindowRestored=0]="WindowRestored",e[e.WindowMinimized=1]="WindowMinimized"}(i||(i={}))},720482:(e,t,n)=>{var i;n.d(t,{y:()=>i}),function(e){e[e.none=0]="none",e[e.started=1]="started",e[e.failed=2]="failed"}(i||(i={}))},225927:(e,t,n)=>{var i,a;n.r(t),n.d(t,{CallStateExt:()=>i,NetworkReconnectStatus:()=>a}),function(e){e[e.Reconnecting=1e3]="Reconnecting",e[e.Transferring=1001]="Transferring",e[e.TransferFailed=1002]="TransferFailed",e[e.TransferSucceeded=1003]="TransferSucceeded",e[e.Escalating=1004]="Escalating",e[e.EscalationFailed=1005]="EscalationFailed",e[e.EscalationSucceeded=1006]="EscalationSucceeded",e[e.Parking=1007]="Parking",e[e.ParkSucceeded=1008]="ParkSucceeded",e[e.ParkFailed=1009]="ParkFailed",e[e.MusicOnHold=1010]="MusicOnHold",e[e.Aborted=1011]="Aborted"}(i||(i={})),function(e){e[e.Good=0]="Good",e[e.Poor=1]="Poor",e[e.Bad=2]="Bad"}(a||(a={}))},56484:(e,t,n)=>{n.r(t),n.d(t,{GestureBasedReactionState:()=>i,GestureBasedReactionStatus:()=>a,GestureBasedReactionType:()=>o,GestureBasedReactionMixinService:()=>u});var i,a,o,r=n(361366),s=n(360452),l=n(197981),c=n(796973),d=n(686621);!function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.Unsupported="Unsupported"}(i||(i={})),function(e){e.Init="Initial",e.Cancel="Cancel",e.Complete="Completed"}(a||(a={})),function(e){e.thumbsUp="ThumbsUp",e.heart="Heart",e.applause="Applause",e.handRaised="HandRaised",e.fingerRaised="FingerRaised"}(o||(o={}));class g{constructor(e,t,n,a,o,r,s,l){this.config=e,this.call=t,this.desktopUtilityService=n,this.deviceManagerService=a,this.eventingService=o,this.loggingService=r,this.storageService=s,this.platformDetectService=l,this.gestureReactionCountdownInMs=1500,this.logger=r.newLogger("GestureBasedReactionMixin"),this.isGestureBasedReactionEnabled=this.config.isGestureBasedReactionEnabled()&&this.desktopUtilityService.isDesktop()&&!this.platformDetectService.isRigel()&&!this.desktopUtilityService.isPluginless()&&!l.isElectronAppSurfaceHub(),this.gestureBasedReactionOption={state:i.Unsupported,stateDescription:null},this.isGestureBasedReactionEnabled&&this.subscribeToCallEvents()}getGestureBasedReactionOption(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){return this.isGestureBasedReactionEnabled?(yield this.initGestureBasedReactionOption(),this.gestureBasedReactionOption):this.gestureBasedReactionOption}))}toggleGestureBasedReactionOption(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){if(!this.isGestureBasedReactionEnabled||this.gestureBasedReactionOption.state===i.Unsupported)return Promise.resolve(!1);const e=!this.userSelectedOption;try{return this.logger.info(`toggleGestureBasedReactionOption: changing from: ${this.userSelectedOption} to ${e}`),yield this.deviceManagerService.setVideoEffectOnDevice("GestureDetection",e,"GestureBasedReactions"),this.userSelectedOption=e,this.storageService.set(c.Constants.events.calling.userSelectionForGestureBasedReaction,e),e?this.subscribeToGestureBasedReaction():this.unsubscribeGestureBasedReaction(),Promise.resolve(e)}catch(e){return this.logger.error(`toggleGestureBasedReactionOption: failed with error: ${e}`),Promise.reject(e)}}))}initialize(){let e=this.storageService.get(c.Constants.events.calling.userSelectionForGestureBasedReaction);this.logger.info(`initialize: gestureBasedReactionEnabled: ${this.isGestureBasedReactionEnabled}, userSelection: ${e}`),null==e&&(e="true"),this.userSelectedOption="true"===e,this.initGestureBasedReactionOption().then((()=>{(this.gestureBasedReactionOption.state===i.Disabled&&this.userSelectedOption?this.deviceManagerService.setVideoEffectOnDevice("GestureDetection",this.userSelectedOption,"GestureBasedReactions"):Promise.resolve()).then((()=>{this.subscribeToGestureBasedReaction()})).catch((e=>{this.logger.error(`initialize: failed to update the gesture based reaction state to: ${this.userSelectedOption}, error: ${JSON.stringify(e)}`)}))}))}subscribeToCallEvents(){const e=this.call.on("callStateChanged",(()=>{switch(this.call.state){case s.OX.Disconnected:e.dispose(),this.unsubscribeGestureBasedReaction();break;case s.OX.Connected:this.initialize()}}))}subscribeToGestureBasedReaction(){isNaN(this.gestureBasedReactionEventSubscription)&&!1!==this.userSelectedOption&&this.initGestureBasedReactionOption().then((()=>{this.gestureBasedReactionOption.state===i.Enabled&&(this.gestureBasedReactionEventSubscription=this.deviceManagerService.subscribe(((e,t)=>this.onGestureBasedReactionReceived(t.payload)))),this.logger.info(`GestureBasedReactionOption ${this.gestureBasedReactionOption.state}, subscription: ${this.gestureBasedReactionEventSubscription}`)}))}unsubscribeGestureBasedReaction(){isNaN(this.gestureBasedReactionEventSubscription)||(this.deviceManagerService.unsubscribe(this.gestureBasedReactionEventSubscription),this.gestureBasedReactionEventSubscription=void 0)}initGestureBasedReactionOption(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){try{const e=yield this.deviceManagerService.getGestureBasedReactionCapability();switch(this.logger.info(`initGestureBasedReactionOption: got VideoEffectState: ${e}`),e){case"On":this.gestureBasedReactionOption.state=i.Enabled;break;case"Off":this.gestureBasedReactionOption.state=i.Disabled;break;case"Unavailable":default:this.gestureBasedReactionOption.state=i.Unsupported}}catch(e){this.gestureBasedReactionOption.state=i.Unsupported}}))}onGestureBasedReactionReceived(e){if(this.logger.info(`onGestureBasedReactionReceived: received gesture: ${null==e?void 0:e.detectedGesture}, and state: ${null==e?void 0:e.detectionState}`),!e||!(0,l.values)(a).includes(e.detectionState)||!(0,l.values)(o).includes(e.detectedGesture))return;const t={teamsCallId:this.call.teamsCallId.toString(),meetingReactionType:e.detectedGesture,status:e.detectionState,countdownTimeInMs:this.config.gestureReactionCountdownInMs()||this.gestureReactionCountdownInMs};this.eventingService.emit(c.Constants.events.calling.gestureBasedReactionEventReceived,t)}}class u{constructor(e,t,n,i,a,o,r){this.config=e,this.desktopUtilityService=t,this.deviceManagerService=n,this.eventingService=i,this.loggingService=a,this.storageService=o,this.platformDetectService=r,this.logger=a.newLogger("GestureBasedReactionMixinService")}mixTeamsCall(e){const t=new g(this.config,e,this.desktopUtilityService,this.deviceManagerService,this.eventingService,this.loggingService,this.storageService,this.platformDetectService);d.TeamsCallService.bindProps(e,t,[],this.logger),d.TeamsCallService.bindMethods(e,t,["getGestureBasedReactionOption","toggleGestureBasedReactionOption"],this.logger)}}},878081:(e,t,n)=>{var i,a,o;n.d(t,{dx:()=>i,H8:()=>a,NH:()=>o}),function(e){e.Created="Created",e.Ready="Ready",e.Started="Started",e.Stopping="Stopping",e.Stopped="Stopped"}(i||(i={})),function(e){e.None="None",e.FeatureDisabled="FeatureDisabled",e.UnsupportedPlatform="UnsupportedPlatform",e.OutdatedClient="OutdatedClient",e.DisabledByPolicy="DisabledByPolicy",e.UnsupportedUserMeetingRole="UnsupportedUserMeetingRole",e.DisabledDueToViewOnlyAttendeesInMeeting="DisabledDueToViewOnlyAttendeesInMeeting",e.ValidationPending="ValidationPending"}(a||(a={})),function(e){e.startStreamTo="startStreamTo",e.stopStreamTo="stopStreamTo"}(o||(o={}))},773982:(e,t,n)=>{var i,a;n.d(t,{k:()=>i,B:()=>a}),function(e){e.StartOrStopRecording="startOrStopRecording",e.Share="share",e.ChangeMeetingRole="changeMeetingRole",e.AdmitOrDenyParticipantInLobby="admitOrDenyParticipantInLobby",e.RemoveParticipant="removeParticipant",e.MuteParticipant="muteParticipant",e.MuteAll="muteAll",e.TakeControl="takeControl",e.LowerAllHands="lowerAllHands",e.UpdateAttendeeRestrictions="updateAttendeeRestrictions",e.RequestToSpeak="requestToSpeak"}(i||(i={})),function(e){e[e.UpdateMeetingSettings=5661]="UpdateMeetingSettings",e[e.UpdateParticipant=5651]="UpdateParticipant"}(a||(a={}))},911868:(e,t,n)=>{var i;n.r(t),n.d(t,{MultichannelAudioBandwidthMode:()=>i,MultichannelAudioBandwidthEvents:()=>a}),function(e){e[e.Good=0]="Good",e[e.Poor=1]="Poor",e[e.Bad=2]="Bad",e[e.Unknown=3]="Unknown"}(i||(i={}));const a={dynamicBandwidth:"dynamicBandwidth"}},785654:(e,t,n)=>{var i;n.d(t,{d:()=>i}),function(e){e[e.announcement=0]="announcement",e[e.tooltipNotification=1]="tooltipNotification"}(i||(i={}))},250295:(e,t,n)=>{n.r(t),n.d(t,{BotSourceType:()=>i,ErrorReason:()=>c,RTMPInMixinService:()=>g});var i,a=n(360452),o=n(796973),r=n(686621),s=n(268316),l=n(62606);!function(e){e.RTMPInput="rtmpinput"}(i||(i={}));const c={RtmpInBotJoinedAfterTimeoutThreshold:"RtmpInBotJoinedAfterTimeoutThreshold",RtmpInBotRemovedFromOngoingCall:"RtmpInBotRemovedFromOngoingCall",RtmpInBotNeverJoinedCall:"RtmpInBotNeverJoinedCall",UserLeftCallBeforeTimeoutDuration:"UserLeftCallBeforeTimeoutDuration",CallNotBroadcastType:"CallIsNotBroadcast"};class d{constructor(e,t,n){this.call=e,this.loggingService=t,this.config=n,this.logger=t.newLogger("RTMPInMixinImplementation"),this.hasRtmpInBotEverJoined=!1,this.isRtmpInBotInCall=!1,this.isRtmpCaptionsAvailable=!1,this.latestRtmpInStatus=void 0,this.callInitializedTimestamp=Date.now(),this.subscribeToCallEvents()}get rtmpInProperties(){var e,t,n;const i=null===(n=null===(t=null===(e=this.call)||void 0===e?void 0:e.meetingDetails)||void 0===t?void 0:t.meetingCapability)||void 0===n?void 0:n.rtmpEnabled;return i!=this.latestRtmpInStatus&&(this.logger.info(`Received the following RTMPInProperties from meetingDetails.meetingCapability, rtmpEnabled: ${i}`),this.latestRtmpInStatus=i),{rtmpEnabled:i}}isUserAttendee(){var e;return"attendee"===(null===(e=this.call)||void 0===e?void 0:e.meetingRole)}dispose(){this.callChangedSubscription&&(this.callChangedSubscription.dispose(),this.callChangedSubscription=null),this.participantAddedSubscription&&(this.participantAddedSubscription.dispose(),this.participantAddedSubscription=null),this.participantRemovedSubscription&&(this.participantRemovedSubscription.dispose(),this.participantRemovedSubscription=null),this.participantChangedSubscription&&(this.participantChangedSubscription.dispose(),this.participantChangedSubscription=null),this.trackedRtmpBot=null}subscribeToCallEvents(){this.participantAddedSubscription=this.call.on("participantAdded",(e=>{if(this.rtmpInProperties.rtmpEnabled&&e.id.startsWith("28:"))if(e.endpoints)this.processBotParticipant(e);else{const t=e.changed((()=>{e.endpoints&&(t.dispose(),this.processBotParticipant(e))}))}})),this.participantRemovedSubscription=this.call.on("participantRemoved",(e=>{if(!this.rtmpInProperties.rtmpEnabled)return;l.CallUtilities.isParticipantAnRtmpInBot(e)&&(this.isRtmpCaptionsAvailable&&this.removeClosedCaptionsTextTrackForRTMPBot(),this.handleRtmpInBotRemovedScenario())})),this.callChangedSubscription=(0,s.safeSubscribeToCall)(this.call,(e=>{e.state!==a.OX.Disconnected&&e.state!==a.OX.Disconnecting||this.handleCallDisconnected()}),!0)}handleCallDisconnected(){if(this.dispose(),this.rtmpInProperties.rtmpEnabled&&!this.isUserAttendee())if(this.hasRtmpInBotEverJoined){if(this.isRtmpInBotInCall){const e=this.loggingService.newScenario(o.Constants.scenarios.broadcast.rtmpInBotRemoved),t=this.call.participants.find(l.CallUtilities.isParticipantAnRtmpInBot);e.stop(this.getEventData(void 0,{participantIdOfBot:(null==t?void 0:t.id)||""}))}}else{const e=this.loggingService.newScenario(o.Constants.scenarios.broadcast.rtmpInBotAdded),t=this.calcTimeWindowElapsed();this.hasTimeoutWindowLapsed(t)?this.call.isBroadcast?e.fail(this.getEventData(c.RtmpInBotNeverJoinedCall,{callDisconnectedAfter:t})):e.cancel(this.getEventData(c.CallNotBroadcastType)):e.cancel(this.getEventData(c.UserLeftCallBeforeTimeoutDuration))}}processBotParticipant(e){l.CallUtilities.isParticipantAnRtmpInBot(e)&&(this.trackedRtmpBot=e,this.subscribeToRtmpBot(),this.handleRtmpInBotAddedScenario(),this.handleClosedCaptionsTextTrackForRTMPBot())}subscribeToRtmpBot(){this.participantChangedSubscription=this.trackedRtmpBot.changed((()=>{this.handleClosedCaptionsTextTrackForRTMPBot()}))}getEventData(e,t){var n;const i={};i[o.Constants.counters.eventNames.id]=this.call.callId,i[o.Constants.counters.eventNames.callId]=this.call.callId,i[o.Constants.counters.eventNames.participantId]=this.call.participantId;let a={isRtmpEnabled:(null===(n=this.call.rtmpInProperties)||void 0===n?void 0:n.rtmpEnabled)||!1,callState:l.CallUtilities.stringifyCallState(this.call.state),isBroadcast:this.call.isBroadcast||!1};return t&&(a=Object.assign(Object.assign({},a),t)),i[o.Constants.scenarioDataPropNames.broadcastData]=JSON.stringify(a),e&&(i[o.Constants.scenarioDataPropNames.broadcastError]=JSON.stringify(e)),i}handleClosedCaptionsTextTrackForRTMPBot(){var e,t,n,i;const a=null===(t=null===(e=this.trackedRtmpBot)||void 0===e?void 0:e.endpoints)||void 0===t?void 0:t.endpointDetails,o=a&&(null===(i=null===(n=a[0])||void 0===n?void 0:n.endpointMetadata)||void 0===i?void 0:i.mcrData),r=[];let s=null;const l=o&&o.textTracks;l&&Array.isArray(l)&&l.length>0&&l.forEach((e=>{const t={source:e.source,language:e.lang};this.call.hasActiveClosedCaptionsTextTrack(t)||(s=t,r.push(t))})),s&&this.addClosedCaptionsTextTrackForRTMPBot(s,r),(!l||Array.isArray(l)&&0==l.length)&&this.isRtmpCaptionsAvailable&&this.removeClosedCaptionsTextTrackForRTMPBot()}addClosedCaptionsTextTrackForRTMPBot(e,t){var n;this.isRtmpCaptionsAvailable=!0,this.call.addClosedCaptionsTextTracks(t);const i=this.call.getActiveClosedCaptionsTextTracks();if(!this.isUserAttendee()){this.loggingService.newScenario(o.Constants.scenarios.broadcast.rtmpInBotTextTrackAdded).stop(this.getEventData(void 0,{participantIdOfBot:(null===(n=this.trackedRtmpBot)||void 0===n?void 0:n.id)||"",isRtmpCaptionsAvailable:this.isRtmpCaptionsAvailable,newTrackAddedbyBot:Object.assign({},e),currentActiveTracks:Object.assign({},i)}))}}removeClosedCaptionsTextTrackForRTMPBot(){var e,t,n,i,a;const r=null===(t=null===(e=this.trackedRtmpBot)||void 0===e?void 0:e.endpoints)||void 0===t?void 0:t.endpointDetails,s=r&&(null===(i=null===(n=r[0])||void 0===n?void 0:n.endpointMetadata)||void 0===i?void 0:i.mcrData);this.call.removeClosedCaptionsTextTracks(s.textTracks);const l=this.call.getActiveClosedCaptionsTextTracks();if(!this.isUserAttendee()){this.loggingService.newScenario(o.Constants.scenarios.broadcast.rtmpInBotTextTrackRemoved).stop(this.getEventData(void 0,{participantIdOfBot:(null===(a=this.trackedRtmpBot)||void 0===a?void 0:a.id)||"",currentActiveTracks:Object.assign({},l)}))}}handleRtmpInBotAddedScenario(){var e;if(!this.isRtmpInBotInCall){if(!this.isUserAttendee()){const t=this.loggingService.newScenario(o.Constants.scenarios.broadcast.rtmpInBotAdded);let n="";const i=this.calcTimeWindowElapsed();this.hasTimeoutWindowLapsed(i)&&(n=c.RtmpInBotJoinedAfterTimeoutThreshold),t.stop(this.getEventData(n,{participantIdOfBot:(null===(e=this.trackedRtmpBot)||void 0===e?void 0:e.id)||"",botJoinedCallAfter:i}))}this.hasRtmpInBotEverJoined=!0,this.isRtmpInBotInCall=!0}}handleRtmpInBotRemovedScenario(){var e,t;if(!this.isUserAttendee()){const n=this.loggingService.newScenario(o.Constants.scenarios.broadcast.rtmpInBotRemoved);this.call.state===a.OX.Disconnecting||this.call.state===a.OX.Disconnected?n.stop(this.getEventData(void 0,{participantIdOfBot:(null===(e=this.trackedRtmpBot)||void 0===e?void 0:e.id)||""})):n.cancel(this.getEventData(c.RtmpInBotRemovedFromOngoingCall,{participantIdOfBot:(null===(t=this.trackedRtmpBot)||void 0===t?void 0:t.id)||""}))}this.trackedRtmpBot=null,this.isRtmpInBotInCall=!1}calcTimeWindowElapsed(){return Date.now()-this.callInitializedTimestamp}hasTimeoutWindowLapsed(e){return e>this.config.rtmpBotJoinTimeoutThresholdInMs()}}class g{constructor(e,t){this.loggingService=e,this.config=t,this.logger=e.newLogger("RTMPInMixinService")}mixTeamsCall(e){const t=new d(e,this.loggingService,this.config);r.TeamsCallService.bindProps(e,t,["rtmpInProperties"],this.logger)}}},150165:(e,t,n)=>{var i,a,o;n.d(t,{ve:()=>i,z3:()=>a,BI:()=>o}),function(e){e[e.SourceOCR=0]="SourceOCR"}(i||(i={})),function(e){e[e.TypeUnknown=0]="TypeUnknown",e[e.TypeMsOcr=1]="TypeMsOcr",e[e.TypeOneOcrV2=2]="TypeOneOcrV2",e[e.TypeOneOcrV3=3]="TypeOneOcrV3"}(a||(a={})),function(e){e[e.Started=0]="Started",e[e.Updated=1]="Updated",e[e.Captured=2]="Captured",e[e.Processed=3]="Processed",e[e.Stopped=4]="Stopped",e[e.Error=5]="Error"}(o||(o={}))},811407:(e,t,n)=>{var i;n.d(t,{C:()=>i}),function(e){e[e.NotControlCapable=0]="NotControlCapable",e[e.Disabled=1]="Disabled",e[e.NotInControl=2]="NotInControl",e[e.RequestSent=3]="RequestSent",e[e.InControl=4]="InControl"}(i||(i={}))},991419:(e,t,n)=>{var i;n.d(t,{o:()=>i}),function(e){e[e.None=0]="None",e[e.InGreenRoom=1]="InGreenRoom",e[e.InStagingRoom=2]="InStagingRoom",e[e.SuccessfullyMovedToMainMeeting=3]="SuccessfullyMovedToMainMeeting",e[e.FailedToBeMovedToMainMeeting=4]="FailedToBeMovedToMainMeeting",e[e.MeetingIsLive=5]="MeetingIsLive"}(i||(i={}))},776081:(e,t,n)=>{var i,a,o;n.r(t),n.d(t,{TranscriptDownloadFormat:()=>i,TranscriptEventType:()=>a,TranscriptEditType:()=>o}),function(e){e.Vtt="Vtt",e.Docx="Docx",e.Pdf="Pdf"}(i||(i={})),function(e){e.CallStarted="CallStarted",e.CallEnded="CallEnded",e.TranscriptStarted="TranscriptStarted",e.TranscriptEnded="TranscriptStopped",e.ParticipantJoined="ParticipantJoined",e.ParticipantLeft="ParticipantLeft",e.UserEdit="UserEdit",e.RoomAttributionStarted="RoomAttributionStarted",e.RoomAttributionStopped="RoomAttributionStopped",e.Published="TranscriptPublished",e.SessionHandover="SessionHandover"}(a||(a={})),function(e){e.Speaker="Speaker"}(o||(o={}))},454938:(e,t,n)=>{var i;n.d(t,{E:()=>i}),function(e){e.Cameo="Cameo",e.ContentOnly="ContentOnly",e.Weatherperson="Weatherperson",e.SideBySide="SideBySide",e.NewsAnchor="NewsAnchor"}(i||(i={}))},239819:(e,t,n)=>{n.d(t,{z:()=>i});class i{}i.ApplicationIntegrationEnabled="applicationIntegrationEnabled"},40653:(e,t,n)=>{var i,a,o,r,s;n.d(t,{yj:()=>i,qj:()=>a,C_:()=>o,HJ:()=>r,cR:()=>s}),function(e){e.Initial="initial",e.Success="success",e.DownloadScheduled="download_scheduled",e.Error="error"}(i||(i={})),function(e){e.DownloadFailure="DownloadFailure",e.UnpackingFailure="UnpackingFailure",e.VerificationFailure="VerificationFailure",e.InstallationFailure="InstallationFailure",e.IpcTimeout="IpcTimeout",e.NotSupported="NotSupported",e.UnknownFailure="UnknownFailure",e.CannotEnableDuringMeeting="CannotEnableDuringMeeting"}(a||(a={})),function(e){e.NdiRealObject="createNdi() returned real object",e.NdiUndefined="createNdi() returned undefined",e.SlimcoreInitializedFailed="Slimcore failed to initialize",e.SlimcoreInitializedSuccess="Slimcore initialized successfully",e.NDITriggeredManually="NDI triggered manually in UI",e.NDITriggeredAutomatically="NDI triggered automatically, enabled during previous client run"}(o||(o={})),function(e){e.Local="Local",e.ActiveSpeaker="ActiveSpeaker"}(r||(r={})),function(e){e.On="on",e.Off="off",e.Fade="fade"}(s||(s={}))},364813:(e,t,n)=>{var i;n.d(t,{L:()=>i}),function(e){e.LocationResponseUpdate="updateFromLocationResponse",e.CallingStackInit="availableDuringCallingStackInit",e.AggregateSettingsUpdate="updateFromAggregateSettings"}(i||(i={}))},746552:(e,t,n)=>{var i,a,o;n.d(t,{k$:()=>i,KP:()=>a,qp:()=>o}),function(e){e[e.Any=0]="Any",e[e.Never=1]="Never",e[e.Chat=2]="Chat",e[e.Reply=3]="Reply",e[e.ReplyToReply=4]="ReplyToReply",e[e.Like=5]="Like",e[e.Mention=6]="Mention",e[e.TeamMembershipChange=7]="TeamMembershipChange",e[e.AddedToTeam=8]="AddedToTeam",e[e.PromotedToTeamAdmin=9]="PromotedToTeamAdmin",e[e.Download=10]="Download",e[e.Follow=11]="Follow",e[e.CallOrMeetup=12]="CallOrMeetup",e[e.ThirdParty=13]="ThirdParty",e[e.Unread=14]="Unread",e[e.Inferred=15]="Inferred",e[e.MessageSendFailed=16]="MessageSendFailed",e[e.LikeInChat=17]="LikeInChat",e[e.MentionInChat=18]="MentionInChat",e[e.CallTransferFailed=19]="CallTransferFailed",e[e.Call=20]="Call",e[e.MissedCall=21]="MissedCall",e[e.Voicemail=22]="Voicemail",e[e.GroupRenewal=23]="GroupRenewal",e[e.Error=24]="Error",e[e.DesktopNotification=25]="DesktopNotification",e[e.Trending=26]="Trending",e[e.ShareFromChat=27]="ShareFromChat",e[e.PresenceStatus=28]="PresenceStatus",e[e.Priority=30]="Priority",e[e.Reaction=31]="Reaction",e[e.ReactionInChat=32]="ReactionInChat",e[e.TeamsTasks=34]="TeamsTasks",e[e.TeamsEngagementActivity=33]="TeamsEngagementActivity",e[e.DLP=35]="DLP",e[e.MsGraph=37]="MsGraph",e[e.StaffHub=38]="StaffHub",e[e.SkypeConsumerCall=42]="SkypeConsumerCall",e[e.SpamCall=43]="SpamCall",e[e.UserActivity=100]="UserActivity",e[e.NativeNotificationFre=150]="NativeNotificationFre",e[e.Recommendation=200]="Recommendation"}(i||(i={})),function(e){e[e.Team=1]="Team",e[e.Person=2]="Person",e[e.AddedToTeam=3]="AddedToTeam",e[e.PromotedToTeamAdmin=4]="PromotedToTeamAdmin",e[e.DownloadStarted=5]="DownloadStarted",e[e.Downloaded=6]="Downloaded",e[e.DownloadFailed=7]="DownloadFailed",e[e.ChannelReplyMessage=8]="ChannelReplyMessage",e[e.ChannelNewMessage=9]="ChannelNewMessage",e[e.Call=10]="Call",e[e.Meetup=11]="Meetup",e[e.Bot=12]="Bot",e[e.Channel=13]="Channel",e[e.MissedCall=14]="MissedCall",e[e.Voicemail=15]="Voicemail",e[e.ThirtyDayNotification=16]="ThirtyDayNotification",e[e.FifteenDayNotification=17]="FifteenDayNotification",e[e.RenewedNotification=18]="RenewedNotification",e[e.OneOnOneChat=19]="OneOnOneChat",e[e.GroupChat=20]="GroupChat",e[e.ShareFromChat=21]="ShareFromChat",e[e.Like=22]="Like",e[e.Angry=23]="Angry",e[e.Sad=24]="Sad",e[e.Laugh=25]="Laugh",e[e.Heart=26]="Heart",e[e.Surprised=27]="Surprised",e[e.NotifySender=28]="NotifySender",e[e.PendingSelfJoinRequest=29]="PendingSelfJoinRequest",e[e.PendingOnBehalfOfJoinRequest=30]="PendingOnBehalfOfJoinRequest",e[e.WelcomeNewUser=31]="WelcomeNewUser",e[e.PendingOnBehalfOfJoinRequestMultiple=32]="PendingOnBehalfOfJoinRequestMultiple",e[e.Tag=33]="Tag",e[e.TaskAssignedToYou=34]="TaskAssignedToYou",e[e.UrgentTaskAssignedToYou=35]="UrgentTaskAssignedToYou",e[e.YourTaskWasUpdated=36]="YourTaskWasUpdated",e[e.YourTaskChangedToNotStarted=37]="YourTaskChangedToNotStarted",e[e.YourTaskChangedToInProgress=38]="YourTaskChangedToInProgress",e[e.YourTaskChangedToCompleted=39]="YourTaskChangedToCompleted",e[e.YourTaskChangedToBlocked=40]="YourTaskChangedToBlocked",e[e.YourTaskChangedToRemoved=41]="YourTaskChangedToRemoved",e[e.YourTaskChangedToNotApplicable=42]="YourTaskChangedToNotApplicable",e[e.YourTaskWasReassigned=43]="YourTaskWasReassigned",e[e.YourTaskWasDeleted=44]="YourTaskWasDeleted",e[e.TaskListPublishedToYourTeam=45]="TaskListPublishedToYourTeam",e[e.TaskListRecalledFromYourTeam=46]="TaskListRecalledFromYourTeam",e[e.YourTaskWasMarkedUrgent=47]="YourTaskWasMarkedUrgent",e[e.YourTaskWasMarkedNotUrgent=48]="YourTaskWasMarkedNotUrgent",e[e.UrgentTaskPublishedToYourTeam=49]="UrgentTaskPublishedToYourTeam",e[e.MissedMeetingNudge=50]="MissedMeetingNudge",e[e.Backoff=51]="Backoff",e[e.TeamMention=52]="TeamMention",e[e.ChannelMention=53]="ChannelMention",e[e.UserMention=54]="UserMention",e[e.SmsChat=55]="SmsChat",e[e.CallAnsweredElsewhere=56]="CallAnsweredElsewhere",e[e.CallSafeTransferRingback=57]="CallSafeTransferRingback",e[e.SkypeConsumerCall=58]="SkypeConsumerCall",e[e.NewShift=60]="NewShift",e[e.SchedulePublished=61]="SchedulePublished",e[e.NewShiftRequest=62]="NewShiftRequest",e[e.ShiftRequestUpdated=63]="ShiftRequestUpdated",e[e.ShiftUpdated=64]="ShiftUpdated",e[e.AddedToSharedChannel=65]="AddedToSharedChannel",e[e.PromotedToSharedChannelOwner=66]="PromotedToSharedChannelOwner",e[e.SpamCall=67]="SpamCall",e[e.TFLPlanCreated=70]="TFLPlanCreated",e[e.TFLTaskAssigned=71]="TFLTaskAssigned",e[e.TFLTaskUnassigned=72]="TFLTaskUnassigned",e[e.TFLTaskAssignedDeleted=73]="TFLTaskAssignedDeleted",e[e.TFLTaskAssignedMarkedCompleted=74]="TFLTaskAssignedMarkedCompleted",e[e.TeamShareTeamOwnerNotify=75]="TeamShareTeamOwnerNotify",e[e.ChannelOwnerUnshareTeamOwnerNotify=76]="ChannelOwnerUnshareTeamOwnerNotify",e[e.TeamOwnerUnshareChannelOwnerNotify=77]="TeamOwnerUnshareChannelOwnerNotify",e[e.HostOwnerUnshareChannelOwnerNotify=78]="HostOwnerUnshareChannelOwnerNotify",e[e.HostOwnerUnshareTeamOwnerNotify=79]="HostOwnerUnshareTeamOwnerNotify",e[e.GenericReaction=80]="GenericReaction",e[e.ProactiveTaskFeed=81]="ProactiveTaskFeed",e[e.ProactiveMeetingFeed=82]="ProactiveMeetingFeed",e[e.Reminder=83]="Reminder",e[e.Word=84]="Word",e[e.CallBasicNative=85]="CallBasicNative",e[e.Everyone=300]="Everyone"}(a||(a={})),function(e){e[e.oneToOne=1]="oneToOne",e[e.groupCall=2]="groupCall",e[e.meeting=3]="meeting",e[e.chat=4]="chat",e[e.reply=5]="reply",e[e.replyToReply=6]="replyToReply",e[e.like=7]="like",e[e.mention=8]="mention",e[e.download=9]="download",e[e.appUpdated=10]="appUpdated",e[e.needMoreDiskSpace=11]="needMoreDiskSpace",e[e.teamMembershipChange=12]="teamMembershipChange",e[e.follow=13]="follow",e[e.oneToOnePstn=14]="oneToOnePstn",e[e.thirdparty=15]="thirdparty",e[e.messageSendFailed=16]="messageSendFailed",e[e.callTransferFailed=19]="callTransferFailed",e[e.shareFromChat=20]="shareFromChat",e[e.inferred=21]="inferred",e[e.trending=26]="trending",e[e.meetingWentLive=27]="meetingWentLive",e[e.presenceStatus=28]="presenceStatus",e[e.reaction=29]="reaction",e[e.priority=30]="priority",e[e.TeamsTasks=34]="TeamsTasks",e[e.dlp=35]="dlp",e[e.teamsEngagementActivity=36]="teamsEngagementActivity",e[e.msGraph=37]="msGraph",e[e.StaffHub=38]="StaffHub",e[e.callAnsweredElsewhere=40]="callAnsweredElsewhere",e[e.callSafeTransferRingback=41]="callSafeTransferRingback",e[e.skypeConsumerCall=42]="skypeConsumerCall",e[e.spamCall=43]="spamCall",e[e.callMissed=44]="callMissed",e[e.callBasicNative=45]="callBasicNative",e[e.default=100]="default"}(o||(o={}))},940739:(e,t,n)=>{var i;n.d(t,{N:()=>i}),function(e){e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected",e[e.Disconnected=3]="Disconnected",e[e.InLobby=4]="InLobby",e[e.CallFailed=5]="CallFailed"}(i||(i={}))},520940:(e,t,n)=>{n.d(t,{N:()=>i});class i{}i.none="none",i.setLayout="setLayout",i.start="start",i.stop="stop",i.switchPrimary="switchPrimary",i.failoverInstance="instanceFailover",i.updateMediaState="updateMediaState",i.restart="restart"},987822:(e,t,n)=>{n.r(t),n.d(t,{ProducerCommand:()=>i});class i{constructor(e){this.id=e.generateUUID()}}},318845:(e,t,n)=>{n.r(t),n.d(t,{ProducerFailoverInstanceCommand:()=>o});var i=n(987822),a=n(520940);class o extends i.ProducerCommand{constructor(e,t){super(e),this.name=a.N.failoverInstance,this.instanceFailoverTarget=t?"Primary":"Secondary"}}},611743:(e,t,n)=>{n.r(t),n.d(t,{ProducerRestartCommand:()=>o});var i=n(987822),a=n(520940);class o extends i.ProducerCommand{constructor(e){super(e),this.name=a.N.restart}}},610322:(e,t,n)=>{n.r(t),n.d(t,{ProducerSetLayoutCommand:()=>o});var i=n(987822),a=n(520940);class o extends i.ProducerCommand{constructor(e){super(e),this.name=a.N.setLayout}}},516902:(e,t,n)=>{n.r(t),n.d(t,{ProducerStartCommand:()=>o});var i=n(987822),a=n(520940);class o extends i.ProducerCommand{constructor(e){super(e),this.name=a.N.start}}},958285:(e,t,n)=>{n.r(t),n.d(t,{ProducerStopCommand:()=>o});var i=n(987822),a=n(520940);class o extends i.ProducerCommand{constructor(e){super(e),this.name=a.N.stop}}},202496:(e,t,n)=>{n.r(t),n.d(t,{ProducerSwitchPrimaryCommand:()=>o});var i=n(987822),a=n(520940);class o extends i.ProducerCommand{constructor(e){super(e),this.name=a.N.switchPrimary}}},306402:(e,t,n)=>{n.r(t),n.d(t,{ProducerUpdateMediaStateCommand:()=>o});var i=n(987822),a=n(520940);class o extends i.ProducerCommand{constructor(e,t,n,i){super(e),this.name=a.N.updateMediaState,this.sources=t,this.mediaState=n,this.reason=i}}},2781:(e,t,n)=>{n.r(t),n.d(t,{PromiseCancellationRejectReason:()=>o,EsPromiseFactoryImplementation:()=>r,EsPromiseFactory:()=>s,HttpRequestDispatcher:()=>l});var i=n(197981),a=n(190329);const o="promiseCancelled";class r{resolve(e){return Promise.resolve(e)}when(e){return Promise.resolve(e)}reject(e){return Promise.reject(e)}create(e){return new Promise(e)}all(e){if(!e)return Promise.resolve();if((0,i.isArray)(e))return Promise.all(e);const t={},n=Object.keys(e).reduce(((n,i)=>[...n,e[i].then((e=>t[i]=e))]),[]);return Promise.all(n).then((()=>Promise.resolve(t)))}allSettled(e){if(!e)return Promise.resolve();const t=e.map((e=>e.then((e=>({state:"fulfilled",value:e})),(e=>({state:"rejected",reason:e})))));return this.all(t)}createDeferred(){let e=null,t=null;const n=new Promise(((n,i)=>{e=n,t=i}));return{resolve:e,reject:t,promise:n}}toCancellable(e){let t=null;const n=new Promise(((n,i)=>{t=i,e.then(n).catch(i)}));return n.__cancel=()=>t(o),n}cancel(e){"function"==typeof e.__cancel&&e.__cancel()}finalized(e,t){return e.catch(i.noop).then(t).then((()=>e))}toNgPromise(e){return e}}const s=new r;class l{constructor(e,t=s){this.http=e,this.promiseFactory=t}getRequestOptions(e,t,n,i,a){return{headers:t||{},retry:null,reporting:{serviceName:"HttpRequestDispatcherFactory"+(e?`-${e}`:"")},payload:n||null,timeout:i||null,responseType:a}}getAsync(e,t){return this.wrapOperationResponse(this.http.getDetailed(e,this.convertRequestOptions(t)))}postAsync(e,t){return this.wrapOperationResponse(this.http.postDetailed(e,this.convertRequestOptions(t),t.payload))}putAsync(e,t){return this.wrapOperationResponse(this.http.putDetailed(e,this.convertRequestOptions(t),t.payload))}removeAsync(e,t){const n=this.convertRequestOptions(t);if(t.payload&&!Object.keys(n.headers).some((e=>"content-type"===e.toLowerCase())))try{JSON.parse(t.payload),n.headers["Content-Type"]="application/json"}catch(e){}return this.wrapOperationResponse(this.http.deleteDetailed(e,n,t.payload))}canRetry(e){return a.TransientErrorPolicy.isTransientFailure(e)}wrapOperationResponse(e){return new Promise(((t,n)=>{e.then(this.getApiResolveCallback(t),this.getApiRejectCallback(n))}))}getApiResolveCallback(e){return t=>{const n={response:t.object||{status:t.statusCode},request:t.request};e(n)}}getApiRejectCallback(e){return t=>{let n,i,a;this.isErrorPayload(t)?(n=t.code,i=t.message):(n=t.errorCode||t.statusCode,i=t.customErrorData||{message:t.errorMessage},a=t.request),n=n<0?0:n,e({status:n,response:i,request:a})}}isErrorPayload(e){return void 0!==e.codeEnum}convertRequestOptions(e){return{callType:e.reporting.serviceName,headers:e.headers,retries:0,timeout:this.convertTimeout(e.timeout),responseType:e.responseType}}convertTimeout(e){if(e instanceof Promise){const t=this.promiseFactory.createDeferred();return e.then((()=>t.resolve())).catch((e=>t.reject(e))),t.promise}return e}}},50473:(e,t,n)=>{var i,a,o,r,s,l,c,d,g;n.r(t),n.d(t,{RigelTeamsCallState:()=>i,FrontRowDefaultPanelType:()=>a,RigelWindowType:()=>o,MTRExperience:()=>r,SfBState:()=>s,RigelLayoutType:()=>l,DefaultLayoutType:()=>c,FrontRowVideoSize:()=>d,ThirdPartyMeetingType:()=>g}),function(e){e[e.Idle=0]="Idle",e[e.PreCall=1]="PreCall",e[e.Incoming=2]="Incoming",e[e.InACall=3]="InACall",e[e.PostCall=4]="PostCall",e[e.Cortana=5]="Cortana",e[e.PreHeating=6]="PreHeating",e[e.FeedbackOpen=7]="FeedbackOpen",e[e.Broadcast=8]="Broadcast",e[e.ExperienceContainerError=9]="ExperienceContainerError"}(i||(i={})),function(e){e[e.Auto=0]="Auto",e[e.Hide=1]="Hide",e[e.Chat=2]="Chat",e[e.RaisedHand=3]="RaisedHand"}(a||(a={})),function(e){e.GalleryAndContent="GalleryAndContent",e.Gallery="Gallery",e.Content="Content",e.Main="Main"}(o||(o={})),function(e){e.Standard="Standard",e.AllInOne="AllInOne"}(r||(r={})),function(e){e[e.Idle=0]="Idle",e[e.InMeeting=1]="InMeeting",e[e.Incoming=2]="Incoming",e[e.Settings=3]="Settings",e[e.OOBE=4]="OOBE"}(s||(s={})),function(e){e[e.None=0]="None",e[e.Gallery=1]="Gallery",e[e.Content=2]="Content",e[e.ContentWithGallery=3]="ContentWithGallery"}(l||(l={})),function(e){e[e.Grid=0]="Grid",e[e.FrontRow=1]="FrontRow"}(c||(c={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(d||(d={})),function(e){e.Webex="webex",e.Zoom="zoom",e.BlueJeans="blueJeans",e.LogMeIn="logMeIn",e.Skype="skype"}(g||(g={}))},98705:(e,t,n)=>{var i;n.d(t,{j:()=>i}),function(e){e.BlueWave="BlueWave",e.CreativeConservatory="CreativeConservatory",e.Default="Default",e.DigitalForest="DigitalForest",e.Dreamcatcher="Dreamcatcher",e.IntoTheFold="IntoTheFold",e.Limeade="Limeade",e.NoTheme="NoTheme",e.PixelPerfect="PixelPerfect",e.PurpleParadise="PurpleParadise",e.Roadmap="Roadmap",e.SeasideBliss="SeasideBliss",e.SummerSummit="SummerSummit",e.Sunset="Sunset",e.VividFlagDefault="VividFlagDefault",e.Custom="Custom"}(i||(i={}))},447862:(e,t,n)=>{var i,a;n.d(t,{s:()=>i,r:()=>a}),function(e){e[e.Regular=0]="Regular",e[e.CallQueue=1]="CallQueue",e[e.CallGroup=2]="CallGroup",e[e.Delegate=3]="Delegate",e[e.MeetingStartedReminder=4]="MeetingStartedReminder"}(i||(i={})),function(e){e[e.Ring=0]="Ring",e[e.Bop=1]="Bop",e[e.Bounce=2]="Bounce",e[e.Bubbles=3]="Bubbles",e[e.DripDrop=4]="DripDrop",e[e.Eureka=5]="Eureka",e[e.Flutter=6]="Flutter",e[e.HighScore=7]="HighScore",e[e.NextLevel=8]="NextLevel",e[e.Plink=9]="Plink",e[e.RingRing=10]="RingRing",e[e.Ripple=11]="Ripple",e[e.Spacetime=12]="Spacetime",e[e.WishGranted=13]="WishGranted",e[e.Wobble=14]="Wobble",e[e.BubblesLoud=15]="BubblesLoud",e[e.Remix=16]="Remix"}(a||(a={}))},344546:(e,t,n)=>{n.d(t,{v:()=>i});class i{}i.Stores={emergencyLocation:{name:"emergency_location",primaryKeyPath:"networkInfo"},internaldata:{name:"internaldata",primaryKeyPath:"id"}}},870556:(e,t,n)=>{var i,a,o,r,s;n.d(t,{Fj:()=>i,bo:()=>a,ex:()=>o,lJ:()=>r,VZ:()=>s}),function(e){e[e.sendingRequest=0]="sendingRequest",e[e.responseInControl=1]="responseInControl",e[e.responseNotInControl=2]="responseNotInControl"}(i||(i={})),function(e){e[e.disabled=0]="disabled",e[e.inControl=1]="inControl",e[e.notInControl=2]="notInControl",e[e.showDisabledRequestControl=3]="showDisabledRequestControl"}(a||(a={})),function(e){e.start="start",e.stop="stop",e.collaborate="collaborate",e.readOnly="readonly",e.clear="clear"}(o||(o={})),function(e){e[e.Request=0]="Request",e[e.Release=1]="Release"}(r||(r={})),function(e){e[e.videoStreamingEnded=0]="videoStreamingEnded",e[e.controlChannelEnded=1]="controlChannelEnded"}(s||(s={}))},9718:(e,t,n)=>{var i;n.d(t,{U:()=>i}),function(e){e[e.DataChannelAdapter=0]="DataChannelAdapter",e[e.Control=1]="Control",e[e.RtcpHint=2]="RtcpHint",e[e.Web=3]="Web"}(i||(i={}))},906712:(e,t,n)=>{var i;n.d(t,{b:()=>i}),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(i||(i={}))},881989:(e,t,n)=>{var i;n.d(t,{y:()=>i}),function(e){e.Local="local",e.Remote="remote"}(i||(i={}))},504441:(e,t,n)=>{var i,a;n.d(t,{I:()=>i,B:()=>a}),function(e){e[e.Manual=0]="Manual",e[e.AppState=1]="AppState"}(i||(i={})),function(e){e[e.FailedToReachAppliance=0]="FailedToReachAppliance",e[e.OutgoingCall=1]="OutgoingCall",e[e.FailedOutgoingCall=2]="FailedOutgoingCall",e[e.IncomingCall=3]="IncomingCall",e[e.FailedIncomingCall=4]="FailedIncomingCall",e[e.ApplianceMode=5]="ApplianceMode",e[e.FallbackSucceded=6]="FallbackSucceded",e[e.FallbackFailed=7]="FallbackFailed"}(a||(a={}))},939419:(e,t,n)=>{var i;n.d(t,{p:()=>i}),function(e){e[e.NotInstalled=0]="NotInstalled",e[e.InProgress=1]="InProgress",e[e.Installed=2]="Installed",e[e.Unavailable=3]="Unavailable",e[e.UpdateAvailable=4]="UpdateAvailable",e[e.MustUpdate=5]="MustUpdate"}(i||(i={}))},686621:(e,t,n)=>{n.r(t),n.d(t,{TeamsCallService:()=>r});var i=n(361366),a=n(197981);class o{mixTeamsCall(e){e.isTeamsMixed=!0}}class r{constructor(e,t=[],n=(()=>{}),i=!0){this.inputMixinsList=t,this.onTeamsCallCreated=n,this.mixins=[],this.logger=e.newLogger("TeamsCallService"),i&&this.initializeOnAppLaunchAndReinit()}disposeService(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return new Promise((t=>{this.cleanupOnAppTeardown(e.reason),t()}))}))}initializeOnAppLaunchAndReinit(e){this.mixins=[new o,...this.inputMixinsList]}cleanupOnAppTeardown(e){this.mixins=[],r.nextTeamsCallId=1}getOrCreateTeamsCall(e,t){const n=e;return n?(n.isTeamsMixed||(n.teamsCallId=t||r.getNextTeamsCallId(),this.mixins.map((e=>{try{return e.mixTeamsCall(n)}catch(e){this.logger.error(`Failed to apply mixin: ${e}`)}})).filter((e=>this.isActualInitializer(e))).forEach((e=>{try{e()}catch(e){this.logger.error(`Failed to initialize mixin: ${e}`)}})),this.onTeamsCallCreated(n),this.logger.info(`Assigned teamsCallId ${n.teamsCallId} to call with callId ${n.callId}, suggested teamsCallId: ${t}`)),n):n}static getNextTeamsCallId(){return r.nextTeamsCallId++}static getTeamsCallIdAsString(e){return String(e)}static parseTeamsCallId(e){return Number(e)||0}static bindMethods(e,t,n,i,a=!1){n.forEach((n=>{const o=n;a||void 0===e[o]||!e[o]?void 0===t[o]?i&&i.error(`Method ${o} not present on the mixin`):e[o]=t[o].bind(t):i&&i.error(`Method ${o} already present on the call object`)}))}static bindProps(e,t,n,i,a=!1){n.forEach((n=>{a||void 0===e[n]?Object.defineProperty(e,n,{get:()=>t[n],set(e){t[n]=e}}):i&&i.error(`Property ${String(n)} already present on the call object`)}))}isActualInitializer(e){return(0,a.isFunction)(e)}}r.nextTeamsCallId=1},808805:(e,t,n)=>{var i,a,o,r,s,l;n.d(t,{kB:()=>a,lo:()=>o,Mx:()=>r,YR:()=>s,hp:()=>l}),function(e){e.queryMeetingState="query-meeting-state",e.toggleMute="toggle-mute",e.toggleVideo="toggle-video",e.raiseHand="raise-hand",e.backgroundBlur="background-blur",e.recording="recording",e.call="call"}(i||(i={})),function(e){e.queryMeetingState="query-meeting-state",e.queryMeetingStateV2="query-state",e.mute="mute",e.unmute="unmute",e.toggleMute="toggle-mute",e.showVideo="show-video",e.hideVideo="hide-video",e.toggleVideo="toggle-video",e.raiseHand="raise-hand",e.lowerHand="lower-hand",e.toggleHand="toggle-hand",e.blurBackground="blur-background",e.unblurBackground="unblur-background",e.toggleBackgroundBlur="toggle-background-blur",e.toggleRecording="toggle-recording",e.startRecording="start-recording",e.stopRecording="stop-recording",e.leaveCall="leave-call",e.reactApplause="react-applause",e.reactLaugh="react-laugh",e.reactLike="react-like",e.reactLove="react-love",e.reactWow="react-wow",e.sendReaction="send-reaction",e.toggleUi="toggle-ui",e.stopSharing="stop-sharing",e.pair="pair"}(a||(a={})),function(e){e.applause="applause",e.laugh="laugh",e.like="like",e.love="love",e.wow="wow"}(o||(o={})),function(e){e.success="Success",e.error="Error"}(r||(r={})),function(e){e.allowed="allowed",e.blocked="blocked",e.unpaired="unpaired"}(s||(s={})),function(e){e.allow="allow",e.block="block",e.timeout="timeout",e.dismissed="dismissed",e.busy="busy",e.error="error"}(l||(l={}))},190329:(e,t,n)=>{n.r(t),n.d(t,{TransientErrorPolicy:()=>i});class i{static isTimeout(e){return e<=0}static statusCodeMatch(e,t){return t.test(e)}static isWebApiSuccess(e){return i.statusCodeMatch(e,i.statusCodes.success)||i.statusCodeMatch(e,i.statusCodes.redirection)}static isTransientFailure(e){return i.isTimeout(e)||i.statusCodeMatch(e,i.statusCodes.serverError)}}i.statusCodes={success:/^(2)\d{2}/,redirection:/^(3)\d{2}/,serverError:/^(5)\d{2}/}},93997:(e,t,n)=>{var i,a,o,r,s;n.d(t,{N7:()=>i,WE:()=>a,yy:()=>o,fm:()=>r,ab:()=>s}),function(e){e.MaxUsersReached="MaxUsersReached",e.MeetingNotFound="MeetingNotFound",e.VodAccessDisabled="VodAccessDisabled",e.NotAuthorized="NotAuthorized",e.RoutingException="RoutingException",e.ResourceDeleted="ResourceDeleted",e.InvalidIdentifiers="InvalidIdentifiers",e.Unknown="Unknown"}(i||(i={})),function(e){e[e.Unauthorized=401]="Unauthorized"}(a||(a={})),function(e){e[e.UserNotLoggedIn=1]="UserNotLoggedIn"}(o||(o={})),function(e){e.broadcast_yammer_group_info_text_groupName="broadcast_yammer_group_info_text_groupName",e.broadcast_yammer_group_info_text_visibility="broadcast_yammer_group_info_text_visibility: string",e.broadcast_yammer_group_info_text_visibility_private="broadcast_yammer_group_info_text_visibility_private",e.broadcast_yammer_group_info_text_visibility_public="broadcast_yammer_group_info_text_visibility_public"}(r||(r={})),function(e){e[e.Private=0]="Private",e[e.Public=1]="Public"}(s||(s={}))},376617:(e,t,n)=>{n.r(t),n.d(t,{BroadcastUtilities:()=>c});var i=n(360452),a=n(197981),o=n(796973),r=n(417382),s=n(207500),l=n(93997);class c{static getBroadcastStatusResourceString(e,t,n){switch(e){case teams.calling.BroadcastStatus.NotStarted:case teams.calling.BroadcastStatus.Starting:return n?t.strings.broadcast_status_pre_live_shortformat:t.strings.broadcast_status_pre_live;case teams.calling.BroadcastStatus.Started:return t.strings.broadcast_status_live;case teams.calling.BroadcastStatus.Stopping:case teams.calling.BroadcastStatus.Stopped:return t.strings.broadcast_status_stopped;default:return t.strings.calling_prejoin_preview_container_title_connecting}}static logExternalForDDL(e,t,n,i){if(t)return;const a=c.broadcastUtilitiesHelpers.getRootToolsManager();a&&a.logExternalForDDL?a.logExternalForDDL(e,i):n.warn("logExternalForDDL: Attempted to use RootToolsManager.logExternalForDDL but it's not defined")}static isComposerBotMri(e,t){return!!(t&&t.indexOf(e)>=0)}static getAvailableComposerStream(e,t,n){const i=e&&e.broadcastMeeting&&e.broadcastMeeting.broadcastState;if(!i)return null;const a=i&&i.previewSourceId;if(!a)return n.error("getAvailableComposerStream: Preview sourceId not present in current metadata."),null;const o=c.getParticipantStreamFromMediaId(t,a,n);return o||(n.error("getAvailableComposerStream: No preview stream found for participant {0} with sourceId {1}",t.id,a),null)}static getParticipantFromBroadcastSource(e,t,n,i){let a;if("0"===t){const t=e.getScreenSharer();return t?t.id:e.isScreenSharingOn?n.getCurrentSkypeMri():null}for(const n of e.participants)if(!c.isComposerBotMri(n.id,i)&&c.isMediaIdInParticipantEndpoints(n.endpoints,t)){a=n.id;break}return!a&&c.isMediaIdInParticipantEndpoints(e.endpoints,t)&&(a=n.getCurrentSkypeMri()),a}static getParticipantStreamFromMediaId(e,t,n){const o=c.getParticipantIdFromBroadcastSource(e,t,n);if(!o)return n.error("MediaId {0} not found in participants endpoint",t),null;const r="0"===t?i.jx.ScreenSharing:i.jx.Video,s=e.streams[r];if(!s)return n.error("No video stream found for participantId {0}",e.id),null;const l=(0,a.find)(s,(e=>e.participantId===o));return l||(n.error("No stream found for participantId {0}",o),null)}static getParticipantIdFromBroadcastSource(e,t,n){if(!e)return null;const i=c.getEndPointWithGivenMediaId(e.endpoints,t);return i?i.participantId:(n.error("No end point detail found with given mediaId {0}",t),null)}static getEndPointWithGivenMediaId(e,t){const n=e&&e.endpointDetails&&e.endpointDetails;if(!n)return null;for(let e=0;e<n.length;e++){const a=n[e],o=a&&a.mediaStreams;let r;if(r="0"===t?o&&o.some((e=>e.label===c.mediaSourceLabelForVbss&&e.direction===i.WN.SendOnly)):o&&o.some((e=>e.sourceId===Number(t))),r)return a}return null}static isMyVideoBroadcasting(e){return!!(e&&e.broadcastMeeting&&e.endpoints)&&c.isVideoBroadcasting(e.broadcastMeeting,e.endpoints)}static isVideoBroadcasting(e,t){const n=e.broadcastState,i=c.getBroadcastLiveSources(n);for(const e of i)if("0"!==e.id&&c.isMediaIdInParticipantEndpoints(t,e.id))return!0;return!1}static getBroadcastLiveSources(e){return e&&e.status===teams.calling.BroadcastStatus.Started?c.getBroadcastLayoutSources(e):[]}static isMediaIdInParticipantEndpoints(e,t){return!!c.getEndPointWithGivenMediaId(e,t)}static getBroadcastLayoutSources(e){const t=[];if(!e)return t;const n=e.layout&&e.layout.sources;if(n&&n.length>0)for(const i of n)i&&e.sources&&i.idx<e.sources.length&&e.sources[i.idx]&&t.push(e.sources[i.idx]);return t}static isMyScreenShareBroadcasting(e){if(!e||!e.broadcastMeeting)return!1;const t=e.broadcastMeeting.broadcastState,n=c.getBroadcastLiveSources(t);for(const t of n)if("0"===t.id)return e.isScreenSharingOn;return!1}static isScreenShareBroadcasting(e){if(!e||!e.broadcastMeeting)return!1;const t=e.broadcastMeeting.broadcastState,n=c.getBroadcastLiveSources(t);for(const e of n)if("0"===e.id)return!0;return!1}static isParticipantVideoBroadcasting(e,t){return!!(t&&e&&e.endpoints)&&c.isVideoBroadcasting(t,e.endpoints)}static isParticipantScreenShareBroadcasting(e,t){if(!t)return!1;const n=t.broadcastState,a=c.getBroadcastLiveSources(n);for(const t of a)if("0"===t.id&&e)return e.streams&&e.streams[i.jx.ScreenSharing]&&e.streams[i.jx.ScreenSharing][0]&&e.streams[i.jx.ScreenSharing][0].isAvailable;return!1}static getIdentifiersFromAttendeeMeetingUrl(e,t){try{if(!e||-1===e.indexOf("/teams/")&&-1===e.indexOf("/ngc/v1/"))return null;let t;const n=e.split("?");return t=-1!=n[0].indexOf("/teams/")?n[0].match(/(\/teams\/)([\w\-]{36})\/([\w\-]{36})\/(\w*.*)\/(\w*.*)/):n[0].match(/(\/ngc\/v1\/)([\w\-]{36})\/([\w\-]{36})\/(\w*.*)\/(\w*.*)\/(\w*.*)/),t&&t.length>=6&&t.splice(0,2)&&!(0,a.some)(t,(e=>!e))?t:null}catch(e){return t&&t.error(`Error during parsing meeting url, error: ${e}`),null}}static getMeetingIdFromAttendeeMeetingUrl(e,t){const n=c.getIdentifiersFromAttendeeMeetingUrl(e,t);return n?n.join(c.attendeeMeetingParamsSeparator):null}static getTenantIdFromAttendeeMeetingUrl(e,t){const n=c.getIdentifiersFromAttendeeMeetingUrl(e,t);return n?n[0]:null}static getSessionIdFromAttendeeMeetingUrl(e,t){const n=c.getIdentifiersFromAttendeeMeetingUrl(e,t);return n?n[4]:void 0}static stringifyBroadcastState(e){switch(e){case i.Zs.Connected:return"Connected";case i.Zs.Connecting:return"Connecting";case i.Zs.Disconnected:return"Disconnected";case i.Zs.Ringing:return"Ringing";default:return"None"}}static isParticipantStreamLive(e,t,n){if(!e||!e.broadcastMeeting)return!1;const i=e.broadcastMeeting.broadcastState,a=c.getBroadcastLiveSources(i);for(const e of a){if(!e)continue;if("0"===e.id===n&&(n||c.isMediaIdInParticipantEndpoints(t.endpoints,e.id)))return!0}return!1}static isAnyParticipantStreamAvailable(e,t){if(e.isVideoOn||e.isScreenSharingOn)return!0;return e.participants.filter((e=>!c.isComposerBotMri(e.id,t)&&(teams.calling.ICallParticipantHelpers.bestAvailableVideoFor(e)||teams.calling.ICallParticipantHelpers.bestAvailableScreenShareFor(e)))).length>0}static getStreamAttendeeExternalLink(e){return e?`https://web.microsoftstream.com/video/${e}`:null}static getStreamProducerExternalLink(e){return e?`https://web.microsoftstream.com/update/${e}`:null}static getYammerAttendeeExternalLink(e){return e&&(e.event||e.broadcastId)?e.event||`https://www.yammer.com/#/broadcast/${e.broadcastId}`:null}static yammerGroupInfoToString(e,t){if(!e)return null;const n=t.instant(l.fm.broadcast_yammer_group_info_text_groupName),i=t.instant(l.fm.broadcast_yammer_group_info_text_visibility),a=l.ab[e.visibility]===l.ab.Private?t.instant(l.fm.broadcast_yammer_group_info_text_visibility_private):t.instant(l.fm.broadcast_yammer_group_info_text_visibility_public);return`${n}: ${e.displayName}, ${i}: ${a}`}static submitAutoBrbLogs(e,t,n,i,r,s){const l=n.newScenario(o.Constants.scenarios.broadcast.autoBrbForBroadcast);if(!r)return l.stop({[o.Constants.scenarioDataPropNames.broadcastError]:"Feature flag not enabled"}),Promise.reject("Feature flag not enabled");if(!t)return l.fail({[o.Constants.scenarioDataPropNames.broadcastError]:"Call object is required"}),Promise.reject("Call object is required");const c=`Auto Brb: ${e} (callId: ${t.callId}, participantId: ${t.participantId}, threadId: ${t.threadId})`,d=t.broadcastMeeting&&t.broadcastMeeting.broadcastState;let g;try{g=JSON.stringify({failureType:t.failureType,abortReason:t.abortReason,mediaConnected:t.mediaConnected,terminatedReason:t.terminatedReason,broadcastRole:t.broadcastMeeting&&t.broadcastMeeting.role||"unknown",broadcastModalityState:teams.calling.BroadcastUtilities.stringifyBroadcastState(t.broadcastMeeting.modalityState),broadcastState:(0,a.pick)(d,["commands","error","status","sources","commandStatus","layout"]),callstate:teams.calling.CallUtilities.stringifyCallState(t.state)})}catch(e){s.error(`submitAutoBrbLogs encountered error - ${e})`),g=c}const u=String(o.Constants.feedback.categories.other);return i.sendFeedbackToBrbV2(!0,{category:u,title:c,description:g,piiSafeLogsOnly:!0,allowScreenshots:!1,includeBackgroundBlurImages:!1,includeHeapSnapshot:!1}).then((()=>{l.stop()})).catch((e=>{s.error(`Brb submission failed with error: ${e}`);const n={};n[o.Constants.counters.eventNames.callId]=t.callId,n[o.Constants.counters.eventNames.participantId]=t.participantId,[o.Constants.scenarioDataPropNames.broadcastError]=e,l.fail(n)}))}static handleBroadcastScenarioOnError(e,t,n,i){const r=t&&(t.statusCode||t.status),s=t&&t.errorMessage&&t.errorMessage.subCode;n&&n[o.Constants.scenarioDataPropNames.broadcastError]||(n=Object.assign(Object.assign({},n),{[o.Constants.scenarioDataPropNames.broadcastError]:JSON.stringify(t)})),void 0!==r&&null!=r&&(t.code===o.Constants.errorCodes.scenarioAbandoned||t.code===o.Constants.errorCodes.networkOffline||r===l.WE.Unauthorized&&t.errorCode===l.yy.UserNotLoggedIn||r===o.Constants.responseCode.tooManyRequests&&s===l.N7.MaxUsersReached||(0,a.includes)(i,r))?e.cancel(n):e.fail(n)}static appendQueryStringToUrl(e,t,n){if(!e)return null;const i=`${t}=${n}`;return e.indexOf("?")>=0?`${e}&${i}`:`${e}?${i}`}static isPrimaryOrAlternateStreamAvailable(e){return e&&(c.isStreamValid(e.stream)||c.isStreamValid(e.altStream))}static isStreamValid(e){return e&&!!e.wamsStreamingUrl&&!!e.decryptionToken}static isStreamInfoComplete(e){return e&&c.isStreamValid(e.stream)&&c.isStreamValid(e.altStream)}static isQuickStartStreamBroadcast(e,t){return e.streamResource&&e.streamResource.encoderSource===t||!1}static isOverflowBroadcast(e){return!!c.getAttendeeMeetingParamsFromId(e.meetingId).sessionId}static getMeetingIdFromAttendeeMeetingParams(e,t,n,i,a){return[e,t,n,i,a].filter((e=>void 0!==e)).join(c.attendeeMeetingParamsSeparator)}static getAttendeeMeetingParamsFromId(e){const[t,n,i,a,o]=e.split(c.attendeeMeetingParamsSeparator);return{tenantId:t,organizerId:n,threadId:i,messageId:a,sessionId:o}}static hasUnresolvedEmailForETMs(e){return(0,a.some)(e,(e=>e&&!e.skypeMri&&!e.objectId&&e.type!==s.AttendeeType[s.AttendeeType.Organizer]))}static hasUnresolvedEmailForAttendees(e){return(0,a.some)(e,(e=>e&&!e.skypeMri&&!e.objectId))}static getBroadcastLayout(e,t,n){if(!t)return n.error("Sources is null or undefined"),null;return{sources:t.map((t=>({type:t.type,id:c.getMediaId(t,e,n)})))}}static getMediaId(e,t,n){if(!e.participant)return n.error("Source participant is null or undefined"),null;if("vbss"===e.type)return"0";let i;if(e.participant.isMe)i=t.endpoints;else{const n=(0,a.find)(t.participants,(t=>t.id===e.participant.mri));i=n&&n.endpoints}if(!i||!i.endpointDetails)return n.error("No endpoint details found"),null;const o=i.endpointDetails,r=this.getParticipantId(t,e,n);let s;if(r){const t=(0,a.find)(o,(e=>e.participantId===r));t?s=[t]:n.error(`No endpoint found for ${r} and ${e.type}`)}else n.error("No valid participantId found for the given source {0}",JSON.stringify(e.participant));s||(s=o);for(const t of s){const i=c.getSourceIdFromEndpoint(e.type,t,n);if(i)return i}return n.error("No mediaId found"),null}static getParticipantId(e,t,n){if(!t||!t.participant)return n.error("Source participant is null or undefined"),null;if(t.participant.isMe)return e.participantId;const i=e.participants.find((e=>e.id===t.participant.mri));if(!i)return n.error("No participant found with current mri {0}",t.participant.mri),null;if(!i.endpoints&&!i.endpoints.endpointDetails)return n.error("No end points available for local user."),null;"video"!==t.type&&n.error("We always expect the type here to be video. Something wrong");const a=r.ICallParticipantHelpers.bestVideoFor(i);return a?a.participantId:(n.error("No available stream found for the participant {0}",t.participant.mri),null)}static getSourceIdFromEndpoint(e,t,n){const i=t.mediaStreams;if(!i)return n.error("Media stream is null"),null;n.info(`MediaStreams from call object: ${JSON.stringify(i)}`);const a=c.mediaSourceLabels[e],o=a&&i.find((e=>e.label===a)),r=o&&o.sourceId;return n.info(`Found sourceId [${r}] for [${a}] source, mediaSourceLabel: [${e}]`),r}static isMySourcesInLivePreview(e){if(!e||!e.broadcastMeeting||!e.broadcastMeeting.broadcastState)return!1;const t=e.broadcastMeeting.broadcastState,n=c.getBroadcastLiveSources(t);for(const t of n)if(c.isMediaIdInParticipantEndpoints(e.endpoints,t.id)||"0"===t.id&&e.isScreenSharingOn)return!0;return!1}}c.mediaSourceLabelForVbss="applicationsharing-video",c.attendeeMeetingParamsSeparator="__",c.mediaSourceLabels={audio:"main-audio",data:"data",video:"main-video",vbss:"applicationsharing-video"}},386448:(e,t,n)=>{n.r(t),n.d(t,{AttendeeRestrictionType:()=>i,CallAttendeeRestrictionsHelper:()=>o});var i,a=n(618466);!function(e){e[e.RestrictAudio=0]="RestrictAudio",e[e.UnRestrictAudio=1]="UnRestrictAudio",e[e.RestrictVideo=2]="RestrictVideo",e[e.UnRestrictVideo=3]="UnRestrictVideo"}(i||(i={}));const o={shouldAllowAttendeeToUnmute:(e,t,n)=>!!(r(e,t)&&t.isServerMuted&&(n||t.isHandRaised&&e.isRequestToSpeakEnabled)&&e.isAttendeeRestricted(t.id)),shouldDisallowAttendeeToUnmute:(e,t)=>r(e,t)&&e.isRequestToSpeakEnabled&&(e.isRestrictingAnAttendeeAudioEnabled||e.isAttendeeRestrictedModality(a.RestrictableModalities.Audio))&&!e.isAttendeeRestricted(t.id),shouldAllowAttendeeToShareVideo:(e,t)=>!!(r(e,t)&&e.isRestrictingAnAttendeeVideoEnabled&&e.isAttendeeRestricted(t.id,!1,a.RestrictableModalities.Video)),shouldDisallowAttendeeToShareVideo:(e,t)=>!(!r(e,t)||!e.isRestrictingAnAttendeeVideoEnabled||e.isAttendeeRestricted(t.id,!1,a.RestrictableModalities.Video)),unrestrictAttendee(e,t){if(t)return e.unrestrictAttendeeAudio([t.id])},restrictAttendee(e,t){if(t)return e.restrictAttendeeAudio([t.id])},getAttendeeRestrictions(e,t){const n=e.attendeeRestrictedModalities||[];switch(t){case i.RestrictAudio:return n.includes(a.RestrictableModalities.Audio)?n:[...n,a.RestrictableModalities.Audio];case i.UnRestrictAudio:return n.filter((e=>e!==a.RestrictableModalities.Audio));case i.RestrictVideo:return n.includes(a.RestrictableModalities.Video)?n:[...n,a.RestrictableModalities.Video];case i.UnRestrictVideo:return n.filter((e=>e!==a.RestrictableModalities.Video))}}},r=(e,t)=>!(!t||"attendee"===e.meetingRole||"attendee"!==t.meetingRole)},62606:(e,t,n)=>{n.r(t),n.d(t,{CallUtilities:()=>C});var i=n(360452),a=n(197981),o=n(796973),r=n(375094),s=n(225927),l=n(991419),c=n(347123),d=n(341189),g=n(2781),u=n(268316),p=n(343508);const C={SOURCE_ID_ANY:4294967294,skypeIdNamespaces:["live","sip_profile","myspace","c2c","sms","facebook","fb","sc","stbot","guest","test"],bufferToString:e=>String.fromCharCode.apply(null,e),mapMediaTypeStringToMediaType(e){switch(e){case"audio":return i.DD.Audio;case"video":return i.DD.Video;case"applicationsharing-video":return i.DD.ScreenShare;case"data":return i.DD.Data;default:return}},getOwnEndpoint:e=>e.endpoints&&e.endpoints.endpointDetails?(0,a.find)(e.endpoints.endpointDetails,(t=>t.participantId===e.participantId)):null,getParticipantFromCall:(e,t)=>e.participants.find((e=>e.id===t)),getPlazaParticipantRoomId(e,t,n){var i,a,o,r,s,l;let c,d;const g=new Map;let u=0;for(;u<e.participants.length;){const p=e.participants[u];if(g.set(null===(o=null===(a=null===(i=p.endpoints)||void 0===i?void 0:i.endpointDetails)||void 0===a?void 0:a[0])||void 0===o?void 0:o.participantId,p),p.id===n){if(c=p,d=null===(l=null===(s=null===(r=c.endpoints)||void 0===r?void 0:r.endpointDetails)||void 0===s?void 0:s[0])||void 0===l?void 0:l.mappedTo,!d)return;if(d===e.participantId)return t}if(d){const e=g.get(d);if(e)return e.id}u++}},getNumParticipants:(e,t)=>t.getCallParticipantCounts(e.teamsCallId).totalParticipants,sendAutoBrbForCallingAnomalies(e,t,n,i,a,o,r=g.EsPromiseFactory){const s=Date.now(),l=e=>t.sendFeedbackToBrbV2(!0,{category:a,title:e,description:"Submitted via perf monitor",allowScreenshots:!1,includeBackgroundBlurImages:!1,includeHeapSnapshot:!1}),c=r.toCancellable(e).then((()=>{const e=Date.now()-s;e>o&&l(`${i} exceeded ${o}ms (taking ${e}ms)`)})).catch((e=>{if("promiseCancelled"===e){const e=Date.now()-s;l(`${i} timed out after ${e}ms`)}else l(`${i} failed`)})).finally((()=>{n.timeout.cancel(d)})),d=n.timeout.set((()=>{r.cancel(c)}),12e4)},getParticipantInOneToOneCall(e,t){let n=null;return t.participants.forEach((t=>{t.id!==e&&(n=t.id)})),n},getSourceIdForMediaTypeFromEndpoint(e,t){if(e&&e.mediaStreams){const n=e.mediaStreams.find((e=>C.mapMediaTypeStringToMediaType(e.type)===t));if(n)return n.sourceId}return C.SOURCE_ID_ANY},hasEndpointDetails:e=>e.endpoints&&e.endpoints.endpointDetails&&e.endpoints.endpointDetails.length>0,hasEndPointType(e,t){if(!e||!e.endpoints)return!1;return-1!==(0,a.findIndex)(e.endpoints.endpointDetails,(e=>e.endpointType===t))},isCallConnecting:e=>e.state===i.OX.Connecting||e.state===i.OX.EarlyMedia,unregisterEventIfNeeded(e){e&&e()},isABot:(e,t,n=[])=>C.isCallingSystemBot(t,n)||e.isVoiceAppMri(t),isAllowedInRoster:(e,t,n)=>!t.isBotMri(e)||n&&n.includes(e),isCallConnected:e=>e.state===i.OX.Connected,isCallDropped:e=>e.failureType===i.Qq.CallDropped,isCallOnServerHold:e=>e.state===i.OX.Observing&&e.isServerHold,isCallSetupFailed:e=>e.failureType===i.Qq.CallSetupFailed||e.terminatedReason===i.yb.UnknownError,isCallingSystemBot:(e,t=[])=>t.includes(e),getCallEndDiagnosticsInfo:e=>e.callEndDiagnosticsInfo||e.participants[0]&&e.participants[0].callEndDiagnosticsInfo,isTransfereeTransferring:e=>!!e.transferorMri&&C.isCallConnecting(e)&&!C.isParkeeParking(e),isParkeeParking:e=>e.origin&&e.origin===i.Fz.Park,isCallActive:e=>C.isCallConnected(e)||C.isCallConnecting(e)||C.isCallOnServerHold(e)||e.state===i.OX.LocalHold||e.state===i.OX.RemoteHold||e.state===i.OX.InLobby,isCallOnServerHoldV2:e=>e.isServerHoldV2,isCallOnLocalHold:e=>e.state===i.OX.LocalHold||C.isCallOnServerHold(e)||C.isCallOnServerHoldV2(e),isCallOnHold:e=>e.state===i.OX.LocalHold||e.state===i.OX.RemoteHold||C.isCallOnServerHold(e),isCallInLobby:e=>e.state===i.OX.InLobby,isDownlevelCall:e=>{if(e.teamsCallType!==i.rf.P2P||!e.participants)return!1;const t=e.participants[0];return!!t&&C.hasEndPointType(t,o.Constants.endpointType.lync)},hasConnectedAcsParticipants:e=>{if(!e.participants)return!1;return!!e.participants.filter((e=>e.id.startsWith(r.AcsUserPrefix)&&e.state===i.b1.Connected)).length},isMeetNow:e=>{var t;const n=e.getIntent();return!(!n||n.type!==c.G.Meeting)&&!!(null===(t=n.coordinates)||void 0===t?void 0:t.isAdhoc)},isEchoBotCall:e=>e.setupArgs&&e.setupArgs.isEchoBotCall&&!0===e.setupArgs.isEchoBotCall||e.getIntent&&e.getIntent()&&e.getIntent().joinOptions&&e.getIntent().joinOptions.context===p.l.EchoBotCall,isFederatedCall:(e,t)=>{if(e.teamsCallType!==i.rf.P2P||!e.participants)return!1;if(C.isOneToOnePstnCall(e))return!1;const n=e.participants[0];return!!n&&(!(!t||!n.tenantId)&&n.tenantId!=t)},isIncomingConferenceCallQueue:e=>e.callQueueInfo&&e.callType===i.rf.Conference&&e.teamsCallType===i.rf.P2P,isIncomingConsultCall:e=>{const t=e&&e.teamsCallType===i.rf.P2P&&e.participants,n=t&&t.length>0&&t[0].endpoints,a=n&&n.endpointDetails,o=a&&a.length>0&&a[0].endpointMetadata,r=o&&o.consultationContext;return!(!r||!r.isIncomingConsult)},isInvisibleBot:e=>e.endpoints&&e.endpoints.endpointDetails[0]&&e.endpoints.endpointDetails[0].endpointMetadata&&e.endpoints.endpointDetails[0].endpointMetadata.__platform&&e.endpoints.endpointDetails[0].endpointMetadata.__platform.ui&&e.endpoints.endpointDetails[0].endpointMetadata.__platform.ui.hidden,isParticipantAnRtmpInBot(e){var t,n,i;const a=null===(t=null==e?void 0:e.endpoints)||void 0===t?void 0:t.endpointDetails,o=a&&(null===(i=null===(n=a[0])||void 0===n?void 0:n.endpointMetadata)||void 0===i?void 0:i.mcrData);return"rtmpinput"===(null==o?void 0:o.type)},isOneToOnePstnCall:e=>e&&e.teamsCallType===i.rf.P2P&&!(0,a.isUndefined)(e.participants)&&!(0,a.isNull)(e.participants)&&e.participants.length>0&&!(0,a.isUndefined)(e.participants[0].id)&&!(0,a.isNull)(e.participants[0].id)&&e.participants[0].id.startsWith(r.PstnPrefix),isMissedCall:e=>e.state===i.OX.Disconnected&&e.wasInState(i.OX.Notified)&&!e.wasInState(i.OX.Connected)&&(e.participants||[]).length<2,isParkCall:e=>e.origin&&e.origin===i.Fz.Park,isPrivateMeeting:(e,t,n)=>e&&e.isInitialized?e.isPrivateMeeting():!(t||!n),isReplacesCall:e=>e&&"replaces"===e.incomingCallType&&!!e.consultativeCallId,isSkypeConsumerCall:e=>{if(e.teamsCallType!==i.rf.P2P||!e.participants)return!1;const t=e.participants[0];return!!t&&C.isSkypeConsumerUser(t.id)},isSkypeBusinessCall:e=>C.isDownlevelCall(e)&&!C.isSkypeConsumerCall(e),isSkypeConsumerUser(e){if(!e)return!1;const t=e.split(";")[0];if(!t)return!1;const n=t.split(":");if(!n||n.length<1||n.length>3)return!1;if("8"!==n[0])return!1;if(2==n.length)return!(0,a.isNil)(n[1])&&!(0,a.isEmpty)(n[1]);if(3===n.length){return!((0,a.findIndex)(C.skypeIdNamespaces,(e=>e==n[1]))<0)&&(!(0,a.isNil)(n[2])&&!(0,a.isEmpty)(n[1]))}return!1},isVoicemailGreetingCall:e=>e.teamsCallType===i.rf.P2P&&C.hasEndPointType(e,o.Constants.endpointType.voicemail),isImmersiveMeetingCall:e=>e.isImmersiveViewActive,mapParticipantToSourceId(e,t){if(!e||!e.endpoints||!e.endpoints.endpointDetails)return C.SOURCE_ID_ANY;for(const n of e.endpoints.endpointDetails){const e=C.getSourceIdForMediaTypeFromEndpoint(n,t);if(e!==C.SOURCE_ID_ANY)return e}return C.SOURCE_ID_ANY},mapRosterVersionStringToPlatformId(e){const t=/(\d+?)(?=\/)/.exec(e);return t?parseInt(t[0]):null},stringifyCallState:e=>{switch(e){case i.OX.Notified:return"Notified";case i.OX.Connecting:return"Connecting";case i.OX.Connected:return"Connected";case i.OX.LocalHold:return"LocalHold";case i.OX.RemoteHold:return"RemoteHold";case i.OX.Disconnecting:return"Disconnecting";case i.OX.Disconnected:return"Disconnected";case i.OX.Observing:return"Observing";case i.OX.EarlyMedia:return"EarlyMedia";case i.OX.InLobby:return"InLobby";case i.OX.Staging:return"Staging";case i.OX.Preheating:return"Preheating";case i.OX.Preheated:return"Preheated";case s.CallStateExt.Reconnecting:return"Reconnecting";case s.CallStateExt.Transferring:return"Transferring";case s.CallStateExt.TransferFailed:return"TransferFailed";case s.CallStateExt.TransferSucceeded:return"TransferSucceeded";case s.CallStateExt.Parking:return"Parking";case s.CallStateExt.ParkFailed:return"ParkFailed";case s.CallStateExt.ParkSucceeded:return"ParkSucceeded";case s.CallStateExt.Escalating:return"Escalating";case s.CallStateExt.EscalationFailed:return"EscalationFailed";case s.CallStateExt.EscalationSucceeded:return"EscalationSucceeded";case s.CallStateExt.Aborted:return"Aborted";default:return"None"}},stringifyStagingRoomState:e=>{switch(e){case l.o.InGreenRoom:return"InGreenRoom";case l.o.InStagingRoom:return"InStagingRoom";case l.o.FailedToBeMovedToMainMeeting:return"FailedToBeMovedToMainMeeting";case l.o.SuccessfullyMovedToMainMeeting:return"SuccessfullyMovedToMainMeeting";case l.o.MeetingIsLive:return"MeetingIsLive";case l.o.None:default:return"None"}},stringToBuffer(e){const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n},waitForCallConnection(e,t){const n=t.createDeferred();return(0,u.safeSubscribeToCall)(e,(e=>{if(e.state===i.OX.Disconnected||e.state===i.OX.Connected)return n.resolve(e),!0}),!0),n.promise},parseHexString(e){const t=[];for(;e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return t},getUUIDHash(e,t){const n=t(e),i=C.parseHexString(n);return i.length<4?-1:(i[0]<<24|i[1]<<16|i[2]<<8|i[3]<<0)>>>0},getUUIDHashPercentage:(e,t)=>C.getCQFHashPercentage(e,t),getCQFHashPercentage(e,t){if(/^[0-9A-Za-z/-]{36}$/.test(e)){const n=C.getUUIDHash(e,t);if(-1!==n)return n%100/100}return-1},systemAudioDeviceCheck(e,t){const n=e.getSelectedDevices();if(!n.microphone)return d.F.NoMicrophone;if(!n.speaker)return d.F.NoSpeakers;const i=e.getDefaultSpeakerDeviceId();return t.info(`checkSystemAudio: current speaker ${n.speaker} default ${i}`),i&&""!==i||e.getSpeakerChangeSubscribeStatus()?i&&i===n.speaker?d.F.Ok:d.F.SpeakersMismatch:(t.warn("no default speaker device found in devicemanager, even though getSelectedDevices returns a speaker"),d.F.Ok)},hasScreenshareModality(e){if(!e)return!1;const t=[i.WN.Inactive,i.WN.Disabled];return!C.hasEndpointDetails(e)||e.endpoints.endpointDetails.some((e=>!e.mediaStreams||e.mediaStreams.some((e=>C.mapMediaTypeStringToMediaType(e.type)===i.DD.ScreenShare&&-1===t.indexOf(C.mapMediaDirectionStringToMediaDirection(e.direction))))))},mapMediaDirectionStringToMediaDirection(e){switch(e){case"disabled":return i.WN.Disabled;case"inactive":return i.WN.Inactive;case"recvonly":return i.WN.ReceiveOnly;case"sendonly":return i.WN.SendOnly;case"sendrecv":return i.WN.Bidirectional;default:return}},isConnectedWithBrowserPermission:e=>e.mediaStreams.some((e=>C.mapMediaTypeStringToMediaType(e.type)===i.DD.Audio&&C.mapMediaDirectionStringToMediaDirection(e.direction)===i.WN.ReceiveOnly)),isConnectedWithAudioOrVideo(e){if(!e)return!1;const t=[i.WN.Inactive,i.WN.Disabled];return!C.hasEndpointDetails(e)||e.endpoints.endpointDetails.some((e=>{if(e.mediaStreams){if(e.mediaStreams.some((e=>"audio-teleconferencing"===e.type)))return!0;if(C.isConnectedWithBrowserPermission(e))return!1;return e.mediaStreams.filter((e=>t.indexOf(C.mapMediaDirectionStringToMediaDirection(e.direction))>-1)).length===e.mediaStreams.length||e.mediaStreams.some((e=>(C.mapMediaTypeStringToMediaType(e.type)===i.DD.Audio||C.mapMediaTypeStringToMediaType(e.type)===i.DD.Video)&&-1===t.indexOf(C.mapMediaDirectionStringToMediaDirection(e.direction))))}return!0}))},convertOidToCid(e){const t="00000000-0000-0000-";return e&&36===e.length&&e.startsWith(t)?e.slice(t.length).replace("-","").replace(/^0*/,""):void 0},b64EncodeUnicode:e=>e?"string"!=typeof e?null:btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))}))):null,b64DecodeUnicode:e=>e?"string"!=typeof e?null:decodeURIComponent(atob(e).split("").map((e=>`%${`00${e.charCodeAt(0).toString(16)}`.slice(-2)}`)).join("")):null,isParticipantInterpreter:e=>"interpreter"===(null==e?void 0:e.advancedMeetingRole),isMeetingCodeInvalid:(e,t)=>!(!e||!t)&&(o.Constants.meetingCodes.invalidMeetingCodeCodes.includes(e)&&o.Constants.meetingCodes.invalidMeetingCodeSubcodes.includes(t)),getMeetingInterpretationGroups(e){var t,n,i;return(null===(i=null===(n=null===(t=null==e?void 0:e.meetingDetails)||void 0===t?void 0:t.meetingGroups)||void 0===n?void 0:n.groups)||void 0===i?void 0:i.languageGroup)||void 0},isMeetingAnonymized(e){var t,n;return!!(null===(n=null===(t=null==e?void 0:e.meetingDetails)||void 0===t?void 0:t.meetingCapability)||void 0===n?void 0:n.maskIdentitiesForRole)},clampEmail(e,t){const n=e.match(/^(.+)@([^@]+)$/),i=null==n?void 0:n[2],a=3===(null==n?void 0:n.length)?n[1]:e,o=a.length>t?`${a.slice(0,t)}***`:a;return i?`${o}@${i}`:o},safeJsonParse:(e,t={},n)=>{let i;try{if(void 0===e)throw new Error('"undefined" is not valid JSON');i=JSON.parse(e)}catch(e){i=t,null==n||n(e)}return i}}},124534:(e,t,n)=>{n.r(t),n.d(t,{CallingIntentUtilities:()=>T});var i=n(361366),a=n(360452),o=n(197981),r=n(151220),s=n(952415),l=n(343508),c=n(918635),d=n(352935),g=n(717409),u=n(337846),p=n(347123),C=n(592084),h=n(62606),m=n(796973),S=n(388994),v=n(375094),I=n(744094),f=n(111576);class T{static intentFromStartPstnCallOptions(e,t,n){let i=v.PstnPrefix+e.dialoutNumber;return t&&!n&&(i+=e.dtmfPortion?`${v.ExtnPrefix}${e.dtmfPortion}`:""),{type:p.G.OneToOneCall,coordinates:{type:p.G.OneToOneCall,mri:i},joinOptions:{outgoingVideo:!1,outgoingAudio:!e.muted,shareDesktop:!1,consultationContext:e.consultationContext,context:e.context,onBehalfOf:e.onBehalfOf,onBehalfOfUserDisplayName:e.onBehalfOfUserDisplayName,extension:t?e.dtmfPortion:void 0,emergencyResult:e.emergencyResult},activeScenarios:[]}}static intentFromPlaceCallClickParametersAsync(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield n.getCallingConversation(e.conversationId);return this.intentFromPlaceCallClickParametersInternal(e,t,i)}))}static intentFromPlaceCallClickParameters(e,t,n){const i=n.getCallingConversation(e.conversationId);return this.intentFromPlaceCallClickParametersInternal(e,t,i)}static intentFromPlaceCallClickParametersInternal(e,t,n){let i,a,o;const r={outgoingVideo:!!e.withVideo,outgoingAudio:!e.muted,shareDesktop:!!e.screenSharingOnly,consultationContext:e.consultationContext,onBehalfOf:e.onBehalfOf,onBehalfOfUserDisplayName:e.onBehalfOfUserDisplayName,context:e.context,invitationData:e.invitationData};if(e.isEchoBotCall||n.isGroup())return a=p.G.GroupCall,o={type:p.G.GroupCall,conversationId:e.conversationId},{type:a,coordinates:o,joinOptions:r,activeScenarios:[]};if(n.isOneToOne()){a=p.G.OneToOneCall;const s=n.members.map((e=>e.id)).filter((e=>e!==t));i=s.length&&s[0],o={type:p.G.OneToOneCall,mri:i,conversationId:e.conversationId};return{type:a,coordinates:o,joinOptions:Object.assign({extension:e.extension},r),activeScenarios:[]}}return null}static intentFromDeepLinkOptions(e,t,n){var i,a,o;if(!e)return;const c=e.context&&e.context.MessageId||e.messageId,d=u.CallingDeepLinkService.getDeepLinkType(e.context,e.messageId,n),g=e.context&&e.context.IsBroadcastMeeting,C=!e.bypassPrejoin;return{type:p.G.Meeting,coordinates:{type:p.G.Meeting,joinType:r.c.Legacy,conversationId:e.conversationId,messageId:c,rootMessageId:e.messageId,isChannel:d!==s._n.PrivateMeeting,isAdhoc:d===s._n.AdhocMeeting,tenantId:e.context&&e.context.Tid||"",organizerId:e.context&&e.context.Oid||"",meetingCloud:e.meetingCloud||t.getUserCloudDomain(),broadcast:g?{role:e.userRole}:null,registration:e.context&&e.context.prid?{participantRegistrationId:e.context&&e.context.prid,isPublicEvent:e.context&&e.context.isPublic||!1}:null},joinOptions:{title:e.meetingTitle||"",isPSTN:!1,showPrejoin:C,outgoingVideo:!!e.withVideo||"true"===(null===(i=e.context)||void 0===i?void 0:i.WithVideo),outgoingAudio:!(e.muted||"true"===(null===(a=e.context)||void 0===a?void 0:a.Muted)),incomingAudio:"true"!==(null===(o=e.context)||void 0===o?void 0:o.MutedSpeakers),deeplinkId:e.deeplinkId,correlationId:e.context&&e.context.correlationId,context:l.l.DeepLink,skipPreJoinOnRejoin:e.context&&e.context.Rejoin,coldDeepLinkJoin:"cold"in e&&e.cold},activeScenarios:[]}}static intentFromMeetingParameters(e,t,n,i){let a;const s=!t.bypassPrejoin,l={correlationId:n,title:e.title||"",isPSTN:t.joinType===S.JoinType.pstn,showPrejoin:s,showScreensharingPanel:t.showScreensharingPanel,context:t.context,outgoingVideo:t.withOutgoingVideo,outgoingAudio:t.withOutgoingAudio};return a=i||!(0,o.isEmpty)(e.meetingData)&&void 0===i?{type:p.G.Meeting,coordinates:{type:p.G.Meeting,joinType:r.c.MeetingData,meetingData:e.meetingData,isAdhoc:!!e.isInstantMeeting},joinOptions:l,activeScenarios:[]}:{type:p.G.Meeting,coordinates:{type:p.G.Meeting,joinType:r.c.Legacy,conversationId:e.conversationId,messageId:e.replyChainMessageId||e.messageId||"0",rootMessageId:e.messageId||"0",isChannel:e.meetingType===c.MeetingType.Team,isAdhoc:!!e.isInstantMeeting,tenantId:e.tenantId||"",organizerId:e.organizerId||"",meetingCloud:e.meetingCloud||"",skypeTeamsMeetingUrl:e.skypeTeamsMeetingUrl||"",broadcast:e&&e.isBroadcast?{role:e.broadcastRole}:null},joinOptions:l,activeScenarios:[]},e.isInstantMeeting&&(a.coordinates.instantMeeting={id:(0,f.Z)(),schedulingServiceEventPromise:e.schedulingServiceEventPromise,autoCreated:!!t.autoCreatedInstantMeeting}),a}static intentFromMeetupParameters(e,t,n,i,a,o){return{type:p.G.Meeting,coordinates:{type:p.G.Meeting,joinType:r.c.Legacy,conversationId:e.conversationId,messageId:e.callMessageId,rootMessageId:e.callMessageId,isChannel:!0,isAdhoc:!!o,tenantId:t.tenantId||"",organizerId:t.organizerId||"",meetingCloud:n.getUserCloudDomain(),broadcast:null},joinOptions:{showPrejoin:!0,correlationId:i,context:l.l.StartMeetup,outgoingVideo:!!e.withVideo,outgoingAudio:!e.muted,title:a},activeScenarios:[]}}static isLegacyIntent(e){return e&&e.type===p.G.Meeting&&e.coordinates&&e.coordinates.joinType===r.c.Legacy}static intentTypeFromConversationId(e,t){const n=e&&t.getConversation(e);return this.intentTypeFromConversation(n)}static intentTypeFromConversationIdAsync(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=e&&(yield t.getConversation(e));return this.intentTypeFromConversation(n)}))}static intentTypeFromConversation(e){return e?e.isOneOnOne()?p.G.OneToOneCall:e.isGroupChat()?p.G.GroupCall:p.G.Meeting:p.G.Meeting}static generateIntentId(e,t){return e.joinOptions&&e.joinOptions.correlationId||t.generateUUID()}static isPSTNCoords(e,t,n=!1){const i=e=>e.type===p.G.OneToOneCall,a=e=>Boolean(e&&e.startsWith(v.PstnPrefix)),o=e=>e.type===p.G.OngoingCall&&"oneToOnePstnCall"===e.coordinates.callType;if(o(e)&&o(t)&&n)return!0;return!!(i(e.coordinates)&&i(t.coordinates)&&a(e.coordinates.mri)&&a(t.coordinates.mri)&&n)}static isEquivalentIntent(e,t,n,i,a=!1){const o=this.getCallFromIntent(e,i),r=this.getCallFromIntent(t,i);if(!this.isEqualCoordsTeamsCallId(e.coordinates,t.coordinates,o,r)&&this.isPSTNCoords(e,t,a))return!1;return this.areCallCoordinatesEquivalent(e.coordinates,t.coordinates,o,r)||this.areCoordinatesEquivalentInternal(e.coordinates,t.coordinates,o,r,n)}static isEquivalentIntentAsync(e,t,n,a,o,r=!1,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this.getCallFromIntent(e,a),l=this.getCallFromIntent(t,a);if(!this.isEqualCoordsTeamsCallId(e.coordinates,t.coordinates,i,l)&&this.isPSTNCoords(e,t,r))return!1;if(this.areCallCoordinatesEquivalent(e.coordinates,t.coordinates,i,l,o,s))return!0;return yield this.areCoordinatesEquivalentInternalAsync(e.coordinates,t.coordinates,i,l,n,o,s)}))}static getCallFromIntent(e,t){return t.getCallByIntentId(e.id)||t.getCallByCoordinates(e.coordinates)}static isExpectedRemoveIntent(e){return[d.ie.EndCallingIntent,d.ie.CleanupApp,d.ie.ChildWindowClosed,d.ie.RejoinCall].includes(e)}static getLinkedChatId(e,t,n,a,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(o&&(e=>{return"mri"in e&&(t=e.mri,Boolean(t&&t.startsWith(v.PstnPrefix)))||"callType"in e&&"oneToOnePstnCall"===e.callType;var t})(e))return Promise.resolve(void 0);{const i=yield T.messageUniqueIdentifierFromCallingIntent(e,t,n,a);if(!r)return null==i?void 0:i.convId;if(!i)return;const{convId:o,rootMessageId:s}=i;return this.isChannelMeeting(s)?`${o};replyChainId=${s}`:o}}))}static messageUniqueIdentifierFromCallingIntent(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!a&&e.type===p.G.Meeting&&e.joinType===r.c.Legacy){const{instantMeeting:t,conversationId:n}=e;!n&&t&&(e.conversationId=(yield t.schedulingServiceEventPromise).groupContext.threadId)}const i=this.messageUniqueIdentifierFromCoordinates(e);if("mri"in e)i.convId=yield this.conversationIdFromMri(e.mri,t);else if("teamsCallId"in e)return this.messageUniqueIdentifierFromTeamsCallId(e.teamsCallId,n);return i}))}static toStartPstnCallOptions(e,t,n,i,a){const{joinOptions:o,coordinates:r}=e;if(!("mri"in r))throw Error("mri property not found with coordinates object for interface OneToOneCoordinates.");let s;return s=i&&!a?-1===r.mri.indexOf(v.ExtnPrefix)?r.mri.substring(v.PstnPrefix.length):r.mri.substring(v.PstnPrefix.length,r.mri.indexOf(v.ExtnPrefix)):r.mri.substring(v.PstnPrefix.length),{dialoutNumber:s,context:t,consultationContext:n,withVideo:o.outgoingVideo,muted:!o.outgoingAudio,dtmfPortion:o.extension,onBehalfOf:o.onBehalfOf,onBehalfOfUserDisplayName:o.onBehalfOfUserDisplayName,emergencyResult:o.emergencyResult}}static toJoinType(e,t){const{isPSTN:n,outgoingVideo:i,outgoingAudio:a,incomingAudio:o}=e.joinOptions;return n||!t.isIPAudioModeEnabled?S.JoinType.pstn:i||a||!1!==o?S.JoinType.normal:S.JoinType.contentOnly}static toSkypeMeetingInfo(e,t){return{conversationId:e.conversationId,isInstantMeeting:!!e.instantMeeting,schedulingServiceEventPromise:e.instantMeeting&&e.instantMeeting.schedulingServiceEventPromise,meetingType:e.isChannel?c.MeetingType.Team:c.MeetingType.Chat,replyChainMessageId:e.messageId,messageId:e.rootMessageId||e.messageId,skypeTeamsMeetingUrl:e.skypeTeamsMeetingUrl,isPstnEnabled:t.isPSTN,correlationId:t.correlationId,title:t.title,meetingCloud:e.meetingCloud,organizerId:e.organizerId,tenantId:e.tenantId,isBroadcast:!!e.broadcast,broadcastRole:e.broadcast&&e.broadcast.role}}static toJoinCallOptions(e,t,n){return{callInfo:{conversationId:n,messageId:t.messageId,callId:t.callId,teamsCallId:t.teamsCallId,isScreenshareFromChat:t.isScreenshareFromChat},audioOnly:t.isScreenshareFromChat||!e.joinOptions.outgoingVideo,screenSharingOnly:t.isScreenshareFromChat,joinContext:e.joinOptions.context,conversationId:n}}static toMeetingInfo(e){if(!e.organizerId||!e.tenantId)return;const t={tenantId:e.tenantId,organizerId:e.organizerId,replyChainMessageId:e.messageId,meetingType:e.isChannel?a.Wr.Channel:a.Wr.Private};return e.broadcast&&(t.isBroadcast=!!e.broadcast,t.broadcastRole=e.broadcast&&T.getBroadcastRoleString(e.broadcast.role)),t}static getBroadcastRoleString(e){switch(e){case g.tf.Producer:return I.BroadcastMeeting.constants.role.producer;case g.tf.Contributor:return I.BroadcastMeeting.constants.role.contributor;default:return null}}static toCommonCallOptions(e,t,n){const{coordinates:i,joinOptions:a}=e,{mainScenario:o,secondaryScenarios:r}=T.resolveCallingScenarios(e,n);return{conversationId:i.conversationId,messageId:i.rootMessageId,meetingInfo:T.toMeetingInfo(i),muted:!a.outgoingAudio,mutedSpeakers:!1===a.incomingAudio,joinType:T.toJoinType(e,t),audioUsageMode:a.audioUsageMode,startCallScenarioPromise:Promise.resolve(o),secondaryScenarios:r,participantPin:null==i?void 0:i.participantPin,participantRegistrationId:i.registration&&i.registration.participantRegistrationId}}static toCallOptions(e,t,n){const{coordinates:i,joinOptions:a}=e,o=T.toCommonCallOptions(e,t,n);return Object.assign(Object.assign({},o),{isChannelMeeting:i.isChannel,withVideo:a.outgoingVideo,title:a.title})}static toJoinCallParams(e,t,n,i){const{joinOptions:a}=e,o=T.toCommonCallOptions(e,n,i);return Object.assign(Object.assign({},o),{callId:t.callId,teamsCallId:t.teamsCallId,callUrl:t.callUrl,audioOnly:!a.outgoingVideo})}static toPlaceCallOptions(e,t,n,i){const a=this.conversationIdFromCallingIntent(e.coordinates,t,i);return this.toPlaceCallOptionsInternal(e,n,a)}static toPlaceCallOptionsAsync(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.conversationIdFromCallingIntentAsync(e.coordinates,t,a);return this.toPlaceCallOptionsInternal(e,n,i)}))}static toPlaceCallOptionsInternal(e,t,n){return{conversationId:n.convId,messageId:n.rootMessageId,withVideo:e.joinOptions.outgoingVideo,isEchoBotCall:e.joinOptions.context===l.l.EchoBotCall,isChannelMeeting:!1,context:t,onBehalfOf:e.type===p.G.OneToOneCall?e.joinOptions.onBehalfOf:"",onBehalfOfUserDisplayName:e.type===p.G.OneToOneCall?e.joinOptions.onBehalfOfUserDisplayName:"",groupId:e.coordinates.type===p.G.GroupCall?e.coordinates.groupId:void 0,invitationData:e.joinOptions.invitationData}}static areCoordinatesEquivalent(e,t,n){const i=n.getCallByCoordinates(e),a=n.getCallByCoordinates(t);return e.type===p.G.Meeting&&t.type===p.G.Meeting&&this.areMeetingCoordinatesEquivalent(e,t,i,a)||this.areCallCoordinatesEquivalent(e,t,i,a)||this.isEqualCoordsConvIdMessageIdInternal(this.messageUniqueIdentifierFromCoordinates(e),this.messageUniqueIdentifierFromCoordinates(t),i,a)}static areCoordinatesEquivalentAsync(e,t,n,i){const a=i.getCallByCoordinates(e),o=i.getCallByCoordinates(t);return this.areCallCoordinatesEquivalent(e,t,a,o)?Promise.resolve(!0):this.areCoordinatesEquivalentInternalAsync(e,t,a,o,n)}static conversationIdFromCallingIntentAsync(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this.messageUniqueIdentifierFromCoordinates(e);if(n&&e.type===p.G.OneToOneCall){const t=null==e?void 0:e.conversationId;if(t)return i.convId=t,i}if("mri"in e){const n=e.mri,a=yield t.getChatConversationWith(n);if(!a)throw Error(`Conversation not found with mri: ${e.mri}`);i.convId=a.id}return i}))}static conversationIdFromCallingIntent(e,t,n){const i=this.messageUniqueIdentifierFromCoordinates(e);if(n&&e.type===p.G.OneToOneCall){const t=null==e?void 0:e.conversationId;if(t)return i.convId=t,i}if("mri"in e){const n=e.mri,a=t.getChatConversationWith(n);if(!a)throw Error(`Conversation not found with mri: ${e.mri}`);i.convId=a.id}return i}static coordinatesTypeFromCallAsync(e,t,n){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(h.CallUtilities.isOneToOnePstnCall(t)||t.isEmergencyCall||t.callType==a.rf.P2P)return p.G.OneToOneCall;if((null===(o=t.getIntent())||void 0===o?void 0:o.type)===p.G.Meeting||t.isBreakoutRoom())return p.G.Meeting;const i=yield e.getConversation(t.conversationId);return this.coordinatesTypeFromCallInternal(i,t,n)}))}static coordinatesTypeFromCallInternal(e,t,n){return e?e.isOneOnOne()?p.G.OneToOneCall:e.isGroupChat()?p.G.GroupCall:e.isMeetingConversation()||e.isChannelConversation()?p.G.Meeting:t.teamsCallType===a.rf.P2P?p.G.OneToOneCall:p.G.Meeting:(null==n?void 0:n.enableDecouplingGroupCallFromChat)&&"scheduledMeeting"!==t.conversationType&&"adHocMeeting"!==t.conversationType||(null==n?void 0:n.enableNewlyCreatedChatGroupCallToast)&&"groupCall"===t.conversationType?p.G.GroupCall:p.G.Meeting}static resolveCallingScenarios(e,t){const n=e.mainScenario&&t.findScenarioByNameAndId(e.mainScenario.name,e.mainScenario.clientId);let i=(n?e.activeScenarios.filter((e=>e&&e.clientId!==n.clientId&&e.name!==n.name)):[]).map((e=>t.findScenarioByNameAndId(e.name,e.clientId)));return i=(0,o.compact)(i),{mainScenario:n,secondaryScenarios:i}}static coordinatesFromCallInfo(e,t){return{type:p.G.Meeting,joinType:r.c.Legacy,conversationId:e.conversationId,messageId:e.replyChainMessageId||e.messageId,rootMessageId:e.messageId,isChannel:"0"!==e.messageId,isAdhoc:!1,tenantId:e.meetingInfo&&e.meetingInfo.tenantId,organizerId:e.meetingInfo&&e.meetingInfo.organizerId,meetingCloud:t.getUserCloudDomain(),broadcast:null}}static intentToTelemetryData(e){let t={[m.Constants.counters.eventNames.context]:e.joinOptions.context,[m.Constants.counters.eventNames.correlationId]:e.joinOptions.correlationId||e.id};if(e.type===p.G.Meeting&&e.coordinates.joinType===r.c.Legacy){const n=e.coordinates;t=Object.assign(Object.assign({},t),{[m.Constants.counters.eventNames.meetingTenantId]:n.tenantId,[m.Constants.counters.eventNames.messageId]:n.messageId,[m.Constants.counters.eventNames.threadId]:n.conversationId,[m.Constants.counters.eventNames.isBroadcast]:!!n.broadcast,[m.Constants.counters.eventNames.broadcastRole]:n.broadcast?g.tf[n.broadcast.role]:null,[m.Constants.counters.eventNames.coldDeepLinkJoin]:!!e.joinOptions.coldDeepLinkJoin})}return t[m.Constants.counters.eventNames.homeCloud]=e.joinOptions.homeCloud,t}static messageUniqueIdentifierFromCoordinates(e){return e.type===p.G.Meeting&&e.joinType===r.c.Legacy?{convId:e.conversationId,rootMessageId:e.rootMessageId,replyChainMessageId:e.messageId}:{convId:"conversationId"in e?e.conversationId:void 0,rootMessageId:void 0}}static messageUniqueIdentifierFromTeamsCallId(e,t){var n;const i=t.getCallByTeamsCallId(e);return{convId:i.conversationId,rootMessageId:i.messageId,replyChainMessageId:null===(n=i.meetingInfo)||void 0===n?void 0:n.replyChainMessageId}}static conversationIdFromMri(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.getConversationWithV2(e,"messageUniqueIdentifierFromCallingIntent");if(!n)throw Error(`Conversation not found with mri: ${e}`);return n.id}))}static areCallCoordinatesEquivalent(e,t,n,i,a,o){const r=e=>e.type===p.G.OneToOneCall||o&&"oneToOneCall"===e.callType;return this.isEqualCoordsTeamsCallId(e,t,n,i,a)||r(e)&&r(t)&&this.isEqualCoordsMri(e,t,n,i,a)}static areCoordinatesEquivalentInternalAsync(e,t,n,a,o,r,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e=>e.type===p.G.Meeting;if(i(e)&&i(t)&&this.areMeetingCoordinatesEquivalent(e,t,n,a,r))return!0;return yield this.isEqualCoordsConvIdMessageIdAsync(e,t,o,n,a,r,s)}))}static areCoordinatesEquivalentInternal(e,t,n,i,a){const o=e=>e.type===p.G.Meeting;return o(e)&&o(t)&&this.areMeetingCoordinatesEquivalent(e,t,n,i)||this.isEqualCoordsConvIdMessageId(e,t,a,n,i)}static intentFromOldIntent(e,t,n){const i={type:e.type,coordinates:Object.assign({},e.coordinates),joinOptions:{context:n.context,showPrejoin:e.joinOptions.showPrejoin,correlationId:t.generateUUID(),outgoingVideo:e.joinOptions.outgoingVideo,outgoingAudio:e.joinOptions.outgoingAudio,incomingVideo:e.joinOptions.incomingVideo,incomingAudio:e.joinOptions.incomingAudio,retryCount:(e.joinOptions.retryCount||0)+1,previousScenario:e.mainScenario&&e.mainScenario.name},activeScenarios:[],retriedIntentId:e.id};if(e.type===p.G.Meeting&&i.type===p.G.Meeting){i.joinOptions.title=e.joinOptions.title;const t=i.coordinates,a=n.meetingData;t.joinType!==r.c.MeetingData||(0,o.isEmpty)(a)||(a.meetingCode&&(t.meetingData={meetingCode:a.meetingCode}),a.passcode&&(t.meetingData.passcode=a.passcode)),t.isAdhoc&&(t.joinType===r.c.Legacy&&t.isChannel?((!t.rootMessageId&&n.rootMessageId||n.replyChainMessageId)&&(t.isAdhoc=!1),t.rootMessageId=t.rootMessageId||n.rootMessageId,t.messageId=t.messageId||n.replyChainMessageId):(t.joinType===r.c.Legacy&&t.conversationId||t.joinType===r.c.MeetingData&&!(0,o.isEmpty)(t.meetingData))&&(t.isAdhoc=!1))}return i}static isEqualCoordsTeamsCallId(e,t,n,i,a){const o="teamsCallId"in e&&e.teamsCallId||n&&n.teamsCallId,r="teamsCallId"in t&&t.teamsCallId||i&&i.teamsCallId,s=!!o&&!!r&&o===r;return s&&(null==a||a.info(`[isEqualCoordsTeamsCallId] #callpopout teamsCallId : ${o}`)),s}static isEqualCoordsMri(e,t,n,i,a){const o=e.mri||n&&n.callerMri,r=t.mri||i&&i.callerMri,s=!!o&&!!r&&o===r;return s&&(null==a||a.info("[isEqualCoordsMri] #callpopout match on mri")),s}static isEqualCoordsConvIdMessageIdAsync(e,t,n,a,o,r,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.conversationIdFromCallingIntentAsync(e,n),l=yield this.conversationIdFromCallingIntentAsync(t,n);return this.isEqualCoordsConvIdMessageIdInternal(i,l,a,o,r,s)}))}static isEqualCoordsConvIdMessageId(e,t,n,i,a){const o=this.conversationIdFromCallingIntent(e,n),r=this.conversationIdFromCallingIntent(t,n);return this.isEqualCoordsConvIdMessageIdInternal(o,r,i,a)}static isEqualCoordsConvIdMessageIdInternal({convId:e,rootMessageId:t},{convId:n,rootMessageId:i},a,o,r,s){e=e||(null==a?void 0:a.conversationId)||(null==a?void 0:a.threadId),n=n||(null==o?void 0:o.conversationId)||(null==o?void 0:o.threadId),t=t||a&&a.messageId,i=i||o&&o.messageId;const l=e=>s?!e||"0"===e:!e,c=!!(e&&n&&e===n&&(t&&i&&t===i||l(t)&&l(i)));return c&&(null==r||r.info(`[isEqualCoordsConvIdMessageIdInternal] #callpopout match on conversationId ${e} and messageId ${t}`)),c}static areMeetingCoordinatesEquivalent(e,t,n,i,a){return this.areMeetingDataCoordinatesEquivalent(e,t,n,i,a)||this.isEqualCoordsConvIdMessageIdInternal(this.messageUniqueIdentifierFromCoordinates(e),this.messageUniqueIdentifierFromCoordinates(t),n,i,a)}static areMeetingDataCoordinatesEquivalent(e,t,n,i,a){var o,s,l,c,d,g,u,p;let C=null===(o=null==n?void 0:n.meetingData)||void 0===o?void 0:o.meetingCode,h=null===(s=null==n?void 0:n.meetingData)||void 0===s?void 0:s.meetingUrl;e.joinType===r.c.MeetingData&&(C=null===(l=e.meetingData)||void 0===l?void 0:l.meetingCode,h=null===(c=e.meetingData)||void 0===c?void 0:c.meetingUrl);let m=null===(d=null==i?void 0:i.meetingData)||void 0===d?void 0:d.meetingCode,S=null===(g=null==i?void 0:i.meetingData)||void 0===g?void 0:g.meetingUrl;t.joinType===r.c.MeetingData&&(m=null===(u=t.meetingData)||void 0===u?void 0:u.meetingCode,S=null===(p=t.meetingData)||void 0===p?void 0:p.meetingUrl);if(C&&m&&C===m)return null==a||a.info(`[areMeetingDataCoordinatesEquivalent] #callpopout match on meetingCode: ${C}`),!0;return h&&S&&h===S?(null==a||a.info(`[areMeetingDataCoordinatesEquivalent] #callpopout match on meetingUrl: ${h}`),!0):void 0}static isChannelMeeting(e){return!(!e||e===C.PRIVATE_MEETUP_MESSAGE_ID)}static legacyMeetingCoordinatesFromCall(e,t,n){const i=e.getIntent();if(i&&i.type===p.G.Meeting&&i.coordinates.joinType===r.c.Legacy)return i.coordinates;const a=t.getCallByCallId(e.conversationId,e.callId),o=e.meetingInfo||a&&a.meetingInfo||e.setupArgs&&e.setupArgs.meetingInfo,s=o&&o.isBroadcast?{role:o.broadcastRole}:null;return{type:p.G.Meeting,joinType:r.c.Legacy,conversationId:e.conversationId,messageId:o&&o.replyChainMessageId||e.messageId,rootMessageId:e.messageId,isChannel:T.isChannelMeeting(e.messageId),isAdhoc:!1,tenantId:o&&o.tenantId||"",organizerId:o&&o.organizerId||"",meetingCloud:n.getUserCloudDomain(),broadcast:s||e.broadcastMetadata?{role:teams.calling.BroadcastParticipantRole.None}:null}}static meetingCodeCoordinatesFromCall(e){return{type:p.G.Meeting,joinType:r.c.MeetingData,meetingData:e.meetingData,isAdhoc:!1}}static toMeetingCoordinatesFromCall(e,t,n){return e.meetingData?T.meetingCodeCoordinatesFromCall(e):T.legacyMeetingCoordinatesFromCall(e,t,n)}}},375094:(e,t,n)=>{n.r(t),n.d(t,{BotPrefix:()=>i,PstnPrefix:()=>a,SfbPrefix:()=>o,MriNamespace_SkypeSpacesUser:()=>r,ExtnPrefix:()=>s,ThreadProp_Meeting:()=>l,ThreadProp_TenantId:()=>c,ThreadProp_Liveness:()=>d,MessageProperty_Importance:()=>g,MessageType_Text:()=>u,MessageType_RichText:()=>p,MessageType_HTML:()=>C,MessageType_Moji:()=>h,MessageType_URIObject:()=>m,MessageType_MediaCard:()=>S,MessageType_Contacts:()=>v,MessageType_Files:()=>I,MessageType_Sms:()=>f,MessageType_Location:()=>T,MessageType_Call:()=>y,MessageType_CallPushNotification:()=>E,Type_Message:()=>A,SmsUserPrefix:()=>b,SmsUserUnverifiedPrefix:()=>M,PublicCloudMriTag:()=>D,AcsUserPrefix:()=>P,SkypeSpacesUserMriTag:()=>R,ConversationType_Chat:()=>N,ThreadProp_ThreadType:()=>O,ThreadProp_GapDetectionEnabled:()=>_,ThreadProp_P2PChatUniqueRosterThread:()=>w,ThreadType_Chat:()=>k,VoiceAppPrefix:()=>F,ConversationProp_InteropConversationStatus:()=>L});const i="28:",a="4:",o="sfb:",r="8:",s=";ext=",l="meeting",c="tenantid",d="awareness_conversationLiveState",g="importance",u="Text",p="RichText",C="RichText/Html",h="RichText/Media_FlikMsg",m="RichText/UriObject",S="RichText/Media_Card",v="RichText/Contacts",I="RichText/Files",f="RichText/Sms",T="RichText/Location",y="Event/Call",E="Signal/Flamingo",A="Message",b="50:sms:",M="50:smsunverified:",D="orgid:",P="8:acs",R=D,N="Chat",O="threadType",_="gapDetectionEnabled",w="uniquerosterthread",k="chat",F=i+D,L="interopconversationstatus"},777439:(e,t,n)=>{n.r(t),n.d(t,{EventSourceImpl:()=>a,EventSubscriptionImpl:()=>o});var i=n(197981);class a{constructor(){this.subscriptions=[]}subscribe(e){return new o(this.subscriptions,e)}dispose(){this.subscriptions=[]}raiseEvents(e){this.subscriptions.slice().forEach((t=>e(t.eventHandler)))}}class o{constructor(e,t){this.subscriptions=e,this.eventHandler=t,e.push(this)}dispose(){(0,i.remove)(this.subscriptions,(e=>e===this))}}},207500:(e,t,n)=>{var i,a,o,r,s;n.r(t),n.d(t,{ResponseType:()=>i,AttendeeType:()=>a,AttendeeGroupType:()=>o,RoleConstants:()=>r,FreeBusyType:()=>s,MeetingAttendeeDetailViewModel:()=>l}),function(e){e[e.None=0]="None",e[e.Organizer=1]="Organizer",e[e.Tentative=2]="Tentative",e[e.Accepted=3]="Accepted",e[e.Declined=4]="Declined",e[e.NotResponded=5]="NotResponded"}(i||(i={})),function(e){e[e.Required=0]="Required",e[e.Optional=1]="Optional",e[e.Resource=2]="Resource",e[e.Organizer=3]="Organizer"}(a||(a={})),function(e){e.StreamGroup="StreamGroup",e.SecurityGroup="SecurityGroup"}(o||(o={})),function(e){e.Admin="Admin"}(r||(r={})),function(e){e[e.Free=0]="Free",e[e.Tentative=1]="Tentative",e[e.Busy=2]="Busy",e[e.Oof=3]="Oof",e[e.WorkingElsewhere=4]="WorkingElsewhere",e[e.Unknown=5]="Unknown"}(s||(s={}));class l{constructor(e){this.name=e.name,this.status=e.status,this.address=e.address,this.type=e.type,this.formattedStatus=e.status?e.status.response:"",this.formattedType=e.type?e.type:"",this.freeBusyStatus=s[s.Unknown],this.role=e.role?e.role:r.Admin,this.broadcastMeetingRole=e.broadcastMeetingRole,this.isGroup=e.isGroup,e.isGroup?(this.objectId=e.objectId,this.groupType=e.groupType&&o[e.groupType]):this.skypeMri=e.mri}}},860810:(e,t,n)=>{n.r(t),n.d(t,{ObservableBase:()=>a});var i=n(777439);class a extends i.EventSourceImpl{changed(e){return this.subscribe({changed:e,on:null})}on(e,t){return this.subscribe({changed:null,on:{name:e,handler:this._toEventCallback(t)}})}once(e,t){let n;return n=this.on(e,this._fromEventCallback(((...e)=>{n.dispose(),this._toEventCallback(t)(...e)})))}raiseChanged(){this.raiseEvents((e=>e.changed&&e.changed()))}event(e){return{raise:this._fromEventCallback(((...t)=>this._raiseEventImpl(e,...t)))}}_raiseEventImpl(e,...t){this.raiseEvents((n=>n.on&&n.on.name===e&&n.on.handler(...t)))}_toEventCallback(e){return e}_fromEventCallback(e){return e}}a.Type_All="%all",a.Key_All="%all"},417382:(e,t,n)=>{n.r(t),n.d(t,{ICallParticipantHelpers:()=>o});var i=n(360452),a=n(197981);class o{static firstScreenShareFor(e){return r(e,i.jx.ScreenSharing)[0]}static firstVideoFor(e){return r(e,i.jx.Video).filter(s)[0]}static bestAvailableScreenShareFor(e){const t=r(e,i.jx.ScreenSharing).filter((e=>e.isAvailable));return(0,a.maxBy)(t,"rank")||t[0]}static bestScreenShareFor(e){return o.bestAvailableScreenShareFor(e)||o.firstScreenShareFor(e)}static bestAvailableVideoFor(e){const t=r(e,i.jx.Video).filter((e=>e.isAvailable&&s(e)));return(0,a.maxBy)(t,"rank")||t[0]}static bestVideoFor(e){return o.bestAvailableVideoFor(e)||o.firstVideoFor(e)}}function r(e,t){return e&&e.streams&&e.streams[t]||[]}function s(e){return!e.label||"main-video"===e.label}},590764:(e,t,n)=>{n.r(t),n.d(t,{AggregateSettingsStorageKey:()=>i,MeetingPolicySettingsStorageKey:()=>a,CallingPolicyStorageKey:()=>o,PolicySettingsStorageKey:()=>r,VoiceSettingsStorageKey:()=>s,TeamsMeetingBrandingPolicyStorageKey:()=>l,SyntheticAutomatedCallPolicyStorageKey:()=>c,TeamsEmergencyCallingPolicyStorageKey:()=>d,TeamsEmergencyCallRoutingPolicyStorageKey:()=>g,EnrollUserOverrideMode:()=>u});class i{}i.adminSettings="adminSettings",i.callingPolicySettings="callingPolicy",i.voicemailPolicy="voicemailPolicy",i.callParkPolicySettings="callParkPolicy",i.meetingPolicySettings="meetingPolicy",i.messagingPolicy="messagingPolicy",i.onlineDialinConferencingPolicy="onlineDialinConferencingPolicy",i.policySettings="policySettings",i.syntheticAutomatedCallPolicy="syntheticAutomatedCallPolicy",i.teamsMeetingBrandingPolicy="teamsMeetingBrandingPolicy",i.tenantSettings="tenantSettingsV2",i.tenantVoiceSettings="tenantVoiceSettings",i.userResourcesSettings="userResourcesSettings",i.voiceSettings="voiceAdminSettings",i.teamsEnhancedEncryptionPolicy="teamsEnhancedEncryptionPolicy",i.teamsEmergencyCallingPolicy="teamsEmergencyCallingPolicy",i.teamsEmergencyCallRoutingPolicy="teamsEmergencyCallRoutingPolicy",i.teamsChannelsPolicy="teamsChannelsPolicy";class a{}a.allowExternalParticipantGiveRequestControl="allowExternalParticipantGiveRequestControl",a.allowNDIStreaming="allowNDIStreaming",a.allowParticipantGiveRequestControl="allowParticipantGiveRequestControl",a.allowPowerPointSharing="allowPowerPointSharing",a.mediaBitRateKb="mediaBitRateKb",a.recordingStorageMode="recordingStorageMode",a.screenSharingMode="screenSharingMode",a.liveStreamingMode="liveStreamingMode",a.roomAttributeUserOverride="roomAttributeUserOverride",a.roomPeopleNameUserOverride="roomPeopleNameUserOverride",a.liveCaptionsEnabledType="liveCaptionsEnabledType",a.allowIPVideo="allowIPVideo",a.teamsCameraFarEndPTZMode="teamsCameraFarEndPTZMode",a.enrollUserOverride="enrollUserOverride",a.allowAnnotations="allowAnnotations";class o{}o.allowPrivateCalling="allowPrivateCalling",o.allowWebPSTNCalling="allowWebPSTNCalling",o.preventTollBypass="preventTollBypass";class r{}r.allowUserOverrideForCalling="teamsInteropPolicy.allowEndUserClientOverride",r.byot="byot",r.callingLineIdentityPolicy="policySettings.callingLineIdentityPolicy",r.dialPlanPolicy="dialPlanPolicy",r.iTUCountryPrefix="dialPlanPolicy.ituCountryPrefix",r.locationPolicy="locationPolicy",r.teamsInteropPolicy="teamsInteropPolicy",r.teamsMeetingPolicy="teamsMeetingPolicy",r.voicePolicy="voicePolicy";class s{}s.delegateSettings="delegationSettings",s.electedSettings="electedSettings",s.isEvEnabled="isEvEnabled",s.isTeamsPreferredClient="isTeamsPreferredClient",s.ringtoneSettings="ringtoneSettings",s.callGroupMembershipSettings="callGroupMembershipSettings",s.callRedirectionSettings="callRedirectionSettings",s.busyOnBusySetting="busyOnBusySetting";class l{}l.enableMeetingBackgroundImages="enableMeetingBackgroundImages",l.meetingBackgroundImages="meetingBackgroundImages";class c{}c.syntheticAutomatedCallsMode="syntheticAutomatedCallsMode";class d{}d.notificationGroup="notificationGroup",d.notificationDialOutNumber="notificationDialOutNumber",d.externalLocationLookupMode="externalLocationLookupMode",d.notificationMode="notificationMode",d.description="description",d.policyDocument="policyDocument",d.securityDeskMris="securityDeskMris",d.enhancedEmergencyServiceDisclaimer="enhancedEmergencyServiceDisclaimer";class g{}g.allowEnhancedEmergencyServices="allowEnhancedEmergencyServices",g.emergencyNumbers="emergencyNumbers",g.policyDocument="policyDocument";const u={disabled:"Disabled",enabled:"Enabled"}},268316:(e,t,n)=>{n.r(t),n.d(t,{safeSubscribeToCall:()=>a,safeOn:()=>o});var i=n(360452);function a(e,t,n=!1,a=null,o){let r=null,s=null;const l=()=>{r&&(r.dispose(),r=null),s&&s()},c=()=>{const n=t(e);(e.state===i.OX.Disconnected||n)&&l()};return e.state!==i.OX.Disconnected&&(r=o?e.on(o,c):e.changed(c)),n&&c(),a&&r&&(s=a((()=>l()))),r}function o(e,t,n){let a=e.on(t,((...t)=>{(n(...t)||e.state===i.OX.Disconnected)&&(null==a||a.dispose(),a=null)}));return a}},2065:(e,t,n)=>{var i,a,o,r,s;n.d(t,{O0:()=>i,MV:()=>a,IL:()=>o,DS:()=>r,$w:()=>s}),function(e){e.Video="video",e.Screenshare="screenshare",e.Appshare="appshare",e.Hid="hid",e.MultiMonitorScreenShare="multimonitorscreenshare",e.RemoteAudioNotifications="remoteaudionotifications",e.CompositeDevices="compositedevices",e.MultiWindow="multiwindow",e.DataChannel="datachannel",e.GiveControl="givecontrol",e.ShareSystemAudio="sharesystemaudio",e.BackgroundEffects="backgroundeffects",e.SecondaryRinger="secondaryringer",e.WebRTC1Dot0="webrtc1.0"}(i||(i={})),function(e){e.Connected="Connected",e.Disconnected="Disconnected",e.Local="Local",e.Unknown="Unknown"}(a||(a={})),function(e){e.Failure="Failure",e.Normal="Normal",e.UnsupportedEndpoint="Unsupported Endpoint",e.NoNetwork="No Network",e.Unknown="Unknown"}(o||(o={})),function(e){e.Disconnected="Disconnected",e.DesktopVersion="DesktopVersion",e.Unknown="Unknown",e.None="None",e.AngularDeprecated="AngularDeprecated",e.MultiWindowCapabilityChange="MultiWindowCapabilityChange"}(r||(r={})),function(e){e[e.none=0]="none",e[e.citrixXenDesktop=1]="citrixXenDesktop",e[e.citrixXenApp=2]="citrixXenApp",e[e.vmware=3]="vmware",e[e.wvd=5]="wvd"}(s||(s={}))}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/863993-213e3f4eb92d5c1b.js.map